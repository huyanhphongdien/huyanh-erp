function u$(e,r){for(var t=0;t<r.length;t++){const n=r[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var on=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ru(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P2={exports:{}},v0={},O2={exports:{}},rn={};var jk;function d$(){if(jk)return rn;jk=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function p(q){return q===null||typeof q!="object"?null:(q=f&&q[f]||q["@@iterator"],typeof q=="function"?q:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,g={};function m(q,M,G){this.props=q,this.context=M,this.refs=g,this.updater=G||h}m.prototype.isReactComponent={},m.prototype.setState=function(q,M){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,M,"setState")},m.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function x(){}x.prototype=m.prototype;function v(q,M,G){this.props=q,this.context=M,this.refs=g,this.updater=G||h}var w=v.prototype=new x;w.constructor=v,y(w,m.prototype),w.isPureReactComponent=!0;var _=Array.isArray,A=Object.prototype.hasOwnProperty,P={current:null},B={key:!0,ref:!0,__self:!0,__source:!0};function T(q,M,G){var X,re={},V=null,J=null;if(M!=null)for(X in M.ref!==void 0&&(J=M.ref),M.key!==void 0&&(V=""+M.key),M)A.call(M,X)&&!B.hasOwnProperty(X)&&(re[X]=M[X]);var W=arguments.length-2;if(W===1)re.children=G;else if(1<W){for(var F=Array(W),Q=0;Q<W;Q++)F[Q]=arguments[Q+2];re.children=F}if(q&&q.defaultProps)for(X in W=q.defaultProps,W)re[X]===void 0&&(re[X]=W[X]);return{$$typeof:e,type:q,key:V,ref:J,props:re,_owner:P.current}}function I(q,M){return{$$typeof:e,type:q.type,key:M,ref:q.ref,props:q.props,_owner:q._owner}}function U(q){return typeof q=="object"&&q!==null&&q.$$typeof===e}function H(q){var M={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(G){return M[G]})}var z=/\/+/g;function O(q,M){return typeof q=="object"&&q!==null&&q.key!=null?H(""+q.key):M.toString(36)}function L(q,M,G,X,re){var V=typeof q;(V==="undefined"||V==="boolean")&&(q=null);var J=!1;if(q===null)J=!0;else switch(V){case"string":case"number":J=!0;break;case"object":switch(q.$$typeof){case e:case r:J=!0}}if(J)return J=q,re=re(J),q=X===""?"."+O(J,0):X,_(re)?(G="",q!=null&&(G=q.replace(z,"$&/")+"/"),L(re,M,G,"",function(Q){return Q})):re!=null&&(U(re)&&(re=I(re,G+(!re.key||J&&J.key===re.key?"":(""+re.key).replace(z,"$&/")+"/")+q)),M.push(re)),1;if(J=0,X=X===""?".":X+":",_(q))for(var W=0;W<q.length;W++){V=q[W];var F=X+O(V,W);J+=L(V,M,G,F,re)}else if(F=p(q),typeof F=="function")for(q=F.call(q),W=0;!(V=q.next()).done;)V=V.value,F=X+O(V,W++),J+=L(V,M,G,F,re);else if(V==="object")throw M=String(q),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return J}function E(q,M,G){if(q==null)return q;var X=[],re=0;return L(q,X,"","",function(V){return M.call(G,V,re++)}),X}function k(q){if(q._status===-1){var M=q._result;M=M(),M.then(function(G){(q._status===0||q._status===-1)&&(q._status=1,q._result=G)},function(G){(q._status===0||q._status===-1)&&(q._status=2,q._result=G)}),q._status===-1&&(q._status=0,q._result=M)}if(q._status===1)return q._result.default;throw q._result}var N={current:null},S={transition:null},C={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:S,ReactCurrentOwner:P};function D(){throw Error("act(...) is not supported in production builds of React.")}return rn.Children={map:E,forEach:function(q,M,G){E(q,function(){M.apply(this,arguments)},G)},count:function(q){var M=0;return E(q,function(){M++}),M},toArray:function(q){return E(q,function(M){return M})||[]},only:function(q){if(!U(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},rn.Component=m,rn.Fragment=t,rn.Profiler=a,rn.PureComponent=v,rn.StrictMode=n,rn.Suspense=u,rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C,rn.act=D,rn.cloneElement=function(q,M,G){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var X=y({},q.props),re=q.key,V=q.ref,J=q._owner;if(M!=null){if(M.ref!==void 0&&(V=M.ref,J=P.current),M.key!==void 0&&(re=""+M.key),q.type&&q.type.defaultProps)var W=q.type.defaultProps;for(F in M)A.call(M,F)&&!B.hasOwnProperty(F)&&(X[F]=M[F]===void 0&&W!==void 0?W[F]:M[F])}var F=arguments.length-2;if(F===1)X.children=G;else if(1<F){W=Array(F);for(var Q=0;Q<F;Q++)W[Q]=arguments[Q+2];X.children=W}return{$$typeof:e,type:q.type,key:re,ref:V,props:X,_owner:J}},rn.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:i,_context:q},q.Consumer=q},rn.createElement=T,rn.createFactory=function(q){var M=T.bind(null,q);return M.type=q,M},rn.createRef=function(){return{current:null}},rn.forwardRef=function(q){return{$$typeof:c,render:q}},rn.isValidElement=U,rn.lazy=function(q){return{$$typeof:d,_payload:{_status:-1,_result:q},_init:k}},rn.memo=function(q,M){return{$$typeof:l,type:q,compare:M===void 0?null:M}},rn.startTransition=function(q){var M=S.transition;S.transition={};try{q()}finally{S.transition=M}},rn.unstable_act=D,rn.useCallback=function(q,M){return N.current.useCallback(q,M)},rn.useContext=function(q){return N.current.useContext(q)},rn.useDebugValue=function(){},rn.useDeferredValue=function(q){return N.current.useDeferredValue(q)},rn.useEffect=function(q,M){return N.current.useEffect(q,M)},rn.useId=function(){return N.current.useId()},rn.useImperativeHandle=function(q,M,G){return N.current.useImperativeHandle(q,M,G)},rn.useInsertionEffect=function(q,M){return N.current.useInsertionEffect(q,M)},rn.useLayoutEffect=function(q,M){return N.current.useLayoutEffect(q,M)},rn.useMemo=function(q,M){return N.current.useMemo(q,M)},rn.useReducer=function(q,M,G){return N.current.useReducer(q,M,G)},rn.useRef=function(q){return N.current.useRef(q)},rn.useState=function(q){return N.current.useState(q)},rn.useSyncExternalStore=function(q,M,G){return N.current.useSyncExternalStore(q,M,G)},rn.useTransition=function(){return N.current.useTransition()},rn.version="18.3.1",rn}var Nk;function Am(){return Nk||(Nk=1,O2.exports=d$()),O2.exports}var kk;function h$(){if(kk)return v0;kk=1;var e=Am(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,l){var d,f={},p=null,h=null;l!==void 0&&(p=""+l),u.key!==void 0&&(p=""+u.key),u.ref!==void 0&&(h=u.ref);for(d in u)n.call(u,d)&&!i.hasOwnProperty(d)&&(f[d]=u[d]);if(c&&c.defaultProps)for(d in u=c.defaultProps,u)f[d]===void 0&&(f[d]=u[d]);return{$$typeof:r,type:c,key:p,ref:h,props:f,_owner:a.current}}return v0.Fragment=t,v0.jsx=o,v0.jsxs=o,v0}var Sk;function f$(){return Sk||(Sk=1,P2.exports=h$()),P2.exports}var s=f$(),R=Am();const sa=ru(R),p$=u$({__proto__:null,default:sa},[R]);var Jy={},M2={exports:{}},go={},I2={exports:{}},R2={};var Ck;function m$(){return Ck||(Ck=1,(function(e){function r(S,C){var D=S.length;S.push(C);e:for(;0<D;){var q=D-1>>>1,M=S[q];if(0<a(M,C))S[q]=C,S[D]=M,D=q;else break e}}function t(S){return S.length===0?null:S[0]}function n(S){if(S.length===0)return null;var C=S[0],D=S.pop();if(D!==C){S[0]=D;e:for(var q=0,M=S.length,G=M>>>1;q<G;){var X=2*(q+1)-1,re=S[X],V=X+1,J=S[V];if(0>a(re,D))V<M&&0>a(J,re)?(S[q]=J,S[V]=D,q=V):(S[q]=re,S[X]=D,q=X);else if(V<M&&0>a(J,D))S[q]=J,S[V]=D,q=V;else break e}}return C}function a(S,C){var D=S.sortIndex-C.sortIndex;return D!==0?D:S.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var u=[],l=[],d=1,f=null,p=3,h=!1,y=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(S){for(var C=t(l);C!==null;){if(C.callback===null)n(l);else if(C.startTime<=S)n(l),C.sortIndex=C.expirationTime,r(u,C);else break;C=t(l)}}function _(S){if(g=!1,w(S),!y)if(t(u)!==null)y=!0,k(A);else{var C=t(l);C!==null&&N(_,C.startTime-S)}}function A(S,C){y=!1,g&&(g=!1,x(T),T=-1),h=!0;var D=p;try{for(w(C),f=t(u);f!==null&&(!(f.expirationTime>C)||S&&!H());){var q=f.callback;if(typeof q=="function"){f.callback=null,p=f.priorityLevel;var M=q(f.expirationTime<=C);C=e.unstable_now(),typeof M=="function"?f.callback=M:f===t(u)&&n(u),w(C)}else n(u);f=t(u)}if(f!==null)var G=!0;else{var X=t(l);X!==null&&N(_,X.startTime-C),G=!1}return G}finally{f=null,p=D,h=!1}}var P=!1,B=null,T=-1,I=5,U=-1;function H(){return!(e.unstable_now()-U<I)}function z(){if(B!==null){var S=e.unstable_now();U=S;var C=!0;try{C=B(!0,S)}finally{C?O():(P=!1,B=null)}}else P=!1}var O;if(typeof v=="function")O=function(){v(z)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,E=L.port2;L.port1.onmessage=z,O=function(){E.postMessage(null)}}else O=function(){m(z,0)};function k(S){B=S,P||(P=!0,O())}function N(S,C){T=m(function(){S(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(S){S.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,k(A))},e.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<S?Math.floor(1e3/S):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return t(u)},e.unstable_next=function(S){switch(p){case 1:case 2:case 3:var C=3;break;default:C=p}var D=p;p=C;try{return S()}finally{p=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(S,C){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var D=p;p=S;try{return C()}finally{p=D}},e.unstable_scheduleCallback=function(S,C,D){var q=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?q+D:q):D=q,S){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=D+M,S={id:d++,callback:C,priorityLevel:S,startTime:D,expirationTime:M,sortIndex:-1},D>q?(S.sortIndex=D,r(l,S),t(u)===null&&S===t(l)&&(g?(x(T),T=-1):g=!0,N(_,D-q))):(S.sortIndex=M,r(u,S),y||h||(y=!0,k(A))),S},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(S){var C=p;return function(){var D=p;p=C;try{return S.apply(this,arguments)}finally{p=D}}}})(R2)),R2}var Ak;function g$(){return Ak||(Ak=1,I2.exports=m$()),I2.exports}var Ek;function y$(){if(Ek)return go;Ek=1;var e=Am(),r=g$();function t(b){for(var j="https://reactjs.org/docs/error-decoder.html?invariant="+b,$=1;$<arguments.length;$++)j+="&args[]="+encodeURIComponent(arguments[$]);return"Minified React error #"+b+"; visit "+j+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(b,j){o(b,j),o(b+"Capture",j)}function o(b,j){for(a[b]=j,b=0;b<j.length;b++)n.add(j[b])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,l=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function p(b){return u.call(f,b)?!0:u.call(d,b)?!1:l.test(b)?f[b]=!0:(d[b]=!0,!1)}function h(b,j,$,Y){if($!==null&&$.type===0)return!1;switch(typeof j){case"function":case"symbol":return!0;case"boolean":return Y?!1:$!==null?!$.acceptsBooleans:(b=b.toLowerCase().slice(0,5),b!=="data-"&&b!=="aria-");default:return!1}}function y(b,j,$,Y){if(j===null||typeof j>"u"||h(b,j,$,Y))return!0;if(Y)return!1;if($!==null)switch($.type){case 3:return!j;case 4:return j===!1;case 5:return isNaN(j);case 6:return isNaN(j)||1>j}return!1}function g(b,j,$,Y,te,oe,ve){this.acceptsBooleans=j===2||j===3||j===4,this.attributeName=Y,this.attributeNamespace=te,this.mustUseProperty=$,this.propertyName=b,this.type=j,this.sanitizeURL=oe,this.removeEmptyString=ve}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(b){m[b]=new g(b,0,!1,b,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(b){var j=b[0];m[j]=new g(j,1,!1,b[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(b){m[b]=new g(b,2,!1,b.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(b){m[b]=new g(b,2,!1,b,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(b){m[b]=new g(b,3,!1,b.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(b){m[b]=new g(b,3,!0,b,null,!1,!1)}),["capture","download"].forEach(function(b){m[b]=new g(b,4,!1,b,null,!1,!1)}),["cols","rows","size","span"].forEach(function(b){m[b]=new g(b,6,!1,b,null,!1,!1)}),["rowSpan","start"].forEach(function(b){m[b]=new g(b,5,!1,b.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function v(b){return b[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(b){var j=b.replace(x,v);m[j]=new g(j,1,!1,b,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(b){var j=b.replace(x,v);m[j]=new g(j,1,!1,b,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(b){var j=b.replace(x,v);m[j]=new g(j,1,!1,b,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(b){m[b]=new g(b,1,!1,b.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(b){m[b]=new g(b,1,!1,b.toLowerCase(),null,!0,!0)});function w(b,j,$,Y){var te=m.hasOwnProperty(j)?m[j]:null;(te!==null?te.type!==0:Y||!(2<j.length)||j[0]!=="o"&&j[0]!=="O"||j[1]!=="n"&&j[1]!=="N")&&(y(j,$,te,Y)&&($=null),Y||te===null?p(j)&&($===null?b.removeAttribute(j):b.setAttribute(j,""+$)):te.mustUseProperty?b[te.propertyName]=$===null?te.type===3?!1:"":$:(j=te.attributeName,Y=te.attributeNamespace,$===null?b.removeAttribute(j):(te=te.type,$=te===3||te===4&&$===!0?"":""+$,Y?b.setAttributeNS(Y,j,$):b.setAttribute(j,$))))}var _=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),P=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),H=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),S=Symbol.iterator;function C(b){return b===null||typeof b!="object"?null:(b=S&&b[S]||b["@@iterator"],typeof b=="function"?b:null)}var D=Object.assign,q;function M(b){if(q===void 0)try{throw Error()}catch($){var j=$.stack.trim().match(/\n( *(at )?)/);q=j&&j[1]||""}return`
`+q+b}var G=!1;function X(b,j){if(!b||G)return"";G=!0;var $=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(j)if(j=function(){throw Error()},Object.defineProperty(j.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(j,[])}catch(et){var Y=et}Reflect.construct(b,[],j)}else{try{j.call()}catch(et){Y=et}b.call(j.prototype)}else{try{throw Error()}catch(et){Y=et}b()}}catch(et){if(et&&Y&&typeof et.stack=="string"){for(var te=et.stack.split(`
`),oe=Y.stack.split(`
`),ve=te.length-1,Pe=oe.length-1;1<=ve&&0<=Pe&&te[ve]!==oe[Pe];)Pe--;for(;1<=ve&&0<=Pe;ve--,Pe--)if(te[ve]!==oe[Pe]){if(ve!==1||Pe!==1)do if(ve--,Pe--,0>Pe||te[ve]!==oe[Pe]){var Fe=`
`+te[ve].replace(" at new "," at ");return b.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",b.displayName)),Fe}while(1<=ve&&0<=Pe);break}}}finally{G=!1,Error.prepareStackTrace=$}return(b=b?b.displayName||b.name:"")?M(b):""}function re(b){switch(b.tag){case 5:return M(b.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return b=X(b.type,!1),b;case 11:return b=X(b.type.render,!1),b;case 1:return b=X(b.type,!0),b;default:return""}}function V(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case B:return"Fragment";case P:return"Portal";case I:return"Profiler";case T:return"StrictMode";case O:return"Suspense";case L:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case H:return(b.displayName||"Context")+".Consumer";case U:return(b._context.displayName||"Context")+".Provider";case z:var j=b.render;return b=b.displayName,b||(b=j.displayName||j.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case E:return j=b.displayName||null,j!==null?j:V(b.type)||"Memo";case k:j=b._payload,b=b._init;try{return V(b(j))}catch{}}return null}function J(b){var j=b.type;switch(b.tag){case 24:return"Cache";case 9:return(j.displayName||"Context")+".Consumer";case 10:return(j._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=j.render,b=b.displayName||b.name||"",j.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return j;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(j);case 8:return j===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof j=="function")return j.displayName||j.name||null;if(typeof j=="string")return j}return null}function W(b){switch(typeof b){case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function F(b){var j=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(j==="checkbox"||j==="radio")}function Q(b){var j=F(b)?"checked":"value",$=Object.getOwnPropertyDescriptor(b.constructor.prototype,j),Y=""+b[j];if(!b.hasOwnProperty(j)&&typeof $<"u"&&typeof $.get=="function"&&typeof $.set=="function"){var te=$.get,oe=$.set;return Object.defineProperty(b,j,{configurable:!0,get:function(){return te.call(this)},set:function(ve){Y=""+ve,oe.call(this,ve)}}),Object.defineProperty(b,j,{enumerable:$.enumerable}),{getValue:function(){return Y},setValue:function(ve){Y=""+ve},stopTracking:function(){b._valueTracker=null,delete b[j]}}}}function ne(b){b._valueTracker||(b._valueTracker=Q(b))}function ie(b){if(!b)return!1;var j=b._valueTracker;if(!j)return!0;var $=j.getValue(),Y="";return b&&(Y=F(b)?b.checked?"true":"false":b.value),b=Y,b!==$?(j.setValue(b),!0):!1}function ce(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}function de(b,j){var $=j.checked;return D({},j,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:$??b._wrapperState.initialChecked})}function le(b,j){var $=j.defaultValue==null?"":j.defaultValue,Y=j.checked!=null?j.checked:j.defaultChecked;$=W(j.value!=null?j.value:$),b._wrapperState={initialChecked:Y,initialValue:$,controlled:j.type==="checkbox"||j.type==="radio"?j.checked!=null:j.value!=null}}function _e(b,j){j=j.checked,j!=null&&w(b,"checked",j,!1)}function ue(b,j){_e(b,j);var $=W(j.value),Y=j.type;if($!=null)Y==="number"?($===0&&b.value===""||b.value!=$)&&(b.value=""+$):b.value!==""+$&&(b.value=""+$);else if(Y==="submit"||Y==="reset"){b.removeAttribute("value");return}j.hasOwnProperty("value")?me(b,j.type,$):j.hasOwnProperty("defaultValue")&&me(b,j.type,W(j.defaultValue)),j.checked==null&&j.defaultChecked!=null&&(b.defaultChecked=!!j.defaultChecked)}function pe(b,j,$){if(j.hasOwnProperty("value")||j.hasOwnProperty("defaultValue")){var Y=j.type;if(!(Y!=="submit"&&Y!=="reset"||j.value!==void 0&&j.value!==null))return;j=""+b._wrapperState.initialValue,$||j===b.value||(b.value=j),b.defaultValue=j}$=b.name,$!==""&&(b.name=""),b.defaultChecked=!!b._wrapperState.initialChecked,$!==""&&(b.name=$)}function me(b,j,$){(j!=="number"||ce(b.ownerDocument)!==b)&&($==null?b.defaultValue=""+b._wrapperState.initialValue:b.defaultValue!==""+$&&(b.defaultValue=""+$))}var Ce=Array.isArray;function fe(b,j,$,Y){if(b=b.options,j){j={};for(var te=0;te<$.length;te++)j["$"+$[te]]=!0;for($=0;$<b.length;$++)te=j.hasOwnProperty("$"+b[$].value),b[$].selected!==te&&(b[$].selected=te),te&&Y&&(b[$].defaultSelected=!0)}else{for($=""+W($),j=null,te=0;te<b.length;te++){if(b[te].value===$){b[te].selected=!0,Y&&(b[te].defaultSelected=!0);return}j!==null||b[te].disabled||(j=b[te])}j!==null&&(j.selected=!0)}}function xe(b,j){if(j.dangerouslySetInnerHTML!=null)throw Error(t(91));return D({},j,{value:void 0,defaultValue:void 0,children:""+b._wrapperState.initialValue})}function je(b,j){var $=j.value;if($==null){if($=j.children,j=j.defaultValue,$!=null){if(j!=null)throw Error(t(92));if(Ce($)){if(1<$.length)throw Error(t(93));$=$[0]}j=$}j==null&&(j=""),$=j}b._wrapperState={initialValue:W($)}}function Oe(b,j){var $=W(j.value),Y=W(j.defaultValue);$!=null&&($=""+$,$!==b.value&&(b.value=$),j.defaultValue==null&&b.defaultValue!==$&&(b.defaultValue=$)),Y!=null&&(b.defaultValue=""+Y)}function Ie(b){var j=b.textContent;j===b._wrapperState.initialValue&&j!==""&&j!==null&&(b.value=j)}function Le(b){switch(b){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function He(b,j){return b==null||b==="http://www.w3.org/1999/xhtml"?Le(j):b==="http://www.w3.org/2000/svg"&&j==="foreignObject"?"http://www.w3.org/1999/xhtml":b}var Qe,Je=(function(b){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(j,$,Y,te){MSApp.execUnsafeLocalFunction(function(){return b(j,$,Y,te)})}:b})(function(b,j){if(b.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in b)b.innerHTML=j;else{for(Qe=Qe||document.createElement("div"),Qe.innerHTML="<svg>"+j.valueOf().toString()+"</svg>",j=Qe.firstChild;b.firstChild;)b.removeChild(b.firstChild);for(;j.firstChild;)b.appendChild(j.firstChild)}});function ct(b,j){if(j){var $=b.firstChild;if($&&$===b.lastChild&&$.nodeType===3){$.nodeValue=j;return}}b.textContent=j}var it={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},At=["Webkit","ms","Moz","O"];Object.keys(it).forEach(function(b){At.forEach(function(j){j=j+b.charAt(0).toUpperCase()+b.substring(1),it[j]=it[b]})});function pt(b,j,$){return j==null||typeof j=="boolean"||j===""?"":$||typeof j!="number"||j===0||it.hasOwnProperty(b)&&it[b]?(""+j).trim():j+"px"}function nt(b,j){b=b.style;for(var $ in j)if(j.hasOwnProperty($)){var Y=$.indexOf("--")===0,te=pt($,j[$],Y);$==="float"&&($="cssFloat"),Y?b.setProperty($,te):b[$]=te}}var ht=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function St(b,j){if(j){if(ht[b]&&(j.children!=null||j.dangerouslySetInnerHTML!=null))throw Error(t(137,b));if(j.dangerouslySetInnerHTML!=null){if(j.children!=null)throw Error(t(60));if(typeof j.dangerouslySetInnerHTML!="object"||!("__html"in j.dangerouslySetInnerHTML))throw Error(t(61))}if(j.style!=null&&typeof j.style!="object")throw Error(t(62))}}function ot(b,j){if(b.indexOf("-")===-1)return typeof j.is=="string";switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bt=null;function Tt(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var xt=null,Kt=null,Pt=null;function wt(b){if(b=Bd(b)){if(typeof xt!="function")throw Error(t(280));var j=b.stateNode;j&&(j=zh(j),xt(b.stateNode,b.type,j))}}function ar(b){Kt?Pt?Pt.push(b):Pt=[b]:Kt=b}function qr(){if(Kt){var b=Kt,j=Pt;if(Pt=Kt=null,wt(b),j)for(b=0;b<j.length;b++)wt(j[b])}}function Ft(b,j){return b(j)}function Er(){}var zr=!1;function vt(b,j,$){if(zr)return b(j,$);zr=!0;try{return Ft(b,j,$)}finally{zr=!1,(Kt!==null||Pt!==null)&&(Er(),qr())}}function Tr(b,j){var $=b.stateNode;if($===null)return null;var Y=zh($);if(Y===null)return null;$=Y[j];e:switch(j){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(Y=!Y.disabled)||(b=b.type,Y=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!Y;break e;default:b=!1}if(b)return null;if($&&typeof $!="function")throw Error(t(231,j,typeof $));return $}var Wr=!1;if(c)try{var Qt={};Object.defineProperty(Qt,"passive",{get:function(){Wr=!0}}),window.addEventListener("test",Qt,Qt),window.removeEventListener("test",Qt,Qt)}catch{Wr=!1}function Me(b,j,$,Y,te,oe,ve,Pe,Fe){var et=Array.prototype.slice.call(arguments,3);try{j.apply($,et)}catch(_t){this.onError(_t)}}var Be=!1,Ze=null,yt=!1,Gt=null,kt={onError:function(b){Be=!0,Ze=b}};function sr(b,j,$,Y,te,oe,ve,Pe,Fe){Be=!1,Ze=null,Me.apply(kt,arguments)}function Ut(b,j,$,Y,te,oe,ve,Pe,Fe){if(sr.apply(this,arguments),Be){if(Be){var et=Ze;Be=!1,Ze=null}else throw Error(t(198));yt||(yt=!0,Gt=et)}}function It(b){var j=b,$=b;if(b.alternate)for(;j.return;)j=j.return;else{b=j;do j=b,(j.flags&4098)!==0&&($=j.return),b=j.return;while(b)}return j.tag===3?$:null}function or(b){if(b.tag===13){var j=b.memoizedState;if(j===null&&(b=b.alternate,b!==null&&(j=b.memoizedState)),j!==null)return j.dehydrated}return null}function Zt(b){if(It(b)!==b)throw Error(t(188))}function Nr(b){var j=b.alternate;if(!j){if(j=It(b),j===null)throw Error(t(188));return j!==b?null:b}for(var $=b,Y=j;;){var te=$.return;if(te===null)break;var oe=te.alternate;if(oe===null){if(Y=te.return,Y!==null){$=Y;continue}break}if(te.child===oe.child){for(oe=te.child;oe;){if(oe===$)return Zt(te),b;if(oe===Y)return Zt(te),j;oe=oe.sibling}throw Error(t(188))}if($.return!==Y.return)$=te,Y=oe;else{for(var ve=!1,Pe=te.child;Pe;){if(Pe===$){ve=!0,$=te,Y=oe;break}if(Pe===Y){ve=!0,Y=te,$=oe;break}Pe=Pe.sibling}if(!ve){for(Pe=oe.child;Pe;){if(Pe===$){ve=!0,$=oe,Y=te;break}if(Pe===Y){ve=!0,Y=oe,$=te;break}Pe=Pe.sibling}if(!ve)throw Error(t(189))}}if($.alternate!==Y)throw Error(t(190))}if($.tag!==3)throw Error(t(188));return $.stateNode.current===$?b:j}function an(b){return b=Nr(b),b!==null?Jr(b):null}function Jr(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var j=Jr(b);if(j!==null)return j;b=b.sibling}return null}var Tn=r.unstable_scheduleCallback,Pn=r.unstable_cancelCallback,js=r.unstable_shouldYield,Ee=r.unstable_requestPaint,ze=r.unstable_now,dt=r.unstable_getCurrentPriorityLevel,mt=r.unstable_ImmediatePriority,Rt=r.unstable_UserBlockingPriority,jt=r.unstable_NormalPriority,Ct=r.unstable_LowPriority,Dr=r.unstable_IdlePriority,wr=null,yr=null;function dr(b){if(yr&&typeof yr.onCommitFiberRoot=="function")try{yr.onCommitFiberRoot(wr,b,void 0,(b.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:Rr,Yr=Math.log,ln=Math.LN2;function Rr(b){return b>>>=0,b===0?32:31-(Yr(b)/ln|0)|0}var Fn=64,_n=4194304;function cs(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function ui(b,j){var $=b.pendingLanes;if($===0)return 0;var Y=0,te=b.suspendedLanes,oe=b.pingedLanes,ve=$&268435455;if(ve!==0){var Pe=ve&~te;Pe!==0?Y=cs(Pe):(oe&=ve,oe!==0&&(Y=cs(oe)))}else ve=$&~te,ve!==0?Y=cs(ve):oe!==0&&(Y=cs(oe));if(Y===0)return 0;if(j!==0&&j!==Y&&(j&te)===0&&(te=Y&-Y,oe=j&-j,te>=oe||te===16&&(oe&4194240)!==0))return j;if((Y&4)!==0&&(Y|=$&16),j=b.entangledLanes,j!==0)for(b=b.entanglements,j&=Y;0<j;)$=31-br(j),te=1<<$,Y|=b[$],j&=~te;return Y}function Ys(b,j){switch(b){case 1:case 2:case 4:return j+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return j+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bn(b,j){for(var $=b.suspendedLanes,Y=b.pingedLanes,te=b.expirationTimes,oe=b.pendingLanes;0<oe;){var ve=31-br(oe),Pe=1<<ve,Fe=te[ve];Fe===-1?((Pe&$)===0||(Pe&Y)!==0)&&(te[ve]=Ys(Pe,j)):Fe<=j&&(b.expiredLanes|=Pe),oe&=~Pe}}function ha(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function en(){var b=Fn;return Fn<<=1,(Fn&4194240)===0&&(Fn=64),b}function Gr(b){for(var j=[],$=0;31>$;$++)j.push(b);return j}function Ha(b,j,$){b.pendingLanes|=j,j!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,j=31-br(j),b[j]=$}function fa(b,j){var $=b.pendingLanes&~j;b.pendingLanes=j,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=j,b.mutableReadLanes&=j,b.entangledLanes&=j,j=b.entanglements;var Y=b.eventTimes;for(b=b.expirationTimes;0<$;){var te=31-br($),oe=1<<te;j[te]=0,Y[te]=-1,b[te]=-1,$&=~oe}}function Co(b,j){var $=b.entangledLanes|=j;for(b=b.entanglements;$;){var Y=31-br($),te=1<<Y;te&j|b[Y]&j&&(b[Y]|=j),$&=~te}}var Pr=0;function Ca(b){return b&=-b,1<b?4<b?(b&268435455)!==0?16:536870912:4:1}var Aa,Ao,Pl,Eo,di,Ol=!1,Qs=[],Ni=null,Zs=null,Ea=null,tl=new Map,xr=new Map,hi=[],Gm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sp(b,j){switch(b){case"focusin":case"focusout":Ni=null;break;case"dragenter":case"dragleave":Zs=null;break;case"mouseover":case"mouseout":Ea=null;break;case"pointerover":case"pointerout":tl.delete(j.pointerId);break;case"gotpointercapture":case"lostpointercapture":xr.delete(j.pointerId)}}function Hi(b,j,$,Y,te,oe){return b===null||b.nativeEvent!==oe?(b={blockedOn:j,domEventName:$,eventSystemFlags:Y,nativeEvent:oe,targetContainers:[te]},j!==null&&(j=Bd(j),j!==null&&Ao(j)),b):(b.eventSystemFlags|=Y,j=b.targetContainers,te!==null&&j.indexOf(te)===-1&&j.push(te),b)}function Ml(b,j,$,Y,te){switch(j){case"focusin":return Ni=Hi(Ni,b,j,$,Y,te),!0;case"dragenter":return Zs=Hi(Zs,b,j,$,Y,te),!0;case"mouseover":return Ea=Hi(Ea,b,j,$,Y,te),!0;case"pointerover":var oe=te.pointerId;return tl.set(oe,Hi(tl.get(oe)||null,b,j,$,Y,te)),!0;case"gotpointercapture":return oe=te.pointerId,xr.set(oe,Hi(xr.get(oe)||null,b,j,$,Y,te)),!0}return!1}function ap(b){var j=Tc(b.target);if(j!==null){var $=It(j);if($!==null){if(j=$.tag,j===13){if(j=or($),j!==null){b.blockedOn=j,di(b.priority,function(){Pl($)});return}}else if(j===3&&$.stateNode.current.memoizedState.isDehydrated){b.blockedOn=$.tag===3?$.stateNode.containerInfo:null;return}}}b.blockedOn=null}function Nd(b){if(b.blockedOn!==null)return!1;for(var j=b.targetContainers;0<j.length;){var $=cu(b.domEventName,b.eventSystemFlags,j[0],b.nativeEvent);if($===null){$=b.nativeEvent;var Y=new $.constructor($.type,$);Bt=Y,$.target.dispatchEvent(Y),Bt=null}else return j=Bd($),j!==null&&Ao(j),b.blockedOn=$,!1;j.shift()}return!0}function ou(b,j,$){Nd(b)&&$.delete(j)}function Ch(){Ol=!1,Ni!==null&&Nd(Ni)&&(Ni=null),Zs!==null&&Nd(Zs)&&(Zs=null),Ea!==null&&Nd(Ea)&&(Ea=null),tl.forEach(ou),xr.forEach(ou)}function To(b,j){b.blockedOn===j&&(b.blockedOn=null,Ol||(Ol=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ch)))}function lu(b){function j(te){return To(te,b)}if(0<Qs.length){To(Qs[0],b);for(var $=1;$<Qs.length;$++){var Y=Qs[$];Y.blockedOn===b&&(Y.blockedOn=null)}}for(Ni!==null&&To(Ni,b),Zs!==null&&To(Zs,b),Ea!==null&&To(Ea,b),tl.forEach(j),xr.forEach(j),$=0;$<hi.length;$++)Y=hi[$],Y.blockedOn===b&&(Y.blockedOn=null);for(;0<hi.length&&($=hi[0],$.blockedOn===null);)ap($),$.blockedOn===null&&hi.shift()}var ki=_.ReactCurrentBatchConfig,kd=!0;function Ah(b,j,$,Y){var te=Pr,oe=ki.transition;ki.transition=null;try{Pr=1,Sd(b,j,$,Y)}finally{Pr=te,ki.transition=oe}}function Eh(b,j,$,Y){var te=Pr,oe=ki.transition;ki.transition=null;try{Pr=4,Sd(b,j,$,Y)}finally{Pr=te,ki.transition=oe}}function Sd(b,j,$,Y){if(kd){var te=cu(b,j,$,Y);if(te===null)Bh(b,j,Y,so,$),sp(b,Y);else if(Ml(te,b,j,$,Y))Y.stopPropagation();else if(sp(b,Y),j&4&&-1<Gm.indexOf(b)){for(;te!==null;){var oe=Bd(te);if(oe!==null&&Aa(oe),oe=cu(b,j,$,Y),oe===null&&Bh(b,j,Y,so,$),oe===te)break;te=oe}te!==null&&Y.stopPropagation()}else Bh(b,j,Y,null,$)}}var so=null;function cu(b,j,$,Y){if(so=null,b=Tt(Y),b=Tc(b),b!==null)if(j=It(b),j===null)b=null;else if($=j.tag,$===13){if(b=or(j),b!==null)return b;b=null}else if($===3){if(j.stateNode.current.memoizedState.isDehydrated)return j.tag===3?j.stateNode.containerInfo:null;b=null}else j!==b&&(b=null);return so=b,null}function uu(b){switch(b){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dt()){case mt:return 1;case Rt:return 4;case jt:case Ct:return 16;case Dr:return 536870912;default:return 16}default:return 16}}var ao=null,Il=null,bc=null;function Th(){if(bc)return bc;var b,j=Il,$=j.length,Y,te="value"in ao?ao.value:ao.textContent,oe=te.length;for(b=0;b<$&&j[b]===te[b];b++);var ve=$-b;for(Y=1;Y<=ve&&j[$-Y]===te[oe-Y];Y++);return bc=te.slice(b,1<Y?1-Y:void 0)}function du(b){var j=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&j===13&&(b=13)):b=j,b===10&&(b=13),32<=b||b===13?b:0}function io(){return!0}function rl(){return!1}function Va(b){function j($,Y,te,oe,ve){this._reactName=$,this._targetInst=te,this.type=Y,this.nativeEvent=oe,this.target=ve,this.currentTarget=null;for(var Pe in b)b.hasOwnProperty(Pe)&&($=b[Pe],this[Pe]=$?$(oe):oe[Pe]);return this.isDefaultPrevented=(oe.defaultPrevented!=null?oe.defaultPrevented:oe.returnValue===!1)?io:rl,this.isPropagationStopped=rl,this}return D(j.prototype,{preventDefault:function(){this.defaultPrevented=!0;var $=this.nativeEvent;$&&($.preventDefault?$.preventDefault():typeof $.returnValue!="unknown"&&($.returnValue=!1),this.isDefaultPrevented=io)},stopPropagation:function(){var $=this.nativeEvent;$&&($.stopPropagation?$.stopPropagation():typeof $.cancelBubble!="unknown"&&($.cancelBubble=!0),this.isPropagationStopped=io)},persist:function(){},isPersistent:io}),j}var oo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cd=Va(oo),ee=D({},oo,{view:0,detail:0}),ye=Va(ee),Te,Re,Ue,lt=D({},ee,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hu,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==Ue&&(Ue&&b.type==="mousemove"?(Te=b.screenX-Ue.screenX,Re=b.screenY-Ue.screenY):Re=Te=0,Ue=b),Te)},movementY:function(b){return"movementY"in b?b.movementY:Re}}),gt=Va(lt),Xt=D({},lt,{dataTransfer:0}),lr=Va(Xt),Or=D({},ee,{relatedTarget:0}),Lr=Va(Or),cn=D({},oo,{animationName:0,elapsedTime:0,pseudoElement:0}),ns=Va(cn),Ls=D({},oo,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),$n=Va(Ls),Js=D({},oo,{data:0}),Ns=Va(Js),Ta={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Po={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ll(b){var j=this.nativeEvent;return j.getModifierState?j.getModifierState(b):(b=Po[b])?!!j[b]:!1}function hu(){return Ll}var Ad=D({},ee,{key:function(b){if(b.key){var j=Ta[b.key]||b.key;if(j!=="Unidentified")return j}return b.type==="keypress"?(b=du(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?Rl[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hu,charCode:function(b){return b.type==="keypress"?du(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?du(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),wc=Va(Ad),fu=D({},lt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_c=Va(fu),jc=D({},ee,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hu}),Pa=Va(jc),pu=D({},oo,{propertyName:0,elapsedTime:0,pseudoElement:0}),mu=Va(pu),Ph=D({},lt,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),Oh=Va(Ph),fi=[9,13,27,32],Oo=c&&"CompositionEvent"in window,nl=null;c&&"documentMode"in document&&(nl=document.documentMode);var ip=c&&"TextEvent"in window&&!nl,Vi=c&&(!Oo||nl&&8<nl&&11>=nl),Nc=" ",Ed=!1;function Td(b,j){switch(b){case"keyup":return fi.indexOf(j.keyCode)!==-1;case"keydown":return j.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dl(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var lo=!1;function Wi(b,j){switch(b){case"compositionend":return Dl(j);case"keypress":return j.which!==32?null:(Ed=!0,Nc);case"textInput":return b=j.data,b===Nc&&Ed?null:b;default:return null}}function Ki(b,j){if(lo)return b==="compositionend"||!Oo&&Td(b,j)?(b=Th(),bc=Il=ao=null,lo=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(j.ctrlKey||j.altKey||j.metaKey)||j.ctrlKey&&j.altKey){if(j.char&&1<j.char.length)return j.char;if(j.which)return String.fromCharCode(j.which)}return null;case"compositionend":return Vi&&j.locale!=="ko"?null:j.data;default:return null}}var kc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sl(b){var j=b&&b.nodeName&&b.nodeName.toLowerCase();return j==="input"?!!kc[b.type]:j==="textarea"}function Fl(b,j,$,Y){ar(Y),j=dp(j,"onChange"),0<j.length&&($=new Cd("onChange","change",null,$,Y),b.push({event:$,listeners:j}))}var Bl=null,al=null;function ks(b){Dh(b,0)}function gu(b){var j=Su(b);if(ie(j))return b}function il(b,j){if(b==="change")return j}var Mo=!1;if(c){var yu;if(c){var xu="oninput"in document;if(!xu){var Pd=document.createElement("div");Pd.setAttribute("oninput","return;"),xu=typeof Pd.oninput=="function"}yu=xu}else yu=!1;Mo=yu&&(!document.documentMode||9<document.documentMode)}function Od(){Bl&&(Bl.detachEvent("onpropertychange",$l),al=Bl=null)}function $l(b){if(b.propertyName==="value"&&gu(al)){var j=[];Fl(j,al,b,Tt(b)),vt(ks,j)}}function Sc(b,j,$){b==="focusin"?(Od(),Bl=j,al=$,Bl.attachEvent("onpropertychange",$l)):b==="focusout"&&Od()}function Cc(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return gu(al)}function vu(b,j){if(b==="click")return gu(j)}function Ac(b,j){if(b==="input"||b==="change")return gu(j)}function bu(b,j){return b===j&&(b!==0||1/b===1/j)||b!==b&&j!==j}var us=typeof Object.is=="function"?Object.is:bu;function Si(b,j){if(us(b,j))return!0;if(typeof b!="object"||b===null||typeof j!="object"||j===null)return!1;var $=Object.keys(b),Y=Object.keys(j);if($.length!==Y.length)return!1;for(Y=0;Y<$.length;Y++){var te=$[Y];if(!u.call(j,te)||!us(b[te],j[te]))return!1}return!0}function fn(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Nn(b,j){var $=fn(b);b=0;for(var Y;$;){if($.nodeType===3){if(Y=b+$.textContent.length,b<=j&&Y>=j)return{node:$,offset:j-b};b=Y}e:{for(;$;){if($.nextSibling){$=$.nextSibling;break e}$=$.parentNode}$=void 0}$=fn($)}}function ds(b,j){return b&&j?b===j?!0:b&&b.nodeType===3?!1:j&&j.nodeType===3?ds(b,j.parentNode):"contains"in b?b.contains(j):b.compareDocumentPosition?!!(b.compareDocumentPosition(j)&16):!1:!1}function Ds(){for(var b=window,j=ce();j instanceof b.HTMLIFrameElement;){try{var $=typeof j.contentWindow.location.href=="string"}catch{$=!1}if($)b=j.contentWindow;else break;j=ce(b.document)}return j}function Io(b){var j=b&&b.nodeName&&b.nodeName.toLowerCase();return j&&(j==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||j==="textarea"||b.contentEditable==="true")}function Mh(b){var j=Ds(),$=b.focusedElem,Y=b.selectionRange;if(j!==$&&$&&$.ownerDocument&&ds($.ownerDocument.documentElement,$)){if(Y!==null&&Io($)){if(j=Y.start,b=Y.end,b===void 0&&(b=j),"selectionStart"in $)$.selectionStart=j,$.selectionEnd=Math.min(b,$.value.length);else if(b=(j=$.ownerDocument||document)&&j.defaultView||window,b.getSelection){b=b.getSelection();var te=$.textContent.length,oe=Math.min(Y.start,te);Y=Y.end===void 0?oe:Math.min(Y.end,te),!b.extend&&oe>Y&&(te=Y,Y=oe,oe=te),te=Nn($,oe);var ve=Nn($,Y);te&&ve&&(b.rangeCount!==1||b.anchorNode!==te.node||b.anchorOffset!==te.offset||b.focusNode!==ve.node||b.focusOffset!==ve.offset)&&(j=j.createRange(),j.setStart(te.node,te.offset),b.removeAllRanges(),oe>Y?(b.addRange(j),b.extend(ve.node,ve.offset)):(j.setEnd(ve.node,ve.offset),b.addRange(j)))}}for(j=[],b=$;b=b.parentNode;)b.nodeType===1&&j.push({element:b,left:b.scrollLeft,top:b.scrollTop});for(typeof $.focus=="function"&&$.focus(),$=0;$<j.length;$++)b=j[$],b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}var Md=c&&"documentMode"in document&&11>=document.documentMode,ql=null,op=null,Id=null,lp=!1;function Xm(b,j,$){var Y=$.window===$?$.document:$.nodeType===9?$:$.ownerDocument;lp||ql==null||ql!==ce(Y)||(Y=ql,"selectionStart"in Y&&Io(Y)?Y={start:Y.selectionStart,end:Y.selectionEnd}:(Y=(Y.ownerDocument&&Y.ownerDocument.defaultView||window).getSelection(),Y={anchorNode:Y.anchorNode,anchorOffset:Y.anchorOffset,focusNode:Y.focusNode,focusOffset:Y.focusOffset}),Id&&Si(Id,Y)||(Id=Y,Y=dp(op,"onSelect"),0<Y.length&&(j=new Cd("onSelect","select",null,j,$),b.push({event:j,listeners:Y}),j.target=ql)))}function Ih(b,j){var $={};return $[b.toLowerCase()]=j.toLowerCase(),$["Webkit"+b]="webkit"+j,$["Moz"+b]="moz"+j,$}var wu={animationend:Ih("Animation","AnimationEnd"),animationiteration:Ih("Animation","AnimationIteration"),animationstart:Ih("Animation","AnimationStart"),transitionend:Ih("Transition","TransitionEnd")},_u={},Ym={};c&&(Ym=document.createElement("div").style,"AnimationEvent"in window||(delete wu.animationend.animation,delete wu.animationiteration.animation,delete wu.animationstart.animation),"TransitionEvent"in window||delete wu.transitionend.transition);function Rh(b){if(_u[b])return _u[b];if(!wu[b])return b;var j=wu[b],$;for($ in j)if(j.hasOwnProperty($)&&$ in Ym)return _u[b]=j[$];return b}var Qm=Rh("animationend"),Zm=Rh("animationiteration"),Jm=Rh("animationstart"),e0=Rh("transitionend"),t0=new Map,r0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ol(b,j){t0.set(b,j),i(j,[b])}for(var Rd=0;Rd<r0.length;Rd++){var pi=r0[Rd],co=pi.toLowerCase(),cp=pi[0].toUpperCase()+pi.slice(1);ol(co,"on"+cp)}ol(Qm,"onAnimationEnd"),ol(Zm,"onAnimationIteration"),ol(Jm,"onAnimationStart"),ol("dblclick","onDoubleClick"),ol("focusin","onFocus"),ol("focusout","onBlur"),ol(e0,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ec));function Lh(b,j,$){var Y=b.type||"unknown-event";b.currentTarget=$,Ut(Y,j,void 0,b),b.currentTarget=null}function Dh(b,j){j=(j&4)!==0;for(var $=0;$<b.length;$++){var Y=b[$],te=Y.event;Y=Y.listeners;e:{var oe=void 0;if(j)for(var ve=Y.length-1;0<=ve;ve--){var Pe=Y[ve],Fe=Pe.instance,et=Pe.currentTarget;if(Pe=Pe.listener,Fe!==oe&&te.isPropagationStopped())break e;Lh(te,Pe,et),oe=Fe}else for(ve=0;ve<Y.length;ve++){if(Pe=Y[ve],Fe=Pe.instance,et=Pe.currentTarget,Pe=Pe.listener,Fe!==oe&&te.isPropagationStopped())break e;Lh(te,Pe,et),oe=Fe}}}if(yt)throw b=Gt,yt=!1,Gt=null,b}function On(b,j){var $=j[Ai];$===void 0&&($=j[Ai]=new Set);var Y=b+"__bubble";$.has(Y)||(Fh(j,b,2,!1),$.add(Y))}function up(b,j,$){var Y=0;j&&(Y|=4),Fh($,b,Y,j)}var Ld="_reactListening"+Math.random().toString(36).slice(2);function ju(b){if(!b[Ld]){b[Ld]=!0,n.forEach(function($){$!=="selectionchange"&&(vy.has($)||up($,!1,b),up($,!0,b))});var j=b.nodeType===9?b:b.ownerDocument;j===null||j[Ld]||(j[Ld]=!0,up("selectionchange",!1,j))}}function Fh(b,j,$,Y){switch(uu(j)){case 1:var te=Ah;break;case 4:te=Eh;break;default:te=Sd}$=te.bind(null,j,$,b),te=void 0,!Wr||j!=="touchstart"&&j!=="touchmove"&&j!=="wheel"||(te=!0),Y?te!==void 0?b.addEventListener(j,$,{capture:!0,passive:te}):b.addEventListener(j,$,!0):te!==void 0?b.addEventListener(j,$,{passive:te}):b.addEventListener(j,$,!1)}function Bh(b,j,$,Y,te){var oe=Y;if((j&1)===0&&(j&2)===0&&Y!==null)e:for(;;){if(Y===null)return;var ve=Y.tag;if(ve===3||ve===4){var Pe=Y.stateNode.containerInfo;if(Pe===te||Pe.nodeType===8&&Pe.parentNode===te)break;if(ve===4)for(ve=Y.return;ve!==null;){var Fe=ve.tag;if((Fe===3||Fe===4)&&(Fe=ve.stateNode.containerInfo,Fe===te||Fe.nodeType===8&&Fe.parentNode===te))return;ve=ve.return}for(;Pe!==null;){if(ve=Tc(Pe),ve===null)return;if(Fe=ve.tag,Fe===5||Fe===6){Y=oe=ve;continue e}Pe=Pe.parentNode}}Y=Y.return}vt(function(){var et=oe,_t=Tt($),Nt=[];e:{var bt=t0.get(b);if(bt!==void 0){var $t=Cd,Jt=b;switch(b){case"keypress":if(du($)===0)break e;case"keydown":case"keyup":$t=wc;break;case"focusin":Jt="focus",$t=Lr;break;case"focusout":Jt="blur",$t=Lr;break;case"beforeblur":case"afterblur":$t=Lr;break;case"click":if($.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$t=gt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$t=lr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$t=Pa;break;case Qm:case Zm:case Jm:$t=ns;break;case e0:$t=mu;break;case"scroll":$t=ye;break;case"wheel":$t=Oh;break;case"copy":case"cut":case"paste":$t=$n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$t=_c}var ir=(j&4)!==0,ra=!ir&&b==="scroll",Ke=ir?bt!==null?bt+"Capture":null:bt;ir=[];for(var qe=et,Ye;qe!==null;){Ye=qe;var Et=Ye.stateNode;if(Ye.tag===5&&Et!==null&&(Ye=Et,Ke!==null&&(Et=Tr(qe,Ke),Et!=null&&ir.push($h(qe,Et,Ye)))),ra)break;qe=qe.return}0<ir.length&&(bt=new $t(bt,Jt,null,$,_t),Nt.push({event:bt,listeners:ir}))}}if((j&7)===0){e:{if(bt=b==="mouseover"||b==="pointerover",$t=b==="mouseout"||b==="pointerout",bt&&$!==Bt&&(Jt=$.relatedTarget||$.fromElement)&&(Tc(Jt)||Jt[Wa]))break e;if(($t||bt)&&(bt=_t.window===_t?_t:(bt=_t.ownerDocument)?bt.defaultView||bt.parentWindow:window,$t?(Jt=$.relatedTarget||$.toElement,$t=et,Jt=Jt?Tc(Jt):null,Jt!==null&&(ra=It(Jt),Jt!==ra||Jt.tag!==5&&Jt.tag!==6)&&(Jt=null)):($t=null,Jt=et),$t!==Jt)){if(ir=gt,Et="onMouseLeave",Ke="onMouseEnter",qe="mouse",(b==="pointerout"||b==="pointerover")&&(ir=_c,Et="onPointerLeave",Ke="onPointerEnter",qe="pointer"),ra=$t==null?bt:Su($t),Ye=Jt==null?bt:Su(Jt),bt=new ir(Et,qe+"leave",$t,$,_t),bt.target=ra,bt.relatedTarget=Ye,Et=null,Tc(_t)===et&&(ir=new ir(Ke,qe+"enter",Jt,$,_t),ir.target=Ye,ir.relatedTarget=ra,Et=ir),ra=Et,$t&&Jt)t:{for(ir=$t,Ke=Jt,qe=0,Ye=ir;Ye;Ye=Nu(Ye))qe++;for(Ye=0,Et=Ke;Et;Et=Nu(Et))Ye++;for(;0<qe-Ye;)ir=Nu(ir),qe--;for(;0<Ye-qe;)Ke=Nu(Ke),Ye--;for(;qe--;){if(ir===Ke||Ke!==null&&ir===Ke.alternate)break t;ir=Nu(ir),Ke=Nu(Ke)}ir=null}else ir=null;$t!==null&&by(Nt,bt,$t,ir,!1),Jt!==null&&ra!==null&&by(Nt,ra,Jt,ir,!0)}}e:{if(bt=et?Su(et):window,$t=bt.nodeName&&bt.nodeName.toLowerCase(),$t==="select"||$t==="input"&&bt.type==="file")var hr=il;else if(sl(bt))if(Mo)hr=Ac;else{hr=Cc;var _r=Sc}else($t=bt.nodeName)&&$t.toLowerCase()==="input"&&(bt.type==="checkbox"||bt.type==="radio")&&(hr=vu);if(hr&&(hr=hr(b,et))){Fl(Nt,hr,$,_t);break e}_r&&_r(b,bt,et),b==="focusout"&&(_r=bt._wrapperState)&&_r.controlled&&bt.type==="number"&&me(bt,"number",bt.value)}switch(_r=et?Su(et):window,b){case"focusin":(sl(_r)||_r.contentEditable==="true")&&(ql=_r,op=et,Id=null);break;case"focusout":Id=op=ql=null;break;case"mousedown":lp=!0;break;case"contextmenu":case"mouseup":case"dragend":lp=!1,Xm(Nt,$,_t);break;case"selectionchange":if(Md)break;case"keydown":case"keyup":Xm(Nt,$,_t)}var jr;if(Oo)e:{switch(b){case"compositionstart":var Mr="onCompositionStart";break e;case"compositionend":Mr="onCompositionEnd";break e;case"compositionupdate":Mr="onCompositionUpdate";break e}Mr=void 0}else lo?Td(b,$)&&(Mr="onCompositionEnd"):b==="keydown"&&$.keyCode===229&&(Mr="onCompositionStart");Mr&&(Vi&&$.locale!=="ko"&&(lo||Mr!=="onCompositionStart"?Mr==="onCompositionEnd"&&lo&&(jr=Th()):(ao=_t,Il="value"in ao?ao.value:ao.textContent,lo=!0)),_r=dp(et,Mr),0<_r.length&&(Mr=new Ns(Mr,b,null,$,_t),Nt.push({event:Mr,listeners:_r}),jr?Mr.data=jr:(jr=Dl($),jr!==null&&(Mr.data=jr)))),(jr=ip?Wi(b,$):Ki(b,$))&&(et=dp(et,"onBeforeInput"),0<et.length&&(_t=new Ns("onBeforeInput","beforeinput",null,$,_t),Nt.push({event:_t,listeners:et}),_t.data=jr))}Dh(Nt,j)})}function $h(b,j,$){return{instance:b,listener:j,currentTarget:$}}function dp(b,j){for(var $=j+"Capture",Y=[];b!==null;){var te=b,oe=te.stateNode;te.tag===5&&oe!==null&&(te=oe,oe=Tr(b,$),oe!=null&&Y.unshift($h(b,oe,te)),oe=Tr(b,j),oe!=null&&Y.push($h(b,oe,te))),b=b.return}return Y}function Nu(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5);return b||null}function by(b,j,$,Y,te){for(var oe=j._reactName,ve=[];$!==null&&$!==Y;){var Pe=$,Fe=Pe.alternate,et=Pe.stateNode;if(Fe!==null&&Fe===Y)break;Pe.tag===5&&et!==null&&(Pe=et,te?(Fe=Tr($,oe),Fe!=null&&ve.unshift($h($,Fe,Pe))):te||(Fe=Tr($,oe),Fe!=null&&ve.push($h($,Fe,Pe)))),$=$.return}ve.length!==0&&b.push({event:j,listeners:ve})}var V1=/\r\n?/g,W1=/\u0000|\uFFFD/g;function wy(b){return(typeof b=="string"?b:""+b).replace(V1,`
`).replace(W1,"")}function hp(b,j,$){if(j=wy(j),wy(b)!==j&&$)throw Error(t(425))}function Dd(){}var qh=null,ku=null;function n0(b,j){return b==="textarea"||b==="noscript"||typeof j.children=="string"||typeof j.children=="number"||typeof j.dangerouslySetInnerHTML=="object"&&j.dangerouslySetInnerHTML!==null&&j.dangerouslySetInnerHTML.__html!=null}var s0=typeof setTimeout=="function"?setTimeout:void 0,_y=typeof clearTimeout=="function"?clearTimeout:void 0,jy=typeof Promise=="function"?Promise:void 0,K1=typeof queueMicrotask=="function"?queueMicrotask:typeof jy<"u"?function(b){return jy.resolve(null).then(b).catch(G1)}:s0;function G1(b){setTimeout(function(){throw b})}function a0(b,j){var $=j,Y=0;do{var te=$.nextSibling;if(b.removeChild($),te&&te.nodeType===8)if($=te.data,$==="/$"){if(Y===0){b.removeChild(te),lu(j);return}Y--}else $!=="$"&&$!=="$?"&&$!=="$!"||Y++;$=te}while($);lu(j)}function mi(b){for(;b!=null;b=b.nextSibling){var j=b.nodeType;if(j===1||j===3)break;if(j===8){if(j=b.data,j==="$"||j==="$!"||j==="$?")break;if(j==="/$")return null}}return b}function uo(b){b=b.previousSibling;for(var j=0;b;){if(b.nodeType===8){var $=b.data;if($==="$"||$==="$!"||$==="$?"){if(j===0)return b;j--}else $==="/$"&&j++}b=b.previousSibling}return null}var Ci=Math.random().toString(36).slice(2),ll="__reactFiber$"+Ci,Fd="__reactProps$"+Ci,Wa="__reactContainer$"+Ci,Ai="__reactEvents$"+Ci,X1="__reactListeners$"+Ci,Y1="__reactHandles$"+Ci;function Tc(b){var j=b[ll];if(j)return j;for(var $=b.parentNode;$;){if(j=$[Wa]||$[ll]){if($=j.alternate,j.child!==null||$!==null&&$.child!==null)for(b=uo(b);b!==null;){if($=b[ll])return $;b=uo(b)}return j}b=$,$=b.parentNode}return null}function Bd(b){return b=b[ll]||b[Wa],!b||b.tag!==5&&b.tag!==6&&b.tag!==13&&b.tag!==3?null:b}function Su(b){if(b.tag===5||b.tag===6)return b.stateNode;throw Error(t(33))}function zh(b){return b[Fd]||null}var i0=[],zl=-1;function Ro(b){return{current:b}}function jn(b){0>zl||(b.current=i0[zl],i0[zl]=null,zl--)}function kn(b,j){zl++,i0[zl]=b.current,b.current=j}var Pc={},Oa=Ro(Pc),Ei=Ro(!1),Cu=Pc;function $d(b,j){var $=b.type.contextTypes;if(!$)return Pc;var Y=b.stateNode;if(Y&&Y.__reactInternalMemoizedUnmaskedChildContext===j)return Y.__reactInternalMemoizedMaskedChildContext;var te={},oe;for(oe in $)te[oe]=j[oe];return Y&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=j,b.__reactInternalMemoizedMaskedChildContext=te),te}function Ti(b){return b=b.childContextTypes,b!=null}function fp(){jn(Ei),jn(Oa)}function Ny(b,j,$){if(Oa.current!==Pc)throw Error(t(168));kn(Oa,j),kn(Ei,$)}function o0(b,j,$){var Y=b.stateNode;if(j=j.childContextTypes,typeof Y.getChildContext!="function")return $;Y=Y.getChildContext();for(var te in Y)if(!(te in j))throw Error(t(108,J(b)||"Unknown",te));return D({},$,Y)}function Au(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||Pc,Cu=Oa.current,kn(Oa,b),kn(Ei,Ei.current),!0}function ky(b,j,$){var Y=b.stateNode;if(!Y)throw Error(t(169));$?(b=o0(b,j,Cu),Y.__reactInternalMemoizedMergedChildContext=b,jn(Ei),jn(Oa),kn(Oa,b)):jn(Ei),kn(Ei,$)}var Ul=null,Uh=!1,K=!1;function Z(b){Ul===null?Ul=[b]:Ul.push(b)}function ae(b){Uh=!0,Z(b)}function he(){if(!K&&Ul!==null){K=!0;var b=0,j=Pr;try{var $=Ul;for(Pr=1;b<$.length;b++){var Y=$[b];do Y=Y(!0);while(Y!==null)}Ul=null,Uh=!1}catch(te){throw Ul!==null&&(Ul=Ul.slice(b+1)),Tn(mt,he),te}finally{Pr=j,K=!1}}return null}var ge=[],be=0,we=null,Ne=0,ke=[],Se=0,De=null,We=1,Ae="";function $e(b,j){ge[be++]=Ne,ge[be++]=we,we=b,Ne=j}function Ve(b,j,$){ke[Se++]=We,ke[Se++]=Ae,ke[Se++]=De,De=b;var Y=We;b=Ae;var te=32-br(Y)-1;Y&=~(1<<te),$+=1;var oe=32-br(j)+te;if(30<oe){var ve=te-te%5;oe=(Y&(1<<ve)-1).toString(32),Y>>=ve,te-=ve,We=1<<32-br(j)+te|$<<te|Y,Ae=oe+b}else We=1<<oe|$<<te|Y,Ae=b}function at(b){b.return!==null&&($e(b,1),Ve(b,1,0))}function Ge(b){for(;b===we;)we=ge[--be],ge[be]=null,Ne=ge[--be],ge[be]=null;for(;b===De;)De=ke[--Se],ke[Se]=null,Ae=ke[--Se],ke[Se]=null,We=ke[--Se],ke[Se]=null}var tt=null,st=null,ut=!1,ft=null;function cr(b,j){var $=fl(5,null,null,0);$.elementType="DELETED",$.stateNode=j,$.return=b,j=b.deletions,j===null?(b.deletions=[$],b.flags|=16):j.push($)}function qt(b,j){switch(b.tag){case 5:var $=b.type;return j=j.nodeType!==1||$.toLowerCase()!==j.nodeName.toLowerCase()?null:j,j!==null?(b.stateNode=j,tt=b,st=mi(j.firstChild),!0):!1;case 6:return j=b.pendingProps===""||j.nodeType!==3?null:j,j!==null?(b.stateNode=j,tt=b,st=null,!0):!1;case 13:return j=j.nodeType!==8?null:j,j!==null?($=De!==null?{id:We,overflow:Ae}:null,b.memoizedState={dehydrated:j,treeContext:$,retryLane:1073741824},$=fl(18,null,null,0),$.stateNode=j,$.return=b,b.child=$,tt=b,st=null,!0):!1;default:return!1}}function Fr(b){return(b.mode&1)!==0&&(b.flags&128)===0}function Yt(b){if(ut){var j=st;if(j){var $=j;if(!qt(b,j)){if(Fr(b))throw Error(t(418));j=mi($.nextSibling);var Y=tt;j&&qt(b,j)?cr(Y,$):(b.flags=b.flags&-4097|2,ut=!1,tt=b)}}else{if(Fr(b))throw Error(t(418));b.flags=b.flags&-4097|2,ut=!1,tt=b}}}function tn(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;tt=b}function hs(b){if(b!==tt)return!1;if(!ut)return tn(b),ut=!0,!1;var j;if((j=b.tag!==3)&&!(j=b.tag!==5)&&(j=b.type,j=j!=="head"&&j!=="body"&&!n0(b.type,b.memoizedProps)),j&&(j=st)){if(Fr(b))throw Ur(),Error(t(418));for(;j;)cr(b,j),j=mi(j.nextSibling)}if(tn(b),b.tag===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));e:{for(b=b.nextSibling,j=0;b;){if(b.nodeType===8){var $=b.data;if($==="/$"){if(j===0){st=mi(b.nextSibling);break e}j--}else $!=="$"&&$!=="$!"&&$!=="$?"||j++}b=b.nextSibling}st=null}}else st=tt?mi(b.stateNode.nextSibling):null;return!0}function Ur(){for(var b=st;b;)b=mi(b.nextSibling)}function zt(){st=tt=null,ut=!1}function Ot(b){ft===null?ft=[b]:ft.push(b)}var Ss=_.ReactCurrentBatchConfig;function Ar(b,j,$){if(b=$.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if($._owner){if($=$._owner,$){if($.tag!==1)throw Error(t(309));var Y=$.stateNode}if(!Y)throw Error(t(147,b));var te=Y,oe=""+b;return j!==null&&j.ref!==null&&typeof j.ref=="function"&&j.ref._stringRef===oe?j.ref:(j=function(ve){var Pe=te.refs;ve===null?delete Pe[oe]:Pe[oe]=ve},j._stringRef=oe,j)}if(typeof b!="string")throw Error(t(284));if(!$._owner)throw Error(t(290,b))}return b}function Qr(b,j){throw b=Object.prototype.toString.call(j),Error(t(31,b==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":b))}function qn(b){var j=b._init;return j(b._payload)}function pa(b){function j(Ke,qe){if(b){var Ye=Ke.deletions;Ye===null?(Ke.deletions=[qe],Ke.flags|=16):Ye.push(qe)}}function $(Ke,qe){if(!b)return null;for(;qe!==null;)j(Ke,qe),qe=qe.sibling;return null}function Y(Ke,qe){for(Ke=new Map;qe!==null;)qe.key!==null?Ke.set(qe.key,qe):Ke.set(qe.index,qe),qe=qe.sibling;return Ke}function te(Ke,qe){return Ke=Yd(Ke,qe),Ke.index=0,Ke.sibling=null,Ke}function oe(Ke,qe,Ye){return Ke.index=Ye,b?(Ye=Ke.alternate,Ye!==null?(Ye=Ye.index,Ye<qe?(Ke.flags|=2,qe):Ye):(Ke.flags|=2,qe)):(Ke.flags|=1048576,qe)}function ve(Ke){return b&&Ke.alternate===null&&(Ke.flags|=2),Ke}function Pe(Ke,qe,Ye,Et){return qe===null||qe.tag!==6?(qe=k2(Ye,Ke.mode,Et),qe.return=Ke,qe):(qe=te(qe,Ye),qe.return=Ke,qe)}function Fe(Ke,qe,Ye,Et){var hr=Ye.type;return hr===B?_t(Ke,qe,Ye.props.children,Et,Ye.key):qe!==null&&(qe.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===k&&qn(hr)===qe.type)?(Et=te(qe,Ye.props),Et.ref=Ar(Ke,qe,Ye),Et.return=Ke,Et):(Et=Vy(Ye.type,Ye.key,Ye.props,null,Ke.mode,Et),Et.ref=Ar(Ke,qe,Ye),Et.return=Ke,Et)}function et(Ke,qe,Ye,Et){return qe===null||qe.tag!==4||qe.stateNode.containerInfo!==Ye.containerInfo||qe.stateNode.implementation!==Ye.implementation?(qe=S2(Ye,Ke.mode,Et),qe.return=Ke,qe):(qe=te(qe,Ye.children||[]),qe.return=Ke,qe)}function _t(Ke,qe,Ye,Et,hr){return qe===null||qe.tag!==7?(qe=Qh(Ye,Ke.mode,Et,hr),qe.return=Ke,qe):(qe=te(qe,Ye),qe.return=Ke,qe)}function Nt(Ke,qe,Ye){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return qe=k2(""+qe,Ke.mode,Ye),qe.return=Ke,qe;if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case A:return Ye=Vy(qe.type,qe.key,qe.props,null,Ke.mode,Ye),Ye.ref=Ar(Ke,null,qe),Ye.return=Ke,Ye;case P:return qe=S2(qe,Ke.mode,Ye),qe.return=Ke,qe;case k:var Et=qe._init;return Nt(Ke,Et(qe._payload),Ye)}if(Ce(qe)||C(qe))return qe=Qh(qe,Ke.mode,Ye,null),qe.return=Ke,qe;Qr(Ke,qe)}return null}function bt(Ke,qe,Ye,Et){var hr=qe!==null?qe.key:null;if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number")return hr!==null?null:Pe(Ke,qe,""+Ye,Et);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case A:return Ye.key===hr?Fe(Ke,qe,Ye,Et):null;case P:return Ye.key===hr?et(Ke,qe,Ye,Et):null;case k:return hr=Ye._init,bt(Ke,qe,hr(Ye._payload),Et)}if(Ce(Ye)||C(Ye))return hr!==null?null:_t(Ke,qe,Ye,Et,null);Qr(Ke,Ye)}return null}function $t(Ke,qe,Ye,Et,hr){if(typeof Et=="string"&&Et!==""||typeof Et=="number")return Ke=Ke.get(Ye)||null,Pe(qe,Ke,""+Et,hr);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case A:return Ke=Ke.get(Et.key===null?Ye:Et.key)||null,Fe(qe,Ke,Et,hr);case P:return Ke=Ke.get(Et.key===null?Ye:Et.key)||null,et(qe,Ke,Et,hr);case k:var _r=Et._init;return $t(Ke,qe,Ye,_r(Et._payload),hr)}if(Ce(Et)||C(Et))return Ke=Ke.get(Ye)||null,_t(qe,Ke,Et,hr,null);Qr(qe,Et)}return null}function Jt(Ke,qe,Ye,Et){for(var hr=null,_r=null,jr=qe,Mr=qe=0,Qa=null;jr!==null&&Mr<Ye.length;Mr++){jr.index>Mr?(Qa=jr,jr=null):Qa=jr.sibling;var vn=bt(Ke,jr,Ye[Mr],Et);if(vn===null){jr===null&&(jr=Qa);break}b&&jr&&vn.alternate===null&&j(Ke,jr),qe=oe(vn,qe,Mr),_r===null?hr=vn:_r.sibling=vn,_r=vn,jr=Qa}if(Mr===Ye.length)return $(Ke,jr),ut&&$e(Ke,Mr),hr;if(jr===null){for(;Mr<Ye.length;Mr++)jr=Nt(Ke,Ye[Mr],Et),jr!==null&&(qe=oe(jr,qe,Mr),_r===null?hr=jr:_r.sibling=jr,_r=jr);return ut&&$e(Ke,Mr),hr}for(jr=Y(Ke,jr);Mr<Ye.length;Mr++)Qa=$t(jr,Ke,Mr,Ye[Mr],Et),Qa!==null&&(b&&Qa.alternate!==null&&jr.delete(Qa.key===null?Mr:Qa.key),qe=oe(Qa,qe,Mr),_r===null?hr=Qa:_r.sibling=Qa,_r=Qa);return b&&jr.forEach(function(Qd){return j(Ke,Qd)}),ut&&$e(Ke,Mr),hr}function ir(Ke,qe,Ye,Et){var hr=C(Ye);if(typeof hr!="function")throw Error(t(150));if(Ye=hr.call(Ye),Ye==null)throw Error(t(151));for(var _r=hr=null,jr=qe,Mr=qe=0,Qa=null,vn=Ye.next();jr!==null&&!vn.done;Mr++,vn=Ye.next()){jr.index>Mr?(Qa=jr,jr=null):Qa=jr.sibling;var Qd=bt(Ke,jr,vn.value,Et);if(Qd===null){jr===null&&(jr=Qa);break}b&&jr&&Qd.alternate===null&&j(Ke,jr),qe=oe(Qd,qe,Mr),_r===null?hr=Qd:_r.sibling=Qd,_r=Qd,jr=Qa}if(vn.done)return $(Ke,jr),ut&&$e(Ke,Mr),hr;if(jr===null){for(;!vn.done;Mr++,vn=Ye.next())vn=Nt(Ke,vn.value,Et),vn!==null&&(qe=oe(vn,qe,Mr),_r===null?hr=vn:_r.sibling=vn,_r=vn);return ut&&$e(Ke,Mr),hr}for(jr=Y(Ke,jr);!vn.done;Mr++,vn=Ye.next())vn=$t(jr,Ke,Mr,vn.value,Et),vn!==null&&(b&&vn.alternate!==null&&jr.delete(vn.key===null?Mr:vn.key),qe=oe(vn,qe,Mr),_r===null?hr=vn:_r.sibling=vn,_r=vn);return b&&jr.forEach(function(c$){return j(Ke,c$)}),ut&&$e(Ke,Mr),hr}function ra(Ke,qe,Ye,Et){if(typeof Ye=="object"&&Ye!==null&&Ye.type===B&&Ye.key===null&&(Ye=Ye.props.children),typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case A:e:{for(var hr=Ye.key,_r=qe;_r!==null;){if(_r.key===hr){if(hr=Ye.type,hr===B){if(_r.tag===7){$(Ke,_r.sibling),qe=te(_r,Ye.props.children),qe.return=Ke,Ke=qe;break e}}else if(_r.elementType===hr||typeof hr=="object"&&hr!==null&&hr.$$typeof===k&&qn(hr)===_r.type){$(Ke,_r.sibling),qe=te(_r,Ye.props),qe.ref=Ar(Ke,_r,Ye),qe.return=Ke,Ke=qe;break e}$(Ke,_r);break}else j(Ke,_r);_r=_r.sibling}Ye.type===B?(qe=Qh(Ye.props.children,Ke.mode,Et,Ye.key),qe.return=Ke,Ke=qe):(Et=Vy(Ye.type,Ye.key,Ye.props,null,Ke.mode,Et),Et.ref=Ar(Ke,qe,Ye),Et.return=Ke,Ke=Et)}return ve(Ke);case P:e:{for(_r=Ye.key;qe!==null;){if(qe.key===_r)if(qe.tag===4&&qe.stateNode.containerInfo===Ye.containerInfo&&qe.stateNode.implementation===Ye.implementation){$(Ke,qe.sibling),qe=te(qe,Ye.children||[]),qe.return=Ke,Ke=qe;break e}else{$(Ke,qe);break}else j(Ke,qe);qe=qe.sibling}qe=S2(Ye,Ke.mode,Et),qe.return=Ke,Ke=qe}return ve(Ke);case k:return _r=Ye._init,ra(Ke,qe,_r(Ye._payload),Et)}if(Ce(Ye))return Jt(Ke,qe,Ye,Et);if(C(Ye))return ir(Ke,qe,Ye,Et);Qr(Ke,Ye)}return typeof Ye=="string"&&Ye!==""||typeof Ye=="number"?(Ye=""+Ye,qe!==null&&qe.tag===6?($(Ke,qe.sibling),qe=te(qe,Ye),qe.return=Ke,Ke=qe):($(Ke,qe),qe=k2(Ye,Ke.mode,Et),qe.return=Ke,Ke=qe),ve(Ke)):$(Ke,qe)}return ra}var Fs=pa(!0),ss=pa(!1),ea=Ro(null),ma=null,Xn=null,sn=null;function pn(){sn=Xn=ma=null}function Yn(b){var j=ea.current;jn(ea),b._currentValue=j}function mn(b,j,$){for(;b!==null;){var Y=b.alternate;if((b.childLanes&j)!==j?(b.childLanes|=j,Y!==null&&(Y.childLanes|=j)):Y!==null&&(Y.childLanes&j)!==j&&(Y.childLanes|=j),b===$)break;b=b.return}}function fs(b,j){ma=b,sn=Xn=null,b=b.dependencies,b!==null&&b.firstContext!==null&&((b.lanes&j)!==0&&(fo=!0),b.firstContext=null)}function ps(b){var j=b._currentValue;if(sn!==b)if(b={context:b,memoizedValue:j,next:null},Xn===null){if(ma===null)throw Error(t(308));Xn=b,ma.dependencies={lanes:0,firstContext:b}}else Xn=Xn.next=b;return j}var Mn=null;function Ka(b){Mn===null?Mn=[b]:Mn.push(b)}function Sn(b,j,$,Y){var te=j.interleaved;return te===null?($.next=$,Ka(j)):($.next=te.next,te.next=$),j.interleaved=$,In(b,Y)}function In(b,j){b.lanes|=j;var $=b.alternate;for($!==null&&($.lanes|=j),$=b,b=b.return;b!==null;)b.childLanes|=j,$=b.alternate,$!==null&&($.childLanes|=j),$=b,b=b.return;return $.tag===3?$.stateNode:null}var Bs=!1;function Ma(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pi(b,j){b=b.updateQueue,j.updateQueue===b&&(j.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function Cs(b,j){return{eventTime:b,lane:j,tag:0,payload:null,callback:null,next:null}}function As(b,j,$){var Y=b.updateQueue;if(Y===null)return null;if(Y=Y.shared,(gn&2)!==0){var te=Y.pending;return te===null?j.next=j:(j.next=te.next,te.next=j),Y.pending=j,In(b,$)}return te=Y.interleaved,te===null?(j.next=j,Ka(Y)):(j.next=te.next,te.next=j),Y.interleaved=j,In(b,$)}function Ga(b,j,$){if(j=j.updateQueue,j!==null&&(j=j.shared,($&4194240)!==0)){var Y=j.lanes;Y&=b.pendingLanes,$|=Y,j.lanes=$,Co(b,$)}}function Rn(b,j){var $=b.updateQueue,Y=b.alternate;if(Y!==null&&(Y=Y.updateQueue,$===Y)){var te=null,oe=null;if($=$.firstBaseUpdate,$!==null){do{var ve={eventTime:$.eventTime,lane:$.lane,tag:$.tag,payload:$.payload,callback:$.callback,next:null};oe===null?te=oe=ve:oe=oe.next=ve,$=$.next}while($!==null);oe===null?te=oe=j:oe=oe.next=j}else te=oe=j;$={baseState:Y.baseState,firstBaseUpdate:te,lastBaseUpdate:oe,shared:Y.shared,effects:Y.effects},b.updateQueue=$;return}b=$.lastBaseUpdate,b===null?$.firstBaseUpdate=j:b.next=j,$.lastBaseUpdate=j}function Xa(b,j,$,Y){var te=b.updateQueue;Bs=!1;var oe=te.firstBaseUpdate,ve=te.lastBaseUpdate,Pe=te.shared.pending;if(Pe!==null){te.shared.pending=null;var Fe=Pe,et=Fe.next;Fe.next=null,ve===null?oe=et:ve.next=et,ve=Fe;var _t=b.alternate;_t!==null&&(_t=_t.updateQueue,Pe=_t.lastBaseUpdate,Pe!==ve&&(Pe===null?_t.firstBaseUpdate=et:Pe.next=et,_t.lastBaseUpdate=Fe))}if(oe!==null){var Nt=te.baseState;ve=0,_t=et=Fe=null,Pe=oe;do{var bt=Pe.lane,$t=Pe.eventTime;if((Y&bt)===bt){_t!==null&&(_t=_t.next={eventTime:$t,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var Jt=b,ir=Pe;switch(bt=j,$t=$,ir.tag){case 1:if(Jt=ir.payload,typeof Jt=="function"){Nt=Jt.call($t,Nt,bt);break e}Nt=Jt;break e;case 3:Jt.flags=Jt.flags&-65537|128;case 0:if(Jt=ir.payload,bt=typeof Jt=="function"?Jt.call($t,Nt,bt):Jt,bt==null)break e;Nt=D({},Nt,bt);break e;case 2:Bs=!0}}Pe.callback!==null&&Pe.lane!==0&&(b.flags|=64,bt=te.effects,bt===null?te.effects=[Pe]:bt.push(Pe))}else $t={eventTime:$t,lane:bt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},_t===null?(et=_t=$t,Fe=Nt):_t=_t.next=$t,ve|=bt;if(Pe=Pe.next,Pe===null){if(Pe=te.shared.pending,Pe===null)break;bt=Pe,Pe=bt.next,bt.next=null,te.lastBaseUpdate=bt,te.shared.pending=null}}while(!0);if(_t===null&&(Fe=Nt),te.baseState=Fe,te.firstBaseUpdate=et,te.lastBaseUpdate=_t,j=te.shared.interleaved,j!==null){te=j;do ve|=te.lane,te=te.next;while(te!==j)}else oe===null&&(te.shared.lanes=0);Kh|=ve,b.lanes=ve,b.memoizedState=Nt}}function ho(b,j,$){if(b=j.effects,j.effects=null,b!==null)for(j=0;j<b.length;j++){var Y=b[j],te=Y.callback;if(te!==null){if(Y.callback=null,Y=$,typeof te!="function")throw Error(t(191,te));te.call(Y)}}}var Lo={},ga=Ro(Lo),Es=Ro(Lo),Oc=Ro(Lo);function Hl(b){if(b===Lo)throw Error(t(174));return b}function qd(b,j){switch(kn(Oc,j),kn(Es,b),kn(ga,Lo),b=j.nodeType,b){case 9:case 11:j=(j=j.documentElement)?j.namespaceURI:He(null,"");break;default:b=b===8?j.parentNode:j,j=b.namespaceURI||null,b=b.tagName,j=He(j,b)}jn(ga),kn(ga,j)}function cl(){jn(ga),jn(Es),jn(Oc)}function Sy(b){Hl(Oc.current);var j=Hl(ga.current),$=He(j,b.type);j!==$&&(kn(Es,b),kn(ga,$))}function l0(b){Es.current===b&&(jn(ga),jn(Es))}var Vn=Ro(0);function Do(b){for(var j=b;j!==null;){if(j.tag===13){var $=j.memoizedState;if($!==null&&($=$.dehydrated,$===null||$.data==="$?"||$.data==="$!"))return j}else if(j.tag===19&&j.memoizedProps.revealOrder!==void 0){if((j.flags&128)!==0)return j}else if(j.child!==null){j.child.return=j,j=j.child;continue}if(j===b)break;for(;j.sibling===null;){if(j.return===null||j.return===b)return null;j=j.return}j.sibling.return=j.return,j=j.sibling}return null}var c0=[];function u0(){for(var b=0;b<c0.length;b++)c0[b]._workInProgressVersionPrimary=null;c0.length=0}var pp=_.ReactCurrentDispatcher,mp=_.ReactCurrentBatchConfig,ul=0,Qn=null,$s=null,Ts=null,zd=!1,Vl=!1,Ud=0,Q1=0;function ta(){throw Error(t(321))}function gp(b,j){if(j===null)return!1;for(var $=0;$<j.length&&$<b.length;$++)if(!us(b[$],j[$]))return!1;return!0}function Hh(b,j,$,Y,te,oe){if(ul=oe,Qn=j,j.memoizedState=null,j.updateQueue=null,j.lanes=0,pp.current=b===null||b.memoizedState===null?RB:LB,b=$(Y,te),Vl){oe=0;do{if(Vl=!1,Ud=0,25<=oe)throw Error(t(301));oe+=1,Ts=$s=null,j.updateQueue=null,pp.current=DB,b=$(Y,te)}while(Vl)}if(pp.current=Py,j=$s!==null&&$s.next!==null,ul=0,Ts=$s=Qn=null,zd=!1,j)throw Error(t(300));return b}function dl(){var b=Ud!==0;return Ud=0,b}function Fo(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ts===null?Qn.memoizedState=Ts=b:Ts=Ts.next=b,Ts}function Gi(){if($s===null){var b=Qn.alternate;b=b!==null?b.memoizedState:null}else b=$s.next;var j=Ts===null?Qn.memoizedState:Ts.next;if(j!==null)Ts=j,$s=b;else{if(b===null)throw Error(t(310));$s=b,b={memoizedState:$s.memoizedState,baseState:$s.baseState,baseQueue:$s.baseQueue,queue:$s.queue,next:null},Ts===null?Qn.memoizedState=Ts=b:Ts=Ts.next=b}return Ts}function Vh(b,j){return typeof j=="function"?j(b):j}function yp(b){var j=Gi(),$=j.queue;if($===null)throw Error(t(311));$.lastRenderedReducer=b;var Y=$s,te=Y.baseQueue,oe=$.pending;if(oe!==null){if(te!==null){var ve=te.next;te.next=oe.next,oe.next=ve}Y.baseQueue=te=oe,$.pending=null}if(te!==null){oe=te.next,Y=Y.baseState;var Pe=ve=null,Fe=null,et=oe;do{var _t=et.lane;if((ul&_t)===_t)Fe!==null&&(Fe=Fe.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),Y=et.hasEagerState?et.eagerState:b(Y,et.action);else{var Nt={lane:_t,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};Fe===null?(Pe=Fe=Nt,ve=Y):Fe=Fe.next=Nt,Qn.lanes|=_t,Kh|=_t}et=et.next}while(et!==null&&et!==oe);Fe===null?ve=Y:Fe.next=Pe,us(Y,j.memoizedState)||(fo=!0),j.memoizedState=Y,j.baseState=ve,j.baseQueue=Fe,$.lastRenderedState=Y}if(b=$.interleaved,b!==null){te=b;do oe=te.lane,Qn.lanes|=oe,Kh|=oe,te=te.next;while(te!==b)}else te===null&&($.lanes=0);return[j.memoizedState,$.dispatch]}function Mc(b){var j=Gi(),$=j.queue;if($===null)throw Error(t(311));$.lastRenderedReducer=b;var Y=$.dispatch,te=$.pending,oe=j.memoizedState;if(te!==null){$.pending=null;var ve=te=te.next;do oe=b(oe,ve.action),ve=ve.next;while(ve!==te);us(oe,j.memoizedState)||(fo=!0),j.memoizedState=oe,j.baseQueue===null&&(j.baseState=oe),$.lastRenderedState=oe}return[oe,Y]}function Cy(){}function d0(b,j){var $=Qn,Y=Gi(),te=j(),oe=!us(Y.memoizedState,te);if(oe&&(Y.memoizedState=te,fo=!0),Y=Y.queue,bp(Ey.bind(null,$,Y,b),[b]),Y.getSnapshot!==j||oe||Ts!==null&&Ts.memoizedState.tag&1){if($.flags|=2048,Xi(9,h0.bind(null,$,Y,te,j),void 0,null),Ya===null)throw Error(t(349));(ul&30)!==0||Ay($,j,te)}return te}function Ay(b,j,$){b.flags|=16384,b={getSnapshot:j,value:$},j=Qn.updateQueue,j===null?(j={lastEffect:null,stores:null},Qn.updateQueue=j,j.stores=[b]):($=j.stores,$===null?j.stores=[b]:$.push(b))}function h0(b,j,$,Y){j.value=$,j.getSnapshot=Y,Hd(j)&&xp(b)}function Ey(b,j,$){return $(function(){Hd(j)&&xp(b)})}function Hd(b){var j=b.getSnapshot;b=b.value;try{var $=j();return!us(b,$)}catch{return!0}}function xp(b){var j=In(b,1);j!==null&&Yl(j,b,1,-1)}function Wh(b){var j=Fo();return typeof b=="function"&&(b=b()),j.memoizedState=j.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:b},j.queue=b,b=b.dispatch=IB.bind(null,Qn,b),[j.memoizedState,b]}function Xi(b,j,$,Y){return b={tag:b,create:j,destroy:$,deps:Y,next:null},j=Qn.updateQueue,j===null?(j={lastEffect:null,stores:null},Qn.updateQueue=j,j.lastEffect=b.next=b):($=j.lastEffect,$===null?j.lastEffect=b.next=b:(Y=$.next,$.next=b,b.next=Y,j.lastEffect=b)),b}function Wl(){return Gi().memoizedState}function Bo(b,j,$,Y){var te=Fo();Qn.flags|=b,te.memoizedState=Xi(1|j,$,void 0,Y===void 0?null:Y)}function Eu(b,j,$,Y){var te=Gi();Y=Y===void 0?null:Y;var oe=void 0;if($s!==null){var ve=$s.memoizedState;if(oe=ve.destroy,Y!==null&&gp(Y,ve.deps)){te.memoizedState=Xi(j,$,oe,Y);return}}Qn.flags|=b,te.memoizedState=Xi(1|j,$,oe,Y)}function vp(b,j){return Bo(8390656,8,b,j)}function bp(b,j){return Eu(2048,8,b,j)}function Ty(b,j){return Eu(4,2,b,j)}function wp(b,j){return Eu(4,4,b,j)}function _p(b,j){if(typeof j=="function")return b=b(),j(b),function(){j(null)};if(j!=null)return b=b(),j.current=b,function(){j.current=null}}function w6(b,j,$){return $=$!=null?$.concat([b]):null,Eu(4,4,_p.bind(null,j,b),$)}function Z1(){}function _6(b,j){var $=Gi();j=j===void 0?null:j;var Y=$.memoizedState;return Y!==null&&j!==null&&gp(j,Y[1])?Y[0]:($.memoizedState=[b,j],b)}function j6(b,j){var $=Gi();j=j===void 0?null:j;var Y=$.memoizedState;return Y!==null&&j!==null&&gp(j,Y[1])?Y[0]:(b=b(),$.memoizedState=[b,j],b)}function N6(b,j,$){return(ul&21)===0?(b.baseState&&(b.baseState=!1,fo=!0),b.memoizedState=$):(us($,j)||($=en(),Qn.lanes|=$,Kh|=$,b.baseState=!0),j)}function OB(b,j){var $=Pr;Pr=$!==0&&4>$?$:4,b(!0);var Y=mp.transition;mp.transition={};try{b(!1),j()}finally{Pr=$,mp.transition=Y}}function k6(){return Gi().memoizedState}function MB(b,j,$){var Y=Gd(b);if($={lane:Y,action:$,hasEagerState:!1,eagerState:null,next:null},S6(b))C6(j,$);else if($=Sn(b,j,$,Y),$!==null){var te=Qi();Yl($,b,Y,te),A6($,j,Y)}}function IB(b,j,$){var Y=Gd(b),te={lane:Y,action:$,hasEagerState:!1,eagerState:null,next:null};if(S6(b))C6(j,te);else{var oe=b.alternate;if(b.lanes===0&&(oe===null||oe.lanes===0)&&(oe=j.lastRenderedReducer,oe!==null))try{var ve=j.lastRenderedState,Pe=oe(ve,$);if(te.hasEagerState=!0,te.eagerState=Pe,us(Pe,ve)){var Fe=j.interleaved;Fe===null?(te.next=te,Ka(j)):(te.next=Fe.next,Fe.next=te),j.interleaved=te;return}}catch{}$=Sn(b,j,te,Y),$!==null&&(te=Qi(),Yl($,b,Y,te),A6($,j,Y))}}function S6(b){var j=b.alternate;return b===Qn||j!==null&&j===Qn}function C6(b,j){Vl=zd=!0;var $=b.pending;$===null?j.next=j:(j.next=$.next,$.next=j),b.pending=j}function A6(b,j,$){if(($&4194240)!==0){var Y=j.lanes;Y&=b.pendingLanes,$|=Y,j.lanes=$,Co(b,$)}}var Py={readContext:ps,useCallback:ta,useContext:ta,useEffect:ta,useImperativeHandle:ta,useInsertionEffect:ta,useLayoutEffect:ta,useMemo:ta,useReducer:ta,useRef:ta,useState:ta,useDebugValue:ta,useDeferredValue:ta,useTransition:ta,useMutableSource:ta,useSyncExternalStore:ta,useId:ta,unstable_isNewReconciler:!1},RB={readContext:ps,useCallback:function(b,j){return Fo().memoizedState=[b,j===void 0?null:j],b},useContext:ps,useEffect:vp,useImperativeHandle:function(b,j,$){return $=$!=null?$.concat([b]):null,Bo(4194308,4,_p.bind(null,j,b),$)},useLayoutEffect:function(b,j){return Bo(4194308,4,b,j)},useInsertionEffect:function(b,j){return Bo(4,2,b,j)},useMemo:function(b,j){var $=Fo();return j=j===void 0?null:j,b=b(),$.memoizedState=[b,j],b},useReducer:function(b,j,$){var Y=Fo();return j=$!==void 0?$(j):j,Y.memoizedState=Y.baseState=j,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:j},Y.queue=b,b=b.dispatch=MB.bind(null,Qn,b),[Y.memoizedState,b]},useRef:function(b){var j=Fo();return b={current:b},j.memoizedState=b},useState:Wh,useDebugValue:Z1,useDeferredValue:function(b){return Fo().memoizedState=b},useTransition:function(){var b=Wh(!1),j=b[0];return b=OB.bind(null,b[1]),Fo().memoizedState=b,[j,b]},useMutableSource:function(){},useSyncExternalStore:function(b,j,$){var Y=Qn,te=Fo();if(ut){if($===void 0)throw Error(t(407));$=$()}else{if($=j(),Ya===null)throw Error(t(349));(ul&30)!==0||Ay(Y,j,$)}te.memoizedState=$;var oe={value:$,getSnapshot:j};return te.queue=oe,vp(Ey.bind(null,Y,oe,b),[b]),Y.flags|=2048,Xi(9,h0.bind(null,Y,oe,$,j),void 0,null),$},useId:function(){var b=Fo(),j=Ya.identifierPrefix;if(ut){var $=Ae,Y=We;$=(Y&~(1<<32-br(Y)-1)).toString(32)+$,j=":"+j+"R"+$,$=Ud++,0<$&&(j+="H"+$.toString(32)),j+=":"}else $=Q1++,j=":"+j+"r"+$.toString(32)+":";return b.memoizedState=j},unstable_isNewReconciler:!1},LB={readContext:ps,useCallback:_6,useContext:ps,useEffect:bp,useImperativeHandle:w6,useInsertionEffect:Ty,useLayoutEffect:wp,useMemo:j6,useReducer:yp,useRef:Wl,useState:function(){return yp(Vh)},useDebugValue:Z1,useDeferredValue:function(b){var j=Gi();return N6(j,$s.memoizedState,b)},useTransition:function(){var b=yp(Vh)[0],j=Gi().memoizedState;return[b,j]},useMutableSource:Cy,useSyncExternalStore:d0,useId:k6,unstable_isNewReconciler:!1},DB={readContext:ps,useCallback:_6,useContext:ps,useEffect:bp,useImperativeHandle:w6,useInsertionEffect:Ty,useLayoutEffect:wp,useMemo:j6,useReducer:Mc,useRef:Wl,useState:function(){return Mc(Vh)},useDebugValue:Z1,useDeferredValue:function(b){var j=Gi();return $s===null?j.memoizedState=b:N6(j,$s.memoizedState,b)},useTransition:function(){var b=Mc(Vh)[0],j=Gi().memoizedState;return[b,j]},useMutableSource:Cy,useSyncExternalStore:d0,useId:k6,unstable_isNewReconciler:!1};function Kl(b,j){if(b&&b.defaultProps){j=D({},j),b=b.defaultProps;for(var $ in b)j[$]===void 0&&(j[$]=b[$]);return j}return j}function J1(b,j,$,Y){j=b.memoizedState,$=$(Y,j),$=$==null?j:D({},j,$),b.memoizedState=$,b.lanes===0&&(b.updateQueue.baseState=$)}var Oy={isMounted:function(b){return(b=b._reactInternals)?It(b)===b:!1},enqueueSetState:function(b,j,$){b=b._reactInternals;var Y=Qi(),te=Gd(b),oe=Cs(Y,te);oe.payload=j,$!=null&&(oe.callback=$),j=As(b,oe,te),j!==null&&(Yl(j,b,te,Y),Ga(j,b,te))},enqueueReplaceState:function(b,j,$){b=b._reactInternals;var Y=Qi(),te=Gd(b),oe=Cs(Y,te);oe.tag=1,oe.payload=j,$!=null&&(oe.callback=$),j=As(b,oe,te),j!==null&&(Yl(j,b,te,Y),Ga(j,b,te))},enqueueForceUpdate:function(b,j){b=b._reactInternals;var $=Qi(),Y=Gd(b),te=Cs($,Y);te.tag=2,j!=null&&(te.callback=j),j=As(b,te,Y),j!==null&&(Yl(j,b,Y,$),Ga(j,b,Y))}};function E6(b,j,$,Y,te,oe,ve){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(Y,oe,ve):j.prototype&&j.prototype.isPureReactComponent?!Si($,Y)||!Si(te,oe):!0}function T6(b,j,$){var Y=!1,te=Pc,oe=j.contextType;return typeof oe=="object"&&oe!==null?oe=ps(oe):(te=Ti(j)?Cu:Oa.current,Y=j.contextTypes,oe=(Y=Y!=null)?$d(b,te):Pc),j=new j($,oe),b.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=Oy,b.stateNode=j,j._reactInternals=b,Y&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=te,b.__reactInternalMemoizedMaskedChildContext=oe),j}function P6(b,j,$,Y){b=j.state,typeof j.componentWillReceiveProps=="function"&&j.componentWillReceiveProps($,Y),typeof j.UNSAFE_componentWillReceiveProps=="function"&&j.UNSAFE_componentWillReceiveProps($,Y),j.state!==b&&Oy.enqueueReplaceState(j,j.state,null)}function e2(b,j,$,Y){var te=b.stateNode;te.props=$,te.state=b.memoizedState,te.refs={},Ma(b);var oe=j.contextType;typeof oe=="object"&&oe!==null?te.context=ps(oe):(oe=Ti(j)?Cu:Oa.current,te.context=$d(b,oe)),te.state=b.memoizedState,oe=j.getDerivedStateFromProps,typeof oe=="function"&&(J1(b,j,oe,$),te.state=b.memoizedState),typeof j.getDerivedStateFromProps=="function"||typeof te.getSnapshotBeforeUpdate=="function"||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(j=te.state,typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount(),j!==te.state&&Oy.enqueueReplaceState(te,te.state,null),Xa(b,$,te,Y),te.state=b.memoizedState),typeof te.componentDidMount=="function"&&(b.flags|=4194308)}function jp(b,j){try{var $="",Y=j;do $+=re(Y),Y=Y.return;while(Y);var te=$}catch(oe){te=`
Error generating stack: `+oe.message+`
`+oe.stack}return{value:b,source:j,stack:te,digest:null}}function t2(b,j,$){return{value:b,source:null,stack:$??null,digest:j??null}}function r2(b,j){try{console.error(j.value)}catch($){setTimeout(function(){throw $})}}var FB=typeof WeakMap=="function"?WeakMap:Map;function O6(b,j,$){$=Cs(-1,$),$.tag=3,$.payload={element:null};var Y=j.value;return $.callback=function(){By||(By=!0,y2=Y),r2(b,j)},$}function M6(b,j,$){$=Cs(-1,$),$.tag=3;var Y=b.type.getDerivedStateFromError;if(typeof Y=="function"){var te=j.value;$.payload=function(){return Y(te)},$.callback=function(){r2(b,j)}}var oe=b.stateNode;return oe!==null&&typeof oe.componentDidCatch=="function"&&($.callback=function(){r2(b,j),typeof Y!="function"&&(Wd===null?Wd=new Set([this]):Wd.add(this));var ve=j.stack;this.componentDidCatch(j.value,{componentStack:ve!==null?ve:""})}),$}function I6(b,j,$){var Y=b.pingCache;if(Y===null){Y=b.pingCache=new FB;var te=new Set;Y.set(j,te)}else te=Y.get(j),te===void 0&&(te=new Set,Y.set(j,te));te.has($)||(te.add($),b=ZB.bind(null,b,j,$),j.then(b,b))}function R6(b){do{var j;if((j=b.tag===13)&&(j=b.memoizedState,j=j!==null?j.dehydrated!==null:!0),j)return b;b=b.return}while(b!==null);return null}function L6(b,j,$,Y,te){return(b.mode&1)===0?(b===j?b.flags|=65536:(b.flags|=128,$.flags|=131072,$.flags&=-52805,$.tag===1&&($.alternate===null?$.tag=17:(j=Cs(-1,1),j.tag=2,As($,j,1))),$.lanes|=1),b):(b.flags|=65536,b.lanes=te,b)}var BB=_.ReactCurrentOwner,fo=!1;function Yi(b,j,$,Y){j.child=b===null?ss(j,null,$,Y):Fs(j,b.child,$,Y)}function D6(b,j,$,Y,te){$=$.render;var oe=j.ref;return fs(j,te),Y=Hh(b,j,$,Y,oe,te),$=dl(),b!==null&&!fo?(j.updateQueue=b.updateQueue,j.flags&=-2053,b.lanes&=~te,Tu(b,j,te)):(ut&&$&&at(j),j.flags|=1,Yi(b,j,Y,te),j.child)}function F6(b,j,$,Y,te){if(b===null){var oe=$.type;return typeof oe=="function"&&!N2(oe)&&oe.defaultProps===void 0&&$.compare===null&&$.defaultProps===void 0?(j.tag=15,j.type=oe,B6(b,j,oe,Y,te)):(b=Vy($.type,null,Y,j,j.mode,te),b.ref=j.ref,b.return=j,j.child=b)}if(oe=b.child,(b.lanes&te)===0){var ve=oe.memoizedProps;if($=$.compare,$=$!==null?$:Si,$(ve,Y)&&b.ref===j.ref)return Tu(b,j,te)}return j.flags|=1,b=Yd(oe,Y),b.ref=j.ref,b.return=j,j.child=b}function B6(b,j,$,Y,te){if(b!==null){var oe=b.memoizedProps;if(Si(oe,Y)&&b.ref===j.ref)if(fo=!1,j.pendingProps=Y=oe,(b.lanes&te)!==0)(b.flags&131072)!==0&&(fo=!0);else return j.lanes=b.lanes,Tu(b,j,te)}return n2(b,j,$,Y,te)}function $6(b,j,$){var Y=j.pendingProps,te=Y.children,oe=b!==null?b.memoizedState:null;if(Y.mode==="hidden")if((j.mode&1)===0)j.memoizedState={baseLanes:0,cachePool:null,transitions:null},kn(kp,$o),$o|=$;else{if(($&1073741824)===0)return b=oe!==null?oe.baseLanes|$:$,j.lanes=j.childLanes=1073741824,j.memoizedState={baseLanes:b,cachePool:null,transitions:null},j.updateQueue=null,kn(kp,$o),$o|=b,null;j.memoizedState={baseLanes:0,cachePool:null,transitions:null},Y=oe!==null?oe.baseLanes:$,kn(kp,$o),$o|=Y}else oe!==null?(Y=oe.baseLanes|$,j.memoizedState=null):Y=$,kn(kp,$o),$o|=Y;return Yi(b,j,te,$),j.child}function q6(b,j){var $=j.ref;(b===null&&$!==null||b!==null&&b.ref!==$)&&(j.flags|=512,j.flags|=2097152)}function n2(b,j,$,Y,te){var oe=Ti($)?Cu:Oa.current;return oe=$d(j,oe),fs(j,te),$=Hh(b,j,$,Y,oe,te),Y=dl(),b!==null&&!fo?(j.updateQueue=b.updateQueue,j.flags&=-2053,b.lanes&=~te,Tu(b,j,te)):(ut&&Y&&at(j),j.flags|=1,Yi(b,j,$,te),j.child)}function z6(b,j,$,Y,te){if(Ti($)){var oe=!0;Au(j)}else oe=!1;if(fs(j,te),j.stateNode===null)Iy(b,j),T6(j,$,Y),e2(j,$,Y,te),Y=!0;else if(b===null){var ve=j.stateNode,Pe=j.memoizedProps;ve.props=Pe;var Fe=ve.context,et=$.contextType;typeof et=="object"&&et!==null?et=ps(et):(et=Ti($)?Cu:Oa.current,et=$d(j,et));var _t=$.getDerivedStateFromProps,Nt=typeof _t=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Nt||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Pe!==Y||Fe!==et)&&P6(j,ve,Y,et),Bs=!1;var bt=j.memoizedState;ve.state=bt,Xa(j,Y,ve,te),Fe=j.memoizedState,Pe!==Y||bt!==Fe||Ei.current||Bs?(typeof _t=="function"&&(J1(j,$,_t,Y),Fe=j.memoizedState),(Pe=Bs||E6(j,$,Pe,Y,bt,Fe,et))?(Nt||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(j.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(j.flags|=4194308),j.memoizedProps=Y,j.memoizedState=Fe),ve.props=Y,ve.state=Fe,ve.context=et,Y=Pe):(typeof ve.componentDidMount=="function"&&(j.flags|=4194308),Y=!1)}else{ve=j.stateNode,Pi(b,j),Pe=j.memoizedProps,et=j.type===j.elementType?Pe:Kl(j.type,Pe),ve.props=et,Nt=j.pendingProps,bt=ve.context,Fe=$.contextType,typeof Fe=="object"&&Fe!==null?Fe=ps(Fe):(Fe=Ti($)?Cu:Oa.current,Fe=$d(j,Fe));var $t=$.getDerivedStateFromProps;(_t=typeof $t=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Pe!==Nt||bt!==Fe)&&P6(j,ve,Y,Fe),Bs=!1,bt=j.memoizedState,ve.state=bt,Xa(j,Y,ve,te);var Jt=j.memoizedState;Pe!==Nt||bt!==Jt||Ei.current||Bs?(typeof $t=="function"&&(J1(j,$,$t,Y),Jt=j.memoizedState),(et=Bs||E6(j,$,et,Y,bt,Jt,Fe)||!1)?(_t||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(Y,Jt,Fe),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(Y,Jt,Fe)),typeof ve.componentDidUpdate=="function"&&(j.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(j.flags|=1024)):(typeof ve.componentDidUpdate!="function"||Pe===b.memoizedProps&&bt===b.memoizedState||(j.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Pe===b.memoizedProps&&bt===b.memoizedState||(j.flags|=1024),j.memoizedProps=Y,j.memoizedState=Jt),ve.props=Y,ve.state=Jt,ve.context=Fe,Y=et):(typeof ve.componentDidUpdate!="function"||Pe===b.memoizedProps&&bt===b.memoizedState||(j.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Pe===b.memoizedProps&&bt===b.memoizedState||(j.flags|=1024),Y=!1)}return s2(b,j,$,Y,oe,te)}function s2(b,j,$,Y,te,oe){q6(b,j);var ve=(j.flags&128)!==0;if(!Y&&!ve)return te&&ky(j,$,!1),Tu(b,j,oe);Y=j.stateNode,BB.current=j;var Pe=ve&&typeof $.getDerivedStateFromError!="function"?null:Y.render();return j.flags|=1,b!==null&&ve?(j.child=Fs(j,b.child,null,oe),j.child=Fs(j,null,Pe,oe)):Yi(b,j,Pe,oe),j.memoizedState=Y.state,te&&ky(j,$,!0),j.child}function U6(b){var j=b.stateNode;j.pendingContext?Ny(b,j.pendingContext,j.pendingContext!==j.context):j.context&&Ny(b,j.context,!1),qd(b,j.containerInfo)}function H6(b,j,$,Y,te){return zt(),Ot(te),j.flags|=256,Yi(b,j,$,Y),j.child}var a2={dehydrated:null,treeContext:null,retryLane:0};function i2(b){return{baseLanes:b,cachePool:null,transitions:null}}function V6(b,j,$){var Y=j.pendingProps,te=Vn.current,oe=!1,ve=(j.flags&128)!==0,Pe;if((Pe=ve)||(Pe=b!==null&&b.memoizedState===null?!1:(te&2)!==0),Pe?(oe=!0,j.flags&=-129):(b===null||b.memoizedState!==null)&&(te|=1),kn(Vn,te&1),b===null)return Yt(j),b=j.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?((j.mode&1)===0?j.lanes=1:b.data==="$!"?j.lanes=8:j.lanes=1073741824,null):(ve=Y.children,b=Y.fallback,oe?(Y=j.mode,oe=j.child,ve={mode:"hidden",children:ve},(Y&1)===0&&oe!==null?(oe.childLanes=0,oe.pendingProps=ve):oe=Wy(ve,Y,0,null),b=Qh(b,Y,$,null),oe.return=j,b.return=j,oe.sibling=b,j.child=oe,j.child.memoizedState=i2($),j.memoizedState=a2,b):o2(j,ve));if(te=b.memoizedState,te!==null&&(Pe=te.dehydrated,Pe!==null))return $B(b,j,ve,Y,Pe,te,$);if(oe){oe=Y.fallback,ve=j.mode,te=b.child,Pe=te.sibling;var Fe={mode:"hidden",children:Y.children};return(ve&1)===0&&j.child!==te?(Y=j.child,Y.childLanes=0,Y.pendingProps=Fe,j.deletions=null):(Y=Yd(te,Fe),Y.subtreeFlags=te.subtreeFlags&14680064),Pe!==null?oe=Yd(Pe,oe):(oe=Qh(oe,ve,$,null),oe.flags|=2),oe.return=j,Y.return=j,Y.sibling=oe,j.child=Y,Y=oe,oe=j.child,ve=b.child.memoizedState,ve=ve===null?i2($):{baseLanes:ve.baseLanes|$,cachePool:null,transitions:ve.transitions},oe.memoizedState=ve,oe.childLanes=b.childLanes&~$,j.memoizedState=a2,Y}return oe=b.child,b=oe.sibling,Y=Yd(oe,{mode:"visible",children:Y.children}),(j.mode&1)===0&&(Y.lanes=$),Y.return=j,Y.sibling=null,b!==null&&($=j.deletions,$===null?(j.deletions=[b],j.flags|=16):$.push(b)),j.child=Y,j.memoizedState=null,Y}function o2(b,j){return j=Wy({mode:"visible",children:j},b.mode,0,null),j.return=b,b.child=j}function My(b,j,$,Y){return Y!==null&&Ot(Y),Fs(j,b.child,null,$),b=o2(j,j.pendingProps.children),b.flags|=2,j.memoizedState=null,b}function $B(b,j,$,Y,te,oe,ve){if($)return j.flags&256?(j.flags&=-257,Y=t2(Error(t(422))),My(b,j,ve,Y)):j.memoizedState!==null?(j.child=b.child,j.flags|=128,null):(oe=Y.fallback,te=j.mode,Y=Wy({mode:"visible",children:Y.children},te,0,null),oe=Qh(oe,te,ve,null),oe.flags|=2,Y.return=j,oe.return=j,Y.sibling=oe,j.child=Y,(j.mode&1)!==0&&Fs(j,b.child,null,ve),j.child.memoizedState=i2(ve),j.memoizedState=a2,oe);if((j.mode&1)===0)return My(b,j,ve,null);if(te.data==="$!"){if(Y=te.nextSibling&&te.nextSibling.dataset,Y)var Pe=Y.dgst;return Y=Pe,oe=Error(t(419)),Y=t2(oe,Y,void 0),My(b,j,ve,Y)}if(Pe=(ve&b.childLanes)!==0,fo||Pe){if(Y=Ya,Y!==null){switch(ve&-ve){case 4:te=2;break;case 16:te=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:te=32;break;case 536870912:te=268435456;break;default:te=0}te=(te&(Y.suspendedLanes|ve))!==0?0:te,te!==0&&te!==oe.retryLane&&(oe.retryLane=te,In(b,te),Yl(Y,b,te,-1))}return j2(),Y=t2(Error(t(421))),My(b,j,ve,Y)}return te.data==="$?"?(j.flags|=128,j.child=b.child,j=JB.bind(null,b),te._reactRetry=j,null):(b=oe.treeContext,st=mi(te.nextSibling),tt=j,ut=!0,ft=null,b!==null&&(ke[Se++]=We,ke[Se++]=Ae,ke[Se++]=De,We=b.id,Ae=b.overflow,De=j),j=o2(j,Y.children),j.flags|=4096,j)}function W6(b,j,$){b.lanes|=j;var Y=b.alternate;Y!==null&&(Y.lanes|=j),mn(b.return,j,$)}function l2(b,j,$,Y,te){var oe=b.memoizedState;oe===null?b.memoizedState={isBackwards:j,rendering:null,renderingStartTime:0,last:Y,tail:$,tailMode:te}:(oe.isBackwards=j,oe.rendering=null,oe.renderingStartTime=0,oe.last=Y,oe.tail=$,oe.tailMode=te)}function K6(b,j,$){var Y=j.pendingProps,te=Y.revealOrder,oe=Y.tail;if(Yi(b,j,Y.children,$),Y=Vn.current,(Y&2)!==0)Y=Y&1|2,j.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=j.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&W6(b,$,j);else if(b.tag===19)W6(b,$,j);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===j)break e;for(;b.sibling===null;){if(b.return===null||b.return===j)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}Y&=1}if(kn(Vn,Y),(j.mode&1)===0)j.memoizedState=null;else switch(te){case"forwards":for($=j.child,te=null;$!==null;)b=$.alternate,b!==null&&Do(b)===null&&(te=$),$=$.sibling;$=te,$===null?(te=j.child,j.child=null):(te=$.sibling,$.sibling=null),l2(j,!1,te,$,oe);break;case"backwards":for($=null,te=j.child,j.child=null;te!==null;){if(b=te.alternate,b!==null&&Do(b)===null){j.child=te;break}b=te.sibling,te.sibling=$,$=te,te=b}l2(j,!0,$,null,oe);break;case"together":l2(j,!1,null,null,void 0);break;default:j.memoizedState=null}return j.child}function Iy(b,j){(j.mode&1)===0&&b!==null&&(b.alternate=null,j.alternate=null,j.flags|=2)}function Tu(b,j,$){if(b!==null&&(j.dependencies=b.dependencies),Kh|=j.lanes,($&j.childLanes)===0)return null;if(b!==null&&j.child!==b.child)throw Error(t(153));if(j.child!==null){for(b=j.child,$=Yd(b,b.pendingProps),j.child=$,$.return=j;b.sibling!==null;)b=b.sibling,$=$.sibling=Yd(b,b.pendingProps),$.return=j;$.sibling=null}return j.child}function qB(b,j,$){switch(j.tag){case 3:U6(j),zt();break;case 5:Sy(j);break;case 1:Ti(j.type)&&Au(j);break;case 4:qd(j,j.stateNode.containerInfo);break;case 10:var Y=j.type._context,te=j.memoizedProps.value;kn(ea,Y._currentValue),Y._currentValue=te;break;case 13:if(Y=j.memoizedState,Y!==null)return Y.dehydrated!==null?(kn(Vn,Vn.current&1),j.flags|=128,null):($&j.child.childLanes)!==0?V6(b,j,$):(kn(Vn,Vn.current&1),b=Tu(b,j,$),b!==null?b.sibling:null);kn(Vn,Vn.current&1);break;case 19:if(Y=($&j.childLanes)!==0,(b.flags&128)!==0){if(Y)return K6(b,j,$);j.flags|=128}if(te=j.memoizedState,te!==null&&(te.rendering=null,te.tail=null,te.lastEffect=null),kn(Vn,Vn.current),Y)break;return null;case 22:case 23:return j.lanes=0,$6(b,j,$)}return Tu(b,j,$)}var G6,c2,X6,Y6;G6=function(b,j){for(var $=j.child;$!==null;){if($.tag===5||$.tag===6)b.appendChild($.stateNode);else if($.tag!==4&&$.child!==null){$.child.return=$,$=$.child;continue}if($===j)break;for(;$.sibling===null;){if($.return===null||$.return===j)return;$=$.return}$.sibling.return=$.return,$=$.sibling}},c2=function(){},X6=function(b,j,$,Y){var te=b.memoizedProps;if(te!==Y){b=j.stateNode,Hl(ga.current);var oe=null;switch($){case"input":te=de(b,te),Y=de(b,Y),oe=[];break;case"select":te=D({},te,{value:void 0}),Y=D({},Y,{value:void 0}),oe=[];break;case"textarea":te=xe(b,te),Y=xe(b,Y),oe=[];break;default:typeof te.onClick!="function"&&typeof Y.onClick=="function"&&(b.onclick=Dd)}St($,Y);var ve;$=null;for(et in te)if(!Y.hasOwnProperty(et)&&te.hasOwnProperty(et)&&te[et]!=null)if(et==="style"){var Pe=te[et];for(ve in Pe)Pe.hasOwnProperty(ve)&&($||($={}),$[ve]="")}else et!=="dangerouslySetInnerHTML"&&et!=="children"&&et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(a.hasOwnProperty(et)?oe||(oe=[]):(oe=oe||[]).push(et,null));for(et in Y){var Fe=Y[et];if(Pe=te?.[et],Y.hasOwnProperty(et)&&Fe!==Pe&&(Fe!=null||Pe!=null))if(et==="style")if(Pe){for(ve in Pe)!Pe.hasOwnProperty(ve)||Fe&&Fe.hasOwnProperty(ve)||($||($={}),$[ve]="");for(ve in Fe)Fe.hasOwnProperty(ve)&&Pe[ve]!==Fe[ve]&&($||($={}),$[ve]=Fe[ve])}else $||(oe||(oe=[]),oe.push(et,$)),$=Fe;else et==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Pe=Pe?Pe.__html:void 0,Fe!=null&&Pe!==Fe&&(oe=oe||[]).push(et,Fe)):et==="children"?typeof Fe!="string"&&typeof Fe!="number"||(oe=oe||[]).push(et,""+Fe):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&(a.hasOwnProperty(et)?(Fe!=null&&et==="onScroll"&&On("scroll",b),oe||Pe===Fe||(oe=[])):(oe=oe||[]).push(et,Fe))}$&&(oe=oe||[]).push("style",$);var et=oe;(j.updateQueue=et)&&(j.flags|=4)}},Y6=function(b,j,$,Y){$!==Y&&(j.flags|=4)};function f0(b,j){if(!ut)switch(b.tailMode){case"hidden":j=b.tail;for(var $=null;j!==null;)j.alternate!==null&&($=j),j=j.sibling;$===null?b.tail=null:$.sibling=null;break;case"collapsed":$=b.tail;for(var Y=null;$!==null;)$.alternate!==null&&(Y=$),$=$.sibling;Y===null?j||b.tail===null?b.tail=null:b.tail.sibling=null:Y.sibling=null}}function Oi(b){var j=b.alternate!==null&&b.alternate.child===b.child,$=0,Y=0;if(j)for(var te=b.child;te!==null;)$|=te.lanes|te.childLanes,Y|=te.subtreeFlags&14680064,Y|=te.flags&14680064,te.return=b,te=te.sibling;else for(te=b.child;te!==null;)$|=te.lanes|te.childLanes,Y|=te.subtreeFlags,Y|=te.flags,te.return=b,te=te.sibling;return b.subtreeFlags|=Y,b.childLanes=$,j}function zB(b,j,$){var Y=j.pendingProps;switch(Ge(j),j.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oi(j),null;case 1:return Ti(j.type)&&fp(),Oi(j),null;case 3:return Y=j.stateNode,cl(),jn(Ei),jn(Oa),u0(),Y.pendingContext&&(Y.context=Y.pendingContext,Y.pendingContext=null),(b===null||b.child===null)&&(hs(j)?j.flags|=4:b===null||b.memoizedState.isDehydrated&&(j.flags&256)===0||(j.flags|=1024,ft!==null&&(b2(ft),ft=null))),c2(b,j),Oi(j),null;case 5:l0(j);var te=Hl(Oc.current);if($=j.type,b!==null&&j.stateNode!=null)X6(b,j,$,Y,te),b.ref!==j.ref&&(j.flags|=512,j.flags|=2097152);else{if(!Y){if(j.stateNode===null)throw Error(t(166));return Oi(j),null}if(b=Hl(ga.current),hs(j)){Y=j.stateNode,$=j.type;var oe=j.memoizedProps;switch(Y[ll]=j,Y[Fd]=oe,b=(j.mode&1)!==0,$){case"dialog":On("cancel",Y),On("close",Y);break;case"iframe":case"object":case"embed":On("load",Y);break;case"video":case"audio":for(te=0;te<Ec.length;te++)On(Ec[te],Y);break;case"source":On("error",Y);break;case"img":case"image":case"link":On("error",Y),On("load",Y);break;case"details":On("toggle",Y);break;case"input":le(Y,oe),On("invalid",Y);break;case"select":Y._wrapperState={wasMultiple:!!oe.multiple},On("invalid",Y);break;case"textarea":je(Y,oe),On("invalid",Y)}St($,oe),te=null;for(var ve in oe)if(oe.hasOwnProperty(ve)){var Pe=oe[ve];ve==="children"?typeof Pe=="string"?Y.textContent!==Pe&&(oe.suppressHydrationWarning!==!0&&hp(Y.textContent,Pe,b),te=["children",Pe]):typeof Pe=="number"&&Y.textContent!==""+Pe&&(oe.suppressHydrationWarning!==!0&&hp(Y.textContent,Pe,b),te=["children",""+Pe]):a.hasOwnProperty(ve)&&Pe!=null&&ve==="onScroll"&&On("scroll",Y)}switch($){case"input":ne(Y),pe(Y,oe,!0);break;case"textarea":ne(Y),Ie(Y);break;case"select":case"option":break;default:typeof oe.onClick=="function"&&(Y.onclick=Dd)}Y=te,j.updateQueue=Y,Y!==null&&(j.flags|=4)}else{ve=te.nodeType===9?te:te.ownerDocument,b==="http://www.w3.org/1999/xhtml"&&(b=Le($)),b==="http://www.w3.org/1999/xhtml"?$==="script"?(b=ve.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild)):typeof Y.is=="string"?b=ve.createElement($,{is:Y.is}):(b=ve.createElement($),$==="select"&&(ve=b,Y.multiple?ve.multiple=!0:Y.size&&(ve.size=Y.size))):b=ve.createElementNS(b,$),b[ll]=j,b[Fd]=Y,G6(b,j,!1,!1),j.stateNode=b;e:{switch(ve=ot($,Y),$){case"dialog":On("cancel",b),On("close",b),te=Y;break;case"iframe":case"object":case"embed":On("load",b),te=Y;break;case"video":case"audio":for(te=0;te<Ec.length;te++)On(Ec[te],b);te=Y;break;case"source":On("error",b),te=Y;break;case"img":case"image":case"link":On("error",b),On("load",b),te=Y;break;case"details":On("toggle",b),te=Y;break;case"input":le(b,Y),te=de(b,Y),On("invalid",b);break;case"option":te=Y;break;case"select":b._wrapperState={wasMultiple:!!Y.multiple},te=D({},Y,{value:void 0}),On("invalid",b);break;case"textarea":je(b,Y),te=xe(b,Y),On("invalid",b);break;default:te=Y}St($,te),Pe=te;for(oe in Pe)if(Pe.hasOwnProperty(oe)){var Fe=Pe[oe];oe==="style"?nt(b,Fe):oe==="dangerouslySetInnerHTML"?(Fe=Fe?Fe.__html:void 0,Fe!=null&&Je(b,Fe)):oe==="children"?typeof Fe=="string"?($!=="textarea"||Fe!=="")&&ct(b,Fe):typeof Fe=="number"&&ct(b,""+Fe):oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&oe!=="autoFocus"&&(a.hasOwnProperty(oe)?Fe!=null&&oe==="onScroll"&&On("scroll",b):Fe!=null&&w(b,oe,Fe,ve))}switch($){case"input":ne(b),pe(b,Y,!1);break;case"textarea":ne(b),Ie(b);break;case"option":Y.value!=null&&b.setAttribute("value",""+W(Y.value));break;case"select":b.multiple=!!Y.multiple,oe=Y.value,oe!=null?fe(b,!!Y.multiple,oe,!1):Y.defaultValue!=null&&fe(b,!!Y.multiple,Y.defaultValue,!0);break;default:typeof te.onClick=="function"&&(b.onclick=Dd)}switch($){case"button":case"input":case"select":case"textarea":Y=!!Y.autoFocus;break e;case"img":Y=!0;break e;default:Y=!1}}Y&&(j.flags|=4)}j.ref!==null&&(j.flags|=512,j.flags|=2097152)}return Oi(j),null;case 6:if(b&&j.stateNode!=null)Y6(b,j,b.memoizedProps,Y);else{if(typeof Y!="string"&&j.stateNode===null)throw Error(t(166));if($=Hl(Oc.current),Hl(ga.current),hs(j)){if(Y=j.stateNode,$=j.memoizedProps,Y[ll]=j,(oe=Y.nodeValue!==$)&&(b=tt,b!==null))switch(b.tag){case 3:hp(Y.nodeValue,$,(b.mode&1)!==0);break;case 5:b.memoizedProps.suppressHydrationWarning!==!0&&hp(Y.nodeValue,$,(b.mode&1)!==0)}oe&&(j.flags|=4)}else Y=($.nodeType===9?$:$.ownerDocument).createTextNode(Y),Y[ll]=j,j.stateNode=Y}return Oi(j),null;case 13:if(jn(Vn),Y=j.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(ut&&st!==null&&(j.mode&1)!==0&&(j.flags&128)===0)Ur(),zt(),j.flags|=98560,oe=!1;else if(oe=hs(j),Y!==null&&Y.dehydrated!==null){if(b===null){if(!oe)throw Error(t(318));if(oe=j.memoizedState,oe=oe!==null?oe.dehydrated:null,!oe)throw Error(t(317));oe[ll]=j}else zt(),(j.flags&128)===0&&(j.memoizedState=null),j.flags|=4;Oi(j),oe=!1}else ft!==null&&(b2(ft),ft=null),oe=!0;if(!oe)return j.flags&65536?j:null}return(j.flags&128)!==0?(j.lanes=$,j):(Y=Y!==null,Y!==(b!==null&&b.memoizedState!==null)&&Y&&(j.child.flags|=8192,(j.mode&1)!==0&&(b===null||(Vn.current&1)!==0?Ia===0&&(Ia=3):j2())),j.updateQueue!==null&&(j.flags|=4),Oi(j),null);case 4:return cl(),c2(b,j),b===null&&ju(j.stateNode.containerInfo),Oi(j),null;case 10:return Yn(j.type._context),Oi(j),null;case 17:return Ti(j.type)&&fp(),Oi(j),null;case 19:if(jn(Vn),oe=j.memoizedState,oe===null)return Oi(j),null;if(Y=(j.flags&128)!==0,ve=oe.rendering,ve===null)if(Y)f0(oe,!1);else{if(Ia!==0||b!==null&&(b.flags&128)!==0)for(b=j.child;b!==null;){if(ve=Do(b),ve!==null){for(j.flags|=128,f0(oe,!1),Y=ve.updateQueue,Y!==null&&(j.updateQueue=Y,j.flags|=4),j.subtreeFlags=0,Y=$,$=j.child;$!==null;)oe=$,b=Y,oe.flags&=14680066,ve=oe.alternate,ve===null?(oe.childLanes=0,oe.lanes=b,oe.child=null,oe.subtreeFlags=0,oe.memoizedProps=null,oe.memoizedState=null,oe.updateQueue=null,oe.dependencies=null,oe.stateNode=null):(oe.childLanes=ve.childLanes,oe.lanes=ve.lanes,oe.child=ve.child,oe.subtreeFlags=0,oe.deletions=null,oe.memoizedProps=ve.memoizedProps,oe.memoizedState=ve.memoizedState,oe.updateQueue=ve.updateQueue,oe.type=ve.type,b=ve.dependencies,oe.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),$=$.sibling;return kn(Vn,Vn.current&1|2),j.child}b=b.sibling}oe.tail!==null&&ze()>Sp&&(j.flags|=128,Y=!0,f0(oe,!1),j.lanes=4194304)}else{if(!Y)if(b=Do(ve),b!==null){if(j.flags|=128,Y=!0,$=b.updateQueue,$!==null&&(j.updateQueue=$,j.flags|=4),f0(oe,!0),oe.tail===null&&oe.tailMode==="hidden"&&!ve.alternate&&!ut)return Oi(j),null}else 2*ze()-oe.renderingStartTime>Sp&&$!==1073741824&&(j.flags|=128,Y=!0,f0(oe,!1),j.lanes=4194304);oe.isBackwards?(ve.sibling=j.child,j.child=ve):($=oe.last,$!==null?$.sibling=ve:j.child=ve,oe.last=ve)}return oe.tail!==null?(j=oe.tail,oe.rendering=j,oe.tail=j.sibling,oe.renderingStartTime=ze(),j.sibling=null,$=Vn.current,kn(Vn,Y?$&1|2:$&1),j):(Oi(j),null);case 22:case 23:return _2(),Y=j.memoizedState!==null,b!==null&&b.memoizedState!==null!==Y&&(j.flags|=8192),Y&&(j.mode&1)!==0?($o&1073741824)!==0&&(Oi(j),j.subtreeFlags&6&&(j.flags|=8192)):Oi(j),null;case 24:return null;case 25:return null}throw Error(t(156,j.tag))}function UB(b,j){switch(Ge(j),j.tag){case 1:return Ti(j.type)&&fp(),b=j.flags,b&65536?(j.flags=b&-65537|128,j):null;case 3:return cl(),jn(Ei),jn(Oa),u0(),b=j.flags,(b&65536)!==0&&(b&128)===0?(j.flags=b&-65537|128,j):null;case 5:return l0(j),null;case 13:if(jn(Vn),b=j.memoizedState,b!==null&&b.dehydrated!==null){if(j.alternate===null)throw Error(t(340));zt()}return b=j.flags,b&65536?(j.flags=b&-65537|128,j):null;case 19:return jn(Vn),null;case 4:return cl(),null;case 10:return Yn(j.type._context),null;case 22:case 23:return _2(),null;case 24:return null;default:return null}}var Ry=!1,Mi=!1,HB=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function Np(b,j){var $=b.ref;if($!==null)if(typeof $=="function")try{$(null)}catch(Y){qs(b,j,Y)}else $.current=null}function u2(b,j,$){try{$()}catch(Y){qs(b,j,Y)}}var Q6=!1;function VB(b,j){if(qh=kd,b=Ds(),Io(b)){if("selectionStart"in b)var $={start:b.selectionStart,end:b.selectionEnd};else e:{$=($=b.ownerDocument)&&$.defaultView||window;var Y=$.getSelection&&$.getSelection();if(Y&&Y.rangeCount!==0){$=Y.anchorNode;var te=Y.anchorOffset,oe=Y.focusNode;Y=Y.focusOffset;try{$.nodeType,oe.nodeType}catch{$=null;break e}var ve=0,Pe=-1,Fe=-1,et=0,_t=0,Nt=b,bt=null;t:for(;;){for(var $t;Nt!==$||te!==0&&Nt.nodeType!==3||(Pe=ve+te),Nt!==oe||Y!==0&&Nt.nodeType!==3||(Fe=ve+Y),Nt.nodeType===3&&(ve+=Nt.nodeValue.length),($t=Nt.firstChild)!==null;)bt=Nt,Nt=$t;for(;;){if(Nt===b)break t;if(bt===$&&++et===te&&(Pe=ve),bt===oe&&++_t===Y&&(Fe=ve),($t=Nt.nextSibling)!==null)break;Nt=bt,bt=Nt.parentNode}Nt=$t}$=Pe===-1||Fe===-1?null:{start:Pe,end:Fe}}else $=null}$=$||{start:0,end:0}}else $=null;for(ku={focusedElem:b,selectionRange:$},kd=!1,Ht=j;Ht!==null;)if(j=Ht,b=j.child,(j.subtreeFlags&1028)!==0&&b!==null)b.return=j,Ht=b;else for(;Ht!==null;){j=Ht;try{var Jt=j.alternate;if((j.flags&1024)!==0)switch(j.tag){case 0:case 11:case 15:break;case 1:if(Jt!==null){var ir=Jt.memoizedProps,ra=Jt.memoizedState,Ke=j.stateNode,qe=Ke.getSnapshotBeforeUpdate(j.elementType===j.type?ir:Kl(j.type,ir),ra);Ke.__reactInternalSnapshotBeforeUpdate=qe}break;case 3:var Ye=j.stateNode.containerInfo;Ye.nodeType===1?Ye.textContent="":Ye.nodeType===9&&Ye.documentElement&&Ye.removeChild(Ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Et){qs(j,j.return,Et)}if(b=j.sibling,b!==null){b.return=j.return,Ht=b;break}Ht=j.return}return Jt=Q6,Q6=!1,Jt}function p0(b,j,$){var Y=j.updateQueue;if(Y=Y!==null?Y.lastEffect:null,Y!==null){var te=Y=Y.next;do{if((te.tag&b)===b){var oe=te.destroy;te.destroy=void 0,oe!==void 0&&u2(j,$,oe)}te=te.next}while(te!==Y)}}function Ly(b,j){if(j=j.updateQueue,j=j!==null?j.lastEffect:null,j!==null){var $=j=j.next;do{if(($.tag&b)===b){var Y=$.create;$.destroy=Y()}$=$.next}while($!==j)}}function d2(b){var j=b.ref;if(j!==null){var $=b.stateNode;b.tag,b=$,typeof j=="function"?j(b):j.current=b}}function Z6(b){var j=b.alternate;j!==null&&(b.alternate=null,Z6(j)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(j=b.stateNode,j!==null&&(delete j[ll],delete j[Fd],delete j[Ai],delete j[X1],delete j[Y1])),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function J6(b){return b.tag===5||b.tag===3||b.tag===4}function ek(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||J6(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function h2(b,j,$){var Y=b.tag;if(Y===5||Y===6)b=b.stateNode,j?$.nodeType===8?$.parentNode.insertBefore(b,j):$.insertBefore(b,j):($.nodeType===8?(j=$.parentNode,j.insertBefore(b,$)):(j=$,j.appendChild(b)),$=$._reactRootContainer,$!=null||j.onclick!==null||(j.onclick=Dd));else if(Y!==4&&(b=b.child,b!==null))for(h2(b,j,$),b=b.sibling;b!==null;)h2(b,j,$),b=b.sibling}function f2(b,j,$){var Y=b.tag;if(Y===5||Y===6)b=b.stateNode,j?$.insertBefore(b,j):$.appendChild(b);else if(Y!==4&&(b=b.child,b!==null))for(f2(b,j,$),b=b.sibling;b!==null;)f2(b,j,$),b=b.sibling}var gi=null,Gl=!1;function Vd(b,j,$){for($=$.child;$!==null;)tk(b,j,$),$=$.sibling}function tk(b,j,$){if(yr&&typeof yr.onCommitFiberUnmount=="function")try{yr.onCommitFiberUnmount(wr,$)}catch{}switch($.tag){case 5:Mi||Np($,j);case 6:var Y=gi,te=Gl;gi=null,Vd(b,j,$),gi=Y,Gl=te,gi!==null&&(Gl?(b=gi,$=$.stateNode,b.nodeType===8?b.parentNode.removeChild($):b.removeChild($)):gi.removeChild($.stateNode));break;case 18:gi!==null&&(Gl?(b=gi,$=$.stateNode,b.nodeType===8?a0(b.parentNode,$):b.nodeType===1&&a0(b,$),lu(b)):a0(gi,$.stateNode));break;case 4:Y=gi,te=Gl,gi=$.stateNode.containerInfo,Gl=!0,Vd(b,j,$),gi=Y,Gl=te;break;case 0:case 11:case 14:case 15:if(!Mi&&(Y=$.updateQueue,Y!==null&&(Y=Y.lastEffect,Y!==null))){te=Y=Y.next;do{var oe=te,ve=oe.destroy;oe=oe.tag,ve!==void 0&&((oe&2)!==0||(oe&4)!==0)&&u2($,j,ve),te=te.next}while(te!==Y)}Vd(b,j,$);break;case 1:if(!Mi&&(Np($,j),Y=$.stateNode,typeof Y.componentWillUnmount=="function"))try{Y.props=$.memoizedProps,Y.state=$.memoizedState,Y.componentWillUnmount()}catch(Pe){qs($,j,Pe)}Vd(b,j,$);break;case 21:Vd(b,j,$);break;case 22:$.mode&1?(Mi=(Y=Mi)||$.memoizedState!==null,Vd(b,j,$),Mi=Y):Vd(b,j,$);break;default:Vd(b,j,$)}}function rk(b){var j=b.updateQueue;if(j!==null){b.updateQueue=null;var $=b.stateNode;$===null&&($=b.stateNode=new HB),j.forEach(function(Y){var te=e$.bind(null,b,Y);$.has(Y)||($.add(Y),Y.then(te,te))})}}function Xl(b,j){var $=j.deletions;if($!==null)for(var Y=0;Y<$.length;Y++){var te=$[Y];try{var oe=b,ve=j,Pe=ve;e:for(;Pe!==null;){switch(Pe.tag){case 5:gi=Pe.stateNode,Gl=!1;break e;case 3:gi=Pe.stateNode.containerInfo,Gl=!0;break e;case 4:gi=Pe.stateNode.containerInfo,Gl=!0;break e}Pe=Pe.return}if(gi===null)throw Error(t(160));tk(oe,ve,te),gi=null,Gl=!1;var Fe=te.alternate;Fe!==null&&(Fe.return=null),te.return=null}catch(et){qs(te,j,et)}}if(j.subtreeFlags&12854)for(j=j.child;j!==null;)nk(j,b),j=j.sibling}function nk(b,j){var $=b.alternate,Y=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:if(Xl(j,b),Ic(b),Y&4){try{p0(3,b,b.return),Ly(3,b)}catch(ir){qs(b,b.return,ir)}try{p0(5,b,b.return)}catch(ir){qs(b,b.return,ir)}}break;case 1:Xl(j,b),Ic(b),Y&512&&$!==null&&Np($,$.return);break;case 5:if(Xl(j,b),Ic(b),Y&512&&$!==null&&Np($,$.return),b.flags&32){var te=b.stateNode;try{ct(te,"")}catch(ir){qs(b,b.return,ir)}}if(Y&4&&(te=b.stateNode,te!=null)){var oe=b.memoizedProps,ve=$!==null?$.memoizedProps:oe,Pe=b.type,Fe=b.updateQueue;if(b.updateQueue=null,Fe!==null)try{Pe==="input"&&oe.type==="radio"&&oe.name!=null&&_e(te,oe),ot(Pe,ve);var et=ot(Pe,oe);for(ve=0;ve<Fe.length;ve+=2){var _t=Fe[ve],Nt=Fe[ve+1];_t==="style"?nt(te,Nt):_t==="dangerouslySetInnerHTML"?Je(te,Nt):_t==="children"?ct(te,Nt):w(te,_t,Nt,et)}switch(Pe){case"input":ue(te,oe);break;case"textarea":Oe(te,oe);break;case"select":var bt=te._wrapperState.wasMultiple;te._wrapperState.wasMultiple=!!oe.multiple;var $t=oe.value;$t!=null?fe(te,!!oe.multiple,$t,!1):bt!==!!oe.multiple&&(oe.defaultValue!=null?fe(te,!!oe.multiple,oe.defaultValue,!0):fe(te,!!oe.multiple,oe.multiple?[]:"",!1))}te[Fd]=oe}catch(ir){qs(b,b.return,ir)}}break;case 6:if(Xl(j,b),Ic(b),Y&4){if(b.stateNode===null)throw Error(t(162));te=b.stateNode,oe=b.memoizedProps;try{te.nodeValue=oe}catch(ir){qs(b,b.return,ir)}}break;case 3:if(Xl(j,b),Ic(b),Y&4&&$!==null&&$.memoizedState.isDehydrated)try{lu(j.containerInfo)}catch(ir){qs(b,b.return,ir)}break;case 4:Xl(j,b),Ic(b);break;case 13:Xl(j,b),Ic(b),te=b.child,te.flags&8192&&(oe=te.memoizedState!==null,te.stateNode.isHidden=oe,!oe||te.alternate!==null&&te.alternate.memoizedState!==null||(g2=ze())),Y&4&&rk(b);break;case 22:if(_t=$!==null&&$.memoizedState!==null,b.mode&1?(Mi=(et=Mi)||_t,Xl(j,b),Mi=et):Xl(j,b),Ic(b),Y&8192){if(et=b.memoizedState!==null,(b.stateNode.isHidden=et)&&!_t&&(b.mode&1)!==0)for(Ht=b,_t=b.child;_t!==null;){for(Nt=Ht=_t;Ht!==null;){switch(bt=Ht,$t=bt.child,bt.tag){case 0:case 11:case 14:case 15:p0(4,bt,bt.return);break;case 1:Np(bt,bt.return);var Jt=bt.stateNode;if(typeof Jt.componentWillUnmount=="function"){Y=bt,$=bt.return;try{j=Y,Jt.props=j.memoizedProps,Jt.state=j.memoizedState,Jt.componentWillUnmount()}catch(ir){qs(Y,$,ir)}}break;case 5:Np(bt,bt.return);break;case 22:if(bt.memoizedState!==null){ik(Nt);continue}}$t!==null?($t.return=bt,Ht=$t):ik(Nt)}_t=_t.sibling}e:for(_t=null,Nt=b;;){if(Nt.tag===5){if(_t===null){_t=Nt;try{te=Nt.stateNode,et?(oe=te.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none"):(Pe=Nt.stateNode,Fe=Nt.memoizedProps.style,ve=Fe!=null&&Fe.hasOwnProperty("display")?Fe.display:null,Pe.style.display=pt("display",ve))}catch(ir){qs(b,b.return,ir)}}}else if(Nt.tag===6){if(_t===null)try{Nt.stateNode.nodeValue=et?"":Nt.memoizedProps}catch(ir){qs(b,b.return,ir)}}else if((Nt.tag!==22&&Nt.tag!==23||Nt.memoizedState===null||Nt===b)&&Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}if(Nt===b)break e;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===b)break e;_t===Nt&&(_t=null),Nt=Nt.return}_t===Nt&&(_t=null),Nt.sibling.return=Nt.return,Nt=Nt.sibling}}break;case 19:Xl(j,b),Ic(b),Y&4&&rk(b);break;case 21:break;default:Xl(j,b),Ic(b)}}function Ic(b){var j=b.flags;if(j&2){try{e:{for(var $=b.return;$!==null;){if(J6($)){var Y=$;break e}$=$.return}throw Error(t(160))}switch(Y.tag){case 5:var te=Y.stateNode;Y.flags&32&&(ct(te,""),Y.flags&=-33);var oe=ek(b);f2(b,oe,te);break;case 3:case 4:var ve=Y.stateNode.containerInfo,Pe=ek(b);h2(b,Pe,ve);break;default:throw Error(t(161))}}catch(Fe){qs(b,b.return,Fe)}b.flags&=-3}j&4096&&(b.flags&=-4097)}function WB(b,j,$){Ht=b,sk(b)}function sk(b,j,$){for(var Y=(b.mode&1)!==0;Ht!==null;){var te=Ht,oe=te.child;if(te.tag===22&&Y){var ve=te.memoizedState!==null||Ry;if(!ve){var Pe=te.alternate,Fe=Pe!==null&&Pe.memoizedState!==null||Mi;Pe=Ry;var et=Mi;if(Ry=ve,(Mi=Fe)&&!et)for(Ht=te;Ht!==null;)ve=Ht,Fe=ve.child,ve.tag===22&&ve.memoizedState!==null?ok(te):Fe!==null?(Fe.return=ve,Ht=Fe):ok(te);for(;oe!==null;)Ht=oe,sk(oe),oe=oe.sibling;Ht=te,Ry=Pe,Mi=et}ak(b)}else(te.subtreeFlags&8772)!==0&&oe!==null?(oe.return=te,Ht=oe):ak(b)}}function ak(b){for(;Ht!==null;){var j=Ht;if((j.flags&8772)!==0){var $=j.alternate;try{if((j.flags&8772)!==0)switch(j.tag){case 0:case 11:case 15:Mi||Ly(5,j);break;case 1:var Y=j.stateNode;if(j.flags&4&&!Mi)if($===null)Y.componentDidMount();else{var te=j.elementType===j.type?$.memoizedProps:Kl(j.type,$.memoizedProps);Y.componentDidUpdate(te,$.memoizedState,Y.__reactInternalSnapshotBeforeUpdate)}var oe=j.updateQueue;oe!==null&&ho(j,oe,Y);break;case 3:var ve=j.updateQueue;if(ve!==null){if($=null,j.child!==null)switch(j.child.tag){case 5:$=j.child.stateNode;break;case 1:$=j.child.stateNode}ho(j,ve,$)}break;case 5:var Pe=j.stateNode;if($===null&&j.flags&4){$=Pe;var Fe=j.memoizedProps;switch(j.type){case"button":case"input":case"select":case"textarea":Fe.autoFocus&&$.focus();break;case"img":Fe.src&&($.src=Fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(j.memoizedState===null){var et=j.alternate;if(et!==null){var _t=et.memoizedState;if(_t!==null){var Nt=_t.dehydrated;Nt!==null&&lu(Nt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Mi||j.flags&512&&d2(j)}catch(bt){qs(j,j.return,bt)}}if(j===b){Ht=null;break}if($=j.sibling,$!==null){$.return=j.return,Ht=$;break}Ht=j.return}}function ik(b){for(;Ht!==null;){var j=Ht;if(j===b){Ht=null;break}var $=j.sibling;if($!==null){$.return=j.return,Ht=$;break}Ht=j.return}}function ok(b){for(;Ht!==null;){var j=Ht;try{switch(j.tag){case 0:case 11:case 15:var $=j.return;try{Ly(4,j)}catch(Fe){qs(j,$,Fe)}break;case 1:var Y=j.stateNode;if(typeof Y.componentDidMount=="function"){var te=j.return;try{Y.componentDidMount()}catch(Fe){qs(j,te,Fe)}}var oe=j.return;try{d2(j)}catch(Fe){qs(j,oe,Fe)}break;case 5:var ve=j.return;try{d2(j)}catch(Fe){qs(j,ve,Fe)}}}catch(Fe){qs(j,j.return,Fe)}if(j===b){Ht=null;break}var Pe=j.sibling;if(Pe!==null){Pe.return=j.return,Ht=Pe;break}Ht=j.return}}var KB=Math.ceil,Dy=_.ReactCurrentDispatcher,p2=_.ReactCurrentOwner,hl=_.ReactCurrentBatchConfig,gn=0,Ya=null,ya=null,yi=0,$o=0,kp=Ro(0),Ia=0,m0=null,Kh=0,Fy=0,m2=0,g0=null,po=null,g2=0,Sp=1/0,Pu=null,By=!1,y2=null,Wd=null,$y=!1,Kd=null,qy=0,y0=0,x2=null,zy=-1,Uy=0;function Qi(){return(gn&6)!==0?ze():zy!==-1?zy:zy=ze()}function Gd(b){return(b.mode&1)===0?1:(gn&2)!==0&&yi!==0?yi&-yi:Ss.transition!==null?(Uy===0&&(Uy=en()),Uy):(b=Pr,b!==0||(b=window.event,b=b===void 0?16:uu(b.type)),b)}function Yl(b,j,$,Y){if(50<y0)throw y0=0,x2=null,Error(t(185));Ha(b,$,Y),((gn&2)===0||b!==Ya)&&(b===Ya&&((gn&2)===0&&(Fy|=$),Ia===4&&Xd(b,yi)),mo(b,Y),$===1&&gn===0&&(j.mode&1)===0&&(Sp=ze()+500,Uh&&he()))}function mo(b,j){var $=b.callbackNode;Bn(b,j);var Y=ui(b,b===Ya?yi:0);if(Y===0)$!==null&&Pn($),b.callbackNode=null,b.callbackPriority=0;else if(j=Y&-Y,b.callbackPriority!==j){if($!=null&&Pn($),j===1)b.tag===0?ae(ck.bind(null,b)):Z(ck.bind(null,b)),K1(function(){(gn&6)===0&&he()}),$=null;else{switch(Ca(Y)){case 1:$=mt;break;case 4:$=Rt;break;case 16:$=jt;break;case 536870912:$=Dr;break;default:$=jt}$=yk($,lk.bind(null,b))}b.callbackPriority=j,b.callbackNode=$}}function lk(b,j){if(zy=-1,Uy=0,(gn&6)!==0)throw Error(t(327));var $=b.callbackNode;if(Cp()&&b.callbackNode!==$)return null;var Y=ui(b,b===Ya?yi:0);if(Y===0)return null;if((Y&30)!==0||(Y&b.expiredLanes)!==0||j)j=Hy(b,Y);else{j=Y;var te=gn;gn|=2;var oe=dk();(Ya!==b||yi!==j)&&(Pu=null,Sp=ze()+500,Xh(b,j));do try{YB();break}catch(Pe){uk(b,Pe)}while(!0);pn(),Dy.current=oe,gn=te,ya!==null?j=0:(Ya=null,yi=0,j=Ia)}if(j!==0){if(j===2&&(te=ha(b),te!==0&&(Y=te,j=v2(b,te))),j===1)throw $=m0,Xh(b,0),Xd(b,Y),mo(b,ze()),$;if(j===6)Xd(b,Y);else{if(te=b.current.alternate,(Y&30)===0&&!GB(te)&&(j=Hy(b,Y),j===2&&(oe=ha(b),oe!==0&&(Y=oe,j=v2(b,oe))),j===1))throw $=m0,Xh(b,0),Xd(b,Y),mo(b,ze()),$;switch(b.finishedWork=te,b.finishedLanes=Y,j){case 0:case 1:throw Error(t(345));case 2:Yh(b,po,Pu);break;case 3:if(Xd(b,Y),(Y&130023424)===Y&&(j=g2+500-ze(),10<j)){if(ui(b,0)!==0)break;if(te=b.suspendedLanes,(te&Y)!==Y){Qi(),b.pingedLanes|=b.suspendedLanes&te;break}b.timeoutHandle=s0(Yh.bind(null,b,po,Pu),j);break}Yh(b,po,Pu);break;case 4:if(Xd(b,Y),(Y&4194240)===Y)break;for(j=b.eventTimes,te=-1;0<Y;){var ve=31-br(Y);oe=1<<ve,ve=j[ve],ve>te&&(te=ve),Y&=~oe}if(Y=te,Y=ze()-Y,Y=(120>Y?120:480>Y?480:1080>Y?1080:1920>Y?1920:3e3>Y?3e3:4320>Y?4320:1960*KB(Y/1960))-Y,10<Y){b.timeoutHandle=s0(Yh.bind(null,b,po,Pu),Y);break}Yh(b,po,Pu);break;case 5:Yh(b,po,Pu);break;default:throw Error(t(329))}}}return mo(b,ze()),b.callbackNode===$?lk.bind(null,b):null}function v2(b,j){var $=g0;return b.current.memoizedState.isDehydrated&&(Xh(b,j).flags|=256),b=Hy(b,j),b!==2&&(j=po,po=$,j!==null&&b2(j)),b}function b2(b){po===null?po=b:po.push.apply(po,b)}function GB(b){for(var j=b;;){if(j.flags&16384){var $=j.updateQueue;if($!==null&&($=$.stores,$!==null))for(var Y=0;Y<$.length;Y++){var te=$[Y],oe=te.getSnapshot;te=te.value;try{if(!us(oe(),te))return!1}catch{return!1}}}if($=j.child,j.subtreeFlags&16384&&$!==null)$.return=j,j=$;else{if(j===b)break;for(;j.sibling===null;){if(j.return===null||j.return===b)return!0;j=j.return}j.sibling.return=j.return,j=j.sibling}}return!0}function Xd(b,j){for(j&=~m2,j&=~Fy,b.suspendedLanes|=j,b.pingedLanes&=~j,b=b.expirationTimes;0<j;){var $=31-br(j),Y=1<<$;b[$]=-1,j&=~Y}}function ck(b){if((gn&6)!==0)throw Error(t(327));Cp();var j=ui(b,0);if((j&1)===0)return mo(b,ze()),null;var $=Hy(b,j);if(b.tag!==0&&$===2){var Y=ha(b);Y!==0&&(j=Y,$=v2(b,Y))}if($===1)throw $=m0,Xh(b,0),Xd(b,j),mo(b,ze()),$;if($===6)throw Error(t(345));return b.finishedWork=b.current.alternate,b.finishedLanes=j,Yh(b,po,Pu),mo(b,ze()),null}function w2(b,j){var $=gn;gn|=1;try{return b(j)}finally{gn=$,gn===0&&(Sp=ze()+500,Uh&&he())}}function Gh(b){Kd!==null&&Kd.tag===0&&(gn&6)===0&&Cp();var j=gn;gn|=1;var $=hl.transition,Y=Pr;try{if(hl.transition=null,Pr=1,b)return b()}finally{Pr=Y,hl.transition=$,gn=j,(gn&6)===0&&he()}}function _2(){$o=kp.current,jn(kp)}function Xh(b,j){b.finishedWork=null,b.finishedLanes=0;var $=b.timeoutHandle;if($!==-1&&(b.timeoutHandle=-1,_y($)),ya!==null)for($=ya.return;$!==null;){var Y=$;switch(Ge(Y),Y.tag){case 1:Y=Y.type.childContextTypes,Y!=null&&fp();break;case 3:cl(),jn(Ei),jn(Oa),u0();break;case 5:l0(Y);break;case 4:cl();break;case 13:jn(Vn);break;case 19:jn(Vn);break;case 10:Yn(Y.type._context);break;case 22:case 23:_2()}$=$.return}if(Ya=b,ya=b=Yd(b.current,null),yi=$o=j,Ia=0,m0=null,m2=Fy=Kh=0,po=g0=null,Mn!==null){for(j=0;j<Mn.length;j++)if($=Mn[j],Y=$.interleaved,Y!==null){$.interleaved=null;var te=Y.next,oe=$.pending;if(oe!==null){var ve=oe.next;oe.next=te,Y.next=ve}$.pending=Y}Mn=null}return b}function uk(b,j){do{var $=ya;try{if(pn(),pp.current=Py,zd){for(var Y=Qn.memoizedState;Y!==null;){var te=Y.queue;te!==null&&(te.pending=null),Y=Y.next}zd=!1}if(ul=0,Ts=$s=Qn=null,Vl=!1,Ud=0,p2.current=null,$===null||$.return===null){Ia=1,m0=j,ya=null;break}e:{var oe=b,ve=$.return,Pe=$,Fe=j;if(j=yi,Pe.flags|=32768,Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var et=Fe,_t=Pe,Nt=_t.tag;if((_t.mode&1)===0&&(Nt===0||Nt===11||Nt===15)){var bt=_t.alternate;bt?(_t.updateQueue=bt.updateQueue,_t.memoizedState=bt.memoizedState,_t.lanes=bt.lanes):(_t.updateQueue=null,_t.memoizedState=null)}var $t=R6(ve);if($t!==null){$t.flags&=-257,L6($t,ve,Pe,oe,j),$t.mode&1&&I6(oe,et,j),j=$t,Fe=et;var Jt=j.updateQueue;if(Jt===null){var ir=new Set;ir.add(Fe),j.updateQueue=ir}else Jt.add(Fe);break e}else{if((j&1)===0){I6(oe,et,j),j2();break e}Fe=Error(t(426))}}else if(ut&&Pe.mode&1){var ra=R6(ve);if(ra!==null){(ra.flags&65536)===0&&(ra.flags|=256),L6(ra,ve,Pe,oe,j),Ot(jp(Fe,Pe));break e}}oe=Fe=jp(Fe,Pe),Ia!==4&&(Ia=2),g0===null?g0=[oe]:g0.push(oe),oe=ve;do{switch(oe.tag){case 3:oe.flags|=65536,j&=-j,oe.lanes|=j;var Ke=O6(oe,Fe,j);Rn(oe,Ke);break e;case 1:Pe=Fe;var qe=oe.type,Ye=oe.stateNode;if((oe.flags&128)===0&&(typeof qe.getDerivedStateFromError=="function"||Ye!==null&&typeof Ye.componentDidCatch=="function"&&(Wd===null||!Wd.has(Ye)))){oe.flags|=65536,j&=-j,oe.lanes|=j;var Et=M6(oe,Pe,j);Rn(oe,Et);break e}}oe=oe.return}while(oe!==null)}fk($)}catch(hr){j=hr,ya===$&&$!==null&&(ya=$=$.return);continue}break}while(!0)}function dk(){var b=Dy.current;return Dy.current=Py,b===null?Py:b}function j2(){(Ia===0||Ia===3||Ia===2)&&(Ia=4),Ya===null||(Kh&268435455)===0&&(Fy&268435455)===0||Xd(Ya,yi)}function Hy(b,j){var $=gn;gn|=2;var Y=dk();(Ya!==b||yi!==j)&&(Pu=null,Xh(b,j));do try{XB();break}catch(te){uk(b,te)}while(!0);if(pn(),gn=$,Dy.current=Y,ya!==null)throw Error(t(261));return Ya=null,yi=0,Ia}function XB(){for(;ya!==null;)hk(ya)}function YB(){for(;ya!==null&&!js();)hk(ya)}function hk(b){var j=gk(b.alternate,b,$o);b.memoizedProps=b.pendingProps,j===null?fk(b):ya=j,p2.current=null}function fk(b){var j=b;do{var $=j.alternate;if(b=j.return,(j.flags&32768)===0){if($=zB($,j,$o),$!==null){ya=$;return}}else{if($=UB($,j),$!==null){$.flags&=32767,ya=$;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{Ia=6,ya=null;return}}if(j=j.sibling,j!==null){ya=j;return}ya=j=b}while(j!==null);Ia===0&&(Ia=5)}function Yh(b,j,$){var Y=Pr,te=hl.transition;try{hl.transition=null,Pr=1,QB(b,j,$,Y)}finally{hl.transition=te,Pr=Y}return null}function QB(b,j,$,Y){do Cp();while(Kd!==null);if((gn&6)!==0)throw Error(t(327));$=b.finishedWork;var te=b.finishedLanes;if($===null)return null;if(b.finishedWork=null,b.finishedLanes=0,$===b.current)throw Error(t(177));b.callbackNode=null,b.callbackPriority=0;var oe=$.lanes|$.childLanes;if(fa(b,oe),b===Ya&&(ya=Ya=null,yi=0),($.subtreeFlags&2064)===0&&($.flags&2064)===0||$y||($y=!0,yk(jt,function(){return Cp(),null})),oe=($.flags&15990)!==0,($.subtreeFlags&15990)!==0||oe){oe=hl.transition,hl.transition=null;var ve=Pr;Pr=1;var Pe=gn;gn|=4,p2.current=null,VB(b,$),nk($,b),Mh(ku),kd=!!qh,ku=qh=null,b.current=$,WB($),Ee(),gn=Pe,Pr=ve,hl.transition=oe}else b.current=$;if($y&&($y=!1,Kd=b,qy=te),oe=b.pendingLanes,oe===0&&(Wd=null),dr($.stateNode),mo(b,ze()),j!==null)for(Y=b.onRecoverableError,$=0;$<j.length;$++)te=j[$],Y(te.value,{componentStack:te.stack,digest:te.digest});if(By)throw By=!1,b=y2,y2=null,b;return(qy&1)!==0&&b.tag!==0&&Cp(),oe=b.pendingLanes,(oe&1)!==0?b===x2?y0++:(y0=0,x2=b):y0=0,he(),null}function Cp(){if(Kd!==null){var b=Ca(qy),j=hl.transition,$=Pr;try{if(hl.transition=null,Pr=16>b?16:b,Kd===null)var Y=!1;else{if(b=Kd,Kd=null,qy=0,(gn&6)!==0)throw Error(t(331));var te=gn;for(gn|=4,Ht=b.current;Ht!==null;){var oe=Ht,ve=oe.child;if((Ht.flags&16)!==0){var Pe=oe.deletions;if(Pe!==null){for(var Fe=0;Fe<Pe.length;Fe++){var et=Pe[Fe];for(Ht=et;Ht!==null;){var _t=Ht;switch(_t.tag){case 0:case 11:case 15:p0(8,_t,oe)}var Nt=_t.child;if(Nt!==null)Nt.return=_t,Ht=Nt;else for(;Ht!==null;){_t=Ht;var bt=_t.sibling,$t=_t.return;if(Z6(_t),_t===et){Ht=null;break}if(bt!==null){bt.return=$t,Ht=bt;break}Ht=$t}}}var Jt=oe.alternate;if(Jt!==null){var ir=Jt.child;if(ir!==null){Jt.child=null;do{var ra=ir.sibling;ir.sibling=null,ir=ra}while(ir!==null)}}Ht=oe}}if((oe.subtreeFlags&2064)!==0&&ve!==null)ve.return=oe,Ht=ve;else e:for(;Ht!==null;){if(oe=Ht,(oe.flags&2048)!==0)switch(oe.tag){case 0:case 11:case 15:p0(9,oe,oe.return)}var Ke=oe.sibling;if(Ke!==null){Ke.return=oe.return,Ht=Ke;break e}Ht=oe.return}}var qe=b.current;for(Ht=qe;Ht!==null;){ve=Ht;var Ye=ve.child;if((ve.subtreeFlags&2064)!==0&&Ye!==null)Ye.return=ve,Ht=Ye;else e:for(ve=qe;Ht!==null;){if(Pe=Ht,(Pe.flags&2048)!==0)try{switch(Pe.tag){case 0:case 11:case 15:Ly(9,Pe)}}catch(hr){qs(Pe,Pe.return,hr)}if(Pe===ve){Ht=null;break e}var Et=Pe.sibling;if(Et!==null){Et.return=Pe.return,Ht=Et;break e}Ht=Pe.return}}if(gn=te,he(),yr&&typeof yr.onPostCommitFiberRoot=="function")try{yr.onPostCommitFiberRoot(wr,b)}catch{}Y=!0}return Y}finally{Pr=$,hl.transition=j}}return!1}function pk(b,j,$){j=jp($,j),j=O6(b,j,1),b=As(b,j,1),j=Qi(),b!==null&&(Ha(b,1,j),mo(b,j))}function qs(b,j,$){if(b.tag===3)pk(b,b,$);else for(;j!==null;){if(j.tag===3){pk(j,b,$);break}else if(j.tag===1){var Y=j.stateNode;if(typeof j.type.getDerivedStateFromError=="function"||typeof Y.componentDidCatch=="function"&&(Wd===null||!Wd.has(Y))){b=jp($,b),b=M6(j,b,1),j=As(j,b,1),b=Qi(),j!==null&&(Ha(j,1,b),mo(j,b));break}}j=j.return}}function ZB(b,j,$){var Y=b.pingCache;Y!==null&&Y.delete(j),j=Qi(),b.pingedLanes|=b.suspendedLanes&$,Ya===b&&(yi&$)===$&&(Ia===4||Ia===3&&(yi&130023424)===yi&&500>ze()-g2?Xh(b,0):m2|=$),mo(b,j)}function mk(b,j){j===0&&((b.mode&1)===0?j=1:(j=_n,_n<<=1,(_n&130023424)===0&&(_n=4194304)));var $=Qi();b=In(b,j),b!==null&&(Ha(b,j,$),mo(b,$))}function JB(b){var j=b.memoizedState,$=0;j!==null&&($=j.retryLane),mk(b,$)}function e$(b,j){var $=0;switch(b.tag){case 13:var Y=b.stateNode,te=b.memoizedState;te!==null&&($=te.retryLane);break;case 19:Y=b.stateNode;break;default:throw Error(t(314))}Y!==null&&Y.delete(j),mk(b,$)}var gk;gk=function(b,j,$){if(b!==null)if(b.memoizedProps!==j.pendingProps||Ei.current)fo=!0;else{if((b.lanes&$)===0&&(j.flags&128)===0)return fo=!1,qB(b,j,$);fo=(b.flags&131072)!==0}else fo=!1,ut&&(j.flags&1048576)!==0&&Ve(j,Ne,j.index);switch(j.lanes=0,j.tag){case 2:var Y=j.type;Iy(b,j),b=j.pendingProps;var te=$d(j,Oa.current);fs(j,$),te=Hh(null,j,Y,b,te,$);var oe=dl();return j.flags|=1,typeof te=="object"&&te!==null&&typeof te.render=="function"&&te.$$typeof===void 0?(j.tag=1,j.memoizedState=null,j.updateQueue=null,Ti(Y)?(oe=!0,Au(j)):oe=!1,j.memoizedState=te.state!==null&&te.state!==void 0?te.state:null,Ma(j),te.updater=Oy,j.stateNode=te,te._reactInternals=j,e2(j,Y,b,$),j=s2(null,j,Y,!0,oe,$)):(j.tag=0,ut&&oe&&at(j),Yi(null,j,te,$),j=j.child),j;case 16:Y=j.elementType;e:{switch(Iy(b,j),b=j.pendingProps,te=Y._init,Y=te(Y._payload),j.type=Y,te=j.tag=r$(Y),b=Kl(Y,b),te){case 0:j=n2(null,j,Y,b,$);break e;case 1:j=z6(null,j,Y,b,$);break e;case 11:j=D6(null,j,Y,b,$);break e;case 14:j=F6(null,j,Y,Kl(Y.type,b),$);break e}throw Error(t(306,Y,""))}return j;case 0:return Y=j.type,te=j.pendingProps,te=j.elementType===Y?te:Kl(Y,te),n2(b,j,Y,te,$);case 1:return Y=j.type,te=j.pendingProps,te=j.elementType===Y?te:Kl(Y,te),z6(b,j,Y,te,$);case 3:e:{if(U6(j),b===null)throw Error(t(387));Y=j.pendingProps,oe=j.memoizedState,te=oe.element,Pi(b,j),Xa(j,Y,null,$);var ve=j.memoizedState;if(Y=ve.element,oe.isDehydrated)if(oe={element:Y,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},j.updateQueue.baseState=oe,j.memoizedState=oe,j.flags&256){te=jp(Error(t(423)),j),j=H6(b,j,Y,$,te);break e}else if(Y!==te){te=jp(Error(t(424)),j),j=H6(b,j,Y,$,te);break e}else for(st=mi(j.stateNode.containerInfo.firstChild),tt=j,ut=!0,ft=null,$=ss(j,null,Y,$),j.child=$;$;)$.flags=$.flags&-3|4096,$=$.sibling;else{if(zt(),Y===te){j=Tu(b,j,$);break e}Yi(b,j,Y,$)}j=j.child}return j;case 5:return Sy(j),b===null&&Yt(j),Y=j.type,te=j.pendingProps,oe=b!==null?b.memoizedProps:null,ve=te.children,n0(Y,te)?ve=null:oe!==null&&n0(Y,oe)&&(j.flags|=32),q6(b,j),Yi(b,j,ve,$),j.child;case 6:return b===null&&Yt(j),null;case 13:return V6(b,j,$);case 4:return qd(j,j.stateNode.containerInfo),Y=j.pendingProps,b===null?j.child=Fs(j,null,Y,$):Yi(b,j,Y,$),j.child;case 11:return Y=j.type,te=j.pendingProps,te=j.elementType===Y?te:Kl(Y,te),D6(b,j,Y,te,$);case 7:return Yi(b,j,j.pendingProps,$),j.child;case 8:return Yi(b,j,j.pendingProps.children,$),j.child;case 12:return Yi(b,j,j.pendingProps.children,$),j.child;case 10:e:{if(Y=j.type._context,te=j.pendingProps,oe=j.memoizedProps,ve=te.value,kn(ea,Y._currentValue),Y._currentValue=ve,oe!==null)if(us(oe.value,ve)){if(oe.children===te.children&&!Ei.current){j=Tu(b,j,$);break e}}else for(oe=j.child,oe!==null&&(oe.return=j);oe!==null;){var Pe=oe.dependencies;if(Pe!==null){ve=oe.child;for(var Fe=Pe.firstContext;Fe!==null;){if(Fe.context===Y){if(oe.tag===1){Fe=Cs(-1,$&-$),Fe.tag=2;var et=oe.updateQueue;if(et!==null){et=et.shared;var _t=et.pending;_t===null?Fe.next=Fe:(Fe.next=_t.next,_t.next=Fe),et.pending=Fe}}oe.lanes|=$,Fe=oe.alternate,Fe!==null&&(Fe.lanes|=$),mn(oe.return,$,j),Pe.lanes|=$;break}Fe=Fe.next}}else if(oe.tag===10)ve=oe.type===j.type?null:oe.child;else if(oe.tag===18){if(ve=oe.return,ve===null)throw Error(t(341));ve.lanes|=$,Pe=ve.alternate,Pe!==null&&(Pe.lanes|=$),mn(ve,$,j),ve=oe.sibling}else ve=oe.child;if(ve!==null)ve.return=oe;else for(ve=oe;ve!==null;){if(ve===j){ve=null;break}if(oe=ve.sibling,oe!==null){oe.return=ve.return,ve=oe;break}ve=ve.return}oe=ve}Yi(b,j,te.children,$),j=j.child}return j;case 9:return te=j.type,Y=j.pendingProps.children,fs(j,$),te=ps(te),Y=Y(te),j.flags|=1,Yi(b,j,Y,$),j.child;case 14:return Y=j.type,te=Kl(Y,j.pendingProps),te=Kl(Y.type,te),F6(b,j,Y,te,$);case 15:return B6(b,j,j.type,j.pendingProps,$);case 17:return Y=j.type,te=j.pendingProps,te=j.elementType===Y?te:Kl(Y,te),Iy(b,j),j.tag=1,Ti(Y)?(b=!0,Au(j)):b=!1,fs(j,$),T6(j,Y,te),e2(j,Y,te,$),s2(null,j,Y,!0,b,$);case 19:return K6(b,j,$);case 22:return $6(b,j,$)}throw Error(t(156,j.tag))};function yk(b,j){return Tn(b,j)}function t$(b,j,$,Y){this.tag=b,this.key=$,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=j,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fl(b,j,$,Y){return new t$(b,j,$,Y)}function N2(b){return b=b.prototype,!(!b||!b.isReactComponent)}function r$(b){if(typeof b=="function")return N2(b)?1:0;if(b!=null){if(b=b.$$typeof,b===z)return 11;if(b===E)return 14}return 2}function Yd(b,j){var $=b.alternate;return $===null?($=fl(b.tag,j,b.key,b.mode),$.elementType=b.elementType,$.type=b.type,$.stateNode=b.stateNode,$.alternate=b,b.alternate=$):($.pendingProps=j,$.type=b.type,$.flags=0,$.subtreeFlags=0,$.deletions=null),$.flags=b.flags&14680064,$.childLanes=b.childLanes,$.lanes=b.lanes,$.child=b.child,$.memoizedProps=b.memoizedProps,$.memoizedState=b.memoizedState,$.updateQueue=b.updateQueue,j=b.dependencies,$.dependencies=j===null?null:{lanes:j.lanes,firstContext:j.firstContext},$.sibling=b.sibling,$.index=b.index,$.ref=b.ref,$}function Vy(b,j,$,Y,te,oe){var ve=2;if(Y=b,typeof b=="function")N2(b)&&(ve=1);else if(typeof b=="string")ve=5;else e:switch(b){case B:return Qh($.children,te,oe,j);case T:ve=8,te|=8;break;case I:return b=fl(12,$,j,te|2),b.elementType=I,b.lanes=oe,b;case O:return b=fl(13,$,j,te),b.elementType=O,b.lanes=oe,b;case L:return b=fl(19,$,j,te),b.elementType=L,b.lanes=oe,b;case N:return Wy($,te,oe,j);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case U:ve=10;break e;case H:ve=9;break e;case z:ve=11;break e;case E:ve=14;break e;case k:ve=16,Y=null;break e}throw Error(t(130,b==null?b:typeof b,""))}return j=fl(ve,$,j,te),j.elementType=b,j.type=Y,j.lanes=oe,j}function Qh(b,j,$,Y){return b=fl(7,b,Y,j),b.lanes=$,b}function Wy(b,j,$,Y){return b=fl(22,b,Y,j),b.elementType=N,b.lanes=$,b.stateNode={isHidden:!1},b}function k2(b,j,$){return b=fl(6,b,null,j),b.lanes=$,b}function S2(b,j,$){return j=fl(4,b.children!==null?b.children:[],b.key,j),j.lanes=$,j.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},j}function n$(b,j,$,Y,te){this.tag=j,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gr(0),this.expirationTimes=Gr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gr(0),this.identifierPrefix=Y,this.onRecoverableError=te,this.mutableSourceEagerHydrationData=null}function C2(b,j,$,Y,te,oe,ve,Pe,Fe){return b=new n$(b,j,$,Pe,Fe),j===1?(j=1,oe===!0&&(j|=8)):j=0,oe=fl(3,null,null,j),b.current=oe,oe.stateNode=b,oe.memoizedState={element:Y,isDehydrated:$,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(oe),b}function s$(b,j,$){var Y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:Y==null?null:""+Y,children:b,containerInfo:j,implementation:$}}function xk(b){if(!b)return Pc;b=b._reactInternals;e:{if(It(b)!==b||b.tag!==1)throw Error(t(170));var j=b;do{switch(j.tag){case 3:j=j.stateNode.context;break e;case 1:if(Ti(j.type)){j=j.stateNode.__reactInternalMemoizedMergedChildContext;break e}}j=j.return}while(j!==null);throw Error(t(171))}if(b.tag===1){var $=b.type;if(Ti($))return o0(b,$,j)}return j}function vk(b,j,$,Y,te,oe,ve,Pe,Fe){return b=C2($,Y,!0,b,te,oe,ve,Pe,Fe),b.context=xk(null),$=b.current,Y=Qi(),te=Gd($),oe=Cs(Y,te),oe.callback=j??null,As($,oe,te),b.current.lanes=te,Ha(b,te,Y),mo(b,Y),b}function Ky(b,j,$,Y){var te=j.current,oe=Qi(),ve=Gd(te);return $=xk($),j.context===null?j.context=$:j.pendingContext=$,j=Cs(oe,ve),j.payload={element:b},Y=Y===void 0?null:Y,Y!==null&&(j.callback=Y),b=As(te,j,ve),b!==null&&(Yl(b,te,ve,oe),Ga(b,te,ve)),ve}function Gy(b){return b=b.current,b.child?(b.child.tag===5,b.child.stateNode):null}function bk(b,j){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var $=b.retryLane;b.retryLane=$!==0&&$<j?$:j}}function A2(b,j){bk(b,j),(b=b.alternate)&&bk(b,j)}function a$(){return null}var wk=typeof reportError=="function"?reportError:function(b){console.error(b)};function E2(b){this._internalRoot=b}Xy.prototype.render=E2.prototype.render=function(b){var j=this._internalRoot;if(j===null)throw Error(t(409));Ky(b,j,null,null)},Xy.prototype.unmount=E2.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var j=b.containerInfo;Gh(function(){Ky(null,b,null,null)}),j[Wa]=null}};function Xy(b){this._internalRoot=b}Xy.prototype.unstable_scheduleHydration=function(b){if(b){var j=Eo();b={blockedOn:null,target:b,priority:j};for(var $=0;$<hi.length&&j!==0&&j<hi[$].priority;$++);hi.splice($,0,b),$===0&&ap(b)}};function T2(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function Yy(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11&&(b.nodeType!==8||b.nodeValue!==" react-mount-point-unstable "))}function _k(){}function i$(b,j,$,Y,te){if(te){if(typeof Y=="function"){var oe=Y;Y=function(){var et=Gy(ve);oe.call(et)}}var ve=vk(j,Y,b,0,null,!1,!1,"",_k);return b._reactRootContainer=ve,b[Wa]=ve.current,ju(b.nodeType===8?b.parentNode:b),Gh(),ve}for(;te=b.lastChild;)b.removeChild(te);if(typeof Y=="function"){var Pe=Y;Y=function(){var et=Gy(Fe);Pe.call(et)}}var Fe=C2(b,0,!1,null,null,!1,!1,"",_k);return b._reactRootContainer=Fe,b[Wa]=Fe.current,ju(b.nodeType===8?b.parentNode:b),Gh(function(){Ky(j,Fe,$,Y)}),Fe}function Qy(b,j,$,Y,te){var oe=$._reactRootContainer;if(oe){var ve=oe;if(typeof te=="function"){var Pe=te;te=function(){var Fe=Gy(ve);Pe.call(Fe)}}Ky(j,ve,b,te)}else ve=i$($,j,b,te,Y);return Gy(ve)}Aa=function(b){switch(b.tag){case 3:var j=b.stateNode;if(j.current.memoizedState.isDehydrated){var $=cs(j.pendingLanes);$!==0&&(Co(j,$|1),mo(j,ze()),(gn&6)===0&&(Sp=ze()+500,he()))}break;case 13:Gh(function(){var Y=In(b,1);if(Y!==null){var te=Qi();Yl(Y,b,1,te)}}),A2(b,1)}},Ao=function(b){if(b.tag===13){var j=In(b,134217728);if(j!==null){var $=Qi();Yl(j,b,134217728,$)}A2(b,134217728)}},Pl=function(b){if(b.tag===13){var j=Gd(b),$=In(b,j);if($!==null){var Y=Qi();Yl($,b,j,Y)}A2(b,j)}},Eo=function(){return Pr},di=function(b,j){var $=Pr;try{return Pr=b,j()}finally{Pr=$}},xt=function(b,j,$){switch(j){case"input":if(ue(b,$),j=$.name,$.type==="radio"&&j!=null){for($=b;$.parentNode;)$=$.parentNode;for($=$.querySelectorAll("input[name="+JSON.stringify(""+j)+'][type="radio"]'),j=0;j<$.length;j++){var Y=$[j];if(Y!==b&&Y.form===b.form){var te=zh(Y);if(!te)throw Error(t(90));ie(Y),ue(Y,te)}}}break;case"textarea":Oe(b,$);break;case"select":j=$.value,j!=null&&fe(b,!!$.multiple,j,!1)}},Ft=w2,Er=Gh;var o$={usingClientEntryPoint:!1,Events:[Bd,Su,zh,ar,qr,w2]},x0={findFiberByHostInstance:Tc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l$={bundleType:x0.bundleType,version:x0.version,rendererPackageName:x0.rendererPackageName,rendererConfig:x0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(b){return b=an(b),b===null?null:b.stateNode},findFiberByHostInstance:x0.findFiberByHostInstance||a$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zy.isDisabled&&Zy.supportsFiber)try{wr=Zy.inject(l$),yr=Zy}catch{}}return go.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o$,go.createPortal=function(b,j){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T2(j))throw Error(t(200));return s$(b,j,null,$)},go.createRoot=function(b,j){if(!T2(b))throw Error(t(299));var $=!1,Y="",te=wk;return j!=null&&(j.unstable_strictMode===!0&&($=!0),j.identifierPrefix!==void 0&&(Y=j.identifierPrefix),j.onRecoverableError!==void 0&&(te=j.onRecoverableError)),j=C2(b,1,!1,null,null,$,!1,Y,te),b[Wa]=j.current,ju(b.nodeType===8?b.parentNode:b),new E2(j)},go.findDOMNode=function(b){if(b==null)return null;if(b.nodeType===1)return b;var j=b._reactInternals;if(j===void 0)throw typeof b.render=="function"?Error(t(188)):(b=Object.keys(b).join(","),Error(t(268,b)));return b=an(j),b=b===null?null:b.stateNode,b},go.flushSync=function(b){return Gh(b)},go.hydrate=function(b,j,$){if(!Yy(j))throw Error(t(200));return Qy(null,b,j,!0,$)},go.hydrateRoot=function(b,j,$){if(!T2(b))throw Error(t(405));var Y=$!=null&&$.hydratedSources||null,te=!1,oe="",ve=wk;if($!=null&&($.unstable_strictMode===!0&&(te=!0),$.identifierPrefix!==void 0&&(oe=$.identifierPrefix),$.onRecoverableError!==void 0&&(ve=$.onRecoverableError)),j=vk(j,null,b,1,$??null,te,!1,oe,ve),b[Wa]=j.current,ju(b),Y)for(b=0;b<Y.length;b++)$=Y[b],te=$._getVersion,te=te($._source),j.mutableSourceEagerHydrationData==null?j.mutableSourceEagerHydrationData=[$,te]:j.mutableSourceEagerHydrationData.push($,te);return new Xy(j)},go.render=function(b,j,$){if(!Yy(j))throw Error(t(200));return Qy(null,b,j,!1,$)},go.unmountComponentAtNode=function(b){if(!Yy(b))throw Error(t(40));return b._reactRootContainer?(Gh(function(){Qy(null,null,b,!1,function(){b._reactRootContainer=null,b[Wa]=null})}),!0):!1},go.unstable_batchedUpdates=w2,go.unstable_renderSubtreeIntoContainer=function(b,j,$,Y){if(!Yy($))throw Error(t(200));if(b==null||b._reactInternals===void 0)throw Error(t(38));return Qy(b,j,$,!1,Y)},go.version="18.3.1-next-f1338f8080-20240426",go}var Tk;function wP(){if(Tk)return M2.exports;Tk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),M2.exports=y$(),M2.exports}var Pk;function x$(){if(Pk)return Jy;Pk=1;var e=wP();return Jy.createRoot=e.createRoot,Jy.hydrateRoot=e.hydrateRoot,Jy}var v$=x$();var Ok="popstate";function b$(e={}){function r(n,a){let{pathname:i,search:o,hash:c}=n.location;return T5("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(n,a){return typeof a=="string"?a:ig(a)}return _$(r,t,null,e)}function ws(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Qo(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function w$(){return Math.random().toString(36).substring(2,10)}function Mk(e,r){return{usr:e.state,key:e.key,idx:r}}function T5(e,r,t=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?Em(r):r,state:t,key:r&&r.key||n||w$()}}function ig({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Em(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substring(n),e=e.substring(0,n)),e&&(r.pathname=e)}return r}function _$(e,r,t,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,c="POP",u=null,l=d();l==null&&(l=0,o.replaceState({...o.state,idx:l},""));function d(){return(o.state||{idx:null}).idx}function f(){c="POP";let m=d(),x=m==null?null:m-l;l=m,u&&u({action:c,location:g.location,delta:x})}function p(m,x){c="PUSH";let v=T5(g.location,m,x);l=d()+1;let w=Mk(v,l),_=g.createHref(v);try{o.pushState(w,"",_)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(_)}i&&u&&u({action:c,location:g.location,delta:1})}function h(m,x){c="REPLACE";let v=T5(g.location,m,x);l=d();let w=Mk(v,l),_=g.createHref(v);o.replaceState(w,"",_),i&&u&&u({action:c,location:g.location,delta:0})}function y(m){return j$(m)}let g={get action(){return c},get location(){return e(a,o)},listen(m){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(Ok,f),u=m,()=>{a.removeEventListener(Ok,f),u=null}},createHref(m){return r(a,m)},createURL:y,encodeLocation(m){let x=y(m);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:h,go(m){return o.go(m)}};return g}function j$(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ws(t,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:ig(e);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function _P(e,r,t="/"){return N$(e,r,t,!1)}function N$(e,r,t,n){let a=typeof r=="string"?Em(r):r,i=nd(a.pathname||"/",t);if(i==null)return null;let o=jP(e);k$(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let l=L$(i);c=I$(o[u],l,n)}return c}function jP(e,r=[],t=[],n="",a=!1){let i=(o,c,u=a,l)=>{let d={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(n)&&u)return;ws(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length)}let f=Ju([n,d.relativePath]),p=t.concat(d);o.children&&o.children.length>0&&(ws(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),jP(o.children,r,p,f,u)),!(o.path==null&&!o.index)&&r.push({path:f,score:O$(f,o.index),routesMeta:p})};return e.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))i(o,c);else for(let u of NP(o.path))i(o,c,!0,u)}),r}function NP(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,a=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=NP(n.join("/")),c=[];return c.push(...o.map(u=>u===""?i:[i,u].join("/"))),a&&c.push(...o),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function k$(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:M$(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var S$=/^:[\w-]+$/,C$=3,A$=2,E$=1,T$=10,P$=-2,Ik=e=>e==="*";function O$(e,r){let t=e.split("/"),n=t.length;return t.some(Ik)&&(n+=P$),r&&(n+=A$),t.filter(a=>!Ik(a)).reduce((a,i)=>a+(S$.test(i)?C$:i===""?E$:T$),n)}function M$(e,r){return e.length===r.length&&e.slice(0,-1).every((n,a)=>n===r[a])?e[e.length-1]-r[r.length-1]:0}function I$(e,r,t=!1){let{routesMeta:n}=e,a={},i="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],l=c===n.length-1,d=i==="/"?r:r.slice(i.length)||"/",f=fv({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},d),p=u.route;if(!f&&l&&t&&!n[n.length-1].route.index&&(f=fv({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:Ju([i,f.pathname]),pathnameBase:$$(Ju([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=Ju([i,f.pathnameBase]))}return o}function fv(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=R$(e.path,e.caseSensitive,e.end),a=r.match(t);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((l,{paramName:d,isOptional:f},p)=>{if(d==="*"){let y=c[p]||"";o=i.slice(0,i.length-y.length).replace(/(.)\/+$/,"$1")}const h=c[p];return f&&!h?l[d]=void 0:l[d]=(h||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:e}}function R$(e,r=!1,t=!0){Qo(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),n]}function L$(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Qo(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function nd(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}var kP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,D$=e=>kP.test(e);function F$(e,r="/"){let{pathname:t,search:n="",hash:a=""}=typeof e=="string"?Em(e):e,i;if(t)if(D$(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Qo(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${t}`)}t.startsWith("/")?i=Rk(t.substring(1),"/"):i=Rk(t,r)}else i=r;return{pathname:i,search:q$(n),hash:z$(a)}}function Rk(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function L2(e,r,t,n){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function B$(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function O4(e){let r=B$(e);return r.map((t,n)=>n===r.length-1?t.pathname:t.pathnameBase)}function M4(e,r,t,n=!1){let a;typeof e=="string"?a=Em(e):(a={...e},ws(!a.pathname||!a.pathname.includes("?"),L2("?","pathname","search",a)),ws(!a.pathname||!a.pathname.includes("#"),L2("#","pathname","hash",a)),ws(!a.search||!a.search.includes("#"),L2("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=t;else{let f=r.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}c=f>=0?r[f]:"/"}let u=F$(a,c),l=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(l||d)&&(u.pathname+="/"),u}var Ju=e=>e.join("/").replace(/\/\/+/g,"/"),$$=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q$=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,z$=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,U$=class{constructor(e,r,t,n=!1){this.status=e,this.statusText=r||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function H$(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function V$(e){return e.map(r=>r.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var SP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function CP(e,r){let t=e;if(typeof t!="string"||!kP.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,a=!1;if(SP)try{let i=new URL(window.location.href),o=t.startsWith("//")?new URL(i.protocol+t):new URL(t),c=nd(o.pathname,r);o.origin===i.origin&&c!=null?t=c+o.search+o.hash:a=!0}catch{Qo(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var AP=["POST","PUT","PATCH","DELETE"];new Set(AP);var W$=["GET",...AP];new Set(W$);var Tm=R.createContext(null);Tm.displayName="DataRouter";var Ob=R.createContext(null);Ob.displayName="DataRouterState";var K$=R.createContext(!1),EP=R.createContext({isTransitioning:!1});EP.displayName="ViewTransition";var G$=R.createContext(new Map);G$.displayName="Fetchers";var X$=R.createContext(null);X$.displayName="Await";var el=R.createContext(null);el.displayName="Navigation";var Ug=R.createContext(null);Ug.displayName="Location";var Cl=R.createContext({outlet:null,matches:[],isDataRoute:!1});Cl.displayName="Route";var I4=R.createContext(null);I4.displayName="RouteError";var TP="REACT_ROUTER_ERROR",Y$="REDIRECT",Q$="ROUTE_ERROR_RESPONSE";function Z$(e){if(e.startsWith(`${TP}:${Y$}:{`))try{let r=JSON.parse(e.slice(28));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.location=="string"&&typeof r.reloadDocument=="boolean"&&typeof r.replace=="boolean")return r}catch{}}function J$(e){if(e.startsWith(`${TP}:${Q$}:{`))try{let r=JSON.parse(e.slice(40));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string")return new U$(r.status,r.statusText,r.data)}catch{}}function eq(e,{relative:r}={}){ws(Pm(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=R.useContext(el),{hash:a,pathname:i,search:o}=Hg(e,{relative:r}),c=i;return t!=="/"&&(c=i==="/"?t:Ju([t,i])),n.createHref({pathname:c,search:o,hash:a})}function Pm(){return R.useContext(Ug)!=null}function jo(){return ws(Pm(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(Ug).location}var PP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function OP(e){R.useContext(el).static||R.useLayoutEffect(e)}function ts(){let{isDataRoute:e}=R.useContext(Cl);return e?mq():tq()}function tq(){ws(Pm(),"useNavigate() may be used only in the context of a <Router> component.");let e=R.useContext(Tm),{basename:r,navigator:t}=R.useContext(el),{matches:n}=R.useContext(Cl),{pathname:a}=jo(),i=JSON.stringify(O4(n)),o=R.useRef(!1);return OP(()=>{o.current=!0}),R.useCallback((u,l={})=>{if(Qo(o.current,PP),!o.current)return;if(typeof u=="number"){t.go(u);return}let d=M4(u,JSON.parse(i),a,l.relative==="path");e==null&&r!=="/"&&(d.pathname=d.pathname==="/"?r:Ju([r,d.pathname])),(l.replace?t.replace:t.push)(d,l.state,l)},[r,t,i,a,e])}var rq=R.createContext(null);function nq(e){let r=R.useContext(Cl).outlet;return R.useMemo(()=>r&&R.createElement(rq.Provider,{value:e},r),[r,e])}function _h(){let{matches:e}=R.useContext(Cl),r=e[e.length-1];return r?r.params:{}}function Hg(e,{relative:r}={}){let{matches:t}=R.useContext(Cl),{pathname:n}=jo(),a=JSON.stringify(O4(t));return R.useMemo(()=>M4(e,JSON.parse(a),n,r==="path"),[e,a,n,r])}function sq(e,r){return MP(e,r)}function MP(e,r,t,n,a){ws(Pm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=R.useContext(el),{matches:o}=R.useContext(Cl),c=o[o.length-1],u=c?c.params:{},l=c?c.pathname:"/",d=c?c.pathnameBase:"/",f=c&&c.route;{let v=f&&f.path||"";RP(l,!f||v.endsWith("*")||v.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${v}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${v}"> to <Route path="${v==="/"?"*":`${v}/*`}">.`)}let p=jo(),h;if(r){let v=typeof r=="string"?Em(r):r;ws(d==="/"||v.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${v.pathname}" was given in the \`location\` prop.`),h=v}else h=p;let y=h.pathname||"/",g=y;if(d!=="/"){let v=d.replace(/^\//,"").split("/");g="/"+y.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=_P(e,{pathname:g});Qo(f||m!=null,`No routes matched location "${h.pathname}${h.search}${h.hash}" `),Qo(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${h.pathname}${h.search}${h.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=cq(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},u,v.params),pathname:Ju([d,i.encodeLocation?i.encodeLocation(v.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?d:Ju([d,i.encodeLocation?i.encodeLocation(v.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:v.pathnameBase])})),o,t,n,a);return r&&x?R.createElement(Ug.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...h},navigationType:"POP"}},x):x}function aq(){let e=pq(),r=H$(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=R.createElement(R.Fragment,null,R.createElement("p",null," Hey developer "),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:i},"ErrorBoundary")," or"," ",R.createElement("code",{style:i},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},r),t?R.createElement("pre",{style:a},t):null,o)}var iq=R.createElement(aq,null),IP=class extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.onError?this.props.onError(e,r):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const t=J$(e.digest);t&&(e=t)}let r=e!==void 0?R.createElement(Cl.Provider,{value:this.props.routeContext},R.createElement(I4.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?R.createElement(oq,{error:e},r):r}};IP.contextType=K$;var D2=new WeakMap;function oq({children:e,error:r}){let{basename:t}=R.useContext(el);if(typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){let n=Z$(r.digest);if(n){let a=D2.get(r);if(a)throw a;let i=CP(n.location,t);if(SP&&!D2.get(r))if(i.isExternal||n.reloadDocument)window.location.href=i.absoluteURL||i.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(i.to,{replace:n.replace}));throw D2.set(r,o),o}return R.createElement("meta",{httpEquiv:"refresh",content:`0;url=${i.absoluteURL||i.to}`})}}return e}function lq({routeContext:e,match:r,children:t}){let n=R.useContext(Tm);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),R.createElement(Cl.Provider,{value:e},t)}function cq(e,r=[],t=null,n=null,a=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let i=e,o=t?.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);ws(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(t)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:h}=t,y=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!h||h[f.route.id]===void 0);if(f.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}let l=t&&n?(d,f)=>{n(d,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:V$(t.matches),errorInfo:f})}:void 0;return i.reduceRight((d,f,p)=>{let h,y=!1,g=null,m=null;t&&(h=o&&f.route.id?o[f.route.id]:void 0,g=f.route.errorElement||iq,c&&(u<0&&p===0?(RP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,m=null):u===p&&(y=!0,m=f.route.hydrateFallbackElement||null)));let x=r.concat(i.slice(0,p+1)),v=()=>{let w;return h?w=g:y?w=m:f.route.Component?w=R.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,R.createElement(lq,{match:f,routeContext:{outlet:d,matches:x,isDataRoute:t!=null},children:w})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?R.createElement(IP,{location:t.location,revalidation:t.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0},onError:l}):v()},null)}function R4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uq(e){let r=R.useContext(Tm);return ws(r,R4(e)),r}function dq(e){let r=R.useContext(Ob);return ws(r,R4(e)),r}function hq(e){let r=R.useContext(Cl);return ws(r,R4(e)),r}function L4(e){let r=hq(e),t=r.matches[r.matches.length-1];return ws(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function fq(){return L4("useRouteId")}function pq(){let e=R.useContext(I4),r=dq("useRouteError"),t=L4("useRouteError");return e!==void 0?e:r.errors?.[t]}function mq(){let{router:e}=uq("useNavigate"),r=L4("useNavigate"),t=R.useRef(!1);return OP(()=>{t.current=!0}),R.useCallback(async(a,i={})=>{Qo(t.current,PP),t.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:r,...i}))},[e,r])}var Lk={};function RP(e,r,t){!r&&!Lk[e]&&(Lk[e]=!0,Qo(!1,t))}R.memo(gq);function gq({routes:e,future:r,state:t,onError:n}){return MP(e,void 0,t,n,r)}function $u({to:e,replace:r,state:t,relative:n}){ws(Pm(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=R.useContext(el);Qo(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=R.useContext(Cl),{pathname:o}=jo(),c=ts(),u=M4(e,O4(i),o,n==="path"),l=JSON.stringify(u);return R.useEffect(()=>{c(JSON.parse(l),{replace:r,state:t,relative:n})},[c,l,n,r,t]),null}function yq(e){return nq(e.context)}function fr(e){ws(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xq({basename:e="/",children:r=null,location:t,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){ws(!Pm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),u=R.useMemo(()=>({basename:c,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[c,a,i,o]);typeof t=="string"&&(t=Em(t));let{pathname:l="/",search:d="",hash:f="",state:p=null,key:h="default"}=t,y=R.useMemo(()=>{let g=nd(l,c);return g==null?null:{location:{pathname:g,search:d,hash:f,state:p,key:h},navigationType:n}},[c,l,d,f,p,h,n]);return Qo(y!=null,`<Router basename="${c}"> is not able to match the URL "${l}${d}${f}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:R.createElement(el.Provider,{value:u},R.createElement(Ug.Provider,{children:r,value:y}))}function vq({children:e,location:r}){return sq(P5(e),r)}function P5(e,r=[]){let t=[];return R.Children.forEach(e,(n,a)=>{if(!R.isValidElement(n))return;let i=[...r,a];if(n.type===R.Fragment){t.push.apply(t,P5(n.props.children,i));return}ws(n.type===fr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ws(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=P5(n.props.children,i)),t.push(o)}),t}var Yx="get",Qx="application/x-www-form-urlencoded";function Mb(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function bq(e){return Mb(e)&&e.tagName.toLowerCase()==="button"}function wq(e){return Mb(e)&&e.tagName.toLowerCase()==="form"}function _q(e){return Mb(e)&&e.tagName.toLowerCase()==="input"}function jq(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Nq(e,r){return e.button===0&&(!r||r==="_self")&&!jq(e)}function O5(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,t)=>{let n=e[t];return r.concat(Array.isArray(n)?n.map(a=>[t,a]):[[t,n]])},[]))}function kq(e,r){let t=O5(e);return r&&r.forEach((n,a)=>{t.has(a)||r.getAll(a).forEach(i=>{t.append(a,i)})}),t}var ex=null;function Sq(){if(ex===null)try{new FormData(document.createElement("form"),0),ex=!1}catch{ex=!0}return ex}var Cq=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function F2(e){return e!=null&&!Cq.has(e)?(Qo(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qx}"`),null):e}function Aq(e,r){let t,n,a,i,o;if(wq(e)){let c=e.getAttribute("action");n=c?nd(c,r):null,t=e.getAttribute("method")||Yx,a=F2(e.getAttribute("enctype"))||Qx,i=new FormData(e)}else if(bq(e)||_q(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||c.getAttribute("action");if(n=u?nd(u,r):null,t=e.getAttribute("formmethod")||c.getAttribute("method")||Yx,a=F2(e.getAttribute("formenctype"))||F2(c.getAttribute("enctype"))||Qx,i=new FormData(c,e),!Sq()){let{name:l,type:d,value:f}=e;if(d==="image"){let p=l?`${l}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else l&&i.append(l,f)}}else{if(Mb(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Yx,n=null,a=Qx,o=e}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:t.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function D4(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Eq(e,r,t,n){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${n}`:a.pathname=`${a.pathname}.${n}`:a.pathname==="/"?a.pathname=`_root.${n}`:r&&nd(a.pathname,r)==="/"?a.pathname=`${r.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function Tq(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Pq(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Oq(e,r,t){let n=await Promise.all(e.map(async a=>{let i=r.routes[a.route.id];if(i){let o=await Tq(i,t);return o.links?o.links():[]}return[]}));return Lq(n.flat(1).filter(Pq).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Dk(e,r,t,n,a,i){let o=(u,l)=>t[l]?u.route.id!==t[l].route.id:!0,c=(u,l)=>t[l].pathname!==u.pathname||t[l].route.path?.endsWith("*")&&t[l].params["*"]!==u.params["*"];return i==="assets"?r.filter((u,l)=>o(u,l)||c(u,l)):i==="data"?r.filter((u,l)=>{let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,l)||c(u,l))return!0;if(u.route.shouldRevalidate){let f=u.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Mq(e,r,{includeHydrateFallback:t}={}){return Iq(e.map(n=>{let a=r.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function Iq(e){return[...new Set(e)]}function Rq(e){let r={},t=Object.keys(e).sort();for(let n of t)r[n]=e[n];return r}function Lq(e,r){let t=new Set;return new Set(r),e.reduce((n,a)=>{let i=JSON.stringify(Rq(a));return t.has(i)||(t.add(i),n.push({key:i,link:a})),n},[])}function LP(){let e=R.useContext(Tm);return D4(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Dq(){let e=R.useContext(Ob);return D4(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var F4=R.createContext(void 0);F4.displayName="FrameworkContext";function DP(){let e=R.useContext(F4);return D4(e,"You must render this element inside a <HydratedRouter> element"),e}function Fq(e,r){let t=R.useContext(F4),[n,a]=R.useState(!1),[i,o]=R.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:l,onMouseLeave:d,onTouchStart:f}=r,p=R.useRef(null);R.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let g=x=>{x.forEach(v=>{o(v.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return p.current&&m.observe(p.current),()=>{m.disconnect()}}},[e]),R.useEffect(()=>{if(n){let g=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(g)}}},[n]);let h=()=>{a(!0)},y=()=>{a(!1),o(!1)};return t?e!=="intent"?[i,p,{}]:[i,p,{onFocus:b0(c,h),onBlur:b0(u,y),onMouseEnter:b0(l,h),onMouseLeave:b0(d,y),onTouchStart:b0(f,h)}]:[!1,p,{}]}function b0(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function Bq({page:e,...r}){let{router:t}=LP(),n=R.useMemo(()=>_P(t.routes,e,t.basename),[t.routes,e,t.basename]);return n?R.createElement(qq,{page:e,matches:n,...r}):null}function $q(e){let{manifest:r,routeModules:t}=DP(),[n,a]=R.useState([]);return R.useEffect(()=>{let i=!1;return Oq(e,r,t).then(o=>{i||a(o)}),()=>{i=!0}},[e,r,t]),n}function qq({page:e,matches:r,...t}){let n=jo(),{future:a,manifest:i,routeModules:o}=DP(),{basename:c}=LP(),{loaderData:u,matches:l}=Dq(),d=R.useMemo(()=>Dk(e,r,l,i,n,"data"),[e,r,l,i,n]),f=R.useMemo(()=>Dk(e,r,l,i,n,"assets"),[e,r,l,i,n]),p=R.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let g=new Set,m=!1;if(r.forEach(v=>{let w=i.routes[v.route.id];!w||!w.hasLoader||(!d.some(_=>_.route.id===v.route.id)&&v.route.id in u&&o[v.route.id]?.shouldRevalidate||w.hasClientLoader?m=!0:g.add(v.route.id))}),g.size===0)return[];let x=Eq(e,c,a.unstable_trailingSlashAwareDataRequests,"data");return m&&g.size>0&&x.searchParams.set("_routes",r.filter(v=>g.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[c,a.unstable_trailingSlashAwareDataRequests,u,n,i,d,r,e,o]),h=R.useMemo(()=>Mq(f,i),[f,i]),y=$q(f);return R.createElement(R.Fragment,null,p.map(g=>R.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...t})),h.map(g=>R.createElement("link",{key:g,rel:"modulepreload",href:g,...t})),y.map(({key:g,link:m})=>R.createElement("link",{key:g,nonce:t.nonce,...m})))}function zq(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var Uq=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Uq&&(window.__reactRouterVersion="7.12.0")}catch{}function Hq({basename:e,children:r,unstable_useTransitions:t,window:n}){let a=R.useRef();a.current==null&&(a.current=b$({window:n,v5Compat:!0}));let i=a.current,[o,c]=R.useState({action:i.action,location:i.location}),u=R.useCallback(l=>{t===!1?c(l):R.startTransition(()=>c(l))},[t]);return R.useLayoutEffect(()=>i.listen(u),[i,u]),R.createElement(xq,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:t})}var FP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$a=R.forwardRef(function({onClick:r,discover:t="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:c,target:u,to:l,preventScrollReset:d,viewTransition:f,unstable_defaultShouldRevalidate:p,...h},y){let{basename:g,unstable_useTransitions:m}=R.useContext(el),x=typeof l=="string"&&FP.test(l),v=CP(l,g);l=v.to;let w=eq(l,{relative:a}),[_,A,P]=Fq(n,h),B=Kq(l,{replace:o,state:c,target:u,preventScrollReset:d,relative:a,viewTransition:f,unstable_defaultShouldRevalidate:p,unstable_useTransitions:m});function T(U){r&&r(U),U.defaultPrevented||B(U)}let I=R.createElement("a",{...h,...P,href:v.absoluteURL||w,onClick:v.isExternal||i?r:T,ref:zq(y,A),target:u,"data-discover":!x&&t==="render"?"true":void 0});return _&&!x?R.createElement(R.Fragment,null,I,R.createElement(Bq,{page:w})):I});$a.displayName="Link";var M5=R.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:c,children:u,...l},d){let f=Hg(o,{relative:l.relative}),p=jo(),h=R.useContext(Ob),{navigator:y,basename:g}=R.useContext(el),m=h!=null&&Zq(f)&&c===!0,x=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,v=p.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;t||(v=v.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&g&&(w=nd(w,g)||w);const _=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let A=v===x||!a&&v.startsWith(x)&&v.charAt(_)==="/",P=w!=null&&(w===x||!a&&w.startsWith(x)&&w.charAt(x.length)==="/"),B={isActive:A,isPending:P,isTransitioning:m},T=A?r:void 0,I;typeof n=="function"?I=n(B):I=[n,A?"active":null,P?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let U=typeof i=="function"?i(B):i;return R.createElement($a,{...l,"aria-current":T,className:I,ref:d,style:U,to:o,viewTransition:c},typeof u=="function"?u(B):u)});M5.displayName="NavLink";var Vq=R.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:n,replace:a,state:i,method:o=Yx,action:c,onSubmit:u,relative:l,preventScrollReset:d,viewTransition:f,unstable_defaultShouldRevalidate:p,...h},y)=>{let{unstable_useTransitions:g}=R.useContext(el),m=Yq(),x=Qq(c,{relative:l}),v=o.toLowerCase()==="get"?"get":"post",w=typeof c=="string"&&FP.test(c),_=A=>{if(u&&u(A),A.defaultPrevented)return;A.preventDefault();let P=A.nativeEvent.submitter,B=P?.getAttribute("formmethod")||o,T=()=>m(P||A.currentTarget,{fetcherKey:r,method:B,navigate:t,replace:a,state:i,relative:l,preventScrollReset:d,viewTransition:f,unstable_defaultShouldRevalidate:p});g&&t!==!1?R.startTransition(()=>T()):T()};return R.createElement("form",{ref:y,method:v,action:x,onSubmit:n?u:_,...h,"data-discover":!w&&e==="render"?"true":void 0})});Vq.displayName="Form";function Wq(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function BP(e){let r=R.useContext(Tm);return ws(r,Wq(e)),r}function Kq(e,{target:r,replace:t,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c,unstable_useTransitions:u}={}){let l=ts(),d=jo(),f=Hg(e,{relative:i});return R.useCallback(p=>{if(Nq(p,r)){p.preventDefault();let h=t!==void 0?t:ig(d)===ig(f),y=()=>l(e,{replace:h,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:c});u?R.startTransition(()=>y()):y()}},[d,l,f,t,n,r,e,a,i,o,c,u])}function Ib(e){Qo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=R.useRef(O5(e)),t=R.useRef(!1),n=jo(),a=R.useMemo(()=>kq(n.search,t.current?null:r.current),[n.search]),i=ts(),o=R.useCallback((c,u)=>{const l=O5(typeof c=="function"?c(new URLSearchParams(a)):c);t.current=!0,i("?"+l,u)},[i,a]);return[a,o]}var Gq=0,Xq=()=>`__${String(++Gq)}__`;function Yq(){let{router:e}=BP("useSubmit"),{basename:r}=R.useContext(el),t=fq(),n=e.fetch,a=e.navigate;return R.useCallback(async(i,o={})=>{let{action:c,method:u,encType:l,formData:d,body:f}=Aq(i,r);if(o.navigate===!1){let p=o.fetcherKey||Xq();await n(p,t,o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:f,formMethod:o.method||u,formEncType:o.encType||l,flushSync:o.flushSync})}else await a(o.action||c,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:f,formMethod:o.method||u,formEncType:o.encType||l,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,a,r,t])}function Qq(e,{relative:r}={}){let{basename:t}=R.useContext(el),n=R.useContext(Cl);ws(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Hg(e||".",{relative:r})},o=jo();if(e==null){i.search=o.search;let c=new URLSearchParams(i.search),u=c.getAll("index");if(u.some(d=>d==="")){c.delete("index"),u.filter(f=>f).forEach(f=>c.append("index",f));let d=c.toString();i.search=d?`?${d}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Ju([t,i.pathname])),ig(i)}function Zq(e,{relative:r}={}){let t=R.useContext(EP);ws(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=BP("useViewTransitionState"),a=Hg(e,{relative:r});if(!t.isTransitioning)return!1;let i=nd(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=nd(t.nextLocation.pathname,n)||t.nextLocation.pathname;return fv(a.pathname,o)!=null||fv(a.pathname,i)!=null}var B4=wP(),Om=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Jq={setTimeout:(e,r)=>setTimeout(e,r),clearTimeout:e=>clearTimeout(e),setInterval:(e,r)=>setInterval(e,r),clearInterval:e=>clearInterval(e)},ez=class{#e=Jq;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,r){return this.#e.setTimeout(e,r)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,r){return this.#e.setInterval(e,r)}clearInterval(e){this.#e.clearInterval(e)}},mf=new ez;function tz(e){setTimeout(e,0)}var Pf=typeof window>"u"||"Deno"in globalThis;function Ji(){}function rz(e,r){return typeof e=="function"?e(r):e}function I5(e){return typeof e=="number"&&e>=0&&e!==1/0}function $P(e,r){return Math.max(e+(r||0)-Date.now(),0)}function fh(e,r){return typeof e=="function"?e(r):e}function vl(e,r){return typeof e=="function"?e(r):e}function Fk(e,r){const{type:t="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:c}=e;if(o){if(n){if(r.queryHash!==$4(o,r.options))return!1}else if(!og(r.queryKey,o))return!1}if(t!=="all"){const u=r.isActive();if(t==="active"&&!u||t==="inactive"&&u)return!1}return!(typeof c=="boolean"&&r.isStale()!==c||a&&a!==r.state.fetchStatus||i&&!i(r))}function Bk(e,r){const{exact:t,status:n,predicate:a,mutationKey:i}=e;if(i){if(!r.options.mutationKey)return!1;if(t){if(Of(r.options.mutationKey)!==Of(i))return!1}else if(!og(r.options.mutationKey,i))return!1}return!(n&&r.state.status!==n||a&&!a(r))}function $4(e,r){return(r?.queryKeyHashFn||Of)(e)}function Of(e){return JSON.stringify(e,(r,t)=>R5(t)?Object.keys(t).sort().reduce((n,a)=>(n[a]=t[a],n),{}):t)}function og(e,r){return e===r?!0:typeof e!=typeof r?!1:e&&r&&typeof e=="object"&&typeof r=="object"?Object.keys(r).every(t=>og(e[t],r[t])):!1}var nz=Object.prototype.hasOwnProperty;function qP(e,r,t=0){if(e===r)return e;if(t>500)return r;const n=$k(e)&&$k(r);if(!n&&!(R5(e)&&R5(r)))return r;const i=(n?e:Object.keys(e)).length,o=n?r:Object.keys(r),c=o.length,u=n?new Array(c):{};let l=0;for(let d=0;d<c;d++){const f=n?d:o[d],p=e[f],h=r[f];if(p===h){u[f]=p,(n?d<i:nz.call(e,f))&&l++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){u[f]=h;continue}const y=qP(p,h,t+1);u[f]=y,y===p&&l++}return i===c&&l===i?e:u}function pv(e,r){if(!r||Object.keys(e).length!==Object.keys(r).length)return!1;for(const t in e)if(e[t]!==r[t])return!1;return!0}function $k(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function R5(e){if(!qk(e))return!1;const r=e.constructor;if(r===void 0)return!0;const t=r.prototype;return!(!qk(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qk(e){return Object.prototype.toString.call(e)==="[object Object]"}function sz(e){return new Promise(r=>{mf.setTimeout(r,e)})}function L5(e,r,t){return typeof t.structuralSharing=="function"?t.structuralSharing(e,r):t.structuralSharing!==!1?qP(e,r):r}function az(e,r,t=0){const n=[...e,r];return t&&n.length>t?n.slice(1):n}function iz(e,r,t=0){const n=[r,...e];return t&&n.length>t?n.slice(0,-1):n}var q4=Symbol();function zP(e,r){return!e.queryFn&&r?.initialPromise?()=>r.initialPromise:!e.queryFn||e.queryFn===q4?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function z4(e,r){return typeof e=="function"?e(...r):!!e}function oz(e,r,t){let n=!1,a;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(a??=r(),n||(n=!0,a.aborted?t():a.addEventListener("abort",t,{once:!0})),a)}),e}var lz=class extends Om{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!Pf&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},U4=new lz;function D5(){let e,r;const t=new Promise((a,i)=>{e=a,r=i});t.status="pending",t.catch(()=>{});function n(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},t.reject=a=>{n({status:"rejected",reason:a}),r(a)},t}var cz=tz;function uz(){let e=[],r=0,t=c=>{c()},n=c=>{c()},a=cz;const i=c=>{r?e.push(c):a(()=>{t(c)})},o=()=>{const c=e;e=[],c.length&&a(()=>{n(()=>{c.forEach(u=>{t(u)})})})};return{batch:c=>{let u;r++;try{u=c()}finally{r--,r||o()}return u},batchCalls:c=>(...u)=>{i(()=>{c(...u)})},schedule:i,setNotifyFunction:c=>{t=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{a=c}}}var Ba=uz(),dz=class extends Om{#e=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!Pf&&window.addEventListener){const r=()=>e(!0),t=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#e}},mv=new dz;function hz(e){return Math.min(1e3*2**e,3e4)}function UP(e){return(e??"online")==="online"?mv.isOnline():!0}var F5=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function HP(e){let r=!1,t=0,n;const a=D5(),i=()=>a.status!=="pending",o=g=>{if(!i()){const m=new F5(g);p(m),e.onCancel?.(m)}},c=()=>{r=!0},u=()=>{r=!1},l=()=>U4.isFocused()&&(e.networkMode==="always"||mv.isOnline())&&e.canRun(),d=()=>UP(e.networkMode)&&e.canRun(),f=g=>{i()||(n?.(),a.resolve(g))},p=g=>{i()||(n?.(),a.reject(g))},h=()=>new Promise(g=>{n=m=>{(i()||l())&&g(m)},e.onPause?.()}).then(()=>{n=void 0,i()||e.onContinue?.()}),y=()=>{if(i())return;let g;const m=t===0?e.initialPromise:void 0;try{g=m??e.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(f).catch(x=>{if(i())return;const v=e.retry??(Pf?0:3),w=e.retryDelay??hz,_=typeof w=="function"?w(t,x):w,A=v===!0||typeof v=="number"&&t<v||typeof v=="function"&&v(t,x);if(r||!A){p(x);return}t++,e.onFail?.(t,x),sz(_).then(()=>l()?void 0:h()).then(()=>{r?p(x):y()})})};return{promise:a,status:()=>a.status,cancel:o,continue:()=>(n?.(),a),cancelRetry:c,continueRetry:u,canStart:d,start:()=>(d()?y():h().then(y),a)}}var VP=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),I5(this.gcTime)&&(this.#e=mf.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Pf?1/0:300*1e3))}clearGcTimeout(){this.#e&&(mf.clearTimeout(this.#e),this.#e=void 0)}},fz=class extends VP{#e;#t;#r;#s;#n;#i;#o;constructor(e){super(),this.#o=!1,this.#i=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#s=e.client,this.#r=this.#s.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Uk(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){if(this.options={...this.#i,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Uk(this.options);r.data!==void 0&&(this.setState(zk(r.data,r.dataUpdatedAt)),this.#e=r)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,r){const t=L5(this.state.data,e,this.options);return this.#a({data:t,type:"success",dataUpdatedAt:r?.updatedAt,manual:r?.manual}),t}setState(e,r){this.#a({type:"setState",state:e,setStateOptions:r})}cancel(e){const r=this.#n?.promise;return this.#n?.cancel(e),r?r.then(Ji).catch(Ji):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>vl(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===q4||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>fh(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!$P(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(r=>r.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(r=>r.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(this.#n&&(this.#o?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(e,r){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&r?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const c=this.observers.find(u=>u.options.queryFn);c&&this.setOptions(c.options)}const t=new AbortController,n=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#o=!0,t.signal)})},a=()=>{const c=zP(this.options,r),l=(()=>{const d={client:this.#s,queryKey:this.queryKey,meta:this.meta};return n(d),d})();return this.#o=!1,this.options.persister?this.options.persister(c,l,this):c(l)},o=(()=>{const c={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:a};return n(c),c})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#a({type:"fetch",meta:o.fetchOptions?.meta}),this.#n=HP({initialPromise:r?.initialPromise,fn:o.fetchFn,onCancel:c=>{c instanceof F5&&c.revert&&this.setState({...this.#t,fetchStatus:"idle"}),t.abort()},onFail:(c,u)=>{this.#a({type:"failed",failureCount:c,error:u})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const c=await this.#n.start();if(c===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(c),this.#r.config.onSuccess?.(c,this),this.#r.config.onSettled?.(c,this.state.error,this),c}catch(c){if(c instanceof F5){if(c.silent)return this.#n.promise;if(c.revert){if(this.state.data===void 0)throw c;return this.state.data}}throw this.#a({type:"error",error:c}),this.#r.config.onError?.(c,this),this.#r.config.onSettled?.(this.state.data,c,this),c}finally{this.scheduleGc()}}#a(e){const r=t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...WP(t.data,this.options),fetchMeta:e.meta??null};case"success":const n={...t,...zk(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?n:void 0,n;case"error":const a=e.error;return{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}};this.state=r(this.state),Ba.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function WP(e,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:UP(r.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function zk(e,r){return{data:e,dataUpdatedAt:r??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Uk(e){const r=typeof e.initialData=="function"?e.initialData():e.initialData,t=r!==void 0,n=t?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var pz=class extends Om{constructor(e,r){super(),this.options=r,this.#e=e,this.#a=null,this.#o=D5(),this.bindMethods(),this.setOptions(r)}#e;#t=void 0;#r=void 0;#s=void 0;#n;#i;#o;#a;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Hk(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return B5(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return B5(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#w(),this.#t.removeObserver(this)}setOptions(e){const r=this.options,t=this.#t;if(this.options=this.#e.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof vl(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#_(),this.#t.setOptions(this.options),r._defaulted&&!pv(this.options,r)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const n=this.hasListeners();n&&Vk(this.#t,t,this.options,r)&&this.#d(),this.updateResult(),n&&(this.#t!==t||vl(this.options.enabled,this.#t)!==vl(r.enabled,this.#t)||fh(this.options.staleTime,this.#t)!==fh(r.staleTime,this.#t))&&this.#g();const a=this.#y();n&&(this.#t!==t||vl(this.options.enabled,this.#t)!==vl(r.enabled,this.#t)||a!==this.#l)&&this.#x(a)}getOptimisticResult(e){const r=this.#e.getQueryCache().build(this.#e,e),t=this.createResult(r,e);return gz(this,t)&&(this.#s=t,this.#i=this.options,this.#n=this.#t.state),t}getCurrentResult(){return this.#s}trackResult(e,r){return new Proxy(e,{get:(t,n)=>(this.trackProp(n),r?.(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(t,n))})}trackProp(e){this.#p.add(e)}getCurrentQuery(){return this.#t}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=this.#e.defaultQueryOptions(e),t=this.#e.getQueryCache().build(this.#e,r);return t.fetch().then(()=>this.createResult(t,r))}fetch(e){return this.#d({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#s))}#d(e){this.#_();let r=this.#t.fetch(this.options,e);return e?.throwOnError||(r=r.catch(Ji)),r}#g(){this.#b();const e=fh(this.options.staleTime,this.#t);if(Pf||this.#s.isStale||!I5(e))return;const t=$P(this.#s.dataUpdatedAt,e)+1;this.#c=mf.setTimeout(()=>{this.#s.isStale||this.updateResult()},t)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#x(e){this.#w(),this.#l=e,!(Pf||vl(this.options.enabled,this.#t)===!1||!I5(this.#l)||this.#l===0)&&(this.#u=mf.setInterval(()=>{(this.options.refetchIntervalInBackground||U4.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#x(this.#y())}#b(){this.#c&&(mf.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(mf.clearInterval(this.#u),this.#u=void 0)}createResult(e,r){const t=this.#t,n=this.options,a=this.#s,i=this.#n,o=this.#i,u=e!==t?e.state:this.#r,{state:l}=e;let d={...l},f=!1,p;if(r._optimisticResults){const T=this.hasListeners(),I=!T&&Hk(e,r),U=T&&Vk(e,t,r,n);(I||U)&&(d={...d,...WP(l.data,e.options)}),r._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:h,errorUpdatedAt:y,status:g}=d;p=d.data;let m=!1;if(r.placeholderData!==void 0&&p===void 0&&g==="pending"){let T;a?.isPlaceholderData&&r.placeholderData===o?.placeholderData?(T=a.data,m=!0):T=typeof r.placeholderData=="function"?r.placeholderData(this.#f?.state.data,this.#f):r.placeholderData,T!==void 0&&(g="success",p=L5(a?.data,T,r),f=!0)}if(r.select&&p!==void 0&&!m)if(a&&p===i?.data&&r.select===this.#m)p=this.#h;else try{this.#m=r.select,p=r.select(p),p=L5(a?.data,p,r),this.#h=p,this.#a=null}catch(T){this.#a=T}this.#a&&(h=this.#a,p=this.#h,y=Date.now(),g="error");const x=d.fetchStatus==="fetching",v=g==="pending",w=g==="error",_=v&&x,A=p!==void 0,B={status:g,fetchStatus:d.fetchStatus,isPending:v,isSuccess:g==="success",isError:w,isInitialLoading:_,isLoading:_,data:p,dataUpdatedAt:d.dataUpdatedAt,error:h,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>u.dataUpdateCount||d.errorUpdateCount>u.errorUpdateCount,isFetching:x,isRefetching:x&&!v,isLoadingError:w&&!A,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&A,isStale:H4(e,r),refetch:this.refetch,promise:this.#o,isEnabled:vl(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const T=H=>{B.status==="error"?H.reject(B.error):B.data!==void 0&&H.resolve(B.data)},I=()=>{const H=this.#o=B.promise=D5();T(H)},U=this.#o;switch(U.status){case"pending":e.queryHash===t.queryHash&&T(U);break;case"fulfilled":(B.status==="error"||B.data!==U.value)&&I();break;case"rejected":(B.status!=="error"||B.error!==U.reason)&&I();break}}return B}updateResult(){const e=this.#s,r=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#i=this.options,this.#n.data!==void 0&&(this.#f=this.#t),pv(r,e))return;this.#s=r;const t=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,a=typeof n=="function"?n():n;if(a==="all"||!a&&!this.#p.size)return!0;const i=new Set(a??this.#p);return this.options.throwOnError&&i.add("error"),Object.keys(this.#s).some(o=>{const c=o;return this.#s[c]!==e[c]&&i.has(c)})};this.#j({listeners:t()})}#_(){const e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#t)return;const r=this.#t;this.#t=e,this.#r=e.state,this.hasListeners()&&(r?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#j(e){Ba.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(this.#s)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function mz(e,r){return vl(r.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&r.retryOnMount===!1)}function Hk(e,r){return mz(e,r)||e.state.data!==void 0&&B5(e,r,r.refetchOnMount)}function B5(e,r,t){if(vl(r.enabled,e)!==!1&&fh(r.staleTime,e)!=="static"){const n=typeof t=="function"?t(e):t;return n==="always"||n!==!1&&H4(e,r)}return!1}function Vk(e,r,t,n){return(e!==r||vl(n.enabled,e)===!1)&&(!t.suspense||e.state.status!=="error")&&H4(e,t)}function H4(e,r){return vl(r.enabled,e)!==!1&&e.isStaleByTime(fh(r.staleTime,e))}function gz(e,r){return!pv(e.getCurrentResult(),r)}function Wk(e){return{onFetch:(r,t)=>{const n=r.options,a=r.fetchOptions?.meta?.fetchMore?.direction,i=r.state.data?.pages||[],o=r.state.data?.pageParams||[];let c={pages:[],pageParams:[]},u=0;const l=async()=>{let d=!1;const f=y=>{oz(y,()=>r.signal,()=>d=!0)},p=zP(r.options,r.fetchOptions),h=async(y,g,m)=>{if(d)return Promise.reject();if(g==null&&y.pages.length)return Promise.resolve(y);const v=(()=>{const P={client:r.client,queryKey:r.queryKey,pageParam:g,direction:m?"backward":"forward",meta:r.options.meta};return f(P),P})(),w=await p(v),{maxPages:_}=r.options,A=m?iz:az;return{pages:A(y.pages,w,_),pageParams:A(y.pageParams,g,_)}};if(a&&i.length){const y=a==="backward",g=y?yz:Kk,m={pages:i,pageParams:o},x=g(n,m);c=await h(m,x,y)}else{const y=e??i.length;do{const g=u===0?o[0]??n.initialPageParam:Kk(n,c);if(u>0&&g==null)break;c=await h(c,g),u++}while(u<y)}return c};r.options.persister?r.fetchFn=()=>r.options.persister?.(l,{client:r.client,queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},t):r.fetchFn=l}}}function Kk(e,{pages:r,pageParams:t}){const n=r.length-1;return r.length>0?e.getNextPageParam(r[n],r,t[n],t):void 0}function yz(e,{pages:r,pageParams:t}){return r.length>0?e.getPreviousPageParam?.(r[0],r,t[0],t):void 0}var xz=class extends VP{#e;#t;#r;#s;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#r=e.mutationCache,this.#t=[],this.state=e.state||KP(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(r=>r!==e),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){const r=()=>{this.#n({type:"continue"})},t={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#s=HP({fn:()=>this.options.mutationFn?this.options.mutationFn(e,t):Promise.reject(new Error("No mutationFn found")),onFail:(i,o)=>{this.#n({type:"failed",failureCount:i,error:o})},onPause:()=>{this.#n({type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const n=this.state.status==="pending",a=!this.#s.canStart();try{if(n)r();else{this.#n({type:"pending",variables:e,isPaused:a}),await this.#r.config.onMutate?.(e,this,t);const o=await this.options.onMutate?.(e,t);o!==this.state.context&&this.#n({type:"pending",context:o,variables:e,isPaused:a})}const i=await this.#s.start();return await this.#r.config.onSuccess?.(i,e,this.state.context,this,t),await this.options.onSuccess?.(i,e,this.state.context,t),await this.#r.config.onSettled?.(i,null,this.state.variables,this.state.context,this,t),await this.options.onSettled?.(i,null,e,this.state.context,t),this.#n({type:"success",data:i}),i}catch(i){try{await this.#r.config.onError?.(i,e,this.state.context,this,t)}catch(o){Promise.reject(o)}try{await this.options.onError?.(i,e,this.state.context,t)}catch(o){Promise.reject(o)}try{await this.#r.config.onSettled?.(void 0,i,this.state.variables,this.state.context,this,t)}catch(o){Promise.reject(o)}try{await this.options.onSettled?.(void 0,i,e,this.state.context,t)}catch(o){Promise.reject(o)}throw this.#n({type:"error",error:i}),i}finally{this.#r.runNext(this)}}#n(e){const r=t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ba.batch(()=>{this.#t.forEach(t=>{t.onMutationUpdate(e)}),this.#r.notify({mutation:this,type:"updated",action:e})})}};function KP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var vz=class extends Om{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,r,t){const n=new xz({client:e,mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(r),state:t});return this.add(n),n}add(e){this.#e.add(e);const r=tx(e);if(typeof r=="string"){const t=this.#t.get(r);t?t.push(e):this.#t.set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const r=tx(e);if(typeof r=="string"){const t=this.#t.get(r);if(t)if(t.length>1){const n=t.indexOf(e);n!==-1&&t.splice(n,1)}else t[0]===e&&this.#t.delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=tx(e);if(typeof r=="string"){const n=this.#t.get(r)?.find(a=>a.state.status==="pending");return!n||n===e}else return!0}runNext(e){const r=tx(e);return typeof r=="string"?this.#t.get(r)?.find(n=>n!==e&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ba.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const r={exact:!0,...e};return this.getAll().find(t=>Bk(r,t))}findAll(e={}){return this.getAll().filter(r=>Bk(e,r))}notify(e){Ba.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return Ba.batch(()=>Promise.all(e.map(r=>r.continue().catch(Ji))))}};function tx(e){return e.options.scope?.id}var bz=class extends Om{#e;#t=void 0;#r;#s;constructor(r,t){super(),this.#e=r,this.setOptions(t),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){const t=this.options;this.options=this.#e.defaultMutationOptions(r),pv(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&Of(t.mutationKey)!==Of(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(r){this.#n(),this.#i(r)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#i()}mutate(r,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(r)}#n(){const r=this.#r?.state??KP();this.#t={...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset}}#i(r){Ba.batch(()=>{if(this.#s&&this.hasListeners()){const t=this.#t.variables,n=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(r?.type==="success"){try{this.#s.onSuccess?.(r.data,t,n,a)}catch(i){Promise.reject(i)}try{this.#s.onSettled?.(r.data,null,t,n,a)}catch(i){Promise.reject(i)}}else if(r?.type==="error"){try{this.#s.onError?.(r.error,t,n,a)}catch(i){Promise.reject(i)}try{this.#s.onSettled?.(void 0,r.error,t,n,a)}catch(i){Promise.reject(i)}}}this.listeners.forEach(t=>{t(this.#t)})})}},wz=class extends Om{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,r,t){const n=r.queryKey,a=r.queryHash??$4(n,r);let i=this.get(a);return i||(i=new fz({client:e,queryKey:n,queryHash:a,options:e.defaultQueryOptions(r),state:t,defaultOptions:e.getQueryDefaults(n)}),this.add(i)),i}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=this.#e.get(e.queryHash);r&&(e.destroy(),r===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ba.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const r={exact:!0,...e};return this.getAll().find(t=>Fk(r,t))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(t=>Fk(e,t)):r}notify(e){Ba.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Ba.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ba.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},_z=class{#e;#t;#r;#s;#n;#i;#o;#a;constructor(e={}){this.#e=e.queryCache||new wz,this.#t=e.mutationCache||new vz,this.#r=e.defaultOptions||{},this.#s=new Map,this.#n=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#o=U4.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=mv.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#o?.(),this.#o=void 0,this.#a?.(),this.#a=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const r=this.defaultQueryOptions({queryKey:e});return this.#e.get(r.queryHash)?.state.data}ensureQueryData(e){const r=this.defaultQueryOptions(e),t=this.#e.build(this,r),n=t.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&t.isStaleByTime(fh(r.staleTime,t))&&this.prefetchQuery(r),Promise.resolve(n))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:r,state:t})=>{const n=t.data;return[r,n]})}setQueryData(e,r,t){const n=this.defaultQueryOptions({queryKey:e}),i=this.#e.get(n.queryHash)?.state.data,o=rz(r,i);if(o!==void 0)return this.#e.build(this,n).setData(o,{...t,manual:!0})}setQueriesData(e,r,t){return Ba.batch(()=>this.#e.findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,r,t)]))}getQueryState(e){const r=this.defaultQueryOptions({queryKey:e});return this.#e.get(r.queryHash)?.state}removeQueries(e){const r=this.#e;Ba.batch(()=>{r.findAll(e).forEach(t=>{r.remove(t)})})}resetQueries(e,r){const t=this.#e;return Ba.batch(()=>(t.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},r)))}cancelQueries(e,r={}){const t={revert:!0,...r},n=Ba.batch(()=>this.#e.findAll(e).map(a=>a.cancel(t)));return Promise.all(n).then(Ji).catch(Ji)}invalidateQueries(e,r={}){return Ba.batch(()=>(this.#e.findAll(e).forEach(t=>{t.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},r)))}refetchQueries(e,r={}){const t={...r,cancelRefetch:r.cancelRefetch??!0},n=Ba.batch(()=>this.#e.findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,t);return t.throwOnError||(i=i.catch(Ji)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Ji)}fetchQuery(e){const r=this.defaultQueryOptions(e);r.retry===void 0&&(r.retry=!1);const t=this.#e.build(this,r);return t.isStaleByTime(fh(r.staleTime,t))?t.fetch(r):Promise.resolve(t.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ji).catch(Ji)}fetchInfiniteQuery(e){return e.behavior=Wk(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ji).catch(Ji)}ensureInfiniteQueryData(e){return e.behavior=Wk(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return mv.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,r){this.#s.set(Of(e),{queryKey:e,defaultOptions:r})}getQueryDefaults(e){const r=[...this.#s.values()],t={};return r.forEach(n=>{og(e,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(e,r){this.#n.set(Of(e),{mutationKey:e,defaultOptions:r})}getMutationDefaults(e){const r=[...this.#n.values()],t={};return r.forEach(n=>{og(e,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(e){if(e._defaulted)return e;const r={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return r.queryHash||(r.queryHash=$4(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.queryFn===q4&&(r.enabled=!1),r}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},GP=R.createContext(void 0),Is=e=>{const r=R.useContext(GP);if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},jz=({client:e,children:r})=>(R.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(GP.Provider,{value:e,children:r})),XP=R.createContext(!1),Nz=()=>R.useContext(XP);XP.Provider;function kz(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Sz=R.createContext(kz()),Cz=()=>R.useContext(Sz),Az=(e,r,t)=>{const n=t?.state.error&&typeof e.throwOnError=="function"?z4(e.throwOnError,[t.state.error,t]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||n)&&(r.isReset()||(e.retryOnMount=!1))},Ez=e=>{R.useEffect(()=>{e.clearReset()},[e])},Tz=({result:e,errorResetBoundary:r,throwOnError:t,query:n,suspense:a})=>e.isError&&!r.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||z4(t,[e.error,n])),Pz=e=>{if(e.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>t(n(...a)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Oz=(e,r)=>e.isLoading&&e.isFetching&&!r,Mz=(e,r)=>e?.suspense&&r.isPending,Gk=(e,r,t)=>r.fetchOptimistic(e).catch(()=>{t.clearReset()});function Iz(e,r,t){const n=Nz(),a=Cz(),i=Is(),o=i.defaultQueryOptions(e);i.getDefaultOptions().queries?._experimental_beforeQuery?.(o);const c=i.getQueryCache().get(o.queryHash);o._optimisticResults=n?"isRestoring":"optimistic",Pz(o),Az(o,a,c),Ez(a);const u=!i.getQueryCache().get(o.queryHash),[l]=R.useState(()=>new r(i,o)),d=l.getOptimisticResult(o),f=!n&&e.subscribed!==!1;if(R.useSyncExternalStore(R.useCallback(p=>{const h=f?l.subscribe(Ba.batchCalls(p)):Ji;return l.updateResult(),h},[l,f]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),R.useEffect(()=>{l.setOptions(o)},[o,l]),Mz(o,d))throw Gk(o,l,a);if(Tz({result:d,errorResetBoundary:a,throwOnError:o.throwOnError,query:c,suspense:o.suspense}))throw d.error;return i.getDefaultOptions().queries?._experimental_afterQuery?.(o,d),o.experimental_prefetchInRender&&!Pf&&Oz(d,n)&&(u?Gk(o,l,a):c?.promise)?.catch(Ji).finally(()=>{l.updateResult()}),o.notifyOnChangeProps?d:l.trackResult(d)}function gr(e,r){return Iz(e,pz)}function nn(e,r){const t=Is(),[n]=R.useState(()=>new bz(t,e));R.useEffect(()=>{n.setOptions(e)},[n,e]);const a=R.useSyncExternalStore(R.useCallback(o=>n.subscribe(Ba.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=R.useCallback((o,c)=>{n.mutate(o,c).catch(Ji)},[n]);if(a.error&&z4(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}const Xk=e=>{let r;const t=new Set,n=(l,d)=>{const f=typeof l=="function"?l(r):l;if(!Object.is(f,r)){const p=r;r=d??(typeof f!="object"||f===null)?f:Object.assign({},r,f),t.forEach(h=>h(r,p))}},a=()=>r,c={setState:n,getState:a,getInitialState:()=>u,subscribe:l=>(t.add(l),()=>t.delete(l))},u=r=e(n,a,c);return c},Rz=(e=>e?Xk(e):Xk),Lz=e=>e;function Dz(e,r=Lz){const t=sa.useSyncExternalStore(e.subscribe,sa.useCallback(()=>r(e.getState()),[e,r]),sa.useCallback(()=>r(e.getInitialState()),[e,r]));return sa.useDebugValue(t),t}const Yk=e=>{const r=Rz(e),t=n=>Dz(r,n);return Object.assign(t,r),t},Fz=(e=>e?Yk(e):Yk);function Rb(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t}function Bz(e,r,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(d){try{l(n.next(d))}catch(f){o(f)}}function u(d){try{l(n.throw(d))}catch(f){o(f)}}function l(d){d.done?i(d.value):a(d.value).then(c,u)}l((n=n.apply(e,r||[])).next())})}const $z=e=>e?(...r)=>e(...r):(...r)=>fetch(...r);class V4 extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class qz extends V4{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Qk extends V4{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Zk extends V4{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var $5;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})($5||($5={}));class zz{constructor(r,{headers:t={},customFetch:n,region:a=$5.Any}={}){this.url=r,this.headers=t,this.region=a,this.fetch=$z(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return Bz(this,arguments,void 0,function*(t,n={}){var a;let i,o;try{const{headers:c,method:u,body:l,signal:d,timeout:f}=n;let p={},{region:h}=n;h||(h=this.region);const y=new URL(`${this.url}/${t}`);h&&h!=="any"&&(p["x-region"]=h,y.searchParams.set("forceFunctionRegion",h));let g;l&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(p["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(p["Content-Type"]="application/json",g=JSON.stringify(l)):l&&typeof l!="string"&&!(typeof Blob<"u"&&l instanceof Blob)&&!(l instanceof ArrayBuffer)&&!(typeof FormData<"u"&&l instanceof FormData)?g=JSON.stringify(l):g=l;let m=d;f&&(o=new AbortController,i=setTimeout(()=>o.abort(),f),d?(m=o.signal,d.addEventListener("abort",()=>o.abort())):m=o.signal);const x=yield this.fetch(y.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),c),body:g,signal:m}).catch(A=>{throw new qz(A)}),v=x.headers.get("x-relay-error");if(v&&v==="true")throw new Qk(x);if(!x.ok)throw new Zk(x);let w=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),_;return w==="application/json"?_=yield x.json():w==="application/octet-stream"||w==="application/pdf"?_=yield x.blob():w==="text/event-stream"?_=x:w==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(c){return{data:null,error:c,response:c instanceof Zk||c instanceof Qk?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var Uz=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Hz=class{constructor(e){var r,t;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(t=e.isMaybeSingle)!==null&&t!==void 0?t:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,c=null,u=null,l=i.status,d=i.statusText;if(i.ok){var f,p;if(t.method!=="HEAD"){var h;const x=await i.text();x===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((h=t.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?c=x:c=JSON.parse(x))}const g=(f=t.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),m=(p=i.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");g&&m&&m.length>1&&(u=parseInt(m[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,u=null,l=406,d="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var y;const g=await i.text();try{o=JSON.parse(g),Array.isArray(o)&&i.status===404&&(c=[],o=null,l=200,d="OK")}catch{i.status===404&&g===""?(l=204,d="No Content"):o={message:g}}if(o&&t.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,l=200,d="OK"),o&&t.shouldThrowOnError)throw new Uz(o)}return{error:o,data:c,count:u,status:l,statusText:d}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let c="";const u=i?.cause;if(u){var l,d,f,p;const y=(l=u?.message)!==null&&l!==void 0?l:"",g=(d=u?.code)!==null&&d!==void 0?d:"";c=`${(f=i?.name)!==null&&f!==void 0?f:"FetchError"}: ${i?.message}`,c+=`

Caused by: ${(p=u?.name)!==null&&p!==void 0?p:"Error"}: ${y}`,g&&(c+=` (${g})`),u?.stack&&(c+=`
${u.stack}`)}else{var h;c=(h=i?.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(o=i?.name)!==null&&o!==void 0?o:"FetchError"}: ${i?.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,r)}returns(){return this}overrideTypes(){return this}},Vz=class extends Hz{select(e){let r=!1;const t=(e??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:t,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${r?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:t=r}={}){const n=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,r,{foreignTable:t,referencedTable:n=t}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:t=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var o;const c=[e?"analyze":null,r?"verbose":null,t?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Jk=new RegExp("[,()]");var Kp=class extends Vz{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}regexMatch(e,r){return this.url.searchParams.append(e,`match.${r}`),this}regexIMatch(e,r){return this.url.searchParams.append(e,`imatch.${r}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}isDistinct(e,r){return this.url.searchParams.append(e,`isdistinct.${r}`),this}in(e,r){const t=Array.from(new Set(r)).map(n=>typeof n=="string"&&Jk.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}notIn(e,r){const t=Array.from(new Set(r)).map(n=>typeof n=="string"&&Jk.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${t})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:t,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${a}fts${i}.${r}`),this}match(e){return Object.entries(e).forEach(([r,t])=>{this.url.searchParams.append(r,`eq.${t}`)}),this}not(e,r,t){return this.url.searchParams.append(e,`not.${r}.${t}`),this}or(e,{foreignTable:r,referencedTable:t=r}={}){const n=t?`${t}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,r,t){return this.url.searchParams.append(e,`${r}.${t}`),this}},Wz=class{constructor(e,{headers:r={},schema:t,fetch:n}){this.url=e,this.headers=new Headers(r),this.schema=t,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,r){const{head:t=!1,count:n}=r??{},a=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join(""),{url:c,headers:u}=this.cloneRequestState();return c.searchParams.set("select",o),n&&u.append("Prefer",`count=${n}`),new Kp({method:a,url:c,headers:u,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:t=!0}={}){var n;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(r&&o.append("Prefer",`count=${r}`),t||o.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,l)=>u.concat(Object.keys(l)),[]);if(c.length>0){const u=[...new Set(c)].map(l=>`"${l}"`);i.searchParams.set("columns",u.join(","))}}return new Kp({method:a,url:i,headers:o,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:t=!1,count:n,defaultToNull:a=!0}={}){var i;const o="POST",{url:c,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),r!==void 0&&c.searchParams.set("on_conflict",r),n&&u.append("Prefer",`count=${n}`),a||u.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(l.length>0){const d=[...new Set(l)].map(f=>`"${f}"`);c.searchParams.set("columns",d.join(","))}}return new Kp({method:o,url:c,headers:u,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:r}={}){var t;const n="PATCH",{url:a,headers:i}=this.cloneRequestState();return r&&i.append("Prefer",`count=${r}`),new Kp({method:n,url:a,headers:i,schema:this.schema,body:e,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:e}={}){var r;const t="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Kp({method:t,url:n,headers:a,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}},Kz=class YP{constructor(r,{headers:t={},schema:n,fetch:a}={}){this.url=r,this.headers=new Headers(t),this.schemaName=n,this.fetch=a}from(r){if(!r||typeof r!="string"||r.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Wz(new URL(`${this.url}/${r}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new YP(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,t={},{head:n=!1,get:a=!1,count:i}={}){var o;let c;const u=new URL(`${this.url}/rpc/${r}`);let l;const d=h=>h!==null&&typeof h=="object"&&(!Array.isArray(h)||h.some(d)),f=n&&Object.values(t).some(d);f?(c="POST",l=t):n||a?(c=n?"HEAD":"GET",Object.entries(t).filter(([h,y])=>y!==void 0).map(([h,y])=>[h,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([h,y])=>{u.searchParams.append(h,y)})):(c="POST",l=t);const p=new Headers(this.headers);return f?p.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&p.set("Prefer",`count=${i}`),new Kp({method:c,url:u,headers:p,schema:this.schemaName,body:l,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class Gz{constructor(){}static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const a=n.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let t=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(t+=`

Suggested solution: ${r.workaround}`),new Error(t)}static createWebSocket(r,t){const n=this.getWebSocketConstructor();return new n(r,t)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const Xz="2.90.1",Yz=`realtime-js/${Xz}`,QP="1.0.0",Qz="2.0.0",eS=QP,q5=1e4,Zz=1e3,Jz=100;var sh;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(sh||(sh={}));var Da;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Da||(Da={}));var rc;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(rc||(rc={}));var z5;(function(e){e.websocket="websocket"})(z5||(z5={}));var df;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(df||(df={}));class eU{constructor(r){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=r??[]}encode(r,t){if(r.event===this.BROADCAST_EVENT&&!(r.payload instanceof ArrayBuffer)&&typeof r.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(r));let n=[r.join_ref,r.ref,r.topic,r.event,r.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(r){var t;return this._isArrayBuffer((t=r.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(r):this._encodeJsonUserBroadcastPush(r)}_encodeBinaryUserBroadcastPush(r){var t,n;const a=(n=(t=r.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(r,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(r){var t,n;const a=(n=(t=r.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(r,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(r,t,n){var a,i;const o=r.topic,c=(a=r.ref)!==null&&a!==void 0?a:"",u=(i=r.join_ref)!==null&&i!==void 0?i:"",l=r.payload.event,d=this.allowedMetadataKeys?this._pick(r.payload,this.allowedMetadataKeys):{},f=Object.keys(d).length===0?"":JSON.stringify(d);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+c.length+o.length+l.length+f.length,h=new ArrayBuffer(this.HEADER_LENGTH+p);let y=new DataView(h),g=0;y.setUint8(g++,this.KINDS.userBroadcastPush),y.setUint8(g++,u.length),y.setUint8(g++,c.length),y.setUint8(g++,o.length),y.setUint8(g++,l.length),y.setUint8(g++,f.length),y.setUint8(g++,t),Array.from(u,x=>y.setUint8(g++,x.charCodeAt(0))),Array.from(c,x=>y.setUint8(g++,x.charCodeAt(0))),Array.from(o,x=>y.setUint8(g++,x.charCodeAt(0))),Array.from(l,x=>y.setUint8(g++,x.charCodeAt(0))),Array.from(f,x=>y.setUint8(g++,x.charCodeAt(0)));var m=new Uint8Array(h.byteLength+n.byteLength);return m.set(new Uint8Array(h),0),m.set(new Uint8Array(n),h.byteLength),m.buffer}decode(r,t){if(this._isArrayBuffer(r)){let n=this._binaryDecode(r);return t(n)}if(typeof r=="string"){const n=JSON.parse(r),[a,i,o,c,u]=n;return t({join_ref:a,ref:i,topic:o,event:c,payload:u})}return t({})}_binaryDecode(r){const t=new DataView(r),n=t.getUint8(0),a=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(r,t,a)}_decodeUserBroadcast(r,t,n){const a=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),c=t.getUint8(4);let u=this.HEADER_LENGTH+4;const l=n.decode(r.slice(u,u+a));u=u+a;const d=n.decode(r.slice(u,u+i));u=u+i;const f=n.decode(r.slice(u,u+o));u=u+o;const p=r.slice(u,r.byteLength),h=c===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,y={type:this.BROADCAST_EVENT,event:d,payload:h};return o>0&&(y.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(r){var t;return r instanceof ArrayBuffer||((t=r?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(r,t){return!r||typeof r!="object"?{}:Object.fromEntries(Object.entries(r).filter(([n])=>t.includes(n)))}}let ZP=class{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Zn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Zn||(Zn={}));const tS=(e,r,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return r?Object.keys(r).reduce((i,o)=>(i[o]=tU(o,e,r,a),i),{}):{}},tU=(e,r,t,n)=>{const a=r.find(c=>c.name===e),i=a?.type,o=t[e];return i&&!n.includes(i)?JP(i,o):U5(o)},JP=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return aU(r,t)}switch(e){case Zn.bool:return rU(r);case Zn.float4:case Zn.float8:case Zn.int2:case Zn.int4:case Zn.int8:case Zn.numeric:case Zn.oid:return nU(r);case Zn.json:case Zn.jsonb:return sU(r);case Zn.timestamp:return iU(r);case Zn.abstime:case Zn.date:case Zn.daterange:case Zn.int4range:case Zn.int8range:case Zn.money:case Zn.reltime:case Zn.text:case Zn.time:case Zn.timestamptz:case Zn.timetz:case Zn.tsrange:case Zn.tstzrange:return U5(r);default:return U5(r)}},U5=e=>e,rU=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},nU=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},sU=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},aU=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>JP(r,c))}return e},iU=e=>typeof e=="string"?e.replace(" ","T"):e,eO=e=>{const r=new URL(e);return r.protocol=r.protocol.replace(/^ws/i,"http"),r.pathname=r.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),r.pathname===""||r.pathname==="/"?r.pathname="/api/broadcast":r.pathname=r.pathname+"/api/broadcast",r.href};class B2{constructor(r,t,n={},a=q5){this.channel=r,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var rS;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(rS||(rS={}));class Y0{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Y0.syncState(this.state,a,i,o),this.pendingDiffs.forEach(u=>{this.state=Y0.syncDiff(this.state,u,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Y0.syncDiff(this.state,a,i,o),c())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,a){const i=this.cloneDeep(r),o=this.transformState(t),c={},u={};return this.map(i,(l,d)=>{o[l]||(u[l]=d)}),this.map(o,(l,d)=>{const f=i[l];if(f){const p=d.map(m=>m.presence_ref),h=f.map(m=>m.presence_ref),y=d.filter(m=>h.indexOf(m.presence_ref)<0),g=f.filter(m=>p.indexOf(m.presence_ref)<0);y.length>0&&(c[l]=y),g.length>0&&(u[l]=g)}else c[l]=d}),this.syncDiff(i,{joins:c,leaves:u},n,a)}static syncDiff(r,t,n,a){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(c,u)=>{var l;const d=(l=r[c])!==null&&l!==void 0?l:[];if(r[c]=this.cloneDeep(u),d.length>0){const f=r[c].map(h=>h.presence_ref),p=d.filter(h=>f.indexOf(h.presence_ref)<0);r[c].unshift(...p)}n(c,d,u)}),this.map(o,(c,u)=>{let l=r[c];if(!l)return;const d=u.map(f=>f.presence_ref);l=l.filter(f=>d.indexOf(f.presence_ref)<0),r[c]=l,a(c,l,u),l.length===0&&delete r[c]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const a=r[n];return"metas"in a?t[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=a,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var nS;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(nS||(nS={}));var Q0;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Q0||(Q0={}));var qu;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(qu||(qu={}));class em{constructor(r,t={config:{}},n){var a,i;if(this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=Da.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new B2(this,rc.join,this.params,this.timeout),this.rejoinTimer=new ZP(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Da.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Da.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Da.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Da.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Da.errored,this.rejoinTimer.scheduleTimeout())}),this._on(rc.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Y0(this),this.broadcastEndpointURL=eO(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(r,t=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Da.closed){const{config:{broadcast:o,presence:c,private:u}}=this.params,l=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[Q0.PRESENCE]&&this.bindings[Q0.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},p={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:d}),postgres_changes:l,private:u};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>r?.(qu.CHANNEL_ERROR,h)),this._onClose(()=>r?.(qu.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){r?.(qu.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,m=(y=g?.length)!==null&&y!==void 0?y:0,x=[];for(let v=0;v<m;v++){const w=g[v],{filter:{event:_,schema:A,table:P,filter:B}}=w,T=h&&h[v];if(T&&T.event===_&&em.isFilterValueEqual(T.schema,A)&&em.isFilterValueEqual(T.table,P)&&em.isFilterValueEqual(T.filter,B))x.push(Object.assign(Object.assign({},w),{id:T.id}));else{this.unsubscribe(),this.state=Da.errored,r?.(qu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(qu.SUBSCRIBED);return}}).receive("error",h=>{this.state=Da.errored,r?.(qu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{r?.(qu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this.state===Da.joined&&r===Q0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(r,t,n)}async httpSend(r,t,n={}){var a;if(t==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(c.status===202)return{success:!0};let u=c.statusText;try{const l=await c.json();u=l.error||l.message||u}catch{}return Promise.reject(new Error(u))}async send(r,t={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=r,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=l.body)===null||a===void 0?void 0:a.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,u;const l=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((u=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Da.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(rc.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new B2(this,rc.leave,{},r),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Da.closed,this.bindings={}}async _fetchWithTimeout(r,t,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(i),o}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new B2(this,r,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>Jz){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var a,i;const o=r.toLocaleLowerCase(),{close:c,error:u,leave:l,join:d}=rc;if(n&&[c,u,l,d].indexOf(o)>=0&&n!==this._joinRef())return;let p=this._onMessage(o,t,n);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var y,g,m;return((y=h.filter)===null||y===void 0?void 0:y.event)==="*"||((m=(g=h.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(h=>h.callback(p,n)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var y,g,m,x,v,w,_,A;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const P=h.id,B=(y=h.filter)===null||y===void 0?void 0:y.event;return P&&((g=t.ids)===null||g===void 0?void 0:g.includes(P))&&(B==="*"||B?.toLocaleLowerCase()===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))&&(!(!((x=h.filter)===null||x===void 0)&&x.table)||h.filter.table===((v=t.data)===null||v===void 0?void 0:v.table))}else{const P=(_=(w=h?.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return P==="*"||P===((A=t?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:g,table:m,commit_timestamp:x,type:v,errors:w}=y;p=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:x,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(y))}h.callback(p,n)})}_isClosed(){return this.state===Da.closed}_isJoined(){return this.state===Da.joined}_isJoining(){return this.state===Da.joining}_isLeaving(){return this.state===Da.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const a=r.toLocaleLowerCase(),i={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&em.isEqual(a.filter,t))})),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}static isFilterValueEqual(r,t){return(r??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(rc.close,{},r)}_onError(r){this._on(rc.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Da.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=tS(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=tS(r.columns,r.old_record)),t}}const $2=()=>{},rx={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},oU=[1e3,2e3,5e3,1e4],lU=1e4,cU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class uU{constructor(r,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=q5,this.transport=null,this.heartbeatIntervalMs=rx.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$2,this.ref=0,this.reconnectTimer=null,this.vsn=eS,this.logger=$2,this.conn=null,this.sendBuffer=[],this.serializer=new eU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${r}/${z5.websocket}`,this.httpEndpoint=eO(r),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Gz.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const t=r.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(r,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(r?this.conn.close(r,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case sh.connecting:return df.Connecting;case sh.open:return df.Open;case sh.closing:return df.Closing;default:return df.Closed}}isConnected(){return this.connectionState()===df.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,t={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new em(`realtime:${r}`,t,this);return this.channels.push(i),i}}push(r){const{topic:t,event:n,payload:a,ref:i}=r,o=()=>{this.encode(r,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${t} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(Zz,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},rx.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const l=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",l)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:i,ref:o}=t,c=o?`(${o})`:"",u=i.status||"";this.log("receive",`${u} ${n} ${a} ${c}`.trim(),i),this.channels.filter(l=>l._isMember(n)).forEach(l=>l._trigger(a,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(r){var t;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r),this.conn.readyState===sh.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===sh.open||this.conn.readyState===sh.connecting)try{this.conn.close()}catch(r){this.log("error","Error closing connection",r)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(r){var t;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(rc.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${r}${n}${a}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([cU],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(r,t=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(r=null){let t,n=!1;if(r)t=r,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const i={access_token:t,version:Yz};t&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(rc.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${r}`,t)})}_triggerStateCallbacks(r,t){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new ZP(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rx.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var t,n,a,i,o,c,u,l,d,f,p,h;switch(this.transport=(t=r?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:q5,this.heartbeatIntervalMs=(a=r?.heartbeatIntervalMs)!==null&&a!==void 0?a:rx.HEARTBEAT_INTERVAL,this.worker=(i=r?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=r?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=r?.heartbeatCallback)!==null&&c!==void 0?c:$2,this.vsn=(u=r?.vsn)!==null&&u!==void 0?u:eS,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=r?.reconnectAfterMs)!==null&&l!==void 0?l:(y=>oU[y-1]||lU),this.vsn){case QP:this.encode=(d=r?.encode)!==null&&d!==void 0?d:((y,g)=>g(JSON.stringify(y))),this.decode=(f=r?.decode)!==null&&f!==void 0?f:((y,g)=>g(JSON.parse(y)));break;case Qz:this.encode=(p=r?.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(h=r?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}var lg=class extends Error{constructor(e,r){super(e),this.name="IcebergError",this.status=r.status,this.icebergType=r.icebergType,this.icebergCode=r.icebergCode,this.details=r.details,this.isCommitStateUnknown=r.icebergType==="CommitStateUnknownException"||[500,502,504].includes(r.status)&&r.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function dU(e,r,t){const n=new URL(r,e);if(t)for(const[a,i]of Object.entries(t))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function hU(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function fU(e){const r=e.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:a,body:i,headers:o}){const c=dU(e.baseUrl,n,a),u=await hU(e.auth),l=await r(c,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...u,...o},body:i?JSON.stringify(i):void 0}),d=await l.text(),f=(l.headers.get("content-type")||"").includes("application/json"),p=f&&d?JSON.parse(d):d;if(!l.ok){const h=f?p:void 0,y=h?.error;throw new lg(y?.message??`Request failed with status ${l.status}`,{status:l.status,icebergType:y?.type,icebergCode:y?.code,details:h})}return{status:l.status,headers:l.headers,data:p}}}}function nx(e){return e.join("")}var pU=class{constructor(e,r=""){this.client=e,this.prefix=r}async listNamespaces(e){const r=e?{parent:nx(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:r})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,r){const t={namespace:e.namespace,properties:r?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${nx(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${nx(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${nx(e.namespace)}`}),!0}catch(r){if(r instanceof lg&&r.status===404)return!1;throw r}}async createNamespaceIfNotExists(e,r){try{return await this.createNamespace(e,r)}catch(t){if(t instanceof lg&&t.status===409)return;throw t}}};function Ap(e){return e.join("")}var mU=class{constructor(e,r="",t){this.client=e,this.prefix=r,this.accessDelegation=t}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables`})).data.identifiers}async createTable(e,r){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables`,body:r,headers:t})).data.metadata}async updateTable(e,r){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables/${e.name}`,body:r});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(e,r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(r?.purge??!1)}})}async loadTable(e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables/${e.name}`,headers:r})).data.metadata}async tableExists(e){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ap(e.namespace)}/tables/${e.name}`,headers:r}),!0}catch(t){if(t instanceof lg&&t.status===404)return!1;throw t}}async createTableIfNotExists(e,r){try{return await this.createTable(e,r)}catch(t){if(t instanceof lg&&t.status===409)return await this.loadTable({namespace:e.namespace,name:r.name});throw t}}},gU=class{constructor(e){let r="v1";e.catalogName&&(r+=`/${e.catalogName}`);const t=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=fU({baseUrl:t,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new pU(this.client,r),this.tableOps=new mU(this.client,r,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,r){return this.namespaceOps.createNamespace(e,r)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,r){return this.tableOps.createTable(e,r)}async updateTable(e,r){return this.tableOps.updateTable(e,r)}async dropTable(e,r){await this.tableOps.dropTable(e,r)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,r){return this.namespaceOps.createNamespaceIfNotExists(e,r)}async createTableIfNotExists(e,r){return this.tableOps.createTableIfNotExists(e,r)}},Lb=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Ps(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var yU=class extends Lb{constructor(e,r,t){super(e),this.name="StorageApiError",this.status=r,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},H5=class extends Lb{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}};const W4=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),xU=()=>Response,V5=e=>{if(Array.isArray(e))return e.map(t=>V5(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));r[a]=V5(n)}),r},vU=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},bU=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},cg(e)}function wU(e,r){if(cg(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(cg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function _U(e){var r=wU(e,"string");return cg(r)=="symbol"?r:r+""}function jU(e,r,t){return(r=_U(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function sS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Sr(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sS(Object(t),!0).forEach(function(n){jU(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}const q2=e=>{var r;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(r=e.error)===null||r===void 0?void 0:r.message)||JSON.stringify(e)},NU=async(e,r,t)=>{e instanceof await xU()&&!t?.noResolveJson?e.json().then(n=>{const a=e.status||500,i=n?.statusCode||a+"";r(new yU(q2(n),a,i))}).catch(n=>{r(new H5(q2(n),n))}):r(new H5(q2(e),e))},kU=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"||!n?a:(vU(n)?(a.headers=Sr({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(n)):a.body=n,r?.duplex&&(a.duplex=r.duplex),Sr(Sr({},a),t))};async function Vg(e,r,t,n,a,i){return new Promise((o,c)=>{e(t,kU(r,n,a,i)).then(u=>{if(!u.ok)throw u;return n?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>NU(u,c,n))})}async function ug(e,r,t,n){return Vg(e,"GET",r,t,n)}async function tc(e,r,t,n,a){return Vg(e,"POST",r,n,a,t)}async function W5(e,r,t,n,a){return Vg(e,"PUT",r,n,a,t)}async function SU(e,r,t,n){return Vg(e,"HEAD",r,Sr(Sr({},t),{},{noResolveJson:!0}),n)}async function K4(e,r,t,n,a){return Vg(e,"DELETE",r,n,a,t)}var CU=class{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ps(r))return{data:null,error:r};throw r}}};let tO;tO=Symbol.toStringTag;var AU=class{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[tO]="BlobDownloadBuilder",this.promise=null}asStream(){return new CU(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ps(r))return{data:null,error:r};throw r}}};const EU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},aS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var TU=class{constructor(e,r={},t,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=t,this.fetch=W4(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,r,t,n){var a=this;try{let i;const o=Sr(Sr({},aS),n);let c=Sr(Sr({},a.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),u&&i.append("metadata",a.encodeMetadata(u)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),u&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(u))):(i=t,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,u&&(c["x-metadata"]=a.toBase64(a.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(c=Sr(Sr({},c),n.headers));const l=a._removeEmptyFolders(r),d=a._getFinalPath(l),f=await(e=="PUT"?W5:tc)(a.fetch,`${a.url}/object/${d}`,i,Sr({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:l,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Ps(i))return{data:null,error:i};throw i}}async upload(e,r,t){return this.uploadOrUpdate("POST",e,r,t)}async uploadToSignedUrl(e,r,t,n){var a=this;const i=a._removeEmptyFolders(e),o=a._getFinalPath(i),c=new URL(a.url+`/object/upload/sign/${o}`);c.searchParams.set("token",r);try{let u;const l=Sr({upsert:aS.upsert},n),d=Sr(Sr({},a.headers),{"x-upsert":String(l.upsert)});return typeof Blob<"u"&&t instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",t)):typeof FormData<"u"&&t instanceof FormData?(u=t,u.append("cacheControl",l.cacheControl)):(u=t,d["cache-control"]=`max-age=${l.cacheControl}`,d["content-type"]=l.contentType),{data:{path:i,fullPath:(await W5(a.fetch,c.toString(),u,{headers:d})).Key},error:null}}catch(u){if(a.shouldThrowOnError)throw u;if(Ps(u))return{data:null,error:u};throw u}}async createSignedUploadUrl(e,r){var t=this;try{let n=t._getFinalPath(e);const a=Sr({},t.headers);r?.upsert&&(a["x-upsert"]="true");const i=await tc(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(t.url+i.url),c=o.searchParams.get("token");if(!c)throw new Lb("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ps(n))return{data:null,error:n};throw n}}async update(e,r,t){return this.uploadOrUpdate("PUT",e,r,t)}async move(e,r,t){var n=this;try{return{data:await tc(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:r,destinationBucket:t?.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ps(a))return{data:null,error:a};throw a}}async copy(e,r,t){var n=this;try{return{data:{path:(await tc(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:r,destinationBucket:t?.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ps(a))return{data:null,error:a};throw a}}async createSignedUrl(e,r,t){var n=this;try{let a=n._getFinalPath(e),i=await tc(n.fetch,`${n.url}/object/sign/${a}`,Sr({expiresIn:r},t?.transform?{transform:t.transform}:{}),{headers:n.headers});const o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return i={signedUrl:encodeURI(`${n.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ps(a))return{data:null,error:a};throw a}}async createSignedUrls(e,r,t){var n=this;try{const a=await tc(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:r,paths:e},{headers:n.headers}),i=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:a.map(o=>Sr(Sr({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ps(a))return{data:null,error:a};throw a}}download(e,r){const t=typeof r?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(r?.transform||{}),a=n?`?${n}`:"",i=this._getFinalPath(e),o=()=>ug(this.fetch,`${this.url}/${t}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new AU(o,this.shouldThrowOnError)}async info(e){var r=this;const t=r._getFinalPath(e);try{return{data:V5(await ug(r.fetch,`${r.url}/object/info/${t}`,{headers:r.headers})),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ps(n))return{data:null,error:n};throw n}}async exists(e){var r=this;const t=r._getFinalPath(e);try{return await SU(r.fetch,`${r.url}/object/${t}`,{headers:r.headers}),{data:!0,error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ps(n)&&n instanceof H5){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,r){const t=this._getFinalPath(e),n=[],a=r?.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const i=typeof r?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(r?.transform||{});o!==""&&n.push(o);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${t}${c}`)}}}async remove(e){var r=this;try{return{data:await K4(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:e},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async list(e,r,t){var n=this;try{const a=Sr(Sr(Sr({},EU),r),{},{prefix:e||""});return{data:await tc(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},t),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ps(a))return{data:null,error:a};throw a}}async listV2(e,r){var t=this;try{const n=Sr({},e);return{data:await tc(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},r),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ps(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}};const rO="2.90.1",nO={"X-Client-Info":`storage-js/${rO}`};var PU=class{constructor(e,r={},t,n){this.shouldThrowOnError=!1;const a=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Sr(Sr({},nO),r),this.fetch=W4(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var r=this;try{const t=r.listBucketOptionsToQueryString(e);return{data:await ug(r.fetch,`${r.url}/bucket${t}`,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async getBucket(e){var r=this;try{return{data:await ug(r.fetch,`${r.url}/bucket/${e}`,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async createBucket(e,r={public:!1}){var t=this;try{return{data:await tc(t.fetch,`${t.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ps(n))return{data:null,error:n};throw n}}async updateBucket(e,r){var t=this;try{return{data:await W5(t.fetch,`${t.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ps(n))return{data:null,error:n};throw n}}async emptyBucket(e){var r=this;try{return{data:await tc(r.fetch,`${r.url}/bucket/${e}/empty`,{},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async deleteBucket(e){var r=this;try{return{data:await K4(r.fetch,`${r.url}/bucket/${e}`,{},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},OU=class{constructor(e,r={},t){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Sr(Sr({},nO),r),this.fetch=W4(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var r=this;try{return{data:await tc(r.fetch,`${r.url}/bucket`,{name:e},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async listBuckets(e){var r=this;try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const n=t.toString(),a=n?`${r.url}/bucket?${n}`:`${r.url}/bucket`;return{data:await ug(r.fetch,a,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}async deleteBucket(e){var r=this;try{return{data:await K4(r.fetch,`${r.url}/bucket/${e}`,{},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ps(t))return{data:null,error:t};throw t}}from(e){var r=this;if(!bU(e))throw new Lb("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new gU({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>r.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(a,c),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}}}})}};const G4={"X-Client-Info":`storage-js/${rO}`,"Content-Type":"application/json"};var sO=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ho(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var z2=class extends sO{constructor(e,r,t){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},MU=class extends sO{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}};const X4=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),IU=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},iS=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),RU=async(e,r,t)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!t?.noResolveJson){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const o=i?.statusCode||i?.code||n+"";r(new z2(iS(i),n,o))}).catch(()=>{const i=n+"";r(new z2(a.statusText||`HTTP ${n} error`,n,i))});else{const i=n+"";r(new z2(a.statusText||`HTTP ${n} error`,n,i))}}else r(new MU(iS(e),e))},LU=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return n?(IU(n)?(a.headers=Sr({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(n)):a.body=n,Sr(Sr({},a),t)):a};async function DU(e,r,t,n,a,i){return new Promise((o,c)=>{e(t,LU(r,n,a,i)).then(u=>{if(!u.ok)throw u;if(n?.noResolveJson)return u;const l=u.headers.get("content-type");return!l||!l.includes("application/json")?{}:u.json()}).then(u=>o(u)).catch(u=>RU(u,c,n))})}async function Vo(e,r,t,n,a){return DU(e,"POST",r,n,a,t)}var FU=class{constructor(e,r={},t){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Sr(Sr({},G4),r),this.fetch=X4(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/CreateIndex`,e,{headers:r.headers})||{},error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async getIndex(e,r){var t=this;try{return{data:await Vo(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ho(n))return{data:null,error:n};throw n}}async listIndexes(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/ListIndexes`,e,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async deleteIndex(e,r){var t=this;try{return{data:await Vo(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ho(n))return{data:null,error:n};throw n}}},BU=class{constructor(e,r={},t){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Sr(Sr({},G4),r),this.fetch=X4(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var r=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Vo(r.fetch,`${r.url}/PutVectors`,e,{headers:r.headers})||{},error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async getVectors(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/GetVectors`,e,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async listVectors(e){var r=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Vo(r.fetch,`${r.url}/ListVectors`,e,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async queryVectors(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/QueryVectors`,e,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async deleteVectors(e){var r=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Vo(r.fetch,`${r.url}/DeleteVectors`,e,{headers:r.headers})||{},error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}},$U=class{constructor(e,r={},t){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Sr(Sr({},G4),r),this.fetch=X4(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:r.headers})||{},error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async getBucket(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/GetVectorBucket`,{vectorBucketName:e},{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async listBuckets(e={}){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/ListVectorBuckets`,e,{headers:r.headers}),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}async deleteBucket(e){var r=this;try{return{data:await Vo(r.fetch,`${r.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:r.headers})||{},error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Ho(t))return{data:null,error:t};throw t}}},qU=class extends $U{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new zU(this.url,this.headers,e,this.fetch)}async createBucket(e){var r=()=>super.createBucket,t=this;return r().call(t,e)}async getBucket(e){var r=()=>super.getBucket,t=this;return r().call(t,e)}async listBuckets(e={}){var r=()=>super.listBuckets,t=this;return r().call(t,e)}async deleteBucket(e){var r=()=>super.deleteBucket,t=this;return r().call(t,e)}},zU=class extends FU{constructor(e,r,t,n){super(e,r,n),this.vectorBucketName=t}async createIndex(e){var r=()=>super.createIndex,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(e={}){var r=()=>super.listIndexes,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(e){var r=()=>super.getIndex,t=this;return r().call(t,t.vectorBucketName,e)}async deleteIndex(e){var r=()=>super.deleteIndex,t=this;return r().call(t,t.vectorBucketName,e)}index(e){return new UU(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},UU=class extends BU{constructor(e,r,t,n,a){super(e,r,a),this.vectorBucketName=t,this.indexName=n}async putVectors(e){var r=()=>super.putVectors,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var r=()=>super.getVectors,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(e={}){var r=()=>super.listVectors,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var r=()=>super.queryVectors,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var r=()=>super.deleteVectors,t=this;return r().call(t,Sr(Sr({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},HU=class extends PU{constructor(e,r={},t,n){super(e,r,t,n)}from(e){return new TU(this.url,this.headers,e,this.fetch)}get vectors(){return new qU(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new OU(this.url+"/iceberg",this.headers,this.fetch)}};const aO="2.90.1",Gp=30*1e3,K5=3,U2=K5*Gp,VU="http://localhost:9999",WU="supabase.auth.token",KU={"X-Client-Info":`gotrue-js/${aO}`},G5="X-Supabase-Api-Version",iO={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},GU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XU=600*1e3;class dg extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function pr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class YU extends dg{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function QU(e){return pr(e)&&e.name==="AuthApiError"}class hf extends dg{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class pd extends dg{constructor(r,t,n,a){super(r,n,a),this.name=t,this.status=n}}class Uo extends pd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ZU(e){return pr(e)&&e.name==="AuthSessionMissingError"}class Ep extends pd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sx extends pd{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class ax extends pd{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function JU(e){return pr(e)&&e.name==="AuthImplicitGrantRedirectError"}class oS extends pd{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eH extends pd{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class X5 extends pd{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function H2(e){return pr(e)&&e.name==="AuthRetryableFetchError"}class lS extends pd{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Y5 extends pd{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const gv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cS=` 	
\r=`.split(""),tH=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<cS.length;r+=1)e[cS[r].charCodeAt(0)]=-2;for(let r=0;r<gv.length;r+=1)e[gv[r].charCodeAt(0)]=r;return e})();function uS(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(gv[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(gv[n]),r.queuedBits-=6}}function oO(e,r,t){const n=tH[e];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function dS(e){const r=[],t=o=>{r.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{sH(o,n,t)};for(let o=0;o<e.length;o+=1)oO(e.charCodeAt(o),a,i);return r.join("")}function rH(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function nH(e,r){for(let t=0;t<e.length;t+=1){let n=e.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}rH(n,r)}}function sH(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function am(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<e.length;a+=1)oO(e.charCodeAt(a),t,n);return new Uint8Array(r)}function aH(e){const r=[];return nH(e,t=>r.push(t)),new Uint8Array(r)}function gf(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};return e.forEach(a=>uS(a,t,n)),uS(null,t,n),r.join("")}function iH(e){return Math.round(Date.now()/1e3)+e}function oH(){return Symbol("auth-callback")}const vi=()=>typeof window<"u"&&typeof document<"u",Zh={tested:!1,writable:!1},lO=()=>{if(!vi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zh.tested)return Zh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Zh.tested=!0,Zh.writable=!0}catch{Zh.tested=!0,Zh.writable=!1}return Zh.writable};function lH(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,i)=>{r[i]=a})}catch{}return t.searchParams.forEach((n,a)=>{r[a]=n}),r}const cO=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),cH=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Xp=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Jh=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},xi=async(e,r)=>{await e.removeItem(r)};class Db{constructor(){this.promise=new Db.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}Db.promiseConstructor=Promise;function V2(e){const r=e.split(".");if(r.length!==3)throw new Y5("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!GU.test(r[n]))throw new Y5("JWT not in base64url format");return{header:JSON.parse(dS(r[0])),payload:JSON.parse(dS(r[1])),signature:am(r[2]),raw:{header:r[0],payload:r[1]}}}async function uH(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function dH(e,r){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!r(i,null,o)){n(o);return}}catch(o){if(!r(i,o)){a(o);return}}})()})}function hH(e){return("0"+e.toString(16)).substr(-2)}function fH(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let i=0;i<56;i++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,hH).join("")}async function pH(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function mH(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await pH(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Tp(e,r,t=!1){const n=fH();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await Xp(e,`${r}-code-verifier`,a);const i=await mH(n);return[i,n===i?"plain":"s256"]}const gH=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yH(e){const r=e.headers.get(G5);if(!r||!r.match(gH))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function xH(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function vH(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const bH=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pp(e){if(!bH.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function W2(){const e={};return new Proxy(e,{get:(r,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function wH(e,r){return new Proxy(e,{get:(t,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,a)}return!r.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(t,n,a)}})}function hS(e){return JSON.parse(JSON.stringify(e))}const af=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_H=[502,503,504];async function fS(e){var r;if(!cH(e))throw new X5(af(e),0);if(_H.includes(e.status))throw new X5(af(e),e.status);let t;try{t=await e.json()}catch(i){throw new hf(af(i),i)}let n;const a=yH(e);if(a&&a.getTime()>=iO["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new lS(af(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new Uo}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new lS(af(t),e.status,t.weak_password.reasons);throw new YU(af(t),e.status||500,n)}const jH=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function kr(e,r,t,n){var a;const i=Object.assign({},n?.headers);i[G5]||(i[G5]=iO["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await NH(e,r,t+c,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(u):{data:Object.assign({},u),error:null}}async function NH(e,r,t,n,a,i){const o=jH(r,n,a,i);let c;try{c=await e(t,Object.assign({},o))}catch(u){throw console.error(u),new X5(af(u),0)}if(c.ok||await fS(c),n?.noResolveJson)return c;try{return await c.json()}catch(u){await fS(u)}}function Jl(e){var r;let t=null;CH(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=iH(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function pS(e){const r=Jl(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function oh(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function kH(e){return{data:e,error:null}}function SH(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i}=e,o=Rb(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i},u=Object.assign({},o);return{data:{properties:c,user:u},error:null}}function mS(e){return e}function CH(e){return e.access_token&&e.refresh_token&&e.expires_in}const K2=["global","local","others"];class AH{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=cO(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(r,t=K2[0]){if(K2.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${K2.join(", ")}`);try{return await kr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(pr(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await kr(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:oh})}catch(n){if(pr(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=Rb(r,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await kr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:SH,redirectTo:t?.redirectTo})}catch(t){if(pr(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await kr(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:oh})}catch(t){if(pr(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,a,i,o,c,u;try{const l={nextPage:null,lastPage:0,total:0},d=await kr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:mS});if(d.error)throw d.error;const f=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(u=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return h.length>0&&(h.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(y.split(";")[1].split("=")[1]);l[`${m}Page`]=g}),l.total=parseInt(p)),{data:Object.assign(Object.assign({},f),l),error:null}}catch(l){if(pr(l))return{data:{users:[]},error:l};throw l}}async getUserById(r){Pp(r);try{return await kr(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:oh})}catch(t){if(pr(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){Pp(r);try{return await kr(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:oh})}catch(n){if(pr(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){Pp(r);try{return await kr(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:oh})}catch(n){if(pr(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Pp(r.userId);try{const{data:t,error:n}=await kr(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(pr(t))return{data:null,error:t};throw t}}async _deleteFactor(r){Pp(r.userId),Pp(r.id);try{return{data:await kr(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(pr(t))return{data:null,error:t};throw t}}async _listOAuthClients(r){var t,n,a,i,o,c,u;try{const l={nextPage:null,lastPage:0,total:0},d=await kr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:mS});if(d.error)throw d.error;const f=await d.json(),p=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(u=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return h.length>0&&(h.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(y.split(";")[1].split("=")[1]);l[`${m}Page`]=g}),l.total=parseInt(p)),{data:Object.assign(Object.assign({},f),l),error:null}}catch(l){if(pr(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(r){try{return await kr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:r,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(pr(t))return{data:null,error:t};throw t}}async _getOAuthClient(r){try{return await kr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(pr(t))return{data:null,error:t};throw t}}async _updateOAuthClient(r,t){try{return await kr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${r}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(pr(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(r){try{return await kr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(pr(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(r){try{return await kr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${r}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(pr(t))return{data:null,error:t};throw t}}}function gS(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}const Op={debug:!!(globalThis&&lO()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class uO extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class EH extends uO{}async function TH(e,r,t){Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Op.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await t()}finally{Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(r===0)throw Op.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new EH(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Op.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function PH(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function dO(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function OH(e){return parseInt(e,16)}function MH(e){const r=new TextEncoder().encode(e);return"0x"+Array.from(r,n=>n.toString(16).padStart(2,"0")).join("")}function IH(e){var r;const{chainId:t,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:u,resources:l,scheme:d,uri:f,version:p}=e;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((r=e.statement)===null||r===void 0)&&r.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const h=dO(e.address),y=d?`${d}://${n}`:n,g=e.statement?`${e.statement}
`:"",m=`${y} wants you to sign in with your Ethereum account:
${h}

${g}`;let x=`URI: ${f}
Version: ${p}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),c&&(x+=`
Not Before: ${c.toISOString()}`),u&&(x+=`
Request ID: ${u}`),l){let v=`
Resources:`;for(const w of l){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);v+=`
- ${w}`}x+=v}return`${m}
${x}`}class va extends Error{constructor({message:r,code:t,cause:n,name:a}){var i;super(r,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class yv extends va{constructor(r,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:r}),this.name="WebAuthnUnknownError",this.originalError=t}}function RH({error:e,options:r}){var t,n,a;const{publicKey:i}=r;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(r.signal instanceof AbortSignal)return new va({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new va({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(r.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new va({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new va({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new va({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new va({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new va({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new va({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(hO(o)){if(i.rp.id!==o)return new va({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new va({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new va({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new va({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new va({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function LH({error:e,options:r}){const{publicKey:t}=r;if(!t)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(r.signal instanceof AbortSignal)return new va({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new va({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(hO(n)){if(t.rpId!==n)return new va({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new va({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new va({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new va({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class DH{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const r=new AbortController;return this.controller=r,r.signal}cancelCeremony(){if(this.controller){const r=new Error("Manually cancelling existing WebAuthn API call");r.name="AbortError",this.controller.abort(r),this.controller=void 0}}}const FH=new DH;function BH(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:r,user:t,excludeCredentials:n}=e,a=Rb(e,["challenge","user","excludeCredentials"]),i=am(r).buffer,o=Object.assign(Object.assign({},t),{id:am(t.id).buffer}),c=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const l=n[u];c.excludeCredentials[u]=Object.assign(Object.assign({},l),{id:am(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return c}function $H(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:r,allowCredentials:t}=e,n=Rb(e,["challenge","allowCredentials"]),a=am(r).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const c=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:am(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function qH(e){var r;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const t=e;return{id:e.id,rawId:e.id,response:{attestationObject:gf(new Uint8Array(e.response.attestationObject)),clientDataJSON:gf(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(r=t.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function zH(e){var r;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const t=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:gf(new Uint8Array(a.authenticatorData)),clientDataJSON:gf(new Uint8Array(a.clientDataJSON)),signature:gf(new Uint8Array(a.signature)),userHandle:a.userHandle?gf(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(r=t.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function hO(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function yS(){var e,r;return!!(vi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((r=navigator?.credentials)===null||r===void 0?void 0:r.get)=="function")}async function UH(e){try{const r=await navigator.credentials.create(e);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new yv("Browser returned unexpected credential type",r)}:{data:null,error:new yv("Empty credential response",r)}}catch(r){return{data:null,error:RH({error:r,options:e})}}}async function HH(e){try{const r=await navigator.credentials.get(e);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new yv("Browser returned unexpected credential type",r)}:{data:null,error:new yv("Empty credential response",r)}}catch(r){return{data:null,error:LH({error:r,options:e})}}}const VH={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},WH={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function xv(...e){const r=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(t(o))n[i]=o;else if(r(o)){const c=n[i];r(c)?n[i]=xv(c,o):n[i]=xv(o)}else n[i]=o}return n}function KH(e,r){return xv(VH,e,r||{})}function GH(e,r){return xv(WH,e,r||{})}class XH{constructor(r){this.client=r,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(r){return this.client.mfa.enroll(Object.assign(Object.assign({},r),{factorType:"webauthn"}))}async _challenge({factorId:r,webauthn:t,friendlyName:n,signal:a},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:r,webauthn:t});if(!o)return{data:null,error:c};const u=a??FH.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:l}=o.webauthn.credential_options.publicKey;l.name||(l.name=`${l.id}:${n}`),l.displayName||(l.displayName=l.name)}switch(o.webauthn.type){case"create":{const l=KH(o.webauthn.credential_options.publicKey,i?.create),{data:d,error:f}=await UH({publicKey:l,signal:u});return d?{data:{factorId:r,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const l=GH(o.webauthn.credential_options.publicKey,i?.request),{data:d,error:f}=await HH(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:l,signal:u}));return d?{data:{factorId:r,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(o){return pr(o)?{data:null,error:o}:{data:null,error:new hf("Unexpected error in challenge",o)}}}async _verify({challengeId:r,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:r,webauthn:n})}async _authenticate({factorId:r,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new dg("rpId is required for WebAuthn authentication")};try{if(!yS())return{data:null,error:new hf("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:r,webauthn:{rpId:t,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:c};const{webauthn:u}=o;return this._verify({factorId:r,challengeId:o.challengeId,webauthn:{type:u.type,rpId:t,rpOrigins:n,credential_response:u.credential_response}})}catch(o){return pr(o)?{data:null,error:o}:{data:null,error:new hf("Unexpected error in authenticate",o)}}}async _register({friendlyName:r,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new dg("rpId is required for WebAuthn registration")};try{if(!yS())return{data:null,error:new hf("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:r});if(!o)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===r&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d?.id}):void 0),{data:null,error:c};const{data:u,error:l}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:a},{create:i});return u?this._verify({factorId:o.id,challengeId:u.challengeId,webauthn:{rpId:t,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:l}}catch(o){return pr(o)?{data:null,error:o}:{data:null,error:new hf("Unexpected error in register",o)}}}}PH();const YH={url:VU,storageKey:WU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:KU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function xS(e,r,t){return await t()}const Mp={};class hg{get jwks(){var r,t;return(t=(r=Mp[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(r){Mp[this.storageKey]=Object.assign(Object.assign({},Mp[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,t;return(t=(r=Mp[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){Mp[this.storageKey]=Object.assign(Object.assign({},Mp[this.storageKey]),{cachedAt:r})}constructor(r){var t,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},YH),r);if(this.storageKey=i.storageKey,this.instanceID=(t=hg.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,hg.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&vi()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new AH({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=cO(i.fetch),this.lock=i.lock||xS,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&vi()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=TH:this.lock=xS,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new XH(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:lO()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=gS(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=gS(this.memoryStorage)),vi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(r){if(this.throwOnError&&r&&r.error)throw r.error;return r}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${aO}) ${new Date().toISOString()}`}_debug(...r){return this.logDebugMessages&&this.logger(this._logPrefix(),...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{let t={},n="none";if(vi()&&(t=lH(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),vi()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),JU(i)){const u=(r=i.details)===null||r===void 0?void 0:r.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return pr(t)?this._returnResult({error:t}):this._returnResult({error:new hf("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,a;try{const i=await kr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Jl}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(i){if(pr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(r){var t,n,a;try{let i;if("email"in r){const{email:d,password:f,options:p}=r;let h=null,y=null;this.flowType==="pkce"&&([h,y]=await Tp(this.storage,this.storageKey)),i=await kr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:d,password:f,data:(t=p?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:h,code_challenge_method:y},xform:Jl})}else if("phone"in r){const{phone:d,password:f,options:p}=r;i=await kr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=p?.data)!==null&&n!==void 0?n:{},channel:(a=p?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Jl})}else throw new sx("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return await xi(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const u=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(i){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(r){try{let t;if("email"in r){const{email:i,password:o,options:c}=r;t=await kr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:pS})}else if("phone"in r){const{phone:i,password:o,options:c}=r;t=await kr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:pS})}else throw new sx("You must provide either an email or phone number and a password");const{data:n,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new Ep;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(pr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(r){var t,n,a,i;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=r.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;switch(t){case"ethereum":return await this.signInWithEthereum(r);case"solana":return await this.signInWithSolana(r);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(r){var t,n,a,i,o,c,u,l,d,f,p;let h,y;if("message"in r)h=r.message,y=r.signature;else{const{chain:g,wallet:m,statement:x,options:v}=r;let w;if(vi())if(typeof m=="object")w=m;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")w=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=m}const _=new URL((t=v?.url)!==null&&t!==void 0?t:window.location.href),A=await w.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!A||A.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const P=dO(A[0]);let B=(n=v?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!B){const I=await w.request({method:"eth_chainId"});B=OH(I)}const T={domain:_.host,address:P,statement:x,uri:_.href,version:"1",chainId:B,nonce:(a=v?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=v?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=v?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(u=v?.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(l=v?.signInWithEthereum)===null||l===void 0?void 0:l.requestId,resources:(d=v?.signInWithEthereum)===null||d===void 0?void 0:d.resources};h=IH(T),y=await w.request({method:"personal_sign",params:[MH(h),P]})}try{const{data:g,error:m}=await kr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:y},!((f=r.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=r.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Jl});if(m)throw m;if(!g||!g.session||!g.user){const x=new Ep;return this._returnResult({data:{user:null,session:null},error:x})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:m})}catch(g){if(pr(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(r){var t,n,a,i,o,c,u,l,d,f,p,h;let y,g;if("message"in r)y=r.message,g=r.signature;else{const{chain:m,wallet:x,statement:v,options:w}=r;let _;if(vi())if(typeof x=="object")_=x;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))_=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const A=new URL((t=w?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in _&&_.signIn){const P=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),v?{statement:v}:null));let B;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")B=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)B=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)y=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),g=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${A.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(a=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((u=w?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(d=w?.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const P=await _.signMessage(new TextEncoder().encode(y),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=P}}try{const{data:m,error:x}=await kr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:gf(g)},!((p=r.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Jl});if(x)throw x;if(!m||!m.session||!m.user){const v=new Ep;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(pr(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(r){const t=await Jh(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new eH;const{data:i,error:o}=await kr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:Jl});if(await xi(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new Ep;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(r){try{const{options:t,provider:n,token:a,access_token:i,nonce:o}=r,c=await kr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Jl}),{data:u,error:l}=c;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!u||!u.session||!u.user){const d=new Ep;return this._returnResult({data:{user:null,session:null},error:d})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:l})}catch(t){if(pr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(r){var t,n,a,i,o;try{if("email"in r){const{email:c,options:u}=r;let l=null,d=null;this.flowType==="pkce"&&([l,d]=await Tp(this.storage,this.storageKey));const{error:f}=await kr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=u?.data)!==null&&t!==void 0?t:{},create_user:(n=u?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:l,code_challenge_method:d},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in r){const{phone:c,options:u}=r,{data:l,error:d}=await kr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=u?.data)!==null&&a!==void 0?a:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:d})}throw new sx("You must provide either an email or phone number.")}catch(c){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(r){var t,n;try{let a,i;"options"in r&&(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo,i=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:c}=await kr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Jl});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,l=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:l,session:u},error:null})}catch(a){if(pr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(r){var t,n,a,i,o;try{let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Tp(this.storage,this.storageKey));const l=await kr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:u}),headers:this.headers,xform:kH});return!((i=l.data)===null||i===void 0)&&i.url&&vi()&&!(!((o=r.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(c){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new Uo;const{error:a}=await kr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(r){if(pr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:i}=r,{error:o}=await kr(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in r){const{phone:n,type:a,options:i}=r,{data:o,error:c}=await kr(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new sx("You must provide either an email or phone number and a type")}catch(t){if(pr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Jh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<U2:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const o=await Jh(this.userStorage,this.storageKey+"-user");o?.user?r.user=o.user:r.user=W2()}if(this.storage.isServer&&r.user&&!r.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};r.user=wH(r.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:r},error:null}}const{data:a,error:i}=await this._callRefreshToken(r.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(r){if(r)return await this._getUser(r);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(r){try{return r?await kr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:oh}):await this._useSession(async t=>{var n,a,i;const{data:o,error:c}=t;if(c)throw c;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Uo}:await kr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:oh})})}catch(t){if(pr(t))return ZU(t)&&(await this._removeSession(),await xi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Uo;const o=a.session;let c=null,u=null;this.flowType==="pkce"&&r.email!=null&&([c,u]=await Tp(this.storage,this.storageKey));const{data:l,error:d}=await kr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:c,code_challenge_method:u}),jwt:o.access_token,xform:oh});if(d)throw d;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Uo;const t=Date.now()/1e3;let n=t,a=!0,i=null;const{payload:o}=V2(r.access_token);if(o.exp&&(n=o.exp,a=n<=t),a){const{data:c,error:u}=await this._callRefreshToken(r.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:u}=await this._getUser(r.access_token);if(u)throw u;i={access_token:r.access_token,refresh_token:r.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(pr(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:o,error:c}=t;if(c)throw c;r=(n=o.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new Uo;const{data:a,error:i}=await this._callRefreshToken(r.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(pr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(r,t){try{if(!vi())throw new ax("No browser detected.");if(r.error||r.error_description||r.error_code)throw new ax(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new oS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ax("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new oS("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(r.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:c,expires_at:u,token_type:l}=r;if(!i||!c||!o||!l)throw new ax("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(c);let p=d+f;u&&(p=parseInt(u));const h=p-d;h*1e3<=Gp&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const y=p-f;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:g,error:m}=await this._getUser(i);if(m)throw m;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:o,token_type:l,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:r.type},error:null})}catch(n){if(pr(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(r){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),r):!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Jh(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:c}=await this.admin.signOut(o,r);if(c&&!(QU(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return r!=="others"&&(await this._removeSession(),await xi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(r){const t=oH(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,a;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",r,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",i),console.error(i)}})}async resetPasswordForEmail(r,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Tp(this.storage,this.storageKey,!0));try{return await kr(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(r){return"token"in r?this.linkIdentityIdToken(r):this.linkIdentityOAuth(r)}async linkIdentityOAuth(r){var t;try{const{data:n,error:a}=await this._useSession(async i=>{var o,c,u,l,d;const{data:f,error:p}=i;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(o=r.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=r.options)===null||c===void 0?void 0:c.scopes,queryParams:(u=r.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await kr(this.fetch,"GET",h,{headers:this.headers,jwt:(d=(l=f.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return vi()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:r.provider,url:n?.url},error:null})}catch(n){if(pr(n))return this._returnResult({data:{provider:r.provider,url:null},error:n});throw n}}async linkIdentityIdToken(r){return await this._useSession(async t=>{var n;try{const{error:a,data:{session:i}}=t;if(a)throw a;const{options:o,provider:c,token:u,access_token:l,nonce:d}=r,f=await kr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:u,access_token:l,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Jl}),{data:p,error:h}=f;return h?this._returnResult({data:{user:null,session:null},error:h}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Ep}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:h}))}catch(a){if(await xi(this.storage,`${this.storageKey}-code-verifier`),pr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,a;const{data:i,error:o}=t;if(o)throw o;return await kr(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await dH(async a=>(a>0&&await uH(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await kr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:Jl})),(a,i)=>{const o=200*Math.pow(2,a);return i&&H2(i)&&Date.now()+o-n<Gp})}catch(n){if(this._debug(t,"error",n),pr(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),vi()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Jh(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Jh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await Xp(this.userStorage,this.storageKey+"-user",o)),a.user=(r=o?.user)!==null&&r!==void 0?r:W2()}else if(a&&!a.user&&!a.user){const o=await Jh(this.storage,this.storageKey+"-user");o&&o?.user?(a.user=o.user,await xi(this.storage,this.storageKey+"-user"),await Xp(this.storage,this.storageKey,a)):a.user=W2()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<U2;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${U2}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),H2(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(a.access_token);!c&&o?.user?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new Uo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Db;const{data:i,error:o}=await this._refreshAccessToken(r);if(o)throw o;if(!i.session)throw new Uo;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),pr(i)){const o={data:null,error:i};return H2(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,t,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(r,t)}catch(u){i.push(u)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await xi(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},r),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Xp(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const i=hS(a);await Xp(this.storage,this.storageKey,i)}else{const a=hS(t);await Xp(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await xi(this.storage,this.storageKey),await xi(this.storage,this.storageKey+"-code-verifier"),await xi(this.storage,this.storageKey+"-user"),this.userStorage&&await xi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&vi()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Gp);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/Gp);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Gp}ms, refresh threshold is ${K5} ticks`),a<=K5&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof uO)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vi()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await Tp(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;return i?this._returnResult({data:null,error:i}):await kr(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,a;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:r.factorType==="totp"?{issuer:r.issuer}:{}),{data:u,error:l}=await kr(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(r.factorType==="totp"&&u.type==="totp"&&(!((a=u?.totp)===null||a===void 0)&&a.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async _verify(r){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:r.challengeId},"webauthn"in r?{webauthn:Object.assign(Object.assign({},r.webauthn),{credential_response:r.webauthn.type==="create"?qH(r.webauthn.credential_response):zH(r.webauthn.credential_response)})}:{code:r.code}),{data:c,error:u}=await kr(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:u}))})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(r){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await kr(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:r,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:BH(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:$H(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){var r;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(r=t?.factors)!==null&&r!==void 0?r:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var r,t;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=V2(n.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((t=(r=n.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const l=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:l},error:null}}async _getAuthorizationDetails(r){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?await kr(this.fetch,"GET",`${this.url}/oauth/authorizations/${r}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Uo})})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(r,t){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Uo});const o=await kr(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&vi()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(pr(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(r,t){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Uo});const o=await kr(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&vi()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(pr(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;return n?this._returnResult({data:null,error:n}):t?await kr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Uo})})}catch(r){if(pr(r))return this._returnResult({data:null,error:r});throw r}}async _revokeOAuthGrant(r){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?(await kr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:r.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Uo})})}catch(t){if(pr(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(r,t={keys:[]}){let n=t.keys.find(c=>c.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(c=>c.kid===r),n&&this.jwks_cached_at+XU>a)return n;const{data:i,error:o}=await kr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(c=>c.kid===r),!n)?null:n}async getClaims(r,t={}){try{let n=r;if(!n){const{data:h,error:y}=await this.getSession();if(y||!h.session)return this._returnResult({data:null,error:y});n=h.session.access_token}const{header:a,payload:i,signature:o,raw:{header:c,payload:u}}=V2(n);t?.allowExpired||xH(i.exp);const l=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!l){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:o},error:null}}const d=vH(a.alg),f=await crypto.subtle.importKey("jwk",l,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,o,aH(`${c}.${u}`)))throw new Y5("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(pr(n))return this._returnResult({data:null,error:n});throw n}}}hg.nextInstanceID={};const QH=hg,ZH="2.90.1";let V0="";typeof Deno<"u"?V0="deno":typeof document<"u"?V0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?V0="react-native":V0="node";const JH={"X-Client-Info":`supabase-js-${V0}/${ZH}`},eV={headers:JH},tV={schema:"public"},rV={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nV={};function fg(e){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},fg(e)}function sV(e,r){if(fg(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(fg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function aV(e){var r=sV(e,"string");return fg(r)=="symbol"?r:r+""}function iV(e,r,t){return(r=aV(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function vS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Us(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?vS(Object(t),!0).forEach(function(n){iV(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}const oV=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),lV=()=>Headers,cV=(e,r,t)=>{const n=oV(t),a=lV();return async(i,o)=>{var c;const u=(c=await r())!==null&&c!==void 0?c:e;let l=new a(o?.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),n(i,Us(Us({},o),{},{headers:l}))}};function uV(e){return e.endsWith("/")?e:e+"/"}function dV(e,r){var t,n;const{db:a,auth:i,realtime:o,global:c}=e,{db:u,auth:l,realtime:d,global:f}=r,p={db:Us(Us({},u),a),auth:Us(Us({},l),i),realtime:Us(Us({},d),o),storage:{},global:Us(Us(Us({},f),c),{},{headers:Us(Us({},(t=f?.headers)!==null&&t!==void 0?t:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function hV(e){const r=e?.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(uV(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var fV=class extends QH{constructor(e){super(e)}},pV=class{constructor(e,r,t){var n,a;this.supabaseUrl=e,this.supabaseKey=r;const i=hV(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:tV,realtime:nV,auth:Us(Us({},rV),{},{storageKey:o}),global:eV},u=dV(t??{},c);if(this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var l;this.auth=this._initSupabaseAuthClient((l=u.auth)!==null&&l!==void 0?l:{},this.headers,u.global.fetch)}this.fetch=cV(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Us({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new Kz(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new HU(this.storageUrl.href,this.headers,this.fetch,t?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new zz(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,t)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,r,t;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:t,storage:n,userStorage:a,storageKey:i,flowType:o,lock:c,debug:u,throwOnError:l},d,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new fV({url:this.authUrl.href,headers:Us(Us({},p),d),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:t,storage:n,userStorage:a,flowType:o,lock:c,debug:u,throwOnError:l,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new uU(this.realtimeUrl.href,Us(Us({},e),{},{params:Us(Us({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r?.access_token)})}_handleTokenChanged(e,r,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const mV=(e,r,t)=>new pV(e,r,t);function gV(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const r=e.version;if(r==null)return!1;const t=r.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}gV()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yV="https://dygveetaatqllhjusyzz.supabase.co",xV="sb_publishable_TmhOgRteyuVScb3v114oNw_UrZ_OKKQ",se=mV(yV,xV);async function bS(e){try{let r=null;const{data:t,error:n}=await se.from("employees").select("id, code, full_name, department_id, position_id").eq("id",e).single();if(t)r=t;else{const{data:o,error:c}=await se.from("employees").select("id, code, full_name, department_id, position_id").eq("user_id",e).single();o&&(r=o)}if(!r)return null;let a=null;if(r.department_id){const{data:o,error:c}=await se.from("departments").select("id, name, manager_id").eq("id",r.department_id).single();!c&&o&&(a=o)}let i=null;if(r.position_id){const{data:o,error:c}=await se.from("positions").select("id, name, level").eq("id",r.position_id).single();!c&&o&&(i=o)}return{id:r.id,code:r.code,full_name:r.full_name,department_id:r.department_id,position_id:r.position_id,department:a,position:i}}catch(r){return console.error("Error in getEmployeeByUserId:",r),null}}function wS(e,r){return e?.is_admin===!0||e?.role==="admin"?"admin":e?.role==="manager"||e?.is_manager===!0||e?.is_manager==="true"||r&&r.department&&r.department.manager_id===r.id||r&&r.position&&r.position.level&&r.position.level<=5?"manager":"employee"}const xn=Fz(e=>({user:null,isLoading:!0,isAuthenticated:!1,error:null,login:async r=>{e({isLoading:!0,error:null});try{const{data:t,error:n}=await se.auth.signInWithPassword({email:r.email,password:r.password});if(n)throw n;const a=await bS(t.user.id),i=wS(t.user.user_metadata,a),o={id:t.user.id,email:t.user.email||"",full_name:a?.full_name||t.user.user_metadata?.full_name,employee_id:a?.id||null,employee_code:a?.code||null,department_id:a?.department_id||null,department_name:a?.department?.name||null,position_id:a?.position_id||null,position_name:a?.position?.name||null,position_level:a?.position?.level||null,role:i,is_manager:i==="manager"||i==="admin"};return e({user:o,isAuthenticated:!0,isLoading:!1}),!0}catch(t){return e({error:t.message||"ng nhp tht bi",isLoading:!1}),!1}},register:async r=>{e({isLoading:!0,error:null});try{const{error:t}=await se.auth.signUp({email:r.email,password:r.password,options:{data:{full_name:r.full_name,phone:r.phone}}});if(t)throw t;return e({isLoading:!1}),!0}catch(t){return e({error:t.message||"ng k tht bi",isLoading:!1}),!1}},logout:async()=>{e({isLoading:!0}),await se.auth.signOut(),e({user:null,isAuthenticated:!1,isLoading:!1})},forgotPassword:async r=>{e({isLoading:!0,error:null});try{const{error:t}=await se.auth.resetPasswordForEmail(r,{redirectTo:`${window.location.origin}/reset-password`});if(t)throw t;return e({isLoading:!1}),!0}catch(t){return e({error:t.message||"Khng th gi email",isLoading:!1}),!1}},checkAuth:async()=>{e({isLoading:!0});try{const{data:{session:r}}=await se.auth.getSession();if(r?.user){const t=await bS(r.user.id),n=wS(r.user.user_metadata,t),a={id:r.user.id,email:r.user.email||"",full_name:t?.full_name||r.user.user_metadata?.full_name,employee_id:t?.id||null,employee_code:t?.code||null,department_id:t?.department_id||null,department_name:t?.department?.name||null,position_id:t?.position_id||null,position_name:t?.position?.name||null,position_level:t?.position?.level||null,role:n,is_manager:n==="manager"||n==="admin"};e({user:a,isAuthenticated:!0,isLoading:!1})}else e({user:null,isAuthenticated:!1,isLoading:!1})}catch(r){console.error("checkAuth error:",r),e({user:null,isAuthenticated:!1,isLoading:!1})}},clearError:()=>e({error:null})})),vV={async getMyPermissions(){const{data:{user:e}}=await se.auth.getUser();if(!e)return{has_access:!1,access_type:"none",can_view:!1,can_create_order:!1,can_edit_order:!1,can_delete_order:!1,can_approve_order:!1,can_add_invoice:!1,can_add_payment:!1,can_manage_suppliers:!1,can_manage_materials:!1,can_view_reports:!1,can_export_data:!1,can_view_all_orders:!1,can_grant_access:!1};const{data:r}=await se.from("employees").select("id").eq("user_id",e.id).single();return r?this.getPermissions(r.id):{has_access:!1,access_type:"none",can_view:!1,can_create_order:!1,can_edit_order:!1,can_delete_order:!1,can_approve_order:!1,can_add_invoice:!1,can_add_payment:!1,can_manage_suppliers:!1,can_manage_materials:!1,can_view_reports:!1,can_export_data:!1,can_view_all_orders:!1,can_grant_access:!1}},async getPermissions(e){try{const{data:r,error:t}=await se.rpc("get_purchase_permissions",{emp_id:e});if(t){if(t.code==="PGRST202"||t.message.includes("not find the function"))return console.warn("Function get_purchase_permissions not found, using fallback"),this.fallbackGetPermissions(e);throw t}return r}catch(r){return console.error("getPermissions error:",r),this.fallbackGetPermissions(e)}},async fallbackGetPermissions(e){const r={has_access:!1,access_type:"none",can_view:!1,can_create_order:!1,can_edit_order:!1,can_delete_order:!1,can_approve_order:!1,can_add_invoice:!1,can_add_payment:!1,can_manage_suppliers:!1,can_manage_materials:!1,can_view_reports:!1,can_export_data:!1,can_view_all_orders:!1,can_grant_access:!1};try{const{data:t,error:n}=await se.from("employees").select(`
          id,
          positions!inner(level),
          departments!inner(code)
        `).eq("id",e).single();if(n||!t)return r;const a=t.positions?.level||99,i=t.departments?.code||"";if(a<=3)return{has_access:!0,access_type:"executive",can_view:!0,can_create_order:!0,can_edit_order:!0,can_delete_order:!0,can_approve_order:!0,can_add_invoice:!0,can_add_payment:!0,can_manage_suppliers:!0,can_manage_materials:!0,can_view_reports:!0,can_export_data:!0,can_view_all_orders:!0,can_grant_access:!0};if(i==="HAP-KT")return{has_access:!0,access_type:"accounting",can_view:!0,can_create_order:!1,can_edit_order:!1,can_delete_order:!1,can_approve_order:!1,can_add_invoice:!0,can_add_payment:!0,can_manage_suppliers:!1,can_manage_materials:!1,can_view_reports:!0,can_export_data:!0,can_view_all_orders:!0,can_grant_access:!1};const{data:o}=await se.from("purchase_access").select("*").eq("employee_id",e).eq("status","active").maybeSingle();return o?{has_access:!0,access_type:"granted",can_view:o.can_view||!1,can_create_order:o.can_create_order||!1,can_edit_order:o.can_edit_order||!1,can_delete_order:o.can_delete_order||!1,can_approve_order:o.can_approve_order||!1,can_add_invoice:o.can_add_invoice||!1,can_add_payment:o.can_add_payment||!1,can_manage_suppliers:o.can_manage_suppliers||!1,can_manage_materials:o.can_manage_materials||!1,can_view_reports:o.can_view_reports||!1,can_export_data:o.can_export_data||!1,can_view_all_orders:o.can_view_all_orders||!1,can_grant_access:!1,max_order_amount:o.max_order_amount}:r}catch(t){return console.error("fallbackGetPermissions error:",t),r}},async hasAccess(e){try{if(!e){const{data:{user:n}}=await se.auth.getUser();if(!n)return!1;const{data:a}=await se.from("employees").select("id").eq("user_id",n.id).single();if(!a)return!1;e=a.id}const{data:r,error:t}=await se.rpc("has_purchase_access",{emp_id:e});if(t){if(t.code==="PGRST202"||t.message.includes("not find the function"))return console.warn("Function has_purchase_access not found, using fallback check"),e?this.fallbackHasAccess(e):!1;throw t}return r}catch(r){return console.error("hasAccess error:",r),e?this.fallbackHasAccess(e):!1}},async fallbackHasAccess(e){try{const{data:r,error:t}=await se.from("employees").select(`
          id,
          positions!inner(level),
          departments!inner(code)
        `).eq("id",e).single();if(t||!r)return!1;const n=r.positions?.level||99,a=r.departments?.code||"";if(n<=3||a==="HAP-KT")return!0;const{data:i}=await se.from("purchase_access").select("id").eq("employee_id",e).eq("status","active").maybeSingle();return!!i}catch(r){return console.error("fallbackHasAccess error:",r),!1}},async checkPermission(e,r){try{return(await this.getPermissions(e))[r]||!1}catch(t){return console.error("checkPermission error:",t),!1}},async isExecutive(e){try{const{data:r,error:t}=await se.rpc("is_executive",{emp_id:e});if(t){const{data:n}=await se.from("employees").select("positions!inner(level)").eq("id",e).single();return(n?.positions?.level||99)<=3}return r}catch(r){return console.error("isExecutive error:",r),!1}},async isAccounting(e){try{const{data:r,error:t}=await se.rpc("is_accounting",{emp_id:e});if(t){const{data:n}=await se.from("employees").select("departments!inner(code)").eq("id",e).single();return(n?.departments?.code||"")==="HAP-KT"}return r}catch(r){return console.error("isAccounting error:",r),!1}},async getAllAccess(){const{data:e,error:r}=await se.from("v_all_purchase_access").select("*").order("access_type").order("employee_name");if(r)throw r;return e||[]},async getGrantedAccess(){const{data:e,error:r}=await se.from("v_purchase_access_list").select("*").order("created_at",{ascending:!1});if(r)throw r;return e||[]},async getAccessByEmployee(e){const{data:r,error:t}=await se.from("purchase_access").select("*").eq("employee_id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async grantAccess(e){const{data:{user:r}}=await se.auth.getUser();if(!r)throw new Error("Cha ng nhp");const{data:t}=await se.from("employees").select("id").eq("user_id",r.id).single();if(!t)throw new Error("Khng tm thy thng tin nhn vin");const{data:n,error:a}=await se.rpc("grant_purchase_access",{p_employee_id:e.employee_id,p_granted_by:t.id,p_permissions:e.permissions,p_reason:e.reason||null,p_valid_until:e.valid_until||null});if(a)throw a;return n},async updateAccess(e,r,t){const{data:n,error:a}=await se.from("purchase_access").update({...r,reason:t}).eq("id",e).select().single();if(a)throw a;return n},async revokeAccess(e,r){const{data:{user:t}}=await se.auth.getUser();if(!t)throw new Error("Cha ng nhp");const{data:n}=await se.from("employees").select("id").eq("user_id",t.id).single();if(!n)throw new Error("Khng tm thy thng tin nhn vin");const{data:a,error:i}=await se.rpc("revoke_purchase_access",{p_employee_id:e,p_revoked_by:n.id,p_reason:r||null});if(i)throw i;return a},async suspendAccess(e,r){const{data:{user:t}}=await se.auth.getUser();if(!t)throw new Error("Cha ng nhp");const{data:n}=await se.from("employees").select("id").eq("user_id",t.id).single(),{data:a,error:i}=await se.from("purchase_access").update({status:"suspended",revoked_by:n?.id,revoke_reason:r}).eq("id",e).select().single();if(i)throw i;return a},async restoreAccess(e){const{data:r,error:t}=await se.from("purchase_access").update({status:"active",revoked_by:null,revoke_reason:null,revoked_at:null}).eq("id",e).select().single();if(t)throw t;return r},async getEligibleEmployees(){const{data:e,error:r}=await se.from("employees").select(`
        id,
        code,
        full_name,
        departments!inner(name),
        positions!inner(name, level)
      `).eq("status","active");if(r)throw r;const{data:t}=await se.from("v_all_purchase_access").select("employee_id"),n=new Set(t?.map(i=>i.employee_id)||[]);return(e||[]).filter(i=>!n.has(i.id)).map(i=>({id:i.id,code:i.code,full_name:i.full_name,department_name:i.departments?.name||"",position_name:i.positions?.name||""}))},async getAccessLogs(e){let r=se.from("purchase_access_logs").select("*").order("created_at",{ascending:!1});e&&(r=r.eq("employee_id",e));const{data:t,error:n}=await r;if(n)throw n;return t||[]},canCreateOrderWithAmount(e,r){return e.can_create_order?e.max_order_amount===null||e.max_order_amount===void 0?!0:r<=e.max_order_amount:!1},getPermissionLabel(e){return{can_view:"Xem module",can_create_order:"To n hng",can_edit_order:"Sa n hng",can_delete_order:"Xa n hng",can_approve_order:"Duyt n hng",can_add_invoice:"Thm ha n",can_add_payment:"Thm thanh ton",can_manage_suppliers:"Qun l NCC",can_manage_materials:"Qun l vt t",can_view_reports:"Xem bo co",can_export_data:"Xut d liu",can_view_all_orders:"Xem tt c n",can_grant_access:"Cp quyn",max_order_amount:"Hn mc n hng"}[e]||e},getAccessTypeLabel(e){return{executive:"Ban Gim c",accounting:"Phng K ton",granted:"c cp quyn",none:"Khng c quyn"}[e]||e},getAccessTypeBadgeColor(e){return{executive:"red",accounting:"blue",granted:"green",none:"gray"}[e]||"gray"}},Zd=`
  *,
  employee:employees!overtime_requests_employee_id_fkey(
    id, code, full_name, department_id,
    department:departments!employees_department_id_fkey(id, name),
    position:positions!employees_position_id_fkey(name, level)
  ),
  shift:shifts!overtime_requests_shift_id_fkey(
    id, name, code, start_time, end_time, shift_category
),
  approver:employees!overtime_requests_approved_by_fkey(
    id, full_name
  )
`,Hu={async getAll(e){const{page:r=1,pageSize:t=10,status:n,employee_id:a,department_id:i,from_date:o,to_date:c}=e,u=(r-1)*t,l=u+t-1;let d=se.from("overtime_requests").select(Zd,{count:"exact"});n&&n!=="all"&&(d=d.eq("status",n)),a&&(d=d.eq("employee_id",a)),o&&(d=d.gte("request_date",o)),c&&(d=d.lte("request_date",c));const{data:f,error:p,count:h}=await d.order("request_date",{ascending:!1}).range(u,l);if(p)throw p;let y=f||[];return i&&(y=y.filter(g=>g.employee?.department_id===i)),{data:y,total:h||0,page:r,pageSize:t,totalPages:Math.ceil((h||0)/t)}},async getMyRequests(e,r={page:1,pageSize:10}){return this.getAll({...r,employee_id:e})},async getById(e){const{data:r,error:t}=await se.from("overtime_requests").select(Zd).eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r}=await se.from("overtime_requests").select("id").eq("employee_id",e.employee_id).eq("request_date",e.request_date).maybeSingle();if(r)throw new Error(" tn ti phiu tng ca cho ngy ny");const{data:t,error:n}=await se.from("overtime_requests").insert({employee_id:e.employee_id,request_date:e.request_date,shift_id:e.shift_id||null,planned_start_time:e.planned_start_time,planned_end_time:e.planned_end_time,planned_minutes:e.planned_minutes,reason:e.reason,status:"pending"}).select(Zd).single();if(n)throw n;return t},async approve(e,r,t){const{data:n,error:a}=await se.from("overtime_requests").update({status:"approved",approved_by:r,approved_at:new Date().toISOString(),rejection_reason:t||null}).eq("id",e).eq("status","pending").select(Zd).single();if(a)throw a;return n},async reject(e,r,t){const{data:n,error:a}=await se.from("overtime_requests").update({status:"rejected",approved_by:r,approved_at:new Date().toISOString(),rejection_reason:t}).eq("id",e).eq("status","pending").select(Zd).single();if(a)throw a;return n},async cancel(e){const{error:r}=await se.from("overtime_requests").delete().eq("id",e).eq("status","pending");if(r)throw r},async getPendingByDepartment(e){const{data:r,error:t}=await se.from("overtime_requests").select(Zd).eq("status","pending").order("request_date",{ascending:!0});if(t)throw t;return(r||[]).filter(a=>a.employee?.department_id===e)},async getAllPending(){const{data:e,error:r}=await se.from("overtime_requests").select(Zd).eq("status","pending").order("request_date",{ascending:!0});if(r)throw r;return e||[]},async getPendingCount(e){const{data:r,error:t}=await se.from("overtime_requests").select("id, employee:employees!overtime_requests_employee_id_fkey(department_id)").eq("status","pending");if(t)throw t;return e?.departmentId?(r||[]).filter(n=>n.employee?.department_id===e.departmentId).length:r?.length||0},async getApprovalHistory(e){const{page:r=1,pageSize:t=10,approverId:n,departmentId:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("overtime_requests").select(Zd,{count:"exact"}).in("status",["approved","rejected"]);n&&(c=c.eq("approved_by",n));const{data:u,error:l,count:d}=await c.order("approved_at",{ascending:!1}).range(i,o);if(l)throw l;let f=u||[];return a&&(f=f.filter(p=>p.employee?.department_id===a)),{data:f,total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}}};const bV=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wV=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,t,n)=>n?n.toUpperCase():t.toLowerCase()),_S=e=>{const r=wV(e);return r.charAt(0).toUpperCase()+r.slice(1)},fO=(...e)=>e.filter((r,t,n)=>!!r&&r.trim()!==""&&n.indexOf(r)===t).join(" ").trim(),_V=e=>{for(const r in e)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};var jV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const NV=R.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...c},u)=>R.createElement("svg",{ref:u,...jV,width:r,height:r,stroke:e,strokeWidth:n?Number(t)*24/Number(r):t,className:fO("lucide",a),...!i&&!_V(c)&&{"aria-hidden":"true"},...c},[...o.map(([l,d])=>R.createElement(l,d)),...Array.isArray(i)?i:[i]]));const rt=(e,r)=>{const t=R.forwardRef(({className:n,...a},i)=>R.createElement(NV,{ref:i,iconNode:r,className:fO(`lucide-${bV(_S(e))}`,`lucide-${e}`,n),...a}));return t.displayName=_S(e),t};const kV=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],G2=rt("activity",kV);const SV=[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}]],CV=rt("alarm-clock-plus",SV);const AV=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],EV=rt("arrow-down-right",AV);const TV=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],wo=rt("arrow-left",TV);const PV=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],OV=rt("arrow-right-left",PV);const MV=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],pO=rt("arrow-up-down",MV);const IV=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Q5=rt("arrow-up-right",IV);const RV=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Mm=rt("award",RV);const LV=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],nu=rt("ban",LV);const DV=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],FV=rt("banknote",DV);const BV=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],mO=rt("bell",BV);const $V=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],gO=rt("box",$V);const qV=[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]],Mf=rt("boxes",qV);const zV=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Fb=rt("briefcase",zV);const UV=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],$r=rt("building-2",UV);const HV=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],ph=rt("building",HV);const VV=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],yO=rt("calendar-clock",VV);const WV=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],pg=rt("calendar-days",WV);const KV=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],GV=rt("calendar-plus",KV);const XV=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],dn=rt("calendar",XV);const YV=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],QV=rt("camera",YV);const ZV=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],If=rt("chart-column",ZV);const JV=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],eW=rt("chart-pie",JV);const tW=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],rW=rt("check-check",tW);const nW=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$i=rt("check",nW);const sW=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Gs=rt("chevron-down",sW);const aW=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],su=rt("chevron-left",aW);const iW=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ks=rt("chevron-right",iW);const oW=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],si=rt("chevron-up",oW);const lW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Cr=rt("circle-alert",lW);const cW=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],hn=rt("circle-check-big",cW);const uW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Un=rt("circle-check",uW);const dW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],hW=rt("circle-plus",dW);const fW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ua=rt("circle-x",fW);const pW=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],mW=rt("clipboard-check",pW);const gW=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],uh=rt("clipboard-list",gW);const yW=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xr=rt("clock",yW);const xW=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],xO=rt("cpu",xW);const vW=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],lc=rt("credit-card",vW);const bW=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Y4=rt("dollar-sign",bW);const wW=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Wg=rt("download",wW);const _W=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],vO=rt("droplet",_W);const jW=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],NW=rt("droplets",jW);const kW=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Bb=rt("ellipsis-vertical",kW);const SW=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],$b=rt("ellipsis",SW);const CW=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],qb=rt("external-link",CW);const AW=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Zx=rt("eye-off",AW);const EW=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ja=rt("eye",EW);const TW=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],PW=rt("file-chart-column-increasing",TW);const OW=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],bO=rt("file-image",OW);const MW=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],zb=rt("file-spreadsheet",MW);const IW=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],vr=rt("file-text",IW);const RW=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],mg=rt("file",RW);const LW=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Ub=rt("flag",LW);const DW=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],wO=rt("flame",DW);const FW=[["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 4 0v-6.998a2 2 0 0 0-.59-1.42L18 5",key:"1wtuz0"}],["path",{d:"M14 21V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v16",key:"e09ifn"}],["path",{d:"M2 21h13",key:"1x0fut"}],["path",{d:"M3 9h11",key:"1p7c0w"}]],_O=rt("fuel",FW);const BW=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Al=rt("funnel",BW);const $W=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],jS=rt("git-branch",$W);const qW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],zW=rt("globe",qW);const UW=[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]],jO=rt("hard-hat",UW);const HW=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],VW=rt("heart",HW);const WW=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Z5=rt("history",WW);const KW=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Kg=rt("image",KW);const GW=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Q4=rt("info",GW);const XW=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],jh=rt("layers",XW);const YW=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],NS=rt("layout-dashboard",YW);const QW=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ZW=rt("lightbulb",QW);const JW=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],eK=rt("list",JW);const tK=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Mt=rt("loader-circle",tK);const rK=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],da=rt("lock",rK);const nK=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],kS=rt("log-in",nK);const sK=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],J5=rt("log-out",sK);const aK=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gg=rt("mail",aK);const iK=[["path",{d:"M12.75 7.09a3 3 0 0 1 2.16 2.16",key:"1d4wjd"}],["path",{d:"M17.072 17.072c-1.634 2.17-3.527 3.912-4.471 4.727a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 1.432-4.568",key:"12yil7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.475 2.818A8 8 0 0 1 20 10c0 1.183-.31 2.377-.81 3.533",key:"lhrkcz"}],["path",{d:"M9.13 9.13a3 3 0 0 0 3.74 3.74",key:"13wojd"}]],SS=rt("map-pin-off",iK);const oK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],dc=rt("map-pin",oK);const lK=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],cK=rt("menu",lK);const uK=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],vv=rt("message-square",uK);const dK=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],bv=rt("monitor",dK);const hK=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],CS=rt("moon",hK);const fK=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],pK=rt("navigation",fK);const mK=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Cn=rt("package",mK);const gK=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],NO=rt("palette",gK);const yK=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],AS=rt("paperclip",yK);const xK=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],vK=rt("pause",xK);const bK=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],yg=rt("pen-line",bK);const wK=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Z4=rt("pen",wK);const _K=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],sd=rt("pencil",_K);const jK=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],_f=rt("phone",jK);const NK=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],kO=rt("play",NK);const kK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],An=rt("plus",kK);const SK=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],xg=rt("power-off",SK);const CK=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],im=rt("power",CK);const AK=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],hc=rt("receipt",AK);const EK=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Vr=rt("refresh-cw",EK);const TK=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],SO=rt("reply",TK);const PK=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],CO=rt("rotate-ccw",PK);const OK=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],MK=rt("ruler",OK);const IK=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ai=rt("save",IK);const RK=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],J4=rt("scale",RK);const LK=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],DK=rt("scroll-text",LK);const FK=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ii=rt("search",FK);const BK=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Hb=rt("send",BK);const $K=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ym=rt("settings",$K);const qK=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zK=rt("shield-check",qK);const UK=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Qc=rt("shield",UK);const HK=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],jl=rt("shopping-cart",HK);const VK=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],X2=rt("smartphone",VK);const WK=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],KK=rt("square-check-big",WK);const GK=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ad=rt("square-pen",GK);const XK=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],YK=rt("square",XK);const QK=[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]],ZK=rt("star-off",QK);const JK=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],_o=rt("star",JK);const eG=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ES=rt("sun",eG);const tG=[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],rG=rt("sunrise",tG);const nG=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],sG=rt("table",nG);const aG=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Kf=rt("tag",aG);const iG=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Vb=rt("target",iG);const oG=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],xm=rt("timer",oG);const lG=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],AO=rt("toggle-left",lG);const cG=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],EO=rt("toggle-right",cG);const uG=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],En=rt("trash-2",uG);const dG=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],hG=rt("tree-palm",dG);const fG=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],md=rt("trending-up",fG);const pG=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Kr=rt("triangle-alert",pG);const mG=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],ix=rt("trophy",mG);const gG=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Gg=rt("upload",gG);const yG=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],xG=rt("user-check",yG);const vG=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Wb=rt("user-plus",vG);const bG=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ls=rt("user",bG);const wG=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],_i=rt("users",wG);const _G=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ej=rt("wallet",_G);const jG=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],TO=rt("wrench",jG);const NG=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Br=rt("x",NG);const kG=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],PO=rt("zap",kG);const SG=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],CG=rt("zoom-in",SG),TS=(e=0,r=0)=>[{title:"TNG QUAN",icon:s.jsx(NS,{size:18}),items:[{path:"/",label:"Dashboard",icon:s.jsx(NS,{size:18})}]},{title:"QUN L NHN S",icon:s.jsx(_i,{size:18}),collapsible:!0,items:[{path:"/departments",label:"Phng ban",icon:s.jsx($r,{size:18})},{path:"/positions",label:"Chc v",icon:s.jsx(Fb,{size:18})},{path:"/employees",label:"Nhn vin",icon:s.jsx(_i,{size:18})},{path:"/contract-types",label:"Loi hp ng",icon:s.jsx(DK,{size:18})},{path:"/contracts",label:"Hp ng",icon:s.jsx(vr,{size:18})},{path:"/leave-types",label:"Loi ngh php",icon:s.jsx(hG,{size:18})},{path:"/leave-requests",label:"n ngh php",icon:s.jsx(yO,{size:18})},{path:"/salary-grades",label:"Bc lng",icon:s.jsx(ej,{size:18})},{path:"/payroll-periods",label:"K lng",icon:s.jsx(dn,{size:18})},{path:"/payslips",label:"Phiu lng",icon:s.jsx(hc,{size:18})},{path:"/performance-criteria",label:"Tiu ch nh gi",icon:s.jsx(Vb,{size:18})},{path:"/performance-reviews",label:"nh gi hiu sut",icon:s.jsx(_o,{size:18})}]},{title:"CHM CNG",icon:s.jsx(Xr,{size:18}),collapsible:!0,items:[{path:"/attendance",label:"Bng chm cng",icon:s.jsx(Xr,{size:18})},{path:"/shifts",label:"Qun l ca",icon:s.jsx(xm,{size:18}),executiveOnly:!0},{path:"/shift-assignments",label:"Phn ca",icon:s.jsx(pg,{size:18}),managerOnly:!0},{path:"/overtime",label:"Tng ca",icon:s.jsx(CV,{size:18})},{path:"/overtime/approval",label:"Duyt tng ca",icon:s.jsx(mW,{size:18}),managerOnly:!0,badge:r>0?r:void 0}]},{title:"QUN L CNG VIC",icon:s.jsx(uh,{size:18}),items:[{path:"/tasks",label:"Danh sch cng vic",icon:s.jsx(uh,{size:18})},{path:"/my-tasks",label:"Cng vic ca ti",icon:s.jsx(xG,{size:18})},{path:"/approvals",label:"Ph duyt",icon:s.jsx(KK,{size:18}),managerOnly:!0,badge:e>0?e:void 0}]},{title:"MUA HNG",icon:s.jsx(jl,{size:18}),requirePurchaseAccess:!0,items:[{path:"/purchasing/suppliers",label:"Nh cung cp",icon:s.jsx($r,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/categories",label:"Nhm vt t",icon:s.jsx(jh,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/types",label:"Loi vt t",icon:s.jsx(Kf,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/units",label:"n v tnh",icon:s.jsx(J4,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/materials",label:"Vt t",icon:s.jsx(Cn,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/variant-attributes",label:"Thuc tnh bin th",icon:s.jsx(Mf,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/orders",label:"n t hng",icon:s.jsx(jl,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/debt",label:"Cng n NCC",icon:s.jsx(Y4,{size:18}),requirePurchaseAccess:!0},{path:"/purchasing/payments",label:"Lch s thanh ton",icon:s.jsx(lc,{size:18}),requirePurchaseAccess:!0}]},{title:"BO CO",icon:s.jsx(If,{size:18}),executiveOnly:!0,items:[{path:"/reports/tasks",label:"Bo co cng vic",icon:s.jsx(PW,{size:18}),executiveOnly:!0}]},{title:"CI T",icon:s.jsx(ym,{size:18}),items:[{path:"/settings",label:"Ci t ti khon",icon:s.jsx(ls,{size:18})}]}];function AG(){const{user:e,logout:r}=xn(),t=jo(),[n,a]=R.useState(!1),[i,o]=R.useState({"QUN L NHN S":!0,"CHM CNG":!1}),[c,u]=R.useState(!1),[l,d]=R.useState(!0),[f,p]=R.useState(0),h=e?.role==="admin"||e?.role==="manager"||e?.is_manager,y=e?.role==="admin",m=(e?.position_level||7)<=5;R.useEffect(()=>{const B=async()=>{if(!(!e?.employee_id||!h&&!y))try{const T=await Hu.getPendingCount(m||y?void 0:{departmentId:e.department_id||void 0});p(T)}catch(T){console.error("Failed to load pending OT count:",T),p(0)}};if(e?.employee_id&&(h||y)){B();const T=setInterval(B,12e4);return()=>clearInterval(T)}},[e?.employee_id,h,y]),R.useEffect(()=>{e&&(async()=>{try{if(d(!0),y||m){u(!0),d(!1);return}try{const T=await vV.hasAccess();u(T)}catch(T){console.warn("Purchase access check failed:",T),u(!1)}}catch(T){console.error("Check purchase access error:",T),u(!1)}finally{d(!1)}})()},[e,y,m]),R.useEffect(()=>{const B=TS();for(const T of B)T.collapsible&&T.items.some(U=>t.pathname===U.path||t.pathname.startsWith(U.path+"/"))&&o(U=>({...U,[T.title]:!1}))},[t.pathname]);const x=TS(0,f),v=B=>{o(T=>({...T,[B]:!T[B]}))},w=B=>!(B.managerOnly&&!h&&!y||B.executiveOnly&&!m&&!y||B.requirePurchaseAccess&&!c&&!y),_=B=>!(B.executiveOnly&&!m&&!y||B.requirePurchaseAccess&&!c&&!y),A=B=>w(B)?s.jsx("li",{children:s.jsxs(M5,{to:B.path,end:!0,onClick:()=>a(!1),className:({isActive:T})=>`flex items-center justify-between gap-3 px-3 py-2.5 rounded-lg text-sm transition-all ${T?"bg-blue-600 text-white shadow-md":"text-gray-300 hover:bg-gray-700/50 hover:text-white"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"opacity-80",children:B.icon}),s.jsx("span",{children:B.label})]}),B.badge&&B.badge>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-red-500 text-white rounded-full",children:B.badge})]})},B.path):null,P=s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-4 border-b border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-white",children:"Huy Anh ERP"}),s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:"Qun l Doanh nghip"})]}),s.jsx("button",{onClick:()=>a(!1),className:"lg:hidden p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg",children:s.jsx(Br,{size:20})})]})}),s.jsx("div",{className:"p-4 border-b border-gray-700",children:s.jsxs(M5,{to:"/settings",onClick:()=>a(!1),className:"flex items-center gap-3 group",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-lg font-bold text-white shadow-lg group-hover:from-blue-400 group-hover:to-blue-500 transition-all",children:e?.full_name?.charAt(0)||e?.email?.charAt(0)||"?"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-white truncate group-hover:text-blue-300 transition-colors",children:e?.full_name||e?.email}),s.jsx("p",{className:"text-xs text-gray-400 truncate",children:e?.position_name||(e?.role==="admin"?"Qun tr vin":h?"Qun l":"Nhn vin")})]}),s.jsx(ym,{size:16,className:"text-gray-500 group-hover:text-blue-400 transition-colors"})]})}),s.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-2",children:x.map(B=>{if(!_(B))return null;const T=B.items.filter(w);if(T.length===0)return null;const I=B.collapsible&&i[B.title];return s.jsxs("div",{className:"mb-2",children:[B.collapsible?s.jsxs("button",{onClick:()=>v(B.title),className:"w-full flex items-center justify-between px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider hover:text-gray-300 transition-colors",children:[s.jsx("span",{children:B.title}),I?s.jsx(Ks,{size:14}):s.jsx(Gs,{size:14})]}):s.jsx("p",{className:"px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:B.title}),!I&&s.jsx("ul",{className:"space-y-1",children:T.map(A)})]},B.title)})}),s.jsx("div",{className:"p-4 border-t border-gray-700",children:s.jsxs("button",{onClick:()=>{r(),a(!1)},className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 text-sm text-gray-300 hover:bg-red-600/20 hover:text-red-400 rounded-lg transition-colors",children:[s.jsx(J5,{size:18}),s.jsx("span",{children:"ng xut"})]})})]});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-40 bg-gray-800 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>a(!0),className:"p-2 text-gray-300 hover:text-white hover:bg-gray-700 rounded-lg",children:s.jsx(cK,{size:24})}),s.jsx("h1",{className:"text-lg font-bold text-white",children:"Huy Anh ERP"}),s.jsx("div",{className:"w-10"})]}),n&&s.jsx("div",{className:"lg:hidden fixed inset-0 z-40 bg-black/50",onClick:()=>a(!1)}),s.jsx("aside",{className:"hidden lg:flex w-64 bg-gray-800 text-white flex-col min-h-screen fixed left-0 top-0 bottom-0 z-30",children:P}),s.jsx("aside",{className:`lg:hidden fixed top-0 left-0 bottom-0 w-72 bg-gray-800 text-white flex flex-col z-50 transform transition-transform duration-300 ease-in-out ${n?"translate-x-0":"-translate-x-full"}`,children:P}),s.jsx("div",{className:"hidden lg:block w-64 flex-shrink-0"}),s.jsx("div",{className:"lg:hidden h-14"})]})}function EG(){return s.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[s.jsx(AG,{}),s.jsx("main",{className:"flex-1 overflow-auto",children:s.jsx(yq,{})})]})}function OO(e){var r,t,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(r=0;r<a;r++)e[r]&&(t=OO(e[r]))&&(n&&(n+=" "),n+=t)}else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function yn(){for(var e,r,t=0,n="",a=arguments.length;t<a;t++)(e=arguments[t])&&(r=OO(e))&&(n&&(n+=" "),n+=r);return n}const TG=(e,r)=>{const t=new Array(e.length+r.length);for(let n=0;n<e.length;n++)t[n]=e[n];for(let n=0;n<r.length;n++)t[e.length+n]=r[n];return t},PG=(e,r)=>({classGroupId:e,validator:r}),MO=(e=new Map,r=null,t)=>({nextPart:e,validators:r,classGroupId:t}),wv="-",PS=[],OG="arbitrary..",MG=e=>{const r=RG(e),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{if(o.startsWith("[")&&o.endsWith("]"))return IG(o);const c=o.split(wv),u=c[0]===""&&c.length>1?1:0;return IO(c,u,r)},getConflictingClassGroupIds:(o,c)=>{if(c){const u=n[o],l=t[o];return u?l?TG(l,u):u:l||PS}return t[o]||PS}}},IO=(e,r,t)=>{if(e.length-r===0)return t.classGroupId;const a=e[r],i=t.nextPart.get(a);if(i){const l=IO(e,r+1,i);if(l)return l}const o=t.validators;if(o===null)return;const c=r===0?e.join(wv):e.slice(r).join(wv),u=o.length;for(let l=0;l<u;l++){const d=o[l];if(d.validator(c))return d.classGroupId}},IG=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const r=e.slice(1,-1),t=r.indexOf(":"),n=r.slice(0,t);return n?OG+n:void 0})(),RG=e=>{const{theme:r,classGroups:t}=e;return LG(t,r)},LG=(e,r)=>{const t=MO();for(const n in e){const a=e[n];e3(a,t,n,r)}return t},e3=(e,r,t,n)=>{const a=e.length;for(let i=0;i<a;i++){const o=e[i];DG(o,r,t,n)}},DG=(e,r,t,n)=>{if(typeof e=="string"){FG(e,r,t);return}if(typeof e=="function"){BG(e,r,t,n);return}$G(e,r,t,n)},FG=(e,r,t)=>{const n=e===""?r:RO(r,e);n.classGroupId=t},BG=(e,r,t,n)=>{if(qG(e)){e3(e(n),r,t,n);return}r.validators===null&&(r.validators=[]),r.validators.push(PG(t,e))},$G=(e,r,t,n)=>{const a=Object.entries(e),i=a.length;for(let o=0;o<i;o++){const[c,u]=a[o];e3(u,RO(r,c),t,n)}},RO=(e,r)=>{let t=e;const n=r.split(wv),a=n.length;for(let i=0;i<a;i++){const o=n[i];let c=t.nextPart.get(o);c||(c=MO(),t.nextPart.set(o,c)),t=c}return t},qG=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,zG=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,t=Object.create(null),n=Object.create(null);const a=(i,o)=>{t[i]=o,r++,r>e&&(r=0,n=t,t=Object.create(null))};return{get(i){let o=t[i];if(o!==void 0)return o;if((o=n[i])!==void 0)return a(i,o),o},set(i,o){i in t?t[i]=o:a(i,o)}}},tj="!",OS=":",UG=[],MS=(e,r,t,n,a)=>({modifiers:e,hasImportantModifier:r,baseClassName:t,maybePostfixModifierPosition:n,isExternal:a}),HG=e=>{const{prefix:r,experimentalParseClassName:t}=e;let n=a=>{const i=[];let o=0,c=0,u=0,l;const d=a.length;for(let g=0;g<d;g++){const m=a[g];if(o===0&&c===0){if(m===OS){i.push(a.slice(u,g)),u=g+1;continue}if(m==="/"){l=g;continue}}m==="["?o++:m==="]"?o--:m==="("?c++:m===")"&&c--}const f=i.length===0?a:a.slice(u);let p=f,h=!1;f.endsWith(tj)?(p=f.slice(0,-1),h=!0):f.startsWith(tj)&&(p=f.slice(1),h=!0);const y=l&&l>u?l-u:void 0;return MS(i,h,p,y)};if(r){const a=r+OS,i=n;n=o=>o.startsWith(a)?i(o.slice(a.length)):MS(UG,!1,o,void 0,!0)}if(t){const a=n;n=i=>t({className:i,parseClassName:a})}return n},VG=e=>{const r=new Map;return e.orderSensitiveModifiers.forEach((t,n)=>{r.set(t,1e6+n)}),t=>{const n=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i],c=o[0]==="[",u=r.has(o);c||u?(a.length>0&&(a.sort(),n.push(...a),a=[]),n.push(o)):a.push(o)}return a.length>0&&(a.sort(),n.push(...a)),n}},WG=e=>({cache:zG(e.cacheSize),parseClassName:HG(e),sortModifiers:VG(e),...MG(e)}),KG=/\s+/,GG=(e,r)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:i}=r,o=[],c=e.trim().split(KG);let u="";for(let l=c.length-1;l>=0;l-=1){const d=c[l],{isExternal:f,modifiers:p,hasImportantModifier:h,baseClassName:y,maybePostfixModifierPosition:g}=t(d);if(f){u=d+(u.length>0?" "+u:u);continue}let m=!!g,x=n(m?y.substring(0,g):y);if(!x){if(!m){u=d+(u.length>0?" "+u:u);continue}if(x=n(y),!x){u=d+(u.length>0?" "+u:u);continue}m=!1}const v=p.length===0?"":p.length===1?p[0]:i(p).join(":"),w=h?v+tj:v,_=w+x;if(o.indexOf(_)>-1)continue;o.push(_);const A=a(x,m);for(let P=0;P<A.length;++P){const B=A[P];o.push(w+B)}u=d+(u.length>0?" "+u:u)}return u},XG=(...e)=>{let r=0,t,n,a="";for(;r<e.length;)(t=e[r++])&&(n=LO(t))&&(a&&(a+=" "),a+=n);return a},LO=e=>{if(typeof e=="string")return e;let r,t="";for(let n=0;n<e.length;n++)e[n]&&(r=LO(e[n]))&&(t&&(t+=" "),t+=r);return t},YG=(e,...r)=>{let t,n,a,i;const o=u=>{const l=r.reduce((d,f)=>f(d),e());return t=WG(l),n=t.cache.get,a=t.cache.set,i=c,c(u)},c=u=>{const l=n(u);if(l)return l;const d=GG(u,t);return a(u,d),d};return i=o,(...u)=>i(XG(...u))},QG=[],Ra=e=>{const r=t=>t[e]||QG;return r.isThemeGetter=!0,r},DO=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,FO=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ZG=/^\d+\/\d+$/,JG=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,eX=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,tX=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,rX=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,nX=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ip=e=>ZG.test(e),Zr=e=>!!e&&!Number.isNaN(Number(e)),Jd=e=>!!e&&Number.isInteger(Number(e)),Y2=e=>e.endsWith("%")&&Zr(e.slice(0,-1)),Ou=e=>JG.test(e),sX=()=>!0,aX=e=>eX.test(e)&&!tX.test(e),BO=()=>!1,iX=e=>rX.test(e),oX=e=>nX.test(e),lX=e=>!er(e)&&!tr(e),cX=e=>Im(e,zO,BO),er=e=>DO.test(e),ef=e=>Im(e,UO,aX),Q2=e=>Im(e,pX,Zr),IS=e=>Im(e,$O,BO),uX=e=>Im(e,qO,oX),ox=e=>Im(e,HO,iX),tr=e=>FO.test(e),w0=e=>Rm(e,UO),dX=e=>Rm(e,mX),RS=e=>Rm(e,$O),hX=e=>Rm(e,zO),fX=e=>Rm(e,qO),lx=e=>Rm(e,HO,!0),Im=(e,r,t)=>{const n=DO.exec(e);return n?n[1]?r(n[1]):t(n[2]):!1},Rm=(e,r,t=!1)=>{const n=FO.exec(e);return n?n[1]?r(n[1]):t:!1},$O=e=>e==="position"||e==="percentage",qO=e=>e==="image"||e==="url",zO=e=>e==="length"||e==="size"||e==="bg-size",UO=e=>e==="length",pX=e=>e==="number",mX=e=>e==="family-name",HO=e=>e==="shadow",gX=()=>{const e=Ra("color"),r=Ra("font"),t=Ra("text"),n=Ra("font-weight"),a=Ra("tracking"),i=Ra("leading"),o=Ra("breakpoint"),c=Ra("container"),u=Ra("spacing"),l=Ra("radius"),d=Ra("shadow"),f=Ra("inset-shadow"),p=Ra("text-shadow"),h=Ra("drop-shadow"),y=Ra("blur"),g=Ra("perspective"),m=Ra("aspect"),x=Ra("ease"),v=Ra("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],A=()=>[..._(),tr,er],P=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto","contain","none"],T=()=>[tr,er,u],I=()=>[Ip,"full","auto",...T()],U=()=>[Jd,"none","subgrid",tr,er],H=()=>["auto",{span:["full",Jd,tr,er]},Jd,tr,er],z=()=>[Jd,"auto",tr,er],O=()=>["auto","min","max","fr",tr,er],L=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],E=()=>["start","end","center","stretch","center-safe","end-safe"],k=()=>["auto",...T()],N=()=>[Ip,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...T()],S=()=>[e,tr,er],C=()=>[..._(),RS,IS,{position:[tr,er]}],D=()=>["no-repeat",{repeat:["","x","y","space","round"]}],q=()=>["auto","cover","contain",hX,cX,{size:[tr,er]}],M=()=>[Y2,w0,ef],G=()=>["","none","full",l,tr,er],X=()=>["",Zr,w0,ef],re=()=>["solid","dashed","dotted","double"],V=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>[Zr,Y2,RS,IS],W=()=>["","none",y,tr,er],F=()=>["none",Zr,tr,er],Q=()=>["none",Zr,tr,er],ne=()=>[Zr,tr,er],ie=()=>[Ip,"full",...T()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ou],breakpoint:[Ou],color:[sX],container:[Ou],"drop-shadow":[Ou],ease:["in","out","in-out"],font:[lX],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ou],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ou],shadow:[Ou],spacing:["px",Zr],text:[Ou],"text-shadow":[Ou],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ip,er,tr,m]}],container:["container"],columns:[{columns:[Zr,er,tr,c]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:A()}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Jd,"auto",tr,er]}],basis:[{basis:[Ip,"full","auto",c,...T()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Zr,Ip,"auto","initial","none",er]}],grow:[{grow:["",Zr,tr,er]}],shrink:[{shrink:["",Zr,tr,er]}],order:[{order:[Jd,"first","last","none",tr,er]}],"grid-cols":[{"grid-cols":U()}],"col-start-end":[{col:H()}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":U()}],"row-start-end":[{row:H()}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":O()}],"auto-rows":[{"auto-rows":O()}],gap:[{gap:T()}],"gap-x":[{"gap-x":T()}],"gap-y":[{"gap-y":T()}],"justify-content":[{justify:[...L(),"normal"]}],"justify-items":[{"justify-items":[...E(),"normal"]}],"justify-self":[{"justify-self":["auto",...E()]}],"align-content":[{content:["normal",...L()]}],"align-items":[{items:[...E(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...E(),{baseline:["","last"]}]}],"place-content":[{"place-content":L()}],"place-items":[{"place-items":[...E(),"baseline"]}],"place-self":[{"place-self":["auto",...E()]}],p:[{p:T()}],px:[{px:T()}],py:[{py:T()}],ps:[{ps:T()}],pe:[{pe:T()}],pt:[{pt:T()}],pr:[{pr:T()}],pb:[{pb:T()}],pl:[{pl:T()}],m:[{m:k()}],mx:[{mx:k()}],my:[{my:k()}],ms:[{ms:k()}],me:[{me:k()}],mt:[{mt:k()}],mr:[{mr:k()}],mb:[{mb:k()}],ml:[{ml:k()}],"space-x":[{"space-x":T()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":T()}],"space-y-reverse":["space-y-reverse"],size:[{size:N()}],w:[{w:[c,"screen",...N()]}],"min-w":[{"min-w":[c,"screen","none",...N()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...N()]}],h:[{h:["screen","lh",...N()]}],"min-h":[{"min-h":["screen","lh","none",...N()]}],"max-h":[{"max-h":["screen","lh",...N()]}],"font-size":[{text:["base",t,w0,ef]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,tr,Q2]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Y2,er]}],"font-family":[{font:[dX,er,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,tr,er]}],"line-clamp":[{"line-clamp":[Zr,"none",tr,Q2]}],leading:[{leading:[i,...T()]}],"list-image":[{"list-image":["none",tr,er]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",tr,er]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:S()}],"text-color":[{text:S()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...re(),"wavy"]}],"text-decoration-thickness":[{decoration:[Zr,"from-font","auto",tr,ef]}],"text-decoration-color":[{decoration:S()}],"underline-offset":[{"underline-offset":[Zr,"auto",tr,er]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",tr,er]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",tr,er]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:C()}],"bg-repeat":[{bg:D()}],"bg-size":[{bg:q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Jd,tr,er],radial:["",tr,er],conic:[Jd,tr,er]},fX,uX]}],"bg-color":[{bg:S()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:S()}],"gradient-via":[{via:S()}],"gradient-to":[{to:S()}],rounded:[{rounded:G()}],"rounded-s":[{"rounded-s":G()}],"rounded-e":[{"rounded-e":G()}],"rounded-t":[{"rounded-t":G()}],"rounded-r":[{"rounded-r":G()}],"rounded-b":[{"rounded-b":G()}],"rounded-l":[{"rounded-l":G()}],"rounded-ss":[{"rounded-ss":G()}],"rounded-se":[{"rounded-se":G()}],"rounded-ee":[{"rounded-ee":G()}],"rounded-es":[{"rounded-es":G()}],"rounded-tl":[{"rounded-tl":G()}],"rounded-tr":[{"rounded-tr":G()}],"rounded-br":[{"rounded-br":G()}],"rounded-bl":[{"rounded-bl":G()}],"border-w":[{border:X()}],"border-w-x":[{"border-x":X()}],"border-w-y":[{"border-y":X()}],"border-w-s":[{"border-s":X()}],"border-w-e":[{"border-e":X()}],"border-w-t":[{"border-t":X()}],"border-w-r":[{"border-r":X()}],"border-w-b":[{"border-b":X()}],"border-w-l":[{"border-l":X()}],"divide-x":[{"divide-x":X()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":X()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...re(),"hidden","none"]}],"divide-style":[{divide:[...re(),"hidden","none"]}],"border-color":[{border:S()}],"border-color-x":[{"border-x":S()}],"border-color-y":[{"border-y":S()}],"border-color-s":[{"border-s":S()}],"border-color-e":[{"border-e":S()}],"border-color-t":[{"border-t":S()}],"border-color-r":[{"border-r":S()}],"border-color-b":[{"border-b":S()}],"border-color-l":[{"border-l":S()}],"divide-color":[{divide:S()}],"outline-style":[{outline:[...re(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Zr,tr,er]}],"outline-w":[{outline:["",Zr,w0,ef]}],"outline-color":[{outline:S()}],shadow:[{shadow:["","none",d,lx,ox]}],"shadow-color":[{shadow:S()}],"inset-shadow":[{"inset-shadow":["none",f,lx,ox]}],"inset-shadow-color":[{"inset-shadow":S()}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:S()}],"ring-offset-w":[{"ring-offset":[Zr,ef]}],"ring-offset-color":[{"ring-offset":S()}],"inset-ring-w":[{"inset-ring":X()}],"inset-ring-color":[{"inset-ring":S()}],"text-shadow":[{"text-shadow":["none",p,lx,ox]}],"text-shadow-color":[{"text-shadow":S()}],opacity:[{opacity:[Zr,tr,er]}],"mix-blend":[{"mix-blend":[...V(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":V()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Zr]}],"mask-image-linear-from-pos":[{"mask-linear-from":J()}],"mask-image-linear-to-pos":[{"mask-linear-to":J()}],"mask-image-linear-from-color":[{"mask-linear-from":S()}],"mask-image-linear-to-color":[{"mask-linear-to":S()}],"mask-image-t-from-pos":[{"mask-t-from":J()}],"mask-image-t-to-pos":[{"mask-t-to":J()}],"mask-image-t-from-color":[{"mask-t-from":S()}],"mask-image-t-to-color":[{"mask-t-to":S()}],"mask-image-r-from-pos":[{"mask-r-from":J()}],"mask-image-r-to-pos":[{"mask-r-to":J()}],"mask-image-r-from-color":[{"mask-r-from":S()}],"mask-image-r-to-color":[{"mask-r-to":S()}],"mask-image-b-from-pos":[{"mask-b-from":J()}],"mask-image-b-to-pos":[{"mask-b-to":J()}],"mask-image-b-from-color":[{"mask-b-from":S()}],"mask-image-b-to-color":[{"mask-b-to":S()}],"mask-image-l-from-pos":[{"mask-l-from":J()}],"mask-image-l-to-pos":[{"mask-l-to":J()}],"mask-image-l-from-color":[{"mask-l-from":S()}],"mask-image-l-to-color":[{"mask-l-to":S()}],"mask-image-x-from-pos":[{"mask-x-from":J()}],"mask-image-x-to-pos":[{"mask-x-to":J()}],"mask-image-x-from-color":[{"mask-x-from":S()}],"mask-image-x-to-color":[{"mask-x-to":S()}],"mask-image-y-from-pos":[{"mask-y-from":J()}],"mask-image-y-to-pos":[{"mask-y-to":J()}],"mask-image-y-from-color":[{"mask-y-from":S()}],"mask-image-y-to-color":[{"mask-y-to":S()}],"mask-image-radial":[{"mask-radial":[tr,er]}],"mask-image-radial-from-pos":[{"mask-radial-from":J()}],"mask-image-radial-to-pos":[{"mask-radial-to":J()}],"mask-image-radial-from-color":[{"mask-radial-from":S()}],"mask-image-radial-to-color":[{"mask-radial-to":S()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[Zr]}],"mask-image-conic-from-pos":[{"mask-conic-from":J()}],"mask-image-conic-to-pos":[{"mask-conic-to":J()}],"mask-image-conic-from-color":[{"mask-conic-from":S()}],"mask-image-conic-to-color":[{"mask-conic-to":S()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:C()}],"mask-repeat":[{mask:D()}],"mask-size":[{mask:q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",tr,er]}],filter:[{filter:["","none",tr,er]}],blur:[{blur:W()}],brightness:[{brightness:[Zr,tr,er]}],contrast:[{contrast:[Zr,tr,er]}],"drop-shadow":[{"drop-shadow":["","none",h,lx,ox]}],"drop-shadow-color":[{"drop-shadow":S()}],grayscale:[{grayscale:["",Zr,tr,er]}],"hue-rotate":[{"hue-rotate":[Zr,tr,er]}],invert:[{invert:["",Zr,tr,er]}],saturate:[{saturate:[Zr,tr,er]}],sepia:[{sepia:["",Zr,tr,er]}],"backdrop-filter":[{"backdrop-filter":["","none",tr,er]}],"backdrop-blur":[{"backdrop-blur":W()}],"backdrop-brightness":[{"backdrop-brightness":[Zr,tr,er]}],"backdrop-contrast":[{"backdrop-contrast":[Zr,tr,er]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Zr,tr,er]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Zr,tr,er]}],"backdrop-invert":[{"backdrop-invert":["",Zr,tr,er]}],"backdrop-opacity":[{"backdrop-opacity":[Zr,tr,er]}],"backdrop-saturate":[{"backdrop-saturate":[Zr,tr,er]}],"backdrop-sepia":[{"backdrop-sepia":["",Zr,tr,er]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":T()}],"border-spacing-x":[{"border-spacing-x":T()}],"border-spacing-y":[{"border-spacing-y":T()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",tr,er]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Zr,"initial",tr,er]}],ease:[{ease:["linear","initial",x,tr,er]}],delay:[{delay:[Zr,tr,er]}],animate:[{animate:["none",v,tr,er]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,tr,er]}],"perspective-origin":[{"perspective-origin":A()}],rotate:[{rotate:F()}],"rotate-x":[{"rotate-x":F()}],"rotate-y":[{"rotate-y":F()}],"rotate-z":[{"rotate-z":F()}],scale:[{scale:Q()}],"scale-x":[{"scale-x":Q()}],"scale-y":[{"scale-y":Q()}],"scale-z":[{"scale-z":Q()}],"scale-3d":["scale-3d"],skew:[{skew:ne()}],"skew-x":[{"skew-x":ne()}],"skew-y":[{"skew-y":ne()}],transform:[{transform:[tr,er,"","none","gpu","cpu"]}],"transform-origin":[{origin:A()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ie()}],"translate-x":[{"translate-x":ie()}],"translate-y":[{"translate-y":ie()}],"translate-z":[{"translate-z":ie()}],"translate-none":["translate-none"],accent:[{accent:S()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:S()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",tr,er]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",tr,er]}],fill:[{fill:["none",...S()]}],"stroke-w":[{stroke:[Zr,w0,ef,Q2]}],stroke:[{stroke:["none",...S()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},yX=YG(gX);function Lm(...e){return yX(yn(e))}const Lt=R.forwardRef(({className:e,variant:r="primary",size:t="md",isLoading:n,children:a,disabled:i,...o},c)=>{const u={primary:"bg-primary text-white hover:bg-secondary",secondary:"bg-gray-600 text-white hover:bg-gray-700",danger:"bg-danger text-white hover:bg-red-700",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white",ghost:"text-gray-600 hover:bg-gray-100"},l={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"};return s.jsx("button",{ref:c,className:Lm("inline-flex items-center justify-center rounded-lg font-medium","transition-colors duration-200","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",u[r],l[t],e),disabled:i||n,...o,children:n?s.jsxs(s.Fragment,{children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"ang x l..."]}):a})});Lt.displayName="Button";const Dt=R.forwardRef(({className:e,label:r,error:t,type:n="text",...a},i)=>s.jsxs("div",{className:"w-full",children:[r&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r}),s.jsx("input",{ref:i,type:n,className:Lm("w-full px-4 py-2 border rounded-lg","focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent","transition-colors duration-200",t?"border-danger":"border-gray-300",e),...a}),t&&s.jsx("p",{className:"mt-1 text-sm text-danger",children:t})]}));Dt.displayName="Input";const Kn=R.forwardRef(({className:e,label:r,error:t,options:n,placeholder:a,...i},o)=>s.jsxs("div",{className:"w-full",children:[r&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r}),s.jsxs("select",{ref:o,className:Lm("w-full px-4 py-2 border rounded-lg","focus:outline-none focus:ring-2 focus:ring-primary","transition-colors duration-200",t?"border-danger":"border-gray-300",e),...i,children:[a&&s.jsx("option",{value:"",children:a}),n.map(c=>s.jsx("option",{value:c.value,children:c.label},c.value))]}),t&&s.jsx("p",{className:"mt-1 text-sm text-danger",children:t})]}));Kn.displayName="Select";const is=R.forwardRef(({className:e,children:r,...t},n)=>s.jsx("div",{ref:n,className:Lm("bg-white rounded-lg shadow-lg p-6",e),...t,children:r}));is.displayName="Card";function xX({size:e="md",text:r="ang ti..."}){const t={sm:"h-6 w-6",md:"h-10 w-10",lg:"h-16 w-16"};return s.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[s.jsxs("svg",{className:`animate-spin text-primary ${t[e]}`,fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),r&&s.jsx("p",{className:"mt-4 text-gray-600",children:r})]})}function ji({isOpen:e,onClose:r,title:t,children:n,size:a="md"}){if(R.useEffect(()=>{const o=c=>{c.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}},[e,r]),!e)return null;const i={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:r}),s.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:s.jsxs("div",{className:Lm("relative bg-white rounded-lg shadow-xl w-full","transform transition-all",i[a]),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition",children:s.jsx("span",{className:"text-2xl",children:""})})]}),s.jsx("div",{className:"p-4",children:n})]})})]})}function Gf({columns:e,data:r,isLoading:t,emptyMessage:n="Khng c d liu",onRowClick:a}){return t?s.jsx(xX,{text:"ang ti d liu..."}):r.length===0?s.jsx("div",{className:"text-center py-12 text-gray-500",children:n}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsx("tr",{children:e.map(i=>s.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium \r
                  text-gray-500 uppercase tracking-wider`,children:i.title},String(i.key)))})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(i=>s.jsx("tr",{onClick:()=>a?.(i),className:a?"cursor-pointer hover:bg-gray-50":"",children:e.map(o=>s.jsx("td",{className:`px-6 py-4 whitespace-nowrap ${o.className||""}`,children:o.render?o.render(i):String(i[o.key]??"-")},String(o.key)))},i.id))})]})})}function El({currentPage:e,totalPages:r,onPageChange:t}){if(r<=1)return null;const n=[];for(let a=1;a<=r;a++)n.push(a);return s.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[s.jsx("button",{onClick:()=>t(e-1),disabled:e===1,className:`px-3 py-1 border rounded-lg disabled:opacity-50 \r
          disabled:cursor-not-allowed hover:bg-gray-100`,children:""}),n.map(a=>s.jsx("button",{onClick:()=>t(a),className:`px-3 py-1 border rounded-lg ${a===e?"bg-primary text-white":"hover:bg-gray-100"}`,children:a},a)),s.jsx("button",{onClick:()=>t(e+1),disabled:e===r,className:`px-3 py-1 border rounded-lg disabled:opacity-50 \r
          disabled:cursor-not-allowed hover:bg-gray-100`,children:""})]})}function mc({isOpen:e,onClose:r,onConfirm:t,title:n,message:a,confirmText:i="Xc nhn",cancelText:o="Hy",isLoading:c=!1,variant:u="danger"}){return s.jsx(ji,{isOpen:e,onClose:r,title:n,size:"sm",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:a}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx(Lt,{variant:"outline",onClick:r,disabled:c,children:o}),s.jsx(Lt,{variant:u,onClick:t,isLoading:c,children:i})]})]})})}const vX=R.forwardRef(({label:e,error:r,className:t,...n},a)=>s.jsxs("div",{className:"w-full",children:[e&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),s.jsx("input",{ref:a,type:"datetime-local",className:Lm("w-full px-3 py-2 border rounded-lg shadow-sm","focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",r?"border-red-500":"border-gray-300",t),...n}),r&&s.jsx("p",{className:"mt-1 text-sm text-red-500",children:r})]}));vX.displayName="DatePicker";function bX(){const e=ts(),{login:r,isLoading:t,error:n,clearError:a,isAuthenticated:i}=xn(),[o,c]=R.useState(""),[u,l]=R.useState(""),[d,f]=R.useState(!1),[p,h]=R.useState(!1);R.useEffect(()=>{a()},[a]),R.useEffect(()=>{i&&e("/",{replace:!0})},[i,e]);const y=async g=>{g.preventDefault(),a(),await r({email:o,password:u})};return s.jsxs("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:[s.jsxs(is,{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("h1",{className:"text-2xl font-bold text-primary flex items-center justify-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{className:"text-[#2d7a9c]",children:"Huy Anh ERP"})]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"ng nhp vo h thng"})]}),s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",placeholder:"email@company.com",value:o,onChange:g=>c(g.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),s.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",placeholder:"",value:u,onChange:g=>l(g.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:n})}),s.jsx("div",{className:"text-right",children:s.jsx("button",{type:"button",onClick:()=>f(!0),className:"text-sm text-[#2d7a9c] hover:underline",children:"Qun mt khu?"})}),s.jsx(Lt,{type:"submit",className:"w-full bg-[#2d7a9c] hover:bg-[#246a89] text-white py-2 rounded-lg font-medium transition-colors",disabled:t,children:t?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"ang ng nhp..."]}):"ng nhp"})]}),s.jsxs("p",{className:"text-center mt-6 text-gray-600",children:["Cha c ti khon?"," ",s.jsx("button",{type:"button",onClick:()=>h(!0),className:"text-[#2d7a9c] hover:underline font-medium",children:"ng k ngay"})]})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("h2",{className:"text-lg font-semibold",children:"Qun mt khu?"})]}),s.jsxs("div",{className:"text-gray-600 space-y-3",children:[s.jsx("p",{children:"Vui lng lin h b phn IT  c h tr t li mt khu:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[s.jsxs("li",{children:[" Email: ",s.jsx("span",{className:"font-medium",children:"it@huyanhrubber.com"})]}),s.jsxs("li",{children:[" Ni b: ",s.jsx("span",{className:"font-medium",children:"100"})]}),s.jsx("li",{children:" Zalo IT Support"})]}),s.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Lu : Cung cp h tn, m nhn vin v email  c x l nhanh chng."})]}),s.jsx("div",{className:"mt-6 flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:" hiu"})})]})}),p&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("span",{className:"text-2xl",children:""}),s.jsx("h2",{className:"text-lg font-semibold",children:"ng k ti khon"})]}),s.jsxs("div",{className:"text-gray-600 space-y-3",children:[s.jsxs("p",{children:["H thng ",s.jsx("strong",{children:"Huy Anh ERP"})," ch dnh cho nhn vin cng ty. Ti khon s c to bi b phn Nhn s khi bn chnh thc nhn vic."]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-sm",children:[s.jsx("p",{className:"font-medium text-blue-800 mb-1",children:"Nhn vin mi:"}),s.jsx("p",{className:"text-blue-700",children:"Vui lng lin h phng Hnh chnh - Nhn s  c cp ti khon."})]}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[s.jsxs("li",{children:[" Email: ",s.jsx("span",{className:"font-medium",children:"hr@huyanhrubber.com"})]}),s.jsxs("li",{children:[" Ni b: ",s.jsx("span",{className:"font-medium",children:"101"})]})]})]}),s.jsx("div",{className:"mt-6 flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:" hiu"})})]})})]})}const wX=["completed","finished","pending_review"],_X=["pending_review","waiting_approval"],jX=["approved","rejected"],NX=["completed","finished","cancelled","accepted"],cx=["in_progress","new"],ux=["paused","on_hold"],dx=["new","in_progress","paused","on_hold","pending_review"],kX=[1,2,3],SX=[4,5];function Rf(e){return e?kX.includes(e)?"executive":SX.includes(e)?"manager":"employee":"employee"}function Xg(e){return Rf(e)==="executive"}function Uc(e){const r=Rf(e);return r==="executive"||r==="manager"}function xl(e){return wX.includes(e)}function Z2(e){return _X.includes(e)}function vg(e){return!!e&&jX.includes(e)}function CX(e){return NX.includes(e)}function AX(e){const r=typeof e=="string"?e:e?.evaluation_status;return r?r==="approved"?"Cng vic  c ph duyt, khng th chnh sa":r==="rejected"?"Cng vic  b t chi":"":""}function EX(e){return{none:"gray",pending_self_eval:"orange",pending_approval:"yellow",approved:"green",rejected:"red",revision_requested:"purple"}[e||"none"]||"gray"}function TX(e){return{none:"Cha c",pending_self_eval:"Ch t nh gi",pending_approval:"Ch ph duyt",approved:" ph duyt",rejected:"B t chi",revision_requested:"Yu cu sa"}[e||"none"]||e||"Cha c"}function J2(e,r,t,n,a){return a?{canApprove:!0}:Uc(e)?Xg(e)?{canApprove:!0}:n===r?{canApprove:!0}:{canApprove:!1,reason:"Khng c quyn ph duyt cng vic ngoi phng ban"}:{canApprove:!1,reason:"Ch qun l mi c quyn ph duyt"}}function Kb(e,r,t,n,a){const i=a||r==="admin",o=vg(e.evaluation_status),c=CX(e.status);if(i)return{canView:!0,canEdit:!o,canDelete:!c,canAssign:!0,canChangeStatus:!o,canEvaluate:xl(e.status)&&!o,canApprove:Z2(e.status),canRequestExtension:!c,canComment:!0,canAttach:!0,canSelfEvaluate:xl(e.status)&&!o,canMarkComplete:!c&&!o,canPause:cx.includes(e.status),canResume:ux.includes(e.status),canCancel:dx.includes(e.status)&&!o,editDisabledReason:o?"Cng vic  kha":void 0,deleteDisabledReason:c?"Khng th xa cng vic  hon thnh":void 0};const u=e.is_self_assigned===!0,l=e.department_id===t,d=Uc(n);if(Xg(n))return{canView:!0,canEdit:!o,canDelete:!c,canAssign:!0,canChangeStatus:!o,canEvaluate:xl(e.status)&&!o,canApprove:Z2(e.status),canRequestExtension:!c,canComment:!0,canAttach:!0,canSelfEvaluate:u&&xl(e.status)&&!o,canMarkComplete:u&&!c&&!o,canPause:u&&cx.includes(e.status),canResume:u&&ux.includes(e.status),canCancel:dx.includes(e.status)&&!o,editDisabledReason:o?"Cng vic  kha":void 0,deleteDisabledReason:c?"Khng th xa cng vic  hon thnh":void 0};if(d){const p=l;return{canView:p||u,canEdit:p&&!o,canDelete:p&&!c,canAssign:p,canChangeStatus:(p||u)&&!o,canEvaluate:p&&xl(e.status)&&!o,canApprove:p&&Z2(e.status),canRequestExtension:u&&!c,canComment:p||u,canAttach:p||u,canSelfEvaluate:u&&xl(e.status)&&!o,canMarkComplete:u&&!c&&!o,canPause:u&&cx.includes(e.status),canResume:u&&ux.includes(e.status),canCancel:(p||u)&&dx.includes(e.status)&&!o,editDisabledReason:p?o?"Cng vic  kha":void 0:"Khng c quyn sa cng vic ny",deleteDisabledReason:p?c?"Khng th xa cng vic  hon thnh":void 0:"Khng c quyn xa cng vic ny"}}return{canView:u,canEdit:u&&!o&&!c,canDelete:!1,canAssign:!1,canChangeStatus:u&&!o,canEvaluate:u&&xl(e.status)&&!o,canApprove:!1,canRequestExtension:u&&!c,canComment:u,canAttach:u,canSelfEvaluate:u&&xl(e.status)&&!o,canMarkComplete:u&&!c&&!o,canPause:u&&cx.includes(e.status),canResume:u&&ux.includes(e.status),canCancel:u&&dx.includes(e.status)&&!o,editDisabledReason:u?o?"Cng vic  kha":c?"Cng vic  hon thnh":void 0:"Khng c quyn sa cng vic ny",deleteDisabledReason:"Nhn vin khng c quyn xa cng vic"}}function VO(){const{user:e,isLoading:r}=xn(),t=R.useMemo(()=>e?.role?e.role==="admin"?"admin":e.role==="manager"||e.is_manager?"manager":"employee":"employee",[e?.role,e?.is_manager]),n=e?.position_level??null,a=e?.department_id??null,i=e?.employee_id??null,o=t==="admin",c=Rf(n),u=Xg(n),l=t==="manager"||t==="admin"||Uc(n),d=!l&&!o,f=R.useMemo(()=>(_,A,P)=>o||u?!0:l&&P?P===a:!0,[o,u,l,a]),p=R.useMemo(()=>(_,A,P)=>o||u?!0:l?P?P===a:!0:!1,[o,u,l,a]),h=R.useMemo(()=>(_,A,P)=>o||u?!0:l?P?P===a:!0:!!(A&&A===i),[o,u,l,a,i]),y=R.useMemo(()=>(_,A,P)=>o||u?!0:l?P?P===a:!0:!!(A&&A===i),[o,u,l,a,i]),g=R.useMemo(()=>(_,A)=>o?!0:Uc(n)?!!(u||!A||A===a):!1,[n,a,o,u]),m=R.useMemo(()=>(_,A)=>o?{canApprove:!0}:Uc(n)?u?{canApprove:!0}:A===a?{canApprove:!0}:{canApprove:!1,reason:"Khng c quyn ph duyt cng vic ngoi phng ban"}:{canApprove:!1,reason:"Ch qun l mi c quyn ph duyt"},[n,a,o,u]),x=R.useMemo(()=>_=>Kb(_,t,a,n,o),[t,a,n,o]),v=R.useMemo(()=>_=>o?{canAssign:!0}:u?{canAssign:!0}:Uc(n)?!_||_===a?{canAssign:!0}:{canAssign:!1,reason:"Ch c th giao vic trong phng ban ca mnh"}:{canAssign:!1,reason:"Nhn vin khng c quyn giao vic"},[n,a,o,u]),w=R.useMemo(()=>_=>!(!xl(_.status)||vg(_.evaluation_status)),[]);return{group:c,level:n,userRole:t,userLevel:n,userDepartmentId:a,userEmployeeId:i,isAdmin:o,isManager:l,isLoading:r??!1,isExecutive:u,isEmployee:d,canView:f,canCreate:p,canEdit:h,canDelete:y,canApprove:g,canApproveTask:m,getPermissions:x,canAssignTo:v,canEvaluateTask:w,isTaskLocked:vg,canTaskBeEvaluated:xl}}function Rp({title:e,value:r,subtitle:t,icon:n,color:a,link:i,onClick:o}){const c={blue:"bg-blue-50 text-blue-600 border-blue-200 hover:bg-blue-100",yellow:"bg-yellow-50 text-yellow-600 border-yellow-200 hover:bg-yellow-100",green:"bg-green-50 text-green-600 border-green-200 hover:bg-green-100",purple:"bg-purple-50 text-purple-600 border-purple-200 hover:bg-purple-100",orange:"bg-orange-50 text-orange-600 border-orange-200 hover:bg-orange-100",pink:"bg-pink-50 text-pink-600 border-pink-200 hover:bg-pink-100",indigo:"bg-indigo-50 text-indigo-600 border-indigo-200 hover:bg-indigo-100"},u={blue:"bg-blue-100 text-blue-600",yellow:"bg-yellow-100 text-yellow-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",orange:"bg-orange-100 text-orange-600",pink:"bg-pink-100 text-pink-600",indigo:"bg-indigo-100 text-indigo-600"},l=s.jsxs("div",{className:`
        rounded-2xl border-2 p-5 transition-all duration-300
        ${c[a]} 
        ${i||o?"cursor-pointer hover:scale-[1.02] hover:shadow-md":""}
      `,onClick:o,children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:e}),s.jsx("p",{className:"text-3xl font-bold mt-1",children:r}),t&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]}),s.jsx("div",{className:`p-3 rounded-xl ${u[a]}`,children:n})]}),(i||o)&&s.jsx(Ks,{className:"absolute bottom-4 right-4 w-5 h-5 opacity-50"})]});return i?s.jsx($a,{to:i,className:"block relative",children:l}):s.jsx("div",{className:"relative",children:l})}function PX({status:e}){const t={new:{label:"Mi",className:"bg-gray-100 text-gray-700"},in_progress:{label:"ang lm",className:"bg-blue-100 text-blue-700"},pending_review:{label:"Ch duyt",className:"bg-yellow-100 text-yellow-700"},completed:{label:"Hon thnh",className:"bg-green-100 text-green-700"},accepted:{label:" duyt",className:"bg-emerald-100 text-emerald-700"},rejected:{label:"T chi",className:"bg-red-100 text-red-700"}}[e]||{label:e,className:"bg-gray-100 text-gray-700"};return s.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${t.className}`,children:t.label})}function OX({priority:e}){const r={low:{label:"Thp",className:"text-gray-500"},medium:{label:"TB",className:"text-blue-500"},high:{label:"Cao",className:"text-orange-500"},urgent:{label:"Khn",className:"text-red-500"}},t=r[e]||r.medium;return s.jsx("span",{className:`text-xs font-medium ${t.className}`,children:t.label})}function MX(){const e=ts(),{user:r}=xn(),[t,n]=R.useState({totalTasks:0,pendingEvaluation:0,completedTasks:0,inProgressTasks:0,remainingLeaveDays:12,pendingLeaveRequests:0,recentTasks:[]}),[a,i]=R.useState(!0),[o,c]=R.useState(!1),[u,l]=R.useState(null),d=async(h=!1)=>{if(!r?.employee_id){i(!1);return}h?c(!0):i(!0);try{l(null);const y=r.employee_id,{count:g}=await se.from("task_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",y),{data:m}=await se.from("task_assignments").select(`
          id,
          task:tasks!inner(status)
        `).eq("employee_id",y).in("tasks.status",["new","in_progress"]),{data:x}=await se.from("task_assignments").select(`
          id,
          self_rating,
          task:tasks!inner(status)
        `).eq("employee_id",y).eq("tasks.status","pending_review").is("self_rating",null),{data:v}=await se.from("task_assignments").select(`
          id,
          task:tasks!inner(status)
        `).eq("employee_id",y).in("tasks.status",["completed","accepted"]),{count:w}=await se.from("leave_requests").select("*",{count:"exact",head:!0}).eq("employee_id",y).eq("status","pending"),_=new Date().getFullYear(),{data:A}=await se.from("leave_requests").select("total_days").eq("employee_id",y).eq("status","approved").gte("start_date",`${_}-01-01`).lte("end_date",`${_}-12-31`),P=A?.reduce((U,H)=>U+(H.total_days||0),0)||0,B=Math.max(0,12-P),{data:T}=await se.from("task_assignments").select(`
          id,
          task:tasks(id, name, code, status, due_date, priority)
        `).eq("employee_id",y).order("created_at",{ascending:!1}).limit(5),I=(T||[]).filter(U=>U.task).map(U=>({id:U.task.id,name:U.task.name,code:U.task.code||"",status:U.task.status,due_date:U.task.due_date,priority:U.task.priority||"medium"}));n({totalTasks:g||0,pendingEvaluation:x?.length||0,completedTasks:v?.length||0,inProgressTasks:m?.length||0,remainingLeaveDays:B,pendingLeaveRequests:w||0,recentTasks:I})}catch(y){console.error("Error fetching dashboard data:",y),l("Khng th ti d liu dashboard")}finally{i(!1),c(!1)}};if(R.useEffect(()=>{d()},[r?.employee_id]),a)return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mt,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"ang ti Dashboard..."})]})});if(u)return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Cr,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 mb-4",children:u}),s.jsx("button",{onClick:()=>d(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Th li"})]})});const f=h=>h?new Date(h).toLocaleDateString("vi-VN"):"",p=h=>h?new Date(h)<new Date:!1;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:s.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Xin cho, ",r?.full_name||"Nhn vin","! "]}),s.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[r?.department_name||"Cha c phng ban","  ",new Date().toLocaleDateString("vi-VN",{weekday:"long",day:"numeric",month:"long"})]})]}),s.jsxs("button",{onClick:()=>d(!0),disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-100 transition-colors disabled:opacity-50",children:[s.jsx(Vr,{className:`w-4 h-4 ${o?"animate-spin":""}`}),s.jsx("span",{className:"hidden sm:inline",children:"Lm mi"})]})]})})}),s.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[s.jsx(Rp,{title:"Cng vic ca ti",value:t.totalTasks,subtitle:`${t.inProgressTasks} ang thc hin`,icon:s.jsx(uh,{size:24}),color:"blue",link:"/my-tasks"}),s.jsx(Rp,{title:"Ch nh gi",value:t.pendingEvaluation,subtitle:"cn t nh gi",icon:s.jsx(Xr,{size:24}),color:"yellow",link:"/my-tasks?status=pending_review"}),s.jsx(Rp,{title:" hon thnh",value:t.completedTasks,subtitle:"cng vic",icon:s.jsx(Un,{size:24}),color:"green",link:"/my-tasks?status=completed"}),s.jsx(Rp,{title:"Ngy php cn li",value:t.remainingLeaveDays,subtitle:"ngy trong nm",icon:s.jsx(pg,{size:24}),color:"purple"}),s.jsx(Rp,{title:"n ch duyt",value:t.pendingLeaveRequests,subtitle:"n ngh php",icon:s.jsx(vr,{size:24}),color:"orange",link:"/leave-requests"}),s.jsx(Rp,{title:"Phiu lng",value:"Xem",subtitle:"phiu lng mi nht",icon:s.jsx(ej,{size:24}),color:"pink",link:"/payslips"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[s.jsxs("div",{className:"px-5 py-4 border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 rounded-lg bg-blue-100 text-blue-600",children:s.jsx(uh,{size:20})}),s.jsx("h2",{className:"font-semibold text-gray-900",children:"Cng vic gn y"})]}),s.jsxs($a,{to:"/my-tasks",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["Xem tt c",s.jsx(Ks,{size:16})]})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:t.recentTasks.length===0?s.jsxs("div",{className:"px-5 py-12 text-center",children:[s.jsx(uh,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{className:"text-gray-500",children:"Cha c cng vic no c giao"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Cc cng vic mi s hin th  y"})]}):t.recentTasks.map(h=>s.jsxs("div",{onClick:()=>e(`/my-tasks/${h.id}`),className:"px-5 py-4 flex items-center justify-between hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4 min-w-0 flex-1",children:[s.jsx(PX,{status:h.status}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-gray-900 font-medium truncate",children:h.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[s.jsx("span",{className:"text-xs text-gray-400",children:h.code}),s.jsx("span",{className:"text-gray-300",children:""}),s.jsx(OX,{priority:h.priority})]})]})]}),h.due_date&&s.jsxs("div",{className:`flex items-center gap-1.5 text-sm whitespace-nowrap ml-4 ${p(h.due_date)?"text-red-500":"text-gray-500"}`,children:[p(h.due_date)?s.jsx(xm,{size:14}):s.jsx(dn,{size:14}),f(h.due_date)]})]},h.id))})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-100 text-gray-600",children:s.jsx(Ks,{size:20})}),s.jsx("h2",{className:"font-semibold text-gray-900",children:"Thao tc nhanh"})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[s.jsxs($a,{to:"/my-tasks",className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors",children:[s.jsx(uh,{size:24}),s.jsx("span",{className:"text-sm font-medium",children:"Cng vic"})]}),s.jsxs($a,{to:"/leave-requests",className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-purple-50 text-purple-600 hover:bg-purple-100 transition-colors",children:[s.jsx(pg,{size:24}),s.jsx("span",{className:"text-sm font-medium",children:"Xin ngh php"})]}),s.jsxs($a,{to:"/attendance",className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-green-50 text-green-600 hover:bg-green-100 transition-colors",children:[s.jsx(Xr,{size:24}),s.jsx("span",{className:"text-sm font-medium",children:"Chm cng"})]}),s.jsxs($a,{to:"/payslips",className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-pink-50 text-pink-600 hover:bg-pink-100 transition-colors",children:[s.jsx(ej,{size:24}),s.jsx("span",{className:"text-sm font-medium",children:"Phiu lng"})]})]})]})]})]})}var IX=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function t3(e){if(typeof e!="string")return!1;var r=IX;return r.includes(e)}var RX=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],LX=new Set(RX);function WO(e){return typeof e!="string"?!1:LX.has(e)}function KO(e){return typeof e=="string"&&e.startsWith("data-")}function Zo(e){if(typeof e!="object"||e===null)return{};var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(WO(t)||KO(t))&&(r[t]=e[t]);return r}function Lf(e){if(e==null)return null;if(R.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var r=e.props;return Zo(r)}return typeof e=="object"&&!Array.isArray(e)?Zo(e):null}function ro(e){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(WO(t)||KO(t)||t3(t))&&(r[t]=e[t]);return r}function DX(e){return e==null?null:R.isValidElement(e)?ro(e.props):typeof e=="object"&&!Array.isArray(e)?ro(e):null}var FX=["children","width","height","viewBox","className","style","title","desc"];function rj(){return rj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},rj.apply(null,arguments)}function BX(e,r){if(e==null)return{};var t,n,a=$X(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function $X(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var r3=R.forwardRef((e,r)=>{var{children:t,width:n,height:a,viewBox:i,className:o,style:c,title:u,desc:l}=e,d=BX(e,FX),f=i||{width:n,height:a,x:0,y:0},p=yn("recharts-surface",o);return R.createElement("svg",rj({},ro(d),{className:p,width:n,height:a,style:c,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:r}),R.createElement("title",null,u),R.createElement("desc",null,l),t)}),qX=["children","className"];function nj(){return nj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},nj.apply(null,arguments)}function zX(e,r){if(e==null)return{};var t,n,a=UX(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function UX(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var oi=R.forwardRef((e,r)=>{var{children:t,className:n}=e,a=zX(e,qX),i=yn("recharts-layer",n);return R.createElement("g",nj({className:i},ro(a),{ref:r}),t)}),GO=R.createContext(null),HX=()=>R.useContext(GO);function Jn(e){return function(){return e}}const XO=Math.cos,_v=Math.sin,gc=Math.sqrt,jv=Math.PI,Gb=2*jv,sj=Math.PI,aj=2*sj,of=1e-6,VX=aj-of;function YO(e){this._+=e[0];for(let r=1,t=e.length;r<t;++r)this._+=arguments[r]+e[r]}function WX(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return YO;const t=10**r;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*t)/t+n[a]}}class KX{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?YO:WX(r)}moveTo(r,t){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,t){this._append`L${this._x1=+r},${this._y1=+t}`}quadraticCurveTo(r,t,n,a){this._append`Q${+r},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(r,t,n,a,i,o){this._append`C${+r},${+t},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(r,t,n,a,i){if(r=+r,t=+t,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,c=this._y1,u=n-r,l=a-t,d=o-r,f=c-t,p=d*d+f*f;if(this._x1===null)this._append`M${this._x1=r},${this._y1=t}`;else if(p>of)if(!(Math.abs(f*u-l*d)>of)||!i)this._append`L${this._x1=r},${this._y1=t}`;else{let h=n-o,y=a-c,g=u*u+l*l,m=h*h+y*y,x=Math.sqrt(g),v=Math.sqrt(p),w=i*Math.tan((sj-Math.acos((g+p-m)/(2*x*v)))/2),_=w/v,A=w/x;Math.abs(_-1)>of&&this._append`L${r+_*d},${t+_*f}`,this._append`A${i},${i},0,0,${+(f*h>d*y)},${this._x1=r+A*u},${this._y1=t+A*l}`}}arc(r,t,n,a,i,o){if(r=+r,t=+t,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),u=n*Math.sin(a),l=r+c,d=t+u,f=1^o,p=o?a-i:i-a;this._x1===null?this._append`M${l},${d}`:(Math.abs(this._x1-l)>of||Math.abs(this._y1-d)>of)&&this._append`L${l},${d}`,n&&(p<0&&(p=p%aj+aj),p>VX?this._append`A${n},${n},0,1,${f},${r-c},${t-u}A${n},${n},0,1,${f},${this._x1=l},${this._y1=d}`:p>of&&this._append`A${n},${n},0,${+(p>=sj)},${f},${this._x1=r+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(r,t,n,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function n3(e){let r=3;return e.digits=function(t){if(!arguments.length)return r;if(t==null)r=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);r=n}return e},()=>new KX(r)}function s3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function QO(e){this._context=e}QO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function Xb(e){return new QO(e)}function ZO(e){return e[0]}function JO(e){return e[1]}function eM(e,r){var t=Jn(!0),n=null,a=Xb,i=null,o=n3(c);e=typeof e=="function"?e:e===void 0?ZO:Jn(e),r=typeof r=="function"?r:r===void 0?JO:Jn(r);function c(u){var l,d=(u=s3(u)).length,f,p=!1,h;for(n==null&&(i=a(h=o())),l=0;l<=d;++l)!(l<d&&t(f=u[l],l,u))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(f,l,u),+r(f,l,u));if(h)return i=null,h+""||null}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:Jn(+u),c):e},c.y=function(u){return arguments.length?(r=typeof u=="function"?u:Jn(+u),c):r},c.defined=function(u){return arguments.length?(t=typeof u=="function"?u:Jn(!!u),c):t},c.curve=function(u){return arguments.length?(a=u,n!=null&&(i=a(n)),c):a},c.context=function(u){return arguments.length?(u==null?n=i=null:i=a(n=u),c):n},c}function hx(e,r,t){var n=null,a=Jn(!0),i=null,o=Xb,c=null,u=n3(l);e=typeof e=="function"?e:e===void 0?ZO:Jn(+e),r=typeof r=="function"?r:Jn(r===void 0?0:+r),t=typeof t=="function"?t:t===void 0?JO:Jn(+t);function l(f){var p,h,y,g=(f=s3(f)).length,m,x=!1,v,w=new Array(g),_=new Array(g);for(i==null&&(c=o(v=u())),p=0;p<=g;++p){if(!(p<g&&a(m=f[p],p,f))===x)if(x=!x)h=p,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),y=p-1;y>=h;--y)c.point(w[y],_[y]);c.lineEnd(),c.areaEnd()}x&&(w[p]=+e(m,p,f),_[p]=+r(m,p,f),c.point(n?+n(m,p,f):w[p],t?+t(m,p,f):_[p]))}if(v)return c=null,v+""||null}function d(){return eM().defined(a).curve(o).context(i)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Jn(+f),n=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Jn(+f),l):e},l.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Jn(+f),l):n},l.y=function(f){return arguments.length?(r=typeof f=="function"?f:Jn(+f),t=null,l):r},l.y0=function(f){return arguments.length?(r=typeof f=="function"?f:Jn(+f),l):r},l.y1=function(f){return arguments.length?(t=f==null?null:typeof f=="function"?f:Jn(+f),l):t},l.lineX0=l.lineY0=function(){return d().x(e).y(r)},l.lineY1=function(){return d().x(e).y(t)},l.lineX1=function(){return d().x(n).y(r)},l.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Jn(!!f),l):a},l.curve=function(f){return arguments.length?(o=f,i!=null&&(c=o(i)),l):o},l.context=function(f){return arguments.length?(f==null?i=c=null:c=o(i=f),l):i},l}class tM{constructor(r,t){this._context=r,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,t){switch(r=+r,t=+t,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,t,r,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,r,this._y0,r,t);break}}this._x0=r,this._y0=t}}function GX(e){return new tM(e,!0)}function XX(e){return new tM(e,!1)}const a3={draw(e,r){const t=gc(r/jv);e.moveTo(t,0),e.arc(0,0,t,0,Gb)}},YX={draw(e,r){const t=gc(r/5)/2;e.moveTo(-3*t,-t),e.lineTo(-t,-t),e.lineTo(-t,-3*t),e.lineTo(t,-3*t),e.lineTo(t,-t),e.lineTo(3*t,-t),e.lineTo(3*t,t),e.lineTo(t,t),e.lineTo(t,3*t),e.lineTo(-t,3*t),e.lineTo(-t,t),e.lineTo(-3*t,t),e.closePath()}},rM=gc(1/3),QX=rM*2,ZX={draw(e,r){const t=gc(r/QX),n=t*rM;e.moveTo(0,-t),e.lineTo(n,0),e.lineTo(0,t),e.lineTo(-n,0),e.closePath()}},JX={draw(e,r){const t=gc(r),n=-t/2;e.rect(n,n,t,t)}},eY=.8908130915292852,nM=_v(jv/10)/_v(7*jv/10),tY=_v(Gb/10)*nM,rY=-XO(Gb/10)*nM,nY={draw(e,r){const t=gc(r*eY),n=tY*t,a=rY*t;e.moveTo(0,-t),e.lineTo(n,a);for(let i=1;i<5;++i){const o=Gb*i/5,c=XO(o),u=_v(o);e.lineTo(u*t,-c*t),e.lineTo(c*n-u*a,u*n+c*a)}e.closePath()}},ew=gc(3),sY={draw(e,r){const t=-gc(r/(ew*3));e.moveTo(0,t*2),e.lineTo(-ew*t,-t),e.lineTo(ew*t,-t),e.closePath()}},pl=-.5,ml=gc(3)/2,ij=1/gc(12),aY=(ij/2+1)*3,iY={draw(e,r){const t=gc(r/aY),n=t/2,a=t*ij,i=n,o=t*ij+t,c=-i,u=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(c,u),e.lineTo(pl*n-ml*a,ml*n+pl*a),e.lineTo(pl*i-ml*o,ml*i+pl*o),e.lineTo(pl*c-ml*u,ml*c+pl*u),e.lineTo(pl*n+ml*a,pl*a-ml*n),e.lineTo(pl*i+ml*o,pl*o-ml*i),e.lineTo(pl*c+ml*u,pl*u-ml*c),e.closePath()}};function oY(e,r){let t=null,n=n3(a);e=typeof e=="function"?e:Jn(e||a3),r=typeof r=="function"?r:Jn(r===void 0?64:+r);function a(){let i;if(t||(t=i=n()),e.apply(this,arguments).draw(t,+r.apply(this,arguments)),i)return t=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Jn(i),a):e},a.size=function(i){return arguments.length?(r=typeof i=="function"?i:Jn(+i),a):r},a.context=function(i){return arguments.length?(t=i??null,a):t},a}function Nv(){}function kv(e,r,t){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+t)/6)}function sM(e){this._context=e}sM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kv(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kv(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function lY(e){return new sM(e)}function aM(e){this._context=e}aM.prototype={areaStart:Nv,areaEnd:Nv,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:kv(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function cY(e){return new aM(e)}function iM(e){this._context=e}iM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var t=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 3:this._point=4;default:kv(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function uY(e){return new iM(e)}function oM(e){this._context=e}oM.prototype={areaStart:Nv,areaEnd:Nv,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function dY(e){return new oM(e)}function LS(e){return e<0?-1:1}function DS(e,r,t){var n=e._x1-e._x0,a=r-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(t-e._y1)/(a||n<0&&-0),c=(i*a+o*n)/(n+a);return(LS(i)+LS(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(c))||0}function FS(e,r){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-r)/2:r}function tw(e,r,t){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*r,i-c,o-c*t,i,o)}function Sv(e){this._context=e}Sv.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tw(this,this._t0,FS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var t=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,tw(this,FS(this,t=DS(this,e,r)),t);break;default:tw(this,this._t0,t=DS(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=t}}};function lM(e){this._context=new cM(e)}(lM.prototype=Object.create(Sv.prototype)).point=function(e,r){Sv.prototype.point.call(this,r,e)};function cM(e){this._context=e}cM.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,t,n,a,i){this._context.bezierCurveTo(r,e,n,t,i,a)}};function hY(e){return new Sv(e)}function fY(e){return new lM(e)}function uM(e){this._context=e}uM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,t=e.length;if(t)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),t===2)this._context.lineTo(e[1],r[1]);else for(var n=BS(e),a=BS(r),i=0,o=1;o<t;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],r[o]);(this._line||this._line!==0&&t===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function BS(e){var r,t=e.length-1,n,a=new Array(t),i=new Array(t),o=new Array(t);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],r=1;r<t-1;++r)a[r]=1,i[r]=4,o[r]=4*e[r]+2*e[r+1];for(a[t-1]=2,i[t-1]=7,o[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)n=a[r]/i[r-1],i[r]-=n,o[r]-=n*o[r-1];for(a[t-1]=o[t-1]/i[t-1],r=t-2;r>=0;--r)a[r]=(o[r]-a[r+1])/i[r];for(i[t-1]=(e[t]+a[t-1])/2,r=0;r<t-1;++r)i[r]=2*e[r+1]-a[r+1];return[a,i]}function pY(e){return new uM(e)}function Yb(e,r){this._context=e,this._t=r}Yb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var t=this._x*(1-this._t)+e*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,r)}break}}this._x=e,this._y=r}};function mY(e){return new Yb(e,.5)}function gY(e){return new Yb(e,0)}function yY(e){return new Yb(e,1)}function Df(e,r){if((o=e.length)>1)for(var t=1,n,a,i=e[r[0]],o,c=i.length;t<o;++t)for(a=i,i=e[r[t]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function oj(e){for(var r=e.length,t=new Array(r);--r>=0;)t[r]=r;return t}function xY(e,r){return e[r]}function vY(e){const r=[];return r.key=e,r}function bY(){var e=Jn([]),r=oj,t=Df,n=xY;function a(i){var o=Array.from(e.apply(this,arguments),vY),c,u=o.length,l=-1,d;for(const f of i)for(c=0,++l;c<u;++c)(o[c][l]=[0,+n(f,o[c].key,l,i)]).data=f;for(c=0,d=s3(r(o));c<u;++c)o[d[c]].index=c;return t(o,d),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Jn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Jn(+i),a):n},a.order=function(i){return arguments.length?(r=i==null?oj:typeof i=="function"?i:Jn(Array.from(i)),a):r},a.offset=function(i){return arguments.length?(t=i??Df,a):t},a}function wY(e,r){if((n=e.length)>0){for(var t,n,a=0,i=e[0].length,o;a<i;++a){for(o=t=0;t<n;++t)o+=e[t][a][1]||0;if(o)for(t=0;t<n;++t)e[t][a][1]/=o}Df(e,r)}}function _Y(e,r){if((a=e.length)>0){for(var t=0,n=e[r[0]],a,i=n.length;t<i;++t){for(var o=0,c=0;o<a;++o)c+=e[o][t][1]||0;n[t][1]+=n[t][0]=-c/2}Df(e,r)}}function jY(e,r){if(!(!((o=e.length)>0)||!((i=(a=e[r[0]]).length)>0))){for(var t=0,n=1,a,i,o;n<i;++n){for(var c=0,u=0,l=0;c<o;++c){for(var d=e[r[c]],f=d[n][1]||0,p=d[n-1][1]||0,h=(f-p)/2,y=0;y<c;++y){var g=e[r[y]],m=g[n][1]||0,x=g[n-1][1]||0;h+=m-x}u+=f,l+=h*f}a[n-1][1]+=a[n-1][0]=t,u&&(t-=l/u)}a[n-1][1]+=a[n-1][0]=t,Df(e,r)}}var rw={},nw={},$S;function NY(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t==="__proto__"}e.isUnsafeProperty=r})(nw)),nw}var sw={},qS;function dM(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){switch(typeof t){case"number":case"symbol":return!1;case"string":return t.includes(".")||t.includes("[")||t.includes("]")}}e.isDeepKey=r})(sw)),sw}var aw={},zS;function i3(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return typeof t=="string"||typeof t=="symbol"?t:Object.is(t?.valueOf?.(),-0)?"-0":String(t)}e.toKey=r})(aw)),aw}var iw={},ow={},US;function kY(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){if(t==null)return"";if(typeof t=="string")return t;if(Array.isArray(t))return t.map(r).join(",");const n=String(t);return n==="0"&&Object.is(Number(t),-0)?"-0":n}e.toString=r})(ow)),ow}var HS;function o3(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=kY(),t=i3();function n(a){if(Array.isArray(a))return a.map(t.toKey);if(typeof a=="symbol")return[a];a=r.toString(a);const i=[],o=a.length;if(o===0)return i;let c=0,u="",l="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),c++);c<o;){const f=a[c];l?f==="\\"&&c+1<o?(c++,u+=a[c]):f===l?l="":u+=f:d?f==='"'||f==="'"?l=f:f==="]"?(d=!1,i.push(u),u=""):u+=f:f==="["?(d=!0,u&&(i.push(u),u="")):f==="."?u&&(i.push(u),u=""):u+=f,c++}return u&&i.push(u),i}e.toPath=n})(iw)),iw}var VS;function l3(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=NY(),t=dM(),n=i3(),a=o3();function i(c,u,l){if(c==null)return l;switch(typeof u){case"string":{if(r.isUnsafeProperty(u))return l;const d=c[u];return d===void 0?t.isDeepKey(u)?i(c,a.toPath(u),l):l:d}case"number":case"symbol":{typeof u=="number"&&(u=n.toKey(u));const d=c[u];return d===void 0?l:d}default:{if(Array.isArray(u))return o(c,u,l);if(Object.is(u?.valueOf(),-0)?u="-0":u=String(u),r.isUnsafeProperty(u))return l;const d=c[u];return d===void 0?l:d}}}function o(c,u,l){if(u.length===0)return l;let d=c;for(let f=0;f<u.length;f++){if(d==null||r.isUnsafeProperty(u[f]))return l;d=d[u[f]]}return d===void 0?l:d}e.get=i})(rw)),rw}var lw,WS;function SY(){return WS||(WS=1,lw=l3().get),lw}var CY=SY();const Ff=ru(CY);var AY=4;function dh(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AY,t=10**r,n=Math.round(e*t)/t;return Object.is(n,-0)?0:n}function Vs(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return e.reduce((a,i,o)=>{var c=t[o-1];return typeof c=="string"?a+c+i:c!==void 0?a+dh(c)+i:a+i},"")}var ni=e=>e===0?0:e>0?1:-1,Zc=e=>typeof e=="number"&&e!=+e,Bf=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Vt=e=>(typeof e=="number"||e instanceof Number)&&!Zc(e),Jc=e=>Vt(e)||typeof e=="string",EY=0,bg=e=>{var r=++EY;return"".concat(e||"").concat(r)},qi=function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Vt(r)&&typeof r!="string")return n;var i;if(Bf(r)){if(t==null)return n;var o=r.indexOf("%");i=t*parseFloat(r.slice(0,o))/100}else i=+r;return Zc(i)&&(i=n),a&&t!=null&&i>t&&(i=t),i},hM=e=>{if(!Array.isArray(e))return!1;for(var r=e.length,t={},n=0;n<r;n++)if(!t[String(e[n])])t[String(e[n])]=!0;else return!0;return!1};function vs(e,r,t){return Vt(e)&&Vt(r)?dh(e+t*(r-e)):r}function fM(e,r,t){if(!(!e||!e.length))return e.find(n=>n&&(typeof r=="function"?r(n):Ff(n,r))===t)}var Ms=e=>e===null||typeof e>"u",Yg=e=>Ms(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function vo(e){return e!=null}function Xf(){}var TY=["type","size","sizeType"];function lj(){return lj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},lj.apply(null,arguments)}function KS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function GS(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?KS(Object(t),!0).forEach(function(n){PY(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):KS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function PY(e,r,t){return(r=OY(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function OY(e){var r=MY(e,"string");return typeof r=="symbol"?r:r+""}function MY(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function IY(e,r){if(e==null)return{};var t,n,a=RY(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function RY(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var pM={symbolCircle:a3,symbolCross:YX,symbolDiamond:ZX,symbolSquare:JX,symbolStar:nY,symbolTriangle:sY,symbolWye:iY},LY=Math.PI/180,DY=e=>{var r="symbol".concat(Yg(e));return pM[r]||a3},FY=(e,r,t)=>{if(r==="area")return e;switch(t){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*LY;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},BY=(e,r)=>{pM["symbol".concat(Yg(e))]=r},c3=e=>{var{type:r="circle",size:t=64,sizeType:n="area"}=e,a=IY(e,TY),i=GS(GS({},a),{},{type:r,size:t,sizeType:n}),o="circle";typeof r=="string"&&(o=r);var c=()=>{var p=DY(o),h=oY().type(p).size(FY(t,n,o)),y=h();if(y!==null)return y},{className:u,cx:l,cy:d}=i,f=ro(i);return Vt(l)&&Vt(d)&&Vt(t)?R.createElement("path",lj({},f,{className:yn("recharts-symbols",u),transform:"translate(".concat(l,", ").concat(d,")"),d:c()})):null};c3.registerSymbol=BY;var mM=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,u3=(e,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var t=e;if(R.isValidElement(e)&&(t=e.props),typeof t!="object"&&typeof t!="function")return null;var n={};return Object.keys(t).forEach(a=>{t3(a)&&(n[a]=(i=>t[a](t,i)))}),n},$Y=(e,r,t)=>n=>(e(r,t,n),null),Qg=(e,r,t)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];t3(a)&&typeof i=="function"&&(n||(n={}),n[a]=$Y(i,r,t))}),n};function XS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function qY(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?XS(Object(t),!0).forEach(function(n){zY(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):XS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function zY(e,r,t){return(r=UY(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function UY(e){var r=HY(e,"string");return typeof r=="symbol"?r:r+""}function HY(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Sa(e,r){var t=qY({},e),n=r,a=Object.keys(r),i=a.reduce((o,c)=>(o[c]===void 0&&n[c]!==void 0&&(o[c]=n[c]),o),t);return i}function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Cv.apply(null,arguments)}function YS(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function VY(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?YS(Object(t),!0).forEach(function(n){WY(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):YS(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function WY(e,r,t){return(r=KY(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function KY(e){var r=GY(e,"string");return typeof r=="symbol"?r:r+""}function GY(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var yl=32,XY={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function YY(e){var{data:r,iconType:t,inactiveColor:n}=e,a=yl/2,i=yl/6,o=yl/3,c=r.inactive?n:r.color,u=t??r.type;if(u==="none")return null;if(u==="plainline"){var l;return R.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:(l=r.payload)===null||l===void 0?void 0:l.strokeDasharray,x1:0,y1:a,x2:yl,y2:a,className:"recharts-legend-icon"})}if(u==="line")return R.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(yl,"M").concat(2*o,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(u==="rect")return R.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(yl/8,"h").concat(yl,"v").concat(yl*3/4,"h").concat(-yl,"z"),className:"recharts-legend-icon"});if(R.isValidElement(r.legendIcon)){var d=VY({},r);return delete d.legendIcon,R.cloneElement(r.legendIcon,d)}return R.createElement(c3,{fill:c,cx:a,cy:a,size:yl,sizeType:"diameter",type:u})}function QY(e){var{payload:r,iconSize:t,layout:n,formatter:a,inactiveColor:i,iconType:o}=e,c={x:0,y:0,width:yl,height:yl},u={display:n==="horizontal"?"inline-block":"block",marginRight:10},l={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((d,f)=>{var p=d.formatter||a,h=yn({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var y=d.inactive?i:d.color,g=p?p(d.value,d,f):d.value;return R.createElement("li",Cv({className:h,style:u,key:"legend-item-".concat(f)},Qg(e,d,f)),R.createElement(r3,{width:t,height:t,viewBox:c,style:l,"aria-label":"".concat(g," legend icon")},R.createElement(YY,{data:d,iconType:o,inactiveColor:i})),R.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},g))})}var ZY=e=>{var r=Sa(e,XY),{payload:t,layout:n,align:a}=r;if(!t||!t.length)return null;var i={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return R.createElement("ul",{className:"recharts-default-legend",style:i},R.createElement(QY,Cv({},r,{payload:t})))},cw={},uw={},QS;function JY(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,n){const a=new Map;for(let i=0;i<t.length;i++){const o=t[i],c=n(o,i,t);a.has(c)||a.set(c,o)}return Array.from(a.values())}e.uniqBy=r})(uw)),uw}var dw={},ZS;function eQ(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,n){return function(...a){return t.apply(this,a.slice(0,n))}}e.ary=r})(dw)),dw}var hw={},JS;function gM(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t}e.identity=r})(hw)),hw}var fw={},pw={},mw={},e8;function tQ(){return e8||(e8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return Number.isSafeInteger(t)&&t>=0}e.isLength=r})(mw)),mw}var t8;function d3(){return t8||(t8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=tQ();function t(n){return n!=null&&typeof n!="function"&&r.isLength(n.length)}e.isArrayLike=t})(pw)),pw}var gw={},r8;function rQ(){return r8||(r8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return typeof t=="object"&&t!==null}e.isObjectLike=r})(gw)),gw}var n8;function nQ(){return n8||(n8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=d3(),t=rQ();function n(a){return t.isObjectLike(a)&&r.isArrayLike(a)}e.isArrayLikeObject=n})(fw)),fw}var yw={},xw={},s8;function sQ(){return s8||(s8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=l3();function t(n){return function(a){return r.get(a,n)}}e.property=t})(xw)),xw}var vw={},bw={},ww={},_w={},a8;function yM(){return a8||(a8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t!==null&&(typeof t=="object"||typeof t=="function")}e.isObject=r})(_w)),_w}var jw={},i8;function xM(){return i8||(i8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t==null||typeof t!="object"&&typeof t!="function"}e.isPrimitive=r})(jw)),jw}var Nw={},o8;function vM(){return o8||(o8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,n){return t===n||Number.isNaN(t)&&Number.isNaN(n)}e.isEqualsSameValueZero=r})(Nw)),Nw}var l8;function aQ(){return l8||(l8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=yM(),t=xM(),n=vM();function a(d,f,p){return typeof p!="function"?a(d,f,()=>{}):i(d,f,function h(y,g,m,x,v,w){const _=p(y,g,m,x,v,w);return _!==void 0?!!_:i(y,g,h,w)},new Map)}function i(d,f,p,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,p,h);case"function":return Object.keys(f).length>0?i(d,{...f},p,h):n.isEqualsSameValueZero(d,f);default:return r.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,p,h){if(f==null)return!0;if(Array.isArray(f))return u(d,f,p,h);if(f instanceof Map)return c(d,f,p,h);if(f instanceof Set)return l(d,f,p,h);const y=Object.keys(f);if(d==null||t.isPrimitive(d))return y.length===0;if(y.length===0)return!0;if(h?.has(f))return h.get(f)===d;h?.set(f,d);try{for(let g=0;g<y.length;g++){const m=y[g];if(!t.isPrimitive(d)&&!(m in d)||f[m]===void 0&&d[m]!==void 0||f[m]===null&&d[m]!==null||!p(d[m],f[m],m,d,f,h))return!1}return!0}finally{h?.delete(f)}}function c(d,f,p,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[y,g]of f.entries()){const m=d.get(y);if(p(m,g,y,d,f,h)===!1)return!1}return!0}function u(d,f,p,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const y=new Set;for(let g=0;g<f.length;g++){const m=f[g];let x=!1;for(let v=0;v<d.length;v++){if(y.has(v))continue;const w=d[v];let _=!1;if(p(w,m,g,d,f,h)&&(_=!0),_){y.add(v),x=!0;break}}if(!x)return!1}return!0}function l(d,f,p,h){return f.size===0?!0:d instanceof Set?u([...d],[...f],p,h):!1}e.isMatchWith=a,e.isSetMatch=l})(ww)),ww}var c8;function bM(){return c8||(c8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=aQ();function t(n,a){return r.isMatchWith(n,a,()=>{})}e.isMatch=t})(bw)),bw}var kw={},Sw={},Cw={},u8;function iQ(){return u8||(u8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return Object.getOwnPropertySymbols(t).filter(n=>Object.prototype.propertyIsEnumerable.call(t,n))}e.getSymbols=r})(Cw)),Cw}var Aw={},d8;function h3(){return d8||(d8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}e.getTag=r})(Aw)),Aw}var Ew={},h8;function wM(){return h8||(h8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r="[object RegExp]",t="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",o="[object Symbol]",c="[object Date]",u="[object Map]",l="[object Set]",d="[object Array]",f="[object Function]",p="[object ArrayBuffer]",h="[object Object]",y="[object Error]",g="[object DataView]",m="[object Uint8Array]",x="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",_="[object BigUint64Array]",A="[object Int8Array]",P="[object Int16Array]",B="[object Int32Array]",T="[object BigInt64Array]",I="[object Float32Array]",U="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=T,e.bigUint64ArrayTag=_,e.booleanTag=a,e.dataViewTag=g,e.dateTag=c,e.errorTag=y,e.float32ArrayTag=I,e.float64ArrayTag=U,e.functionTag=f,e.int16ArrayTag=P,e.int32ArrayTag=B,e.int8ArrayTag=A,e.mapTag=u,e.numberTag=n,e.objectTag=h,e.regexpTag=r,e.setTag=l,e.stringTag=t,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=m,e.uint8ClampedArrayTag=x})(Ew)),Ew}var Tw={},f8;function oQ(){return f8||(f8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}e.isTypedArray=r})(Tw)),Tw}var p8;function _M(){return p8||(p8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=iQ(),t=h3(),n=wM(),a=xM(),i=oQ();function o(d,f){return c(d,void 0,d,new Map,f)}function c(d,f,p,h=new Map,y=void 0){const g=y?.(d,f,p,h);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const m=new Array(d.length);h.set(d,m);for(let x=0;x<d.length;x++)m[x]=c(d[x],x,p,h,y);return Object.hasOwn(d,"index")&&(m.index=d.index),Object.hasOwn(d,"input")&&(m.input=d.input),m}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const m=new RegExp(d.source,d.flags);return m.lastIndex=d.lastIndex,m}if(d instanceof Map){const m=new Map;h.set(d,m);for(const[x,v]of d)m.set(x,c(v,x,p,h,y));return m}if(d instanceof Set){const m=new Set;h.set(d,m);for(const x of d)m.add(c(x,void 0,p,h,y));return m}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const m=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,m);for(let x=0;x<d.length;x++)m[x]=c(d[x],x,p,h,y);return m}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const m=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,m),u(m,d,p,h,y),m}if(typeof File<"u"&&d instanceof File){const m=new File([d],d.name,{type:d.type});return h.set(d,m),u(m,d,p,h,y),m}if(typeof Blob<"u"&&d instanceof Blob){const m=new Blob([d],{type:d.type});return h.set(d,m),u(m,d,p,h,y),m}if(d instanceof Error){const m=new d.constructor;return h.set(d,m),m.message=d.message,m.name=d.name,m.stack=d.stack,m.cause=d.cause,u(m,d,p,h,y),m}if(d instanceof Boolean){const m=new Boolean(d.valueOf());return h.set(d,m),u(m,d,p,h,y),m}if(d instanceof Number){const m=new Number(d.valueOf());return h.set(d,m),u(m,d,p,h,y),m}if(d instanceof String){const m=new String(d.valueOf());return h.set(d,m),u(m,d,p,h,y),m}if(typeof d=="object"&&l(d)){const m=Object.create(Object.getPrototypeOf(d));return h.set(d,m),u(m,d,p,h,y),m}return d}function u(d,f,p=d,h,y){const g=[...Object.keys(f),...r.getSymbols(f)];for(let m=0;m<g.length;m++){const x=g[m],v=Object.getOwnPropertyDescriptor(d,x);(v==null||v.writable)&&(d[x]=c(f[x],x,p,h,y))}}function l(d){switch(t.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=c,e.copyProperties=u})(Sw)),Sw}var m8;function lQ(){return m8||(m8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=_M();function t(n){return r.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=t})(kw)),kw}var g8;function cQ(){return g8||(g8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=bM(),t=lQ();function n(a){return a=t.cloneDeep(a),i=>r.isMatch(i,a)}e.matches=n})(vw)),vw}var Pw={},Ow={},Mw={},y8;function uQ(){return y8||(y8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=_M(),t=h3(),n=wM();function a(i,o){return r.cloneDeepWith(i,(c,u,l,d)=>{const f=o?.(c,u,l,d);if(f!==void 0)return f;if(typeof i=="object"){if(t.getTag(i)===n.objectTag&&typeof i.constructor!="function"){const p={};return d.set(i,p),r.copyProperties(p,i,l,d),p}switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const p=new i.constructor(i?.valueOf());return r.copyProperties(p,i),p}case n.argumentsTag:{const p={};return r.copyProperties(p,i),p.length=i.length,p[Symbol.iterator]=i[Symbol.iterator],p}default:return}}})}e.cloneDeepWith=a})(Mw)),Mw}var x8;function dQ(){return x8||(x8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=uQ();function t(n){return r.cloneDeepWith(n)}e.cloneDeep=t})(Ow)),Ow}var Iw={},Rw={},v8;function jM(){return v8||(v8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=/^(?:0|[1-9]\d*)$/;function t(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return r.test(n)}}e.isIndex=t})(Rw)),Rw}var Lw={},b8;function hQ(){return b8||(b8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=h3();function t(n){return n!==null&&typeof n=="object"&&r.getTag(n)==="[object Arguments]"}e.isArguments=t})(Lw)),Lw}var w8;function fQ(){return w8||(w8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=dM(),t=jM(),n=hQ(),a=o3();function i(o,c){let u;if(Array.isArray(c)?u=c:typeof c=="string"&&r.isDeepKey(c)&&o?.[c]==null?u=a.toPath(c):u=[c],u.length===0)return!1;let l=o;for(let d=0;d<u.length;d++){const f=u[d];if((l==null||!Object.hasOwn(l,f))&&!((Array.isArray(l)||n.isArguments(l))&&t.isIndex(f)&&f<l.length))return!1;l=l[f]}return!0}e.has=i})(Iw)),Iw}var _8;function pQ(){return _8||(_8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=bM(),t=i3(),n=dQ(),a=l3(),i=fQ();function o(c,u){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=t.toKey(c);break}}return u=n.cloneDeep(u),function(l){const d=a.get(l,c);return d===void 0?i.has(l,c):u===void 0?d===void 0:r.isMatch(d,u)}}e.matchesProperty=o})(Pw)),Pw}var j8;function mQ(){return j8||(j8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=gM(),t=sQ(),n=cQ(),a=pQ();function i(o){if(o==null)return r.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return t.property(o)}}e.iteratee=i})(yw)),yw}var N8;function gQ(){return N8||(N8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=JY(),t=eQ(),n=gM(),a=nQ(),i=mQ();function o(c,u=n.identity){return a.isArrayLikeObject(c)?r.uniqBy(Array.from(c),t.ary(i.iteratee(u),1)):[]}e.uniqBy=o})(cw)),cw}var Dw,k8;function yQ(){return k8||(k8=1,Dw=gQ().uniqBy),Dw}var xQ=yQ();const S8=ru(xQ);function NM(e,r,t){return r===!0?S8(e,t):typeof r=="function"?S8(e,r):e}var Fw={exports:{}},Bw={},$w={exports:{}},qw={};var C8;function vQ(){if(C8)return qw;C8=1;var e=Am();function r(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var t=typeof Object.is=="function"?Object.is:r,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function c(f,p){var h=p(),y=n({inst:{value:h,getSnapshot:p}}),g=y[0].inst,m=y[1];return i(function(){g.value=h,g.getSnapshot=p,u(g)&&m({inst:g})},[f,h,p]),a(function(){return u(g)&&m({inst:g}),f(function(){u(g)&&m({inst:g})})},[f]),o(h),h}function u(f){var p=f.getSnapshot;f=f.value;try{var h=p();return!t(f,h)}catch{return!0}}function l(f,p){return p()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:c;return qw.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,qw}var A8;function bQ(){return A8||(A8=1,$w.exports=vQ()),$w.exports}var E8;function wQ(){if(E8)return Bw;E8=1;var e=Am(),r=bQ();function t(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var n=typeof Object.is=="function"?Object.is:t,a=r.useSyncExternalStore,i=e.useRef,o=e.useEffect,c=e.useMemo,u=e.useDebugValue;return Bw.useSyncExternalStoreWithSelector=function(l,d,f,p,h){var y=i(null);if(y.current===null){var g={hasValue:!1,value:null};y.current=g}else g=y.current;y=c(function(){function x(P){if(!v){if(v=!0,w=P,P=p(P),h!==void 0&&g.hasValue){var B=g.value;if(h(B,P))return _=B}return _=P}if(B=_,n(w,P))return B;var T=p(P);return h!==void 0&&h(B,T)?(w=P,B):(w=P,_=T)}var v=!1,w,_,A=f===void 0?null:f;return[function(){return x(d())},A===null?void 0:function(){return x(A())}]},[d,f,p,h]);var m=a(l,y[0],y[1]);return o(function(){g.hasValue=!0,g.value=m},[m]),u(m),m},Bw}var T8;function _Q(){return T8||(T8=1,Fw.exports=wQ()),Fw.exports}var jQ=_Q(),f3=R.createContext(null),NQ=e=>e,rs=()=>{var e=R.useContext(f3);return e?e.store.dispatch:NQ},Jx=()=>{},kQ=()=>Jx,SQ=(e,r)=>e===r;function nr(e){var r=R.useContext(f3),t=R.useMemo(()=>r?n=>{if(n!=null)return e(n)}:Jx,[r,e]);return jQ.useSyncExternalStoreWithSelector(r?r.subscription.addNestedSub:kQ,r?r.store.getState:Jx,r?r.store.getState:Jx,t,SQ)}function CQ(e,r=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(r)}function AQ(e,r=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(r)}function EQ(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(t=>typeof t=="function")){const t=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${r}[${t}]`)}}var P8=e=>Array.isArray(e)?e:[e];function TQ(e){const r=Array.isArray(e[0])?e[0]:e;return EQ(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function PQ(e,r){const t=[],{length:n}=e;for(let a=0;a<n;a++)t.push(e[a].apply(null,r));return t}var OQ=class{constructor(e){this.value=e}deref(){return this.value}},MQ=typeof WeakRef<"u"?WeakRef:OQ,IQ=0,O8=1;function fx(){return{s:IQ,v:void 0,o:null,p:null}}function kM(e,r={}){let t=fx();const{resultEqualityCheck:n}=r;let a,i=0;function o(){let c=t;const{length:u}=arguments;for(let f=0,p=u;f<p;f++){const h=arguments[f];if(typeof h=="function"||typeof h=="object"&&h!==null){let y=c.o;y===null&&(c.o=y=new WeakMap);const g=y.get(h);g===void 0?(c=fx(),y.set(h,c)):c=g}else{let y=c.p;y===null&&(c.p=y=new Map);const g=y.get(h);g===void 0?(c=fx(),y.set(h,c)):c=g}}const l=c;let d;if(c.s===O8)d=c.v;else if(d=e.apply(null,arguments),i++,n){const f=a?.deref?.()??a;f!=null&&n(f,d)&&(d=f,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new MQ(d):d}return l.s=O8,l.v=d,d}return o.clearCache=()=>{t=fx(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function RQ(e,...r){const t=typeof e=="function"?{memoize:e,memoizeOptions:r}:e,n=(...a)=>{let i=0,o=0,c,u={},l=a.pop();typeof l=="object"&&(u=l,l=a.pop()),CQ(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const d={...t,...u},{memoize:f,memoizeOptions:p=[],argsMemoize:h=kM,argsMemoizeOptions:y=[]}=d,g=P8(p),m=P8(y),x=TQ(a),v=f(function(){return i++,l.apply(null,arguments)},...g),w=h(function(){o++;const A=PQ(x,arguments);return c=v.apply(null,A),c},...m);return Object.assign(w,{resultFunc:l,memoizedResultFunc:v,dependencies:x,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Xe=RQ(kM),LQ=Object.assign((e,r=Xe)=>{AQ(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const t=Object.keys(e),n=t.map(i=>e[i]);return r(n,(...i)=>i.reduce((o,c,u)=>(o[t[u]]=c,o),{}))},{withTypes:()=>LQ}),zw={},Uw={},Hw={},M8;function DQ(){return M8||(M8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const t=(n,a,i)=>{if(n!==a){const o=r(n),c=r(a);if(o===c&&o===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?c-o:o-c}return 0};e.compareValues=t})(Hw)),Hw}var Vw={},Ww={},I8;function SM(){return I8||(I8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return typeof t=="symbol"||t instanceof Symbol}e.isSymbol=r})(Ww)),Ww}var R8;function FQ(){return R8||(R8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=SM(),t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||r.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!t.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=a})(Vw)),Vw}var L8;function BQ(){return L8||(L8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=DQ(),t=FQ(),n=o3();function a(i,o,c,u){if(i==null)return[];c=u?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(h=>String(h));const l=(h,y)=>{let g=h;for(let m=0;m<y.length&&g!=null;++m)g=g[y[m]];return g},d=(h,y)=>y==null||h==null?y:typeof h=="object"&&"key"in h?Object.hasOwn(y,h.key)?y[h.key]:l(y,h.path):typeof h=="function"?h(y):Array.isArray(h)?l(y,h):typeof y=="object"?y[h]:y,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||t.isKey(h)?h:{key:h,path:n.toPath(h)}));return i.map(h=>({original:h,criteria:f.map(y=>d(y,h))})).slice().sort((h,y)=>{for(let g=0;g<f.length;g++){const m=r.compareValues(h.criteria[g],y.criteria[g],c[g]);if(m!==0)return m}return 0}).map(h=>h.original)}e.orderBy=a})(Uw)),Uw}var Kw={},D8;function $Q(){return D8||(D8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,n=1){const a=[],i=Math.floor(n),o=(c,u)=>{for(let l=0;l<c.length;l++){const d=c[l];Array.isArray(d)&&u<i?o(d,u+1):a.push(d)}};return o(t,0),a}e.flatten=r})(Kw)),Kw}var Gw={},F8;function CM(){return F8||(F8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=jM(),t=d3(),n=yM(),a=vM();function i(o,c,u){return n.isObject(u)&&(typeof c=="number"&&t.isArrayLike(u)&&r.isIndex(c)&&c<u.length||typeof c=="string"&&c in u)?a.isEqualsSameValueZero(u[c],o):!1}e.isIterateeCall=i})(Gw)),Gw}var B8;function qQ(){return B8||(B8=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=BQ(),t=$Q(),n=CM();function a(i,...o){const c=o.length;return c>1&&n.isIterateeCall(i,o[0],o[1])?o=[]:c>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),r.orderBy(i,t.flatten(o),["asc"])}e.sortBy=a})(zw)),zw}var Xw,$8;function zQ(){return $8||($8=1,Xw=qQ().sortBy),Xw}var UQ=zQ();const Qb=ru(UQ);var AM=e=>e.legend.settings,HQ=e=>e.legend.size,VQ=e=>e.legend.payload,WQ=Xe([VQ,AM],(e,r)=>{var{itemSorter:t}=r,n=e.flat(1);return t?Qb(n,t):n});function KQ(){return nr(WQ)}var px=1;function EM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[r,t]=R.useState({height:0,left:0,top:0,width:0}),n=R.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-r.height)>px||Math.abs(o.left-r.left)>px||Math.abs(o.top-r.top)>px||Math.abs(o.width-r.width)>px)&&t({height:o.height,left:o.left,top:o.top,width:o.width})}},[r.width,r.height,r.top,r.left,...e]);return[r,n]}function bi(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var GQ=typeof Symbol=="function"&&Symbol.observable||"@@observable",q8=GQ,Yw=()=>Math.random().toString(36).substring(7).split("").join("."),XQ={INIT:`@@redux/INIT${Yw()}`,REPLACE:`@@redux/REPLACE${Yw()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Yw()}`},Av=XQ;function p3(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function TM(e,r,t){if(typeof e!="function")throw new Error(bi(2));if(typeof r=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(bi(0));if(typeof r=="function"&&typeof t>"u"&&(t=r,r=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(bi(1));return t(TM)(e,r)}let n=e,a=r,i=new Map,o=i,c=0,u=!1;function l(){o===i&&(o=new Map,i.forEach((m,x)=>{o.set(x,m)}))}function d(){if(u)throw new Error(bi(3));return a}function f(m){if(typeof m!="function")throw new Error(bi(4));if(u)throw new Error(bi(5));let x=!0;l();const v=c++;return o.set(v,m),function(){if(x){if(u)throw new Error(bi(6));x=!1,l(),o.delete(v),i=null}}}function p(m){if(!p3(m))throw new Error(bi(7));if(typeof m.type>"u")throw new Error(bi(8));if(typeof m.type!="string")throw new Error(bi(17));if(u)throw new Error(bi(9));try{u=!0,a=n(a,m)}finally{u=!1}return(i=o).forEach(v=>{v()}),m}function h(m){if(typeof m!="function")throw new Error(bi(10));n=m,p({type:Av.REPLACE})}function y(){const m=f;return{subscribe(x){if(typeof x!="object"||x===null)throw new Error(bi(11));function v(){const _=x;_.next&&_.next(d())}return v(),{unsubscribe:m(v)}},[q8](){return this}}}return p({type:Av.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:h,[q8]:y}}function YQ(e){Object.keys(e).forEach(r=>{const t=e[r];if(typeof t(void 0,{type:Av.INIT})>"u")throw new Error(bi(12));if(typeof t(void 0,{type:Av.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(bi(13))})}function PM(e){const r=Object.keys(e),t={};for(let i=0;i<r.length;i++){const o=r[i];typeof e[o]=="function"&&(t[o]=e[o])}const n=Object.keys(t);let a;try{YQ(t)}catch(i){a=i}return function(o={},c){if(a)throw a;let u=!1;const l={};for(let d=0;d<n.length;d++){const f=n[d],p=t[f],h=o[f],y=p(h,c);if(typeof y>"u")throw c&&c.type,new Error(bi(14));l[f]=y,u=u||y!==h}return u=u||n.length!==Object.keys(o).length,u?l:o}}function Ev(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,t)=>(...n)=>r(t(...n)))}function QQ(...e){return r=>(t,n)=>{const a=r(t,n);let i=()=>{throw new Error(bi(15))};const o={getState:a.getState,dispatch:(u,...l)=>i(u,...l)},c=e.map(u=>u(o));return i=Ev(...c)(a.dispatch),{...a,dispatch:i}}}function OM(e){return p3(e)&&"type"in e&&typeof e.type=="string"}var MM=Symbol.for("immer-nothing"),z8=Symbol.for("immer-draftable"),no=Symbol.for("immer-state");function nc(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Go=Object,vm=Go.getPrototypeOf,Tv="constructor",Zb="prototype",cj="configurable",Pv="enumerable",ev="writable",wg="value",id=e=>!!e&&!!e[no];function fc(e){return e?IM(e)||e1(e)||!!e[z8]||!!e[Tv]?.[z8]||t1(e)||r1(e):!1}var ZQ=Go[Zb][Tv].toString(),U8=new WeakMap;function IM(e){if(!e||!m3(e))return!1;const r=vm(e);if(r===null||r===Go[Zb])return!0;const t=Go.hasOwnProperty.call(r,Tv)&&r[Tv];if(t===Object)return!0;if(!Yp(t))return!1;let n=U8.get(t);return n===void 0&&(n=Function.toString.call(t),U8.set(t,n)),n===ZQ}function Jb(e,r,t=!0){Zg(e)===0?(t?Reflect.ownKeys(e):Go.keys(e)).forEach(a=>{r(a,e[a],e)}):e.forEach((n,a)=>r(a,n,e))}function Zg(e){const r=e[no];return r?r.type_:e1(e)?1:t1(e)?2:r1(e)?3:0}var H8=(e,r,t=Zg(e))=>t===2?e.has(r):Go[Zb].hasOwnProperty.call(e,r),uj=(e,r,t=Zg(e))=>t===2?e.get(r):e[r],Ov=(e,r,t,n=Zg(e))=>{n===2?e.set(r,t):n===3?e.add(t):e[r]=t};function JQ(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}var e1=Array.isArray,t1=e=>e instanceof Map,r1=e=>e instanceof Set,m3=e=>typeof e=="object",Yp=e=>typeof e=="function",Qw=e=>typeof e=="boolean";function eZ(e){const r=+e;return Number.isInteger(r)&&String(r)===e}var zu=e=>e.copy_||e.base_,g3=e=>e.modified_?e.copy_:e.base_;function dj(e,r){if(t1(e))return new Map(e);if(r1(e))return new Set(e);if(e1(e))return Array[Zb].slice.call(e);const t=IM(e);if(r===!0||r==="class_only"&&!t){const n=Go.getOwnPropertyDescriptors(e);delete n[no];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],c=n[o];c[ev]===!1&&(c[ev]=!0,c[cj]=!0),(c.get||c.set)&&(n[o]={[cj]:!0,[ev]:!0,[Pv]:c[Pv],[wg]:e[o]})}return Go.create(vm(e),n)}else{const n=vm(e);if(n!==null&&t)return{...e};const a=Go.create(n);return Go.assign(a,e)}}function y3(e,r=!1){return n1(e)||id(e)||!fc(e)||(Zg(e)>1&&Go.defineProperties(e,{set:mx,add:mx,clear:mx,delete:mx}),Go.freeze(e),r&&Jb(e,(t,n)=>{y3(n,!0)},!1)),e}function tZ(){nc(2)}var mx={[wg]:tZ};function n1(e){return e===null||!m3(e)?!0:Go.isFrozen(e)}var Mv="MapSet",hj="Patches",V8="ArrayMethods",RM={};function $f(e){const r=RM[e];return r||nc(0,e),r}var W8=e=>!!RM[e],_g,LM=()=>_g,rZ=(e,r)=>({drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:W8(Mv)?$f(Mv):void 0,arrayMethodsPlugin_:W8(V8)?$f(V8):void 0});function K8(e,r){r&&(e.patchPlugin_=$f(hj),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function fj(e){pj(e),e.drafts_.forEach(nZ),e.drafts_=null}function pj(e){e===_g&&(_g=e.parent_)}var G8=e=>_g=rZ(_g,e);function nZ(e){const r=e[no];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function X8(e,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];if(e!==void 0&&e!==t){t[no].modified_&&(fj(r),nc(4)),fc(e)&&(e=Y8(r,e));const{patchPlugin_:a}=r;a&&a.generateReplacementPatches_(t[no].base_,e,r)}else e=Y8(r,t);return sZ(r,e,!0),fj(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==MM?e:void 0}function Y8(e,r){if(n1(r))return r;const t=r[no];if(!t)return Iv(r,e.handledSet_,e);if(!s1(t,e))return r;if(!t.modified_)return t.base_;if(!t.finalized_){const{callbacks_:n}=t;if(n)for(;n.length>0;)n.pop()(e);BM(t,e)}return t.copy_}function sZ(e,r,t=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&y3(r,t)}function DM(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var s1=(e,r)=>e.scope_===r,aZ=[];function FM(e,r,t,n){const a=zu(e),i=e.type_;if(n!==void 0&&uj(a,n,i)===r){Ov(a,n,t,i);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;Jb(a,(u,l)=>{if(id(l)){const d=c.get(l)||[];d.push(u),c.set(l,d)}})}const o=e.draftLocations_.get(r)??aZ;for(const c of o)Ov(a,c,t,i)}function iZ(e,r,t){e.callbacks_.push(function(a){const i=r;if(!i||!s1(i,a))return;a.mapSetPlugin_?.fixSetContents(i);const o=g3(i);FM(e,i.draft_??i,o,t),BM(i,a)})}function BM(e,r){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=r;if(n){const a=n.getPath(e);a&&n.generatePatches_(e,a,r)}DM(e)}}function oZ(e,r,t){const{scope_:n}=e;if(id(t)){const a=t[no];s1(a,n)&&a.callbacks_.push(function(){tv(e);const o=g3(a);FM(e,t,o,r)})}else fc(t)&&e.callbacks_.push(function(){const i=zu(e);e.type_===3?i.has(t)&&Iv(t,n.handledSet_,n):uj(i,r,e.type_)===t&&n.drafts_.length>1&&(e.assigned_.get(r)??!1)===!0&&e.copy_&&Iv(uj(e.copy_,r,e.type_),n.handledSet_,n)})}function Iv(e,r,t){return!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||id(e)||r.has(e)||!fc(e)||n1(e)||(r.add(e),Jb(e,(n,a)=>{if(id(a)){const i=a[no];if(s1(i,t)){const o=g3(i);Ov(e,n,o,e.type_),DM(i)}}else fc(a)&&Iv(a,r,t)})),e}function lZ(e,r){const t=e1(e),n={type_:t?1:0,scope_:r?r.scope_:LM(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=Rv;t&&(a=[n],i=jg);const{revoke:o,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=o,[c,n]}var Rv={get(e,r){if(r===no)return e;let t=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof r=="string";if(n&&t?.isArrayOperationMethod(r))return t.createMethodInterceptor(e,r);const a=zu(e);if(!H8(a,r,e.type_))return cZ(e,a,r);const i=a[r];if(e.finalized_||!fc(i)||n&&e.operationMethod&&t?.isMutatingArrayMethod(e.operationMethod)&&eZ(r))return i;if(i===Zw(e.base_,r)){tv(e);const o=e.type_===1?+r:r,c=gj(e.scope_,i,e,o);return e.copy_[o]=c}return i},has(e,r){return r in zu(e)},ownKeys(e){return Reflect.ownKeys(zu(e))},set(e,r,t){const n=$M(zu(e),r);if(n?.set)return n.set.call(e.draft_,t),!0;if(!e.modified_){const a=Zw(zu(e),r),i=a?.[no];if(i&&i.base_===t)return e.copy_[r]=t,e.assigned_.set(r,!1),!0;if(JQ(t,a)&&(t!==void 0||H8(e.base_,r,e.type_)))return!0;tv(e),mj(e)}return e.copy_[r]===t&&(t!==void 0||r in e.copy_)||Number.isNaN(t)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=t,e.assigned_.set(r,!0),oZ(e,r,t)),!0},deleteProperty(e,r){return tv(e),Zw(e.base_,r)!==void 0||r in e.base_?(e.assigned_.set(r,!1),mj(e)):e.assigned_.delete(r),e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const t=zu(e),n=Reflect.getOwnPropertyDescriptor(t,r);return n&&{[ev]:!0,[cj]:e.type_!==1||r!=="length",[Pv]:n[Pv],[wg]:t[r]}},defineProperty(){nc(11)},getPrototypeOf(e){return vm(e.base_)},setPrototypeOf(){nc(12)}},jg={};for(let e in Rv){let r=Rv[e];jg[e]=function(){const t=arguments;return t[0]=t[0][0],r.apply(this,t)}}jg.deleteProperty=function(e,r){return jg.set.call(this,e,r,void 0)};jg.set=function(e,r,t){return Rv.set.call(this,e[0],r,t,e[0])};function Zw(e,r){const t=e[no];return(t?zu(t):e)[r]}function cZ(e,r,t){const n=$M(r,t);return n?wg in n?n[wg]:n.get?.call(e.draft_):void 0}function $M(e,r){if(!(r in e))return;let t=vm(e);for(;t;){const n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;t=vm(t)}}function mj(e){e.modified_||(e.modified_=!0,e.parent_&&mj(e.parent_))}function tv(e){e.copy_||(e.assigned_=new Map,e.copy_=dj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var uZ=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,n,a)=>{if(Yp(t)&&!Yp(n)){const o=n;n=t;const c=this;return function(l=o,...d){return c.produce(l,f=>n.call(this,f,...d))}}Yp(n)||nc(6),a!==void 0&&!Yp(a)&&nc(7);let i;if(fc(t)){const o=G8(this),c=gj(o,t,void 0);let u=!0;try{i=n(c),u=!1}finally{u?fj(o):pj(o)}return K8(o,a),X8(i,o)}else if(!t||!m3(t)){if(i=n(t),i===void 0&&(i=t),i===MM&&(i=void 0),this.autoFreeze_&&y3(i,!0),a){const o=[],c=[];$f(hj).generateReplacementPatches_(t,i,{patches_:o,inversePatches_:c}),a(o,c)}return i}else nc(1,t)},this.produceWithPatches=(t,n)=>{if(Yp(t))return(c,...u)=>this.produceWithPatches(c,l=>t(l,...u));let a,i;return[this.produce(t,n,(c,u)=>{a=c,i=u}),a,i]},Qw(r?.autoFreeze)&&this.setAutoFreeze(r.autoFreeze),Qw(r?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(r.useStrictShallowCopy),Qw(r?.useStrictIteration)&&this.setUseStrictIteration(r.useStrictIteration)}createDraft(r){fc(r)||nc(8),id(r)&&(r=cc(r));const t=G8(this),n=gj(t,r,void 0);return n[no].isManual_=!0,pj(t),n}finishDraft(r,t){const n=r&&r[no];(!n||!n.isManual_)&&nc(9);const{scope_:a}=n;return K8(a,t),X8(void 0,a)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}setUseStrictIteration(r){this.useStrictIteration_=r}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(r,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(i.path.length===0&&i.op==="replace"){r=i.value;break}}n>-1&&(t=t.slice(n+1));const a=$f(hj).applyPatches_;return id(r)?a(r,t):this.produce(r,i=>a(i,t))}};function gj(e,r,t,n){const[a,i]=t1(r)?$f(Mv).proxyMap_(r,t):r1(r)?$f(Mv).proxySet_(r,t):lZ(r,t);return(t?.scope_??LM()).drafts_.push(a),i.callbacks_=t?.callbacks_??[],i.key_=n,t&&n!==void 0?iZ(t,i,n):i.callbacks_.push(function(u){u.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:l}=u;i.modified_&&l&&l.generatePatches_(i,[],u)}),a}function cc(e){return id(e)||nc(10,e),qM(e)}function qM(e){if(!fc(e)||n1(e))return e;const r=e[no];let t,n=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=dj(e,r.scope_.immer_.useStrictShallowCopy_),n=r.scope_.immer_.shouldUseStrictIteration()}else t=dj(e,!0);return Jb(t,(a,i)=>{Ov(t,a,qM(i))},n),r&&(r.finalized_=!1),t}var dZ=new uZ,zM=dZ.produce;function UM(e){return({dispatch:t,getState:n})=>a=>i=>typeof i=="function"?i(t,n,e):a(i)}var hZ=UM(),fZ=UM,pZ=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ev:Ev.apply(null,arguments)};function Nl(e,r){function t(...n){if(r){let a=r(...n);if(!a)throw new Error(Yo(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return t.toString=()=>`${e}`,t.type=e,t.match=n=>OM(n)&&n.type===e,t}var HM=class W0 extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,W0.prototype)}static get[Symbol.species](){return W0}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new W0(...r[0].concat(this)):new W0(...r.concat(this))}};function Q8(e){return fc(e)?zM(e,()=>{}):e}function gx(e,r,t){return e.has(r)?e.get(r):e.set(r,t(r)).get(r)}function mZ(e){return typeof e=="boolean"}var gZ=()=>function(r){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=r??{};let o=new HM;return t&&(mZ(t)?o.push(hZ):o.push(fZ(t.extraArgument))),o},VM="RTK_autoBatch",xs=()=>e=>({payload:e,meta:{[VM]:!0}}),Z8=e=>r=>{setTimeout(r,e)},WM=(e={type:"raf"})=>r=>(...t)=>{const n=r(...t);let a=!0,i=!1,o=!1;const c=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Z8(10):e.type==="callback"?e.queueNotification:Z8(e.timeout),l=()=>{o=!1,i&&(i=!1,c.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),p=n.subscribe(f);return c.add(d),()=>{p(),c.delete(d)}},dispatch(d){try{return a=!d?.meta?.[VM],i=!a,i&&(o||(o=!0,u(l))),n.dispatch(d)}finally{a=!0}}})},yZ=e=>function(t){const{autoBatch:n=!0}=t??{};let a=new HM(e);return n&&a.push(WM(typeof n=="object"?n:void 0)),a};function xZ(e){const r=gZ(),{reducer:t=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let c;if(typeof t=="function")c=t;else if(p3(t))c=PM(t);else throw new Error(Yo(1));let u;typeof n=="function"?u=n(r):u=r();let l=Ev;a&&(l=pZ({trace:!1,...typeof a=="object"&&a}));const d=QQ(...u),f=yZ(d);let p=typeof o=="function"?o(f):f();const h=l(...p);return TM(c,i,h)}function KM(e){const r={},t=[];let n;const a={addCase(i,o){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(Yo(28));if(c in r)throw new Error(Yo(29));return r[c]=o,a},addAsyncThunk(i,o){return o.pending&&(r[i.pending.type]=o.pending),o.rejected&&(r[i.rejected.type]=o.rejected),o.fulfilled&&(r[i.fulfilled.type]=o.fulfilled),o.settled&&t.push({matcher:i.settled,reducer:o.settled}),a},addMatcher(i,o){return t.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[r,t,n]}function vZ(e){return typeof e=="function"}function bZ(e,r){let[t,n,a]=KM(r),i;if(vZ(e))i=()=>Q8(e());else{const c=Q8(e);i=()=>c}function o(c=i(),u){let l=[t[u.type],...n.filter(({matcher:d})=>d(u)).map(({reducer:d})=>d)];return l.filter(d=>!!d).length===0&&(l=[a]),l.reduce((d,f)=>{if(f)if(id(d)){const h=f(d,u);return h===void 0?d:h}else{if(fc(d))return zM(d,p=>f(p,u));{const p=f(d,u);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},c)}return o.getInitialState=i,o}var wZ="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_Z=(e=21)=>{let r="",t=e;for(;t--;)r+=wZ[Math.random()*64|0];return r},jZ=Symbol.for("rtk-slice-createasyncthunk");function NZ(e,r){return`${e}/${r}`}function kZ({creators:e}={}){const r=e?.asyncThunk?.[jZ];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(Yo(11));const o=(typeof n.reducers=="function"?n.reducers(CZ()):n.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(w,_){const A=typeof w=="string"?w:w.type;if(!A)throw new Error(Yo(12));if(A in u.sliceCaseReducersByType)throw new Error(Yo(13));return u.sliceCaseReducersByType[A]=_,l},addMatcher(w,_){return u.sliceMatchers.push({matcher:w,reducer:_}),l},exposeAction(w,_){return u.actionCreators[w]=_,l},exposeCaseReducer(w,_){return u.sliceCaseReducersByName[w]=_,l}};c.forEach(w=>{const _=o[w],A={reducerName:w,type:NZ(a,w),createNotation:typeof n.reducers=="function"};EZ(_)?PZ(A,_,l,r):AZ(A,_,l)});function d(){const[w={},_=[],A=void 0]=typeof n.extraReducers=="function"?KM(n.extraReducers):[n.extraReducers],P={...w,...u.sliceCaseReducersByType};return bZ(n.initialState,B=>{for(let T in P)B.addCase(T,P[T]);for(let T of u.sliceMatchers)B.addMatcher(T.matcher,T.reducer);for(let T of _)B.addMatcher(T.matcher,T.reducer);A&&B.addDefaultCase(A)})}const f=w=>w,p=new Map,h=new WeakMap;let y;function g(w,_){return y||(y=d()),y(w,_)}function m(){return y||(y=d()),y.getInitialState()}function x(w,_=!1){function A(B){let T=B[w];return typeof T>"u"&&_&&(T=gx(h,A,m)),T}function P(B=f){const T=gx(p,_,()=>new WeakMap);return gx(T,B,()=>{const I={};for(const[U,H]of Object.entries(n.selectors??{}))I[U]=SZ(H,B,()=>gx(h,B,m),_);return I})}return{reducerPath:w,getSelectors:P,get selectors(){return P(A)},selectSlice:A}}const v={name:a,reducer:g,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:m,...x(i),injectInto(w,{reducerPath:_,...A}={}){const P=_??i;return w.inject({reducerPath:P,reducer:g},A),{...v,...x(P,!0)}}};return v}}function SZ(e,r,t,n){function a(i,...o){let c=r(i);return typeof c>"u"&&n&&(c=t()),e(c,...o)}return a.unwrapped=e,a}var No=kZ();function CZ(){function e(r,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...t}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...t){return r(...t)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:t}},asyncThunk:e}}function AZ({type:e,reducerName:r,createNotation:t},n,a){let i,o;if("reducer"in n){if(t&&!TZ(n))throw new Error(Yo(17));i=n.reducer,o=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(r,i).exposeAction(r,o?Nl(e,o):Nl(e))}function EZ(e){return e._reducerDefinitionType==="asyncThunk"}function TZ(e){return e._reducerDefinitionType==="reducerWithPrepare"}function PZ({type:e,reducerName:r},t,n,a){if(!a)throw new Error(Yo(18));const{payloadCreator:i,fulfilled:o,pending:c,rejected:u,settled:l,options:d}=t,f=a(e,i,d);n.exposeAction(r,f),o&&n.addCase(f.fulfilled,o),c&&n.addCase(f.pending,c),u&&n.addCase(f.rejected,u),l&&n.addMatcher(f.settled,l),n.exposeCaseReducer(r,{fulfilled:o||yx,pending:c||yx,rejected:u||yx,settled:l||yx})}function yx(){}var OZ="task",GM="listener",XM="completed",x3="cancelled",MZ=`task-${x3}`,IZ=`task-${XM}`,yj=`${GM}-${x3}`,RZ=`${GM}-${XM}`,a1=class{constructor(e){this.code=e,this.message=`${OZ} ${x3} (reason: ${e})`}name="TaskAbortError";message},v3=(e,r)=>{if(typeof e!="function")throw new TypeError(Yo(32))},Lv=()=>{},YM=(e,r=Lv)=>(e.catch(r),e),QM=(e,r)=>(e.addEventListener("abort",r,{once:!0}),()=>e.removeEventListener("abort",r)),jf=e=>{if(e.aborted)throw new a1(e.reason)};function ZM(e,r){let t=Lv;return new Promise((n,a)=>{const i=()=>a(new a1(e.reason));if(e.aborted){i();return}t=QM(e,i),r.finally(()=>t()).then(n,a)}).finally(()=>{t=Lv})}var LZ=async(e,r)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(t){return{status:t instanceof a1?"cancelled":"rejected",error:t}}finally{r?.()}},Dv=e=>r=>YM(ZM(e,r).then(t=>(jf(e),t))),JM=e=>{const r=Dv(e);return t=>r(new Promise(n=>setTimeout(n,t)))},{assign:om}=Object,J8={},i1="listenerMiddleware",DZ=(e,r)=>{const t=n=>QM(e,()=>n.abort(e.reason));return(n,a)=>{v3(n);const i=new AbortController;t(i);const o=LZ(async()=>{jf(e),jf(i.signal);const c=await n({pause:Dv(i.signal),delay:JM(i.signal),signal:i.signal});return jf(i.signal),c},()=>i.abort(IZ));return a?.autoJoin&&r.push(o.catch(Lv)),{result:Dv(e)(o),cancel(){i.abort(MZ)}}}},FZ=(e,r)=>{const t=async(n,a)=>{jf(r);let i=()=>{};const c=[new Promise((u,l)=>{let d=e({predicate:n,effect:(f,p)=>{p.unsubscribe(),u([f,p.getState(),p.getOriginalState()])}});i=()=>{d(),l()}})];a!=null&&c.push(new Promise(u=>setTimeout(u,a,null)));try{const u=await ZM(r,Promise.race(c));return jf(r),u}finally{i()}};return(n,a)=>YM(t(n,a))},eI=e=>{let{type:r,actionCreator:t,matcher:n,predicate:a,effect:i}=e;if(r)a=Nl(r).match;else if(t)r=t.type,a=t.match;else if(n)a=n;else if(!a)throw new Error(Yo(21));return v3(i),{predicate:a,type:r,effect:i}},tI=om(e=>{const{type:r,predicate:t,effect:n}=eI(e);return{id:_Z(),effect:n,type:r,predicate:t,pending:new Set,unsubscribe:()=>{throw new Error(Yo(22))}}},{withTypes:()=>tI}),eC=(e,r)=>{const{type:t,effect:n,predicate:a}=eI(r);return Array.from(e.values()).find(i=>(typeof t=="string"?i.type===t:i.predicate===a)&&i.effect===n)},xj=e=>{e.pending.forEach(r=>{r.abort(yj)})},BZ=(e,r)=>()=>{for(const t of r.keys())xj(t);e.clear()},tC=(e,r,t)=>{try{e(r,t)}catch(n){setTimeout(()=>{throw n},0)}},rI=om(Nl(`${i1}/add`),{withTypes:()=>rI}),$Z=Nl(`${i1}/removeAll`),nI=om(Nl(`${i1}/remove`),{withTypes:()=>nI}),qZ=(...e)=>{console.error(`${i1}/error`,...e)},Jg=(e={})=>{const r=new Map,t=new Map,n=h=>{const y=t.get(h)??0;t.set(h,y+1)},a=h=>{const y=t.get(h)??1;y===1?t.delete(h):t.set(h,y-1)},{extra:i,onError:o=qZ}=e;v3(o);const c=h=>(h.unsubscribe=()=>r.delete(h.id),r.set(h.id,h),y=>{h.unsubscribe(),y?.cancelActive&&xj(h)}),u=h=>{const y=eC(r,h)??tI(h);return c(y)};om(u,{withTypes:()=>u});const l=h=>{const y=eC(r,h);return y&&(y.unsubscribe(),h.cancelActive&&xj(y)),!!y};om(l,{withTypes:()=>l});const d=async(h,y,g,m)=>{const x=new AbortController,v=FZ(u,x.signal),w=[];try{h.pending.add(x),n(h),await Promise.resolve(h.effect(y,om({},g,{getOriginalState:m,condition:(_,A)=>v(_,A).then(Boolean),take:v,delay:JM(x.signal),pause:Dv(x.signal),extra:i,signal:x.signal,fork:DZ(x.signal,w),unsubscribe:h.unsubscribe,subscribe:()=>{r.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((_,A,P)=>{_!==x&&(_.abort(yj),P.delete(_))})},cancel:()=>{x.abort(yj),h.pending.delete(x)},throwIfCancelled:()=>{jf(x.signal)}})))}catch(_){_ instanceof a1||tC(o,_,{raisedBy:"effect"})}finally{await Promise.all(w),x.abort(RZ),a(h),h.pending.delete(x)}},f=BZ(r,t);return{middleware:h=>y=>g=>{if(!OM(g))return y(g);if(rI.match(g))return u(g.payload);if($Z.match(g)){f();return}if(nI.match(g))return l(g.payload);let m=h.getState();const x=()=>{if(m===J8)throw new Error(Yo(23));return m};let v;try{if(v=y(g),r.size>0){const w=h.getState(),_=Array.from(r.values());for(const A of _){let P=!1;try{P=A.predicate(g,w,m)}catch(B){P=!1,tC(o,B,{raisedBy:"predicate"})}P&&d(A,g,h,x)}}}finally{m=J8}return v},startListening:u,stopListening:l,clearListeners:f}};function Yo(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var zZ={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sI=No({name:"chartLayout",initialState:zZ,reducers:{setLayout(e,r){e.layoutType=r.payload},setChartSize(e,r){e.width=r.payload.width,e.height=r.payload.height},setMargin(e,r){var t,n,a,i;e.margin.top=(t=r.payload.top)!==null&&t!==void 0?t:0,e.margin.right=(n=r.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=r.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=r.payload.left)!==null&&i!==void 0?i:0},setScale(e,r){e.scale=r.payload}}}),{setMargin:UZ,setLayout:HZ,setChartSize:VZ,setScale:WZ}=sI.actions,KZ=sI.reducer;function aI(e,r,t){return Array.isArray(e)&&e&&r+t!==0?e.slice(r,t+1):e}function un(e){return Number.isFinite(e)}function eu(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function rC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function tm(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?rC(Object(t),!0).forEach(function(n){GZ(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):rC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function GZ(e,r,t){return(r=XZ(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function XZ(e){var r=YZ(e,"string");return typeof r=="symbol"?r:r+""}function YZ(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Hn(e,r,t){return Ms(e)||Ms(r)?t:Jc(r)?Ff(e,r,t):typeof r=="function"?r(e):t}var QZ=(e,r,t)=>{if(r&&t){var{width:n,height:a}=t,{align:i,verticalAlign:o,layout:c}=r;if((c==="vertical"||c==="horizontal"&&o==="middle")&&i!=="center"&&Vt(e[i]))return tm(tm({},e),{},{[i]:e[i]+(n||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&o!=="middle"&&Vt(e[o]))return tm(tm({},e),{},{[o]:e[o]+(a||0)})}return e},gd=(e,r)=>e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis",iI=(e,r,t,n)=>{if(n)return e.map(c=>c.coordinate);var a,i,o=e.map(c=>(c.coordinate===r&&(a=!0),c.coordinate===t&&(i=!0),c.coordinate));return a||o.push(r),i||o.push(t),o},oI=(e,r,t)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:o,realScaleType:c,isCategorical:u,categoricalDomain:l,tickCount:d,ticks:f,niceTicks:p,axisType:h}=e;if(!o)return null;var y=c==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=a==="category"&&o.bandwidth?o.bandwidth()/y:0;if(g=h==="angleAxis"&&i&&i.length>=2?ni(i[0]-i[1])*2*g:g,f||p){var m=(f||p||[]).map((x,v)=>{var w=n?n.indexOf(x):x,_=o.map(w);return un(_)?{coordinate:_+g,value:x,offset:g,index:v}:null}).filter(vo);return m}return u&&l?l.map((x,v)=>{var w=o.map(x);return un(w)?{coordinate:w+g,value:x,index:v,offset:g}:null}).filter(vo):o.ticks&&d!=null?o.ticks(d).map((x,v)=>{var w=o.map(x);return un(w)?{coordinate:w+g,value:x,index:v,offset:g}:null}).filter(vo):o.domain().map((x,v)=>{var w=o.map(x);return un(w)?{coordinate:w+g,value:n?n[x]:x,index:v,offset:g}:null}).filter(vo)},ZZ=(e,r)=>{if(!r||r.length!==2||!Vt(r[0])||!Vt(r[1]))return e;var t=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]),a=[e[0],e[1]];return(!Vt(e[0])||e[0]<t)&&(a[0]=t),(!Vt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<t&&(a[1]=t),a},JZ=e=>{var r,t=e.length;if(!(t<=0)){var n=(r=e[0])===null||r===void 0?void 0:r.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,o=0,c=0;c<t;++c){var u=e[c],l=u?.[a];if(l!=null){var d=l[1],f=l[0],p=Zc(d)?f:d;p>=0?(l[0]=i,i+=p,l[1]=i):(l[0]=o,o+=p,l[1]=o)}}}},eJ=e=>{var r,t=e.length;if(!(t<=0)){var n=(r=e[0])===null||r===void 0?void 0:r.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,o=0;o<t;++o){var c=e[o],u=c?.[a];if(u!=null){var l=Zc(u[1])?u[0]:u[1];l>=0?(u[0]=i,i+=l,u[1]=i):(u[0]=0,u[1]=0)}}}},tJ={sign:JZ,expand:wY,none:Df,silhouette:_Y,wiggle:jY,positive:eJ},rJ=(e,r,t)=>{var n,a=(n=tJ[t])!==null&&n!==void 0?n:Df,i=bY().keys(r).value((c,u)=>Number(Hn(c,u,0))).order(oj).offset(a),o=i(e);return o.forEach((c,u)=>{c.forEach((l,d)=>{var f=Hn(e[d],r[u],0);Array.isArray(f)&&f.length===2&&Vt(f[0])&&Vt(f[1])&&(l[0]=f[0],l[1]=f[1])})}),o};function nJ(e){return e==null?void 0:String(e)}function nC(e){var{axis:r,ticks:t,bandSize:n,entry:a,index:i,dataKey:o}=e;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Ms(a[r.dataKey])){var c=fM(t,"value",a[r.dataKey]);if(c)return c.coordinate+n/2}return t!=null&&t[i]?t[i].coordinate+n/2:null}var u=Hn(a,Ms(o)?r.dataKey:o),l=r.scale.map(u);return Vt(l)?l:null}var sC=e=>{var{axis:r,ticks:t,offset:n,bandSize:a,entry:i,index:o}=e;if(r.type==="category")return t[o]?t[o].coordinate+n:null;var c=Hn(i,r.dataKey,r.scale.domain()[o]);if(Ms(c))return null;var u=r.scale.map(c);return Vt(u)?u-a/2+n:null},sJ=e=>{var{numericAxis:r}=e,t=r.scale.domain();if(r.type==="number"){var n=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]);return n<=0&&a>=0?0:a<0?a:n}return t[0]},aJ=e=>{var r=e.flat(2).filter(Vt);return[Math.min(...r),Math.max(...r)]},iJ=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],oJ=(e,r,t)=>{if(e!=null)return iJ(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:o}=i,c=o.reduce((u,l)=>{var d=aI(l,r,t),f=aJ(d);return!un(f[0])||!un(f[1])?u:[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},aC=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iC=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,bm=(e,r,t)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!t||n>0)return n}if(e&&r&&r.length>=2){for(var a=Qb(r,d=>d.coordinate),i=1/0,o=1,c=a.length;o<c;o++){var u=a[o],l=a[o-1];i=Math.min((u?.coordinate||0)-(l?.coordinate||0),i)}return i===1/0?0:i}return t?void 0:0};function oC(e){var{tooltipEntrySettings:r,dataKey:t,payload:n,value:a,name:i}=e;return tm(tm({},r),{},{dataKey:t,payload:n,value:a,name:i})}function Dm(e,r){if(e)return String(e);if(typeof r=="string")return r}var lJ=(e,r)=>{if(r==="horizontal")return e.chartX;if(r==="vertical")return e.chartY},cJ=(e,r)=>r==="centric"?e.angle:e.radius,yd=e=>e.layout.width,xd=e=>e.layout.height,uJ=e=>e.layout.scale,lI=e=>e.layout.margin,o1=Xe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),l1=Xe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),cI="data-recharts-item-index",uI="data-recharts-item-id",ey=60;function lC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function xx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lC(Object(t),!0).forEach(function(n){dJ(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function dJ(e,r,t){return(r=hJ(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function hJ(e){var r=fJ(e,"string");return typeof r=="symbol"?r:r+""}function fJ(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var pJ=e=>e.brush.height;function mJ(e){var r=l1(e);return r.reduce((t,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:ey;return t+a}return t},0)}function gJ(e){var r=l1(e);return r.reduce((t,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:ey;return t+a}return t},0)}function yJ(e){var r=o1(e);return r.reduce((t,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?t+n.height:t,0)}function xJ(e){var r=o1(e);return r.reduce((t,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?t+n.height:t,0)}var qa=Xe([yd,xd,lI,pJ,mJ,gJ,yJ,xJ,AM,HQ],(e,r,t,n,a,i,o,c,u,l)=>{var d={left:(t.left||0)+a,right:(t.right||0)+i},f={top:(t.top||0)+o,bottom:(t.bottom||0)+c},p=xx(xx({},f),d),h=p.bottom;p.bottom+=n,p=QZ(p,u,l);var y=e-p.left-p.right,g=r-p.top-p.bottom;return xx(xx({brushBottom:h},p),{},{width:Math.max(y,0),height:Math.max(g,0)})}),vJ=Xe(qa,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),b3=Xe(yd,xd,(e,r)=>({x:0,y:0,width:e,height:r})),bJ=R.createContext(null),Ui=()=>R.useContext(bJ)!=null,c1=e=>e.brush,u1=Xe([c1,qa,lI],(e,r,t)=>({height:e.height,x:Vt(e.x)?e.x:r.left,y:Vt(e.y)?e.y:r.top+r.height+r.brushBottom-(t?.bottom||0),width:Vt(e.width)?e.width:r.width})),Jw={},e_={},t_={},cC;function wJ(){return cC||(cC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t,n,{signal:a,edges:i}={}){let o,c=null;const u=i!=null&&i.includes("leading"),l=i==null||i.includes("trailing"),d=()=>{c!==null&&(t.apply(o,c),o=void 0,c=null)},f=()=>{l&&d(),g()};let p=null;const h=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,f()},n)},y=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{y(),o=void 0,c=null},m=()=>{d()},x=function(...v){if(a?.aborted)return;o=this,c=v;const w=p==null;h(),u&&w&&d()};return x.schedule=h,x.cancel=g,x.flush=m,a?.addEventListener("abort",g,{once:!0}),x}e.debounce=r})(t_)),t_}var uC;function _J(){return uC||(uC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=wJ();function t(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:c=!0,maxWait:u}=i,l=Array(2);o&&(l[0]="leading"),c&&(l[1]="trailing");let d,f=null;const p=r.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:l}),h=function(...g){return u!=null&&(f===null&&(f=Date.now()),Date.now()-f>=u)?(d=n.apply(this,g),f=Date.now(),p.cancel(),p.schedule(),d):(p.apply(this,g),d)},y=()=>(p.flush(),d);return h.cancel=p.cancel,h.flush=y,h}e.debounce=t})(e_)),e_}var dC;function jJ(){return dC||(dC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=_J();function t(n,a=0,i={}){const{leading:o=!0,trailing:c=!0}=i;return r.debounce(n,a,{leading:o,maxWait:a,trailing:c})}e.throttle=t})(Jw)),Jw}var r_,hC;function NJ(){return hC||(hC=1,r_=jJ().throttle),r_}var kJ=NJ();const SJ=ru(kJ);var Fv=function(r,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(t===void 0&&console.warn("LogUtils requires an error message argument"),!r))if(t===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(t.replace(/%s/g,()=>a[o++]))}},Hc={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},dI=(e,r,t)=>{var{width:n=Hc.width,height:a=Hc.height,aspect:i,maxHeight:o}=t,c=Bf(n)?e:Number(n),u=Bf(a)?r:Number(a);return i&&i>0&&(c?u=c/i:u&&(c=u*i),o&&u!=null&&u>o&&(u=o)),{calculatedWidth:c,calculatedHeight:u}},CJ={width:0,height:0,overflow:"visible"},AJ={width:0,overflowX:"visible"},EJ={height:0,overflowY:"visible"},TJ={},PJ=e=>{var{width:r,height:t}=e,n=Bf(r),a=Bf(t);return n&&a?CJ:n?AJ:a?EJ:TJ};function OJ(e){var{width:r,height:t,aspect:n}=e,a=r,i=t;return a===void 0&&i===void 0?(a=Hc.width,i=Hc.height):a===void 0?a=n&&n>0?void 0:Hc.width:i===void 0&&(i=n&&n>0?void 0:Hc.height),{width:a,height:i}}function vj(){return vj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},vj.apply(null,arguments)}function fC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function pC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?fC(Object(t),!0).forEach(function(n){MJ(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function MJ(e,r,t){return(r=IJ(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function IJ(e){var r=RJ(e,"string");return typeof r=="symbol"?r:r+""}function RJ(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var hI=R.createContext(Hc.initialDimension);function LJ(e){return eu(e.width)&&eu(e.height)}function fI(e){var{children:r,width:t,height:n}=e,a=R.useMemo(()=>({width:t,height:n}),[t,n]);return LJ(a)?R.createElement(hI.Provider,{value:a},r):null}var w3=()=>R.useContext(hI),DJ=R.forwardRef((e,r)=>{var{aspect:t,initialDimension:n=Hc.initialDimension,width:a,height:i,minWidth:o=Hc.minWidth,minHeight:c,maxHeight:u,children:l,debounce:d=Hc.debounce,id:f,className:p,onResize:h,style:y={}}=e,g=R.useRef(null),m=R.useRef();m.current=h,R.useImperativeHandle(r,()=>g.current);var[x,v]=R.useState({containerWidth:n.width,containerHeight:n.height}),w=R.useCallback((T,I)=>{v(U=>{var H=Math.round(T),z=Math.round(I);return U.containerWidth===H&&U.containerHeight===z?U:{containerWidth:H,containerHeight:z}})},[]);R.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return Xf;var T=z=>{var O,L=z[0];if(L!=null){var{width:E,height:k}=L.contentRect;w(E,k),(O=m.current)===null||O===void 0||O.call(m,E,k)}};d>0&&(T=SJ(T,d,{trailing:!0,leading:!1}));var I=new ResizeObserver(T),{width:U,height:H}=g.current.getBoundingClientRect();return w(U,H),I.observe(g.current),()=>{I.disconnect()}},[w,d]);var{containerWidth:_,containerHeight:A}=x;Fv(!t||t>0,"The aspect(%s) must be greater than zero.",t);var{calculatedWidth:P,calculatedHeight:B}=dI(_,A,{width:a,height:i,aspect:t,maxHeight:u});return Fv(P!=null&&P>0||B!=null&&B>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,P,B,a,i,o,c,t),R.createElement("div",{id:f?"".concat(f):void 0,className:yn("recharts-responsive-container",p),style:pC(pC({},y),{},{width:a,height:i,minWidth:o,minHeight:c,maxHeight:u}),ref:g},R.createElement("div",{style:PJ({width:a,height:i})},R.createElement(fI,{width:P,height:B},l)))}),Wu=R.forwardRef((e,r)=>{var t=w3();if(eu(t.width)&&eu(t.height))return e.children;var{width:n,height:a}=OJ({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:o}=dI(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Vt(i)&&Vt(o)?R.createElement(fI,{width:i,height:o},e.children):R.createElement(DJ,vj({},e,{width:n,height:a,ref:r}))});function _3(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var d1=()=>{var e,r=Ui(),t=nr(vJ),n=nr(u1),a=(e=nr(c1))===null||e===void 0?void 0:e.padding;return!r||!n||!a?t:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},FJ={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pI=()=>{var e;return(e=nr(qa))!==null&&e!==void 0?e:FJ},j3=()=>nr(yd),N3=()=>nr(xd),BJ=()=>nr(e=>e.layout.margin),wn=e=>e.layout.layoutType,Yf=()=>nr(wn),mI=()=>{var e=Yf();if(e==="horizontal"||e==="vertical")return e},gI=e=>{var r=e.layout.layoutType;if(r==="centric"||r==="radial")return r},$J=()=>{var e=Yf();return e!==void 0},ty=e=>{var r=rs(),t=Ui(),{width:n,height:a}=e,i=w3(),o=n,c=a;return i&&(o=i.width>0?i.width:n,c=i.height>0?i.height:a),R.useEffect(()=>{!t&&eu(o)&&eu(c)&&r(VZ({width:o,height:c}))},[r,t,o,c]),null},yI=Symbol.for("immer-nothing"),mC=Symbol.for("immer-draftable"),Jo=Symbol.for("immer-state");function sc(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ng=Object.getPrototypeOf;function wm(e){return!!e&&!!e[Jo]}function qf(e){return e?xI(e)||Array.isArray(e)||!!e[mC]||!!e.constructor?.[mC]||ry(e)||f1(e):!1}var qJ=Object.prototype.constructor.toString(),gC=new WeakMap;function xI(e){if(!e||typeof e!="object")return!1;const r=Object.getPrototypeOf(e);if(r===null||r===Object.prototype)return!0;const t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;if(t===Object)return!0;if(typeof t!="function")return!1;let n=gC.get(t);return n===void 0&&(n=Function.toString.call(t),gC.set(t,n)),n===qJ}function Bv(e,r,t=!0){h1(e)===0?(t?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{r(a,e[a],e)}):e.forEach((n,a)=>r(a,n,e))}function h1(e){const r=e[Jo];return r?r.type_:Array.isArray(e)?1:ry(e)?2:f1(e)?3:0}function bj(e,r){return h1(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function vI(e,r,t){const n=h1(e);n===2?e.set(r,t):n===3?e.add(t):e[r]=t}function zJ(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function ry(e){return e instanceof Map}function f1(e){return e instanceof Set}function lf(e){return e.copy_||e.base_}function wj(e,r){if(ry(e))return new Map(e);if(f1(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const t=xI(e);if(r===!0||r==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(e);delete n[Jo];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],c=n[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[o]})}return Object.create(Ng(e),n)}else{const n=Ng(e);if(n!==null&&t)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function k3(e,r=!1){return p1(e)||wm(e)||!qf(e)||(h1(e)>1&&Object.defineProperties(e,{set:vx,add:vx,clear:vx,delete:vx}),Object.freeze(e),r&&Object.values(e).forEach(t=>k3(t,!0))),e}function UJ(){sc(2)}var vx={value:UJ};function p1(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var HJ={};function zf(e){const r=HJ[e];return r||sc(0,e),r}var kg;function bI(){return kg}function VJ(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yC(e,r){r&&(zf("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function _j(e){jj(e),e.drafts_.forEach(WJ),e.drafts_=null}function jj(e){e===kg&&(kg=e.parent_)}function xC(e){return kg=VJ(kg,e)}function WJ(e){const r=e[Jo];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function vC(e,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];return e!==void 0&&e!==t?(t[Jo].modified_&&(_j(r),sc(4)),qf(e)&&(e=$v(r,e),r.parent_||qv(r,e)),r.patches_&&zf("Patches").generateReplacementPatches_(t[Jo].base_,e,r.patches_,r.inversePatches_)):e=$v(r,t,[]),_j(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==yI?e:void 0}function $v(e,r,t){if(p1(r))return r;const n=e.immer_.shouldUseStrictIteration(),a=r[Jo];if(!a)return Bv(r,(i,o)=>bC(e,a,r,i,o,t),n),r;if(a.scope_!==e)return r;if(!a.modified_)return qv(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let o=i,c=!1;a.type_===3&&(o=new Set(i),i.clear(),c=!0),Bv(o,(u,l)=>bC(e,a,i,u,l,t,c),n),qv(e,i,!1),t&&e.patches_&&zf("Patches").generatePatches_(a,t,e.patches_,e.inversePatches_)}return a.copy_}function bC(e,r,t,n,a,i,o){if(a==null||typeof a!="object"&&!o)return;const c=p1(a);if(!(c&&!o)){if(wm(a)){const u=i&&r&&r.type_!==3&&!bj(r.assigned_,n)?i.concat(n):void 0,l=$v(e,a,u);if(vI(t,n,l),wm(l))e.canAutoFreeze_=!1;else return}else o&&t.add(a);if(qf(a)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||r&&r.base_&&r.base_[n]===a&&c)return;$v(e,a),(!r||!r.scope_.parent_)&&typeof n!="symbol"&&(ry(t)?t.has(n):Object.prototype.propertyIsEnumerable.call(t,n))&&qv(e,a)}}}function qv(e,r,t=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&k3(r,t)}function KJ(e,r){const t=Array.isArray(e),n={type_:t?1:0,scope_:r?r.scope_:bI(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=S3;t&&(a=[n],i=Sg);const{revoke:o,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=o,c}var S3={get(e,r){if(r===Jo)return e;const t=lf(e);if(!bj(t,r))return GJ(e,t,r);const n=t[r];return e.finalized_||!qf(n)?n:n===n_(e.base_,r)?(s_(e),e.copy_[r]=kj(n,e)):n},has(e,r){return r in lf(e)},ownKeys(e){return Reflect.ownKeys(lf(e))},set(e,r,t){const n=wI(lf(e),r);if(n?.set)return n.set.call(e.draft_,t),!0;if(!e.modified_){const a=n_(lf(e),r),i=a?.[Jo];if(i&&i.base_===t)return e.copy_[r]=t,e.assigned_[r]=!1,!0;if(zJ(t,a)&&(t!==void 0||bj(e.base_,r)))return!0;s_(e),Nj(e)}return e.copy_[r]===t&&(t!==void 0||r in e.copy_)||Number.isNaN(t)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=t,e.assigned_[r]=!0),!0},deleteProperty(e,r){return n_(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,s_(e),Nj(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const t=lf(e),n=Reflect.getOwnPropertyDescriptor(t,r);return n&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:n.enumerable,value:t[r]}},defineProperty(){sc(11)},getPrototypeOf(e){return Ng(e.base_)},setPrototypeOf(){sc(12)}},Sg={};Bv(S3,(e,r)=>{Sg[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Sg.deleteProperty=function(e,r){return Sg.set.call(this,e,r,void 0)};Sg.set=function(e,r,t){return S3.set.call(this,e[0],r,t,e[0])};function n_(e,r){const t=e[Jo];return(t?lf(t):e)[r]}function GJ(e,r,t){const n=wI(r,t);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function wI(e,r){if(!(r in e))return;let t=Ng(e);for(;t;){const n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;t=Ng(t)}}function Nj(e){e.modified_||(e.modified_=!0,e.parent_&&Nj(e.parent_))}function s_(e){e.copy_||(e.copy_=wj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var XJ=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(r,t,n)=>{if(typeof r=="function"&&typeof t!="function"){const i=t;t=r;const o=this;return function(u=i,...l){return o.produce(u,d=>t.call(this,d,...l))}}typeof t!="function"&&sc(6),n!==void 0&&typeof n!="function"&&sc(7);let a;if(qf(r)){const i=xC(this),o=kj(r,void 0);let c=!0;try{a=t(o),c=!1}finally{c?_j(i):jj(i)}return yC(i,n),vC(a,i)}else if(!r||typeof r!="object"){if(a=t(r),a===void 0&&(a=r),a===yI&&(a=void 0),this.autoFreeze_&&k3(a,!0),n){const i=[],o=[];zf("Patches").generateReplacementPatches_(r,a,i,o),n(i,o)}return a}else sc(1,r)},this.produceWithPatches=(r,t)=>{if(typeof r=="function")return(o,...c)=>this.produceWithPatches(o,u=>r(u,...c));let n,a;return[this.produce(r,t,(o,c)=>{n=o,a=c}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){qf(e)||sc(8),wm(e)&&(e=YJ(e));const r=xC(this),t=kj(e,void 0);return t[Jo].isManual_=!0,jj(r),t}finishDraft(e,r){const t=e&&e[Jo];(!t||!t.isManual_)&&sc(9);const{scope_:n}=t;return yC(n,r),vC(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let t;for(t=r.length-1;t>=0;t--){const a=r[t];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}t>-1&&(r=r.slice(t+1));const n=zf("Patches").applyPatches_;return wm(e)?n(e,r):this.produce(e,a=>n(a,r))}};function kj(e,r){const t=ry(e)?zf("MapSet").proxyMap_(e,r):f1(e)?zf("MapSet").proxySet_(e,r):KJ(e,r);return(r?r.scope_:bI()).drafts_.push(t),t}function YJ(e){return wm(e)||sc(10,e),_I(e)}function _I(e){if(!qf(e)||p1(e))return e;const r=e[Jo];let t,n=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=wj(e,r.scope_.immer_.useStrictShallowCopy_),n=r.scope_.immer_.shouldUseStrictIteration()}else t=wj(e,!0);return Bv(t,(a,i)=>{vI(t,a,_I(i))},n),r&&(r.finalized_=!1),t}var QJ=new XJ;QJ.produce;var ZJ={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},jI=No({name:"legend",initialState:ZJ,reducers:{setLegendSize(e,r){e.size.width=r.payload.width,e.size.height=r.payload.height},setLegendSettings(e,r){e.settings.align=r.payload.align,e.settings.layout=r.payload.layout,e.settings.verticalAlign=r.payload.verticalAlign,e.settings.itemSorter=r.payload.itemSorter},addLegendPayload:{reducer(e,r){e.payload.push(r.payload)},prepare:xs()},replaceLegendPayload:{reducer(e,r){var{prev:t,next:n}=r.payload,a=cc(e).payload.indexOf(t);a>-1&&(e.payload[a]=n)},prepare:xs()},removeLegendPayload:{reducer(e,r){var t=cc(e).payload.indexOf(r.payload);t>-1&&e.payload.splice(t,1)},prepare:xs()}}}),{setLegendSize:wC,setLegendSettings:JJ,addLegendPayload:NI,replaceLegendPayload:kI,removeLegendPayload:SI}=jI.actions,eee=jI.reducer,tee=["contextPayload"];function Sj(){return Sj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Sj.apply(null,arguments)}function _C(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function _m(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_C(Object(t),!0).forEach(function(n){ree(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_C(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ree(e,r,t){return(r=nee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function nee(e){var r=see(e,"string");return typeof r=="symbol"?r:r+""}function see(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function aee(e,r){if(e==null)return{};var t,n,a=iee(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function iee(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function oee(e){return e.value}function lee(e){var{contextPayload:r}=e,t=aee(e,tee),n=NM(r,e.payloadUniqBy,oee),a=_m(_m({},t),{},{payload:n});return R.isValidElement(e.content)?R.cloneElement(e.content,a):typeof e.content=="function"?R.createElement(e.content,a):R.createElement(ZY,a)}function cee(e,r,t,n,a,i){var{layout:o,align:c,verticalAlign:u}=r,l,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(c==="center"&&o==="vertical"?l={left:((n||0)-i.width)/2}:l=c==="right"?{right:t&&t.right||0}:{left:t&&t.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(u==="middle"?d={top:((a||0)-i.height)/2}:d=u==="bottom"?{bottom:t&&t.bottom||0}:{top:t&&t.top||0}),_m(_m({},l),d)}function uee(e){var r=rs();return R.useEffect(()=>{r(JJ(e))},[r,e]),null}function dee(e){var r=rs();return R.useEffect(()=>(r(wC(e)),()=>{r(wC({width:0,height:0}))}),[r,e]),null}function hee(e,r,t,n){return e==="vertical"&&r!=null?{height:r}:e==="horizontal"?{width:t||n}:null}var fee={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function lm(e){var r=Sa(e,fee),t=KQ(),n=HX(),a=BJ(),{width:i,height:o,wrapperStyle:c,portal:u}=r,[l,d]=EM([t]),f=j3(),p=N3();if(f==null||p==null)return null;var h=f-(a?.left||0)-(a?.right||0),y=hee(r.layout,o,i,h),g=u?c:_m(_m({position:"absolute",width:y?.width||i||"auto",height:y?.height||o||"auto"},cee(c,r,a,f,p,l)),c),m=u??n;if(m==null||t==null)return null;var x=R.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},R.createElement(uee,{layout:r.layout,align:r.align,verticalAlign:r.verticalAlign,itemSorter:r.itemSorter}),!u&&R.createElement(dee,{width:l.width,height:l.height}),R.createElement(lee,Sj({},r,y,{margin:a,chartWidth:f,chartHeight:p,contextPayload:t})));return B4.createPortal(x,m)}lm.displayName="Legend";function Cj(){return Cj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Cj.apply(null,arguments)}function jC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function _0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?jC(Object(t),!0).forEach(function(n){pee(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function pee(e,r,t){return(r=mee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function mee(e){var r=gee(e,"string");return typeof r=="symbol"?r:r+""}function gee(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function yee(e){return Array.isArray(e)&&Jc(e[0])&&Jc(e[1])?e.join(" ~ "):e}var Lp={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},xee=e=>{var{separator:r=Lp.separator,contentStyle:t,itemStyle:n,labelStyle:a=Lp.labelStyle,payload:i,formatter:o,itemSorter:c,wrapperClassName:u,labelClassName:l,label:d,labelFormatter:f,accessibilityLayer:p=Lp.accessibilityLayer}=e,h=()=>{if(i&&i.length){var A={padding:0,margin:0},P=(c?Qb(i,c):i).map((B,T)=>{if(B.type==="none")return null;var I=B.formatter||o||yee,{value:U,name:H}=B,z=U,O=H;if(I){var L=I(U,H,B,T,i);if(Array.isArray(L))[z,O]=L;else if(L!=null)z=L;else return null}var E=_0(_0({},Lp.itemStyle),{},{color:B.color||Lp.itemStyle.color},n);return R.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:E},Jc(O)?R.createElement("span",{className:"recharts-tooltip-item-name"},O):null,Jc(O)?R.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,R.createElement("span",{className:"recharts-tooltip-item-value"},z),R.createElement("span",{className:"recharts-tooltip-item-unit"},B.unit||""))});return R.createElement("ul",{className:"recharts-tooltip-item-list",style:A},P)}return null},y=_0(_0({},Lp.contentStyle),t),g=_0({margin:0},a),m=!Ms(d),x=m?d:"",v=yn("recharts-default-tooltip",u),w=yn("recharts-tooltip-label",l);m&&f&&i!==void 0&&i!==null&&(x=f(d,i));var _=p?{role:"status","aria-live":"assertive"}:{};return R.createElement("div",Cj({className:v,style:y},_),R.createElement("p",{className:w,style:g},R.isValidElement(x)?x:"".concat(x)),h())},j0="recharts-tooltip-wrapper",vee={visibility:"hidden"};function bee(e){var{coordinate:r,translateX:t,translateY:n}=e;return yn(j0,{["".concat(j0,"-right")]:Vt(t)&&r&&Vt(r.x)&&t>=r.x,["".concat(j0,"-left")]:Vt(t)&&r&&Vt(r.x)&&t<r.x,["".concat(j0,"-bottom")]:Vt(n)&&r&&Vt(r.y)&&n>=r.y,["".concat(j0,"-top")]:Vt(n)&&r&&Vt(r.y)&&n<r.y})}function NC(e){var{allowEscapeViewBox:r,coordinate:t,key:n,offset:a,position:i,reverseDirection:o,tooltipDimension:c,viewBox:u,viewBoxDimension:l}=e;if(i&&Vt(i[n]))return i[n];var d=t[n]-c-(a>0?a:0),f=t[n]+a;if(r[n])return o[n]?d:f;var p=u[n];if(p==null)return 0;if(o[n]){var h=d,y=p;return h<y?Math.max(f,p):Math.max(d,p)}if(l==null)return 0;var g=f+c,m=p+l;return g>m?Math.max(d,p):Math.max(f,p)}function wee(e){var{translateX:r,translateY:t,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(r,"px, ").concat(t,"px, 0)"):"translate(".concat(r,"px, ").concat(t,"px)")}}function _ee(e){var{allowEscapeViewBox:r,coordinate:t,offsetTop:n,offsetLeft:a,position:i,reverseDirection:o,tooltipBox:c,useTranslate3d:u,viewBox:l}=e,d,f,p;return c.height>0&&c.width>0&&t?(f=NC({allowEscapeViewBox:r,coordinate:t,key:"x",offset:a,position:i,reverseDirection:o,tooltipDimension:c.width,viewBox:l,viewBoxDimension:l.width}),p=NC({allowEscapeViewBox:r,coordinate:t,key:"y",offset:n,position:i,reverseDirection:o,tooltipDimension:c.height,viewBox:l,viewBoxDimension:l.height}),d=wee({translateX:f,translateY:p,useTranslate3d:u})):d=vee,{cssProperties:d,cssClasses:bee({translateX:f,translateY:p,coordinate:t})}}function kC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function bx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?kC(Object(t),!0).forEach(function(n){Aj(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Aj(e,r,t){return(r=jee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function jee(e){var r=Nee(e,"string");return typeof r=="symbol"?r:r+""}function Nee(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class kee extends R.PureComponent{constructor(){super(...arguments),Aj(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Aj(this,"handleKeyDown",r=>{if(r.key==="Escape"){var t,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(t=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&t!==void 0?t:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var r,t;this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((t=this.props.coordinate)===null||t===void 0?void 0:t.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:r,allowEscapeViewBox:t,animationDuration:n,animationEasing:a,children:i,coordinate:o,hasPayload:c,isAnimationActive:u,offset:l,position:d,reverseDirection:f,useTranslate3d:p,viewBox:h,wrapperStyle:y,lastBoundingBox:g,innerRef:m,hasPortalFromProps:x}=this.props,v=typeof l=="number"?l:l.x,w=typeof l=="number"?l:l.y,{cssClasses:_,cssProperties:A}=_ee({allowEscapeViewBox:t,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:h}),P=x?{}:bx(bx({transition:u&&r?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&c?"visible":"hidden",position:"absolute",top:0,left:0}),B=bx(bx({},P),{},{visibility:!this.state.dismissed&&r&&c?"visible":"hidden"},y);return R.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:B,ref:m},i)}}var CI=()=>{var e;return(e=nr(r=>r.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Ej(){return Ej=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ej.apply(null,arguments)}function SC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function CC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?SC(Object(t),!0).forEach(function(n){See(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function See(e,r,t){return(r=Cee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Cee(e){var r=Aee(e,"string");return typeof r=="symbol"?r:r+""}function Aee(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var AC={curveBasisClosed:cY,curveBasisOpen:uY,curveBasis:lY,curveBumpX:GX,curveBumpY:XX,curveLinearClosed:dY,curveLinear:Xb,curveMonotoneX:hY,curveMonotoneY:fY,curveNatural:pY,curveStep:mY,curveStepAfter:yY,curveStepBefore:gY},zv=e=>un(e.x)&&un(e.y),EC=e=>e.base!=null&&zv(e.base)&&zv(e),N0=e=>e.x,k0=e=>e.y,Eee=(e,r)=>{if(typeof e=="function")return e;var t="curve".concat(Yg(e));if((t==="curveMonotone"||t==="curveBump")&&r){var n=AC["".concat(t).concat(r==="vertical"?"Y":"X")];if(n)return n}return AC[t]||Xb},TC={connectNulls:!1,type:"linear"},Tee=e=>{var{type:r=TC.type,points:t=[],baseLine:n,layout:a,connectNulls:i=TC.connectNulls}=e,o=Eee(r,a),c=i?t.filter(zv):t;if(Array.isArray(n)){var u,l=t.map((y,g)=>CC(CC({},y),{},{base:n[g]}));a==="vertical"?u=hx().y(k0).x1(N0).x0(y=>y.base.x):u=hx().x(N0).y1(k0).y0(y=>y.base.y);var d=u.defined(EC).curve(o),f=i?l.filter(EC):l;return d(f)}var p;a==="vertical"&&Vt(n)?p=hx().y(k0).x1(N0).x0(n):Vt(n)?p=hx().x(N0).y1(k0).y0(n):p=eM().x(N0).y(k0);var h=p.defined(zv).curve(o);return h(c)},C3=e=>{var{className:r,points:t,path:n,pathRef:a}=e,i=Yf();if((!t||!t.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},c=t&&t.length?Tee(o):n;return R.createElement("path",Ej({},Zo(e),u3(e),{className:yn("recharts-curve",r),d:c===null?void 0:c,ref:a}))},Pee=["x","y","top","left","width","height","className"];function Tj(){return Tj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Tj.apply(null,arguments)}function PC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Oee(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?PC(Object(t),!0).forEach(function(n){Mee(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):PC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Mee(e,r,t){return(r=Iee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Iee(e){var r=Ree(e,"string");return typeof r=="symbol"?r:r+""}function Ree(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Lee(e,r){if(e==null)return{};var t,n,a=Dee(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Dee(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Fee=(e,r,t,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(r,"h").concat(t),Bee=e=>{var{x:r=0,y:t=0,top:n=0,left:a=0,width:i=0,height:o=0,className:c}=e,u=Lee(e,Pee),l=Oee({x:r,y:t,top:n,left:a,width:i,height:o},u);return!Vt(r)||!Vt(t)||!Vt(i)||!Vt(o)||!Vt(n)||!Vt(a)?null:R.createElement("path",Tj({},ro(l),{className:yn("recharts-cross",c),d:Fee(r,t,i,o,n,a)}))};function $ee(e,r,t,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?r.x-a:t.left+.5,y:e==="horizontal"?t.top+.5:r.y-a,width:e==="horizontal"?n:t.width-1,height:e==="horizontal"?t.height-1:n}}function OC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function MC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?OC(Object(t),!0).forEach(function(n){qee(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):OC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function qee(e,r,t){return(r=zee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function zee(e){var r=Uee(e,"string");return typeof r=="symbol"?r:r+""}function Uee(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Hee=e=>e.replace(/([A-Z])/g,r=>"-".concat(r.toLowerCase())),AI=(e,r,t)=>e.map(n=>"".concat(Hee(n)," ").concat(r,"ms ").concat(t)).join(","),Vee=(e,r)=>[Object.keys(e),Object.keys(r)].reduce((t,n)=>t.filter(a=>n.includes(a))),Cg=(e,r)=>Object.keys(r).reduce((t,n)=>MC(MC({},t),{},{[n]:e(n,r[n])}),{});function IC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Fa(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?IC(Object(t),!0).forEach(function(n){Wee(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):IC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Wee(e,r,t){return(r=Kee(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Kee(e){var r=Gee(e,"string");return typeof r=="symbol"?r:r+""}function Gee(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Uv=(e,r,t)=>e+(r-e)*t,Pj=e=>{var{from:r,to:t}=e;return r!==t},EI=(e,r,t)=>{var n=Cg((a,i)=>{if(Pj(i)){var[o,c]=e(i.from,i.to,i.velocity);return Fa(Fa({},i),{},{from:o,velocity:c})}return i},r);return t<1?Cg((a,i)=>Pj(i)&&n[a]!=null?Fa(Fa({},i),{},{velocity:Uv(i.velocity,n[a].velocity,t),from:Uv(i.from,n[a].from,t)}):i,r):EI(e,n,t-1)};function Xee(e,r,t,n,a,i){var o,c=n.reduce((p,h)=>Fa(Fa({},p),{},{[h]:{from:e[h],velocity:0,to:r[h]}}),{}),u=()=>Cg((p,h)=>h.from,c),l=()=>!Object.values(c).filter(Pj).length,d=null,f=p=>{o||(o=p);var h=p-o,y=h/t.dt;c=EI(t,c,y),a(Fa(Fa(Fa({},e),r),u())),o=p,l()||(d=i.setTimeout(f))};return()=>(d=i.setTimeout(f),()=>{var p;(p=d)===null||p===void 0||p()})}function Yee(e,r,t,n,a,i,o){var c=null,u=a.reduce((f,p)=>{var h=e[p],y=r[p];return h==null||y==null?f:Fa(Fa({},f),{},{[p]:[h,y]})},{}),l,d=f=>{l||(l=f);var p=(f-l)/n,h=Cg((g,m)=>Uv(...m,t(p)),u);if(i(Fa(Fa(Fa({},e),r),h)),p<1)c=o.setTimeout(d);else{var y=Cg((g,m)=>Uv(...m,t(1)),u);i(Fa(Fa(Fa({},e),r),y))}};return()=>(c=o.setTimeout(d),()=>{var f;(f=c)===null||f===void 0||f()})}const Qee=(e,r,t,n,a,i)=>{var o=Vee(e,r);return t==null?()=>(a(Fa(Fa({},e),r)),()=>{}):t.isStepper===!0?Xee(e,r,t,o,a,i):Yee(e,r,t,n,o,a,i)};var Hv=1e-4,TI=(e,r)=>[0,3*e,3*r-6*e,3*e-3*r+1],PI=(e,r)=>e.map((t,n)=>t*r**n).reduce((t,n)=>t+n),RC=(e,r)=>t=>{var n=TI(e,r);return PI(n,t)},Zee=(e,r)=>t=>{var n=TI(e,r),a=[...n.map((i,o)=>i*o).slice(1),0];return PI(a,t)},Jee=e=>{var r,t=e.split("(");if(t.length!==2||t[0]!=="cubic-bezier")return null;var n=(r=t[1])===null||r===void 0||(r=r.split(")")[0])===null||r===void 0?void 0:r.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},ete=function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];if(t.length===1)switch(t[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=Jee(t[0]);if(a)return a}}return t.length===4?t:[0,0,1,1]},tte=(e,r,t,n)=>{var a=RC(e,t),i=RC(r,n),o=Zee(e,t),c=l=>l>1?1:l<0?0:l,u=l=>{for(var d=l>1?1:l,f=d,p=0;p<8;++p){var h=a(f)-d,y=o(f);if(Math.abs(h-d)<Hv||y<Hv)return i(f);f=c(f-h/y)}return i(f)};return u.isStepper=!1,u},LC=function(){return tte(...ete(...arguments))},rte=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:t=100,damping:n=8,dt:a=17}=r,i=(o,c,u)=>{var l=-(o-c)*t,d=u*n,f=u+(l-d)*a/1e3,p=u*a/1e3+o;return Math.abs(p-c)<Hv&&Math.abs(f)<Hv?[c,0]:[p,f]};return i.isStepper=!0,i.dt=a,i},nte=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return LC(e);case"spring":return rte();default:if(e.split("(")[0]==="cubic-bezier")return LC(e)}return typeof e=="function"?e:null};function ste(e){var r,t=()=>null,n=!1,a=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var c=o,[u,...l]=c;if(typeof u=="number"){a=e.setTimeout(i.bind(null,l),u);return}i(u),a=e.setTimeout(i.bind(null,l));return}typeof o=="string"&&(r=o,t(r)),typeof o=="object"&&(r=o,t(r)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),i(o)},subscribe:o=>(t=o,()=>{t=()=>null}),getTimeoutController:()=>e}}class ate{setTimeout(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=o=>{o-n>=t?r(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function ite(){return ste(new ate)}var ote=R.createContext(ite);function lte(e,r){var t=R.useContext(ote);return R.useMemo(()=>r??t(e),[e,r,t])}var cte=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),m1={isSsr:cte()},ute={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},DC={t:0},a_={t:1};function ny(e){var r=Sa(e,ute),{isActive:t,canBegin:n,duration:a,easing:i,begin:o,onAnimationEnd:c,onAnimationStart:u,children:l}=r,d=t==="auto"?!m1.isSsr:t,f=lte(r.animationId,r.animationManager),[p,h]=R.useState(d?DC:a_),y=R.useRef(null);return R.useEffect(()=>{d||h(a_)},[d]),R.useEffect(()=>{if(!d||!n)return Xf;var g=Qee(DC,a_,nte(i),a,h,f.getTimeoutController()),m=()=>{y.current=g()};return f.start([u,o,m,a,c]),()=>{f.stop(),y.current&&y.current(),c()}},[d,n,a,i,o,u,c,f]),l(p.t)}function sy(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",t=R.useRef(bg(r)),n=R.useRef(e);return n.current!==e&&(t.current=bg(r),n.current=e),t.current}var dte=["radius"],hte=["radius"],FC,BC,$C,qC,zC,UC,HC,VC,WC,KC;function GC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function XC(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?GC(Object(t),!0).forEach(function(n){fte(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):GC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function fte(e,r,t){return(r=pte(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function pte(e){var r=mte(e,"string");return typeof r=="symbol"?r:r+""}function mte(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Vv.apply(null,arguments)}function YC(e,r){if(e==null)return{};var t,n,a=gte(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function gte(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function Rc(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var QC=(e,r,t,n,a)=>{var i=dh(t),o=dh(n),c=Math.min(Math.abs(i)/2,Math.abs(o)/2),u=o>=0?1:-1,l=i>=0?1:-1,d=o>=0&&i>=0||o<0&&i<0?1:0,f;if(c>0&&Array.isArray(a)){for(var p=[0,0,0,0],h=0,y=4;h<y;h++){var g,m=(g=a[h])!==null&&g!==void 0?g:0;p[h]=m>c?c:m}f=Vs(FC||(FC=Rc(["M",",",""])),e,r+u*p[0]),p[0]>0&&(f+=Vs(BC||(BC=Rc(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+l*p[0],r)),f+=Vs($C||($C=Rc(["L ",",",""])),e+t-l*p[1],r),p[1]>0&&(f+=Vs(qC||(qC=Rc(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+t,r+u*p[1])),f+=Vs(zC||(zC=Rc(["L ",",",""])),e+t,r+n-u*p[2]),p[2]>0&&(f+=Vs(UC||(UC=Rc(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+t-l*p[2],r+n)),f+=Vs(HC||(HC=Rc(["L ",",",""])),e+l*p[3],r+n),p[3]>0&&(f+=Vs(VC||(VC=Rc(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,r+n-u*p[3])),f+="Z"}else if(c>0&&a===+a&&a>0){var x=Math.min(c,a);f=Vs(WC||(WC=Rc(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,r+u*x,x,x,d,e+l*x,r,e+t-l*x,r,x,x,d,e+t,r+u*x,e+t,r+n-u*x,x,x,d,e+t-l*x,r+n,e+l*x,r+n,x,x,d,e,r+n-u*x)}else f=Vs(KC||(KC=Rc(["M ",","," h "," v "," h "," Z"])),e,r,t,n,-t);return f},ZC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},OI=e=>{var r=Sa(e,ZC),t=R.useRef(null),[n,a]=R.useState(-1);R.useEffect(()=>{if(t.current&&t.current.getTotalLength)try{var N=t.current.getTotalLength();N&&a(N)}catch{}},[]);var{x:i,y:o,width:c,height:u,radius:l,className:d}=r,{animationEasing:f,animationDuration:p,animationBegin:h,isAnimationActive:y,isUpdateAnimationActive:g}=r,m=R.useRef(c),x=R.useRef(u),v=R.useRef(i),w=R.useRef(o),_=R.useMemo(()=>({x:i,y:o,width:c,height:u,radius:l}),[i,o,c,u,l]),A=sy(_,"rectangle-");if(i!==+i||o!==+o||c!==+c||u!==+u||c===0||u===0)return null;var P=yn("recharts-rectangle",d);if(!g){var B=ro(r),{radius:T}=B,I=YC(B,dte);return R.createElement("path",Vv({},I,{x:dh(i),y:dh(o),width:dh(c),height:dh(u),radius:typeof l=="number"?l:void 0,className:P,d:QC(i,o,c,u,l)}))}var U=m.current,H=x.current,z=v.current,O=w.current,L="0px ".concat(n===-1?1:n,"px"),E="".concat(n,"px 0px"),k=AI(["strokeDasharray"],p,typeof f=="string"?f:ZC.animationEasing);return R.createElement(ny,{animationId:A,key:A,canBegin:n>0,duration:p,easing:f,isActive:g,begin:h},N=>{var S=vs(U,c,N),C=vs(H,u,N),D=vs(z,i,N),q=vs(O,o,N);t.current&&(m.current=S,x.current=C,v.current=D,w.current=q);var M;y?N>0?M={transition:k,strokeDasharray:E}:M={strokeDasharray:L}:M={strokeDasharray:E};var G=ro(r),{radius:X}=G,re=YC(G,hte);return R.createElement("path",Vv({},re,{radius:typeof l=="number"?l:void 0,className:P,d:QC(D,q,S,C,l),ref:t,style:XC(XC({},M),r.style)}))})};function JC(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function e7(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?JC(Object(t),!0).forEach(function(n){yte(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):JC(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function yte(e,r,t){return(r=xte(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function xte(e){var r=vte(e,"string");return typeof r=="symbol"?r:r+""}function vte(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Wv=Math.PI/180,bte=e=>e*180/Math.PI,wa=(e,r,t,n)=>({x:e+Math.cos(-Wv*n)*t,y:r+Math.sin(-Wv*n)*t}),MI=function(r,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},wte=(e,r)=>{var{x:t,y:n}=e,{x:a,y:i}=r;return Math.sqrt((t-a)**2+(n-i)**2)},_te=(e,r)=>{var{x:t,y:n}=e,{cx:a,cy:i}=r,o=wte({x:t,y:n},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var c=(t-a)/o,u=Math.acos(c);return n>i&&(u=2*Math.PI-u),{radius:o,angle:bte(u),angleInRadian:u}},jte=e=>{var{startAngle:r,endAngle:t}=e,n=Math.floor(r/360),a=Math.floor(t/360),i=Math.min(n,a);return{startAngle:r-i*360,endAngle:t-i*360}},Nte=(e,r)=>{var{startAngle:t,endAngle:n}=r,a=Math.floor(t/360),i=Math.floor(n/360),o=Math.min(a,i);return e+o*360},kte=(e,r)=>{var{chartX:t,chartY:n}=e,{radius:a,angle:i}=_te({x:t,y:n},r),{innerRadius:o,outerRadius:c}=r;if(a<o||a>c||a===0)return null;var{startAngle:u,endAngle:l}=jte(r),d=i,f;if(u<=l){for(;d>l;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=l}else{for(;d>u;)d-=360;for(;d<l;)d+=360;f=d>=l&&d<=u}return f?e7(e7({},r),{},{radius:a,angle:Nte(d,r)}):null};function II(e){var{cx:r,cy:t,radius:n,startAngle:a,endAngle:i}=e,o=wa(r,t,n,a),c=wa(r,t,n,i);return{points:[o,c],cx:r,cy:t,radius:n,startAngle:a,endAngle:i}}var t7,r7,n7,s7,a7,i7,o7;function Oj(){return Oj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Oj.apply(null,arguments)}function yf(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var Ste=(e,r)=>{var t=ni(r-e),n=Math.min(Math.abs(r-e),359.999);return t*n},wx=e=>{var{cx:r,cy:t,radius:n,angle:a,sign:i,isExternal:o,cornerRadius:c,cornerIsExternal:u}=e,l=c*(o?1:-1)+n,d=Math.asin(c/l)/Wv,f=u?a:a+i*d,p=wa(r,t,l,f),h=wa(r,t,n,f),y=u?a-i*d:a,g=wa(r,t,l*Math.cos(d*Wv),y);return{center:p,circleTangency:h,lineTangency:g,theta:d}},RI=e=>{var{cx:r,cy:t,innerRadius:n,outerRadius:a,startAngle:i,endAngle:o}=e,c=Ste(i,o),u=i+c,l=wa(r,t,a,i),d=wa(r,t,a,u),f=Vs(t7||(t7=yf(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),l.x,l.y,a,a,+(Math.abs(c)>180),+(i>u),d.x,d.y);if(n>0){var p=wa(r,t,n,i),h=wa(r,t,n,u);f+=Vs(r7||(r7=yf(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(c)>180),+(i<=u),p.x,p.y)}else f+=Vs(n7||(n7=yf(["L ",","," Z"])),r,t);return f},Cte=e=>{var{cx:r,cy:t,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:l}=e,d=ni(l-u),{circleTangency:f,lineTangency:p,theta:h}=wx({cx:r,cy:t,radius:a,angle:u,sign:d,cornerRadius:i,cornerIsExternal:c}),{circleTangency:y,lineTangency:g,theta:m}=wx({cx:r,cy:t,radius:a,angle:l,sign:-d,cornerRadius:i,cornerIsExternal:c}),x=c?Math.abs(u-l):Math.abs(u-l)-h-m;if(x<0)return o?Vs(s7||(s7=yf(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,i,i,i*2,i,i,-i*2):RI({cx:r,cy:t,innerRadius:n,outerRadius:a,startAngle:u,endAngle:l});var v=Vs(a7||(a7=yf(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,i,i,+(d<0),f.x,f.y,a,a,+(x>180),+(d<0),y.x,y.y,i,i,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:_,theta:A}=wx({cx:r,cy:t,radius:n,angle:u,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:P,lineTangency:B,theta:T}=wx({cx:r,cy:t,radius:n,angle:l,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),I=c?Math.abs(u-l):Math.abs(u-l)-A-T;if(I<0&&i===0)return"".concat(v,"L").concat(r,",").concat(t,"Z");v+=Vs(i7||(i7=yf(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),B.x,B.y,i,i,+(d<0),P.x,P.y,n,n,+(I>180),+(d>0),w.x,w.y,i,i,+(d<0),_.x,_.y)}else v+=Vs(o7||(o7=yf(["L",",","Z"])),r,t);return v},Ate={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},LI=e=>{var r=Sa(e,Ate),{cx:t,cy:n,innerRadius:a,outerRadius:i,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:u,startAngle:l,endAngle:d,className:f}=r;if(i<a||l===d)return null;var p=yn("recharts-sector",f),h=i-a,y=qi(o,h,0,!0),g;return y>0&&Math.abs(l-d)<360?g=Cte({cx:t,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(y,h/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:l,endAngle:d}):g=RI({cx:t,cy:n,innerRadius:a,outerRadius:i,startAngle:l,endAngle:d}),R.createElement("path",Oj({},ro(r),{className:p,d:g}))};function Ete(e,r,t){if(e==="horizontal")return[{x:r.x,y:t.top},{x:r.x,y:t.top+t.height}];if(e==="vertical")return[{x:t.left,y:r.y},{x:t.left+t.width,y:r.y}];if(mM(r)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:o,angle:c}=r,u=wa(n,a,i,c),l=wa(n,a,o,c);return[{x:u.x,y:u.y},{x:l.x,y:l.y}]}return II(r)}}var i_={},o_={},l_={},l7;function Tte(){return l7||(l7=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=SM();function t(n){return r.isSymbol(n)?NaN:Number(n)}e.toNumber=t})(l_)),l_}var c7;function Pte(){return c7||(c7=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Tte();function t(n){return n?(n=r.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=t})(o_)),o_}var u7;function Ote(){return u7||(u7=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=CM(),t=Pte();function n(a,i,o){o&&typeof o!="number"&&r.isIterateeCall(a,i,o)&&(i=o=void 0),a=t.toFinite(a),i===void 0?(i=a,a=0):i=t.toFinite(i),o=o===void 0?a<i?1:-1:t.toFinite(o);const c=Math.max(Math.ceil((i-a)/(o||1)),0),u=new Array(c);for(let l=0;l<c;l++)u[l]=a,a+=o;return u}e.range=n})(i_)),i_}var c_,d7;function Mte(){return d7||(d7=1,c_=Ote().range),c_}var Ite=Mte();const DI=ru(Ite);function mh(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function Rte(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function A3(e){let r,t,n;e.length!==2?(r=mh,t=(c,u)=>mh(e(c),u),n=(c,u)=>e(c)-u):(r=e===mh||e===Rte?e:Lte,t=e,n=e);function a(c,u,l=0,d=c.length){if(l<d){if(r(u,u)!==0)return d;do{const f=l+d>>>1;t(c[f],u)<0?l=f+1:d=f}while(l<d)}return l}function i(c,u,l=0,d=c.length){if(l<d){if(r(u,u)!==0)return d;do{const f=l+d>>>1;t(c[f],u)<=0?l=f+1:d=f}while(l<d)}return l}function o(c,u,l=0,d=c.length){const f=a(c,u,l,d-1);return f>l&&n(c[f-1],u)>-n(c[f],u)?f-1:f}return{left:a,center:o,right:i}}function Lte(){return 0}function FI(e){return e===null?NaN:+e}function*Dte(e,r){for(let t of e)t!=null&&(t=+t)>=t&&(yield t)}const Fte=A3(mh),ay=Fte.right;A3(FI).center;class h7 extends Map{constructor(r,t=qte){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),r!=null)for(const[n,a]of r)this.set(n,a)}get(r){return super.get(f7(this,r))}has(r){return super.has(f7(this,r))}set(r,t){return super.set(Bte(this,r),t)}delete(r){return super.delete($te(this,r))}}function f7({_intern:e,_key:r},t){const n=r(t);return e.has(n)?e.get(n):t}function Bte({_intern:e,_key:r},t){const n=r(t);return e.has(n)?e.get(n):(e.set(n,t),t)}function $te({_intern:e,_key:r},t){const n=r(t);return e.has(n)&&(t=e.get(n),e.delete(n)),t}function qte(e){return e!==null&&typeof e=="object"?e.valueOf():e}function zte(e=mh){if(e===mh)return BI;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,t)=>{const n=e(r,t);return n||n===0?n:(e(t,t)===0)-(e(r,r)===0)}}function BI(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const Ute=Math.sqrt(50),Hte=Math.sqrt(10),Vte=Math.sqrt(2);function Kv(e,r,t){const n=(r-e)/Math.max(0,t),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=Ute?10:i>=Hte?5:i>=Vte?2:1;let c,u,l;return a<0?(l=Math.pow(10,-a)/o,c=Math.round(e*l),u=Math.round(r*l),c/l<e&&++c,u/l>r&&--u,l=-l):(l=Math.pow(10,a)*o,c=Math.round(e/l),u=Math.round(r/l),c*l<e&&++c,u*l>r&&--u),u<c&&.5<=t&&t<2?Kv(e,r,t*2):[c,u,l]}function Mj(e,r,t){if(r=+r,e=+e,t=+t,!(t>0))return[];if(e===r)return[e];const n=r<e,[a,i,o]=n?Kv(r,e,t):Kv(e,r,t);if(!(i>=a))return[];const c=i-a+1,u=new Array(c);if(n)if(o<0)for(let l=0;l<c;++l)u[l]=(i-l)/-o;else for(let l=0;l<c;++l)u[l]=(i-l)*o;else if(o<0)for(let l=0;l<c;++l)u[l]=(a+l)/-o;else for(let l=0;l<c;++l)u[l]=(a+l)*o;return u}function Ij(e,r,t){return r=+r,e=+e,t=+t,Kv(e,r,t)[2]}function Rj(e,r,t){r=+r,e=+e,t=+t;const n=r<e,a=n?Ij(r,e,t):Ij(e,r,t);return(n?-1:1)*(a<0?1/-a:a)}function p7(e,r){let t;for(const n of e)n!=null&&(t<n||t===void 0&&n>=n)&&(t=n);return t}function m7(e,r){let t;for(const n of e)n!=null&&(t>n||t===void 0&&n>=n)&&(t=n);return t}function $I(e,r,t=0,n=1/0,a){if(r=Math.floor(r),t=Math.floor(Math.max(0,t)),n=Math.floor(Math.min(e.length-1,n)),!(t<=r&&r<=n))return e;for(a=a===void 0?BI:zte(a);n>t;){if(n-t>600){const u=n-t+1,l=r-t+1,d=Math.log(u),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(t,Math.floor(r-l*f/u+p)),y=Math.min(n,Math.floor(r+(u-l)*f/u+p));$I(e,r,h,y,a)}const i=e[r];let o=t,c=n;for(S0(e,t,r),a(e[n],i)>0&&S0(e,t,n);o<c;){for(S0(e,o,c),++o,--c;a(e[o],i)<0;)++o;for(;a(e[c],i)>0;)--c}a(e[t],i)===0?S0(e,t,c):(++c,S0(e,c,n)),c<=r&&(t=c+1),r<=c&&(n=c-1)}return e}function S0(e,r,t){const n=e[r];e[r]=e[t],e[t]=n}function Wte(e,r,t){if(e=Float64Array.from(Dte(e)),!(!(n=e.length)||isNaN(r=+r))){if(r<=0||n<2)return m7(e);if(r>=1)return p7(e);var n,a=(n-1)*r,i=Math.floor(a),o=p7($I(e,i).subarray(0,i+1)),c=m7(e.subarray(i+1));return o+(c-o)*(a-i)}}function Kte(e,r,t=FI){if(!(!(n=e.length)||isNaN(r=+r))){if(r<=0||n<2)return+t(e[0],0,e);if(r>=1)return+t(e[n-1],n-1,e);var n,a=(n-1)*r,i=Math.floor(a),o=+t(e[i],i,e),c=+t(e[i+1],i+1,e);return o+(c-o)*(a-i)}}function Gte(e,r,t){e=+e,r=+r,t=(a=arguments.length)<2?(r=e,e=0,1):a<3?1:+t;for(var n=-1,a=Math.max(0,Math.ceil((r-e)/t))|0,i=new Array(a);++n<a;)i[n]=e+n*t;return i}function Tl(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function vd(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const Lj=Symbol("implicit");function E3(){var e=new h7,r=[],t=[],n=Lj;function a(i){let o=e.get(i);if(o===void 0){if(n!==Lj)return n;e.set(i,o=r.push(i)-1)}return t[o%t.length]}return a.domain=function(i){if(!arguments.length)return r.slice();r=[],e=new h7;for(const o of i)e.has(o)||e.set(o,r.push(o)-1);return a},a.range=function(i){return arguments.length?(t=Array.from(i),a):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return E3(r,t).unknown(n)},Tl.apply(a,arguments),a}function T3(){var e=E3().unknown(void 0),r=e.domain,t=e.range,n=0,a=1,i,o,c=!1,u=0,l=0,d=.5;delete e.unknown;function f(){var p=r().length,h=a<n,y=h?a:n,g=h?n:a;i=(g-y)/Math.max(1,p-u+l*2),c&&(i=Math.floor(i)),y+=(g-y-i*(p-u))*d,o=i*(1-u),c&&(y=Math.round(y),o=Math.round(o));var m=Gte(p).map(function(x){return y+i*x});return t(h?m.reverse():m)}return e.domain=function(p){return arguments.length?(r(p),f()):r()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,c=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(p){return arguments.length?(c=!!p,f()):c},e.padding=function(p){return arguments.length?(u=Math.min(1,l=+p),f()):u},e.paddingInner=function(p){return arguments.length?(u=Math.min(1,p),f()):u},e.paddingOuter=function(p){return arguments.length?(l=+p,f()):l},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),f()):d},e.copy=function(){return T3(r(),[n,a]).round(c).paddingInner(u).paddingOuter(l).align(d)},Tl.apply(f(),arguments)}function qI(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return qI(r())},e}function Xte(){return qI(T3.apply(null,arguments).paddingInner(1))}function P3(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function zI(e,r){var t=Object.create(e.prototype);for(var n in r)t[n]=r[n];return t}function iy(){}var Ag=.7,Gv=1/Ag,cm="\\s*([+-]?\\d+)\\s*",Eg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yte=/^#([0-9a-f]{3,8})$/,Qte=new RegExp(`^rgb\\(${cm},${cm},${cm}\\)$`),Zte=new RegExp(`^rgb\\(${Gc},${Gc},${Gc}\\)$`),Jte=new RegExp(`^rgba\\(${cm},${cm},${cm},${Eg}\\)$`),ere=new RegExp(`^rgba\\(${Gc},${Gc},${Gc},${Eg}\\)$`),tre=new RegExp(`^hsl\\(${Eg},${Gc},${Gc}\\)$`),rre=new RegExp(`^hsla\\(${Eg},${Gc},${Gc},${Eg}\\)$`),g7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};P3(iy,Tg,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:y7,formatHex:y7,formatHex8:nre,formatHsl:sre,formatRgb:x7,toString:x7});function y7(){return this.rgb().formatHex()}function nre(){return this.rgb().formatHex8()}function sre(){return UI(this).formatHsl()}function x7(){return this.rgb().formatRgb()}function Tg(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=Yte.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?v7(r):t===3?new bo(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?_x(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?_x(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Qte.exec(e))?new bo(r[1],r[2],r[3],1):(r=Zte.exec(e))?new bo(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Jte.exec(e))?_x(r[1],r[2],r[3],r[4]):(r=ere.exec(e))?_x(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=tre.exec(e))?_7(r[1],r[2]/100,r[3]/100,1):(r=rre.exec(e))?_7(r[1],r[2]/100,r[3]/100,r[4]):g7.hasOwnProperty(e)?v7(g7[e]):e==="transparent"?new bo(NaN,NaN,NaN,0):null}function v7(e){return new bo(e>>16&255,e>>8&255,e&255,1)}function _x(e,r,t,n){return n<=0&&(e=r=t=NaN),new bo(e,r,t,n)}function are(e){return e instanceof iy||(e=Tg(e)),e?(e=e.rgb(),new bo(e.r,e.g,e.b,e.opacity)):new bo}function Dj(e,r,t,n){return arguments.length===1?are(e):new bo(e,r,t,n??1)}function bo(e,r,t,n){this.r=+e,this.g=+r,this.b=+t,this.opacity=+n}P3(bo,Dj,zI(iy,{brighter(e){return e=e==null?Gv:Math.pow(Gv,e),new bo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ag:Math.pow(Ag,e),new bo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bo(Nf(this.r),Nf(this.g),Nf(this.b),Xv(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:b7,formatHex:b7,formatHex8:ire,formatRgb:w7,toString:w7}));function b7(){return`#${xf(this.r)}${xf(this.g)}${xf(this.b)}`}function ire(){return`#${xf(this.r)}${xf(this.g)}${xf(this.b)}${xf((isNaN(this.opacity)?1:this.opacity)*255)}`}function w7(){const e=Xv(this.opacity);return`${e===1?"rgb(":"rgba("}${Nf(this.r)}, ${Nf(this.g)}, ${Nf(this.b)}${e===1?")":`, ${e})`}`}function Xv(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Nf(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function xf(e){return e=Nf(e),(e<16?"0":"")+e.toString(16)}function _7(e,r,t,n){return n<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new ac(e,r,t,n)}function UI(e){if(e instanceof ac)return new ac(e.h,e.s,e.l,e.opacity);if(e instanceof iy||(e=Tg(e)),!e)return new ac;if(e instanceof ac)return e;e=e.rgb();var r=e.r/255,t=e.g/255,n=e.b/255,a=Math.min(r,t,n),i=Math.max(r,t,n),o=NaN,c=i-a,u=(i+a)/2;return c?(r===i?o=(t-n)/c+(t<n)*6:t===i?o=(n-r)/c+2:o=(r-t)/c+4,c/=u<.5?i+a:2-i-a,o*=60):c=u>0&&u<1?0:o,new ac(o,c,u,e.opacity)}function ore(e,r,t,n){return arguments.length===1?UI(e):new ac(e,r,t,n??1)}function ac(e,r,t,n){this.h=+e,this.s=+r,this.l=+t,this.opacity=+n}P3(ac,ore,zI(iy,{brighter(e){return e=e==null?Gv:Math.pow(Gv,e),new ac(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ag:Math.pow(Ag,e),new ac(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*r,a=2*t-n;return new bo(u_(e>=240?e-240:e+120,a,n),u_(e,a,n),u_(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ac(j7(this.h),jx(this.s),jx(this.l),Xv(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xv(this.opacity);return`${e===1?"hsl(":"hsla("}${j7(this.h)}, ${jx(this.s)*100}%, ${jx(this.l)*100}%${e===1?")":`, ${e})`}`}}));function j7(e){return e=(e||0)%360,e<0?e+360:e}function jx(e){return Math.max(0,Math.min(1,e||0))}function u_(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}const O3=e=>()=>e;function lre(e,r){return function(t){return e+t*r}}function cre(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(n){return Math.pow(e+n*r,t)}}function ure(e){return(e=+e)==1?HI:function(r,t){return t-r?cre(r,t,e):O3(isNaN(r)?t:r)}}function HI(e,r){var t=r-e;return t?lre(e,t):O3(isNaN(e)?r:e)}const N7=(function e(r){var t=ure(r);function n(a,i){var o=t((a=Dj(a)).r,(i=Dj(i)).r),c=t(a.g,i.g),u=t(a.b,i.b),l=HI(a.opacity,i.opacity);return function(d){return a.r=o(d),a.g=c(d),a.b=u(d),a.opacity=l(d),a+""}}return n.gamma=e,n})(1);function dre(e,r){r||(r=[]);var t=e?Math.min(r.length,e.length):0,n=r.slice(),a;return function(i){for(a=0;a<t;++a)n[a]=e[a]*(1-i)+r[a]*i;return n}}function hre(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function fre(e,r){var t=r?r.length:0,n=e?Math.min(t,e.length):0,a=new Array(n),i=new Array(t),o;for(o=0;o<n;++o)a[o]=Fm(e[o],r[o]);for(;o<t;++o)i[o]=r[o];return function(c){for(o=0;o<n;++o)i[o]=a[o](c);return i}}function pre(e,r){var t=new Date;return e=+e,r=+r,function(n){return t.setTime(e*(1-n)+r*n),t}}function Yv(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}function mre(e,r){var t={},n={},a;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in e?t[a]=Fm(e[a],r[a]):n[a]=r[a];return function(i){for(a in t)n[a]=t[a](i);return n}}var Fj=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d_=new RegExp(Fj.source,"g");function gre(e){return function(){return e}}function yre(e){return function(r){return e(r)+""}}function xre(e,r){var t=Fj.lastIndex=d_.lastIndex=0,n,a,i,o=-1,c=[],u=[];for(e=e+"",r=r+"";(n=Fj.exec(e))&&(a=d_.exec(r));)(i=a.index)>t&&(i=r.slice(t,i),c[o]?c[o]+=i:c[++o]=i),(n=n[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,u.push({i:o,x:Yv(n,a)})),t=d_.lastIndex;return t<r.length&&(i=r.slice(t),c[o]?c[o]+=i:c[++o]=i),c.length<2?u[0]?yre(u[0].x):gre(r):(r=u.length,function(l){for(var d=0,f;d<r;++d)c[(f=u[d]).i]=f.x(l);return c.join("")})}function Fm(e,r){var t=typeof r,n;return r==null||t==="boolean"?O3(r):(t==="number"?Yv:t==="string"?(n=Tg(r))?(r=n,N7):xre:r instanceof Tg?N7:r instanceof Date?pre:hre(r)?dre:Array.isArray(r)?fre:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?mre:Yv)(e,r)}function M3(e,r){return e=+e,r=+r,function(t){return Math.round(e*(1-t)+r*t)}}function vre(e,r){r===void 0&&(r=e,e=Fm);for(var t=0,n=r.length-1,a=r[0],i=new Array(n<0?0:n);t<n;)i[t]=e(a,a=r[++t]);return function(o){var c=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[c](o-c)}}function bre(e){return function(){return e}}function Qv(e){return+e}var k7=[0,1];function to(e){return e}function Bj(e,r){return(r-=e=+e)?function(t){return(t-e)/r}:bre(isNaN(r)?NaN:.5)}function wre(e,r){var t;return e>r&&(t=e,e=r,r=t),function(n){return Math.max(e,Math.min(r,n))}}function _re(e,r,t){var n=e[0],a=e[1],i=r[0],o=r[1];return a<n?(n=Bj(a,n),i=t(o,i)):(n=Bj(n,a),i=t(i,o)),function(c){return i(n(c))}}function jre(e,r,t){var n=Math.min(e.length,r.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++o<n;)a[o]=Bj(e[o],e[o+1]),i[o]=t(r[o],r[o+1]);return function(c){var u=ay(e,c,1,n)-1;return i[u](a[u](c))}}function oy(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function g1(){var e=k7,r=k7,t=Fm,n,a,i,o=to,c,u,l;function d(){var p=Math.min(e.length,r.length);return o!==to&&(o=wre(e[0],e[p-1])),c=p>2?jre:_re,u=l=null,f}function f(p){return p==null||isNaN(p=+p)?i:(u||(u=c(e.map(n),r,t)))(n(o(p)))}return f.invert=function(p){return o(a((l||(l=c(r,e.map(n),Yv)))(p)))},f.domain=function(p){return arguments.length?(e=Array.from(p,Qv),d()):e.slice()},f.range=function(p){return arguments.length?(r=Array.from(p),d()):r.slice()},f.rangeRound=function(p){return r=Array.from(p),t=M3,d()},f.clamp=function(p){return arguments.length?(o=p?!0:to,d()):o!==to},f.interpolate=function(p){return arguments.length?(t=p,d()):t},f.unknown=function(p){return arguments.length?(i=p,f):i},function(p,h){return n=p,a=h,d()}}function I3(){return g1()(to,to)}function Nre(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Zv(e,r){if(!isFinite(e)||e===0)return null;var t=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"),n=e.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+e.slice(t+1)]}function jm(e){return e=Zv(Math.abs(e)),e?e[1]:NaN}function kre(e,r){return function(t,n){for(var a=t.length,i=[],o=0,c=e[0],u=0;a>0&&c>0&&(u+c+1>n&&(c=Math.max(1,n-u)),i.push(t.substring(a-=c,a+c)),!((u+=c+1)>n));)c=e[o=(o+1)%e.length];return i.reverse().join(r)}}function Sre(e){return function(r){return r.replace(/[0-9]/g,function(t){return e[+t]})}}var Cre=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pg(e){if(!(r=Cre.exec(e)))throw new Error("invalid format: "+e);var r;return new R3({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}Pg.prototype=R3.prototype;function R3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}R3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Are(e){e:for(var r=e.length,t=1,n=-1,a;t<r;++t)switch(e[t]){case".":n=a=t;break;case"0":n===0&&(n=t),a=t;break;default:if(!+e[t])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Jv;function Ere(e,r){var t=Zv(e,r);if(!t)return Jv=void 0,e.toPrecision(r);var n=t[0],a=t[1],i=a-(Jv=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Zv(e,Math.max(0,r+i-1))[0]}function S7(e,r){var t=Zv(e,r);if(!t)return e+"";var n=t[0],a=t[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const C7={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Nre,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>S7(e*100,r),r:S7,s:Ere,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function A7(e){return e}var E7=Array.prototype.map,T7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Tre(e){var r=e.grouping===void 0||e.thousands===void 0?A7:kre(E7.call(e.grouping,Number),e.thousands+""),t=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?A7:Sre(E7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f,p){f=Pg(f);var h=f.fill,y=f.align,g=f.sign,m=f.symbol,x=f.zero,v=f.width,w=f.comma,_=f.precision,A=f.trim,P=f.type;P==="n"?(w=!0,P="g"):C7[P]||(_===void 0&&(_=12),A=!0,P="g"),(x||h==="0"&&y==="=")&&(x=!0,h="0",y="=");var B=(p&&p.prefix!==void 0?p.prefix:"")+(m==="$"?t:m==="#"&&/[boxX]/.test(P)?"0"+P.toLowerCase():""),T=(m==="$"?n:/[%p]/.test(P)?o:"")+(p&&p.suffix!==void 0?p.suffix:""),I=C7[P],U=/[defgprs%]/.test(P);_=_===void 0?6:/[gprs]/.test(P)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function H(z){var O=B,L=T,E,k,N;if(P==="c")L=I(z)+L,z="";else{z=+z;var S=z<0||1/z<0;if(z=isNaN(z)?u:I(Math.abs(z),_),A&&(z=Are(z)),S&&+z==0&&g!=="+"&&(S=!1),O=(S?g==="("?g:c:g==="-"||g==="("?"":g)+O,L=(P==="s"&&!isNaN(z)&&Jv!==void 0?T7[8+Jv/3]:"")+L+(S&&g==="("?")":""),U){for(E=-1,k=z.length;++E<k;)if(N=z.charCodeAt(E),48>N||N>57){L=(N===46?a+z.slice(E+1):z.slice(E))+L,z=z.slice(0,E);break}}}w&&!x&&(z=r(z,1/0));var C=O.length+z.length+L.length,D=C<v?new Array(v-C+1).join(h):"";switch(w&&x&&(z=r(D+z,D.length?v-L.length:1/0),D=""),y){case"<":z=O+z+L+D;break;case"=":z=O+D+z+L;break;case"^":z=D.slice(0,C=D.length>>1)+O+z+L+D.slice(C);break;default:z=D+O+z+L;break}return i(z)}return H.toString=function(){return f+""},H}function d(f,p){var h=Math.max(-8,Math.min(8,Math.floor(jm(p)/3)))*3,y=Math.pow(10,-h),g=l((f=Pg(f),f.type="f",f),{suffix:T7[8+h/3]});return function(m){return g(y*m)}}return{format:l,formatPrefix:d}}var Nx,L3,VI;Pre({thousands:",",grouping:[3],currency:["$",""]});function Pre(e){return Nx=Tre(e),L3=Nx.format,VI=Nx.formatPrefix,Nx}function Ore(e){return Math.max(0,-jm(Math.abs(e)))}function Mre(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jm(r)/3)))*3-jm(Math.abs(e)))}function Ire(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,jm(r)-jm(e))+1}function WI(e,r,t,n){var a=Rj(e,r,t),i;switch(n=Pg(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(r));return n.precision==null&&!isNaN(i=Mre(a,o))&&(n.precision=i),VI(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=Ire(a,Math.max(Math.abs(e),Math.abs(r))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Ore(a))&&(n.precision=i-(n.type==="%")*2);break}}return L3(n)}function Nh(e){var r=e.domain;return e.ticks=function(t){var n=r();return Mj(n[0],n[n.length-1],t??10)},e.tickFormat=function(t,n){var a=r();return WI(a[0],a[a.length-1],t??10,n)},e.nice=function(t){t==null&&(t=10);var n=r(),a=0,i=n.length-1,o=n[a],c=n[i],u,l,d=10;for(c<o&&(l=o,o=c,c=l,l=a,a=i,i=l);d-- >0;){if(l=Ij(o,c,t),l===u)return n[a]=o,n[i]=c,r(n);if(l>0)o=Math.floor(o/l)*l,c=Math.ceil(c/l)*l;else if(l<0)o=Math.ceil(o*l)/l,c=Math.floor(c*l)/l;else break;u=l}return e},e}function KI(){var e=I3();return e.copy=function(){return oy(e,KI())},Tl.apply(e,arguments),Nh(e)}function GI(e){var r;function t(n){return n==null||isNaN(n=+n)?r:n}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=Array.from(n,Qv),t):e.slice()},t.unknown=function(n){return arguments.length?(r=n,t):r},t.copy=function(){return GI(e).unknown(r)},e=arguments.length?Array.from(e,Qv):[0,1],Nh(t)}function XI(e,r){e=e.slice();var t=0,n=e.length-1,a=e[t],i=e[n],o;return i<a&&(o=t,t=n,n=o,o=a,a=i,i=o),e[t]=r.floor(a),e[n]=r.ceil(i),e}function P7(e){return Math.log(e)}function O7(e){return Math.exp(e)}function Rre(e){return-Math.log(-e)}function Lre(e){return-Math.exp(-e)}function Dre(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Fre(e){return e===10?Dre:e===Math.E?Math.exp:r=>Math.pow(e,r)}function Bre(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function M7(e){return(r,t)=>-e(-r,t)}function D3(e){const r=e(P7,O7),t=r.domain;let n=10,a,i;function o(){return a=Bre(n),i=Fre(n),t()[0]<0?(a=M7(a),i=M7(i),e(Rre,Lre)):e(P7,O7),r}return r.base=function(c){return arguments.length?(n=+c,o()):n},r.domain=function(c){return arguments.length?(t(c),o()):t()},r.ticks=c=>{const u=t();let l=u[0],d=u[u.length-1];const f=d<l;f&&([l,d]=[d,l]);let p=a(l),h=a(d),y,g;const m=c==null?10:+c;let x=[];if(!(n%1)&&h-p<m){if(p=Math.floor(p),h=Math.ceil(h),l>0){for(;p<=h;++p)for(y=1;y<n;++y)if(g=p<0?y/i(-p):y*i(p),!(g<l)){if(g>d)break;x.push(g)}}else for(;p<=h;++p)for(y=n-1;y>=1;--y)if(g=p>0?y/i(-p):y*i(p),!(g<l)){if(g>d)break;x.push(g)}x.length*2<m&&(x=Mj(l,d,m))}else x=Mj(p,h,Math.min(h-p,m)).map(i);return f?x.reverse():x},r.tickFormat=(c,u)=>{if(c==null&&(c=10),u==null&&(u=n===10?"s":","),typeof u!="function"&&(!(n%1)&&(u=Pg(u)).precision==null&&(u.trim=!0),u=L3(u)),c===1/0)return u;const l=Math.max(1,n*c/r.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=l?u(d):""}},r.nice=()=>t(XI(t(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),r}function YI(){const e=D3(g1()).domain([1,10]);return e.copy=()=>oy(e,YI()).base(e.base()),Tl.apply(e,arguments),e}function I7(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function R7(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function F3(e){var r=1,t=e(I7(r),R7(r));return t.constant=function(n){return arguments.length?e(I7(r=+n),R7(r)):r},Nh(t)}function QI(){var e=F3(g1());return e.copy=function(){return oy(e,QI()).constant(e.constant())},Tl.apply(e,arguments)}function L7(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function $re(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function qre(e){return e<0?-e*e:e*e}function B3(e){var r=e(to,to),t=1;function n(){return t===1?e(to,to):t===.5?e($re,qre):e(L7(t),L7(1/t))}return r.exponent=function(a){return arguments.length?(t=+a,n()):t},Nh(r)}function $3(){var e=B3(g1());return e.copy=function(){return oy(e,$3()).exponent(e.exponent())},Tl.apply(e,arguments),e}function zre(){return $3.apply(null,arguments).exponent(.5)}function D7(e){return Math.sign(e)*e*e}function Ure(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ZI(){var e=I3(),r=[0,1],t=!1,n;function a(i){var o=Ure(e(i));return isNaN(o)?n:t?Math.round(o):o}return a.invert=function(i){return e.invert(D7(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((r=Array.from(i,Qv)).map(D7)),a):r.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(t=!!i,a):t},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return ZI(e.domain(),r).round(t).clamp(e.clamp()).unknown(n)},Tl.apply(a,arguments),Nh(a)}function JI(){var e=[],r=[],t=[],n;function a(){var o=0,c=Math.max(1,r.length);for(t=new Array(c-1);++o<c;)t[o-1]=Kte(e,o/c);return i}function i(o){return o==null||isNaN(o=+o)?n:r[ay(t,o)]}return i.invertExtent=function(o){var c=r.indexOf(o);return c<0?[NaN,NaN]:[c>0?t[c-1]:e[0],c<t.length?t[c]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(mh),a()},i.range=function(o){return arguments.length?(r=Array.from(o),a()):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return t.slice()},i.copy=function(){return JI().domain(e).range(r).unknown(n)},Tl.apply(i,arguments)}function eR(){var e=0,r=1,t=1,n=[.5],a=[0,1],i;function o(u){return u!=null&&u<=u?a[ay(n,u,0,t)]:i}function c(){var u=-1;for(n=new Array(t);++u<t;)n[u]=((u+1)*r-(u-t)*e)/(t+1);return o}return o.domain=function(u){return arguments.length?([e,r]=u,e=+e,r=+r,c()):[e,r]},o.range=function(u){return arguments.length?(t=(a=Array.from(u)).length-1,c()):a.slice()},o.invertExtent=function(u){var l=a.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,n[0]]:l>=t?[n[t-1],r]:[n[l-1],n[l]]},o.unknown=function(u){return arguments.length&&(i=u),o},o.thresholds=function(){return n.slice()},o.copy=function(){return eR().domain([e,r]).range(a).unknown(i)},Tl.apply(Nh(o),arguments)}function tR(){var e=[.5],r=[0,1],t,n=1;function a(i){return i!=null&&i<=i?r[ay(e,i,0,n)]:t}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,r.length-1),a):e.slice()},a.range=function(i){return arguments.length?(r=Array.from(i),n=Math.min(e.length,r.length-1),a):r.slice()},a.invertExtent=function(i){var o=r.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(t=i,a):t},a.copy=function(){return tR().domain(e).range(r).unknown(t)},Tl.apply(a,arguments)}const h_=new Date,f_=new Date;function za(e,r,t,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),r(i,1),e(i),i),a.round=i=>{const o=a(i),c=a.ceil(i);return i-o<c-i?o:c},a.offset=(i,o)=>(r(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,c)=>{const u=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<o)||!(c>0))return u;let l;do u.push(l=new Date(+i)),r(i,c),e(i);while(l<i&&i<o);return u},a.filter=i=>za(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;r(o,-1),!i(o););else for(;--c>=0;)for(;r(o,1),!i(o););}),t&&(a.count=(i,o)=>(h_.setTime(+i),f_.setTime(+o),e(h_),e(f_),Math.floor(t(h_,f_))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const eb=za(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);eb.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?za(r=>{r.setTime(Math.floor(r/e)*e)},(r,t)=>{r.setTime(+r+t*e)},(r,t)=>(t-r)/e):eb);eb.range;const Ku=1e3,wl=Ku*60,Gu=wl*60,od=Gu*24,q3=od*7,F7=od*30,p_=od*365,vf=za(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*Ku)},(e,r)=>(r-e)/Ku,e=>e.getUTCSeconds());vf.range;const z3=za(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ku)},(e,r)=>{e.setTime(+e+r*wl)},(e,r)=>(r-e)/wl,e=>e.getMinutes());z3.range;const U3=za(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*wl)},(e,r)=>(r-e)/wl,e=>e.getUTCMinutes());U3.range;const H3=za(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ku-e.getMinutes()*wl)},(e,r)=>{e.setTime(+e+r*Gu)},(e,r)=>(r-e)/Gu,e=>e.getHours());H3.range;const V3=za(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*Gu)},(e,r)=>(r-e)/Gu,e=>e.getUTCHours());V3.range;const ly=za(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*wl)/od,e=>e.getDate()-1);ly.range;const y1=za(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/od,e=>e.getUTCDate()-1);y1.range;const rR=za(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/od,e=>Math.floor(e/od));rR.range;function Qf(e){return za(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,t)=>{r.setDate(r.getDate()+t*7)},(r,t)=>(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*wl)/q3)}const x1=Qf(0),tb=Qf(1),Hre=Qf(2),Vre=Qf(3),Nm=Qf(4),Wre=Qf(5),Kre=Qf(6);x1.range;tb.range;Hre.range;Vre.range;Nm.range;Wre.range;Kre.range;function Zf(e){return za(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t*7)},(r,t)=>(t-r)/q3)}const v1=Zf(0),rb=Zf(1),Gre=Zf(2),Xre=Zf(3),km=Zf(4),Yre=Zf(5),Qre=Zf(6);v1.range;rb.range;Gre.range;Xre.range;km.range;Yre.range;Qre.range;const W3=za(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());W3.range;const K3=za(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());K3.range;const ld=za(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());ld.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:za(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,t)=>{r.setFullYear(r.getFullYear()+t*e)});ld.range;const cd=za(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());cd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:za(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCFullYear(r.getUTCFullYear()+t*e)});cd.range;function nR(e,r,t,n,a,i){const o=[[vf,1,Ku],[vf,5,5*Ku],[vf,15,15*Ku],[vf,30,30*Ku],[i,1,wl],[i,5,5*wl],[i,15,15*wl],[i,30,30*wl],[a,1,Gu],[a,3,3*Gu],[a,6,6*Gu],[a,12,12*Gu],[n,1,od],[n,2,2*od],[t,1,q3],[r,1,F7],[r,3,3*F7],[e,1,p_]];function c(l,d,f){const p=d<l;p&&([l,d]=[d,l]);const h=f&&typeof f.range=="function"?f:u(l,d,f),y=h?h.range(l,+d+1):[];return p?y.reverse():y}function u(l,d,f){const p=Math.abs(d-l)/f,h=A3(([,,m])=>m).right(o,p);if(h===o.length)return e.every(Rj(l/p_,d/p_,f));if(h===0)return eb.every(Math.max(Rj(l,d,f),1));const[y,g]=o[p/o[h-1][2]<o[h][2]/p?h-1:h];return y.every(g)}return[c,u]}const[Zre,Jre]=nR(cd,K3,v1,rR,V3,U3),[ene,tne]=nR(ld,W3,x1,ly,H3,z3);function m_(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function g_(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function C0(e,r,t){return{y:e,m:r,d:t,H:0,M:0,S:0,L:0}}function rne(e){var r=e.dateTime,t=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,c=e.months,u=e.shortMonths,l=A0(a),d=E0(a),f=A0(i),p=E0(i),h=A0(o),y=E0(o),g=A0(c),m=E0(c),x=A0(u),v=E0(u),w={a:N,A:S,b:C,B:D,c:null,d:H7,e:H7,f:kne,g:Rne,G:Dne,H:_ne,I:jne,j:Nne,L:sR,m:Sne,M:Cne,p:q,q:M,Q:K7,s:G7,S:Ane,u:Ene,U:Tne,V:Pne,w:One,W:Mne,x:null,X:null,y:Ine,Y:Lne,Z:Fne,"%":W7},_={a:G,A:X,b:re,B:V,c:null,d:V7,e:V7,f:zne,g:Zne,G:ese,H:Bne,I:$ne,j:qne,L:iR,m:Une,M:Hne,p:J,q:W,Q:K7,s:G7,S:Vne,u:Wne,U:Kne,V:Gne,w:Xne,W:Yne,x:null,X:null,y:Qne,Y:Jne,Z:tse,"%":W7},A={a:U,A:H,b:z,B:O,c:L,d:z7,e:z7,f:xne,g:q7,G:$7,H:U7,I:U7,j:pne,L:yne,m:fne,M:mne,p:I,q:hne,Q:bne,s:wne,S:gne,u:one,U:lne,V:cne,w:ine,W:une,x:E,X:k,y:q7,Y:$7,Z:dne,"%":vne};w.x=P(t,w),w.X=P(n,w),w.c=P(r,w),_.x=P(t,_),_.X=P(n,_),_.c=P(r,_);function P(F,Q){return function(ne){var ie=[],ce=-1,de=0,le=F.length,_e,ue,pe;for(ne instanceof Date||(ne=new Date(+ne));++ce<le;)F.charCodeAt(ce)===37&&(ie.push(F.slice(de,ce)),(ue=B7[_e=F.charAt(++ce)])!=null?_e=F.charAt(++ce):ue=_e==="e"?" ":"0",(pe=Q[_e])&&(_e=pe(ne,ue)),ie.push(_e),de=ce+1);return ie.push(F.slice(de,ce)),ie.join("")}}function B(F,Q){return function(ne){var ie=C0(1900,void 0,1),ce=T(ie,F,ne+="",0),de,le;if(ce!=ne.length)return null;if("Q"in ie)return new Date(ie.Q);if("s"in ie)return new Date(ie.s*1e3+("L"in ie?ie.L:0));if(Q&&!("Z"in ie)&&(ie.Z=0),"p"in ie&&(ie.H=ie.H%12+ie.p*12),ie.m===void 0&&(ie.m="q"in ie?ie.q:0),"V"in ie){if(ie.V<1||ie.V>53)return null;"w"in ie||(ie.w=1),"Z"in ie?(de=g_(C0(ie.y,0,1)),le=de.getUTCDay(),de=le>4||le===0?rb.ceil(de):rb(de),de=y1.offset(de,(ie.V-1)*7),ie.y=de.getUTCFullYear(),ie.m=de.getUTCMonth(),ie.d=de.getUTCDate()+(ie.w+6)%7):(de=m_(C0(ie.y,0,1)),le=de.getDay(),de=le>4||le===0?tb.ceil(de):tb(de),de=ly.offset(de,(ie.V-1)*7),ie.y=de.getFullYear(),ie.m=de.getMonth(),ie.d=de.getDate()+(ie.w+6)%7)}else("W"in ie||"U"in ie)&&("w"in ie||(ie.w="u"in ie?ie.u%7:"W"in ie?1:0),le="Z"in ie?g_(C0(ie.y,0,1)).getUTCDay():m_(C0(ie.y,0,1)).getDay(),ie.m=0,ie.d="W"in ie?(ie.w+6)%7+ie.W*7-(le+5)%7:ie.w+ie.U*7-(le+6)%7);return"Z"in ie?(ie.H+=ie.Z/100|0,ie.M+=ie.Z%100,g_(ie)):m_(ie)}}function T(F,Q,ne,ie){for(var ce=0,de=Q.length,le=ne.length,_e,ue;ce<de;){if(ie>=le)return-1;if(_e=Q.charCodeAt(ce++),_e===37){if(_e=Q.charAt(ce++),ue=A[_e in B7?Q.charAt(ce++):_e],!ue||(ie=ue(F,ne,ie))<0)return-1}else if(_e!=ne.charCodeAt(ie++))return-1}return ie}function I(F,Q,ne){var ie=l.exec(Q.slice(ne));return ie?(F.p=d.get(ie[0].toLowerCase()),ne+ie[0].length):-1}function U(F,Q,ne){var ie=h.exec(Q.slice(ne));return ie?(F.w=y.get(ie[0].toLowerCase()),ne+ie[0].length):-1}function H(F,Q,ne){var ie=f.exec(Q.slice(ne));return ie?(F.w=p.get(ie[0].toLowerCase()),ne+ie[0].length):-1}function z(F,Q,ne){var ie=x.exec(Q.slice(ne));return ie?(F.m=v.get(ie[0].toLowerCase()),ne+ie[0].length):-1}function O(F,Q,ne){var ie=g.exec(Q.slice(ne));return ie?(F.m=m.get(ie[0].toLowerCase()),ne+ie[0].length):-1}function L(F,Q,ne){return T(F,r,Q,ne)}function E(F,Q,ne){return T(F,t,Q,ne)}function k(F,Q,ne){return T(F,n,Q,ne)}function N(F){return o[F.getDay()]}function S(F){return i[F.getDay()]}function C(F){return u[F.getMonth()]}function D(F){return c[F.getMonth()]}function q(F){return a[+(F.getHours()>=12)]}function M(F){return 1+~~(F.getMonth()/3)}function G(F){return o[F.getUTCDay()]}function X(F){return i[F.getUTCDay()]}function re(F){return u[F.getUTCMonth()]}function V(F){return c[F.getUTCMonth()]}function J(F){return a[+(F.getUTCHours()>=12)]}function W(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var Q=P(F+="",w);return Q.toString=function(){return F},Q},parse:function(F){var Q=B(F+="",!1);return Q.toString=function(){return F},Q},utcFormat:function(F){var Q=P(F+="",_);return Q.toString=function(){return F},Q},utcParse:function(F){var Q=B(F+="",!0);return Q.toString=function(){return F},Q}}}var B7={"-":"",_:" ",0:"0"},li=/^\s*\d+/,nne=/^%/,sne=/[\\^$*+?|[\]().{}]/g;function bn(e,r,t){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<t?new Array(t-i+1).join(r)+a:a)}function ane(e){return e.replace(sne,"\\$&")}function A0(e){return new RegExp("^(?:"+e.map(ane).join("|")+")","i")}function E0(e){return new Map(e.map((r,t)=>[r.toLowerCase(),t]))}function ine(e,r,t){var n=li.exec(r.slice(t,t+1));return n?(e.w=+n[0],t+n[0].length):-1}function one(e,r,t){var n=li.exec(r.slice(t,t+1));return n?(e.u=+n[0],t+n[0].length):-1}function lne(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.U=+n[0],t+n[0].length):-1}function cne(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.V=+n[0],t+n[0].length):-1}function une(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.W=+n[0],t+n[0].length):-1}function $7(e,r,t){var n=li.exec(r.slice(t,t+4));return n?(e.y=+n[0],t+n[0].length):-1}function q7(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function dne(e,r,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(t,t+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function hne(e,r,t){var n=li.exec(r.slice(t,t+1));return n?(e.q=n[0]*3-3,t+n[0].length):-1}function fne(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.m=n[0]-1,t+n[0].length):-1}function z7(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.d=+n[0],t+n[0].length):-1}function pne(e,r,t){var n=li.exec(r.slice(t,t+3));return n?(e.m=0,e.d=+n[0],t+n[0].length):-1}function U7(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.H=+n[0],t+n[0].length):-1}function mne(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.M=+n[0],t+n[0].length):-1}function gne(e,r,t){var n=li.exec(r.slice(t,t+2));return n?(e.S=+n[0],t+n[0].length):-1}function yne(e,r,t){var n=li.exec(r.slice(t,t+3));return n?(e.L=+n[0],t+n[0].length):-1}function xne(e,r,t){var n=li.exec(r.slice(t,t+6));return n?(e.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function vne(e,r,t){var n=nne.exec(r.slice(t,t+1));return n?t+n[0].length:-1}function bne(e,r,t){var n=li.exec(r.slice(t));return n?(e.Q=+n[0],t+n[0].length):-1}function wne(e,r,t){var n=li.exec(r.slice(t));return n?(e.s=+n[0],t+n[0].length):-1}function H7(e,r){return bn(e.getDate(),r,2)}function _ne(e,r){return bn(e.getHours(),r,2)}function jne(e,r){return bn(e.getHours()%12||12,r,2)}function Nne(e,r){return bn(1+ly.count(ld(e),e),r,3)}function sR(e,r){return bn(e.getMilliseconds(),r,3)}function kne(e,r){return sR(e,r)+"000"}function Sne(e,r){return bn(e.getMonth()+1,r,2)}function Cne(e,r){return bn(e.getMinutes(),r,2)}function Ane(e,r){return bn(e.getSeconds(),r,2)}function Ene(e){var r=e.getDay();return r===0?7:r}function Tne(e,r){return bn(x1.count(ld(e)-1,e),r,2)}function aR(e){var r=e.getDay();return r>=4||r===0?Nm(e):Nm.ceil(e)}function Pne(e,r){return e=aR(e),bn(Nm.count(ld(e),e)+(ld(e).getDay()===4),r,2)}function One(e){return e.getDay()}function Mne(e,r){return bn(tb.count(ld(e)-1,e),r,2)}function Ine(e,r){return bn(e.getFullYear()%100,r,2)}function Rne(e,r){return e=aR(e),bn(e.getFullYear()%100,r,2)}function Lne(e,r){return bn(e.getFullYear()%1e4,r,4)}function Dne(e,r){var t=e.getDay();return e=t>=4||t===0?Nm(e):Nm.ceil(e),bn(e.getFullYear()%1e4,r,4)}function Fne(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+bn(r/60|0,"0",2)+bn(r%60,"0",2)}function V7(e,r){return bn(e.getUTCDate(),r,2)}function Bne(e,r){return bn(e.getUTCHours(),r,2)}function $ne(e,r){return bn(e.getUTCHours()%12||12,r,2)}function qne(e,r){return bn(1+y1.count(cd(e),e),r,3)}function iR(e,r){return bn(e.getUTCMilliseconds(),r,3)}function zne(e,r){return iR(e,r)+"000"}function Une(e,r){return bn(e.getUTCMonth()+1,r,2)}function Hne(e,r){return bn(e.getUTCMinutes(),r,2)}function Vne(e,r){return bn(e.getUTCSeconds(),r,2)}function Wne(e){var r=e.getUTCDay();return r===0?7:r}function Kne(e,r){return bn(v1.count(cd(e)-1,e),r,2)}function oR(e){var r=e.getUTCDay();return r>=4||r===0?km(e):km.ceil(e)}function Gne(e,r){return e=oR(e),bn(km.count(cd(e),e)+(cd(e).getUTCDay()===4),r,2)}function Xne(e){return e.getUTCDay()}function Yne(e,r){return bn(rb.count(cd(e)-1,e),r,2)}function Qne(e,r){return bn(e.getUTCFullYear()%100,r,2)}function Zne(e,r){return e=oR(e),bn(e.getUTCFullYear()%100,r,2)}function Jne(e,r){return bn(e.getUTCFullYear()%1e4,r,4)}function ese(e,r){var t=e.getUTCDay();return e=t>=4||t===0?km(e):km.ceil(e),bn(e.getUTCFullYear()%1e4,r,4)}function tse(){return"+0000"}function W7(){return"%"}function K7(e){return+e}function G7(e){return Math.floor(+e/1e3)}var Dp,lR,cR;rse({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function rse(e){return Dp=rne(e),lR=Dp.format,Dp.parse,cR=Dp.utcFormat,Dp.utcParse,Dp}function nse(e){return new Date(e)}function sse(e){return e instanceof Date?+e:+new Date(+e)}function G3(e,r,t,n,a,i,o,c,u,l){var d=I3(),f=d.invert,p=d.domain,h=l(".%L"),y=l(":%S"),g=l("%I:%M"),m=l("%I %p"),x=l("%a %d"),v=l("%b %d"),w=l("%B"),_=l("%Y");function A(P){return(u(P)<P?h:c(P)<P?y:o(P)<P?g:i(P)<P?m:n(P)<P?a(P)<P?x:v:t(P)<P?w:_)(P)}return d.invert=function(P){return new Date(f(P))},d.domain=function(P){return arguments.length?p(Array.from(P,sse)):p().map(nse)},d.ticks=function(P){var B=p();return e(B[0],B[B.length-1],P??10)},d.tickFormat=function(P,B){return B==null?A:l(B)},d.nice=function(P){var B=p();return(!P||typeof P.range!="function")&&(P=r(B[0],B[B.length-1],P??10)),P?p(XI(B,P)):d},d.copy=function(){return oy(d,G3(e,r,t,n,a,i,o,c,u,l))},d}function ase(){return Tl.apply(G3(ene,tne,ld,W3,x1,ly,H3,z3,vf,lR).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ise(){return Tl.apply(G3(Zre,Jre,cd,K3,v1,y1,V3,U3,vf,cR).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function b1(){var e=0,r=1,t,n,a,i,o=to,c=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(a===0?.5:(f=(i(f)-t)*a,c?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,r]=f,t=i(e=+e),n=i(r=+r),a=t===n?0:1/(n-t),l):[e,r]},l.clamp=function(f){return arguments.length?(c=!!f,l):c},l.interpolator=function(f){return arguments.length?(o=f,l):o};function d(f){return function(p){var h,y;return arguments.length?([h,y]=p,o=f(h,y),l):[o(0),o(1)]}}return l.range=d(Fm),l.rangeRound=d(M3),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return i=f,t=f(e),n=f(r),a=t===n?0:1/(n-t),l}}function kh(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function uR(){var e=Nh(b1()(to));return e.copy=function(){return kh(e,uR())},vd.apply(e,arguments)}function dR(){var e=D3(b1()).domain([1,10]);return e.copy=function(){return kh(e,dR()).base(e.base())},vd.apply(e,arguments)}function hR(){var e=F3(b1());return e.copy=function(){return kh(e,hR()).constant(e.constant())},vd.apply(e,arguments)}function X3(){var e=B3(b1());return e.copy=function(){return kh(e,X3()).exponent(e.exponent())},vd.apply(e,arguments)}function ose(){return X3.apply(null,arguments).exponent(.5)}function fR(){var e=[],r=to;function t(n){if(n!=null&&!isNaN(n=+n))return r((ay(e,n,1)-1)/(e.length-1))}return t.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(mh),t},t.interpolator=function(n){return arguments.length?(r=n,t):r},t.range=function(){return e.map((n,a)=>r(a/(e.length-1)))},t.quantiles=function(n){return Array.from({length:n+1},(a,i)=>Wte(e,i/n))},t.copy=function(){return fR(r).domain(e)},vd.apply(t,arguments)}function w1(){var e=0,r=.5,t=1,n=1,a,i,o,c,u,l=to,d,f=!1,p;function h(g){return isNaN(g=+g)?p:(g=.5+((g=+d(g))-i)*(n*g<n*i?c:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,r,t]=g,a=d(e=+e),i=d(r=+r),o=d(t=+t),c=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),n=i<a?-1:1,h):[e,r,t]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function y(g){return function(m){var x,v,w;return arguments.length?([x,v,w]=m,l=vre(g,[x,v,w]),h):[l(0),l(.5),l(1)]}}return h.range=y(Fm),h.rangeRound=y(M3),h.unknown=function(g){return arguments.length?(p=g,h):p},function(g){return d=g,a=g(e),i=g(r),o=g(t),c=a===i?0:.5/(i-a),u=i===o?0:.5/(o-i),n=i<a?-1:1,h}}function pR(){var e=Nh(w1()(to));return e.copy=function(){return kh(e,pR())},vd.apply(e,arguments)}function mR(){var e=D3(w1()).domain([.1,1,10]);return e.copy=function(){return kh(e,mR()).base(e.base())},vd.apply(e,arguments)}function gR(){var e=F3(w1());return e.copy=function(){return kh(e,gR()).constant(e.constant())},vd.apply(e,arguments)}function Y3(){var e=B3(w1());return e.copy=function(){return kh(e,Y3()).exponent(e.exponent())},vd.apply(e,arguments)}function lse(){return Y3.apply(null,arguments).exponent(.5)}const K0=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:T3,scaleDiverging:pR,scaleDivergingLog:mR,scaleDivergingPow:Y3,scaleDivergingSqrt:lse,scaleDivergingSymlog:gR,scaleIdentity:GI,scaleImplicit:Lj,scaleLinear:KI,scaleLog:YI,scaleOrdinal:E3,scalePoint:Xte,scalePow:$3,scaleQuantile:JI,scaleQuantize:eR,scaleRadial:ZI,scaleSequential:uR,scaleSequentialLog:dR,scaleSequentialPow:X3,scaleSequentialQuantile:fR,scaleSequentialSqrt:ose,scaleSequentialSymlog:hR,scaleSqrt:zre,scaleSymlog:QI,scaleThreshold:tR,scaleTime:ase,scaleUtc:ise,tickFormat:WI},Symbol.toStringTag,{value:"Module"}));var bd=e=>e.chartData,_1=Xe([bd],e=>{var r=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:r,dataStartIndex:0}}),Q3=(e,r,t,n)=>n?_1(e):bd(e),cse=(e,r,t)=>t?_1(e):bd(e);function ud(e){if(Array.isArray(e)&&e.length===2){var[r,t]=e;if(un(r)&&un(t))return!0}return!1}function X7(e,r,t){return t?e:[Math.min(e[0],r[0]),Math.max(e[1],r[1])]}function yR(e,r){if(r&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[t,n]=e,a,i;if(un(t))a=t;else if(typeof t=="function")return;if(un(n))i=n;else if(typeof n=="function")return;var o=[a,i];if(ud(o))return o}}function use(e,r,t){if(!(!t&&r==null)){if(typeof e=="function"&&r!=null)try{var n=e(r,t);if(ud(n))return X7(n,r,t)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,o,c;if(a==="auto")r!=null&&(o=Math.min(...r));else if(Vt(a))o=a;else if(typeof a=="function")try{r!=null&&(o=a(r?.[0]))}catch{}else if(typeof a=="string"&&aC.test(a)){var u=aC.exec(a);if(u==null||u[1]==null||r==null)o=void 0;else{var l=+u[1];o=r[0]-l}}else o=r?.[0];if(i==="auto")r!=null&&(c=Math.max(...r));else if(Vt(i))c=i;else if(typeof i=="function")try{r!=null&&(c=i(r?.[1]))}catch{}else if(typeof i=="string"&&iC.test(i)){var d=iC.exec(i);if(d==null||d[1]==null||r==null)c=void 0;else{var f=+d[1];c=r[1]+f}}else c=r?.[1];var p=[o,c];if(ud(p))return r==null?p:X7(p,r,t)}}}var Bm=1e9,dse={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},J3,bs=!0,kl="[DecimalError] ",kf=kl+"Invalid argument: ",Z3=kl+"Exponent out of range: ",$m=Math.floor,cf=Math.pow,hse=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Wo,ti=1e7,as=7,xR=9007199254740991,nb=$m(xR/as),Wt={};Wt.absoluteValue=Wt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Wt.comparedTo=Wt.cmp=function(e){var r,t,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,r=0,t=n<a?n:a;r<t;++r)if(i.d[r]!==e.d[r])return i.d[r]>e.d[r]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Wt.decimalPlaces=Wt.dp=function(){var e=this,r=e.d.length-1,t=(r-e.e)*as;if(r=e.d[r],r)for(;r%10==0;r/=10)t--;return t<0?0:t};Wt.dividedBy=Wt.div=function(e){return ed(this,new this.constructor(e))};Wt.dividedToIntegerBy=Wt.idiv=function(e){var r=this,t=r.constructor;return Gn(ed(r,new t(e),0,1),t.precision)};Wt.equals=Wt.eq=function(e){return!this.cmp(e)};Wt.exponent=function(){return Na(this)};Wt.greaterThan=Wt.gt=function(e){return this.cmp(e)>0};Wt.greaterThanOrEqualTo=Wt.gte=function(e){return this.cmp(e)>=0};Wt.isInteger=Wt.isint=function(){return this.e>this.d.length-2};Wt.isNegative=Wt.isneg=function(){return this.s<0};Wt.isPositive=Wt.ispos=function(){return this.s>0};Wt.isZero=function(){return this.s===0};Wt.lessThan=Wt.lt=function(e){return this.cmp(e)<0};Wt.lessThanOrEqualTo=Wt.lte=function(e){return this.cmp(e)<1};Wt.logarithm=Wt.log=function(e){var r,t=this,n=t.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Wo))throw Error(kl+"NaN");if(t.s<1)throw Error(kl+(t.s?"NaN":"-Infinity"));return t.eq(Wo)?new n(0):(bs=!1,r=ed(Og(t,i),Og(e,i),i),bs=!0,Gn(r,a))};Wt.minus=Wt.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?wR(r,e):vR(r,(e.s=-e.s,e))};Wt.modulo=Wt.mod=function(e){var r,t=this,n=t.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(kl+"NaN");return t.s?(bs=!1,r=ed(t,e,0,1).times(e),bs=!0,t.minus(r)):Gn(new n(t),a)};Wt.naturalExponential=Wt.exp=function(){return bR(this)};Wt.naturalLogarithm=Wt.ln=function(){return Og(this)};Wt.negated=Wt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Wt.plus=Wt.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?vR(r,e):wR(r,(e.s=-e.s,e))};Wt.precision=Wt.sd=function(e){var r,t,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(kf+e);if(r=Na(a)+1,n=a.d.length-1,t=n*as+1,n=a.d[n],n){for(;n%10==0;n/=10)t--;for(n=a.d[0];n>=10;n/=10)t++}return e&&r>t?r:t};Wt.squareRoot=Wt.sqrt=function(){var e,r,t,n,a,i,o,c=this,u=c.constructor;if(c.s<1){if(!c.s)return new u(0);throw Error(kl+"NaN")}for(e=Na(c),bs=!1,a=Math.sqrt(+c),a==0||a==1/0?(r=Vc(c.d),(r.length+e)%2==0&&(r+="0"),a=Math.sqrt(r),e=$m((e+1)/2)-(e<0||e%2),a==1/0?r="5e"+e:(r=a.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new u(r)):n=new u(a.toString()),t=u.precision,a=o=t+3;;)if(i=n,n=i.plus(ed(c,i,o+2)).times(.5),Vc(i.d).slice(0,o)===(r=Vc(n.d)).slice(0,o)){if(r=r.slice(o-3,o+1),a==o&&r=="4999"){if(Gn(i,t+1,0),i.times(i).eq(c)){n=i;break}}else if(r!="9999")break;o+=4}return bs=!0,Gn(n,t)};Wt.times=Wt.mul=function(e){var r,t,n,a,i,o,c,u,l,d=this,f=d.constructor,p=d.d,h=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,t=d.e+e.e,u=p.length,l=h.length,u<l&&(i=p,p=h,h=i,o=u,u=l,l=o),i=[],o=u+l,n=o;n--;)i.push(0);for(n=l;--n>=0;){for(r=0,a=u+n;a>n;)c=i[a]+h[n]*p[a-n-1]+r,i[a--]=c%ti|0,r=c/ti|0;i[a]=(i[a]+r)%ti|0}for(;!i[--o];)i.pop();return r?++t:i.shift(),e.d=i,e.e=t,bs?Gn(e,f.precision):e};Wt.toDecimalPlaces=Wt.todp=function(e,r){var t=this,n=t.constructor;return t=new n(t),e===void 0?t:(tu(e,0,Bm),r===void 0?r=n.rounding:tu(r,0,8),Gn(t,e+Na(t)+1,r))};Wt.toExponential=function(e,r){var t,n=this,a=n.constructor;return e===void 0?t=Uf(n,!0):(tu(e,0,Bm),r===void 0?r=a.rounding:tu(r,0,8),n=Gn(new a(n),e+1,r),t=Uf(n,!0,e+1)),t};Wt.toFixed=function(e,r){var t,n,a=this,i=a.constructor;return e===void 0?Uf(a):(tu(e,0,Bm),r===void 0?r=i.rounding:tu(r,0,8),n=Gn(new i(a),e+Na(a)+1,r),t=Uf(n.abs(),!1,e+Na(n)+1),a.isneg()&&!a.isZero()?"-"+t:t)};Wt.toInteger=Wt.toint=function(){var e=this,r=e.constructor;return Gn(new r(e),Na(e)+1,r.rounding)};Wt.toNumber=function(){return+this};Wt.toPower=Wt.pow=function(e){var r,t,n,a,i,o,c=this,u=c.constructor,l=12,d=+(e=new u(e));if(!e.s)return new u(Wo);if(c=new u(c),!c.s){if(e.s<1)throw Error(kl+"Infinity");return c}if(c.eq(Wo))return c;if(n=u.precision,e.eq(Wo))return Gn(c,n);if(r=e.e,t=e.d.length-1,o=r>=t,i=c.s,o){if((t=d<0?-d:d)<=xR){for(a=new u(Wo),r=Math.ceil(n/as+4),bs=!1;t%2&&(a=a.times(c),Q7(a.d,r)),t=$m(t/2),t!==0;)c=c.times(c),Q7(c.d,r);return bs=!0,e.s<0?new u(Wo).div(a):Gn(a,n)}}else if(i<0)throw Error(kl+"NaN");return i=i<0&&e.d[Math.max(r,t)]&1?-1:1,c.s=1,bs=!1,a=e.times(Og(c,n+l)),bs=!0,a=bR(a),a.s=i,a};Wt.toPrecision=function(e,r){var t,n,a=this,i=a.constructor;return e===void 0?(t=Na(a),n=Uf(a,t<=i.toExpNeg||t>=i.toExpPos)):(tu(e,1,Bm),r===void 0?r=i.rounding:tu(r,0,8),a=Gn(new i(a),e,r),t=Na(a),n=Uf(a,e<=t||t<=i.toExpNeg,e)),n};Wt.toSignificantDigits=Wt.tosd=function(e,r){var t=this,n=t.constructor;return e===void 0?(e=n.precision,r=n.rounding):(tu(e,1,Bm),r===void 0?r=n.rounding:tu(r,0,8)),Gn(new n(t),e,r)};Wt.toString=Wt.valueOf=Wt.val=Wt.toJSON=Wt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=Na(e),t=e.constructor;return Uf(e,r<=t.toExpNeg||r>=t.toExpPos)};function vR(e,r){var t,n,a,i,o,c,u,l,d=e.constructor,f=d.precision;if(!e.s||!r.s)return r.s||(r=new d(e)),bs?Gn(r,f):r;if(u=e.d,l=r.d,o=e.e,a=r.e,u=u.slice(),i=o-a,i){for(i<0?(n=u,i=-i,c=l.length):(n=l,a=o,c=u.length),o=Math.ceil(f/as),c=o>c?o+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=u.length,i=l.length,c-i<0&&(i=c,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/ti|0,u[i]%=ti;for(t&&(u.unshift(t),++a),c=u.length;u[--c]==0;)u.pop();return r.d=u,r.e=a,bs?Gn(r,f):r}function tu(e,r,t){if(e!==~~e||e<r||e>t)throw Error(kf+e)}function Vc(e){var r,t,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,r=1;r<a;r++)n=e[r]+"",t=as-n.length,t&&(i+=ah(t)),i+=n;o=e[r],n=o+"",t=as-n.length,t&&(i+=ah(t))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ed=(function(){function e(n,a){var i,o=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+o,n[c]=i%ti|0,o=i/ti|0;return o&&n.unshift(o),n}function r(n,a,i,o){var c,u;if(i!=o)u=i>o?1:-1;else for(c=u=0;c<i;c++)if(n[c]!=a[c]){u=n[c]>a[c]?1:-1;break}return u}function t(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*ti+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var c,u,l,d,f,p,h,y,g,m,x,v,w,_,A,P,B,T,I=n.constructor,U=n.s==a.s?1:-1,H=n.d,z=a.d;if(!n.s)return new I(n);if(!a.s)throw Error(kl+"Division by zero");for(u=n.e-a.e,B=z.length,A=H.length,h=new I(U),y=h.d=[],l=0;z[l]==(H[l]||0);)++l;if(z[l]>(H[l]||0)&&--u,i==null?v=i=I.precision:o?v=i+(Na(n)-Na(a))+1:v=i,v<0)return new I(0);if(v=v/as+2|0,l=0,B==1)for(d=0,z=z[0],v++;(l<A||d)&&v--;l++)w=d*ti+(H[l]||0),y[l]=w/z|0,d=w%z|0;else{for(d=ti/(z[0]+1)|0,d>1&&(z=e(z,d),H=e(H,d),B=z.length,A=H.length),_=B,g=H.slice(0,B),m=g.length;m<B;)g[m++]=0;T=z.slice(),T.unshift(0),P=z[0],z[1]>=ti/2&&++P;do d=0,c=r(z,g,B,m),c<0?(x=g[0],B!=m&&(x=x*ti+(g[1]||0)),d=x/P|0,d>1?(d>=ti&&(d=ti-1),f=e(z,d),p=f.length,m=g.length,c=r(f,g,p,m),c==1&&(d--,t(f,B<p?T:z,p))):(d==0&&(c=d=1),f=z.slice()),p=f.length,p<m&&f.unshift(0),t(g,f,m),c==-1&&(m=g.length,c=r(z,g,B,m),c<1&&(d++,t(g,B<m?T:z,m))),m=g.length):c===0&&(d++,g=[0]),y[l++]=d,c&&g[0]?g[m++]=H[_]||0:(g=[H[_]],m=1);while((_++<A||g[0]!==void 0)&&v--)}return y[0]||y.shift(),h.e=u,Gn(h,o?i+Na(h)+1:i)}})();function bR(e,r){var t,n,a,i,o,c,u=0,l=0,d=e.constructor,f=d.precision;if(Na(e)>16)throw Error(Z3+Na(e));if(!e.s)return new d(Wo);for(bs=!1,c=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),l+=5;for(n=Math.log(cf(2,l))/Math.LN10*2+5|0,c+=n,t=a=i=new d(Wo),d.precision=c;;){if(a=Gn(a.times(e),c),t=t.times(++u),o=i.plus(ed(a,t,c)),Vc(o.d).slice(0,c)===Vc(i.d).slice(0,c)){for(;l--;)i=Gn(i.times(i),c);return d.precision=f,r==null?(bs=!0,Gn(i,f)):i}i=o}}function Na(e){for(var r=e.e*as,t=e.d[0];t>=10;t/=10)r++;return r}function y_(e,r,t){if(r>e.LN10.sd())throw bs=!0,t&&(e.precision=t),Error(kl+"LN10 precision limit exceeded");return Gn(new e(e.LN10),r)}function ah(e){for(var r="";e--;)r+="0";return r}function Og(e,r){var t,n,a,i,o,c,u,l,d,f=1,p=10,h=e,y=h.d,g=h.constructor,m=g.precision;if(h.s<1)throw Error(kl+(h.s?"NaN":"-Infinity"));if(h.eq(Wo))return new g(0);if(r==null?(bs=!1,l=m):l=r,h.eq(10))return r==null&&(bs=!0),y_(g,l);if(l+=p,g.precision=l,t=Vc(y),n=t.charAt(0),i=Na(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&t.charAt(1)>3;)h=h.times(e),t=Vc(h.d),n=t.charAt(0),f++;i=Na(h),n>1?(h=new g("0."+t),i++):h=new g(n+"."+t.slice(1))}else return u=y_(g,l+2,m).times(i+""),h=Og(new g(n+"."+t.slice(1)),l-p).plus(u),g.precision=m,r==null?(bs=!0,Gn(h,m)):h;for(c=o=h=ed(h.minus(Wo),h.plus(Wo),l),d=Gn(h.times(h),l),a=3;;){if(o=Gn(o.times(d),l),u=c.plus(ed(o,new g(a),l)),Vc(u.d).slice(0,l)===Vc(c.d).slice(0,l))return c=c.times(2),i!==0&&(c=c.plus(y_(g,l+2,m).times(i+""))),c=ed(c,new g(f),l),g.precision=m,r==null?(bs=!0,Gn(c,m)):c;c=u,a+=2}}function Y7(e,r){var t,n,a;for((t=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(t<0&&(t=n),t+=+r.slice(n+1),r=r.substring(0,n)):t<0&&(t=r.length),n=0;r.charCodeAt(n)===48;)++n;for(a=r.length;r.charCodeAt(a-1)===48;)--a;if(r=r.slice(n,a),r){if(a-=n,t=t-n-1,e.e=$m(t/as),e.d=[],n=(t+1)%as,t<0&&(n+=as),n<a){for(n&&e.d.push(+r.slice(0,n)),a-=as;n<a;)e.d.push(+r.slice(n,n+=as));r=r.slice(n),n=as-r.length}else n-=a;for(;n--;)r+="0";if(e.d.push(+r),bs&&(e.e>nb||e.e<-nb))throw Error(Z3+t)}else e.s=0,e.e=0,e.d=[0];return e}function Gn(e,r,t){var n,a,i,o,c,u,l,d,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(n=r-o,n<0)n+=as,a=r,l=f[d=0];else{if(d=Math.ceil((n+1)/as),i=f.length,d>=i)return e;for(l=i=f[d],o=1;i>=10;i/=10)o++;n%=as,a=n-as+o}if(t!==void 0&&(i=cf(10,o-a-1),c=l/i%10|0,u=r<0||f[d+1]!==void 0||l%i,u=t<4?(c||u)&&(t==0||t==(e.s<0?3:2)):c>5||c==5&&(t==4||u||t==6&&(n>0?a>0?l/cf(10,o-a):0:f[d-1])%10&1||t==(e.s<0?8:7))),r<1||!f[0])return u?(i=Na(e),f.length=1,r=r-i-1,f[0]=cf(10,(as-r%as)%as),e.e=$m(-r/as)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=cf(10,as-n),f[d]=a>0?(l/cf(10,o-a)%cf(10,a)|0)*i:0),u)for(;;)if(d==0){(f[0]+=i)==ti&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=ti)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(bs&&(e.e>nb||e.e<-nb))throw Error(Z3+Na(e));return e}function wR(e,r){var t,n,a,i,o,c,u,l,d,f,p=e.constructor,h=p.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new p(e),bs?Gn(r,h):r;if(u=e.d,f=r.d,n=r.e,l=e.e,u=u.slice(),o=l-n,o){for(d=o<0,d?(t=u,o=-o,c=f.length):(t=f,n=l,c=u.length),a=Math.max(Math.ceil(h/as),c)+2,o>a&&(o=a,t.length=1),t.reverse(),a=o;a--;)t.push(0);t.reverse()}else{for(a=u.length,c=f.length,d=a<c,d&&(c=a),a=0;a<c;a++)if(u[a]!=f[a]){d=u[a]<f[a];break}o=0}for(d&&(t=u,u=f,f=t,r.s=-r.s),c=u.length,a=f.length-c;a>0;--a)u[c++]=0;for(a=f.length;a>o;){if(u[--a]<f[a]){for(i=a;i&&u[--i]===0;)u[i]=ti-1;--u[i],u[a]+=ti}u[a]-=f[a]}for(;u[--c]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(r.d=u,r.e=n,bs?Gn(r,h):r):new p(0)}function Uf(e,r,t){var n,a=Na(e),i=Vc(e.d),o=i.length;return r?(t&&(n=t-o)>0?i=i.charAt(0)+"."+i.slice(1)+ah(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ah(-a-1)+i,t&&(n=t-o)>0&&(i+=ah(n))):a>=o?(i+=ah(a+1-o),t&&(n=t-a-1)>0&&(i=i+"."+ah(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),t&&(n=t-o)>0&&(a+1===o&&(i+="."),i+=ah(n))),e.s<0?"-"+i:i}function Q7(e,r){if(e.length>r)return e.length=r,!0}function _R(e){var r,t,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(kf+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return Y7(o,i.toString())}else if(typeof i!="string")throw Error(kf+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,hse.test(i))Y7(o,i);else throw Error(kf+i)}if(a.prototype=Wt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=_R,a.config=a.set=fse,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<n.length;)e.hasOwnProperty(t=n[r++])||(e[t]=this[t]);return a.config(e),a}function fse(e){if(!e||typeof e!="object")throw Error(kl+"Object expected");var r,t,n,a=["precision",1,Bm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<a.length;r+=3)if((n=e[t=a[r]])!==void 0)if($m(n)===n&&n>=a[r+1]&&n<=a[r+2])this[t]=n;else throw Error(kf+t+": "+n);if((n=e[t="LN10"])!==void 0)if(n==Math.LN10)this[t]=new this(n);else throw Error(kf+t+": "+n);return this}var J3=_R(dse);Wo=new J3(1);const Ln=J3;function jR(e){var r;return e===0?r=1:r=Math.floor(new Ln(e).abs().log(10).toNumber())+1,r}function NR(e,r,t){for(var n=new Ln(e),a=0,i=[];n.lt(r)&&a<1e5;)i.push(n.toNumber()),n=n.add(t),a++;return i}var kR=e=>{var[r,t]=e,[n,a]=[r,t];return r>t&&([n,a]=[t,r]),[n,a]},SR=(e,r,t)=>{if(e.lte(0))return new Ln(0);var n=jR(e.toNumber()),a=new Ln(10).pow(n),i=e.div(a),o=n!==1?.05:.1,c=new Ln(Math.ceil(i.div(o).toNumber())).add(t).mul(o),u=c.mul(a);return r?new Ln(u.toNumber()):new Ln(Math.ceil(u.toNumber()))},pse=(e,r,t)=>{var n=new Ln(1),a=new Ln(e);if(!a.isint()&&t){var i=Math.abs(e);i<1?(n=new Ln(10).pow(jR(e)-1),a=new Ln(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Ln(Math.floor(e)))}else e===0?a=new Ln(Math.floor((r-1)/2)):t||(a=new Ln(Math.floor(e)));for(var o=Math.floor((r-1)/2),c=[],u=0;u<r;u++)c.push(a.add(new Ln(u-o).mul(n)).toNumber());return c},CR=function(r,t,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-r)/(n-1)))return{step:new Ln(0),tickMin:new Ln(0),tickMax:new Ln(0)};var o=SR(new Ln(t).sub(r).div(n-1),a,i),c;r<=0&&t>=0?c=new Ln(0):(c=new Ln(r).add(t).div(2),c=c.sub(new Ln(c).mod(o)));var u=Math.ceil(c.sub(r).div(o).toNumber()),l=Math.ceil(new Ln(t).sub(c).div(o).toNumber()),d=u+l+1;return d>n?CR(r,t,n,a,i+1):(d<n&&(l=t>0?l+(n-d):l,u=t>0?u:u+(n-d)),{step:o,tickMin:c.sub(new Ln(u).mul(o)),tickMax:c.add(new Ln(l).mul(o))})},mse=function(r){var[t,n]=r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[c,u]=kR([t,n]);if(c===-1/0||u===1/0){var l=u===1/0?[c,...Array(a-1).fill(1/0)]:[...Array(a-1).fill(-1/0),u];return t>n?l.reverse():l}if(c===u)return pse(c,a,i);var{step:d,tickMin:f,tickMax:p}=CR(c,u,o,i,0),h=NR(f,p.add(new Ln(.1).mul(d)),d);return t>n?h.reverse():h},gse=function(r,t){var[n,a]=r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,c]=kR([n,a]);if(o===-1/0||c===1/0)return[n,a];if(o===c)return[o];var u=Math.max(t,2),l=SR(new Ln(c).sub(o).div(u-1),i,0),d=[...NR(new Ln(o),new Ln(c),l),c];return i===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},AR=e=>e.rootProps.maxBarSize,yse=e=>e.rootProps.barGap,ER=e=>e.rootProps.barCategoryGap,xse=e=>e.rootProps.barSize,cy=e=>e.rootProps.stackOffset,TR=e=>e.rootProps.reverseStackOrder,eN=e=>e.options.chartName,tN=e=>e.rootProps.syncId,PR=e=>e.rootProps.syncMethod,rN=e=>e.options.eventEmitter,_a={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},tf={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Lc={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},j1=(e,r)=>{if(!(!e||!r))return e!=null&&e.reversed?[r[1],r[0]]:r};function N1(e,r,t){if(t!=="auto")return t;if(e!=null)return gd(e,r)?"category":"number"}function Z7(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function sb(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Z7(Object(t),!0).forEach(function(n){vse(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z7(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function vse(e,r,t){return(r=bse(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function bse(e){var r=wse(e,"string");return typeof r=="symbol"?r:r+""}function wse(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var J7={allowDataOverflow:tf.allowDataOverflow,allowDecimals:tf.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:tf.angleAxisId,includeHidden:!1,name:void 0,reversed:tf.reversed,scale:tf.scale,tick:tf.tick,tickCount:void 0,ticks:void 0,type:tf.type,unit:void 0},eA={allowDataOverflow:Lc.allowDataOverflow,allowDecimals:Lc.allowDecimals,allowDuplicatedCategory:Lc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Lc.radiusAxisId,includeHidden:Lc.includeHidden,name:void 0,reversed:Lc.reversed,scale:Lc.scale,tick:Lc.tick,tickCount:Lc.tickCount,ticks:void 0,type:Lc.type,unit:void 0},_se=(e,r)=>{if(r!=null)return e.polarAxis.angleAxis[r]},nN=Xe([_se,gI],(e,r)=>{var t;if(e!=null)return e;var n=(t=N1(r,"angleAxis",J7.type))!==null&&t!==void 0?t:"category";return sb(sb({},J7),{},{type:n})}),jse=(e,r)=>e.polarAxis.radiusAxis[r],sN=Xe([jse,gI],(e,r)=>{var t;if(e!=null)return e;var n=(t=N1(r,"radiusAxis",eA.type))!==null&&t!==void 0?t:"category";return sb(sb({},eA),{},{type:n})}),k1=e=>e.polarOptions,aN=Xe([yd,xd,qa],MI),OR=Xe([k1,aN],(e,r)=>{if(e!=null)return qi(e.innerRadius,r,0)}),MR=Xe([k1,aN],(e,r)=>{if(e!=null)return qi(e.outerRadius,r,r*.8)}),Nse=e=>{if(e==null)return[0,0];var{startAngle:r,endAngle:t}=e;return[r,t]},IR=Xe([k1],Nse);Xe([nN,IR],j1);var RR=Xe([aN,OR,MR],(e,r,t)=>{if(!(e==null||r==null||t==null))return[r,t]});Xe([sN,RR],j1);var LR=Xe([wn,k1,OR,MR,yd,xd],(e,r,t,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||r==null||t==null||n==null)){var{cx:o,cy:c,startAngle:u,endAngle:l}=r;return{cx:qi(o,a,a/2),cy:qi(c,i,i/2),innerRadius:t,outerRadius:n,startAngle:u,endAngle:l,clockWise:!1}}}),Rs=(e,r)=>r,uy=(e,r,t)=>t;function iN(e){return e?.id}function DR(e,r,t){var{chartData:n=[]}=r,{allowDuplicatedCategory:a,dataKey:i}=t,o=new Map;return e.forEach(c=>{var u,l=(u=c.data)!==null&&u!==void 0?u:n;if(!(l==null||l.length===0)){var d=iN(c);l.forEach((f,p)=>{var h=i==null||a?p:String(Hn(f,i,null)),y=Hn(f,c.dataKey,0),g;o.has(h)?g=o.get(h):g={},Object.assign(g,{[d]:y}),o.set(h,g)})}}),Array.from(o.values())}function S1(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var C1=(e,r)=>e===r?!0:e==null||r==null?!1:e[0]===r[0]&&e[1]===r[1];function A1(e,r){return Array.isArray(e)&&Array.isArray(r)&&e.length===0&&r.length===0?!0:e===r}function kse(e,r){if(e.length===r.length){for(var t=0;t<e.length;t++)if(e[t]!==r[t])return!1;return!0}return!1}var ci=e=>{var r=wn(e);return r==="horizontal"?"xAxis":r==="vertical"?"yAxis":r==="centric"?"angleAxis":"radiusAxis"},qm=e=>e.tooltip.settings.axisId;function Sse(e){if(e in K0)return K0[e]();var r="scale".concat(Yg(e));if(r in K0)return K0[r]()}function tA(e){var r=e.ticks,t=e.bandwidth,n=e.range(),a=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:(function(i){function o(){return i.apply(this,arguments)}return o.toString=function(){return i.toString()},o})(()=>a),rangeMin:()=>a[0],rangeMax:()=>a[1],isInRange(i){var o=a[0],c=a[1];return o<=c?i>=o&&i<=c:i>=c&&i<=o},bandwidth:t?()=>t.call(e):void 0,ticks:r?i=>r.call(e,i):void 0,map:(i,o)=>{var c=e(i);if(c!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var u=e.bandwidth();switch(o.position){case"middle":c+=u/2;break;case"end":c+=u;break}}return c}}}}function rA(e,r,t){if(typeof e=="function")return tA(e.copy().domain(r).range(t));if(e!=null){var n=Sse(e);if(n!=null)return n.domain(r).range(t),tA(n)}}var FR=(e,r)=>{if(r!=null)switch(e){case"linear":{if(!ud(r)){for(var t,n,a=0;a<r.length;a++){var i=r[a];un(i)&&((t===void 0||i<t)&&(t=i),(n===void 0||i>n)&&(n=i))}return t!==void 0&&n!==void 0?[t,n]:void 0}return r}default:return r}};function nA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ab(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?nA(Object(t),!0).forEach(function(n){Cse(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):nA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Cse(e,r,t){return(r=Ase(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ase(e){var r=Ese(e,"string");return typeof r=="symbol"?r:r+""}function Ese(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var $j=[0,"auto"],Ja={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},BR=(e,r)=>e.cartesianAxis.xAxis[r],wd=(e,r)=>{var t=BR(e,r);return t??Ja},ei={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:$j,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:ey},$R=(e,r)=>e.cartesianAxis.yAxis[r],_d=(e,r)=>{var t=$R(e,r);return t??ei},Tse={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},oN=(e,r)=>{var t=e.cartesianAxis.zAxis[r];return t??Tse},Xs=(e,r,t)=>{switch(r){case"xAxis":return wd(e,t);case"yAxis":return _d(e,t);case"zAxis":return oN(e,t);case"angleAxis":return nN(e,t);case"radiusAxis":return sN(e,t);default:throw new Error("Unexpected axis type: ".concat(r))}},Pse=(e,r,t)=>{switch(r){case"xAxis":return wd(e,t);case"yAxis":return _d(e,t);default:throw new Error("Unexpected axis type: ".concat(r))}},zm=(e,r,t)=>{switch(r){case"xAxis":return wd(e,t);case"yAxis":return _d(e,t);case"angleAxis":return nN(e,t);case"radiusAxis":return sN(e,t);default:throw new Error("Unexpected axis type: ".concat(r))}},qR=e=>e.graphicalItems.cartesianItems.some(r=>r.type==="bar")||e.graphicalItems.polarItems.some(r=>r.type==="radialBar");function lN(e,r){return t=>{switch(e){case"xAxis":return"xAxisId"in t&&t.xAxisId===r;case"yAxis":return"yAxisId"in t&&t.yAxisId===r;case"zAxis":return"zAxisId"in t&&t.zAxisId===r;case"angleAxis":return"angleAxisId"in t&&t.angleAxisId===r;case"radiusAxis":return"radiusAxisId"in t&&t.radiusAxisId===r;default:return!1}}}var E1=e=>e.graphicalItems.cartesianItems,Ose=Xe([Rs,uy],lN),cN=(e,r,t)=>e.filter(t).filter(n=>r?.includeHidden===!0?!0:!n.hide),dy=Xe([E1,Xs,Ose],cN,{memoizeOptions:{resultEqualityCheck:A1}}),zR=Xe([dy],e=>e.filter(r=>r.type==="area"||r.type==="bar").filter(S1)),UR=e=>e.filter(r=>!("stackId"in r)||r.stackId===void 0),Mse=Xe([dy],UR),uN=e=>e.map(r=>r.data).filter(Boolean).flat(1),Ise=Xe([dy],uN,{memoizeOptions:{resultEqualityCheck:A1}}),dN=(e,r)=>{var{chartData:t=[],dataStartIndex:n,dataEndIndex:a}=r;return e.length>0?e:t.slice(n,a+1)},hN=Xe([Ise,Q3],dN),fN=(e,r,t)=>r?.dataKey!=null?e.map(n=>({value:Hn(n,r.dataKey)})):t.length>0?t.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Hn(a,n)}))):e.map(n=>({value:n})),T1=Xe([hN,Xs,dy],fN);function HR(e,r){switch(e){case"xAxis":return r.direction==="x";case"yAxis":return r.direction==="y";default:return!1}}function rv(e){if(Jc(e)||e instanceof Date){var r=Number(e);if(un(r))return r}}function sA(e){if(Array.isArray(e)){var r=[rv(e[0]),rv(e[1])];return ud(r)?r:void 0}var t=rv(e);if(t!=null)return[t,t]}function dd(e){return e.map(rv).filter(vo)}function Rse(e,r,t){return!t||typeof r!="number"||Zc(r)?[]:t.length?dd(t.flatMap(n=>{var a=Hn(e,n.dataKey),i,o;if(Array.isArray(a)?[i,o]=a:i=o=a,!(!un(i)||!un(o)))return[r-i,r+o]})):[]}var Ua=e=>{var r=ci(e),t=qm(e);return zm(e,r,t)},hy=Xe([Ua],e=>e?.dataKey),Lse=Xe([zR,Q3,Ua],DR),VR=(e,r,t,n)=>{var a={},i=r.reduce((o,c)=>{if(c.stackId==null)return o;var u=o[c.stackId];return u==null&&(u=[]),u.push(c),o[c.stackId]=u,o},a);return Object.fromEntries(Object.entries(i).map(o=>{var[c,u]=o,l=n?[...u].reverse():u,d=l.map(iN);return[c,{stackedData:rJ(e,d,t),graphicalItems:l}]}))},qj=Xe([Lse,zR,cy,TR],VR),WR=(e,r,t,n)=>{var{dataStartIndex:a,dataEndIndex:i}=r;if(n==null&&t!=="zAxis"){var o=oJ(e,a,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},Dse=Xe([Xs],e=>e.allowDataOverflow),pN=e=>{var r;if(e==null||!("domain"in e))return $j;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var t=dd(e.ticks);return[Math.min(...t),Math.max(...t)]}if(e.type==="category")return e.ticks.map(String)}return(r=e?.domain)!==null&&r!==void 0?r:$j},mN=Xe([Xs],pN),gN=Xe([mN,Dse],yR),Fse=Xe([qj,bd,Rs,gN],WR,{memoizeOptions:{resultEqualityCheck:C1}}),P1=e=>e.errorBars,Bse=(e,r,t)=>e.flatMap(n=>r[n.id]).filter(Boolean).filter(n=>HR(t,n)),ib=function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];var a=t.filter(Boolean);if(a.length!==0){var i=a.flat(),o=Math.min(...i),c=Math.max(...i);return[o,c]}},yN=(e,r,t,n,a)=>{var i,o;if(t.length>0&&e.forEach(c=>{t.forEach(u=>{var l,d,f=(l=n[u.id])===null||l===void 0?void 0:l.filter(x=>HR(a,x)),p=Hn(c,(d=r.dataKey)!==null&&d!==void 0?d:u.dataKey),h=Rse(c,p,f);if(h.length>=2){var y=Math.min(...h),g=Math.max(...h);(i==null||y<i)&&(i=y),(o==null||g>o)&&(o=g)}var m=sA(p);m!=null&&(i=i==null?m[0]:Math.min(i,m[0]),o=o==null?m[1]:Math.max(o,m[1]))})}),r?.dataKey!=null&&e.forEach(c=>{var u=sA(Hn(c,r.dataKey));u!=null&&(i=i==null?u[0]:Math.min(i,u[0]),o=o==null?u[1]:Math.max(o,u[1]))}),un(i)&&un(o))return[i,o]},$se=Xe([hN,Xs,Mse,P1,Rs],yN,{memoizeOptions:{resultEqualityCheck:C1}});function qse(e){var{value:r}=e;if(Jc(r)||r instanceof Date)return r}var zse=(e,r,t)=>{var n=e.map(qse).filter(a=>a!=null);return t&&(r.dataKey==null||r.allowDuplicatedCategory&&hM(n))?DI(0,e.length):r.allowDuplicatedCategory?n:Array.from(new Set(n))},KR=e=>e.referenceElements.dots,Um=(e,r,t)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>r==="xAxis"?n.xAxisId===t:n.yAxisId===t),Use=Xe([KR,Rs,uy],Um),GR=e=>e.referenceElements.areas,Hse=Xe([GR,Rs,uy],Um),XR=e=>e.referenceElements.lines,Vse=Xe([XR,Rs,uy],Um),YR=(e,r)=>{if(e!=null){var t=dd(e.map(n=>r==="xAxis"?n.x:n.y));if(t.length!==0)return[Math.min(...t),Math.max(...t)]}},Wse=Xe(Use,Rs,YR),QR=(e,r)=>{if(e!=null){var t=dd(e.flatMap(n=>[r==="xAxis"?n.x1:n.y1,r==="xAxis"?n.x2:n.y2]));if(t.length!==0)return[Math.min(...t),Math.max(...t)]}},Kse=Xe([Hse,Rs],QR);function Gse(e){var r;if(e.x!=null)return dd([e.x]);var t=(r=e.segment)===null||r===void 0?void 0:r.map(n=>n.x);return t==null||t.length===0?[]:dd(t)}function Xse(e){var r;if(e.y!=null)return dd([e.y]);var t=(r=e.segment)===null||r===void 0?void 0:r.map(n=>n.y);return t==null||t.length===0?[]:dd(t)}var ZR=(e,r)=>{if(e!=null){var t=e.flatMap(n=>r==="xAxis"?Gse(n):Xse(n));if(t.length!==0)return[Math.min(...t),Math.max(...t)]}},Yse=Xe([Vse,Rs],ZR),Qse=Xe(Wse,Yse,Kse,(e,r,t)=>ib(e,t,r)),xN=(e,r,t,n,a,i,o,c)=>{if(t!=null)return t;var u=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",l=u?ib(n,i,a):ib(i,a);return use(r,l,e.allowDataOverflow)},Zse=Xe([Xs,mN,gN,Fse,$se,Qse,wn,Rs],xN,{memoizeOptions:{resultEqualityCheck:C1}}),Jse=[0,1],vN=(e,r,t,n,a,i,o)=>{if(!((e==null||t==null||t.length===0)&&o===void 0)){var{dataKey:c,type:u}=e,l=gd(r,i);if(l&&c==null){var d;return DI(0,(d=t?.length)!==null&&d!==void 0?d:0)}return u==="category"?zse(n,e,l):a==="expand"?Jse:o}},bN=Xe([Xs,wn,hN,T1,cy,Rs,Zse],vN);function eae(e){return e in K0}var JR=(e,r,t)=>{if(e!=null){var{scale:n,type:a}=e;if(n==="auto")return a==="category"&&t&&(t.indexOf("LineChart")>=0||t.indexOf("AreaChart")>=0||t.indexOf("ComposedChart")>=0&&!r)?"point":a==="category"?"band":"linear";if(typeof n=="string"){var i="scale".concat(Yg(n));return eae(i)?i:"point"}}},Sh=Xe([Xs,qR,eN],JR);function wN(e,r,t,n){if(!(t==null||n==null))return typeof e.scale=="function"?rA(e.scale,t,n):rA(r,t,n)}var _N=(e,r,t)=>{var n=pN(r);if(!(t!=="auto"&&t!=="linear")){if(r!=null&&r.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ud(e))return mse(e,r.tickCount,r.allowDecimals);if(r!=null&&r.tickCount&&r.type==="number"&&ud(e))return gse(e,r.tickCount,r.allowDecimals)}},jN=Xe([bN,zm,Sh],_N),NN=(e,r,t,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&ud(r)&&Array.isArray(t)&&t.length>0){var a,i,o=r[0],c=(a=t[0])!==null&&a!==void 0?a:0,u=r[1],l=(i=t[t.length-1])!==null&&i!==void 0?i:0;return[Math.min(o,c),Math.max(u,l)]}return r},tae=Xe([Xs,bN,jN,Rs],NN),rae=Xe(T1,Xs,(e,r)=>{if(!(!r||r.type!=="number")){var t=1/0,n=Array.from(dd(e.map(f=>f.value))).sort((f,p)=>f-p),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var o=i-a;if(o===0)return 1/0;for(var c=0;c<n.length-1;c++){var u=n[c],l=n[c+1];if(!(u==null||l==null)){var d=l-u;t=Math.min(t,d)}}return t/o}}),eL=Xe(rae,wn,ER,qa,(e,r,t,n,a)=>a,(e,r,t,n,a)=>{if(!un(e))return 0;var i=r==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var o=qi(t,e*i),c=e*i/2;return c-o-(c-o)/i*o}return 0}),nae=(e,r,t)=>{var n=wd(e,r);return n==null||typeof n.padding!="string"?0:eL(e,"xAxis",r,t,n.padding)},sae=(e,r,t)=>{var n=_d(e,r);return n==null||typeof n.padding!="string"?0:eL(e,"yAxis",r,t,n.padding)},aae=Xe(wd,nae,(e,r)=>{var t,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:r,right:r}:{left:((t=a.left)!==null&&t!==void 0?t:0)+r,right:((n=a.right)!==null&&n!==void 0?n:0)+r}}),iae=Xe(_d,sae,(e,r)=>{var t,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:r,bottom:r}:{top:((t=a.top)!==null&&t!==void 0?t:0)+r,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+r}}),oae=Xe([qa,aae,u1,c1,(e,r,t)=>t],(e,r,t,n,a)=>{var{padding:i}=n;return a?[i.left,t.width-i.right]:[e.left+r.left,e.left+e.width-r.right]}),lae=Xe([qa,wn,iae,u1,c1,(e,r,t)=>t],(e,r,t,n,a,i)=>{var{padding:o}=a;return i?[n.height-o.bottom,o.top]:r==="horizontal"?[e.top+e.height-t.bottom,e.top+t.top]:[e.top+t.top,e.top+e.height-t.bottom]}),fy=(e,r,t,n)=>{var a;switch(r){case"xAxis":return oae(e,t,n);case"yAxis":return lae(e,t,n);case"zAxis":return(a=oN(e,t))===null||a===void 0?void 0:a.range;case"angleAxis":return IR(e);case"radiusAxis":return RR(e,t);default:return}},tL=Xe([Xs,fy],j1),cae=Xe([Sh,tae],FR),O1=Xe([Xs,Sh,cae,tL],wN);Xe([dy,P1,Rs],Bse);function rL(e,r){return e.id<r.id?-1:e.id>r.id?1:0}var M1=(e,r)=>r,I1=(e,r,t)=>t,uae=Xe(o1,M1,I1,(e,r,t)=>e.filter(n=>n.orientation===r).filter(n=>n.mirror===t).sort(rL)),dae=Xe(l1,M1,I1,(e,r,t)=>e.filter(n=>n.orientation===r).filter(n=>n.mirror===t).sort(rL)),nL=(e,r)=>({width:e.width,height:r.height}),hae=(e,r)=>{var t=typeof r.width=="number"?r.width:ey;return{width:t,height:e.height}},sL=Xe(qa,wd,nL),fae=(e,r,t)=>{switch(r){case"top":return e.top;case"bottom":return t-e.bottom;default:return 0}},pae=(e,r,t)=>{switch(r){case"left":return e.left;case"right":return t-e.right;default:return 0}},mae=Xe(xd,qa,uae,M1,I1,(e,r,t,n,a)=>{var i={},o;return t.forEach(c=>{var u=nL(r,c);o==null&&(o=fae(r,n,e));var l=n==="top"&&!a||n==="bottom"&&a;i[c.id]=o-Number(l)*u.height,o+=(l?-1:1)*u.height}),i}),gae=Xe(yd,qa,dae,M1,I1,(e,r,t,n,a)=>{var i={},o;return t.forEach(c=>{var u=hae(r,c);o==null&&(o=pae(r,n,e));var l=n==="left"&&!a||n==="right"&&a;i[c.id]=o-Number(l)*u.width,o+=(l?-1:1)*u.width}),i}),yae=(e,r)=>{var t=wd(e,r);if(t!=null)return mae(e,t.orientation,t.mirror)},xae=Xe([qa,wd,yae,(e,r)=>r],(e,r,t,n)=>{if(r!=null){var a=t?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),vae=(e,r)=>{var t=_d(e,r);if(t!=null)return gae(e,t.orientation,t.mirror)},bae=Xe([qa,_d,vae,(e,r)=>r],(e,r,t,n)=>{if(r!=null){var a=t?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),aL=Xe(qa,_d,(e,r)=>{var t=typeof r.width=="number"?r.width:ey;return{width:t,height:e.height}}),aA=(e,r,t)=>{switch(r){case"xAxis":return sL(e,t).width;case"yAxis":return aL(e,t).height;default:return}},iL=(e,r,t,n)=>{if(t!=null){var{allowDuplicatedCategory:a,type:i,dataKey:o}=t,c=gd(e,n),u=r.map(l=>l.value);if(o&&c&&i==="category"&&a&&hM(u))return u}},kN=Xe([wn,T1,Xs,Rs],iL),oL=(e,r,t,n)=>{if(!(t==null||t.dataKey==null)){var{type:a,scale:i}=t,o=gd(e,n);if(o&&(a==="number"||i!=="auto"))return r.map(c=>c.value)}},SN=Xe([wn,T1,zm,Rs],oL),iA=Xe([wn,Pse,Sh,O1,kN,SN,fy,jN,Rs],(e,r,t,n,a,i,o,c,u)=>{if(r!=null){var l=gd(e,u);return{angle:r.angle,interval:r.interval,minTickGap:r.minTickGap,orientation:r.orientation,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit,axisType:u,categoricalDomain:i,duplicateDomain:a,isCategorical:l,niceTicks:c,range:o,realScaleType:t,scale:n}}}),wae=(e,r,t,n,a,i,o,c,u)=>{if(!(r==null||n==null)){var l=gd(e,u),{type:d,ticks:f,tickCount:p}=r,h=t==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=d==="category"&&n.bandwidth?n.bandwidth()/h:0;y=u==="angleAxis"&&i!=null&&i.length>=2?ni(i[0]-i[1])*2*y:y;var g=f||a;return g?g.map((m,x)=>{var v=o?o.indexOf(m):m,w=n.map(v);return un(w)?{index:x,coordinate:w+y,value:m,offset:y}:null}).filter(vo):l&&c?c.map((m,x)=>{var v=n.map(m);return un(v)?{coordinate:v+y,value:m,index:x,offset:y}:null}).filter(vo):n.ticks?n.ticks(p).map((m,x)=>{var v=n.map(m);return un(v)?{coordinate:v+y,value:m,index:x,offset:y}:null}).filter(vo):n.domain().map((m,x)=>{var v=n.map(m);return un(v)?{coordinate:v+y,value:o?o[m]:m,index:x,offset:y}:null}).filter(vo)}},lL=Xe([wn,zm,Sh,O1,jN,fy,kN,SN,Rs],wae),_ae=(e,r,t,n,a,i,o)=>{if(!(r==null||t==null||n==null||n[0]===n[1])){var c=gd(e,o),{tickCount:u}=r,l=0;return l=o==="angleAxis"&&n?.length>=2?ni(n[0]-n[1])*2*l:l,c&&i?i.map((d,f)=>{var p=t.map(d);return un(p)?{coordinate:p+l,value:d,index:f,offset:l}:null}).filter(vo):t.ticks?t.ticks(u).map((d,f)=>{var p=t.map(d);return un(p)?{coordinate:p+l,value:d,index:f,offset:l}:null}).filter(vo):t.domain().map((d,f)=>{var p=t.map(d);return un(p)?{coordinate:p+l,value:a?a[d]:d,index:f,offset:l}:null}).filter(vo)}},yh=Xe([wn,zm,O1,fy,kN,SN,Rs],_ae),xh=Xe(Xs,O1,(e,r)=>{if(!(e==null||r==null))return ab(ab({},e),{},{scale:r})}),jae=Xe([Xs,Sh,bN,tL],wN);Xe((e,r,t)=>oN(e,t),jae,(e,r)=>{if(!(e==null||r==null))return ab(ab({},e),{},{scale:r})});var Nae=Xe([wn,o1,l1],(e,r,t)=>{switch(e){case"horizontal":return r.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return t.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),cL=e=>e.options.defaultTooltipEventType,uL=e=>e.options.validateTooltipEventTypes;function dL(e,r,t){if(e==null)return r;var n=e?"axis":"item";return t==null?r:t.includes(n)?n:r}function CN(e,r){var t=cL(e),n=uL(e);return dL(r,t,n)}function kae(e){return nr(r=>CN(r,e))}var hL=(e,r)=>{var t,n=Number(r);if(!(Zc(n)||r==null))return n>=0?e==null||(t=e[n])===null||t===void 0?void 0:t.value:void 0},Sae=e=>e.tooltip.settings,lh={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Cae={itemInteraction:{click:lh,hover:lh},axisInteraction:{click:lh,hover:lh},keyboardInteraction:lh,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},fL=No({name:"tooltip",initialState:Cae,reducers:{addTooltipEntrySettings:{reducer(e,r){e.tooltipItemPayloads.push(r.payload)},prepare:xs()},replaceTooltipEntrySettings:{reducer(e,r){var{prev:t,next:n}=r.payload,a=cc(e).tooltipItemPayloads.indexOf(t);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:xs()},removeTooltipEntrySettings:{reducer(e,r){var t=cc(e).tooltipItemPayloads.indexOf(r.payload);t>-1&&e.tooltipItemPayloads.splice(t,1)},prepare:xs()},setTooltipSettingsState(e,r){e.settings=r.payload},setActiveMouseOverItemIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=r.payload.activeIndex,e.itemInteraction.hover.dataKey=r.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=r.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,r){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=r.payload.activeIndex,e.itemInteraction.click.dataKey=r.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=r.payload.activeCoordinate},setMouseOverAxisIndex(e,r){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=r.payload.activeIndex,e.axisInteraction.hover.dataKey=r.payload.activeDataKey,e.axisInteraction.hover.coordinate=r.payload.activeCoordinate},setMouseClickAxisIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=r.payload.activeIndex,e.axisInteraction.click.dataKey=r.payload.activeDataKey,e.axisInteraction.click.coordinate=r.payload.activeCoordinate},setSyncInteraction(e,r){e.syncInteraction=r.payload},setKeyboardInteraction(e,r){e.keyboardInteraction.active=r.payload.active,e.keyboardInteraction.index=r.payload.activeIndex,e.keyboardInteraction.coordinate=r.payload.activeCoordinate}}}),{addTooltipEntrySettings:Aae,replaceTooltipEntrySettings:Eae,removeTooltipEntrySettings:Tae,setTooltipSettingsState:Pae,setActiveMouseOverItemIndex:pL,mouseLeaveItem:Oae,mouseLeaveChart:mL,setActiveClickItemIndex:Mae,setMouseOverAxisIndex:gL,setMouseClickAxisIndex:Iae,setSyncInteraction:zj,setKeyboardInteraction:Uj}=fL.actions,Rae=fL.reducer;function oA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function kx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?oA(Object(t),!0).forEach(function(n){Lae(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Lae(e,r,t){return(r=Dae(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Dae(e){var r=Fae(e,"string");return typeof r=="symbol"?r:r+""}function Fae(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Bae(e,r,t){return r==="axis"?t==="click"?e.axisInteraction.click:e.axisInteraction.hover:t==="click"?e.itemInteraction.click:e.itemInteraction.hover}function $ae(e){return e.index!=null}var yL=(e,r,t,n)=>{if(r==null)return lh;var a=Bae(e,r,t);if(a==null)return lh;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if($ae(a)){if(i)return kx(kx({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return kx(kx({},lh),{},{coordinate:a.coordinate})};function qae(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var r=e.valueOf();return Number.isFinite(r)?r:void 0}var t=Number(e);return Number.isFinite(t)?t:void 0}function zae(e,r){var t=qae(e),n=r[0],a=r[1];if(t===void 0)return!1;var i=Math.min(n,a),o=Math.max(n,a);return t>=i&&t<=o}function Uae(e,r,t){if(t==null||r==null)return!0;var n=Hn(e,r);return n==null||!ud(t)?!0:zae(n,t)}var AN=(e,r,t,n)=>{var a=e?.index;if(a==null)return null;var i=Number(a);if(!un(i))return a;var o=0,c=1/0;r.length>0&&(c=r.length-1);var u=Math.max(o,Math.min(i,c)),l=r[u];return l==null||Uae(l,t,n)?String(u):null},xL=(e,r,t,n,a,i,o)=>{if(i!=null){var c=o[0],u=c?.getPosition(i);if(u!=null)return u;var l=a?.[Number(i)];if(l)return t==="horizontal"?{x:l.coordinate,y:(n.top+r)/2}:{x:(n.left+e)/2,y:l.coordinate}}},vL=(e,r,t,n)=>{if(r==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(t==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(o=>{var c;return((c=o.settings)===null||c===void 0?void 0:c.graphicalItemId)===a})},bL=e=>e.options.tooltipPayloadSearcher,Hm=e=>e.tooltip;function lA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function cA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lA(Object(t),!0).forEach(function(n){Hae(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Hae(e,r,t){return(r=Vae(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Vae(e){var r=Wae(e,"string");return typeof r=="symbol"?r:r+""}function Wae(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Kae(e,r){return e??r}var wL=(e,r,t,n,a,i,o)=>{if(!(r==null||i==null)){var{chartData:c,computedData:u,dataStartIndex:l,dataEndIndex:d}=t,f=[];return e.reduce((p,h)=>{var y,{dataDefinedOnItem:g,settings:m}=h,x=Kae(g,c),v=Array.isArray(x)?aI(x,l,d):x,w=(y=m?.dataKey)!==null&&y!==void 0?y:n,_=m?.nameKey,A;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?A=fM(v,n,a):A=i(v,r,u,_),Array.isArray(A))A.forEach(B=>{var T=cA(cA({},m),{},{name:B.name,unit:B.unit,color:void 0,fill:void 0});p.push(oC({tooltipEntrySettings:T,dataKey:B.dataKey,payload:B.payload,value:Hn(B.payload,B.dataKey),name:B.name}))});else{var P;p.push(oC({tooltipEntrySettings:m,dataKey:w,payload:A,value:Hn(A,w),name:(P=Hn(A,_))!==null&&P!==void 0?P:m?.name}))}return p},f)}},EN=Xe([Ua,qR,eN],JR),Gae=Xe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,r)=>[...e,...r]),Xae=Xe([ci,qm],lN),Vm=Xe([Gae,Ua,Xae],cN,{memoizeOptions:{resultEqualityCheck:A1}}),Yae=Xe([Vm],e=>e.filter(S1)),Qae=Xe([Vm],uN,{memoizeOptions:{resultEqualityCheck:A1}}),Wm=Xe([Qae,bd],dN),Zae=Xe([Yae,bd,Ua],DR),TN=Xe([Wm,Ua,Vm],fN),_L=Xe([Ua],pN),Jae=Xe([Ua],e=>e.allowDataOverflow),jL=Xe([_L,Jae],yR),eie=Xe([Vm],e=>e.filter(S1)),tie=Xe([Zae,eie,cy,TR],VR),rie=Xe([tie,bd,ci,jL],WR),nie=Xe([Vm],UR),sie=Xe([Wm,Ua,nie,P1,ci],yN,{memoizeOptions:{resultEqualityCheck:C1}}),aie=Xe([KR,ci,qm],Um),iie=Xe([aie,ci],YR),oie=Xe([GR,ci,qm],Um),lie=Xe([oie,ci],QR),cie=Xe([XR,ci,qm],Um),uie=Xe([cie,ci],ZR),die=Xe([iie,uie,lie],ib),hie=Xe([Ua,_L,jL,rie,sie,die,wn,ci],xN),py=Xe([Ua,wn,Wm,TN,cy,ci,hie],vN),fie=Xe([py,Ua,EN],_N),pie=Xe([Ua,py,fie,ci],NN),NL=e=>{var r=ci(e),t=qm(e),n=!1;return fy(e,r,t,n)},kL=Xe([Ua,NL],j1),SL=Xe([Ua,EN,pie,kL],wN),mie=Xe([wn,TN,Ua,ci],iL),gie=Xe([wn,TN,Ua,ci],oL),yie=(e,r,t,n,a,i,o,c)=>{if(r){var{type:u}=r,l=gd(e,c);if(n){var d=t==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=u==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=c==="angleAxis"&&a!=null&&a?.length>=2?ni(a[0]-a[1])*2*f:f,l&&o?o.map((p,h)=>{var y=n.map(p);return un(y)?{coordinate:y+f,value:p,index:h,offset:f}:null}).filter(vo):n.domain().map((p,h)=>{var y=n.map(p);return un(y)?{coordinate:y+f,value:i?i[p]:p,index:h,offset:f}:null}).filter(vo)}}},jd=Xe([wn,Ua,EN,SL,NL,mie,gie,ci],yie),PN=Xe([cL,uL,Sae],(e,r,t)=>dL(t.shared,e,r)),CL=e=>e.tooltip.settings.trigger,ON=e=>e.tooltip.settings.defaultIndex,my=Xe([Hm,PN,CL,ON],yL),vh=Xe([my,Wm,hy,py],AN),AL=Xe([jd,vh],hL),MN=Xe([my],e=>{if(e)return e.dataKey}),xie=Xe([my],e=>{if(e)return e.graphicalItemId}),EL=Xe([Hm,PN,CL,ON],vL),vie=Xe([yd,xd,wn,qa,jd,ON,EL],xL),bie=Xe([my,vie],(e,r)=>e!=null&&e.coordinate?e.coordinate:r),wie=Xe([my],e=>{var r;return(r=e?.active)!==null&&r!==void 0?r:!1}),_ie=Xe([EL,vh,bd,hy,AL,bL,PN],wL),jie=Xe([_ie],e=>{if(e!=null){var r=e.map(t=>t.payload).filter(t=>t!=null);return Array.from(new Set(r))}});function uA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function dA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uA(Object(t),!0).forEach(function(n){Nie(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Nie(e,r,t){return(r=kie(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function kie(e){var r=Sie(e,"string");return typeof r=="symbol"?r:r+""}function Sie(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Cie=()=>nr(Ua),Aie=()=>{var e=Cie(),r=nr(jd),t=nr(SL);return bm(!e||!t?void 0:dA(dA({},e),{},{scale:t}),r)};function hA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Fp(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?hA(Object(t),!0).forEach(function(n){Eie(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Eie(e,r,t){return(r=Tie(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Tie(e){var r=Pie(e,"string");return typeof r=="symbol"?r:r+""}function Pie(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Oie=(e,r,t,n)=>{var a=r.find(i=>i&&i.index===t);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},Mie=(e,r,t,n)=>{var a=r.find(l=>l&&l.index===t);if(a){if(e==="centric"){var i=a.coordinate,{radius:o}=n;return Fp(Fp(Fp({},n),wa(n.cx,n.cy,o,i)),{},{angle:i,radius:o})}var c=a.coordinate,{angle:u}=n;return Fp(Fp(Fp({},n),wa(n.cx,n.cy,c,u)),{},{angle:u,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Iie(e,r){var{chartX:t,chartY:n}=e;return t>=r.left&&t<=r.left+r.width&&n>=r.top&&n<=r.top+r.height}var TL=(e,r,t,n,a)=>{var i,o=(i=r?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<o;c++){var u,l,d,f,p,h=c>0?(u=t[c-1])===null||u===void 0?void 0:u.coordinate:(l=t[o-1])===null||l===void 0?void 0:l.coordinate,y=(d=t[c])===null||d===void 0?void 0:d.coordinate,g=c>=o-1?(f=t[0])===null||f===void 0?void 0:f.coordinate:(p=t[c+1])===null||p===void 0?void 0:p.coordinate,m=void 0;if(!(h==null||y==null||g==null))if(ni(y-h)!==ni(g-y)){var x=[];if(ni(g-y)===ni(a[1]-a[0])){m=g;var v=y+a[1]-a[0];x[0]=Math.min(v,(v+h)/2),x[1]=Math.max(v,(v+h)/2)}else{m=h;var w=g+a[1]-a[0];x[0]=Math.min(y,(w+y)/2),x[1]=Math.max(y,(w+y)/2)}var _=[Math.min(y,(m+y)/2),Math.max(y,(m+y)/2)];if(e>_[0]&&e<=_[1]||e>=x[0]&&e<=x[1]){var A;return(A=t[c])===null||A===void 0?void 0:A.index}}else{var P=Math.min(h,g),B=Math.max(h,g);if(e>(P+y)/2&&e<=(B+y)/2){var T;return(T=t[c])===null||T===void 0?void 0:T.index}}}else if(r)for(var I=0;I<o;I++){var U=r[I];if(U!=null){var H=r[I+1],z=r[I-1];if(I===0&&H!=null&&e<=(U.coordinate+H.coordinate)/2||I===o-1&&z!=null&&e>(U.coordinate+z.coordinate)/2||I>0&&I<o-1&&z!=null&&H!=null&&e>(U.coordinate+z.coordinate)/2&&e<=(U.coordinate+H.coordinate)/2)return U.index}}return-1},Rie=()=>nr(eN),IN=(e,r)=>r,PL=(e,r,t)=>t,RN=(e,r,t,n)=>n,Lie=Xe(jd,e=>Qb(e,r=>r.coordinate)),LN=Xe([Hm,IN,PL,RN],yL),DN=Xe([LN,Wm,hy,py],AN),Die=(e,r,t)=>{if(r!=null){var n=Hm(e);return r==="axis"?t==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:t==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},OL=Xe([Hm,IN,PL,RN],vL),ob=Xe([yd,xd,wn,qa,jd,RN,OL],xL),Fie=Xe([LN,ob],(e,r)=>{var t;return(t=e.coordinate)!==null&&t!==void 0?t:r}),ML=Xe([jd,DN],hL),Bie=Xe([OL,DN,bd,hy,ML,bL,IN],wL),$ie=Xe([LN,DN],(e,r)=>({isActive:e.active&&r!=null,activeIndex:r})),qie=(e,r,t,n,a,i,o)=>{if(!(!e||!t||!n||!a)&&Iie(e,o)){var c=lJ(e,r),u=TL(c,i,a,t,n),l=Oie(r,a,u,e);return{activeIndex:String(u),activeCoordinate:l}}},zie=(e,r,t,n,a,i,o)=>{if(!(!e||!n||!a||!i||!t)){var c=kte(e,t);if(c){var u=cJ(c,r),l=TL(u,o,i,n,a),d=Mie(r,i,l,c);return{activeIndex:String(l),activeCoordinate:d}}}},Uie=(e,r,t,n,a,i,o,c)=>{if(!(!e||!r||!n||!a||!i))return r==="horizontal"||r==="vertical"?qie(e,r,n,a,i,o,c):zie(e,r,t,n,a,i,o)},Hie=Xe(e=>e.zIndex.zIndexMap,(e,r)=>r,(e,r,t)=>t,(e,r,t)=>{if(r!=null){var n=e[r];if(n!=null)return t?n.panoramaElement:n.element}}),Vie=Xe(e=>e.zIndex.zIndexMap,e=>{var r=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(_a)),t=Array.from(new Set(r));return t.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:kse}});function fA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function pA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?fA(Object(t),!0).forEach(function(n){Wie(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Wie(e,r,t){return(r=Kie(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Kie(e){var r=Gie(e,"string");return typeof r=="symbol"?r:r+""}function Gie(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Xie={},Yie={zIndexMap:Object.values(_a).reduce((e,r)=>pA(pA({},e),{},{[r]:{element:void 0,panoramaElement:void 0,consumers:0}}),Xie)},Qie=new Set(Object.values(_a));function Zie(e){return Qie.has(e)}var IL=No({name:"zIndex",initialState:Yie,reducers:{registerZIndexPortal:{reducer:(e,r)=>{var{zIndex:t}=r.payload;e.zIndexMap[t]?e.zIndexMap[t].consumers+=1:e.zIndexMap[t]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:xs()},unregisterZIndexPortal:{reducer:(e,r)=>{var{zIndex:t}=r.payload;e.zIndexMap[t]&&(e.zIndexMap[t].consumers-=1,e.zIndexMap[t].consumers<=0&&!Zie(t)&&delete e.zIndexMap[t])},prepare:xs()},registerZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:t,element:n,isPanorama:a}=r.payload;e.zIndexMap[t]?a?e.zIndexMap[t].panoramaElement=n:e.zIndexMap[t].element=n:e.zIndexMap[t]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:xs()},unregisterZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:t}=r.payload;e.zIndexMap[t]&&(r.payload.isPanorama?e.zIndexMap[t].panoramaElement=void 0:e.zIndexMap[t].element=void 0)},prepare:xs()}}}),{registerZIndexPortal:Jie,unregisterZIndexPortal:eoe,registerZIndexPortalElement:toe,unregisterZIndexPortalElement:roe}=IL.actions,noe=IL.reducer;function ko(e){var{zIndex:r,children:t}=e,n=$J(),a=n&&r!==void 0&&r!==0,i=Ui(),o=rs();R.useLayoutEffect(()=>a?(o(Jie({zIndex:r})),()=>{o(eoe({zIndex:r}))}):Xf,[o,r,a]);var c=nr(u=>Hie(u,r,i));return a?c?B4.createPortal(t,c):null:t}function Hj(){return Hj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Hj.apply(null,arguments)}function mA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Sx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?mA(Object(t),!0).forEach(function(n){soe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function soe(e,r,t){return(r=aoe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function aoe(e){var r=ioe(e,"string");return typeof r=="symbol"?r:r+""}function ioe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function ooe(e){var{cursor:r,cursorComp:t,cursorProps:n}=e;return R.isValidElement(r)?R.cloneElement(r,n):R.createElement(t,n)}function loe(e){var r,{coordinate:t,payload:n,index:a,offset:i,tooltipAxisBandSize:o,layout:c,cursor:u,tooltipEventType:l,chartName:d}=e,f=t,p=n,h=a;if(!u||!f||d!=="ScatterChart"&&l!=="axis")return null;var y,g,m;if(d==="ScatterChart")y=f,g=Bee,m=_a.cursorLine;else if(d==="BarChart")y=$ee(c,f,i,o),g=OI,m=_a.cursorRectangle;else if(c==="radial"&&mM(f)){var{cx:x,cy:v,radius:w,startAngle:_,endAngle:A}=II(f);y={cx:x,cy:v,startAngle:_,endAngle:A,innerRadius:w,outerRadius:w},g=LI,m=_a.cursorLine}else y={points:Ete(c,f,i)},g=C3,m=_a.cursorLine;var P=typeof u=="object"&&"className"in u?u.className:void 0,B=Sx(Sx(Sx(Sx({stroke:"#ccc",pointerEvents:"none"},i),y),Lf(u)),{},{payload:p,payloadIndex:h,className:yn("recharts-tooltip-cursor",P)});return R.createElement(ko,{zIndex:(r=e.zIndex)!==null&&r!==void 0?r:m},R.createElement(ooe,{cursor:u,cursorComp:g,cursorProps:B}))}function coe(e){var r=Aie(),t=pI(),n=Yf(),a=Rie();return r==null||t==null||n==null||a==null?null:R.createElement(loe,Hj({},e,{offset:t,layout:n,tooltipAxisBandSize:r,chartName:a}))}var RL=R.createContext(null),uoe=()=>R.useContext(RL),x_={exports:{}},gA;function doe(){return gA||(gA=1,(function(e){var r=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function a(u,l,d){this.fn=u,this.context=l,this.once=d||!1}function i(u,l,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||u,p),y=t?t+l:l;return u._events[y]?u._events[y].fn?u._events[y]=[u._events[y],h]:u._events[y].push(h):(u._events[y]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],d,f;if(this._eventsCount===0)return l;for(f in d=this._events)r.call(d,f)&&l.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(d)):l},c.prototype.listeners=function(l){var d=t?t+l:l,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,h=f.length,y=new Array(h);p<h;p++)y[p]=f[p].fn;return y},c.prototype.listenerCount=function(l){var d=t?t+l:l,f=this._events[d];return f?f.fn?1:f.length:0},c.prototype.emit=function(l,d,f,p,h,y){var g=t?t+l:l;if(!this._events[g])return!1;var m=this._events[g],x=arguments.length,v,w;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,f),!0;case 4:return m.fn.call(m.context,d,f,p),!0;case 5:return m.fn.call(m.context,d,f,p,h),!0;case 6:return m.fn.call(m.context,d,f,p,h,y),!0}for(w=1,v=new Array(x-1);w<x;w++)v[w-1]=arguments[w];m.fn.apply(m.context,v)}else{var _=m.length,A;for(w=0;w<_;w++)switch(m[w].once&&this.removeListener(l,m[w].fn,void 0,!0),x){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,d);break;case 3:m[w].fn.call(m[w].context,d,f);break;case 4:m[w].fn.call(m[w].context,d,f,p);break;default:if(!v)for(A=1,v=new Array(x-1);A<x;A++)v[A-1]=arguments[A];m[w].fn.apply(m[w].context,v)}}return!0},c.prototype.on=function(l,d,f){return i(this,l,d,f,!1)},c.prototype.once=function(l,d,f){return i(this,l,d,f,!0)},c.prototype.removeListener=function(l,d,f,p){var h=t?t+l:l;if(!this._events[h])return this;if(!d)return o(this,h),this;var y=this._events[h];if(y.fn)y.fn===d&&(!p||y.once)&&(!f||y.context===f)&&o(this,h);else{for(var g=0,m=[],x=y.length;g<x;g++)(y[g].fn!==d||p&&!y[g].once||f&&y[g].context!==f)&&m.push(y[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},c.prototype.removeAllListeners=function(l){var d;return l?(d=t?t+l:l,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,e.exports=c})(x_)),x_.exports}var hoe=doe();const foe=ru(hoe);var Mg=new foe,Vj="recharts.syncEvent.tooltip",yA="recharts.syncEvent.brush",FN=(e,r)=>{if(r&&Array.isArray(e)){var t=Number.parseInt(r,10);if(!Zc(t))return e[t]}},poe={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},LL=No({name:"options",initialState:poe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),moe=LL.reducer,{createEventEmitter:goe}=LL.actions;function yoe(e){return e.tooltip.syncInteraction}var xoe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},DL=No({name:"chartData",initialState:xoe,reducers:{setChartData(e,r){if(e.chartData=r.payload,r.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}r.payload.length>0&&e.dataEndIndex!==r.payload.length-1&&(e.dataEndIndex=r.payload.length-1)},setComputedData(e,r){e.computedData=r.payload},setDataStartEndIndexes(e,r){var{startIndex:t,endIndex:n}=r.payload;t!=null&&(e.dataStartIndex=t),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:xA,setDataStartEndIndexes:voe,setComputedData:B_e}=DL.actions,boe=DL.reducer,woe=["x","y"];function vA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Bp(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?vA(Object(t),!0).forEach(function(n){_oe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):vA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _oe(e,r,t){return(r=joe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function joe(e){var r=Noe(e,"string");return typeof r=="symbol"?r:r+""}function Noe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function koe(e,r){if(e==null)return{};var t,n,a=Soe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Soe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function Coe(){var e=nr(tN),r=nr(rN),t=rs(),n=nr(PR),a=nr(jd),i=Yf(),o=d1(),c=nr(u=>u.rootProps.className);R.useEffect(()=>{if(e==null)return Xf;var u=(l,d,f)=>{if(r!==f&&e===l){if(n==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:y,y:g}=h,m=koe(h,woe),{x,y:v,width:w,height:_}=d.payload.sourceViewBox,A=Bp(Bp({},m),{},{x:o.x+(w?(y-x)/w:0)*o.width,y:o.y+(_?(g-v)/_:0)*o.height});t(Bp(Bp({},d),{},{payload:Bp(Bp({},d.payload),{},{coordinate:A})}))}else t(d);return}if(a!=null){var P;if(typeof n=="function"){var B={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},T=n(a,B);P=a[T]}else n==="value"&&(P=a.find(k=>String(k.value)===d.payload.label));var{coordinate:I}=d.payload;if(P==null||d.payload.active===!1||I==null||o==null){t(zj({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:U,y:H}=I,z=Math.min(U,o.x+o.width),O=Math.min(H,o.y+o.height),L={x:i==="horizontal"?P.coordinate:z,y:i==="horizontal"?O:P.coordinate},E=zj({active:d.payload.active,coordinate:L,dataKey:d.payload.dataKey,index:String(P.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});t(E)}}};return Mg.on(Vj,u),()=>{Mg.off(Vj,u)}},[c,t,r,e,n,a,i,o])}function Aoe(){var e=nr(tN),r=nr(rN),t=rs();R.useEffect(()=>{if(e==null)return Xf;var n=(a,i,o)=>{r!==o&&e===a&&t(voe(i))};return Mg.on(yA,n),()=>{Mg.off(yA,n)}},[t,r,e])}function Eoe(){var e=rs();R.useEffect(()=>{e(goe())},[e]),Coe(),Aoe()}function Toe(e,r,t,n,a,i){var o=nr(h=>Die(h,e,r)),c=nr(rN),u=nr(tN),l=nr(PR),d=nr(yoe),f=d?.active,p=d1();R.useEffect(()=>{if(!f&&u!=null&&c!=null){var h=zj({active:i,coordinate:t,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:p,graphicalItemId:void 0});Mg.emit(Vj,u,h,c)}},[f,t,o,a,n,c,u,l,i,p])}function bA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function wA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?bA(Object(t),!0).forEach(function(n){Poe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):bA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Poe(e,r,t){return(r=Ooe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ooe(e){var r=Moe(e,"string");return typeof r=="symbol"?r:r+""}function Moe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ioe(e){return e.dataKey}function Roe(e,r){return R.isValidElement(e)?R.cloneElement(e,r):typeof e=="function"?R.createElement(e,r):R.createElement(xee,r)}var _A=[],Loe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Xu(e){var r,t,n=Sa(e,Loe),{active:a,allowEscapeViewBox:i,animationDuration:o,animationEasing:c,content:u,filterNull:l,isAnimationActive:d,offset:f,payloadUniqBy:p,position:h,reverseDirection:y,useTranslate3d:g,wrapperStyle:m,cursor:x,shared:v,trigger:w,defaultIndex:_,portal:A,axisId:P}=n,B=rs(),T=typeof _=="number"?String(_):_;R.useEffect(()=>{B(Pae({shared:v,trigger:w,axisId:P,active:a,defaultIndex:T}))},[B,v,w,P,a,T]);var I=d1(),U=CI(),H=kae(v),{activeIndex:z,isActive:O}=(r=nr(J=>$ie(J,H,w,T)))!==null&&r!==void 0?r:{},L=nr(J=>Bie(J,H,w,T)),E=nr(J=>ML(J,H,w,T)),k=nr(J=>Fie(J,H,w,T)),N=L,S=uoe(),C=(t=a??O)!==null&&t!==void 0?t:!1,[D,q]=EM([N,C]),M=H==="axis"?E:void 0;Toe(H,w,k,M,z,C);var G=A??S;if(G==null||I==null||H==null)return null;var X=N??_A;C||(X=_A),l&&X.length&&(X=NM(X.filter(J=>J.value!=null&&(J.hide!==!0||n.includeHidden)),p,Ioe));var re=X.length>0,V=R.createElement(kee,{allowEscapeViewBox:i,animationDuration:o,animationEasing:c,isAnimationActive:d,active:C,coordinate:k,hasPayload:re,offset:f,position:h,reverseDirection:y,useTranslate3d:g,viewBox:I,wrapperStyle:m,lastBoundingBox:D,innerRef:q,hasPortalFromProps:!!A},Roe(u,wA(wA({},n),{},{payload:X,label:M,active:C,activeIndex:z,coordinate:k,accessibilityLayer:U})));return R.createElement(R.Fragment,null,B4.createPortal(V,G),C&&R.createElement(coe,{cursor:x,tooltipEventType:H,coordinate:k,payload:X,index:z}))}var Jf=e=>null;Jf.displayName="Cell";function Doe(e,r,t){return(r=Foe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Foe(e){var r=Boe(e,"string");return typeof r=="symbol"?r:r+""}function Boe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class $oe{constructor(r){Doe(this,"cache",new Map),this.maxSize=r}get(r){var t=this.cache.get(r);return t!==void 0&&(this.cache.delete(r),this.cache.set(r,t)),t}set(r,t){if(this.cache.has(r))this.cache.delete(r);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(r,t)}clear(){this.cache.clear()}size(){return this.cache.size}}function jA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function qoe(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?jA(Object(t),!0).forEach(function(n){zoe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function zoe(e,r,t){return(r=Uoe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Uoe(e){var r=Hoe(e,"string");return typeof r=="symbol"?r:r+""}function Hoe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Voe={cacheSize:2e3,enableCache:!0},FL=qoe({},Voe),NA=new $oe(FL.cacheSize),Woe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},kA="recharts_measurement_span";function Koe(e,r){var t=r.fontSize||"",n=r.fontFamily||"",a=r.fontWeight||"",i=r.fontStyle||"",o=r.letterSpacing||"",c=r.textTransform||"";return"".concat(e,"|").concat(t,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(o,"|").concat(c)}var SA=(e,r)=>{try{var t=document.getElementById(kA);t||(t=document.createElement("span"),t.setAttribute("id",kA),t.setAttribute("aria-hidden","true"),document.body.appendChild(t)),Object.assign(t.style,Woe,r),t.textContent="".concat(e);var n=t.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Z0=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||m1.isSsr)return{width:0,height:0};if(!FL.enableCache)return SA(r,t);var n=Koe(r,t),a=NA.get(n);if(a)return a;var i=SA(r,t);return NA.set(n,i),i},BL;function Goe(e,r,t){return(r=Xoe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Xoe(e){var r=Yoe(e,"string");return typeof r=="symbol"?r:r+""}function Yoe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var CA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,AA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Qoe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Zoe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Joe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ele=["cm","mm","pt","pc","in","Q","px"];function tle(e){return ele.includes(e)}var rm="NaN";function rle(e,r){return e*Joe[r]}class wi{static parse(r){var t,[,n,a]=(t=Zoe.exec(r))!==null&&t!==void 0?t:[];return n==null?wi.NaN:new wi(parseFloat(n),a??"")}constructor(r,t){this.num=r,this.unit=t,this.num=r,this.unit=t,Zc(r)&&(this.unit=""),t!==""&&!Qoe.test(t)&&(this.num=NaN,this.unit=""),tle(t)&&(this.num=rle(r,t),this.unit="px")}add(r){return this.unit!==r.unit?new wi(NaN,""):new wi(this.num+r.num,this.unit)}subtract(r){return this.unit!==r.unit?new wi(NaN,""):new wi(this.num-r.num,this.unit)}multiply(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new wi(NaN,""):new wi(this.num*r.num,this.unit||r.unit)}divide(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new wi(NaN,""):new wi(this.num/r.num,this.unit||r.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Zc(this.num)}}BL=wi;Goe(wi,"NaN",new BL(NaN,""));function $L(e){if(e==null||e.includes(rm))return rm;for(var r=e;r.includes("*")||r.includes("/");){var t,[,n,a,i]=(t=CA.exec(r))!==null&&t!==void 0?t:[],o=wi.parse(n??""),c=wi.parse(i??""),u=a==="*"?o.multiply(c):o.divide(c);if(u.isNaN())return rm;r=r.replace(CA,u.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var l,[,d,f,p]=(l=AA.exec(r))!==null&&l!==void 0?l:[],h=wi.parse(d??""),y=wi.parse(p??""),g=f==="+"?h.add(y):h.subtract(y);if(g.isNaN())return rm;r=r.replace(AA,g.toString())}return r}var EA=/\(([^()]*)\)/;function nle(e){for(var r=e,t;(t=EA.exec(r))!=null;){var[,n]=t;r=r.replace(EA,$L(n))}return r}function sle(e){var r=e.replace(/\s+/g,"");return r=nle(r),r=$L(r),r}function ale(e){try{return sle(e)}catch{return rm}}function v_(e){var r=ale(e.slice(5,-1));return r===rm?"":r}var ile=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],ole=["dx","dy","angle","className","breakAll"];function Wj(){return Wj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Wj.apply(null,arguments)}function TA(e,r){if(e==null)return{};var t,n,a=lle(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function lle(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var qL=/[ \f\n\r\t\v\u2028\u2029]+/,zL=e=>{var{children:r,breakAll:t,style:n}=e;try{var a=[];Ms(r)||(t?a=r.toString().split(""):a=r.toString().split(qL));var i=a.map(c=>({word:c,width:Z0(c,n).width})),o=t?0:Z0("",n).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}};function cle(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var UL=(e,r,t,n)=>e.reduce((a,i)=>{var{word:o,width:c}=i,u=a[a.length-1];if(u&&c!=null&&(r==null||n||u.width+c+t<Number(r)))u.words.push(o),u.width+=c+t;else{var l={words:[o],width:c};a.push(l)}return a},[]),HL=e=>e.reduce((r,t)=>r.width>t.width?r:t),ule="",PA=(e,r,t,n,a,i,o,c)=>{var u=e.slice(0,r),l=zL({breakAll:t,style:n,children:u+ule});if(!l)return[!1,[]];var d=UL(l.wordsWithComputedWidth,i,o,c),f=d.length>a||HL(d).width>Number(i);return[f,d]},dle=(e,r,t,n,a)=>{var{maxLines:i,children:o,style:c,breakAll:u}=e,l=Vt(i),d=String(o),f=UL(r,n,t,a);if(!l||a)return f;var p=f.length>i||HL(f).width>Number(n);if(!p)return f;for(var h=0,y=d.length-1,g=0,m;h<=y&&g<=d.length-1;){var x=Math.floor((h+y)/2),v=x-1,[w,_]=PA(d,v,u,c,i,n,t,a),[A]=PA(d,x,u,c,i,n,t,a);if(!w&&!A&&(h=x+1),w&&A&&(y=x-1),!w&&A){m=_;break}g++}return m||f},OA=e=>{var r=Ms(e)?[]:e.toString().split(qL);return[{words:r,width:void 0}]},hle=e=>{var{width:r,scaleToFit:t,children:n,style:a,breakAll:i,maxLines:o}=e;if((r||t)&&!m1.isSsr){var c,u,l=zL({breakAll:i,children:n,style:a});if(l){var{wordsWithComputedWidth:d,spaceWidth:f}=l;c=d,u=f}else return OA(n);return dle({breakAll:i,children:n,maxLines:o,style:a},c,u,r,!!t)}return OA(n)},VL="#808080",fle={angle:0,breakAll:!1,capHeight:"0.71em",fill:VL,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},R1=R.forwardRef((e,r)=>{var t=Sa(e,fle),{x:n,y:a,lineHeight:i,capHeight:o,fill:c,scaleToFit:u,textAnchor:l,verticalAnchor:d}=t,f=TA(t,ile),p=R.useMemo(()=>hle({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:u,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,u,f.style,f.width]),{dx:h,dy:y,angle:g,className:m,breakAll:x}=f,v=TA(f,ole);if(!Jc(n)||!Jc(a)||p.length===0)return null;var w=Number(n)+(Vt(h)?h:0),_=Number(a)+(Vt(y)?y:0);if(!un(w)||!un(_))return null;var A;switch(d){case"start":A=v_("calc(".concat(o,")"));break;case"middle":A=v_("calc(".concat((p.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:A=v_("calc(".concat(p.length-1," * -").concat(i,")"));break}var P=[],B=p[0];if(u&&B!=null){var T=B.width,{width:I}=f;P.push("scale(".concat(Vt(I)&&Vt(T)?I/T:1,")"))}return g&&P.push("rotate(".concat(g,", ").concat(w,", ").concat(_,")")),P.length&&(v.transform=P.join(" ")),R.createElement("text",Wj({},ro(v),{ref:r,x:w,y:_,className:yn("recharts-text",m),textAnchor:l,fill:c.includes("url")?VL:c}),p.map((U,H)=>{var z=U.words.join(x?"":" ");return R.createElement("tspan",{x:w,dy:H===0?A:i,key:"".concat(z,"-").concat(H)},z)}))});R1.displayName="Text";function MA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Dc(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?MA(Object(t),!0).forEach(function(n){ple(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):MA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ple(e,r,t){return(r=mle(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function mle(e){var r=gle(e,"string");return typeof r=="symbol"?r:r+""}function gle(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var yle=e=>{var{viewBox:r,position:t,offset:n=0,parentViewBox:a}=e,{x:i,y:o,height:c,upperWidth:u,lowerWidth:l}=_3(r),d=i,f=i+(u-l)/2,p=(d+f)/2,h=(u+l)/2,y=d+u/2,g=c>=0?1:-1,m=g*n,x=g>0?"end":"start",v=g>0?"start":"end",w=u>=0?1:-1,_=w*n,A=w>0?"end":"start",P=w>0?"start":"end",B=a;if(t==="top"){var T={x:d+u/2,y:o-m,horizontalAnchor:"middle",verticalAnchor:x};return B&&(T.height=Math.max(o-B.y,0),T.width=u),T}if(t==="bottom"){var I={x:f+l/2,y:o+c+m,horizontalAnchor:"middle",verticalAnchor:v};return B&&(I.height=Math.max(B.y+B.height-(o+c),0),I.width=l),I}if(t==="left"){var U={x:p-_,y:o+c/2,horizontalAnchor:A,verticalAnchor:"middle"};return B&&(U.width=Math.max(U.x-B.x,0),U.height=c),U}if(t==="right"){var H={x:p+h+_,y:o+c/2,horizontalAnchor:P,verticalAnchor:"middle"};return B&&(H.width=Math.max(B.x+B.width-H.x,0),H.height=c),H}var z=B?{width:h,height:c}:{};return t==="insideLeft"?Dc({x:p+_,y:o+c/2,horizontalAnchor:P,verticalAnchor:"middle"},z):t==="insideRight"?Dc({x:p+h-_,y:o+c/2,horizontalAnchor:A,verticalAnchor:"middle"},z):t==="insideTop"?Dc({x:d+u/2,y:o+m,horizontalAnchor:"middle",verticalAnchor:v},z):t==="insideBottom"?Dc({x:f+l/2,y:o+c-m,horizontalAnchor:"middle",verticalAnchor:x},z):t==="insideTopLeft"?Dc({x:d+_,y:o+m,horizontalAnchor:P,verticalAnchor:v},z):t==="insideTopRight"?Dc({x:d+u-_,y:o+m,horizontalAnchor:A,verticalAnchor:v},z):t==="insideBottomLeft"?Dc({x:f+_,y:o+c-m,horizontalAnchor:P,verticalAnchor:x},z):t==="insideBottomRight"?Dc({x:f+l-_,y:o+c-m,horizontalAnchor:A,verticalAnchor:x},z):t&&typeof t=="object"&&(Vt(t.x)||Bf(t.x))&&(Vt(t.y)||Bf(t.y))?Dc({x:i+qi(t.x,h),y:o+qi(t.y,c),horizontalAnchor:"end",verticalAnchor:"end"},z):Dc({x:y,y:o+c/2,horizontalAnchor:"middle",verticalAnchor:"middle"},z)},xle=["labelRef"],vle=["content"];function IA(e,r){if(e==null)return{};var t,n,a=ble(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function ble(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function RA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function G0(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?RA(Object(t),!0).forEach(function(n){wle(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):RA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function wle(e,r,t){return(r=_le(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _le(e){var r=jle(e,"string");return typeof r=="symbol"?r:r+""}function jle(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Vu.apply(null,arguments)}var WL=R.createContext(null),Nle=e=>{var{x:r,y:t,upperWidth:n,lowerWidth:a,width:i,height:o,children:c}=e,u=R.useMemo(()=>({x:r,y:t,upperWidth:n,lowerWidth:a,width:i,height:o}),[r,t,n,a,i,o]);return R.createElement(WL.Provider,{value:u},c)},KL=()=>{var e=R.useContext(WL),r=d1();return e||(r?_3(r):void 0)},kle=R.createContext(null),Sle=()=>{var e=R.useContext(kle),r=nr(LR);return e||r},Cle=e=>{var{value:r,formatter:t}=e,n=Ms(e.children)?r:e.children;return typeof t=="function"?t(n):n},BN=e=>e!=null&&typeof e=="function",Ale=(e,r)=>{var t=ni(r-e),n=Math.min(Math.abs(r-e),360);return t*n},Ele=(e,r,t,n,a)=>{var{offset:i,className:o}=e,{cx:c,cy:u,innerRadius:l,outerRadius:d,startAngle:f,endAngle:p,clockWise:h}=a,y=(l+d)/2,g=Ale(f,p),m=g>=0?1:-1,x,v;switch(r){case"insideStart":x=f+m*i,v=h;break;case"insideEnd":x=p-m*i,v=!h;break;case"end":x=p+m*i,v=h;break;default:throw new Error("Unsupported position ".concat(r))}v=g<=0?v:!v;var w=wa(c,u,y,x),_=wa(c,u,y,x+(v?1:-1)*359),A="M".concat(w.x,",").concat(w.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(v?0:1,`,
    `).concat(_.x,",").concat(_.y),P=Ms(e.id)?bg("recharts-radial-line-"):e.id;return R.createElement("text",Vu({},n,{dominantBaseline:"central",className:yn("recharts-radial-bar-label",o)}),R.createElement("defs",null,R.createElement("path",{id:P,d:A})),R.createElement("textPath",{xlinkHref:"#".concat(P)},t))},Tle=(e,r,t)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:c,endAngle:u}=e,l=(c+u)/2;if(t==="outside"){var{x:d,y:f}=wa(n,a,o+r,l);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(t==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(t==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(t==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(i+o)/2,{x:h,y}=wa(n,a,p,l);return{x:h,y,textAnchor:"middle",verticalAnchor:"middle"}},nv=e=>e!=null&&"cx"in e&&Vt(e.cx),Ple={angle:0,offset:5,zIndex:_a.label,position:"middle",textBreakAll:!1};function Ole(e){if(!nv(e))return e;var{cx:r,cy:t,outerRadius:n}=e,a=n*2;return{x:r-n,y:t-n,width:a,upperWidth:a,lowerWidth:a,height:a}}function ih(e){var r=Sa(e,Ple),{viewBox:t,parentViewBox:n,position:a,value:i,children:o,content:c,className:u="",textBreakAll:l,labelRef:d}=r,f=Sle(),p=KL(),h=a==="center"?p:f??p,y,g,m;t==null?y=h:nv(t)?y=t:y=_3(t);var x=Ole(y);if(!y||Ms(i)&&Ms(o)&&!R.isValidElement(c)&&typeof c!="function")return null;var v=G0(G0({},r),{},{viewBox:y});if(R.isValidElement(c)){var{labelRef:w}=v,_=IA(v,xle);return R.cloneElement(c,_)}if(typeof c=="function"){var{content:A}=v,P=IA(v,vle);if(g=R.createElement(c,P),R.isValidElement(g))return g}else g=Cle(r);var B=ro(r);if(nv(y)){if(a==="insideStart"||a==="insideEnd"||a==="end")return Ele(r,a,g,B,y);m=Tle(y,r.offset,r.position)}else{if(!x)return null;var T=yle({viewBox:x,position:a,offset:r.offset,parentViewBox:nv(n)?void 0:n});m=G0(G0({x:T.x,y:T.y,textAnchor:T.horizontalAnchor,verticalAnchor:T.verticalAnchor},T.width!==void 0?{width:T.width}:{}),T.height!==void 0?{height:T.height}:{})}return R.createElement(ko,{zIndex:r.zIndex},R.createElement(R1,Vu({ref:d,className:yn("recharts-label",u)},B,m,{textAnchor:cle(B.textAnchor)?B.textAnchor:m.textAnchor,breakAll:l}),g))}ih.displayName="Label";var Mle=(e,r,t)=>{if(!e)return null;var n={viewBox:r,labelRef:t};return e===!0?R.createElement(ih,Vu({key:"label-implicit"},n)):Jc(e)?R.createElement(ih,Vu({key:"label-implicit",value:e},n)):R.isValidElement(e)?e.type===ih?R.cloneElement(e,G0({key:"label-implicit"},n)):R.createElement(ih,Vu({key:"label-implicit",content:e},n)):BN(e)?R.createElement(ih,Vu({key:"label-implicit",content:e},n)):e&&typeof e=="object"?R.createElement(ih,Vu({},e,{key:"label-implicit"},n)):null};function Ile(e){var{label:r,labelRef:t}=e,n=KL();return Mle(r,n,t)||null}var b_={},w_={},LA;function Rle(){return LA||(LA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return t[t.length-1]}e.last=r})(w_)),w_}var __={},DA;function Lle(){return DA||(DA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){return Array.isArray(t)?t:Array.from(t)}e.toArray=r})(__)),__}var FA;function Dle(){return FA||(FA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Rle(),t=Lle(),n=d3();function a(i){if(n.isArrayLike(i))return r.last(t.toArray(i))}e.last=a})(b_)),b_}var j_,BA;function Fle(){return BA||(BA=1,j_=Dle().last),j_}var Ble=Fle();const $le=ru(Ble);var qle=["valueAccessor"],zle=["dataKey","clockWise","id","textBreakAll","zIndex"];function lb(){return lb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},lb.apply(null,arguments)}function $A(e,r){if(e==null)return{};var t,n,a=Ule(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Ule(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Hle=e=>Array.isArray(e.value)?$le(e.value):e.value,GL=R.createContext(void 0),XL=GL.Provider,YL=R.createContext(void 0),Vle=YL.Provider;function Wle(){return R.useContext(GL)}function Kle(){return R.useContext(YL)}function sv(e){var{valueAccessor:r=Hle}=e,t=$A(e,qle),{dataKey:n,clockWise:a,id:i,textBreakAll:o,zIndex:c}=t,u=$A(t,zle),l=Wle(),d=Kle(),f=l||d;return!f||!f.length?null:R.createElement(ko,{zIndex:c??_a.label},R.createElement(oi,{className:"recharts-label-list"},f.map((p,h)=>{var y,g=Ms(n)?r(p,h):Hn(p.payload,n),m=Ms(i)?{}:{id:"".concat(i,"-").concat(h)};return R.createElement(ih,lb({key:"label-".concat(h)},ro(p),u,m,{fill:(y=t.fill)!==null&&y!==void 0?y:p.fill,parentViewBox:p.parentViewBox,value:g,textBreakAll:o,viewBox:p.viewBox,index:h,zIndex:0}))})))}sv.displayName="LabelList";function $N(e){var{label:r}=e;return r?r===!0?R.createElement(sv,{key:"labelList-implicit"}):R.isValidElement(r)||BN(r)?R.createElement(sv,{key:"labelList-implicit",content:r}):typeof r=="object"?R.createElement(sv,lb({key:"labelList-implicit"},r,{type:String(r.type)})):null:null}function Kj(){return Kj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Kj.apply(null,arguments)}var QL=e=>{var{cx:r,cy:t,r:n,className:a}=e,i=yn("recharts-dot",a);return Vt(r)&&Vt(t)&&Vt(n)?R.createElement("circle",Kj({},Zo(e),u3(e),{className:i,cx:r,cy:t,r:n})):null},ZL=e=>e.graphicalItems.polarItems,Gle=Xe([Rs,uy],lN),L1=Xe([ZL,Xs,Gle],cN),Xle=Xe([L1],uN),D1=Xe([Xle,_1],dN),Yle=Xe([D1,Xs,L1],fN);Xe([D1,Xs,L1],(e,r,t)=>t.length>0?e.flatMap(n=>t.flatMap(a=>{var i,o=Hn(n,(i=r.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):r?.dataKey!=null?e.map(n=>({value:Hn(n,r.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var qA=()=>{},Qle=Xe([D1,Xs,L1,P1,Rs],yN),Zle=Xe([Xs,mN,gN,qA,Qle,qA,wn,Rs],xN),JL=Xe([Xs,wn,D1,Yle,cy,Rs,Zle],vN),Jle=Xe([JL,zm,Sh],_N),ece=Xe([Xs,JL,Jle,Rs],NN);Xe([Sh,ece],FR);var tce={radiusAxis:{},angleAxis:{}},eD=No({name:"polarAxis",initialState:tce,reducers:{addRadiusAxis(e,r){e.radiusAxis[r.payload.id]=r.payload},removeRadiusAxis(e,r){delete e.radiusAxis[r.payload.id]},addAngleAxis(e,r){e.angleAxis[r.payload.id]=r.payload},removeAngleAxis(e,r){delete e.angleAxis[r.payload.id]}}}),{addRadiusAxis:$_e,removeRadiusAxis:q_e,addAngleAxis:z_e,removeAngleAxis:U_e}=eD.actions,rce=eD.reducer;function tD(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function zA(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function UA(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?zA(Object(t),!0).forEach(function(n){nce(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):zA(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function nce(e,r,t){return(r=sce(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function sce(e){var r=ace(e,"string");return typeof r=="symbol"?r:r+""}function ace(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ice=(e,r)=>r,qN=Xe([ZL,ice],(e,r)=>e.filter(t=>t.type==="pie").find(t=>t.id===r)),oce=[],zN=(e,r,t)=>t?.length===0?oce:t,rD=Xe([_1,qN,zN],(e,r,t)=>{var{chartData:n}=e;if(r!=null){var a;if(r?.data!=null&&r.data.length>0?a=r.data:a=n,(!a||!a.length)&&t!=null&&(a=t.map(i=>UA(UA({},r.presentationProps),i.props))),a!=null)return a}}),lce=Xe([rD,qN,zN],(e,r,t)=>{if(!(e==null||r==null))return e.map((n,a)=>{var i,o=Hn(n,r.nameKey,r.name),c;return t!=null&&(i=t[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?c=t[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?c=n.fill:c=r.fill,{value:Dm(o,r.dataKey),color:c,payload:n,type:r.legendType}})}),cce=Xe([rD,qN,zN,qa],(e,r,t,n)=>{if(!(r==null||e==null))return uue({offset:n,pieSettings:r,displayedData:e,cells:t})}),N_={exports:{}},zn={};var HA;function uce(){if(HA)return zn;HA=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.view_transition"),h=Symbol.for("react.client.reference");function y(g){if(typeof g=="object"&&g!==null){var m=g.$$typeof;switch(m){case e:switch(g=g.type,g){case t:case a:case n:case u:case l:case p:return g;default:switch(g=g&&g.$$typeof,g){case o:case c:case f:case d:return g;case i:return g;default:return m}}case r:return m}}}return zn.ContextConsumer=i,zn.ContextProvider=o,zn.Element=e,zn.ForwardRef=c,zn.Fragment=t,zn.Lazy=f,zn.Memo=d,zn.Portal=r,zn.Profiler=a,zn.StrictMode=n,zn.Suspense=u,zn.SuspenseList=l,zn.isContextConsumer=function(g){return y(g)===i},zn.isContextProvider=function(g){return y(g)===o},zn.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},zn.isForwardRef=function(g){return y(g)===c},zn.isFragment=function(g){return y(g)===t},zn.isLazy=function(g){return y(g)===f},zn.isMemo=function(g){return y(g)===d},zn.isPortal=function(g){return y(g)===r},zn.isProfiler=function(g){return y(g)===a},zn.isStrictMode=function(g){return y(g)===n},zn.isSuspense=function(g){return y(g)===u},zn.isSuspenseList=function(g){return y(g)===l},zn.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===t||g===a||g===n||g===u||g===l||typeof g=="object"&&g!==null&&(g.$$typeof===f||g.$$typeof===d||g.$$typeof===o||g.$$typeof===i||g.$$typeof===c||g.$$typeof===h||g.getModuleId!==void 0)},zn.typeOf=y,zn}var VA;function dce(){return VA||(VA=1,N_.exports=uce()),N_.exports}var hce=dce(),WA=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",KA=null,k_=null,nD=e=>{if(e===KA&&Array.isArray(k_))return k_;var r=[];return R.Children.forEach(e,t=>{Ms(t)||(hce.isFragment(t)?r=r.concat(nD(t.props.children)):r.push(t))}),k_=r,KA=e,r};function UN(e,r){var t=[],n=[];return Array.isArray(r)?n=r.map(a=>WA(a)):n=[WA(r)],nD(e).forEach(a=>{var i=Ff(a,"type.displayName")||Ff(a,"type.name");i&&n.indexOf(i)!==-1&&t.push(a)}),t}var sD=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,S_={},GA;function fce(){return GA||(GA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const a=t[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${a}]`}let n=t;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n}e.isPlainObject=r})(S_)),S_}var C_,XA;function pce(){return XA||(XA=1,C_=fce().isPlainObject),C_}var mce=pce();const gce=ru(mce);var YA,QA,ZA,JA,eE;function tE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function rE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?tE(Object(t),!0).forEach(function(n){yce(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function yce(e,r,t){return(r=xce(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function xce(e){var r=vce(e,"string");return typeof r=="symbol"?r:r+""}function vce(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function cb(){return cb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},cb.apply(null,arguments)}function T0(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var nE=(e,r,t,n,a)=>{var i=t-n,o;return o=Vs(YA||(YA=T0(["M ",",",""])),e,r),o+=Vs(QA||(QA=T0(["L ",",",""])),e+t,r),o+=Vs(ZA||(ZA=T0(["L ",",",""])),e+t-i/2,r+a),o+=Vs(JA||(JA=T0(["L ",",",""])),e+t-i/2-n,r+a),o+=Vs(eE||(eE=T0(["L ",","," Z"])),e,r),o},bce={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},wce=e=>{var r=Sa(e,bce),{x:t,y:n,upperWidth:a,lowerWidth:i,height:o,className:c}=r,{animationEasing:u,animationDuration:l,animationBegin:d,isUpdateAnimationActive:f}=r,p=R.useRef(null),[h,y]=R.useState(-1),g=R.useRef(a),m=R.useRef(i),x=R.useRef(o),v=R.useRef(t),w=R.useRef(n),_=sy(e,"trapezoid-");if(R.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var L=p.current.getTotalLength();L&&y(L)}catch{}},[]),t!==+t||n!==+n||a!==+a||i!==+i||o!==+o||a===0&&i===0||o===0)return null;var A=yn("recharts-trapezoid",c);if(!f)return R.createElement("g",null,R.createElement("path",cb({},ro(r),{className:A,d:nE(t,n,a,i,o)})));var P=g.current,B=m.current,T=x.current,I=v.current,U=w.current,H="0px ".concat(h===-1?1:h,"px"),z="".concat(h,"px 0px"),O=AI(["strokeDasharray"],l,u);return R.createElement(ny,{animationId:_,key:_,canBegin:h>0,duration:l,easing:u,isActive:f,begin:d},L=>{var E=vs(P,a,L),k=vs(B,i,L),N=vs(T,o,L),S=vs(I,t,L),C=vs(U,n,L);p.current&&(g.current=E,m.current=k,x.current=N,v.current=S,w.current=C);var D=L>0?{transition:O,strokeDasharray:z}:{strokeDasharray:H};return R.createElement("path",cb({},ro(r),{className:A,d:nE(S,C,E,k,N),ref:p,style:rE(rE({},D),r.style)}))})},_ce=["option","shapeType","activeClassName"];function jce(e,r){if(e==null)return{};var t,n,a=Nce(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Nce(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function sE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ub(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?sE(Object(t),!0).forEach(function(n){kce(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function kce(e,r,t){return(r=Sce(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Sce(e){var r=Cce(e,"string");return typeof r=="symbol"?r:r+""}function Cce(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ace(e,r){return ub(ub({},r),e)}function Ece(e,r){return e==="symbols"}function aE(e){var{shapeType:r,elementProps:t}=e;switch(r){case"rectangle":return R.createElement(OI,t);case"trapezoid":return R.createElement(wce,t);case"sector":return R.createElement(LI,t);case"symbols":if(Ece(r))return R.createElement(c3,t);break;case"curve":return R.createElement(C3,t);default:return null}}function Tce(e){return R.isValidElement(e)?e.props:e}function HN(e){var{option:r,shapeType:t,activeClassName:n="recharts-active-shape"}=e,a=jce(e,_ce),i;if(R.isValidElement(r))i=R.cloneElement(r,ub(ub({},a),Tce(r)));else if(typeof r=="function")i=r(a,a.index);else if(gce(r)&&typeof r!="boolean"){var o=Ace(r,a);i=R.createElement(aE,{shapeType:t,elementProps:o})}else{var c=a;i=R.createElement(aE,{shapeType:t,elementProps:c})}return a.isActive?R.createElement(oi,{className:n},i):i}var VN=(e,r,t)=>{var n=rs();return(a,i)=>o=>{e?.(a,i,o),n(pL({activeIndex:String(i),activeDataKey:r,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:t}))}},WN=e=>{var r=rs();return(t,n)=>a=>{e?.(t,n,a),r(Oae())}},KN=(e,r,t)=>{var n=rs();return(a,i)=>o=>{e?.(a,i,o),n(Mae({activeIndex:String(i),activeDataKey:r,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:t}))}};function GN(e){var{tooltipEntrySettings:r}=e,t=rs(),n=Ui(),a=R.useRef(null);return R.useLayoutEffect(()=>{n||(a.current===null?t(Aae(r)):a.current!==r&&t(Eae({prev:a.current,next:r})),a.current=r)},[r,t,n]),R.useLayoutEffect(()=>()=>{a.current&&(t(Tae(a.current)),a.current=null)},[t]),null}function aD(e){var{legendPayload:r}=e,t=rs(),n=Ui(),a=R.useRef(null);return R.useLayoutEffect(()=>{n||(a.current===null?t(NI(r)):a.current!==r&&t(kI({prev:a.current,next:r})),a.current=r)},[t,n,r]),R.useLayoutEffect(()=>()=>{a.current&&(t(SI(a.current)),a.current=null)},[t]),null}function Pce(e){var{legendPayload:r}=e,t=rs(),n=nr(wn),a=R.useRef(null);return R.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?t(NI(r)):a.current!==r&&t(kI({prev:a.current,next:r})),a.current=r)},[t,n,r]),R.useLayoutEffect(()=>()=>{a.current&&(t(SI(a.current)),a.current=null)},[t]),null}var A_,Oce=()=>{var[e]=R.useState(()=>bg("uid-"));return e},Mce=(A_=p$.useId)!==null&&A_!==void 0?A_:Oce;function Ice(e,r){var t=Mce();return r||(e?"".concat(e,"-").concat(t):t)}var Rce=R.createContext(void 0),XN=e=>{var{id:r,type:t,children:n}=e,a=Ice("recharts-".concat(t),r);return R.createElement(Rce.Provider,{value:a},n(a))},Lce={cartesianItems:[],polarItems:[]},iD=No({name:"graphicalItems",initialState:Lce,reducers:{addCartesianGraphicalItem:{reducer(e,r){e.cartesianItems.push(r.payload)},prepare:xs()},replaceCartesianGraphicalItem:{reducer(e,r){var{prev:t,next:n}=r.payload,a=cc(e).cartesianItems.indexOf(t);a>-1&&(e.cartesianItems[a]=n)},prepare:xs()},removeCartesianGraphicalItem:{reducer(e,r){var t=cc(e).cartesianItems.indexOf(r.payload);t>-1&&e.cartesianItems.splice(t,1)},prepare:xs()},addPolarGraphicalItem:{reducer(e,r){e.polarItems.push(r.payload)},prepare:xs()},removePolarGraphicalItem:{reducer(e,r){var t=cc(e).polarItems.indexOf(r.payload);t>-1&&e.polarItems.splice(t,1)},prepare:xs()}}}),{addCartesianGraphicalItem:Dce,replaceCartesianGraphicalItem:Fce,removeCartesianGraphicalItem:Bce,addPolarGraphicalItem:$ce,removePolarGraphicalItem:qce}=iD.actions,zce=iD.reducer,Uce=e=>{var r=rs(),t=R.useRef(null);return R.useLayoutEffect(()=>{t.current===null?r(Dce(e)):t.current!==e&&r(Fce({prev:t.current,next:e})),t.current=e},[r,e]),R.useLayoutEffect(()=>()=>{t.current&&(r(Bce(t.current)),t.current=null)},[r]),null},oD=R.memo(Uce);function Hce(e){var r=rs();return R.useLayoutEffect(()=>(r($ce(e)),()=>{r(qce(e))}),[r,e]),null}var Vce=["key"],Wce=["onMouseEnter","onClick","onMouseLeave"],Kce=["id"],Gce=["id"];function iE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ws(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?iE(Object(t),!0).forEach(function(n){Xce(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):iE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Xce(e,r,t){return(r=Yce(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Yce(e){var r=Qce(e,"string");return typeof r=="symbol"?r:r+""}function Qce(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},bh.apply(null,arguments)}function F1(e,r){if(e==null)return{};var t,n,a=Zce(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Zce(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function Jce(e){var r=R.useMemo(()=>UN(e.children,Jf),[e.children]),t=nr(n=>lce(n,e.id,r));return t==null?null:R.createElement(Pce,{legendPayload:t})}var eue=R.memo(e=>{var{dataKey:r,nameKey:t,sectors:n,stroke:a,strokeWidth:i,fill:o,name:c,hide:u,tooltipType:l,id:d}=e,f={dataDefinedOnItem:n.map(p=>p.tooltipPayload),getPosition:p=>{var h;return(h=n[Number(p)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:a,strokeWidth:i,fill:o,dataKey:r,nameKey:t,name:Dm(c,r),hide:u,type:l,color:o,unit:"",graphicalItemId:d}};return R.createElement(GN,{tooltipEntrySettings:f})}),tue=(e,r)=>e>r?"start":e<r?"end":"middle",rue=(e,r,t)=>qi(typeof r=="function"?r(e):r,t,t*.8),nue=(e,r,t)=>{var{top:n,left:a,width:i,height:o}=r,c=MI(i,o),u=a+qi(e.cx,i,i/2),l=n+qi(e.cy,o,o/2),d=qi(e.innerRadius,c,0),f=rue(t,e.outerRadius,c),p=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:u,cy:l,innerRadius:d,outerRadius:f,maxRadius:p}},sue=(e,r)=>{var t=ni(r-e),n=Math.min(Math.abs(r-e),360);return t*n},aue=(e,r)=>{if(R.isValidElement(e))return R.cloneElement(e,r);if(typeof e=="function")return e(r);var t=yn("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=r,a=F1(r,Vce);return R.createElement(C3,bh({},a,{type:"linear",className:t}))},iue=(e,r,t)=>{if(R.isValidElement(e))return R.cloneElement(e,r);var n=t;if(typeof e=="function"&&(n=e(r),R.isValidElement(n)))return n;var a=yn("recharts-pie-label-text",tD(e));return R.createElement(R1,bh({},r,{alignmentBaseline:"middle",className:a}),n)};function oue(e){var{sectors:r,props:t,showLabels:n}=e,{label:a,labelLine:i,dataKey:o}=t;if(!n||!a||!r)return null;var c=Zo(t),u=Lf(a),l=Lf(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=r.map((p,h)=>{var y=(p.startAngle+p.endAngle)/2,g=wa(p.cx,p.cy,p.outerRadius+d,y),m=Ws(Ws(Ws(Ws({},c),p),{},{stroke:"none"},u),{},{index:h,textAnchor:tue(g.x,p.cx)},g),x=Ws(Ws(Ws(Ws({},c),p),{},{fill:"none",stroke:p.fill},l),{},{index:h,points:[wa(p.cx,p.cy,p.outerRadius,y),g],key:"line"});return R.createElement(ko,{zIndex:_a.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(h)},R.createElement(oi,null,i&&aue(i,x),iue(a,m,Hn(p,o))))});return R.createElement(oi,{className:"recharts-pie-labels"},f)}function lue(e){var{sectors:r,props:t,showLabels:n}=e,{label:a}=t;return typeof a=="object"&&a!=null&&"position"in a?R.createElement($N,{label:a}):R.createElement(oue,{sectors:r,props:t,showLabels:n})}function cue(e){var{sectors:r,activeShape:t,inactiveShape:n,allOtherPieProps:a,shape:i,id:o}=e,c=nr(vh),u=nr(MN),l=nr(xie),{onMouseEnter:d,onClick:f,onMouseLeave:p}=a,h=F1(a,Wce),y=VN(d,a.dataKey,o),g=WN(p),m=KN(f,a.dataKey,o);return r==null||r.length===0?null:R.createElement(R.Fragment,null,r.map((x,v)=>{if(x?.startAngle===0&&x?.endAngle===0&&r.length!==1)return null;var w=l==null||l===o,_=String(v)===c&&(u==null||a.dataKey===u)&&w,A=c?n:null,P=t&&_?t:A,B=Ws(Ws({},x),{},{stroke:x.stroke,tabIndex:-1,[cI]:v,[uI]:o});return R.createElement(oi,bh({key:"sector-".concat(x?.startAngle,"-").concat(x?.endAngle,"-").concat(x.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},Qg(h,x,v),{onMouseEnter:y(x,v),onMouseLeave:g(x,v),onClick:m(x,v)}),R.createElement(HN,bh({option:i??P,index:v,shapeType:"sector",isActive:_},B)))}))}function uue(e){var r,{pieSettings:t,displayedData:n,cells:a,offset:i}=e,{cornerRadius:o,startAngle:c,endAngle:u,dataKey:l,nameKey:d,tooltipType:f}=t,p=Math.abs(t.minAngle),h=sue(c,u),y=Math.abs(h),g=n.length<=1?0:(r=t.paddingAngle)!==null&&r!==void 0?r:0,m=n.filter(P=>Hn(P,l,0)!==0).length,x=(y>=360?m:m-1)*g,v=y-m*p-x,w=n.reduce((P,B)=>{var T=Hn(B,l,0);return P+(Vt(T)?T:0)},0),_;if(w>0){var A;_=n.map((P,B)=>{var T=Hn(P,l,0),I=Hn(P,d,B),U=nue(t,i,P),H=(Vt(T)?T:0)/w,z,O=Ws(Ws({},P),a&&a[B]&&a[B].props);B?z=A.endAngle+ni(h)*g*(T!==0?1:0):z=c;var L=z+ni(h)*((T!==0?p:0)+H*v),E=(z+L)/2,k=(U.innerRadius+U.outerRadius)/2,N=[{name:I,value:T,payload:O,dataKey:l,type:f,graphicalItemId:t.id}],S=wa(U.cx,U.cy,k,E);return A=Ws(Ws(Ws(Ws({},t.presentationProps),{},{percent:H,cornerRadius:typeof o=="string"?parseFloat(o):o,name:I,tooltipPayload:N,midAngle:E,middleRadius:k,tooltipPosition:S},O),U),{},{value:T,dataKey:l,startAngle:z,endAngle:L,payload:O,paddingAngle:ni(h)*g}),A})}return _}function due(e){var{showLabels:r,sectors:t,children:n}=e,a=R.useMemo(()=>!r||!t?[]:t.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[t,r]);return R.createElement(Vle,{value:r?a:void 0},n)}function hue(e){var{props:r,previousSectorsRef:t,id:n}=e,{sectors:a,isAnimationActive:i,animationBegin:o,animationDuration:c,animationEasing:u,activeShape:l,inactiveShape:d,onAnimationStart:f,onAnimationEnd:p}=r,h=sy(r,"recharts-pie-"),y=t.current,[g,m]=R.useState(!1),x=R.useCallback(()=>{typeof p=="function"&&p(),m(!1)},[p]),v=R.useCallback(()=>{typeof f=="function"&&f(),m(!0)},[f]);return R.createElement(due,{showLabels:!g,sectors:a},R.createElement(ny,{animationId:h,begin:o,duration:c,isActive:i,easing:u,onAnimationStart:v,onAnimationEnd:x,key:h},w=>{var _,A=[],P=a&&a[0],B=(_=P?.startAngle)!==null&&_!==void 0?_:0;return a?.forEach((T,I)=>{var U=y&&y[I],H=I>0?Ff(T,"paddingAngle",0):0;if(U){var z=vs(U.endAngle-U.startAngle,T.endAngle-T.startAngle,w),O=Ws(Ws({},T),{},{startAngle:B+H,endAngle:B+z+H});A.push(O),B=O.endAngle}else{var{endAngle:L,startAngle:E}=T,k=vs(0,L-E,w),N=Ws(Ws({},T),{},{startAngle:B+H,endAngle:B+k+H});A.push(N),B=N.endAngle}}),t.current=A,R.createElement(oi,null,R.createElement(cue,{sectors:A,activeShape:l,inactiveShape:d,allOtherPieProps:r,shape:r.shape,id:n}))}),R.createElement(lue,{showLabels:!g,sectors:a,props:r}),r.children)}var fue={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:_a.area};function pue(e){var{id:r}=e,t=F1(e,Kce),{hide:n,className:a,rootTabIndex:i}=e,o=R.useMemo(()=>UN(e.children,Jf),[e.children]),c=nr(d=>cce(d,r,o)),u=R.useRef(null),l=yn("recharts-pie",a);return n||c==null?(u.current=null,R.createElement(oi,{tabIndex:i,className:l})):R.createElement(ko,{zIndex:e.zIndex},R.createElement(eue,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:c,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:r}),R.createElement(oi,{tabIndex:i,className:l},R.createElement(hue,{props:Ws(Ws({},t),{},{sectors:c}),previousSectorsRef:u,id:r})))}function B1(e){var r=Sa(e,fue),{id:t}=r,n=F1(r,Gce),a=Zo(n);return R.createElement(XN,{id:t,type:"pie"},i=>R.createElement(R.Fragment,null,R.createElement(Hce,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:r.maxRadius}),R.createElement(Jce,bh({},n,{id:i})),R.createElement(pue,bh({},n,{id:i}))))}B1.displayName="Pie";var mue=["points"];function oE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function E_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?oE(Object(t),!0).forEach(function(n){gue(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function gue(e,r,t){return(r=yue(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function yue(e){var r=xue(e,"string");return typeof r=="symbol"?r:r+""}function xue(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function db(){return db=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},db.apply(null,arguments)}function vue(e,r){if(e==null)return{};var t,n,a=bue(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function bue(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function wue(e){var{option:r,dotProps:t,className:n}=e;if(R.isValidElement(r))return R.cloneElement(r,t);if(typeof r=="function")return r(t);var a=yn(n,typeof r!="boolean"?r.className:""),i=t??{},{points:o}=i,c=vue(i,mue);return R.createElement(QL,db({},c,{className:a}))}function _ue(e,r){return e==null?!1:r?!0:e.length===1}function jue(e){var{points:r,dot:t,className:n,dotClassName:a,dataKey:i,baseProps:o,needClip:c,clipPathId:u,zIndex:l=_a.scatter}=e;if(!_ue(r,t))return null;var d=sD(t),f=DX(t),p=r.map((y,g)=>{var m,x,v=E_(E_(E_({r:3},o),f),{},{index:g,cx:(m=y.x)!==null&&m!==void 0?m:void 0,cy:(x=y.y)!==null&&x!==void 0?x:void 0,dataKey:i,value:y.value,payload:y.payload,points:r});return R.createElement(wue,{key:"dot-".concat(g),option:t,dotProps:v,className:a})}),h={};return c&&u!=null&&(h.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(u,")")),R.createElement(ko,{zIndex:l},R.createElement(oi,db({className:n},h),p))}function lE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function cE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?lE(Object(t),!0).forEach(function(n){Nue(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):lE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Nue(e,r,t){return(r=kue(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function kue(e){var r=Sue(e,"string");return typeof r=="symbol"?r:r+""}function Sue(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var lD=0,Cue={xAxis:{},yAxis:{},zAxis:{}},cD=No({name:"cartesianAxis",initialState:Cue,reducers:{addXAxis:{reducer(e,r){e.xAxis[r.payload.id]=r.payload},prepare:xs()},replaceXAxis:{reducer(e,r){var{prev:t,next:n}=r.payload;e.xAxis[t.id]!==void 0&&(t.id!==n.id&&delete e.xAxis[t.id],e.xAxis[n.id]=n)},prepare:xs()},removeXAxis:{reducer(e,r){delete e.xAxis[r.payload.id]},prepare:xs()},addYAxis:{reducer(e,r){e.yAxis[r.payload.id]=r.payload},prepare:xs()},replaceYAxis:{reducer(e,r){var{prev:t,next:n}=r.payload;e.yAxis[t.id]!==void 0&&(t.id!==n.id&&delete e.yAxis[t.id],e.yAxis[n.id]=n)},prepare:xs()},removeYAxis:{reducer(e,r){delete e.yAxis[r.payload.id]},prepare:xs()},addZAxis:{reducer(e,r){e.zAxis[r.payload.id]=r.payload},prepare:xs()},replaceZAxis:{reducer(e,r){var{prev:t,next:n}=r.payload;e.zAxis[t.id]!==void 0&&(t.id!==n.id&&delete e.zAxis[t.id],e.zAxis[n.id]=n)},prepare:xs()},removeZAxis:{reducer(e,r){delete e.zAxis[r.payload.id]},prepare:xs()},updateYAxisWidth(e,r){var{id:t,width:n}=r.payload,a=e.yAxis[t];if(a){var i,o=a.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==a.width&&Math.abs(n-((i=o[0])!==null&&i!==void 0?i:0))<=1)return;var c=[...o,n].slice(-3);e.yAxis[t]=cE(cE({},a),{},{width:n,widthHistory:c})}}}}),{addXAxis:Aue,replaceXAxis:Eue,removeXAxis:Tue,addYAxis:Pue,replaceYAxis:Oue,removeYAxis:Mue,addZAxis:H_e,replaceZAxis:V_e,removeZAxis:W_e,updateYAxisWidth:Iue}=cD.actions,Rue=cD.reducer,Lue=Xe([qa],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),Due=Xe([Lue,yd,xd],(e,r,t)=>{if(!(!e||r==null||t==null))return{x:e.left,y:e.top,width:Math.max(0,r-e.left-e.right),height:Math.max(0,t-e.top-e.bottom)}}),YN=()=>nr(Due),Fue=()=>nr(jie);function uE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function T_(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?uE(Object(t),!0).forEach(function(n){Bue(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):uE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Bue(e,r,t){return(r=$ue(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function $ue(e){var r=que(e,"string");return typeof r=="symbol"?r:r+""}function que(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var zue=e=>{var{point:r,childIndex:t,mainColor:n,activeDot:a,dataKey:i,clipPath:o}=e;if(a===!1||r.x==null||r.y==null)return null;var c={index:t,dataKey:i,cx:r.x,cy:r.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},u=T_(T_(T_({},c),Lf(a)),u3(a)),l;return R.isValidElement(a)?l=R.cloneElement(a,u):typeof a=="function"?l=a(u):l=R.createElement(QL,u),R.createElement(oi,{className:"recharts-active-dot",clipPath:o},l)};function Uue(e){var{points:r,mainColor:t,activeDot:n,itemDataKey:a,clipPath:i,zIndex:o=_a.activeDot}=e,c=nr(vh),u=Fue();if(r==null||u==null)return null;var l=r.find(d=>u.includes(d.payload));return Ms(l)?null:R.createElement(ko,{zIndex:o},R.createElement(zue,{point:l,childIndex:Number(c),mainColor:t,dataKey:a,activeDot:n,clipPath:i}))}var dE=(e,r,t)=>{var n=t??e;if(!Ms(n))return qi(n,r,0)},Hue=(e,r,t)=>{var n={},a=e.filter(S1),i=e.filter(l=>l.stackId==null),o=a.reduce((l,d)=>{var f=l[d.stackId];return f==null&&(f=[]),f.push(d),l[d.stackId]=f,l},n),c=Object.entries(o).map(l=>{var d,[f,p]=l,h=p.map(g=>g.dataKey),y=dE(r,t,(d=p[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:h,barSize:y}}),u=i.map(l=>{var d=[l.dataKey].filter(p=>p!=null),f=dE(r,t,l.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...c,...u]};function hE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Cx(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?hE(Object(t),!0).forEach(function(n){Vue(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):hE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Vue(e,r,t){return(r=Wue(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Wue(e){var r=Kue(e,"string");return typeof r=="symbol"?r:r+""}function Kue(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Gue(e,r,t,n,a){var i,o=n.length;if(!(o<1)){var c=qi(e,t,0,!0),u,l=[];if(un((i=n[0])===null||i===void 0?void 0:i.barSize)){var d=!1,f=t/o,p=n.reduce((v,w)=>v+(w.barSize||0),0);p+=(o-1)*c,p>=t&&(p-=(o-1)*c,c=0),p>=t&&f>0&&(d=!0,f*=.9,p=o*f);var h=(t-p)/2>>0,y={offset:h-c,size:0};u=n.reduce((v,w)=>{var _,A={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:y.offset+y.size+c,size:d?f:(_=w.barSize)!==null&&_!==void 0?_:0}},P=[...v,A];return y=A.position,P},l)}else{var g=qi(r,t,0,!0);t-2*g-(o-1)*c<=0&&(c=0);var m=(t-2*g-(o-1)*c)/o;m>1&&(m>>=0);var x=un(a)?Math.min(m,a):m;u=n.reduce((v,w,_)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(m+c)*_+(m-x)/2,size:x}}],l)}return u}}var Xue=(e,r,t,n,a,i,o)=>{var c=Ms(o)?r:o,u=Gue(t,n,a!==i?a:i,e,c);return a!==i&&u!=null&&(u=u.map(l=>Cx(Cx({},l),{},{position:Cx(Cx({},l.position),{},{offset:l.position.offset-a/2})}))),u},Yue=(e,r)=>{var t=iN(r);if(!(!e||t==null||r==null)){var{stackId:n}=r;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(o=>o.key===t)}}}},Que=(e,r)=>{if(!(e==null||r==null)){var t=e.find(n=>n.stackId===r.stackId&&r.dataKey!=null&&n.dataKeys.includes(r.dataKey));if(t!=null)return t.position}};function Zue(e,r){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&un(e.zIndex)?e.zIndex:r}var uD=e=>{var{chartData:r}=e,t=rs(),n=Ui();return R.useEffect(()=>n?()=>{}:(t(xA(r)),()=>{t(xA(void 0))}),[r,t,n]),null},fE={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},dD=No({name:"brush",initialState:fE,reducers:{setBrushSettings(e,r){return r.payload==null?fE:r.payload}}}),{setBrushSettings:K_e}=dD.actions,Jue=dD.reducer;function ede(e){return(e%180+180)%180}var tde=function(r){var{width:t,height:n}=r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=ede(a),o=i*Math.PI/180,c=Math.atan(n/t),u=o>c&&o<Math.PI-c?n/Math.sin(o):t/Math.cos(o);return Math.abs(u)},rde={dots:[],areas:[],lines:[]},hD=No({name:"referenceElements",initialState:rde,reducers:{addDot:(e,r)=>{e.dots.push(r.payload)},removeDot:(e,r)=>{var t=cc(e).dots.findIndex(n=>n===r.payload);t!==-1&&e.dots.splice(t,1)},addArea:(e,r)=>{e.areas.push(r.payload)},removeArea:(e,r)=>{var t=cc(e).areas.findIndex(n=>n===r.payload);t!==-1&&e.areas.splice(t,1)},addLine:(e,r)=>{e.lines.push(r.payload)},removeLine:(e,r)=>{var t=cc(e).lines.findIndex(n=>n===r.payload);t!==-1&&e.lines.splice(t,1)}}}),{addDot:G_e,removeDot:X_e,addArea:Y_e,removeArea:Q_e,addLine:Z_e,removeLine:J_e}=hD.actions,nde=hD.reducer,sde=R.createContext(void 0),ade=e=>{var{children:r}=e,[t]=R.useState("".concat(bg("recharts"),"-clip")),n=YN();if(n==null)return null;var{x:a,y:i,width:o,height:c}=n;return R.createElement(sde.Provider,{value:t},R.createElement("defs",null,R.createElement("clipPath",{id:t},R.createElement("rect",{x:a,y:i,height:c,width:o}))),r)};function fD(e,r){if(r<1)return[];if(r===1)return e;for(var t=[],n=0;n<e.length;n+=r){var a=e[n];a!==void 0&&t.push(a)}return t}function ide(e,r,t){var n={width:e.width+r.width,height:e.height+r.height};return tde(n,t)}function ode(e,r,t){var n=t==="width",{x:a,y:i,width:o,height:c}=e;return r===1?{start:n?a:i,end:n?a+o:i+c}:{start:n?a+o:i+c,end:n?a:i}}function Ig(e,r,t,n,a){if(e*r<e*n||e*r>e*a)return!1;var i=t();return e*(r-e*i/2-n)>=0&&e*(r+e*i/2-a)<=0}function lde(e,r){return fD(e,r+1)}function cde(e,r,t,n,a){for(var i=(n||[]).slice(),{start:o,end:c}=r,u=0,l=1,d=o,f=function(){var y=n?.[u];if(y===void 0)return{v:fD(n,l)};var g=u,m,x=()=>(m===void 0&&(m=t(y,g)),m),v=y.coordinate,w=u===0||Ig(e,v,x,d,c);w||(u=0,d=o,l+=1),w&&(d=v+e*(x()/2+a),u+=l)},p;l<=i.length;)if(p=f(),p)return p.v;return[]}function ude(e,r,t,n,a){var i=(n||[]).slice(),o=i.length;if(o===0)return[];for(var{start:c,end:u}=r,l=1;l<=o;l++){for(var d=(o-1)%l,f=c,p=!0,h=function(){var _=n[g];if(_==null)return 0;var A=g,P,B=()=>(P===void 0&&(P=t(_,A)),P),T=_.coordinate,I=g===d||Ig(e,T,B,f,u);if(!I)return p=!1,1;I&&(f=T+e*(B()/2+a))},y,g=d;g<o&&(y=h(),!(y!==0&&y===1));g+=l);if(p){for(var m=[],x=d;x<o;x+=l){var v=n[x];v!=null&&m.push(v)}return m}}return[]}function pE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Fi(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?pE(Object(t),!0).forEach(function(n){dde(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function dde(e,r,t){return(r=hde(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function hde(e){var r=fde(e,"string");return typeof r=="symbol"?r:r+""}function fde(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pde(e,r,t,n,a){for(var i=(n||[]).slice(),o=i.length,{start:c}=r,{end:u}=r,l=function(p){var h=i[p];if(h==null)return 1;var y=h,g,m=()=>(g===void 0&&(g=t(h,p)),g);if(p===o-1){var x=e*(y.coordinate+e*m()/2-u);i[p]=y=Fi(Fi({},y),{},{tickCoord:x>0?y.coordinate-x*e:y.coordinate})}else i[p]=y=Fi(Fi({},y),{},{tickCoord:y.coordinate});if(y.tickCoord!=null){var v=Ig(e,y.tickCoord,m,c,u);v&&(u=y.tickCoord-e*(m()/2+a),i[p]=Fi(Fi({},y),{},{isShow:!0}))}},d=o-1;d>=0;d--)l(d);return i}function mde(e,r,t,n,a,i){var o=(n||[]).slice(),c=o.length,{start:u,end:l}=r;if(i){var d=n[c-1];if(d!=null){var f=t(d,c-1),p=e*(d.coordinate+e*f/2-l);if(o[c-1]=d=Fi(Fi({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var h=Ig(e,d.tickCoord,()=>f,u,l);h&&(l=d.tickCoord-e*(f/2+a),o[c-1]=Fi(Fi({},d),{},{isShow:!0}))}}}for(var y=i?c-1:c,g=function(v){var w=o[v];if(w==null)return 1;var _=w,A,P=()=>(A===void 0&&(A=t(w,v)),A);if(v===0){var B=e*(_.coordinate-e*P()/2-u);o[v]=_=Fi(Fi({},_),{},{tickCoord:B<0?_.coordinate-B*e:_.coordinate})}else o[v]=_=Fi(Fi({},_),{},{tickCoord:_.coordinate});if(_.tickCoord!=null){var T=Ig(e,_.tickCoord,P,u,l);T&&(u=_.tickCoord+e*(P()/2+a),o[v]=Fi(Fi({},_),{},{isShow:!0}))}},m=0;m<y;m++)g(m);return o}function QN(e,r,t){var{tick:n,ticks:a,viewBox:i,minTickGap:o,orientation:c,interval:u,tickFormatter:l,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(Vt(u)||m1.isSsr){var p;return(p=lde(a,Vt(u)?u:0))!==null&&p!==void 0?p:[]}var h=[],y=c==="top"||c==="bottom"?"width":"height",g=d&&y==="width"?Z0(d,{fontSize:r,letterSpacing:t}):{width:0,height:0},m=(A,P)=>{var B=typeof l=="function"?l(A.value,P):A.value;return y==="width"?ide(Z0(B,{fontSize:r,letterSpacing:t}),g,f):Z0(B,{fontSize:r,letterSpacing:t})[y]},x=a[0],v=a[1],w=a.length>=2&&x!=null&&v!=null?ni(v.coordinate-x.coordinate):1,_=ode(i,w,y);return u==="equidistantPreserveStart"?cde(w,_,m,a,o):u==="equidistantPreserveEnd"?ude(w,_,m,a,o):(u==="preserveStart"||u==="preserveStartEnd"?h=mde(w,_,m,a,o,u==="preserveStartEnd"):h=pde(w,_,m,a,o),h.filter(A=>A.isShow))}var gde=e=>{var{ticks:r,label:t,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(r){Array.from(r).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var c=t?t.getBoundingClientRect().width:0,u=a+i,l=o+u+c+(t?n:0);return Math.round(l)}return 0},yde=["axisLine","width","height","className","hide","ticks","axisType"];function xde(e,r){if(e==null)return{};var t,n,a=vde(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function vde(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function Hf(){return Hf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Hf.apply(null,arguments)}function mE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Hs(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?mE(Object(t),!0).forEach(function(n){bde(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function bde(e,r,t){return(r=wde(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function wde(e){var r=_de(e,"string");return typeof r=="symbol"?r:r+""}function _de(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var td={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:_a.axis};function jde(e){var{x:r,y:t,width:n,height:a,orientation:i,mirror:o,axisLine:c,otherSvgProps:u}=e;if(!c)return null;var l=Hs(Hs(Hs({},u),Zo(c)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!o||i==="bottom"&&o);l=Hs(Hs({},l),{},{x1:r,y1:t+d*a,x2:r+n,y2:t+d*a})}else{var f=+(i==="left"&&!o||i==="right"&&o);l=Hs(Hs({},l),{},{x1:r+f*n,y1:t,x2:r+f*n,y2:t+a})}return R.createElement("line",Hf({},l,{className:yn("recharts-cartesian-axis-line",Ff(c,"className"))}))}function Nde(e,r,t,n,a,i,o,c,u){var l,d,f,p,h,y,g=c?-1:1,m=e.tickSize||o,x=Vt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":l=d=e.coordinate,p=t+ +!c*a,f=p-g*m,y=f-g*u,h=x;break;case"left":f=p=e.coordinate,d=r+ +!c*n,l=d-g*m,h=l-g*u,y=x;break;case"right":f=p=e.coordinate,d=r+ +c*n,l=d+g*m,h=l+g*u,y=x;break;default:l=d=e.coordinate,p=t+ +c*a,f=p+g*m,y=f+g*u,h=x;break}return{line:{x1:l,y1:f,x2:d,y2:p},tick:{x:h,y}}}function kde(e,r){switch(e){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}function Sde(e,r){switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}function Cde(e){var{option:r,tickProps:t,value:n}=e,a,i=yn(t.className,"recharts-cartesian-axis-tick-value");if(R.isValidElement(r))a=R.cloneElement(r,Hs(Hs({},t),{},{className:i}));else if(typeof r=="function")a=r(Hs(Hs({},t),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof r!="boolean"&&(o=yn(o,tD(r))),a=R.createElement(R1,Hf({},t,{className:o}),n)}return a}var Ade=R.forwardRef((e,r)=>{var{ticks:t=[],tick:n,tickLine:a,stroke:i,tickFormatter:o,unit:c,padding:u,tickTextProps:l,orientation:d,mirror:f,x:p,y:h,width:y,height:g,tickSize:m,tickMargin:x,fontSize:v,letterSpacing:w,getTicksConfig:_,events:A,axisType:P}=e,B=QN(Hs(Hs({},_),{},{ticks:t}),v,w),T=kde(d,f),I=Sde(d,f),U=Zo(_),H=Lf(n),z={};typeof a=="object"&&(z=a);var O=Hs(Hs({},U),{},{fill:"none"},z),L=B.map(N=>Hs({entry:N},Nde(N,p,h,y,g,d,m,f,x))),E=L.map(N=>{var{entry:S,line:C}=N;return R.createElement(oi,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},a&&R.createElement("line",Hf({},O,C,{className:yn("recharts-cartesian-axis-tick-line",Ff(a,"className"))})))}),k=L.map((N,S)=>{var C,D,{entry:q,tick:M}=N,G=Hs(Hs(Hs(Hs({verticalAnchor:I},U),{},{textAnchor:T,stroke:"none",fill:i},M),{},{index:S,payload:q,visibleTicksCount:B.length,tickFormatter:o,padding:u},l),{},{angle:(C=(D=l?.angle)!==null&&D!==void 0?D:U.angle)!==null&&C!==void 0?C:0}),X=Hs(Hs({},G),H);return R.createElement(oi,Hf({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},Qg(A,q,S)),n&&R.createElement(Cde,{option:n,tickProps:X,value:"".concat(typeof o=="function"?o(q.value,S):q.value).concat(c||"")}))});return R.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(P,"-ticks")},k.length>0&&R.createElement(ko,{zIndex:_a.label},R.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(P,"-tick-labels"),ref:r},k)),E.length>0&&R.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(P,"-tick-lines")},E))}),Ede=R.forwardRef((e,r)=>{var{axisLine:t,width:n,height:a,className:i,hide:o,ticks:c,axisType:u}=e,l=xde(e,yde),[d,f]=R.useState(""),[p,h]=R.useState(""),y=R.useRef(null);R.useImperativeHandle(r,()=>({getCalculatedWidth:()=>{var m;return gde({ticks:y.current,label:(m=e.labelRef)===null||m===void 0?void 0:m.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=R.useCallback(m=>{if(m){var x=m.getElementsByClassName("recharts-cartesian-axis-tick-value");y.current=x;var v=x[0];if(v){var w=window.getComputedStyle(v),_=w.fontSize,A=w.letterSpacing;(_!==d||A!==p)&&(f(_),h(A))}}},[d,p]);return o||n!=null&&n<=0||a!=null&&a<=0?null:R.createElement(ko,{zIndex:e.zIndex},R.createElement(oi,{className:yn("recharts-cartesian-axis",i)},R.createElement(jde,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:t,otherSvgProps:Zo(e)}),R.createElement(Ade,{ref:g,axisType:u,events:l,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),R.createElement(Nle,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},R.createElement(Ile,{label:e.label,labelRef:e.labelRef}),e.children)))}),ZN=R.forwardRef((e,r)=>{var t=Sa(e,td);return R.createElement(Ede,Hf({},t,{ref:r}))});ZN.displayName="CartesianAxis";var Tde=["x1","y1","x2","y2","key"],Pde=["offset"],Ode=["xAxisId","yAxisId"],Mde=["xAxisId","yAxisId"];function gE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Bi(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?gE(Object(t),!0).forEach(function(n){Ide(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):gE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ide(e,r,t){return(r=Rde(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Rde(e){var r=Lde(e,"string");return typeof r=="symbol"?r:r+""}function Lde(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function bf(){return bf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},bf.apply(null,arguments)}function hb(e,r){if(e==null)return{};var t,n,a=Dde(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Dde(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Fde=e=>{var{fill:r}=e;if(!r||r==="none")return null;var{fillOpacity:t,x:n,y:a,width:i,height:o,ry:c}=e;return R.createElement("rect",{x:n,y:a,ry:c,width:i,height:o,stroke:"none",fill:r,fillOpacity:t,className:"recharts-cartesian-grid-bg"})};function pD(e){var{option:r,lineItemProps:t}=e,n;if(R.isValidElement(r))n=R.cloneElement(r,t);else if(typeof r=="function")n=r(t);else{var a,{x1:i,y1:o,x2:c,y2:u,key:l}=t,d=hb(t,Tde),f=(a=Zo(d))!==null&&a!==void 0?a:{},{offset:p}=f,h=hb(f,Pde);n=R.createElement("line",bf({},h,{x1:i,y1:o,x2:c,y2:u,fill:"none",key:l}))}return n}function Bde(e){var{x:r,width:t,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,c=hb(e,Ode),u=a.map((l,d)=>{var f=Bi(Bi({},c),{},{x1:r,y1:l,x2:r+t,y2:l,key:"line-".concat(d),index:d});return R.createElement(pD,{key:"line-".concat(d),option:n,lineItemProps:f})});return R.createElement("g",{className:"recharts-cartesian-grid-horizontal"},u)}function $de(e){var{y:r,height:t,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,c=hb(e,Mde),u=a.map((l,d)=>{var f=Bi(Bi({},c),{},{x1:l,y1:r,x2:l,y2:r+t,key:"line-".concat(d),index:d});return R.createElement(pD,{option:n,lineItemProps:f,key:"line-".concat(d)})});return R.createElement("g",{className:"recharts-cartesian-grid-vertical"},u)}function qde(e){var{horizontalFill:r,fillOpacity:t,x:n,y:a,width:i,height:o,horizontalPoints:c,horizontal:u=!0}=e;if(!u||!r||!r.length||c==null)return null;var l=c.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==l[0]&&l.unshift(0);var d=l.map((f,p)=>{var h=l[p+1],y=h==null,g=y?a+o-f:h-f;if(g<=0)return null;var m=p%r.length;return R.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:g,width:i,stroke:"none",fill:r[m],fillOpacity:t,className:"recharts-cartesian-grid-bg"})});return R.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function zde(e){var{vertical:r=!0,verticalFill:t,fillOpacity:n,x:a,y:i,width:o,height:c,verticalPoints:u}=e;if(!r||!t||!t.length)return null;var l=u.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==l[0]&&l.unshift(0);var d=l.map((f,p)=>{var h=l[p+1],y=h==null,g=y?a+o-f:h-f;if(g<=0)return null;var m=p%t.length;return R.createElement("rect",{key:"react-".concat(p),x:f,y:i,width:g,height:c,stroke:"none",fill:t[m],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return R.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Ude=(e,r)=>{var{xAxis:t,width:n,height:a,offset:i}=e;return iI(QN(Bi(Bi(Bi({},td),t),{},{ticks:oI(t),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,r)},Hde=(e,r)=>{var{yAxis:t,width:n,height:a,offset:i}=e;return iI(QN(Bi(Bi(Bi({},td),t),{},{ticks:oI(t),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,r)},Vde={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:_a.grid};function Sf(e){var r=j3(),t=N3(),n=pI(),a=Bi(Bi({},Sa(e,Vde)),{},{x:Vt(e.x)?e.x:n.left,y:Vt(e.y)?e.y:n.top,width:Vt(e.width)?e.width:n.width,height:Vt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:o,x:c,y:u,width:l,height:d,syncWithTicks:f,horizontalValues:p,verticalValues:h}=a,y=Ui(),g=nr(I=>iA(I,"xAxis",i,y)),m=nr(I=>iA(I,"yAxis",o,y));if(!eu(l)||!eu(d)||!Vt(c)||!Vt(u))return null;var x=a.verticalCoordinatesGenerator||Ude,v=a.horizontalCoordinatesGenerator||Hde,{horizontalPoints:w,verticalPoints:_}=a;if((!w||!w.length)&&typeof v=="function"){var A=p&&p.length,P=v({yAxis:m?Bi(Bi({},m),{},{ticks:A?p:m.ticks}):void 0,width:r??l,height:t??d,offset:n},A?!0:f);Fv(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(w=P)}if((!_||!_.length)&&typeof x=="function"){var B=h&&h.length,T=x({xAxis:g?Bi(Bi({},g),{},{ticks:B?h:g.ticks}):void 0,width:r??l,height:t??d,offset:n},B?!0:f);Fv(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(_=T)}return R.createElement(ko,{zIndex:a.zIndex},R.createElement("g",{className:"recharts-cartesian-grid"},R.createElement(Fde,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),R.createElement(qde,bf({},a,{horizontalPoints:w})),R.createElement(zde,bf({},a,{verticalPoints:_})),R.createElement(Bde,bf({},a,{offset:n,horizontalPoints:w,xAxis:g,yAxis:m})),R.createElement($de,bf({},a,{offset:n,verticalPoints:_,xAxis:g,yAxis:m}))))}Sf.displayName="CartesianGrid";var Wde={},mD=No({name:"errorBars",initialState:Wde,reducers:{addErrorBar:(e,r)=>{var{itemId:t,errorBar:n}=r.payload;e[t]||(e[t]=[]),e[t].push(n)},replaceErrorBar:(e,r)=>{var{itemId:t,prev:n,next:a}=r.payload;e[t]&&(e[t]=e[t].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,r)=>{var{itemId:t,errorBar:n}=r.payload;e[t]&&(e[t]=e[t].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:e5e,replaceErrorBar:t5e,removeErrorBar:r5e}=mD.actions,Kde=mD.reducer,Gde=["children"];function Xde(e,r){if(e==null)return{};var t,n,a=Yde(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Yde(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Qde={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Zde=R.createContext(Qde);function gD(e){var{children:r}=e,t=Xde(e,Gde);return R.createElement(Zde.Provider,{value:t},r)}function JN(e,r){var t,n,a=nr(l=>wd(l,e)),i=nr(l=>_d(l,r)),o=(t=a?.allowDataOverflow)!==null&&t!==void 0?t:Ja.allowDataOverflow,c=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ei.allowDataOverflow,u=o||c;return{needClip:u,needClipX:o,needClipY:c}}function yD(e){var{xAxisId:r,yAxisId:t,clipPathId:n}=e,a=YN(),{needClipX:i,needClipY:o,needClip:c}=JN(r,t);if(!c||!a)return null;var{x:u,y:l,width:d,height:f}=a;return R.createElement("clipPath",{id:"clipPath-".concat(n)},R.createElement("rect",{x:i?u:u-d/2,y:o?l:l-f/2,width:i?d:d*2,height:o?f:f*2}))}var xD=(e,r,t,n)=>xh(e,"xAxis",r,n),vD=(e,r,t,n)=>yh(e,"xAxis",r,n),bD=(e,r,t,n)=>xh(e,"yAxis",t,n),wD=(e,r,t,n)=>yh(e,"yAxis",t,n),Jde=Xe([wn,xD,bD,vD,wD],(e,r,t,n,a)=>gd(e,"xAxis")?bm(r,n,!1):bm(t,a,!1)),ehe=(e,r,t,n,a)=>a;function the(e){return e.type==="line"}var rhe=Xe([E1,ehe],(e,r)=>e.filter(the).find(t=>t.id===r)),nhe=Xe([wn,xD,bD,vD,wD,rhe,Jde,Q3],(e,r,t,n,a,i,o,c)=>{var{chartData:u,dataStartIndex:l,dataEndIndex:d}=c;if(!(i==null||r==null||t==null||n==null||a==null||n.length===0||a.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:p}=i,h;if(p!=null&&p.length>0?h=p:h=u?.slice(l,d+1),h!=null)return Hhe({layout:e,xAxis:r,yAxis:t,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:o,displayedData:h})}});function she(e){var r=Lf(e),t=3,n=2;if(r!=null){var{r:a,strokeWidth:i}=r,o=Number(a),c=Number(i);return(Number.isNaN(o)||o<0)&&(o=t),(Number.isNaN(c)||c<0)&&(c=n),{r:o,strokeWidth:c}}return{r:t,strokeWidth:n}}var P_={exports:{}},O_={};var yE;function ahe(){if(yE)return O_;yE=1;var e=Am();function r(u,l){return u===l&&(u!==0||1/u===1/l)||u!==u&&l!==l}var t=typeof Object.is=="function"?Object.is:r,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return O_.useSyncExternalStoreWithSelector=function(u,l,d,f,p){var h=a(null);if(h.current===null){var y={hasValue:!1,value:null};h.current=y}else y=h.current;h=o(function(){function m(A){if(!x){if(x=!0,v=A,A=f(A),p!==void 0&&y.hasValue){var P=y.value;if(p(P,A))return w=P}return w=A}if(P=w,t(v,A))return P;var B=f(A);return p!==void 0&&p(P,B)?(v=A,P):(v=A,w=B)}var x=!1,v,w,_=d===void 0?null:d;return[function(){return m(l())},_===null?void 0:function(){return m(_())}]},[l,d,f,p]);var g=n(u,h[0],h[1]);return i(function(){y.hasValue=!0,y.value=g},[g]),c(g),g},O_}var xE;function ihe(){return xE||(xE=1,P_.exports=ahe()),P_.exports}ihe();function ohe(e){e()}function lhe(){let e=null,r=null;return{clear(){e=null,r=null},notify(){ohe(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(t){let n=!0;const a=r={callback:t,next:null,prev:r};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:r=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var vE={notify(){},get:()=>[]};function che(e,r){let t,n=vE,a=0,i=!1;function o(g){d();const m=n.subscribe(g);let x=!1;return()=>{x||(x=!0,m(),f())}}function c(){n.notify()}function u(){y.onStateChange&&y.onStateChange()}function l(){return i}function d(){a++,t||(t=e.subscribe(u),n=lhe())}function f(){a--,t&&a===0&&(t(),t=void 0,n.clear(),n=vE)}function p(){i||(i=!0,d())}function h(){i&&(i=!1,f())}const y={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:u,isSubscribed:l,trySubscribe:p,tryUnsubscribe:h,getListeners:()=>n};return y}var uhe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dhe=uhe(),hhe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",fhe=hhe(),phe=()=>dhe||fhe?R.useLayoutEffect:R.useEffect,mhe=phe();function bE(e,r){return e===r?e!==0||r!==0||1/e===1/r:e!==e&&r!==r}function ghe(e,r){if(bE(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(!Object.prototype.hasOwnProperty.call(r,t[a])||!bE(e[t[a]],r[t[a]]))return!1;return!0}var yhe=Symbol.for("react-redux-context"),xhe=typeof globalThis<"u"?globalThis:{};function vhe(){if(!R.createContext)return{};const e=xhe[yhe]??=new Map;let r=e.get(R.createContext);return r||(r=R.createContext(null),e.set(R.createContext,r)),r}var bhe=vhe();function whe(e){const{children:r,context:t,serverState:n,store:a}=e,i=R.useMemo(()=>{const u=che(a);return{store:a,subscription:u,getServerState:n?()=>n:void 0}},[a,n]),o=R.useMemo(()=>a.getState(),[a]);mhe(()=>{const{subscription:u}=i;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==a.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[i,o]);const c=t||bhe;return R.createElement(c.Provider,{value:i},r)}var _he=whe,jhe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Nhe(e,r){return e==null&&r==null?!0:typeof e=="number"&&typeof r=="number"?e===r||e!==e&&r!==r:e===r}function $1(e,r){var t=new Set([...Object.keys(e),...Object.keys(r)]);for(var n of t)if(jhe.has(n)){if(e[n]==null&&r[n]==null)continue;if(!ghe(e[n],r[n]))return!1}else if(!Nhe(e[n],r[n]))return!1;return!0}var khe=["id"],She=["type","layout","connectNulls","needClip","shape"],Che=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Rg(){return Rg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Rg.apply(null,arguments)}function wE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function qc(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?wE(Object(t),!0).forEach(function(n){Ahe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Ahe(e,r,t){return(r=Ehe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ehe(e){var r=The(e,"string");return typeof r=="symbol"?r:r+""}function The(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function e6(e,r){if(e==null)return{};var t,n,a=Phe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Phe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Ohe=e=>{var{dataKey:r,name:t,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:r,type:a,color:n,value:Dm(t,r),payload:e}]},Mhe=R.memo(e=>{var{dataKey:r,data:t,stroke:n,strokeWidth:a,fill:i,name:o,hide:c,unit:u,tooltipType:l,id:d}=e,f={dataDefinedOnItem:t,getPosition:Xf,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:r,nameKey:void 0,name:Dm(o,r),hide:c,type:l,color:n,unit:u,graphicalItemId:d}};return R.createElement(GN,{tooltipEntrySettings:f})}),_D=(e,r)=>"".concat(r,"px ").concat(e-r,"px");function Ihe(e,r){for(var t=e.length%2!==0?[...e,0]:e,n=[],a=0;a<r;++a)n=[...n,...t];return n}var Rhe=(e,r,t)=>{var n=t.reduce((h,y)=>h+y);if(!n)return _D(r,e);for(var a=Math.floor(e/n),i=e%n,o=r-e,c=[],u=0,l=0;u<t.length;l+=(d=t[u])!==null&&d!==void 0?d:0,++u){var d,f=t[u];if(f!=null&&l+f>i){c=[...t.slice(0,u),i-l];break}}var p=c.length%2===0?[0,o]:[o];return[...Ihe(t,a),...c,...p].map(h=>"".concat(h,"px")).join(", ")};function Lhe(e){var{clipPathId:r,points:t,props:n}=e,{dot:a,dataKey:i,needClip:o}=n,{id:c}=n,u=e6(n,khe),l=Zo(u);return R.createElement(jue,{points:t,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:l,needClip:o,clipPathId:r})}function Dhe(e){var{showLabels:r,children:t,points:n}=e,a=R.useMemo(()=>n?.map(i=>{var o,c,u={x:(o=i.x)!==null&&o!==void 0?o:0,y:(c=i.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return qc(qc({},u),{},{value:i.value,payload:i.payload,viewBox:u,parentViewBox:void 0,fill:void 0})}),[n]);return R.createElement(XL,{value:r?a:void 0},t)}function _E(e){var{clipPathId:r,pathRef:t,points:n,strokeDasharray:a,props:i}=e,{type:o,layout:c,connectNulls:u,needClip:l,shape:d}=i,f=e6(i,She),p=qc(qc({},ro(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(r,")"):void 0,points:n,type:o,layout:c,connectNulls:u,strokeDasharray:a??i.strokeDasharray});return R.createElement(R.Fragment,null,n?.length>1&&R.createElement(HN,Rg({shapeType:"curve",option:d},p,{pathRef:t})),R.createElement(Lhe,{points:n,clipPathId:r,props:i}))}function Fhe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Bhe(e){var{clipPathId:r,props:t,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:c,isAnimationActive:u,animationBegin:l,animationDuration:d,animationEasing:f,animateNewValues:p,width:h,height:y,onAnimationEnd:g,onAnimationStart:m}=t,x=a.current,v=sy(o,"recharts-line-"),w=R.useRef(v),[_,A]=R.useState(!1),P=!_,B=R.useCallback(()=>{typeof g=="function"&&g(),A(!1)},[g]),T=R.useCallback(()=>{typeof m=="function"&&m(),A(!0)},[m]),I=Fhe(n.current),U=R.useRef(0);w.current!==v&&(U.current=i.current,w.current=v);var H=U.current;return R.createElement(Dhe,{points:o,showLabels:P},t.children,R.createElement(ny,{animationId:v,begin:l,duration:d,isActive:u,easing:f,onAnimationEnd:B,onAnimationStart:T,key:v},z=>{var O=vs(H,I+H,z),L=Math.min(O,I),E;if(u)if(c){var k="".concat(c).split(/[,\s]+/gim).map(C=>parseFloat(C));E=Rhe(L,I,k)}else E=_D(I,L);else E=c==null?void 0:String(c);if(z>0&&I>0&&(a.current=o,i.current=Math.max(i.current,L)),x){var N=x.length/o.length,S=z===1?o:o.map((C,D)=>{var q=Math.floor(D*N);if(x[q]){var M=x[q];return qc(qc({},C),{},{x:vs(M.x,C.x,z),y:vs(M.y,C.y,z)})}return p?qc(qc({},C),{},{x:vs(h*2,C.x,z),y:vs(y/2,C.y,z)}):qc(qc({},C),{},{x:C.x,y:C.y})});return a.current=S,R.createElement(_E,{props:t,points:S,clipPathId:r,pathRef:n,strokeDasharray:E})}return R.createElement(_E,{props:t,points:o,clipPathId:r,pathRef:n,strokeDasharray:E})}),R.createElement($N,{label:t.label}))}function $he(e){var{clipPathId:r,props:t}=e,n=R.useRef(null),a=R.useRef(0),i=R.useRef(null);return R.createElement(Bhe,{props:t,clipPathId:r,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var qhe=(e,r)=>{var t,n;return{x:(t=e.x)!==null&&t!==void 0?t:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Hn(e.payload,r)}};class zhe extends R.Component{render(){var{hide:r,dot:t,points:n,className:a,xAxisId:i,yAxisId:o,top:c,left:u,width:l,height:d,id:f,needClip:p,zIndex:h}=this.props;if(r)return null;var y=yn("recharts-line",a),g=f,{r:m,strokeWidth:x}=she(t),v=sD(t),w=m*2+x,_=p?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return R.createElement(ko,{zIndex:h},R.createElement(oi,{className:y},p&&R.createElement("defs",null,R.createElement(yD,{clipPathId:g,xAxisId:i,yAxisId:o}),!v&&R.createElement("clipPath",{id:"clipPath-dots-".concat(g)},R.createElement("rect",{x:u-w/2,y:c-w/2,width:l+w,height:d+w}))),R.createElement(gD,{xAxisId:i,yAxisId:o,data:n,dataPointFormatter:qhe,errorBarOffset:0},R.createElement($he,{props:this.props,clipPathId:g}))),R.createElement(Uue,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:_}))}}var jD={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:_a.line,type:"linear"};function Uhe(e){var r=Sa(e,jD),{activeDot:t,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,connectNulls:c,dot:u,hide:l,isAnimationActive:d,label:f,legendType:p,xAxisId:h,yAxisId:y,id:g}=r,m=e6(r,Che),{needClip:x}=JN(h,y),v=YN(),w=Yf(),_=Ui(),A=nr(U=>nhe(U,h,y,_,g));if(w!=="horizontal"&&w!=="vertical"||A==null||v==null)return null;var{height:P,width:B,x:T,y:I}=v;return R.createElement(zhe,Rg({},m,{id:g,connectNulls:c,dot:u,activeDot:t,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,isAnimationActive:d,hide:l,label:f,legendType:p,xAxisId:h,yAxisId:y,points:A,layout:w,height:P,width:B,left:T,top:I,needClip:x}))}function Hhe(e){var{layout:r,xAxis:t,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:o,bandSize:c,displayedData:u}=e;return u.map((l,d)=>{var f=Hn(l,o);if(r==="horizontal"){var p=nC({axis:t,ticks:a,bandSize:c,entry:l,index:d}),h=Ms(f)?null:n.scale.map(f);return{x:p,y:h??null,value:f,payload:l}}var y=Ms(f)?null:t.scale.map(f),g=nC({axis:n,ticks:i,bandSize:c,entry:l,index:d});return y==null||g==null?null:{x:y,y:g,value:f,payload:l}}).filter(Boolean)}function Vhe(e){var r=Sa(e,jD),t=Ui();return R.createElement(XN,{id:r.id,type:"line"},n=>R.createElement(R.Fragment,null,R.createElement(aD,{legendPayload:Ohe(r)}),R.createElement(Mhe,{dataKey:r.dataKey,data:r.data,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:n}),R.createElement(oD,{type:"line",id:n,data:r.data,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,hide:r.hide,isPanorama:t}),R.createElement(Uhe,Rg({},r,{id:n}))))}var um=R.memo(Vhe,$1);um.displayName="Line";function ep(e,r){var t,n;return(t=(n=e.graphicalItems.cartesianItems.find(a=>a.id===r))===null||n===void 0?void 0:n.xAxisId)!==null&&t!==void 0?t:lD}function tp(e,r){var t,n;return(t=(n=e.graphicalItems.cartesianItems.find(a=>a.id===r))===null||n===void 0?void 0:n.yAxisId)!==null&&t!==void 0?t:lD}var Whe="Invariant failed";function Khe(e,r){throw new Error(Whe)}function Gj(){return Gj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Gj.apply(null,arguments)}function fb(e){return R.createElement(HN,Gj({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var Ghe=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Vt(r))return r;var i=Vt(n)||Ms(n);return i?r(n,a):(i||Khe(),t)}},Xhe=(e,r,t)=>t,Yhe=(e,r)=>r,gy=Xe([E1,Yhe],(e,r)=>e.filter(t=>t.type==="bar").find(t=>t.id===r)),Qhe=Xe([gy],e=>e?.maxBarSize),Zhe=(e,r,t,n)=>n,Jhe=Xe([wn,E1,ep,tp,Xhe],(e,r,t,n,a)=>r.filter(i=>e==="horizontal"?i.xAxisId===t:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),efe=(e,r,t)=>{var n=wn(e),a=ep(e,r),i=tp(e,r);if(!(a==null||i==null))return n==="horizontal"?qj(e,"yAxis",i,t):qj(e,"xAxis",a,t)},tfe=(e,r)=>{var t=wn(e),n=ep(e,r),a=tp(e,r);if(!(n==null||a==null))return t==="horizontal"?aA(e,"xAxis",n):aA(e,"yAxis",a)},rfe=Xe([Jhe,xse,tfe],Hue),nfe=(e,r,t)=>{var n,a,i=gy(e,r);if(i==null)return 0;var o=ep(e,r),c=tp(e,r);if(o==null||c==null)return 0;var u=wn(e),l=AR(e),{maxBarSize:d}=i,f=Ms(d)?l:d,p,h;return u==="horizontal"?(p=xh(e,"xAxis",o,t),h=yh(e,"xAxis",o,t)):(p=xh(e,"yAxis",c,t),h=yh(e,"yAxis",c,t)),(n=(a=bm(p,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0},ND=(e,r,t)=>{var n=wn(e),a=ep(e,r),i=tp(e,r);if(!(a==null||i==null)){var o,c;return n==="horizontal"?(o=xh(e,"xAxis",a,t),c=yh(e,"xAxis",a,t)):(o=xh(e,"yAxis",i,t),c=yh(e,"yAxis",i,t)),bm(o,c)}},sfe=Xe([rfe,AR,yse,ER,nfe,ND,Qhe],Xue),afe=(e,r,t)=>{var n=ep(e,r);if(n!=null)return xh(e,"xAxis",n,t)},ife=(e,r,t)=>{var n=tp(e,r);if(n!=null)return xh(e,"yAxis",n,t)},ofe=(e,r,t)=>{var n=ep(e,r);if(n!=null)return yh(e,"xAxis",n,t)},lfe=(e,r,t)=>{var n=tp(e,r);if(n!=null)return yh(e,"yAxis",n,t)},cfe=Xe([sfe,gy],Que),ufe=Xe([efe,gy],Yue),dfe=Xe([qa,b3,afe,ife,ofe,lfe,cfe,wn,cse,ND,ufe,gy,Zhe],(e,r,t,n,a,i,o,c,u,l,d,f,p)=>{var{chartData:h,dataStartIndex:y,dataEndIndex:g}=u;if(!(f==null||o==null||r==null||c!=="horizontal"&&c!=="vertical"||t==null||n==null||a==null||i==null||l==null)){var{data:m}=f,x;if(m!=null&&m.length>0?x=m:x=h?.slice(y,g+1),x!=null)return Bfe({layout:c,barSettings:f,pos:o,parentViewBox:r,bandSize:l,xAxis:t,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:x,offset:e,cells:p,dataStartIndex:y})}}),hfe=["index"];function Xj(){return Xj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Xj.apply(null,arguments)}function ffe(e,r){if(e==null)return{};var t,n,a=pfe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function pfe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var kD=R.createContext(void 0),mfe=e=>{var r=R.useContext(kD);if(r!=null)return r.stackId;if(e!=null)return nJ(e)},gfe=(e,r)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(r),yfe=e=>{var r=R.useContext(kD);if(r!=null){var{stackId:t}=r;return"url(#".concat(gfe(t,e),")")}},SD=e=>{var{index:r}=e,t=ffe(e,hfe),n=yfe(r);return R.createElement(oi,Xj({className:"recharts-bar-stack-layer",clipPath:n},t))},xfe=["onMouseEnter","onMouseLeave","onClick"],vfe=["value","background","tooltipPosition"],bfe=["id"],wfe=["onMouseEnter","onClick","onMouseLeave"];function hd(){return hd=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},hd.apply(null,arguments)}function jE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function eo(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?jE(Object(t),!0).forEach(function(n){_fe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):jE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function _fe(e,r,t){return(r=jfe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function jfe(e){var r=Nfe(e,"string");return typeof r=="symbol"?r:r+""}function Nfe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pb(e,r){if(e==null)return{};var t,n,a=kfe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function kfe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var Sfe=e=>{var{dataKey:r,name:t,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:r,type:a,color:n,value:Dm(t,r),payload:e}]},Cfe=R.memo(e=>{var{dataKey:r,stroke:t,strokeWidth:n,fill:a,name:i,hide:o,unit:c,tooltipType:u,id:l}=e,d={dataDefinedOnItem:void 0,getPosition:Xf,settings:{stroke:t,strokeWidth:n,fill:a,dataKey:r,nameKey:void 0,name:Dm(i,r),hide:o,type:u,color:a,unit:c,graphicalItemId:l}};return R.createElement(GN,{tooltipEntrySettings:d})});function Afe(e){var r=nr(vh),{data:t,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:c,onClick:u}=i,l=pb(i,xfe),d=VN(o,n,i.id),f=WN(c),p=KN(u,n,i.id);if(!a||t==null)return null;var h=Lf(a);return R.createElement(ko,{zIndex:Zue(a,_a.barBackground)},t.map((y,g)=>{var{value:m,background:x,tooltipPosition:v}=y,w=pb(y,vfe);if(!x)return null;var _=d(y,g),A=f(y,g),P=p(y,g),B=eo(eo(eo(eo(eo({option:a,isActive:String(g)===r},w),{},{fill:"#eee"},x),h),Qg(l,y,g)),{},{onMouseEnter:_,onMouseLeave:A,onClick:P,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return R.createElement(fb,hd({key:"background-bar-".concat(g)},B))}))}function Efe(e){var{showLabels:r,children:t,rects:n}=e,a=n?.map(i=>{var o={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return eo(eo({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return R.createElement(XL,{value:r?a:void 0},t)}function Tfe(e){var{shape:r,activeBar:t,baseProps:n,entry:a,index:i,dataKey:o}=e,c=nr(vh),u=nr(MN),l=t&&String(i)===c&&(u==null||o===u),d=l?t:r;return l?R.createElement(ko,{zIndex:_a.activeBar},R.createElement(SD,{index:i},R.createElement(fb,hd({},n,{name:String(n.name)},a,{isActive:l,option:d,index:i,dataKey:o})))):R.createElement(fb,hd({},n,{name:String(n.name)},a,{isActive:l,option:d,index:i,dataKey:o}))}function Pfe(e){var{shape:r,baseProps:t,entry:n,index:a,dataKey:i}=e;return R.createElement(fb,hd({},t,{name:String(t.name)},n,{isActive:!1,option:r,index:a,dataKey:i}))}function Ofe(e){var r,{data:t,props:n}=e,a=(r=Zo(n))!==null&&r!==void 0?r:{},{id:i}=a,o=pb(a,bfe),{shape:c,dataKey:u,activeBar:l}=n,{onMouseEnter:d,onClick:f,onMouseLeave:p}=n,h=pb(n,wfe),y=VN(d,u,i),g=WN(p),m=KN(f,u,i);return t?R.createElement(R.Fragment,null,t.map((x,v)=>R.createElement(SD,hd({index:v,key:"rectangle-".concat(x?.x,"-").concat(x?.y,"-").concat(x?.value,"-").concat(v),className:"recharts-bar-rectangle"},Qg(h,x,v),{onMouseEnter:y(x,v),onMouseLeave:g(x,v),onClick:m(x,v)}),l?R.createElement(Tfe,{shape:c,activeBar:l,baseProps:o,entry:x,index:v,dataKey:u}):R.createElement(Pfe,{shape:c,baseProps:o,entry:x,index:v,dataKey:u})))):null}function Mfe(e){var{props:r,previousRectanglesRef:t}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:o,animationDuration:c,animationEasing:u,onAnimationEnd:l,onAnimationStart:d}=r,f=t.current,p=sy(r,"recharts-bar-"),[h,y]=R.useState(!1),g=!h,m=R.useCallback(()=>{typeof l=="function"&&l(),y(!1)},[l]),x=R.useCallback(()=>{typeof d=="function"&&d(),y(!0)},[d]);return R.createElement(Efe,{showLabels:g,rects:n},R.createElement(ny,{animationId:p,begin:o,duration:c,isActive:i,easing:u,onAnimationEnd:m,onAnimationStart:x,key:p},v=>{var w=v===1?n:n?.map((_,A)=>{var P=f&&f[A];if(P)return eo(eo({},_),{},{x:vs(P.x,_.x,v),y:vs(P.y,_.y,v),width:vs(P.width,_.width,v),height:vs(P.height,_.height,v)});if(a==="horizontal"){var B=vs(0,_.height,v),T=vs(_.stackedBarStart,_.y,v);return eo(eo({},_),{},{y:T,height:B})}var I=vs(0,_.width,v),U=vs(_.stackedBarStart,_.x,v);return eo(eo({},_),{},{width:I,x:U})});return v>0&&(t.current=w??null),w==null?null:R.createElement(oi,null,R.createElement(Ofe,{props:r,data:w}))}),R.createElement($N,{label:r.label}),r.children)}function Ife(e){var r=R.useRef(null);return R.createElement(Mfe,{previousRectanglesRef:r,props:e})}var CD=0,Rfe=(e,r)=>{var t=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:t,errorVal:Hn(e,r)}};class Lfe extends R.PureComponent{render(){var{hide:r,data:t,dataKey:n,className:a,xAxisId:i,yAxisId:o,needClip:c,background:u,id:l}=this.props;if(r||t==null)return null;var d=yn("recharts-bar",a),f=l;return R.createElement(oi,{className:d,id:l},c&&R.createElement("defs",null,R.createElement(yD,{clipPathId:f,xAxisId:i,yAxisId:o})),R.createElement(oi,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(f,")"):void 0},R.createElement(Afe,{data:t,dataKey:n,background:u,allOtherBarProps:this.props}),R.createElement(Ife,this.props)))}}var Dfe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:CD,xAxisId:0,yAxisId:0,zIndex:_a.bar};function Ffe(e){var{xAxisId:r,yAxisId:t,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:c,animationDuration:u,animationEasing:l,isAnimationActive:d}=e,{needClip:f}=JN(r,t),p=Yf(),h=Ui(),y=UN(e.children,Jf),g=nr(v=>dfe(v,e.id,h,y));if(p!=="vertical"&&p!=="horizontal")return null;var m,x=g?.[0];return x==null||x.height==null||x.width==null?m=0:m=p==="vertical"?x.height/2:x.width/2,R.createElement(gD,{xAxisId:r,yAxisId:t,data:g,dataPointFormatter:Rfe,errorBarOffset:m},R.createElement(Lfe,hd({},e,{layout:p,needClip:f,data:g,xAxisId:r,yAxisId:t,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:c,animationDuration:u,animationEasing:l,isAnimationActive:d})))}function Bfe(e){var{layout:r,barSettings:{dataKey:t,minPointSize:n},pos:a,bandSize:i,xAxis:o,yAxis:c,xAxisTicks:u,yAxisTicks:l,stackedData:d,displayedData:f,offset:p,cells:h,parentViewBox:y,dataStartIndex:g}=e,m=r==="horizontal"?c:o,x=d?m.scale.domain():null,v=sJ({numericAxis:m}),w=m.scale.map(v);return f.map((_,A)=>{var P,B,T,I,U,H;if(d){var z=d[A+g];if(z==null)return null;P=ZZ(z,x)}else P=Hn(_,t),Array.isArray(P)||(P=[v,P]);var O=Ghe(n,CD)(P[1],A);if(r==="horizontal"){var L,E=c.scale.map(P[0]),k=c.scale.map(P[1]);if(E==null||k==null)return null;B=sC({axis:o,ticks:u,bandSize:i,offset:a.offset,entry:_,index:A}),T=(L=k??E)!==null&&L!==void 0?L:void 0,I=a.size;var N=E-k;if(U=Zc(N)?0:N,H={x:B,y:p.top,width:I,height:p.height},Math.abs(O)>0&&Math.abs(U)<Math.abs(O)){var S=ni(U||O)*(Math.abs(O)-Math.abs(U));T-=S,U+=S}}else{var C=o.scale.map(P[0]),D=o.scale.map(P[1]);if(C==null||D==null)return null;if(B=C,T=sC({axis:c,ticks:l,bandSize:i,offset:a.offset,entry:_,index:A}),I=D-C,U=a.size,H={x:p.left,y:T,width:p.width,height:U},Math.abs(O)>0&&Math.abs(I)<Math.abs(O)){var q=ni(I||O)*(Math.abs(O)-Math.abs(I));I+=q}}if(B==null||T==null||I==null||U==null)return null;var M=eo(eo({},_),{},{stackedBarStart:w,x:B,y:T,width:I,height:U,value:d?P:P[1],payload:_,background:H,tooltipPosition:{x:B+I/2,y:T+U/2},parentViewBox:y},h&&h[A]&&h[A].props);return M}).filter(Boolean)}function $fe(e){var r=Sa(e,Dfe),t=mfe(r.stackId),n=Ui();return R.createElement(XN,{id:r.id,type:"bar"},a=>R.createElement(R.Fragment,null,R.createElement(aD,{legendPayload:Sfe(r)}),R.createElement(Cfe,{dataKey:r.dataKey,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:a}),R.createElement(oD,{type:"bar",id:a,data:void 0,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,stackId:t,hide:r.hide,barSize:r.barSize,minPointSize:r.minPointSize,maxBarSize:r.maxBarSize,isPanorama:n}),R.createElement(ko,{zIndex:r.zIndex},R.createElement(Ffe,hd({},r,{id:a})))))}var zc=R.memo($fe,$1);zc.displayName="Bar";var qfe=["domain","range"],zfe=["domain","range"];function NE(e,r){if(e==null)return{};var t,n,a=Ufe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Ufe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function kE(e,r){return e===r?!0:Array.isArray(e)&&e.length===2&&Array.isArray(r)&&r.length===2?e[0]===r[0]&&e[1]===r[1]:!1}function AD(e,r){if(e===r)return!0;var{domain:t,range:n}=e,a=NE(e,qfe),{domain:i,range:o}=r,c=NE(r,zfe);return!kE(t,i)||!kE(n,o)?!1:$1(a,c)}var Hfe=["type"],Vfe=["dangerouslySetInnerHTML","ticks","scale"],Wfe=["id","scale"];function Yj(){return Yj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Yj.apply(null,arguments)}function SE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function CE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?SE(Object(t),!0).forEach(function(n){Kfe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Kfe(e,r,t){return(r=Gfe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Gfe(e){var r=Xfe(e,"string");return typeof r=="symbol"?r:r+""}function Xfe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Qj(e,r){if(e==null)return{};var t,n,a=Yfe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Yfe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function Qfe(e){var r=rs(),t=R.useRef(null),n=mI(),{type:a}=e,i=Qj(e,Hfe),o=N1(n,"xAxis",a),c=R.useMemo(()=>{if(o!=null)return CE(CE({},i),{},{type:o})},[i,o]);return R.useLayoutEffect(()=>{c!=null&&(t.current===null?r(Aue(c)):t.current!==c&&r(Eue({prev:t.current,next:c})),t.current=c)},[c,r]),R.useLayoutEffect(()=>()=>{t.current&&(r(Tue(t.current)),t.current=null)},[r]),null}var Zfe=e=>{var{xAxisId:r,className:t}=e,n=nr(b3),a=Ui(),i="xAxis",o=nr(x=>lL(x,i,r,a)),c=nr(x=>sL(x,r)),u=nr(x=>xae(x,r)),l=nr(x=>BR(x,r));if(c==null||u==null||l==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:p}=e,h=Qj(e,Vfe),{id:y,scale:g}=l,m=Qj(l,Wfe);return R.createElement(ZN,Yj({},h,m,{x:u.x,y:u.y,width:c.width,height:c.height,className:yn("recharts-".concat(i," ").concat(i),t),viewBox:n,ticks:o,axisType:i}))},Jfe={allowDataOverflow:Ja.allowDataOverflow,allowDecimals:Ja.allowDecimals,allowDuplicatedCategory:Ja.allowDuplicatedCategory,angle:Ja.angle,axisLine:td.axisLine,height:Ja.height,hide:!1,includeHidden:Ja.includeHidden,interval:Ja.interval,label:!1,minTickGap:Ja.minTickGap,mirror:Ja.mirror,orientation:Ja.orientation,padding:Ja.padding,reversed:Ja.reversed,scale:Ja.scale,tick:Ja.tick,tickCount:Ja.tickCount,tickLine:td.tickLine,tickSize:td.tickSize,type:Ja.type,xAxisId:0},epe=e=>{var r=Sa(e,Jfe);return R.createElement(R.Fragment,null,R.createElement(Qfe,{allowDataOverflow:r.allowDataOverflow,allowDecimals:r.allowDecimals,allowDuplicatedCategory:r.allowDuplicatedCategory,angle:r.angle,dataKey:r.dataKey,domain:r.domain,height:r.height,hide:r.hide,id:r.xAxisId,includeHidden:r.includeHidden,interval:r.interval,minTickGap:r.minTickGap,mirror:r.mirror,name:r.name,orientation:r.orientation,padding:r.padding,reversed:r.reversed,scale:r.scale,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit}),R.createElement(Zfe,r))},Cf=R.memo(epe,AD);Cf.displayName="XAxis";var tpe=["type"],rpe=["dangerouslySetInnerHTML","ticks","scale"],npe=["id","scale"];function Zj(){return Zj=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Zj.apply(null,arguments)}function AE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function EE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?AE(Object(t),!0).forEach(function(n){spe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):AE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function spe(e,r,t){return(r=ape(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ape(e){var r=ipe(e,"string");return typeof r=="symbol"?r:r+""}function ipe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Jj(e,r){if(e==null)return{};var t,n,a=ope(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function ope(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function lpe(e){var r=rs(),t=R.useRef(null),n=mI(),{type:a}=e,i=Jj(e,tpe),o=N1(n,"yAxis",a),c=R.useMemo(()=>{if(o!=null)return EE(EE({},i),{},{type:o})},[o,i]);return R.useLayoutEffect(()=>{c!=null&&(t.current===null?r(Pue(c)):t.current!==c&&r(Oue({prev:t.current,next:c})),t.current=c)},[c,r]),R.useLayoutEffect(()=>()=>{t.current&&(r(Mue(t.current)),t.current=null)},[r]),null}function cpe(e){var{yAxisId:r,className:t,width:n,label:a}=e,i=R.useRef(null),o=R.useRef(null),c=nr(b3),u=Ui(),l=rs(),d="yAxis",f=nr(P=>aL(P,r)),p=nr(P=>bae(P,r)),h=nr(P=>lL(P,d,r,u)),y=nr(P=>$R(P,r));if(R.useLayoutEffect(()=>{if(!(n!=="auto"||!f||BN(a)||R.isValidElement(a)||y==null)){var P=i.current;if(P){var B=P.getCalculatedWidth();Math.round(f.width)!==Math.round(B)&&l(Iue({id:r,width:B}))}}},[h,f,l,a,r,n,y]),f==null||p==null||y==null)return null;var{dangerouslySetInnerHTML:g,ticks:m,scale:x}=e,v=Jj(e,rpe),{id:w,scale:_}=y,A=Jj(y,npe);return R.createElement(ZN,Zj({},v,A,{ref:i,labelRef:o,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:yn("recharts-".concat(d," ").concat(d),t),viewBox:c,ticks:h,axisType:d}))}var upe={allowDataOverflow:ei.allowDataOverflow,allowDecimals:ei.allowDecimals,allowDuplicatedCategory:ei.allowDuplicatedCategory,angle:ei.angle,axisLine:td.axisLine,hide:!1,includeHidden:ei.includeHidden,interval:ei.interval,label:!1,minTickGap:ei.minTickGap,mirror:ei.mirror,orientation:ei.orientation,padding:ei.padding,reversed:ei.reversed,scale:ei.scale,tick:ei.tick,tickCount:ei.tickCount,tickLine:td.tickLine,tickSize:td.tickSize,type:ei.type,width:ei.width,yAxisId:0},dpe=e=>{var r=Sa(e,upe);return R.createElement(R.Fragment,null,R.createElement(lpe,{interval:r.interval,id:r.yAxisId,scale:r.scale,type:r.type,domain:r.domain,allowDataOverflow:r.allowDataOverflow,dataKey:r.dataKey,allowDuplicatedCategory:r.allowDuplicatedCategory,allowDecimals:r.allowDecimals,tickCount:r.tickCount,padding:r.padding,includeHidden:r.includeHidden,reversed:r.reversed,ticks:r.ticks,width:r.width,orientation:r.orientation,mirror:r.mirror,hide:r.hide,unit:r.unit,name:r.name,angle:r.angle,minTickGap:r.minTickGap,tick:r.tick,tickFormatter:r.tickFormatter}),R.createElement(cpe,r))},Af=R.memo(dpe,AD);Af.displayName="YAxis";var hpe=(e,r)=>r,t6=Xe([hpe,wn,LR,ci,kL,jd,Lie,qa],Uie),r6=e=>{var r=e.currentTarget.getBoundingClientRect(),t=r.width/e.currentTarget.offsetWidth,n=r.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-r.left)/t),chartY:Math.round((e.clientY-r.top)/n)}},ED=Nl("mouseClick"),TD=Jg();TD.startListening({actionCreator:ED,effect:(e,r)=>{var t=e.payload,n=t6(r.getState(),r6(t));n?.activeIndex!=null&&r.dispatch(Iae({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var e4=Nl("mouseMove"),PD=Jg(),Ax=null;PD.startListening({actionCreator:e4,effect:(e,r)=>{var t=e.payload;Ax!==null&&cancelAnimationFrame(Ax);var n=r6(t);Ax=requestAnimationFrame(()=>{var a=r.getState(),i=CN(a,a.tooltip.settings.shared);if(i==="axis"){var o=t6(a,n);o?.activeIndex!=null?r.dispatch(gL({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):r.dispatch(mL())}Ax=null})}});function fpe(e,r){return r instanceof HTMLElement?"HTMLElement <".concat(r.tagName,' class="').concat(r.className,'">'):r===window?"global.window":e==="children"&&typeof r=="object"&&r!==null?"<<CHILDREN>>":r}var TE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},OD=No({name:"rootProps",initialState:TE,reducers:{updateOptions:(e,r)=>{var t;e.accessibilityLayer=r.payload.accessibilityLayer,e.barCategoryGap=r.payload.barCategoryGap,e.barGap=(t=r.payload.barGap)!==null&&t!==void 0?t:TE.barGap,e.barSize=r.payload.barSize,e.maxBarSize=r.payload.maxBarSize,e.stackOffset=r.payload.stackOffset,e.syncId=r.payload.syncId,e.syncMethod=r.payload.syncMethod,e.className=r.payload.className,e.baseValue=r.payload.baseValue,e.reverseStackOrder=r.payload.reverseStackOrder}}}),ppe=OD.reducer,{updateOptions:mpe}=OD.actions,gpe=null,ype={updatePolarOptions:(e,r)=>r.payload},MD=No({name:"polarOptions",initialState:gpe,reducers:ype}),{updatePolarOptions:xpe}=MD.actions,vpe=MD.reducer,ID=Nl("keyDown"),RD=Nl("focus"),n6=Jg();n6.startListening({actionCreator:ID,effect:(e,r)=>{var t=r.getState(),n=t.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=t.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=AN(a,Wm(t),hy(t),py(t)),c=o==null?-1:Number(o);if(!(!Number.isFinite(c)||c<0)){var u=jd(t);if(i==="Enter"){var l=ob(t,"axis","hover",String(a.index));r.dispatch(Uj({active:!a.active,activeIndex:a.index,activeCoordinate:l}));return}var d=Nae(t),f=d==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,h=c+p*f;if(!(u==null||h>=u.length||h<0)){var y=ob(t,"axis","hover",String(h));r.dispatch(Uj({active:!0,activeIndex:h.toString(),activeCoordinate:y}))}}}}}});n6.startListening({actionCreator:RD,effect:(e,r)=>{var t=r.getState(),n=t.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=t.tooltip;if(!a.active&&a.index==null){var i="0",o=ob(t,"axis","hover",String(i));r.dispatch(Uj({active:!0,activeIndex:i,activeCoordinate:o}))}}}});var gl=Nl("externalEvent"),LD=Jg(),M_=new Map;LD.startListening({actionCreator:gl,effect:(e,r)=>{var{handler:t,reactEvent:n}=e.payload;if(t!=null){n.persist();var a=n.type,i=M_.get(a);i!==void 0&&cancelAnimationFrame(i);var o=requestAnimationFrame(()=>{try{var c=r.getState(),u={activeCoordinate:bie(c),activeDataKey:MN(c),activeIndex:vh(c),activeLabel:AL(c),activeTooltipIndex:vh(c),isTooltipActive:wie(c)};t(u,n)}finally{M_.delete(a)}});M_.set(a,o)}}});var bpe=Xe([Hm],e=>e.tooltipItemPayloads),wpe=Xe([bpe,(e,r)=>r,(e,r,t)=>t],(e,r,t)=>{if(r!=null){var n=e.find(i=>i.settings.graphicalItemId===t);if(n!=null){var{getPosition:a}=n;if(a!=null)return a(r)}}}),DD=Nl("touchMove"),FD=Jg();FD.startListening({actionCreator:DD,effect:(e,r)=>{var t=e.payload;if(!(t.touches==null||t.touches.length===0)){var n=r.getState(),a=CN(n,n.tooltip.settings.shared);if(a==="axis"){var i=t.touches[0];if(i==null)return;var o=t6(n,r6({clientX:i.clientX,clientY:i.clientY,currentTarget:t.currentTarget}));o?.activeIndex!=null&&r.dispatch(gL({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var c,u=t.touches[0];if(document.elementFromPoint==null||u==null)return;var l=document.elementFromPoint(u.clientX,u.clientY);if(!l||!l.getAttribute)return;var d=l.getAttribute(cI),f=(c=l.getAttribute(uI))!==null&&c!==void 0?c:void 0,p=Vm(n).find(g=>g.id===f);if(d==null||p==null||f==null)return;var{dataKey:h}=p,y=wpe(n,d,f);r.dispatch(pL({activeDataKey:h,activeIndex:d,activeCoordinate:y,activeGraphicalItemId:f}))}}}});var _pe=PM({brush:Jue,cartesianAxis:Rue,chartData:boe,errorBars:Kde,graphicalItems:zce,layout:KZ,legend:eee,options:moe,polarAxis:rce,polarOptions:vpe,referenceElements:nde,rootProps:ppe,tooltip:Rae,zIndex:noe}),jpe=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return xZ({reducer:_pe,preloadedState:r,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([TD.middleware,PD.middleware,n6.middleware,LD.middleware,FD.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(WM({type:"raf"}))},devTools:{serialize:{replacer:fpe},name:"recharts-".concat(t)}})};function BD(e){var{preloadedState:r,children:t,reduxStoreName:n}=e,a=Ui(),i=R.useRef(null);if(a)return t;i.current==null&&(i.current=jpe(r,n));var o=f3;return R.createElement(_he,{context:o,store:i.current},t)}function Npe(e){var{layout:r,margin:t}=e,n=rs(),a=Ui();return R.useEffect(()=>{a||(n(HZ(r)),n(UZ(t)))},[n,a,r,t]),null}var $D=R.memo(Npe,$1);function qD(e){var r=rs();return R.useEffect(()=>{r(mpe(e))},[r,e]),null}function PE(e){var{zIndex:r,isPanorama:t}=e,n=R.useRef(null),a=rs();return R.useLayoutEffect(()=>(n.current&&a(toe({zIndex:r,element:n.current,isPanorama:t})),()=>{a(roe({zIndex:r,isPanorama:t}))}),[a,r,t]),R.createElement("g",{tabIndex:-1,ref:n})}function OE(e){var{children:r,isPanorama:t}=e,n=nr(Vie);if(!n||n.length===0)return r;var a=n.filter(o=>o<0),i=n.filter(o=>o>0);return R.createElement(R.Fragment,null,a.map(o=>R.createElement(PE,{key:o,zIndex:o,isPanorama:t})),r,i.map(o=>R.createElement(PE,{key:o,zIndex:o,isPanorama:t})))}var kpe=["children"];function Spe(e,r){if(e==null)return{};var t,n,a=Cpe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Cpe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}function mb(){return mb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},mb.apply(null,arguments)}var Ape={width:"100%",height:"100%",display:"block"},Epe=R.forwardRef((e,r)=>{var t=j3(),n=N3(),a=CI();if(!eu(t)||!eu(n))return null;var{children:i,otherAttributes:o,title:c,desc:u}=e,l,d;return o!=null&&(typeof o.tabIndex=="number"?l=o.tabIndex:l=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),R.createElement(r3,mb({},o,{title:c,desc:u,role:d,tabIndex:l,width:t,height:n,style:Ape,ref:r}),i)}),Tpe=e=>{var{children:r}=e,t=nr(u1);if(!t)return null;var{width:n,height:a,y:i,x:o}=t;return R.createElement(r3,{width:n,height:a,x:o,y:i},r)},ME=R.forwardRef((e,r)=>{var{children:t}=e,n=Spe(e,kpe),a=Ui();return a?R.createElement(Tpe,null,R.createElement(OE,{isPanorama:!0},t)):R.createElement(Epe,mb({ref:r},n),R.createElement(OE,{isPanorama:!1},t))});function Ppe(){var e=rs(),[r,t]=R.useState(null),n=nr(uJ);return R.useEffect(()=>{if(r!=null){var a=r.getBoundingClientRect(),i=a.width/r.offsetWidth;un(i)&&i!==n&&e(WZ(i))}},[r,e,n]),t}function IE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ope(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?IE(Object(t),!0).forEach(function(n){Mpe(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):IE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Mpe(e,r,t){return(r=Ipe(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ipe(e){var r=Rpe(e,"string");return typeof r=="symbol"?r:r+""}function Rpe(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},gh.apply(null,arguments)}var Lpe=()=>(Eoe(),null);function gb(e){if(typeof e=="number")return e;if(typeof e=="string"){var r=parseFloat(e);if(!Number.isNaN(r))return r}return 0}var Dpe=R.forwardRef((e,r)=>{var t,n,a=R.useRef(null),[i,o]=R.useState({containerWidth:gb((t=e.style)===null||t===void 0?void 0:t.width),containerHeight:gb((n=e.style)===null||n===void 0?void 0:n.height)}),c=R.useCallback((l,d)=>{o(f=>{var p=Math.round(l),h=Math.round(d);return f.containerWidth===p&&f.containerHeight===h?f:{containerWidth:p,containerHeight:h}})},[]),u=R.useCallback(l=>{if(typeof r=="function"&&r(l),l!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=l.getBoundingClientRect();c(d,f);var p=y=>{var g=y[0];if(g!=null){var{width:m,height:x}=g.contentRect;c(m,x)}},h=new ResizeObserver(p);h.observe(l),a.current=h}},[r,c]);return R.useEffect(()=>()=>{var l=a.current;l?.disconnect()},[c]),R.createElement(R.Fragment,null,R.createElement(ty,{width:i.containerWidth,height:i.containerHeight}),R.createElement("div",gh({ref:u},e)))}),Fpe=R.forwardRef((e,r)=>{var{width:t,height:n}=e,[a,i]=R.useState({containerWidth:gb(t),containerHeight:gb(n)}),o=R.useCallback((u,l)=>{i(d=>{var f=Math.round(u),p=Math.round(l);return d.containerWidth===f&&d.containerHeight===p?d:{containerWidth:f,containerHeight:p}})},[]),c=R.useCallback(u=>{if(typeof r=="function"&&r(u),u!=null){var{width:l,height:d}=u.getBoundingClientRect();o(l,d)}},[r,o]);return R.createElement(R.Fragment,null,R.createElement(ty,{width:a.containerWidth,height:a.containerHeight}),R.createElement("div",gh({ref:c},e)))}),Bpe=R.forwardRef((e,r)=>{var{width:t,height:n}=e;return R.createElement(R.Fragment,null,R.createElement(ty,{width:t,height:n}),R.createElement("div",gh({ref:r},e)))}),$pe=R.forwardRef((e,r)=>{var{width:t,height:n}=e;return typeof t=="string"||typeof n=="string"?R.createElement(Fpe,gh({},e,{ref:r})):typeof t=="number"&&typeof n=="number"?R.createElement(Bpe,gh({},e,{width:t,height:n,ref:r})):R.createElement(R.Fragment,null,R.createElement(ty,{width:t,height:n}),R.createElement("div",gh({ref:r},e)))});function qpe(e){return e?Dpe:$pe}var zpe=R.forwardRef((e,r)=>{var{children:t,className:n,height:a,onClick:i,onContextMenu:o,onDoubleClick:c,onMouseDown:u,onMouseEnter:l,onMouseLeave:d,onMouseMove:f,onMouseUp:p,onTouchEnd:h,onTouchMove:y,onTouchStart:g,style:m,width:x,responsive:v,dispatchTouchEvents:w=!0}=e,_=R.useRef(null),A=rs(),[P,B]=R.useState(null),[T,I]=R.useState(null),U=Ppe(),H=w3(),z=H?.width>0?H.width:x,O=H?.height>0?H.height:a,L=R.useCallback(F=>{U(F),typeof r=="function"&&r(F),B(F),I(F),F!=null&&(_.current=F)},[U,r,B,I]),E=R.useCallback(F=>{A(ED(F)),A(gl({handler:i,reactEvent:F}))},[A,i]),k=R.useCallback(F=>{A(e4(F)),A(gl({handler:l,reactEvent:F}))},[A,l]),N=R.useCallback(F=>{A(mL()),A(gl({handler:d,reactEvent:F}))},[A,d]),S=R.useCallback(F=>{A(e4(F)),A(gl({handler:f,reactEvent:F}))},[A,f]),C=R.useCallback(()=>{A(RD())},[A]),D=R.useCallback(F=>{A(ID(F.key))},[A]),q=R.useCallback(F=>{A(gl({handler:o,reactEvent:F}))},[A,o]),M=R.useCallback(F=>{A(gl({handler:c,reactEvent:F}))},[A,c]),G=R.useCallback(F=>{A(gl({handler:u,reactEvent:F}))},[A,u]),X=R.useCallback(F=>{A(gl({handler:p,reactEvent:F}))},[A,p]),re=R.useCallback(F=>{A(gl({handler:g,reactEvent:F}))},[A,g]),V=R.useCallback(F=>{w&&A(DD(F)),A(gl({handler:y,reactEvent:F}))},[A,w,y]),J=R.useCallback(F=>{A(gl({handler:h,reactEvent:F}))},[A,h]),W=qpe(v);return R.createElement(RL.Provider,{value:P},R.createElement(GO.Provider,{value:T},R.createElement(W,{width:z??m?.width,height:O??m?.height,className:yn("recharts-wrapper",n),style:Ope({position:"relative",cursor:"default",width:z,height:O},m),onClick:E,onContextMenu:q,onDoubleClick:M,onFocus:C,onKeyDown:D,onMouseDown:G,onMouseEnter:k,onMouseLeave:N,onMouseMove:S,onMouseUp:X,onTouchEnd:J,onTouchMove:V,onTouchStart:re,ref:L},R.createElement(Lpe,null),t)))}),Upe=["width","height","responsive","children","className","style","compact","title","desc"];function Hpe(e,r){if(e==null)return{};var t,n,a=Vpe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Vpe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var zD=R.forwardRef((e,r)=>{var{width:t,height:n,responsive:a,children:i,className:o,style:c,compact:u,title:l,desc:d}=e,f=Hpe(e,Upe),p=Zo(f);return u?R.createElement(R.Fragment,null,R.createElement(ty,{width:t,height:n}),R.createElement(ME,{otherAttributes:p,title:l,desc:d},i)):R.createElement(zpe,{className:o,style:c,width:t,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},R.createElement(ME,{otherAttributes:p,title:l,desc:d,ref:r},R.createElement(ade,null,i)))});function t4(){return t4=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},t4.apply(null,arguments)}var Wpe={top:5,right:5,bottom:5,left:5},Kpe={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Wpe,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},UD=R.forwardRef(function(r,t){var n,a=Sa(r.categoricalChartProps,Kpe),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:u,categoricalChartProps:l}=r,d={chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:u,eventEmitter:void 0};return R.createElement(BD,{preloadedState:{options:d},reduxStoreName:(n=l.id)!==null&&n!==void 0?n:i},R.createElement(uD,{chartData:l.data}),R.createElement($D,{layout:a.layout,margin:a.margin}),R.createElement(qD,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),R.createElement(zD,t4({},a,{ref:t})))}),Gpe=["axis"],HD=R.forwardRef((e,r)=>R.createElement(UD,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Gpe,tooltipPayloadSearcher:FN,categoricalChartProps:e,ref:r})),Xpe=["axis","item"],yb=R.forwardRef((e,r)=>R.createElement(UD,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Xpe,tooltipPayloadSearcher:FN,categoricalChartProps:e,ref:r}));function Ype(e){var r=rs();return R.useEffect(()=>{r(xpe(e))},[r,e]),null}var Qpe=["layout"];function r4(){return r4=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},r4.apply(null,arguments)}function Zpe(e,r){if(e==null)return{};var t,n,a=Jpe(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function Jpe(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.indexOf(n)!==-1)continue;t[n]=e[n]}return t}var eme={top:5,right:5,bottom:5,left:5},VD={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:eme,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},tme=R.forwardRef(function(r,t){var n,a=Sa(r.categoricalChartProps,VD),{layout:i}=a,o=Zpe(a,Qpe),{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:l,tooltipPayloadSearcher:d}=r,f={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,eventEmitter:void 0};return R.createElement(BD,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:c},R.createElement(uD,{chartData:a.data}),R.createElement($D,{layout:i,margin:a.margin}),R.createElement(qD,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),R.createElement(Ype,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),R.createElement(zD,r4({},o,{ref:t})))});function RE(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function LE(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?RE(Object(t),!0).forEach(function(n){rme(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):RE(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function rme(e,r,t){return(r=nme(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function nme(e){var r=sme(e,"string");return typeof r=="symbol"?r:r+""}function sme(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ame=["item"],ime=LE(LE({},VD),{},{layout:"centric",startAngle:0,endAngle:360}),s6=R.forwardRef((e,r)=>{var t=Sa(e,ime);return R.createElement(tme,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:ame,tooltipPayloadSearcher:FN,categoricalChartProps:t,ref:r})});const DE={draft:{label:"Nhp",color:"#9CA3AF"},in_progress:{label:"ang lm",color:"#3B82F6"},paused:{label:"Tm dng",color:"#F59E0B"},finished:{label:"Hon thnh",color:"#10B981"},cancelled:{label:" hy",color:"#EF4444"}};function ome(e){return e>=90?"Xut sc":e>=80?"Tt":e>=70?"Kh":e>=60?"Trung bnh":"Cn ci thin"}const Mu={async getStats(){try{const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),1).toISOString(),t=new Date(e.setDate(e.getDate()-e.getDay())).toISOString(),n=new Date().toISOString().split("T")[0],[a,i,o,c,u,l,d,f,p]=await Promise.all([se.from("employees").select("id",{count:"exact",head:!0}).eq("status","active"),se.from("employees").select("id",{count:"exact",head:!0}).eq("status","active").gte("created_at",r),se.from("tasks").select("id",{count:"exact",head:!0}),se.from("tasks").select("id",{count:"exact",head:!0}).gte("created_at",t),se.from("tasks").select("id",{count:"exact",head:!0}).eq("status","finished"),se.from("tasks").select("id",{count:"exact",head:!0}).lt("due_date",n).not("status","in",'("finished","cancelled")'),se.from("task_self_evaluations").select("id",{count:"exact",head:!0}).eq("status","pending"),se.from("leave_requests").select("id",{count:"exact",head:!0}).eq("status","approved").lte("start_date",n).gte("end_date",n),se.from("tasks").select("id",{count:"exact",head:!0}).gte("due_date",n).lte("due_date",new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0]).not("status","in",'("finished","cancelled")')]),h=a.count||0,y=i.count||0,g=o.count||0,m=c.count||0,x=u.count||0,v=l.count||0,w=d.count||0,_=f.count||0,A=p.count||0,P=g>0?Math.round(x/g*100):0;return{data:{totalEmployees:h,newEmployeesThisMonth:y,totalTasks:g,newTasksThisWeek:m,completedTasks:x,completionRate:P,overdueTasks:v,pendingApprovals:w,leavesToday:_,upcomingDeadlines:A},error:null}}catch(e){return{data:null,error:e}}},async getTaskStatusDistribution(){try{const{data:e,error:r}=await se.from("tasks").select("status");if(r)throw r;const t={};return(e||[]).forEach(a=>{const i=a.status||"draft";t[i]=(t[i]||0)+1}),{data:Object.entries(t).map(([a,i])=>({status:a,label:DE[a]?.label||a,count:i,color:DE[a]?.color||"#9CA3AF"})),error:null}}catch(e){return{data:[],error:e}}},async getTaskTrend(e=12){try{const r=[],t=new Date;for(let n=e-1;n>=0;n--){const a=new Date(t);a.setDate(a.getDate()-n*7-a.getDay()),a.setHours(0,0,0,0);const i=new Date(a);i.setDate(i.getDate()+6),i.setHours(23,59,59,999);const[o,c]=await Promise.all([se.from("tasks").select("id",{count:"exact",head:!0}).gte("created_at",a.toISOString()).lte("created_at",i.toISOString()),se.from("tasks").select("id",{count:"exact",head:!0}).eq("status","finished").gte("updated_at",a.toISOString()).lte("updated_at",i.toISOString())]);r.push({date:a.toISOString().split("T")[0],label:`${a.getDate()}/${a.getMonth()+1}`,created:o.count||0,completed:c.count||0})}return{data:r,error:null}}catch(r){return{data:[],error:r}}},async getDepartmentPerformance(){try{const{data:e,error:r}=await se.from("departments").select("id, name").eq("status","active");if(r)throw r;const{data:t,error:n}=await se.from("tasks").select("id, status, assignee_id");if(n)throw n;const a=[...new Set((t||[]).map(d=>d.assignee_id).filter(Boolean))];let i=new Map;if(a.length>0){const{data:d}=await se.from("employees").select("id, department_id").in("id",a);(d||[]).forEach(f=>{f.department_id&&i.set(f.id,f.department_id)})}const{data:o,error:c}=await se.from("task_approvals").select("approved_score, task_id").eq("action","approved").not("approved_score","is",null);if(c)throw c;const u=new Map;(t||[]).forEach(d=>{const f=d.assignee_id?i.get(d.assignee_id):null;u.set(d.id,{status:d.status,department_id:f})});const l=[];for(const d of e||[]){const f=(t||[]).filter(m=>(m.assignee_id?i.get(m.assignee_id):null)===d.id),p=f.length,h=f.filter(m=>m.status==="finished").length,y=(o||[]).filter(m=>u.get(m.task_id)?.department_id===d.id).map(m=>m.approved_score).filter(Boolean),g=y.length>0?Math.round(y.reduce((m,x)=>m+x,0)/y.length):0;l.push({department_id:d.id,department_name:d.name,total_tasks:p,completed_tasks:h,completion_rate:p>0?Math.round(h/p*100):0,avg_score:g})}return l.sort((d,f)=>f.completion_rate!==d.completion_rate?f.completion_rate-d.completion_rate:f.total_tasks-d.total_tasks),{data:l,error:null}}catch(e){return console.error(" [getDepartmentPerformance] error:",e),{data:[],error:e}}},async getTopEmployees(e=5){try{const{data:r,error:t}=await se.from("task_approvals").select("approved_score, rating, task_id").eq("action","approved").not("approved_score","is",null);if(t)throw t;if(!r||r.length===0)return{data:[],error:null};const n=[...new Set(r.map(h=>h.task_id))],{data:a,error:i}=await se.from("tasks").select("id, assignee_id").in("id",n);if(i)throw i;const o=[...new Set((a||[]).map(h=>h.assignee_id).filter(Boolean))];let c=new Map;if(o.length>0){const{data:h}=await se.from("employees").select("id, code, full_name, department_id").in("id",o);(h||[]).forEach(y=>{c.set(y.id,y)})}const u=[...new Set(Array.from(c.values()).map(h=>h.department_id).filter(Boolean))];let l=new Map;if(u.length>0){const{data:h}=await se.from("departments").select("id, name").in("id",u);(h||[]).forEach(y=>{l.set(y.id,y.name)})}const d=new Map;(a||[]).forEach(h=>{h.assignee_id&&d.set(h.id,h.assignee_id)});const f={};return r.forEach(h=>{const y=d.get(h.task_id);if(!y)return;const g=c.get(y);if(!g)return;const m=g.id;f[m]||(f[m]={employee_id:m,employee_name:g.full_name||"",employee_code:g.code||"",department_name:l.get(g.department_id)||"",total_score:0,count:0}),f[m].total_score+=h.approved_score||0,f[m].count+=1}),{data:Object.values(f).map(h=>({employee_id:h.employee_id,employee_name:h.employee_name,employee_code:h.employee_code,department_name:h.department_name,completed_tasks:h.count,avg_score:h.count>0?Math.round(h.total_score/h.count):0,rating:ome(h.count>0?h.total_score/h.count:0)})).sort((h,y)=>y.avg_score-h.avg_score).slice(0,e),error:null}}catch(r){return console.error(" [getTopEmployees] error:",r),{data:[],error:r}}},async getOverdueTasks(e=10){try{const r=new Date().toISOString().split("T")[0],{data:t,error:n}=await se.from("tasks").select("id, code, name, due_date, priority, assignee_id").lt("due_date",r).not("status","in",'("finished","cancelled")').order("due_date",{ascending:!0}).limit(e);if(n)throw n;const a=[...new Set((t||[]).map(l=>l.assignee_id).filter(Boolean))];let i=new Map;if(a.length>0){const{data:l}=await se.from("employees").select("id, full_name, department_id").in("id",a);(l||[]).forEach(d=>{i.set(d.id,d)})}const o=[...new Set(Array.from(i.values()).map(l=>l.department_id).filter(Boolean))];let c=new Map;if(o.length>0){const{data:l}=await se.from("departments").select("id, name").in("id",o);(l||[]).forEach(d=>{c.set(d.id,d.name)})}return{data:(t||[]).map(l=>{const d=new Date(l.due_date),f=new Date(r),p=Math.ceil((f.getTime()-d.getTime())/(1e3*60*60*24)),h=l.assignee_id?i.get(l.assignee_id):null;return{id:l.id,code:l.code||"",name:l.name||"",due_date:l.due_date,days_overdue:p,assignee_name:h?.full_name||"Cha giao",department_name:h?.department_id&&c.get(h.department_id)||"",priority:l.priority||"medium"}}),error:null}}catch(r){return console.error(" [getOverdueTasks] error:",r),{data:[],error:r}}},async getUpcomingTasks(e=7,r=10){try{const t=new Date().toISOString().split("T")[0],n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],{data:a,error:i}=await se.from("tasks").select("id, code, name, due_date, priority, assignee_id").gte("due_date",t).lte("due_date",n).not("status","in",'("finished","cancelled")').order("due_date",{ascending:!0}).limit(r);if(i)throw i;const o=[...new Set((a||[]).map(l=>l.assignee_id).filter(Boolean))];let c=new Map;if(o.length>0){const{data:l}=await se.from("employees").select("id, full_name").in("id",o);(l||[]).forEach(d=>{c.set(d.id,d.full_name)})}return{data:(a||[]).map(l=>{const d=new Date(l.due_date),f=new Date(t),p=Math.ceil((d.getTime()-f.getTime())/(1e3*60*60*24));return{id:l.id,code:l.code||"",name:l.name||"",due_date:l.due_date,days_until_due:p,assignee_name:l.assignee_id&&c.get(l.assignee_id)||"Cha giao",priority:l.priority||"medium"}}),error:null}}catch(t){return console.error(" [getUpcomingTasks] error:",t),{data:[],error:t}}},async getRecentActivities(e=10){try{const{data:r,error:t}=await se.from("task_activities").select("id, action, description, created_at, actor_id, task_id").order("created_at",{ascending:!1}).limit(e);if(t)throw t;const n=[...new Set((r||[]).map(u=>u.actor_id).filter(Boolean))];let a=new Map;if(n.length>0){const{data:u}=await se.from("employees").select("id, full_name").in("id",n);(u||[]).forEach(l=>{a.set(l.id,l.full_name)})}const i=[...new Set((r||[]).map(u=>u.task_id).filter(Boolean))];let o=new Map;if(i.length>0){const{data:u}=await se.from("tasks").select("id, code, name").in("id",i);(u||[]).forEach(l=>{o.set(l.id,{code:l.code,name:l.name})})}return{data:(r||[]).map(u=>{const l=u.task_id?o.get(u.task_id):null;return{id:u.id,action:u.action,description:u.description||"",actor_name:u.actor_id&&a.get(u.actor_id)||"H thng",task_name:l?.name||"",task_code:l?.code||"",created_at:u.created_at}}),error:null}}catch(r){return console.error(" [getRecentActivities] error:",r),{data:[],error:r}}},async getExpiringContracts(e=30,r=5){try{const t=new Date().toISOString().split("T")[0],n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],{data:a,error:i}=await se.from("contracts").select("id, end_date, employee_id, contract_type_id").eq("status","active").gte("end_date",t).lte("end_date",n).order("end_date",{ascending:!0}).limit(r);if(i)throw i;const o=[...new Set((a||[]).map(f=>f.employee_id).filter(Boolean))];let c=new Map;if(o.length>0){const{data:f}=await se.from("employees").select("id, code, full_name").in("id",o);(f||[]).forEach(p=>{c.set(p.id,{code:p.code,full_name:p.full_name})})}const u=[...new Set((a||[]).map(f=>f.contract_type_id).filter(Boolean))];let l=new Map;if(u.length>0){const{data:f}=await se.from("contract_types").select("id, name").in("id",u);(f||[]).forEach(p=>{l.set(p.id,p.name)})}return{data:(a||[]).map(f=>{const p=new Date(f.end_date),h=new Date(t),y=Math.ceil((p.getTime()-h.getTime())/(1e3*60*60*24)),g=f.employee_id?c.get(f.employee_id):null;return{id:f.id,employee_name:g?.full_name||"",employee_code:g?.code||"",contract_type:f.contract_type_id&&l.get(f.contract_type_id)||"",end_date:f.end_date,days_until_expiry:y}}),error:null}}catch(t){return console.error(" [getExpiringContracts] error:",t),{data:[],error:t}}}},FE={low:"bg-gray-100 text-gray-700",medium:"bg-blue-100 text-blue-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"},BE={low:"Thp",medium:"TB",high:"Cao",urgent:"Khn"},lme={created:" to cng vic",updated:" cp nht",status_changed:" i trng thi",progress_updated:" cp nht tin ",assigned:" giao vic",comment_added:" bnh lun",attachment_added:" nh km file",self_eval_submitted:" np t nh gi",approved:" ph duyt",rejected:" t chi"};function P0({title:e,value:r,subtitle:t,icon:n,trend:a,color:i,onClick:o}){const c={blue:"from-blue-500 to-blue-600",green:"from-emerald-500 to-emerald-600",red:"from-red-500 to-red-600",yellow:"from-amber-500 to-amber-600",purple:"from-purple-500 to-purple-600",indigo:"from-indigo-500 to-indigo-600"},u={blue:"bg-blue-400/30",green:"bg-emerald-400/30",red:"bg-red-400/30",yellow:"bg-amber-400/30",purple:"bg-purple-400/30",indigo:"bg-indigo-400/30"};return s.jsxs("div",{onClick:o,className:`
        relative overflow-hidden rounded-2xl p-5
        bg-gradient-to-br ${c[i]}
        text-white shadow-lg
        transform transition-all duration-300
        ${o?"cursor-pointer hover:scale-105 hover:shadow-xl":""}
      `,children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 transform translate-x-8 -translate-y-8",children:s.jsx("div",{className:`w-full h-full rounded-full ${u[i]} opacity-50`})}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("div",{className:`p-3 rounded-xl ${u[i]}`,children:n}),a&&s.jsxs("div",{className:`flex items-center gap-1 text-sm ${a.isPositive?"text-green-200":"text-red-200"}`,children:[a.isPositive?s.jsx(Q5,{className:"w-4 h-4"}):s.jsx(EV,{className:"w-4 h-4"}),a.value,"%"]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("p",{className:"text-white/80 text-sm font-medium",children:e}),s.jsx("p",{className:"text-3xl font-bold mt-1",children:r}),t&&s.jsx("p",{className:"text-white/70 text-xs mt-1",children:t})]})]}),o&&s.jsx(Ks,{className:"absolute bottom-4 right-4 w-5 h-5 text-white/50"})]})}function Iu({title:e,icon:r,action:t}){return s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gray-100 text-gray-600",children:r}),s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:e})]}),t]})}function Ru({children:e,className:r=""}){return s.jsx("div",{className:`bg-white rounded-2xl shadow-sm border border-gray-100 p-5 ${r}`,children:e})}function I_(){const e=ts(),{user:r}=xn(),[t,n]=R.useState(!0),[a,i]=R.useState(!1),[o,c]=R.useState(null),[u,l]=R.useState([]),[d,f]=R.useState([]),[p,h]=R.useState([]),[y,g]=R.useState([]),[m,x]=R.useState([]),[v,w]=R.useState([]),[_,A]=R.useState([]),[P,B]=R.useState([]),T=R.useCallback(async(U=!1)=>{U?i(!0):n(!0);try{const[H,z,O,L,E,k,N,S,C]=await Promise.all([Mu.getStats(),Mu.getTaskStatusDistribution(),Mu.getTaskTrend(8),Mu.getDepartmentPerformance(),Mu.getTopEmployees(5),Mu.getOverdueTasks(5),Mu.getUpcomingTasks(7,5),Mu.getRecentActivities(8),Mu.getExpiringContracts(30,5)]);H.data&&c(H.data),l(z.data),f(O.data),h(L.data),g(E.data),x(k.data),w(N.data),A(S.data),B(C.data)}catch(H){console.error("Dashboard load error:",H)}finally{n(!1),i(!1)}},[]);R.useEffect(()=>{T()},[T]);const I=U=>{const H=new Date(U),O=new Date().getTime()-H.getTime(),L=Math.floor(O/6e4),E=Math.floor(O/36e5),k=Math.floor(O/864e5);return L<60?`${L} pht trc`:E<24?`${E} gi trc`:k<7?`${k} ngy trc`:H.toLocaleDateString("vi-VN")};return t?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-600",children:"ang ti Dashboard..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Xin cho, ",r?.full_name||"Ngi dng","! "]}),s.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Tng quan h thng  ",new Date().toLocaleDateString("vi-VN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),s.jsxs("button",{onClick:()=>T(!0),disabled:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-xl hover:bg-blue-100 transition-colors disabled:opacity-50",children:[s.jsx(Vr,{className:`w-4 h-4 ${a?"animate-spin":""}`}),s.jsx("span",{className:"hidden sm:inline",children:"Lm mi"})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[s.jsx(P0,{title:"Nhn vin",value:o?.totalEmployees||0,subtitle:o?.newEmployeesThisMonth?`+${o.newEmployeesThisMonth} thng ny`:void 0,icon:s.jsx(_i,{className:"w-6 h-6"}),color:"blue",onClick:()=>e("/employees")}),s.jsx(P0,{title:"Cng vic",value:o?.totalTasks||0,subtitle:o?.newTasksThisWeek?`+${o.newTasksThisWeek} tun ny`:void 0,icon:s.jsx(uh,{className:"w-6 h-6"}),color:"indigo",onClick:()=>e("/tasks")}),s.jsx(P0,{title:"Hon thnh",value:`${o?.completionRate||0}%`,subtitle:`${o?.completedTasks||0} cng vic`,icon:s.jsx(Un,{className:"w-6 h-6"}),color:"green"}),s.jsx(P0,{title:"Qu hn",value:o?.overdueTasks||0,subtitle:"Cn x l ngay",icon:s.jsx(Kr,{className:"w-6 h-6"}),color:"red",onClick:()=>e("/tasks?filter=overdue")}),s.jsx(P0,{title:"Ch duyt",value:o?.pendingApprovals||0,subtitle:"ang ch ph duyt",icon:s.jsx(Xr,{className:"w-6 h-6"}),color:"yellow",onClick:()=>e("/approvals")})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs(Ru,{className:"lg:col-span-2",children:[s.jsx(Iu,{title:"Xu hng Cng vic",icon:s.jsx(md,{className:"w-5 h-5"})}),s.jsx("div",{className:"h-72",children:s.jsx(Wu,{width:"100%",height:"100%",children:s.jsxs(HD,{data:d,children:[s.jsx(Sf,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(Cf,{dataKey:"label",tick:{fontSize:12},stroke:"#9CA3AF"}),s.jsx(Af,{tick:{fontSize:12},stroke:"#9CA3AF"}),s.jsx(Xu,{contentStyle:{backgroundColor:"#fff",border:"1px solid #E5E7EB",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),s.jsx(lm,{}),s.jsx(um,{type:"monotone",dataKey:"created",name:"To mi",stroke:"#6366F1",strokeWidth:2,dot:{fill:"#6366F1",strokeWidth:2},activeDot:{r:6}}),s.jsx(um,{type:"monotone",dataKey:"completed",name:"Hon thnh",stroke:"#10B981",strokeWidth:2,dot:{fill:"#10B981",strokeWidth:2},activeDot:{r:6}})]})})})]}),s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Phn b Trng thi",icon:s.jsx(Vb,{className:"w-5 h-5"})}),s.jsx("div",{className:"h-72",children:s.jsx(Wu,{width:"100%",height:"100%",children:s.jsxs(s6,{children:[s.jsx(B1,{data:u,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:5,dataKey:"count",children:u.map((U,H)=>s.jsx(Jf,{fill:U.color},`cell-${H}`))}),s.jsx(Xu,{formatter:(U,H,z)=>[`${U} cng vic`,z.payload.label],contentStyle:{backgroundColor:"#fff",border:"1px solid #E5E7EB",borderRadius:"12px"}})]})})}),s.jsx("div",{className:"flex flex-wrap gap-3 justify-center mt-2",children:u.map(U=>s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:U.color}}),s.jsx("span",{className:"text-xs text-gray-600",children:U.label})]},U.status))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Hiu sut Phng ban",icon:s.jsx($r,{className:"w-5 h-5"}),action:s.jsxs("button",{onClick:()=>e("/tasks?tab=overview"),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:["Xem chi tit ",s.jsx(Ks,{className:"w-4 h-4"})]})}),s.jsx("div",{className:"h-64",children:s.jsx(Wu,{width:"100%",height:"100%",children:s.jsxs(yb,{data:p,layout:"vertical",children:[s.jsx(Sf,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(Cf,{type:"number",domain:[0,100],tick:{fontSize:12},stroke:"#9CA3AF"}),s.jsx(Af,{type:"category",dataKey:"department_name",width:100,tick:{fontSize:11},stroke:"#9CA3AF"}),s.jsx(Xu,{formatter:U=>[`${U}%`,"T l hon thnh"],contentStyle:{backgroundColor:"#fff",border:"1px solid #E5E7EB",borderRadius:"12px"}}),s.jsx(zc,{dataKey:"completion_rate",fill:"#6366F1",radius:[0,4,4,0],barSize:20})]})})})]}),s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Nhn vin Xut sc",icon:s.jsx(Mm,{className:"w-5 h-5"})}),s.jsx("div",{className:"space-y-3",children:y.length===0?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c d liu nh gi"}):y.map((U,H)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[s.jsx("div",{className:`
                        w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                        ${H===0?"bg-yellow-100 text-yellow-700":""}
                        ${H===1?"bg-gray-100 text-gray-700":""}
                        ${H===2?"bg-orange-100 text-orange-700":""}
                        ${H>2?"bg-blue-50 text-blue-600":""}
                      `,children:H+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",children:U.employee_name}),s.jsx("p",{className:"text-xs text-gray-500",children:U.department_name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-lg font-bold text-blue-600",children:U.avg_score}),s.jsxs("p",{className:"text-xs text-gray-500",children:[U.completed_tasks," CV"]})]})]},U.employee_id))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Cng vic Qu hn",icon:s.jsx(Kr,{className:"w-5 h-5 text-red-500"}),action:m.length>0&&s.jsxs("button",{onClick:()=>e("/tasks?filter=overdue"),className:"text-sm text-red-600 hover:text-red-700 flex items-center gap-1",children:["Xem tt c ",s.jsx(Ks,{className:"w-4 h-4"})]})}),m.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Un,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Khng c cng vic qu hn"})]}):s.jsx("div",{className:"space-y-2",children:m.map(U=>s.jsxs("div",{onClick:()=>e(`/tasks/${U.id}`),className:"flex items-center gap-3 p-3 rounded-xl bg-red-50 hover:bg-red-100 cursor-pointer transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:s.jsx(xm,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",children:U.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[U.code,"  ",U.assignee_name]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("span",{className:"text-sm font-semibold text-red-600",children:["-",U.days_overdue," ngy"]}),s.jsx("span",{className:`block text-xs px-2 py-0.5 rounded-full ${FE[U.priority]}`,children:BE[U.priority]})]})]},U.id))})]}),s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Sp n hn (7 ngy)",icon:s.jsx(dn,{className:"w-5 h-5 text-amber-500"}),action:v.length>0&&s.jsxs("button",{onClick:()=>e("/tasks"),className:"text-sm text-amber-600 hover:text-amber-700 flex items-center gap-1",children:["Xem tt c ",s.jsx(Ks,{className:"w-4 h-4"})]})}),v.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(dn,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Khng c cng vic sp n hn"})]}):s.jsx("div",{className:"space-y-2",children:v.map(U=>s.jsxs("div",{onClick:()=>e(`/tasks/${U.id}`),className:"flex items-center gap-3 p-3 rounded-xl bg-amber-50 hover:bg-amber-100 cursor-pointer transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:s.jsx(Xr,{className:"w-5 h-5 text-amber-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",children:U.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[U.code,"  ",U.assignee_name]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-sm font-semibold text-amber-600",children:U.days_until_due===0?"Hm nay":`${U.days_until_due} ngy`}),s.jsx("span",{className:`block text-xs px-2 py-0.5 rounded-full ${FE[U.priority]}`,children:BE[U.priority]})]})]},U.id))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs(Ru,{className:"lg:col-span-2",children:[s.jsx(Iu,{title:"Hot ng Gn y",icon:s.jsx(G2,{className:"w-5 h-5"})}),_.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(G2,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Cha c hot ng no"})]}):s.jsx("div",{className:"space-y-3",children:_.map(U=>s.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:s.jsx(G2,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm text-gray-900",children:[s.jsx("span",{className:"font-medium",children:U.actor_name})," ",s.jsx("span",{className:"text-gray-600",children:lme[U.action]||U.action}),U.task_name&&s.jsxs(s.Fragment,{children:[' "',s.jsx("span",{className:"font-medium text-blue-600",children:U.task_name}),'"']})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:I(U.created_at)})]})]},U.id))})]}),s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Hp ng Sp ht hn",icon:s.jsx(vr,{className:"w-5 h-5 text-purple-500"}),action:P.length>0&&s.jsxs("button",{onClick:()=>e("/contracts"),className:"text-sm text-purple-600 hover:text-purple-700 flex items-center gap-1",children:["Xem tt c ",s.jsx(Ks,{className:"w-4 h-4"})]})}),P.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Un,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Khng c H sp ht hn"})]}):s.jsx("div",{className:"space-y-2",children:P.map(U=>s.jsxs("div",{onClick:()=>e("/contracts"),className:"flex items-center gap-3 p-3 rounded-xl bg-purple-50 hover:bg-purple-100 cursor-pointer transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:s.jsx(Fb,{className:"w-5 h-5 text-purple-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",children:U.employee_name}),s.jsx("p",{className:"text-xs text-gray-500",children:U.contract_type})]}),s.jsx("div",{className:"text-right",children:s.jsxs("span",{className:"text-sm font-semibold text-purple-600",children:[U.days_until_expiry," ngy"]})})]},U.id))})]})]}),s.jsxs(Ru,{children:[s.jsx(Iu,{title:"Thao tc Nhanh",icon:s.jsx(If,{className:"w-5 h-5"})}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-3",children:[{label:"To cng vic",icon:s.jsx(uh,{className:"w-5 h-5"}),path:"/tasks/create",color:"bg-blue-100 text-blue-600 hover:bg-blue-200"},{label:"Cng vic ca ti",icon:s.jsx(Un,{className:"w-5 h-5"}),path:"/my-tasks",color:"bg-green-100 text-green-600 hover:bg-green-200"},{label:"Ph duyt",icon:s.jsx(Xr,{className:"w-5 h-5"}),path:"/approvals",color:"bg-amber-100 text-amber-600 hover:bg-amber-200"},{label:"Nhn vin",icon:s.jsx(_i,{className:"w-5 h-5"}),path:"/employees",color:"bg-purple-100 text-purple-600 hover:bg-purple-200"},{label:"Ngh php",icon:s.jsx(dn,{className:"w-5 h-5"}),path:"/leave-requests",color:"bg-indigo-100 text-indigo-600 hover:bg-indigo-200"},{label:"Thng k CV",icon:s.jsx(If,{className:"w-5 h-5"}),path:"/reports/tasks",color:"bg-pink-100 text-pink-600 hover:bg-pink-200"}].map(U=>s.jsxs("button",{onClick:()=>e(U.path),className:`flex flex-col items-center gap-2 p-4 rounded-xl transition-colors ${U.color}`,children:[U.icon,s.jsx("span",{className:"text-xs font-medium text-center",children:U.label})]},U.path))})]})]})]})}function cme(){const{group:e,isAdmin:r}=VO();return r?s.jsx(I_,{}):e==="executive"?s.jsx(I_,{}):e==="manager"?s.jsx(I_,{}):s.jsx(MX,{})}const zi={async getAll(e={}){const r=e.page||1,t=e.pageSize||10,{search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("departments").select("*",{count:"exact"});a&&a!=="all"&&(c=c.eq("status",a)),n&&(c=c.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("created_at",{ascending:!1}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("departments").select("*").eq("status","active").order("name");if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("departments").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("departments").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("departments").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("departments").delete().eq("id",e);if(r)throw r},async checkCodeExists(e,r){let t=se.from("departments").select("id",{count:"exact",head:!0}).eq("code",e);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async getEmployeeCount(e){const{count:r,error:t}=await se.from("employees").select("id",{count:"exact",head:!0}).eq("department_id",e).eq("status","active");if(t)throw t;return r||0}},Lg={async getAll(e){const{page:r,pageSize:t,search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("positions").select("*",{count:"exact"});a&&a!=="all"&&(c=c.eq("status",a)),n&&(c=c.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("level",{ascending:!0}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("positions").select("*").eq("status","active").order("level");if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("positions").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("positions").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("positions").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("positions").delete().eq("id",e);if(r)throw r},async checkCodeExists(e,r){let t=se.from("positions").select("id",{count:"exact",head:!0}).eq("code",e);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0}},uc={async getAll(e={}){const r=e.page||1,t=e.pageSize||10,{search:n,status:a,department_id:i,position_id:o}=e,c=(r-1)*t,u=c+t-1;let l=se.from("employees").select("*",{count:"exact"});a&&a!=="all"&&(l=l.eq("status",a)),i&&(l=l.eq("department_id",i)),o&&(l=l.eq("position_id",o)),n&&(l=l.or(`full_name.ilike.%${n}%,code.ilike.%${n}%,email.ilike.%${n}%`));const{data:d,error:f,count:p}=await l.order("created_at",{ascending:!1}).range(c,u);if(f)throw f;return{data:d||[],total:p||0,page:r,pageSize:t,totalPages:Math.ceil((p||0)/t)}},async getById(e){const{data:r,error:t}=await se.from("employees").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("employees").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("employees").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("employees").delete().eq("id",e);if(r)throw r},async checkCodeExists(e,r){let t=se.from("employees").select("id",{count:"exact",head:!0}).eq("code",e);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async generateCode(){const{data:e}=await se.from("employees").select("code").order("code",{ascending:!1}).limit(1).maybeSingle();return e?.code?`NV${(parseInt(e.code.replace("NV",""))+1).toString().padStart(3,"0")}`:"NV001"}},Dg={async getAll(e){const{page:r,pageSize:t,search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("contract_types").select("*",{count:"exact"});a&&a!=="all"&&(c=c.eq("status",a)),n&&(c=c.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("created_at",{ascending:!1}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("contract_types").select("*").eq("status","active").order("name");if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("contract_types").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("contract_types").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("contract_types").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("contract_types").delete().eq("id",e);if(r)throw r}},J0={async getAll(e){const{page:r,pageSize:t,search:n,status:a,employee_id:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("contracts").select(`
        *,
        employee:employees!contracts_employee_id_fkey(id, code, full_name),
        contract_type:contract_types!contracts_contract_type_id_fkey(id, code, name)
      `,{count:"exact"});a&&a!=="all"&&(u=u.eq("status",a)),i&&(u=u.eq("employee_id",i)),n&&(u=u.or(`contract_number.ilike.%${n}%`));const{data:l,error:d,count:f}=await u.order("created_at",{ascending:!1}).range(o,c);if(d)throw d;return{data:l||[],total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getByEmployeeId(e){const{data:r,error:t}=await se.from("contracts").select(`
        *,
        contract_type:contract_types!contracts_contract_type_id_fkey(id, code, name)
      `).eq("employee_id",e).order("start_date",{ascending:!1});if(t)throw t;return r||[]},async getActiveContract(e){const{data:r,error:t}=await se.from("contracts").select(`
        *,
        contract_type:contract_types!contracts_contract_type_id_fkey(id, code, name)
      `).eq("employee_id",e).eq("status","active").maybeSingle();if(t)throw t;return r},async getById(e){const{data:r,error:t}=await se.from("contracts").select(`
        *,
        employee:employees!contracts_employee_id_fkey(id, code, full_name),
        contract_type:contract_types!contracts_contract_type_id_fkey(*)
      `).eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("contracts").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("contracts").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("contracts").delete().eq("id",e);if(r)throw r},async generateContractNumber(){const e=new Date().getFullYear(),{data:r,error:t}=await se.from("contracts").select("contract_number").ilike("contract_number",`HD${e}%`).order("contract_number",{ascending:!1}).limit(1);if(!t&&r&&r.length>0&&r[0].contract_number){const n=r[0].contract_number,a=parseInt(n.slice(-4))+1;return`HD${e}${a.toString().padStart(4,"0")}`}return`HD${e}0001`},async getExpiringContracts(e=30){const r=new Date,t=new Date;t.setDate(r.getDate()+e);const{data:n,error:a}=await se.from("contracts").select(`
        *,
        employee:employees!contracts_employee_id_fkey(id, code, full_name),
        contract_type:contract_types!contracts_contract_type_id_fkey(id, code, name)
      `).eq("status","active").not("end_date","is",null).gte("end_date",r.toISOString().split("T")[0]).lte("end_date",t.toISOString().split("T")[0]).order("end_date",{ascending:!0});if(a)throw a;return n||[]}},Fg={async getAll(e){const{page:r=1,pageSize:t=10,search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("leave_types").select("*",{count:"exact"});a&&(c=c.eq("status",a)),n&&(c=c.or(`code.ilike.%${n}%,name.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("created_at",{ascending:!1}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("leave_types").select("*").eq("status","active").order("name",{ascending:!0});if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("leave_types").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("leave_types").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("leave_types").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("leave_types").delete().eq("id",e);if(r)throw r}},eg={async getAll(e){const{page:r=1,pageSize:t=10,status:n,employee_id:a,search:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("leave_requests").select(`
        *,
        employee:employees!leave_requests_employee_id_fkey(id, code, full_name),
        leave_type:leave_types!leave_requests_leave_type_id_fkey(id, name, color),
        approver:employees!leave_requests_approved_by_fkey(id, code, full_name)
      `,{count:"exact"});n&&(u=u.eq("status",n)),a&&(u=u.eq("employee_id",a)),i&&(u=u.ilike("request_number",`%${i}%`));const{data:l,error:d,count:f}=await u.order("created_at",{ascending:!1}).range(o,c);if(d)throw d;return{data:l||[],total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getById(e){const{data:r,error:t}=await se.from("leave_requests").select(`
        *,
        employee:employees!leave_requests_employee_id_fkey(id, code, full_name),
        leave_type:leave_types!leave_requests_leave_type_id_fkey(id, name, color),
        approver:employees!leave_requests_approved_by_fkey(id, code, full_name)
      `).eq("id",e).single();if(t)throw t;return r},async create(e){const r=await this.generateRequestNumber(),{data:t,error:n}=await se.from("leave_requests").insert({...e,request_number:r,status:"pending"}).select().single();if(n)throw n;return t},async update(e,r){const{data:t,error:n}=await se.from("leave_requests").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("leave_requests").delete().eq("id",e);if(r)throw r},async approve(e,r,t){const{data:n,error:a}=await se.from("leave_requests").update({status:"approved",approved_by:r,approved_at:new Date().toISOString(),approval_notes:t||null}).eq("id",e).select().single();if(a)throw a;return n},async reject(e,r,t){const{data:n,error:a}=await se.from("leave_requests").update({status:"rejected",approved_by:r,approved_at:new Date().toISOString(),approval_notes:t}).eq("id",e).select().single();if(a)throw a;return n},async cancel(e){const{data:r,error:t}=await se.from("leave_requests").update({status:"cancelled"}).eq("id",e).select().single();if(t)throw t;return r},async generateRequestNumber(){const e=new Date().getFullYear(),{data:r,error:t}=await se.from("leave_requests").select("request_number").ilike("request_number",`NP${e}%`).order("request_number",{ascending:!1}).limit(1);if(!t&&r&&r.length>0&&r[0].request_number){const n=r[0].request_number,a=parseInt(n.slice(-4))+1;return`NP${e}-${a.toString().padStart(4,"0")}`}return`NP${e}-0001`},async getPendingRequests(){const{data:e,error:r}=await se.from("leave_requests").select(`
        *,
        employee:employees!leave_requests_employee_id_fkey(id, code, full_name),
        leave_type:leave_types!leave_requests_leave_type_id_fkey(id, name, color)
      `).eq("status","pending").order("created_at",{ascending:!0});if(r)throw r;return e||[]}};function $E(e,r,t,n){const i=(t-e)*Math.PI/180,o=(n-r)*Math.PI/180,c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function R_(){const{data:e,error:r}=await se.from("attendance_settings").select("setting_value").eq("setting_key","gps_config").maybeSingle();return r||!e?null:e.setting_value}function qE(e,r,t){for(const a of t.locations){const i=$E(e,r,a.latitude,a.longitude);if(i<=a.radius_meters)return{valid:!0,distance:Math.round(i),location_name:a.name}}const n=t.locations.reduce((a,i)=>{const o=$E(e,r,i.latitude,i.longitude);return o<a.distance?{distance:o,name:i.name}:a},{distance:1/0,name:""});return{valid:!1,distance:Math.round(n.distance),location_name:n.name}}const L_=`
  *,
  employee:employees!attendance_employee_id_fkey(
    id, code, full_name,
    department_id,
    department:departments!employees_department_id_fkey(id, name)
  ),
  shift:shifts!attendance_shift_id_fkey(
    id, code, name, shift_category, start_time, end_time,
    crosses_midnight, standard_hours, break_minutes,
    late_threshold_minutes, early_leave_threshold_minutes
  )
`,D_={async getAll(e){const{page:r,pageSize:t,status:n,employee_id:a,department_id:i,from_date:o,to_date:c}=e,u=(r-1)*t,l=u+t-1;let d=se.from("attendance").select(L_,{count:"exact"});n&&n!=="all"&&(d=d.eq("status",n)),a&&(d=d.eq("employee_id",a)),o&&(d=d.gte("date",o)),c&&(d=d.lte("date",c));const{data:f,error:p,count:h}=await d.order("date",{ascending:!1}).order("check_in_time",{ascending:!1}).range(u,l);if(p)throw p;let y=f||[];return i&&(y=y.filter(g=>g.employee?.department_id===i)),{data:y,total:i?y.length:h||0,page:r,pageSize:t,totalPages:Math.ceil((i?y.length:h||0)/t)}},async getByEmployeeAndDate(e,r){const{data:t,error:n}=await se.from("attendance").select(L_).eq("employee_id",e).eq("date",r).maybeSingle();if(n)throw n;return t},async getTodayAttendance(e){const r=new Date().toISOString().split("T")[0],t=await this.getByEmployeeAndDate(e,r);if(t)return t;const n=new Date;n.setDate(n.getDate()-1);const a=n.toISOString().split("T")[0],i=await this.getByEmployeeAndDate(e,a);return i&&i.check_in_time&&!i.check_out_time?i:null},async getTodayShift(e){const r=new Date().toISOString().split("T")[0],t=new Date;t.setDate(t.getDate()-1);const n=t.toISOString().split("T")[0],a=await this.getByEmployeeAndDate(e,n);if(a&&a.check_in_time&&!a.check_out_time&&a.shift)return a.shift;const{data:i,error:o}=await se.from("shift_assignments").select(`
        shift_id,
        shift:shifts!shift_assignments_shift_id_fkey(
          id, code, name, shift_category, start_time, end_time,
          crosses_midnight, standard_hours, break_minutes,
          late_threshold_minutes, early_leave_threshold_minutes
        )
      `).eq("employee_id",e).eq("date",r).maybeSingle();return o?(console.error("Error loading today shift:",o),null):i?.shift||null},async checkIn(e,r){const t=new Date().toISOString().split("T")[0],n=new Date,a=n.toISOString();if(await this.getByEmployeeAndDate(e,t))throw new Error("Bn  check-in hm nay ri");const o=new Date;o.setDate(o.getDate()-1);const c=o.toISOString().split("T")[0],u=await this.getByEmployeeAndDate(e,c);if(u&&u.check_in_time&&!u.check_out_time)throw new Error("Bn cha check-out ca qua m hm qua. Vui lng check-out trc.");let l=!1,d=null,f=null;const p=await R_();if(p?.enabled){if(!r)throw new Error("Vui lng bt nh v GPS  check-in");d=r.latitude,f=r.longitude;const _=qE(r.latitude,r.longitude,p);if(!_.valid)throw new Error(`Bn khng  trong khu vc cng ty. Khong cch n ${_.location_name}: ${_.distance}m (cho php: ${p.locations[0]?.radius_meters||300}m)`);l=!0}else r&&(d=r.latitude,f=r.longitude);const{data:h}=await se.from("shift_assignments").select(`
        shift_id,
        shift:shifts!shift_assignments_shift_id_fkey(*)
      `).eq("employee_id",e).eq("date",t).maybeSingle();let y="present",g=0,m=null,x=0;if(h?.shift){const _=Array.isArray(h.shift)?h.shift[0]:h.shift;m=h.shift_id,x=_.break_minutes||60;const[A,P]=_.start_time.split(":").map(Number),B=new Date(t);B.setHours(A,P,0,0);const T=Math.floor((n.getTime()-B.getTime())/(1e3*60));T>(_.late_threshold_minutes||15)&&(y="late",g=T)}else{const _=n.getHours(),A=n.getMinutes();(_>8||_===8&&A>30)&&(y="late",g=(_-8)*60+(A-30))}const{data:v,error:w}=await se.from("attendance").insert({employee_id:e,date:t,check_in_time:a,status:y,shift_id:m,shift_date:t,late_minutes:Math.max(0,g),break_minutes:x,check_in_lat:d,check_in_lng:f,is_gps_verified:l}).select().single();if(w)throw w;return v},async checkOut(e,r){const t=new Date().toISOString().split("T")[0],n=new Date,a=n.toISOString();let i=await this.getByEmployeeAndDate(e,t);if(!i){const g=new Date;g.setDate(g.getDate()-1);const m=g.toISOString().split("T")[0],x=await this.getByEmployeeAndDate(e,m);x&&x.check_in_time&&!x.check_out_time&&(i=x)}if(!i)throw new Error("Bn cha check-in hm nay");if(i.check_out_time)throw new Error("Bn  check-out ri");let o=null,c=null;r&&(o=r.latitude,c=r.longitude);let u,l=0,d=0,f=i.status;const p=new Date(i.check_in_time);if(i.shift_id){const{data:g}=await se.from("shifts").select("*").eq("id",i.shift_id).maybeSingle();if(g){const m=g.break_minutes||60,x=Math.floor((n.getTime()-p.getTime())/(1e3*60));u=Math.max(0,x-m);const[v,w]=g.end_time.split(":").map(Number),_=i.date,A=new Date(_+"T00:00:00");A.setHours(v,w,0,0),g.crosses_midnight&&A.setDate(A.getDate()+1);const P=g.early_leave_threshold_minutes||15,B=Math.floor((A.getTime()-n.getTime())/(1e3*60));if(B>P&&(f="early_leave",d=B),n>A){const{data:T}=await se.from("overtime_requests").select("id, planned_minutes").eq("employee_id",e).eq("overtime_date",i.date).eq("status","approved").maybeSingle();T&&(l=Math.floor((n.getTime()-A.getTime())/(1e3*60)),await se.from("overtime_requests").update({actual_start_time:g.end_time,actual_end_time:n.toTimeString().slice(0,8),actual_minutes:l}).eq("id",T.id))}}else u=Math.floor((n.getTime()-p.getTime())/(1e3*60))}else{u=Math.floor((n.getTime()-p.getTime())/(1e3*60));const g=new Date(t+"T17:30:00");if(n>g&&(l=Math.floor((n.getTime()-g.getTime())/(1e3*60))),n.getHours()<17){f="early_leave";const m=new Date(t+"T17:00:00");d=Math.floor((m.getTime()-n.getTime())/(1e3*60))}}const{data:h,error:y}=await se.from("attendance").update({check_out_time:a,working_minutes:u,overtime_minutes:l,early_leave_minutes:d,status:f,check_out_lat:o,check_out_lng:c}).eq("id",i.id).select().single();if(y)throw y;return h},async getMonthlyReport(e,r,t){const n=`${e}-${r.toString().padStart(2,"0")}-01`,a=new Date(e,r,0).toISOString().split("T")[0],{data:i,error:o}=await se.from("attendance").select(L_).gte("date",n).lte("date",a).order("employee_id").order("date");if(o)throw o;return t&&i?i.filter(c=>c.employee?.department_id===t):i||[]},async update(e,r){const{data:t,error:n}=await se.from("attendance").update(r).eq("id",e).select().single();if(n)throw n;return t},async getGPSConfig(){return R_()},async validateGPSPosition(e,r){const t=await R_();return t?.enabled?qE(e,r,t):null}},Xc={async getAll(e){const{page:r,pageSize:t,search:n,category:a,is_active:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("shifts").select("*",{count:"exact"});a&&a!=="all"&&(u=u.eq("shift_category",a)),i!==void 0&&(u=u.eq("is_active",i)),n&&(u=u.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:l,error:d,count:f}=await u.order("shift_category").order("start_time").range(o,c);if(d)throw d;return{data:l||[],total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("shifts").select("*").eq("is_active",!0).order("shift_category").order("start_time");if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("shifts").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("shifts").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("shifts").update(r).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("shifts").delete().eq("id",e);if(r)throw r},async checkCodeExists(e,r){let t=se.from("shifts").select("id",{count:"exact",head:!0}).eq("code",e);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async getShiftsForDepartment(e){const{data:r,error:t}=await se.from("department_shift_config").select(`
        *,
        shift:shifts!department_shift_config_shift_id_fkey(*)
      `).eq("department_id",e).order("is_default",{ascending:!1});if(t)throw t;return r||[]},async getDefaultShift(e){const{data:r,error:t}=await se.from("department_shift_config").select(`
        shift:shifts!department_shift_config_shift_id_fkey(*)
      `).eq("department_id",e).eq("is_default",!0).maybeSingle();if(t)throw t;return r?.shift&&(Array.isArray(r.shift)?r.shift[0]:r.shift)||null},async getAllDepartmentConfigs(){const{data:e,error:r}=await se.from("department_shift_config").select(`
        *,
        department:departments!department_shift_config_department_id_fkey(id, code, name),
        shift:shifts!department_shift_config_shift_id_fkey(*)
      `).order("department_id");if(r)throw r;return e||[]},async updateDepartmentConfig(e,r){const{error:t}=await se.from("department_shift_config").delete().eq("department_id",e);if(t)throw t;if(r.length>0){const n=r.map(i=>({department_id:e,shift_id:i.shift_id,is_default:i.is_default})),{error:a}=await se.from("department_shift_config").insert(n);if(a)throw a}},async departmentHasShifts(e){const{count:r,error:t}=await se.from("department_shift_config").select("id",{count:"exact",head:!0}).eq("department_id",e);if(t)throw t;return(r||0)>0}},n4=["HAP-KT","HAP-RD"],xb={async getByEmployeeAndDate(e,r){const{data:t,error:n}=await se.from("shift_assignments").select(`
        *,
        shift:shifts!shift_assignments_shift_id_fkey(
          id, code, name, shift_category, start_time, end_time, 
          crosses_midnight, standard_hours, break_minutes,
          late_threshold_minutes, early_leave_threshold_minutes
        )
      `).eq("employee_id",e).eq("date",r).maybeSingle();if(n)throw n;return t},async getCalendarView(e){const{department_id:r,date_from:t,date_to:n}=e;let a=se.from("employees").select(`
        id, code, full_name, department_id,
        department:departments!employees_department_id_fkey(id, code, name)
      `).eq("status","active").order("full_name");r&&(a=a.eq("department_id",r));const{data:i,error:o}=await a;if(o)throw o;if(!i||i.length===0)return[];const c=i.map(f=>f.id),{data:u,error:l}=await se.from("shift_assignments").select(`
        *,
        shift:shifts!shift_assignments_shift_id_fkey(
          id, code, name, shift_category, start_time, end_time
        )
      `).in("employee_id",c).gte("date",t).lte("date",n).order("date");if(l)throw l;const d=new Map;return(u||[]).forEach(f=>{const p=f.employee_id;d.has(p)||d.set(p,[]),d.get(p).push(f)}),i.map(f=>{const p=Array.isArray(f.department)?f.department[0]:f.department,h=d.get(f.id)||[],y={};return h.forEach(g=>{const m=Array.isArray(g.shift)?g.shift[0]:g.shift;y[g.date]={id:g.id,shift_id:g.shift_id,shift_code:m?.code||"",shift_name:m?.name||"",shift_category:m?.shift_category||"",start_time:m?.start_time||"",end_time:m?.end_time||"",assignment_type:g.assignment_type,is_override:g.assignment_type==="override"||g.assignment_type==="swap"}}),{employee_id:f.id,employee_code:f.code,employee_name:f.full_name,department_code:p?.code||"",department_name:p?.name||"",assignments:y}})},async getByEmployeeRange(e,r,t){const{data:n,error:a}=await se.from("shift_assignments").select(`
        *,
        shift:shifts!shift_assignments_shift_id_fkey(
          id, code, name, shift_category, start_time, end_time, crosses_midnight
        ),
        original_shift:shifts!shift_assignments_original_shift_id_fkey(
          id, code, name
        )
      `).eq("employee_id",e).gte("date",r).lte("date",t).order("date");if(a)throw a;return n||[]},async batchSchedule(e){const{employee_ids:r,date_from:t,date_to:n,pattern:a,overwrite_existing:i,created_by:o,notes:c}=e;if(a.length===0)throw new Error("Pattern khng c rng");const{data:u,error:l}=await se.from("employees").select(`
        id,
        department:departments!employees_department_id_fkey(code)
      `).in("id",r);if(l)throw l;const d=new Map;(u||[]).forEach(v=>{const w=Array.isArray(v.department)?v.department[0]:v.department;d.set(v.id,w?.code||"")});const f=crypto.randomUUID(),p=[],h=new Date(t),y=new Date(n);let g=new Date(h);for(;g<=y;){const v=g.toISOString().split("T")[0],w=Math.floor((g.getTime()-h.getTime())/(1e3*60*60*24)),_=Math.floor(w/7)%a.length,A=a[_].shift_id,P=g.getDay();for(const B of r){const T=d.get(B)||"";P===0&&n4.includes(T)||p.push({employee_id:B,shift_id:A,date:v,assignment_type:"scheduled",schedule_batch_id:f,created_by:o,notes:c||null})}g.setDate(g.getDate()+1)}if(p.length===0)return{created:0,skipped:0,overwritten:0};let m=0,x=0;if(i){const{data:v}=await se.from("shift_assignments").select("id").in("employee_id",r).gte("date",t).lte("date",n);if(x=v?.length||0,x>0){const w=(v||[]).map(_=>_.id);for(let _=0;_<w.length;_+=100){const A=w.slice(_,_+100);await se.from("shift_assignments").delete().in("id",A)}}for(let w=0;w<p.length;w+=500){const _=p.slice(w,w+500),{error:A}=await se.from("shift_assignments").insert(_);if(A)throw A}return{created:p.length,skipped:0,overwritten:x}}else{const v=[...new Set(p.map(P=>P.date))],{data:w}=await se.from("shift_assignments").select("employee_id, date").in("employee_id",r).in("date",v),_=new Set((w||[]).map(P=>`${P.employee_id}|${P.date}`)),A=p.filter(P=>!_.has(`${P.employee_id}|${P.date}`));if(m=p.length-A.length,A.length>0)for(let P=0;P<A.length;P+=500){const B=A.slice(P,P+500),{error:T}=await se.from("shift_assignments").insert(B);if(T)throw T}return{created:A.length,skipped:m,overwritten:0}}},async overrideShift(e){const{employee_id:r,date:t,new_shift_id:n,created_by:a,notes:i}=e,o=await this.getByEmployeeAndDate(r,t);if(o){const{data:c,error:u}=await se.from("shift_assignments").update({shift_id:n,assignment_type:"override",original_shift_id:o.shift_id,notes:i||`i ca t ${o.shift?.name||"N/A"}`,created_by:a,updated_at:new Date().toISOString()}).eq("id",o.id).select(`
          *,
          shift:shifts!shift_assignments_shift_id_fkey(id, code, name)
        `).single();if(u)throw u;return c}else{const{data:c,error:u}=await se.from("shift_assignments").insert({employee_id:r,shift_id:n,date:t,assignment_type:"override",notes:i,created_by:a}).select(`
          *,
          shift:shifts!shift_assignments_shift_id_fkey(id, code, name)
        `).single();if(u)throw u;return c}},async delete(e){const{error:r}=await se.from("shift_assignments").delete().eq("id",e);if(r)throw r},async deleteBatch(e){const{data:r,error:t}=await se.from("shift_assignments").delete().eq("schedule_batch_id",e).select("id");if(t)throw t;return r?.length||0},async deleteRange(e,r,t){const{data:n,error:a}=await se.from("shift_assignments").delete().eq("employee_id",e).gte("date",r).lte("date",t).select("id");if(a)throw a;return n?.length||0},async getMonthStats(e,r,t){const n=`${e}-${String(r).padStart(2,"0")}-01`,a=new Date(e,r,0).toISOString().split("T")[0];let i=se.from("shift_assignments").select(`
        id, employee_id, shift_id, date,
        shift:shifts!shift_assignments_shift_id_fkey(name),
        employee:employees!shift_assignments_employee_id_fkey(department_id)
      `).gte("date",n).lte("date",a);const{data:o,error:c}=await i;if(c)throw c;let u=o||[];t&&(u=u.filter(f=>(Array.isArray(f.employee)?f.employee[0]:f.employee)?.department_id===t));const l=new Set(u.map(f=>f.employee_id)),d=new Map;return u.forEach(f=>{const h=(Array.isArray(f.shift)?f.shift[0]:f.shift)?.name||"N/A";d.set(h,(d.get(h)||0)+1)}),{total_assignments:u.length,total_employees:l.size,by_shift:Array.from(d.entries()).map(([f,p])=>({shift_name:f,count:p})).sort((f,p)=>p.count-f.count),unassigned_days:0}}},vb={async getAll(e){const{page:r=1,pageSize:t=10,search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("salary_grades").select("*",{count:"exact"});a&&(c=c.eq("status",a)),n&&(c=c.or(`code.ilike.%${n}%,name.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("level",{ascending:!0}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("salary_grades").select("*").eq("status","active").order("level",{ascending:!0});if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("salary_grades").select("*").eq("id",e).single();if(t)throw t;return r},async create(e){const{data:r,error:t}=await se.from("salary_grades").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("salary_grades").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("salary_grades").delete().eq("id",e);if(r)throw r}};async function F_(e){const{data:r,error:t}=await se.from("payroll_periods").select(`
      *,
      creator:employees!payroll_periods_created_by_fkey(id, full_name),
      confirmer:employees!payroll_periods_confirmed_by_fkey(id, full_name)
    `).eq("id",e).single();if(t)throw t;return r}const Ef={async getPeriods(e){const{page:r=1,pageSize:t=10,year:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("payroll_periods").select(`
        *,
        creator:employees!payroll_periods_created_by_fkey(id, full_name),
        confirmer:employees!payroll_periods_confirmed_by_fkey(id, full_name)
      `,{count:"exact"});n&&(c=c.eq("year",n)),a&&(c=c.eq("status",a));const{data:u,error:l,count:d}=await c.order("year",{ascending:!1}).order("month",{ascending:!1}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},getPeriodById:F_,async createPeriod(e,r){const{data:t,error:n}=await se.from("payroll_periods").insert({...e,created_by:r}).select().single();if(n)throw n;return t},async updatePeriod(e,r){const{data:t,error:n}=await se.from("payroll_periods").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async confirmPeriod(e,r){const{data:t,error:n}=await se.from("payroll_periods").update({status:"confirmed",confirmed_by:r,confirmed_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async getPayslips(e){const{page:r=1,pageSize:t=10,period_id:n,employee_id:a,search:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("payslips").select(`
        *,
        employee:employees!payslips_employee_id_fkey(id, code, full_name),
        payroll_period:payroll_periods!payslips_payroll_period_id_fkey(id, code, name, year, month)
      `,{count:"exact"});n&&(u=u.eq("payroll_period_id",n)),a&&(u=u.eq("employee_id",a)),i&&(u=u.or(`payslip_number.ilike.%${i}%,employee_name.ilike.%${i}%`));const{data:l,error:d,count:f}=await u.order("created_at",{ascending:!1}).range(o,c);if(d)throw d;return{data:l||[],total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getPayslipById(e){const{data:r,error:t}=await se.from("payslips").select(`
        *,
        employee:employees!payslips_employee_id_fkey(id, code, full_name),
        payroll_period:payroll_periods!payslips_payroll_period_id_fkey(*),
        items:payslip_items(*)
      `).eq("id",e).single();if(t)throw t;return r},async generatePayslips(e){const r=await F_(e),{data:t,error:n}=await se.from("employees").select(`
        id, 
        code, 
        full_name,
        department_id,
        position_id,
        salary_grade_id,
        departments!employees_department_id_fkey(id, name),
        positions!employees_position_id_fkey(id, name),
        salary_grades!employees_salary_grade_id_fkey(id, name, base_salary)
      `).eq("status","active");if(n)throw n;const a=t||[];let i=0;for(const u of a){const l=`PL${r.year}-${String(r.month).padStart(2,"0")}-${String(i+1).padStart(3,"0")}`,d=u.salary_grades?.base_salary||0,f=Math.round(d*.08),p=Math.round(d*.015),h=Math.round(d*.01),y=f+p+h,{error:g}=await se.from("payslips").insert({payslip_number:l,payroll_period_id:e,employee_id:u.id,employee_code:u.code,employee_name:u.full_name,department_name:u.departments?.name||null,position_name:u.positions?.name||null,salary_grade_name:u.salary_grades?.name||null,working_days:22,actual_days:22,leave_days:0,unpaid_leave_days:0,overtime_hours:0,base_salary:d,allowances:0,overtime_pay:0,bonus:0,other_income:0,gross_salary:d,social_insurance:f,health_insurance:p,unemployment_insurance:h,personal_income_tax:0,other_deductions:0,total_deductions:y,net_salary:d-y,status:"draft"});g||i++}const{data:o}=await se.from("payslips").select("net_salary").eq("payroll_period_id",e),c=o?.reduce((u,l)=>u+(l.net_salary||0),0)||0;return await se.from("payroll_periods").update({total_employees:i,total_amount:c,status:"processing"}).eq("id",e),i},async generatePayslipNumber(e){const r=await F_(e),{data:t,error:n}=await se.from("payslips").select("payslip_number").eq("payroll_period_id",e).order("payslip_number",{ascending:!1}).limit(1);if(!n&&t&&t.length>0){const a=parseInt(t[0].payslip_number.slice(-3))+1;return`PL${r.year}-${String(r.month).padStart(2,"0")}-${String(a).padStart(3,"0")}`}return`PL${r.year}-${String(r.month).padStart(2,"0")}-001`},async deletePayslipsByPeriod(e){const{error:r}=await se.from("payslips").delete().eq("payroll_period_id",e);if(r)throw r;await se.from("payroll_periods").update({total_employees:0,total_amount:0,status:"draft"}).eq("id",e)}},Sm={async getCriteria(e){const{page:r=1,pageSize:t=10,search:n,status:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("performance_criteria").select("*",{count:"exact"});a&&(c=c.eq("status",a)),n&&(c=c.or(`code.ilike.%${n}%,name.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("sort_order",{ascending:!0}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getActiveCriteria(){const{data:e,error:r}=await se.from("performance_criteria").select("*").eq("status","active").order("sort_order",{ascending:!0});if(r)throw r;return e||[]},async createCriteria(e){const{data:r,error:t}=await se.from("performance_criteria").insert(e).select().single();if(t)throw t;return r},async updateCriteria(e,r){const{data:t,error:n}=await se.from("performance_criteria").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async deleteCriteria(e){const{error:r}=await se.from("performance_criteria").delete().eq("id",e);if(r)throw r},async getReviews(e){const{page:r=1,pageSize:t=10,employee_id:n,reviewer_id:a,period:i,status:o}=e,c=(r-1)*t,u=c+t-1;let l=se.from("performance_reviews").select(`
        *,
        employee:employees!performance_reviews_employee_id_fkey(id, code, full_name),
        reviewer:employees!performance_reviews_reviewer_id_fkey(id, full_name)
      `,{count:"exact"});n&&(l=l.eq("employee_id",n)),a&&(l=l.eq("reviewer_id",a)),i&&(l=l.eq("review_period",i)),o&&(l=l.eq("status",o));const{data:d,error:f,count:p}=await l.order("created_at",{ascending:!1}).range(c,u);if(f)throw f;return{data:d||[],total:p||0,page:r,pageSize:t,totalPages:Math.ceil((p||0)/t)}},async getReviewById(e){const{data:r,error:t}=await se.from("performance_reviews").select(`
        *,
        employee:employees!performance_reviews_employee_id_fkey(id, code, full_name),
        reviewer:employees!performance_reviews_reviewer_id_fkey(id, full_name),
        scores:review_scores(
          *,
          criteria:performance_criteria(*)
        )
      `).eq("id",e).single();if(t)throw t;return r},async createReview(e){const r=new Date().getFullYear(),{data:t}=await se.from("performance_reviews").select("review_code").ilike("review_code",`DG${r}%`).order("review_code",{ascending:!1}).limit(1);let n=`DG${r}-0001`;if(t&&t.length>0){const o=parseInt(t[0].review_code.slice(-4))+1;n=`DG${r}-${String(o).padStart(4,"0")}`}const{data:a,error:i}=await se.from("performance_reviews").insert({...e,review_code:n}).select().single();if(i)throw i;return a},async updateReview(e,r){const{data:t,error:n}=await se.from("performance_reviews").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async submitReview(e){const{data:r,error:t}=await se.from("performance_reviews").update({status:"submitted",submitted_at:new Date().toISOString()}).eq("id",e).select().single();if(t)throw t;return r},async saveScores(e,r){await se.from("review_scores").delete().eq("review_id",e);const t=await this.getActiveCriteria(),n=new Map(t.map(u=>[u.id,u])),a=r.map(u=>{const l=n.get(u.criteria_id),d=l?u.score/l.max_score*l.weight:0;return{review_id:e,criteria_id:u.criteria_id,score:u.score,weighted_score:d,comments:u.comments}}),{error:i}=await se.from("review_scores").insert(a);if(i)throw i;const o=a.reduce((u,l)=>u+(l.weighted_score||0),0);let c="E";o>=90?c="A":o>=80?c="B":o>=70?c="C":o>=60&&(c="D"),await se.from("performance_reviews").update({total_score:o,grade:c}).eq("id",e)},async completeReview(e,r,t){const{data:n,error:a}=await se.from("performance_reviews").update({status:"reviewed",reviewer_id:r,reviewer_comments:t,reviewed_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return n}},Bu="https://huyanh-erp.vercel.app",zE={excellent:"Xut sc",good:"Tt",average:"Trung bnh",below_average:"Cn ci thin"},ume={critical:"Khn cp",high:"Cao",medium:"Trung bnh",low:"Thp"},dme={task_assigned:{subject:e=>`[Huy Anh ERP] Cng vic mi: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #1e40af;">Bn c giao cng vic mi</h2>
        <div style="background-color: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngi giao:</strong> ${e.assigner_name}</p>
          <p><strong>Phng ban:</strong> ${e.department_name||"Cha xc nh"}</p>
          <p><strong> u tin:</strong> ${ume[e.priority]||"Bnh thng"}</p>
          ${e.due_date?`<p><strong>Hn hon thnh:</strong> ${new Date(e.due_date).toLocaleDateString("vi-VN")}</p>`:""}
        </div>
        ${e.description?`<p><strong>M t:</strong></p><p style="background-color: #fafafa; padding: 15px; border-left: 4px solid #3b82f6;">${e.description}</p>`:""}
        <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 20px 0;">
        <p>Vui lng ng nhp h thng  xem chi tit v bt u cng vic.</p>
        <a href="${Bu}/tasks/${e.task_id}" style="display: inline-block; background-color: #3B82F6; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Xem cng vic
        </a>
      </div>
    `},task_completed_reminder:{subject:e=>`[Huy Anh ERP] Hon thnh t nh gi: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #059669;">Cng vic  hon thnh - Vui lng t nh gi</h2>
        <div style="background-color: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngy hon thnh:</strong> ${e.completed_date?new Date(e.completed_date).toLocaleDateString("vi-VN"):"Hm nay"}</p>
        </div>
        <p>Cng vic ca bn  c nh du hon thnh. Vui lng hon thnh <strong>t nh gi</strong>  qun l c th ph duyt kt qu.</p>
        <a href="${Bu}/my-tasks" style="display: inline-block; background-color: #10B981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          T nh gi ngay
        </a>
      </div>
    `},self_evaluation_submitted:{subject:e=>`[Huy Anh ERP] T nh gi mi cn ph duyt: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #7c3aed;">C t nh gi mi cn ph duyt</h2>
        <div style="background-color: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">
          <p><strong>Nhn vin:</strong> ${e.employee_name}</p>
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>im t chm:</strong> <span style="font-size: 18px; font-weight: bold; color: #059669;">${e.self_score||"N/A"}</span></p>
          <p><strong>Mc  hon thnh:</strong> ${e.completion_percentage||0}%</p>
          ${e.quality_assessment?`<p><strong>nh gi cht lng:</strong> ${zE[e.quality_assessment]||e.quality_assessment}</p>`:""}
        </div>
        ${e.achievements?`
          <p><strong>Thnh tu t c:</strong></p>
          <p style="background-color: #ecfdf5; padding: 15px; border-left: 4px solid #10b981;">${e.achievements}</p>
        `:""}
        <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 20px 0;">
        <p>Vui lng ng nhp h thng  xem xt v ph duyt.</p>
        <a href="${Bu}/approvals" style="display: inline-block; background-color: #7C3AED; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Ph duyt ngay
        </a>
      </div>
    `},task_approved:{subject:e=>`[Huy Anh ERP]  Cng vic  c ph duyt: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #059669;"> Cng vic ca bn  c ph duyt!</h2>
        <div style="background-color: #ecfdf5; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #10b981;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngi ph duyt:</strong> ${e.approver_name}</p>
          <p><strong>im nh gi:</strong> <span style="font-size: 24px; font-weight: bold; color: #059669;">${e.score}</span>/100</p>
          <p><strong>Xp loi:</strong> ${zE[e.rating]||e.rating}</p>
        </div>
        ${e.comments?`
          <p><strong>Nhn xt t qun l:</strong></p>
          <p style="background-color: #f0fdf4; padding: 15px; border-left: 4px solid #22c55e; font-style: italic;">"${e.comments}"</p>
        `:""}
        <p style="color: #6b7280;">Cm n bn  hon thnh tt cng vic!</p>
        <a href="${Bu}/my-tasks" style="display: inline-block; background-color: #10B981; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Xem chi tit
        </a>
      </div>
    `},task_rejected:{subject:e=>`[Huy Anh ERP]  Cng vic cn xem xt li: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #dc2626;">Cng vic cha c ph duyt</h2>
        <div style="background-color: #fef2f2; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #fca5a5;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngi t chi:</strong> ${e.approver_name}</p>
        </div>
        <p><strong>L do t chi:</strong></p>
        <p style="background-color: #fef2f2; padding: 15px; border-left: 4px solid #ef4444; color: #991b1b;">${e.rejection_reason}</p>
        ${e.comments?`
          <p><strong>Nhn xt thm:</strong></p>
          <p style="background-color: #fffbeb; padding: 15px; border-left: 4px solid #f59e0b;">"${e.comments}"</p>
        `:""}
        <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 20px 0;">
        <p>Vui lng xem xt li v cp nht cng vic theo yu cu.</p>
        <a href="${Bu}/my-tasks" style="display: inline-block; background-color: #EF4444; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Xem v chnh sa
        </a>
      </div>
    `},revision_requested:{subject:e=>`[Huy Anh ERP]  Yu cu b sung: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #d97706;">Yu cu b sung thng tin</h2>
        <div style="background-color: #fffbeb; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #fcd34d;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngi yu cu:</strong> ${e.approver_name}</p>
        </div>
        <p><strong>Ni dung cn b sung:</strong></p>
        <p style="background-color: #fef3c7; padding: 15px; border-left: 4px solid #f59e0b;">${e.additional_request}</p>
        ${e.additional_deadline?`
          <p><strong> Hn b sung:</strong> ${new Date(e.additional_deadline).toLocaleDateString("vi-VN")}</p>
        `:""}
        ${e.comments?`
          <p><strong>Ghi ch thm:</strong></p>
          <p style="font-style: italic; color: #6b7280;">"${e.comments}"</p>
        `:""}
        <hr style="border: none; border-top: 1px solid #e5e7eb; margin: 20px 0;">
        <p>Vui lng cp nht t nh gi theo yu cu v gi li.</p>
        <a href="${Bu}/my-tasks" style="display: inline-block; background-color: #F59E0B; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Cp nht ngay
        </a>
      </div>
    `},evaluation_received:{subject:e=>`[Huy Anh ERP] Bn c nh gi mi: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #3b82f6;">Bn nhn c nh gi mi</h2>
        <div style="background-color: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">
          <p><strong>Cng vic:</strong> ${e.task_name}</p>
          <p><strong>Ngi nh gi:</strong> ${e.evaluator_name}</p>
          <p><strong>im:</strong> <span style="font-size: 20px; font-weight: bold;">${e.score}</span>/100</p>
        </div>
        <a href="${Bu}/my-tasks" style="display: inline-block; background-color: #3B82F6; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Xem chi tit
        </a>
      </div>
    `},deadline_reminder:{subject:e=>`[Huy Anh ERP]  Sp n hn: ${e.task_name}`,content:e=>`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #dc2626;"> Cng vic sp n hn!</h2>
        <div style="background-color: #fef2f2; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #fca5a5;">
          <p><strong>M cng vic:</strong> ${e.task_code}</p>
          <p><strong>Tn cng vic:</strong> ${e.task_name}</p>
          <p><strong>Hn hon thnh:</strong> <span style="color: #dc2626; font-weight: bold;">${new Date(e.due_date).toLocaleDateString("vi-VN")}</span></p>
          <p><strong>Cn li:</strong> <span style="font-size: 18px; font-weight: bold; color: #dc2626;">${e.days_remaining} ngy</span></p>
          <p><strong>Tin  hin ti:</strong> ${e.progress||0}%</p>
        </div>
        <p>Vui lng hon thnh cng vic trc thi hn.</p>
        <a href="${Bu}/tasks/${e.task_id}" style="display: inline-block; background-color: #DC2626; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: 500;">
          Xem cng vic
        </a>
      </div>
    `}};async function hme(e){console.log(" [emailService] getRecipientInfo for:",e);const{data:r,error:t}=await se.from("employees").select("id, full_name, email, department_id").eq("id",e).single();if(t)return console.error(" [emailService] Query error:",t.message),null;if(!r)return console.error(" [emailService] No data returned for:",e),null;let n=null;if(r.department_id){const{data:a}=await se.from("departments").select("id, name").eq("id",r.department_id).single();n=a}return console.log(" [emailService] Found recipient:",r.full_name,r.email),{...r,department:n}}async function fme(e){const{data:r,error:t}=await se.from("tasks").select("id, code, name, description, status, priority, progress, due_date, department_id").eq("id",e).single();if(t||!r)return console.error(" [emailService] Could not find task:",e),null;let n=null;if(r.department_id){const{data:a}=await se.from("departments").select("id, name").eq("id",r.department_id).single();n=a}return{...r,department:n}}async function pme(e){console.log(" [emailService] sendNotificationEmail:",e.notification_type);try{const r=await hme(e.recipient_id);if(!r||!r.email)throw new Error("Recipient not found or has no email");let t=null;e.task_id&&(t=await fme(e.task_id));const n={recipient_name:r.full_name,department_name:r.department?.name,task_id:t?.id,task_code:t?.code,task_name:t?.name,task_description:t?.description,app_url:Bu,...e.additional_data},a=dme[e.notification_type];if(!a)throw new Error(`Unknown notification type: ${e.notification_type}`);const i=a.subject(n),o=a.content(n);console.log(" [emailService] ====== EMAIL DEBUG ======"),console.log(" [emailService] To:",r.email),console.log(" [emailService] Subject:",i),console.log(" [emailService] Body length:",o?.length),console.log(" [emailService] Body preview:",o?.substring(0,200));const c={to:r.email,subject:i,body:o};console.log(" [emailService] Full payload:",JSON.stringify(c,null,2));const{data:u,error:l}=await se.functions.invoke("send-email",{body:c});if(console.log(" [emailService] Response data:",u),console.log(" [emailService] Response error:",l),l)throw console.error(" [emailService] Edge Function error:",l),l;return console.log(" [emailService] Email sent successfully to:",r.email),{success:!0,error:null}}catch(r){return console.error(" [emailService] Error sending notification email:",r),{success:!1,error:r}}}async function B_(e,r,t,n){console.log(" [emailService] notifyTaskAssigned");try{const{data:a}=await se.from("employees").select("full_name").eq("id",t).single();await pme({recipient_id:r,notification_type:"task_assigned",task_id:e,additional_data:{assigner_name:a?.full_name||"Khng xc nh",description:n?.description,priority:n?.priority,due_date:n?.due_date}})}catch(a){console.error(" [emailService] Error notifying task assigned:",a)}}const eh=e=>({...e,title:e.name||e.title||"",assigner_level:null});async function $_(e){const r=new Set;for(const i of e){const o=i.assigner?.position_id;o&&r.add(o)}if(r.size===0)return console.log(" [enrichTasksWithAssignerLevel] No position_ids found"),e;console.log(" [enrichTasksWithAssignerLevel] Fetching levels for positions:",Array.from(r));const{data:t,error:n}=await se.from("positions").select("id, level, name").in("id",Array.from(r));if(n)return console.error(" [enrichTasksWithAssignerLevel] Error:",n),e;const a=new Map;for(const i of t||[])a.set(i.id,i.level);return console.log(" [enrichTasksWithAssignerLevel] Level map:",Object.fromEntries(a)),e.map(i=>{const o=i.assigner?.position_id,c=o?a.get(o):null;return{...i,assigner_level:c??null}})}const UE=e=>{const{title:r,...t}=e;return{...t,name:r||e.name}},mme={async getAll(e=1,r=10,t){console.log(" [taskService.getAll] Called with:",{page:e,pageSize:r,filter:t});const n=(e-1)*r,a=n+r-1;let i=se.from("tasks").select(`
        *,
        department:departments(id, code, name),
        assigner:employees!tasks_assigner_id_fkey(
          id, 
          code, 
          full_name,
          department_id,
          position_id
        ),
        assignee:employees!tasks_assignee_id_fkey(
          id, 
          code, 
          full_name,
          department_id
        )
      `,{count:"exact"});if(t?.search){const d=`%${t.search}%`;i=i.or(`name.ilike.${d},description.ilike.${d}`),console.log(" Applied search filter:",t.search)}if(t?.department_id&&(i=i.eq("department_id",t.department_id),console.log(" Applied department filter:",t.department_id)),t?.assignee_id&&(i=i.eq("assignee_id",t.assignee_id),console.log(" Applied assignee filter:",t.assignee_id)),t?.assigner_id&&(i=i.eq("assigner_id",t.assigner_id),console.log(" Applied assigner filter:",t.assigner_id)),t?.status&&(Array.isArray(t.status)?i=i.in("status",t.status):i=i.eq("status",t.status),console.log(" Applied status filter:",t.status)),t?.priority&&(Array.isArray(t.priority)?i=i.in("priority",t.priority):i=i.eq("priority",t.priority),console.log(" Applied priority filter:",t.priority)),t?.project_id&&(i=i.eq("project_id",t.project_id)),t?.start_date_from&&(i=i.gte("start_date",t.start_date_from)),t?.start_date_to&&(i=i.lte("start_date",t.start_date_to)),t?.due_date_from&&(i=i.gte("due_date",t.due_date_from)),t?.due_date_to&&(i=i.lte("due_date",t.due_date_to)),t?.has_parent===!0?i=i.not("parent_task_id","is",null):t?.has_parent===!1&&(i=i.is("parent_task_id",null)),t?.is_overdue===!0){const d=new Date().toISOString().split("T")[0];i=i.lt("due_date",d).not("status","eq","finished").not("status","eq","cancelled")}t?.is_self_assigned!==void 0&&(i=i.eq("is_self_assigned",t.is_self_assigned));const{data:o,error:c,count:u}=await i.order("created_at",{ascending:!1}).range(n,a);if(c)throw console.error(" [taskService.getAll] Error:",c),c;let l=(o||[]).map(eh);return l=await $_(l),console.log(" [taskService.getAll] Result:",{count:u,returned:l.length,page:e,pageSize:r}),{data:l,total:u||0,page:e,pageSize:r,totalPages:Math.ceil((u||0)/r)}},async getById(e){console.log(" [taskService.getById] ID:",e);const{data:r,error:t}=await se.from("tasks").select(`
        *,
        department:departments(id, code, name),
        assigner:employees!tasks_assigner_id_fkey(
          id, 
          code, 
          full_name,
          department_id,
          position_id
        ),
        assignee:employees!tasks_assignee_id_fkey(
          id, 
          code, 
          full_name,
          department_id
        ),
        parent_task:tasks!tasks_parent_task_id_fkey(id, code, name)
      `).eq("id",e).single();if(t)throw console.error(" [taskService.getById] Error:",t),t;if(!r)return null;const n=eh(r);return(await $_([n]))[0]||null},async create(e){console.log(" [taskService.create] Input:",e);const r=UE(e),{data:t,error:n}=await se.from("tasks").insert(r).select().single();if(n)throw console.error(" [taskService.create] Error:",n),n;return console.log(" [taskService.create] Created:",t.id),t.assignee_id&&t.assigner_id&&t.assignee_id!==t.assigner_id&&(console.log(" [taskService.create] Sending email to assignee:",t.assignee_id),B_(t.id,t.assignee_id,t.assigner_id,{code:t.code,name:t.name,description:t.description,priority:t.priority,due_date:t.due_date}).catch(a=>console.error(" Email error (non-blocking):",a))),eh(t)},async update(e,r){console.log(" [taskService.update] ID:",e,"Input:",r);const{data:t}=await se.from("tasks").select("assignee_id, assigner_id, code, name, description, priority, due_date").eq("id",e).single(),n=UE(r),{data:a,error:i}=await se.from("tasks").update(n).eq("id",e).select().single();if(i)throw console.error(" [taskService.update] Error:",i),i;return console.log(" [taskService.update] Updated:",e),r.assignee_id&&t?.assignee_id!==r.assignee_id&&a.assigner_id&&(console.log(" [taskService.update] Assignee changed, sending email to:",r.assignee_id),B_(e,r.assignee_id,a.assigner_id,{code:a.code,name:a.name,description:a.description,priority:a.priority,due_date:a.due_date}).catch(o=>console.error(" Email error (non-blocking):",o))),eh(a)},async delete(e){console.log(" [taskService.delete] ID:",e);const{error:r}=await se.from("tasks").delete().eq("id",e);if(r)throw console.error(" [taskService.delete] Error:",r),r;console.log(" [taskService.delete] Deleted:",e)},async updateStatus(e,r){console.log(" [taskService.updateStatus] ID:",e,"Status:",r);const t={status:r};r==="finished"&&(t.completed_date=new Date().toISOString(),t.progress=100);const{data:n,error:a}=await se.from("tasks").update(t).eq("id",e).select().single();if(a)throw console.error(" [taskService.updateStatus] Error:",a),a;return console.log(" [taskService.updateStatus] Updated:",e),eh(n)},async updateProgress(e,r){console.log(" [taskService.updateProgress] ID:",e,"Progress:",r);const t={progress:r};r>=100&&(t.status="finished",t.completed_date=new Date().toISOString(),t.progress=100);const{data:n,error:a}=await se.from("tasks").update(t).eq("id",e).select().single();if(a)throw console.error(" [taskService.updateProgress] Error:",a),a;return console.log(" [taskService.updateProgress] Updated:",e),eh(n)},async getSubtasks(e){console.log(" [taskService.getSubtasks] Parent ID:",e);const{data:r,error:t}=await se.from("tasks").select(`
        *,
        assignee:employees!tasks_assignee_id_fkey(id, code, full_name)
      `).eq("parent_task_id",e).order("created_at",{ascending:!0});if(t)throw console.error(" [taskService.getSubtasks] Error:",t),t;return(r||[]).map(eh)},async getStatusCounts(e){console.log(" [taskService.getStatusCounts] Filter:",e);let r=se.from("tasks").select("status",{count:"exact"});e?.department_id&&(r=r.eq("department_id",e.department_id)),e?.assignee_id&&(r=r.eq("assignee_id",e.assignee_id));const{data:t,error:n}=await r;if(n)throw console.error(" [taskService.getStatusCounts] Error:",n),n;const a={all:t?.length||0,draft:0,in_progress:0,paused:0,finished:0,cancelled:0};return t?.forEach(i=>{a[i.status]!==void 0&&a[i.status]++}),console.log(" [taskService.getStatusCounts] Result:",a),a},async assignTask(e,r,t){console.log(" [taskService.assignTask] Task:",e,"Assignee:",r);const{data:n}=await se.from("tasks").select("assignee_id, status, progress, code, name, description, priority, due_date").eq("id",e).single(),a={assignee_id:r,assigner_id:t,updated_at:new Date().toISOString()};n?.status==="draft"&&(a.status="in_progress",(!n.progress||n.progress===0)&&(a.progress=1),console.log(" [taskService.assignTask] Changing status from draft to in_progress"));const{data:i,error:o}=await se.from("tasks").update(a).eq("id",e).select(`
        *,
        department:departments(id, code, name),
        assigner:employees!tasks_assigner_id_fkey(
          id, 
          code, 
          full_name,
          department_id,
          position_id
        ),
        assignee:employees!tasks_assignee_id_fkey(
          id, 
          code, 
          full_name,
          department_id
        )
      `).single();if(o)throw console.error(" [taskService.assignTask] Error:",o),o;console.log(" [taskService.assignTask] Assigned:",e,"to",r,"status:",i.status),r!==t&&(console.log(" [taskService.assignTask] Sending email to assignee:",r),B_(e,r,t,{code:i.code,name:i.name,description:i.description,priority:i.priority,due_date:i.due_date}).catch(l=>console.error(" Email error (non-blocking):",l)));const c=eh(i);return(await $_([c]))[0]||c}},O0=e=>({...e,title:e.name||e.title||""}),q_=(e,r)=>{if(!e&&!r)return 0;if(!e)return-1;if(!r)return 1;const t=new Date(e).setHours(0,0,0,0),n=new Date(r).setHours(0,0,0,0);return t-n},rf=e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",ys={async getSubtasks(e){console.log(" [subtaskService.getSubtasks] Parent ID:",e);const{data:r,error:t}=await se.from("tasks").select(`
        *,
        assignee:employees!tasks_assignee_id_fkey(id, code, full_name),
        department:departments(id, code, name)
      `).eq("parent_task_id",e).order("created_at",{ascending:!0});if(t)throw console.error(" [subtaskService.getSubtasks] Error:",t),t;return(r||[]).map(O0)},async getSubtaskCount(e){const{count:r,error:t}=await se.from("tasks").select("id",{count:"exact",head:!0}).eq("parent_task_id",e);if(t)throw console.error(" [subtaskService.getSubtaskCount] Error:",t),t;return r||0},async getSubtaskSummary(e){console.log(" [subtaskService.getSubtaskSummary] Parent ID:",e);const{data:r,error:t}=await se.from("tasks").select("id, status, progress, due_date").eq("parent_task_id",e);if(t)throw console.error(" [subtaskService.getSubtaskSummary] Error:",t),t;const n=r||[],a=new Date().toISOString().split("T")[0],i={total:n.length,completed:n.filter(o=>o.status==="completed").length,inProgress:n.filter(o=>o.status==="in_progress").length,overdue:n.filter(o=>o.due_date&&o.due_date<a&&o.status!=="completed"&&o.status!=="cancelled").length,averageProgress:n.length>0?Math.round(n.reduce((o,c)=>o+(c.progress||0),0)/n.length):0};return console.log(" [subtaskService.getSubtaskSummary] Result:",i),i},async canHaveChildren(e){console.log(" [subtaskService.canHaveChildren] Task ID:",e);const{data:r,error:t}=await se.from("tasks").select("id, parent_task_id").eq("id",e).single();return t?(console.error(" [subtaskService.canHaveChildren] Error:",t),{canCreate:!1,reason:"Khng tm thy cng vic"}):r.parent_task_id?{canCreate:!1,reason:"Cng vic ny  l cng vic con, khng th to thm cp con na"}:{canCreate:!0}},async getDateConstraints(e){const{data:r}=await se.from("tasks").select("start_date, due_date").eq("id",e).single();return{minStartDate:r?.start_date||null,maxDueDate:r?.due_date||null}},async validateSubtaskDates(e,r,t){const n=[],a=[],{data:i}=await se.from("tasks").select("start_date, due_date, name").eq("id",e).single();return i?(r&&i.start_date&&q_(r,i.start_date)<0&&n.push(`Ngy bt u (${rf(r)}) khng c trc ngy bt u ca cng vic cha (${rf(i.start_date)})`),t&&i.due_date&&q_(t,i.due_date)>0&&n.push(`Hn hon thnh (${rf(t)}) khng c sau hn ca cng vic cha (${rf(i.due_date)})`),!t&&i.due_date&&a.push(`Nn t hn hon thnh trc ${rf(i.due_date)} (hn ca cng vic cha)`),{isValid:n.length===0,errors:n,warnings:a}):{isValid:!1,errors:["Khng tm thy cng vic cha"],warnings:a}},async createSubtask(e){console.log(" [subtaskService.createSubtask] Input:",e);const r=await ys.canHaveChildren(e.parent_task_id);if(!r.canCreate)throw new Error(r.reason||"Khng th to cng vic con");const t=await ys.validateSubtaskDates(e.parent_task_id,e.start_date,e.due_date);if(!t.isValid)throw new Error(t.errors.join(`
`));const{data:n}=await se.from("tasks").select("department_id, assigner_id, start_date, due_date").eq("id",e.parent_task_id).single(),a={parent_task_id:e.parent_task_id,name:e.name,description:e.description||null,assignee_id:e.assignee_id||null,assigner_id:n?.assigner_id||null,department_id:e.department_id||n?.department_id||null,priority:e.priority||"medium",start_date:e.start_date||null,due_date:e.due_date||null,status:"draft",progress:0},{data:i,error:o}=await se.from("tasks").insert(a).select(`
        *,
        assignee:employees!tasks_assignee_id_fkey(id, code, full_name)
      `).single();if(o)throw console.error(" [subtaskService.createSubtask] Error:",o),o;return console.log(" [subtaskService.createSubtask] Created:",i.id),await ys.recalculateParent(e.parent_task_id),O0(i)},async deleteTask(e){console.log(" [subtaskService.deleteTask] Task ID:",e);const r=await ys.getSubtaskCount(e);if(r>0)throw new Error(`Khng th xa cng vic ny v cn ${r} cng vic con. Vui lng xa cng vic con trc.`);const{data:t}=await se.from("tasks").select("parent_task_id").eq("id",e).single(),n=t?.parent_task_id,{error:a}=await se.from("tasks").delete().eq("id",e);if(a)throw console.error(" [subtaskService.deleteTask] Error:",a),a;console.log(" [subtaskService.deleteTask] Deleted:",e),n&&await ys.recalculateParent(n)},async recalculateParent(e){console.log(" [subtaskService.recalculateParent] Parent ID:",e);const{data:r,error:t}=await se.from("tasks").select("id, status, progress").eq("parent_task_id",e);if(t){console.error(" [subtaskService.recalculateParent] Error:",t);return}if(!r||r.length===0){console.log(" [subtaskService.recalculateParent] No children, skip");return}const n=Math.round(r.reduce((u,l)=>u+(l.progress||0),0)/r.length);let a="draft";const i=r.map(u=>u.status);i.every(u=>u==="completed")?a="completed":i.some(u=>u==="in_progress")?a="in_progress":i.some(u=>u==="on_hold")?a="on_hold":i.every(u=>u==="draft")?a="draft":a="in_progress",console.log(" [subtaskService.recalculateParent] New values:",{avgProgress:n,newStatus:a});const o={progress:n,status:a};a==="completed"&&(o.completed_date=new Date().toISOString());const{error:c}=await se.from("tasks").update(o).eq("id",e);c?console.error(" [subtaskService.recalculateParent] Update error:",c):console.log(" [subtaskService.recalculateParent] Updated parent")},async updateSubtaskProgress(e,r){console.log(" [subtaskService.updateSubtaskProgress] Task:",e,"Progress:",r);const t={progress:r};r>=100&&(t.status="completed",t.completed_date=new Date().toISOString(),t.progress=100);const{data:n,error:a}=await se.from("tasks").update(t).eq("id",e).select("*, parent_task_id").single();if(a)throw console.error(" [subtaskService.updateSubtaskProgress] Error:",a),a;return n.parent_task_id&&await ys.recalculateParent(n.parent_task_id),O0(n)},async updateSubtaskStatus(e,r){console.log(" [subtaskService.updateSubtaskStatus] Task:",e,"Status:",r);const t={status:r};r==="completed"&&(t.completed_date=new Date().toISOString(),t.progress=100);const{data:n,error:a}=await se.from("tasks").update(t).eq("id",e).select("*, parent_task_id").single();if(a)throw console.error(" [subtaskService.updateSubtaskStatus] Error:",a),a;return n.parent_task_id&&await ys.recalculateParent(n.parent_task_id),O0(n)},async getSiblings(e){console.log(" [subtaskService.getSiblings] Task ID:",e);const{data:r}=await se.from("tasks").select("parent_task_id").eq("id",e).single();if(!r?.parent_task_id)return[];const{data:t,error:n}=await se.from("tasks").select(`
        *,
        assignee:employees!tasks_assignee_id_fkey(id, code, full_name)
      `).eq("parent_task_id",r.parent_task_id).neq("id",e).order("created_at",{ascending:!0});if(n)throw console.error(" [subtaskService.getSiblings] Error:",n),n;return(t||[]).map(O0)},async isParentTask(e){return await ys.getSubtaskCount(e)>0},async isChildTask(e){const{data:r}=await se.from("tasks").select("parent_task_id").eq("id",e).single();return!!r?.parent_task_id},async validateParentDueDateChange(e,r){const t=[],n=[],{data:a}=await se.from("tasks").select("id, code, name, due_date").eq("parent_task_id",e);if(!a||a.length===0)return{isValid:!0,errors:t,warnings:n};const i=[];for(const o of a)o.due_date&&q_(o.due_date,r)>0&&i.push(`${o.code||o.id}: ${o.name} (hn: ${rf(o.due_date)})`);return i.length>0&&n.push(`${i.length} cng vic con c hn sau ngy mi (${rf(r)}):
`+i.join(`
`)),{isValid:!0,errors:t,warnings:n}},async cascadeStatusToChildren(e,r){console.log(" [subtaskService.cascadeStatus] Parent:",e,"Status:",r);try{const{data:t,error:n}=await se.from("tasks").select("id").eq("parent_task_id",e).not("status","in",'("completed","cancelled")');if(n)throw n;if(!t||t.length===0)return{success:!0,updatedCount:0};const a=t.map(o=>o.id),{error:i}=await se.from("tasks").update({status:r,updated_at:new Date().toISOString()}).in("id",a);if(i)throw i;return console.log(" [subtaskService.cascadeStatus] Updated:",a.length,"children"),{success:!0,updatedCount:a.length}}catch(t){const n=t instanceof Error?t.message:"Unknown error";return console.error(" [subtaskService.cascadeStatus] Error:",t),{success:!1,updatedCount:0,error:n}}},async canParentComplete(e){const{data:r,error:t}=await se.from("tasks").select("id, code, name, status").eq("parent_task_id",e);if(t)return{canComplete:!1,reason:"Li khi kim tra cng vic con"};if(!r||r.length===0)return{canComplete:!0};const n=r.filter(a=>a.status!=="completed");return n.length>0?{canComplete:!1,reason:`Cn ${n.length}/${r.length} cng vic con cha hon thnh`,incompleteChildren:n.map(a=>({id:a.id,code:a.code,name:a.name,status:a.status}))}:{canComplete:!0}},async validateParentStatusChange(e,r){const t=[],n=[];if(r==="completed"){const a=await ys.canParentComplete(e);a.canComplete||(t.push(a.reason||"Khng th hon thnh cng vic cha"),a.incompleteChildren&&a.incompleteChildren.length<=5&&(t.push("Cng vic con cha hon thnh:"),a.incompleteChildren.forEach(i=>{t.push(`  - ${i.code||i.id}: ${i.name}`)})))}if(r==="cancelled"||r==="on_hold"){const a=await ys.getSubtaskCount(e);if(a>0){const i=r==="cancelled"?" hy":"Tm dng";n.push(`${a} cng vic con s t ng chuyn sang trng thi "${i}"`)}}return{isValid:t.length===0,errors:t,warnings:n}}};async function gme(e,r,t,n){console.log(" [taskStatusService.changeTaskStatus]",{taskId:e,newStatus:r});const a=[];try{const i=await ys.getSubtaskCount(e),o=i>0;if(o){if(r==="completed"){const h=await ys.canParentComplete(e);if(!h.canComplete)return{success:!1,error:h.reason||"Khng th hon thnh cng vic cha khi cn cng vic con cha hon thnh"}}if(r==="cancelled"||r==="on_hold"){const h=r==="cancelled"?" hy":"Tm dng";a.push(`${i} cng vic con s t ng chuyn sang "${h}"`)}}const{data:c}=await se.from("tasks").select("status, progress").eq("id",e).single(),u=c?.status,l=c?.progress,d={status:r,updated_at:new Date().toISOString()};r==="completed"&&(d.progress=100,d.completed_date=new Date().toISOString());const{error:f}=await se.from("tasks").update(d).eq("id",e);if(f)throw f;u!==r&&await se.from("task_status_history").insert({task_id:e,old_status:u,new_status:r,old_progress:l,new_progress:d.progress||l,changed_by:t||null,change_reason:n||null,change_type:"manual"});let p=0;if(o&&(r==="cancelled"||r==="on_hold")){const h=await ys.cascadeStatusToChildren(e,r);p=h.updatedCount,h.error&&a.push(`Li cascade: ${h.error}`)}return console.log(" [taskStatusService.changeTaskStatus] Success",{cascadedCount:p}),{success:!0,cascadedChildren:p,warnings:a.length>0?a:void 0}}catch(i){return console.error(" [taskStatusService.changeTaskStatus] Error:",i),{success:!1,error:i.message||"C li khi thay i trng thi"}}}async function yme(e,r){const t=[],n=await ys.getSubtaskCount(e);if(n>0){if(r==="completed"){const a=await ys.canParentComplete(e);if(!a.canComplete)return{canChange:!1,reason:a.reason}}if(r==="cancelled"||r==="on_hold"){const a=r==="cancelled"?" hy":"Tm dng";t.push(`${n} cng vic con s t ng chuyn sang "${a}"`)}}return{canChange:!0,warnings:t.length>0?t:void 0}}async function xme(e,r,t){const{data:n,error:a}=await se.rpc("fn_approve_task",{p_task_id:e,p_manager_id:r,p_notes:t||null});if(a)throw console.error("Error approving task:",a),new Error(a.message);return n===!0}async function vme(e,r,t,n=99){const{data:a,error:i}=await se.rpc("fn_reject_task",{p_task_id:e,p_manager_id:r,p_rejection_reason:t,p_new_progress:n});if(i)throw console.error("Error rejecting task:",i),new Error(i.message);return a===!0}async function bme(e,r,t,n=95){const{data:a,error:i}=await se.rpc("fn_request_revision",{p_task_id:e,p_manager_id:r,p_revision_notes:t,p_new_progress:n});if(i)throw console.error("Error requesting revision:",i),new Error(i.message);return a===!0}async function wme(e){const{data:r,error:t}=await se.rpc("fn_get_unread_notifications",{p_employee_id:e});if(t)throw console.error("Error fetching notifications:",t),new Error(t.message);return r||[]}async function _me(e){const{data:r,error:t}=await se.rpc("fn_mark_notification_read",{p_notification_id:e});if(t)throw console.error("Error marking notification read:",t),new Error(t.message);return r===!0}async function jme(e){const{data:r,error:t}=await se.from("task_notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("recipient_id",e).eq("is_read",!1).select("id");if(t)throw console.error("Error marking all notifications read:",t),new Error(t.message);return r?.length||0}async function Nme(e){const{count:r,error:t}=await se.from("task_notifications").select("id",{count:"exact",head:!0}).eq("recipient_id",e).eq("is_read",!1);return t?(console.error("Error counting notifications:",t),0):r||0}async function kme(e){const{data:r,error:t}=await se.from("task_status_history").select(`
      *,
      changed_by_employee:employees!task_status_history_changed_by_fkey(
        id,
        full_name
      )
    `).eq("task_id",e).order("created_at",{ascending:!1});if(t){console.error("Error fetching status history:",t);const{data:n,error:a}=await se.from("task_status_history").select("*").eq("task_id",e).order("created_at",{ascending:!1});if(a)throw new Error(a.message);return n||[]}return r||[]}async function Sme(){const{data:e,error:r}=await se.rpc("fn_daily_task_maintenance");if(r)throw console.error("Error running daily maintenance:",r),new Error(r.message);return e}async function Cme(){const{data:e,error:r}=await se.rpc("fn_auto_transition_due_tasks");if(r)throw console.error("Error transitioning due tasks:",r),new Error(r.message);return e||0}async function Ame(){const{data:e,error:r}=await se.rpc("fn_mark_overdue_tasks");if(r)throw console.error("Error marking overdue tasks:",r),new Error(r.message);return e||0}async function Eme(){const{data:e,error:r}=await se.from("v_task_status_summary").select("*");if(r)throw console.error("Error fetching status summary:",r),new Error(r.message);return e||[]}async function Tme(){const{data:e,error:r}=await se.from("v_tasks_due_today").select("*");if(r)throw console.error("Error fetching tasks due today:",r),new Error(r.message);return e||[]}function Pme(e){return{due_reminder:"yellow",overdue_alert:"red",pending_approval:"blue",approval_result:"green"}[e]||"gray"}function Ome(e){return{due_reminder:"",overdue_alert:"",pending_approval:"",approval_result:""}[e]||""}function Mme(e){return{manual:"Thay i th cng",auto_due:"T ng (n hn)",auto_overdue:"T ng (qu hn)",approval:"Ph duyt",rejection:"T chi",revision_request:"Yu cu b sung"}[e]||e}const HE={changeTaskStatus:gme,canChangeStatus:yme,approveTask:xme,rejectTask:vme,requestRevision:bme,getUnreadNotifications:wme,markNotificationRead:_me,markAllNotificationsRead:jme,countUnreadNotifications:Nme,getTaskStatusHistory:kme,runDailyMaintenance:Sme,transitionDueTasks:Cme,markOverdueTasks:Ame,getTaskStatusSummary:Eme,getTasksDueToday:Tme,getNotificationColor:Pme,getNotificationIcon:Ome,getChangeTypeLabel:Mme},M0=["draft"],Ime={async getMyTasks(e,r){console.log(" [myTasksService] getMyTasks for:",e),console.log(" [myTasksService] Filter:",r);try{let t=se.from("tasks").select(`
          id,
          code,
          name,
          description,
          department_id,
          assigner_id,
          assignee_id,
          start_date,
          due_date,
          status,
          priority,
          progress,
          notes,
          is_self_assigned,
          evaluation_status,
          created_at,
          updated_at,
          department:departments(id, name),
          assigner:employees!tasks_assigner_id_fkey(id, full_name)
        `,{count:"exact"}).eq("assignee_id",e);r?.include_draft||(t=t.not("status","in",`(${M0.join(",")})`)),r?.status&&r.status!=="all"&&(t=t.eq("status",r.status)),r?.priority&&r.priority!=="all"&&(t=t.eq("priority",r.priority)),r?.department_id&&r.department_id!=="all"&&(t=t.eq("department_id",r.department_id)),r?.search&&(t=t.or(`name.ilike.%${r.search}%,code.ilike.%${r.search}%`)),r?.from_date&&(t=t.gte("due_date",r.from_date)),r?.to_date&&(t=t.lte("due_date",r.to_date));const{data:n,error:a,count:i}=await t.order("updated_at",{ascending:!1});if(a)throw console.error(" [myTasksService] Error fetching assignee tasks:",a),a;console.log(" [myTasksService] Found",n?.length||0,"tasks as assignee (excluding draft)");let o=se.from("task_assignments").select(`
          task_id,
          role,
          status,
          task:tasks(
            id,
            code,
            name,
            description,
            department_id,
            assigner_id,
            assignee_id,
            start_date,
            due_date,
            status,
            priority,
            progress,
            notes,
            is_self_assigned,
            evaluation_status,
            created_at,
            updated_at,
            department:departments(id, name),
            assigner:employees!tasks_assigner_id_fkey(id, full_name)
          )
        `).eq("employee_id",e).neq("status","removed");const{data:c,error:u}=await o;u&&console.error(" [myTasksService] Error fetching participant tasks:",u),console.log(" [myTasksService] Found",c?.length||0,"tasks as participant");const{data:l,error:d}=await se.from("task_self_evaluations").select("id, task_id, status").eq("employee_id",e);d&&console.error(" [myTasksService] Error fetching self-evaluations:",d);const f=new Map;if(l)for(const y of l)f.set(y.task_id,{has:!0,status:y.status,id:y.id});console.log(" [myTasksService] Found",f.size,"self-evaluations");const p=new Map;if(n)for(const y of n){const g=f.get(y.id);p.set(y.id,{...y,my_role:"assignee",department:Array.isArray(y.department)?y.department[0]:y.department,assigner:Array.isArray(y.assigner)?y.assigner[0]:y.assigner,has_self_evaluation:g?.has||!1,self_evaluation_status:g?.status||null,self_evaluation_id:g?.id||null})}if(c)for(const y of c){const g=y.task;if(g&&!p.has(g.id)){if(!r?.include_draft&&M0.includes(g.status)||r?.status&&r.status!=="all"&&g.status!==r.status||r?.priority&&r.priority!=="all"&&g.priority!==r.priority||r?.department_id&&r.department_id!=="all"&&g.department_id!==r.department_id)continue;if(r?.search){const x=r.search.toLowerCase();if(!g.name?.toLowerCase().includes(x)&&!g.code?.toLowerCase().includes(x))continue}const m=f.get(g.id);p.set(g.id,{...g,my_role:"participant",department:Array.isArray(g.department)?g.department[0]:g.department,assigner:Array.isArray(g.assigner)?g.assigner[0]:g.assigner,has_self_evaluation:m?.has||!1,self_evaluation_status:m?.status||null,self_evaluation_id:m?.id||null})}}const h=Array.from(p.values());return h.sort((y,g)=>{const m=new Date(y.updated_at||y.created_at||0).getTime();return new Date(g.updated_at||g.created_at||0).getTime()-m}),console.log(" [myTasksService] Total combined tasks (excluding draft):",h.length),{data:h,total:h.length}}catch(t){throw console.error(" [myTasksService] getMyTasks error:",t),t}},async getMyTaskById(e,r){console.log(" [myTasksService] getMyTaskById:",e,"for employee:",r);try{const{data:t,error:n}=await se.from("tasks").select(`
          id,
          code,
          name,
          description,
          department_id,
          assigner_id,
          assignee_id,
          start_date,
          due_date,
          status,
          priority,
          progress,
          notes,
          is_self_assigned,
          evaluation_status,
          created_at,
          updated_at,
          department:departments(id, name),
          assigner:employees!tasks_assigner_id_fkey(id, full_name)
        `).eq("id",e).single();if(n)throw n;if(!t)return null;const a=t.assignee_id===r;if(!a){const{data:o}=await se.from("task_assignments").select("id").eq("task_id",e).eq("employee_id",r).neq("status","removed").single();if(!o)return console.warn(" [myTasksService] Employee does not have access to task"),null}const{data:i}=await se.from("task_self_evaluations").select("id, status").eq("task_id",e).eq("employee_id",r).single();return{...t,my_role:a?"assignee":"participant",department:Array.isArray(t.department)?t.department[0]:t.department,assigner:Array.isArray(t.assigner)?t.assigner[0]:t.assigner,has_self_evaluation:!!i,self_evaluation_status:i?.status||null,self_evaluation_id:i?.id||null}}catch(t){throw console.error(" [myTasksService] getMyTaskById error:",t),t}},async updateProgress(e,r){console.log(" [myTasksService] updateProgress:",e,r);const{error:t}=await se.from("tasks").update({progress:r,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw console.error(" [myTasksService] updateProgress error:",t),t},async updateStatus(e,r){console.log(" [myTasksService] updateStatus:",e,r);const t={status:r,updated_at:new Date().toISOString()};r==="finished"&&(t.progress=100);const{error:n}=await se.from("tasks").update(t).eq("id",e);if(n)throw console.error(" [myTasksService] updateStatus error:",n),n},async getTaskCountsByStatus(e){console.log(" [myTasksService] getTaskCountsByStatus:",e);const{data:r,error:t}=await se.from("tasks").select("status").eq("assignee_id",e).not("status","in",`(${M0.join(",")})`);if(t)return console.error(" [myTasksService] getTaskCountsByStatus error:",t),{};const n={total:r.length,in_progress:0,paused:0,finished:0,cancelled:0};for(const a of r)n[a.status]!==void 0&&n[a.status]++;return n},async getCompletedTasksForEvaluation(e){console.log(" [myTasksService] getCompletedTasksForEvaluation:",e);try{const{data:r,error:t}=await se.from("tasks").select(`
          id,
          code,
          name,
          description,
          department_id,
          assigner_id,
          assignee_id,
          start_date,
          due_date,
          status,
          priority,
          progress,
          notes,
          is_self_assigned,
          evaluation_status,
          created_at,
          updated_at,
          department:departments(id, name)
        `).eq("assignee_id",e).in("status",["finished"]).not("status","in",`(${M0.join(",")})`);if(t)throw t;const{data:n,error:a}=await se.from("task_self_evaluations").select("id, task_id, status").eq("employee_id",e);if(a)throw a;const i=new Map;n?.forEach(c=>i.set(c.task_id,{status:c.status,id:c.id}));const o=r?.filter(c=>{const u=i.get(c.id);return!u||u.status==="revision_requested"}).map(c=>{const u=i.get(c.id);return{...c,department:Array.isArray(c.department)?c.department[0]:c.department,has_self_evaluation:!!u,self_evaluation_status:u?.status||null,self_evaluation_id:u?.id||null}})||[];return console.log(" [myTasksService] Found",o.length,"tasks for evaluation"),{data:o,error:null}}catch(r){return console.error(" [myTasksService] getCompletedTasksForEvaluation error:",r),{data:[],error:r}}},async getMyTasksStats(e){console.log(" [myTasksService] getMyTasksStats:",e);const{data:r,error:t}=await se.from("tasks").select("id, status, due_date, progress").eq("assignee_id",e).not("status","in",`(${M0.join(",")})`);if(t)return console.error(" [myTasksService] getMyTasksStats error:",t),{total:0,in_progress:0,paused:0,finished:0,cancelled:0,overdue:0,awaiting_self_eval:0,pending_approval:0,approved:0};const{data:n}=await se.from("task_self_evaluations").select("task_id, status").eq("employee_id",e),a=new Map;n?.forEach(c=>a.set(c.task_id,c.status));const i=new Date,o={total:r.length,in_progress:0,paused:0,finished:0,cancelled:0,overdue:0,awaiting_self_eval:0,pending_approval:0,approved:0};for(const c of r)if(c.status==="in_progress"?o.in_progress++:c.status==="paused"?o.paused++:c.status==="finished"?o.finished++:c.status==="cancelled"&&o.cancelled++,c.due_date&&!["finished","cancelled"].includes(c.status)&&new Date(c.due_date)<i&&o.overdue++,c.status==="finished"||c.progress>=100){const u=a.get(c.id);u?u==="pending"?o.pending_approval++:u==="approved"?o.approved++:u==="revision_requested"&&o.awaiting_self_eval++:o.awaiting_self_eval++}return console.log(" [myTasksService] Stats (excluding draft):",o),o}};function WD(e){return e>=90?"excellent":e>=70?"good":e>=50?"average":"below_average"}async function Rme(e){console.log(" [approveTask]:",e);try{const r=e.rating||WD(e.score),{error:t}=await se.from("task_approvals").insert({task_id:e.task_id,approver_id:e.approver_id,action:"approved",approved_score:e.score,original_score:e.score,rating:r,comments:e.comments||null});if(t)throw t;return e.self_evaluation_id&&await se.from("task_self_evaluations").update({status:"approved",updated_at:new Date().toISOString()}).eq("id",e.self_evaluation_id),await se.from("tasks").update({evaluation_status:"approved"}).eq("id",e.task_id),console.log(" [approveTask] Approved successfully (participants scores updated via trigger)"),{success:!0,error:null}}catch(r){return console.error(" [approveTask] error:",r),{success:!1,error:r}}}async function Lme(e){console.log(" [rejectTask]:",e);try{const{error:r}=await se.from("task_approvals").insert({task_id:e.task_id,approver_id:e.approver_id,action:"rejected",comments:e.rejection_reason});if(r)throw r;return e.self_evaluation_id&&await se.from("task_self_evaluations").update({status:"rejected",updated_at:new Date().toISOString()}).eq("id",e.self_evaluation_id),await se.from("tasks").update({evaluation_status:"rejected"}).eq("id",e.task_id),console.log(" [rejectTask] Rejected successfully"),{success:!0,error:null}}catch(r){return console.error(" [rejectTask] error:",r),{success:!1,error:r}}}async function Dme(e){console.log(" [requestInfo]:",e);try{const{error:r}=await se.from("task_approvals").insert({task_id:e.task_id,approver_id:e.approver_id,action:"revision_requested",comments:e.additional_request});if(r)throw r;return e.self_evaluation_id&&await se.from("task_self_evaluations").update({status:"revision_requested",updated_at:new Date().toISOString()}).eq("id",e.self_evaluation_id),await se.from("tasks").update({evaluation_status:"revision_requested"}).eq("id",e.task_id),console.log(" [requestInfo] Revision requested successfully"),{success:!0,error:null}}catch(r){return console.error(" [requestInfo] error:",r),{success:!1,error:r}}}const Ql={async getPendingEvaluations(e){console.log(" [approvalService] getPendingEvaluations with permission:",e);try{const{data:r,error:t}=await se.from("task_self_evaluations").select(`
          *,
          task:tasks(
            id, code, name, status, priority, progress, due_date, department_id, assigner_id,
            department:departments(id, name),
            assigner:employees!tasks_assigner_id_fkey(id, full_name, position_id)
          ),
          employee:employees(id, code, full_name, avatar_url, department_id)
        `).eq("status","pending").order("submitted_at",{ascending:!0});if(t)throw t;const n=new Set;(r||[]).forEach(o=>{const u=(Array.isArray(o.task)?o.task[0]:o.task)?.assigner,l=Array.isArray(u)?u[0]?.position_id:u?.position_id;l&&n.add(l)});const a=new Map;if(n.size>0){const{data:o}=await se.from("positions").select("id, level").in("id",Array.from(n));o?.forEach(c=>a.set(c.id,c.level))}let i=(r||[]).map(o=>{const c=Array.isArray(o.task)?o.task[0]:o.task,u=Array.isArray(o.employee)?o.employee[0]:o.employee,l=c?.assigner,d=Array.isArray(l)?l[0]:l,f=d?.position_id&&a.get(d.position_id)||1;return{...o,task:c?{...c,assigner:d?{...d,position:{level:f}}:null}:null,employee:u}});if(e){const{userLevel:o,userDepartmentId:c,isAdmin:u}=e;if(Rf(o)==="employee"&&!u)return console.log(" [approvalService] User is EMPLOYEE, returning empty"),{data:[],error:null};i=i.map(d=>{const f=d.task?.department_id||"",p=d.task?.assigner?.position?.level||6,h=J2(o,c,p,f,u);return{...d,canApprove:h.canApprove,permissionReason:h.reason}}).filter(d=>d.canApprove),console.log(` [approvalService] Filtered to ${i.length} approvable evaluations`)}return console.log(" [approvalService] Found",i.length,"pending evaluations"),{data:i,error:null}}catch(r){return console.error(" [approvalService] getPendingEvaluations error:",r),{data:[],error:r}}},async getCompletedWithoutEvaluation(e){console.log(" [approvalService] getCompletedWithoutEvaluation with permission:",e);try{const{data:r,error:t}=await se.from("tasks").select(`
          id, code, name, status, priority, progress, due_date, completed_date,
          department_id, assignee_id, assigner_id, created_at, updated_at,
          department:departments(id, name),
          assignee:employees!tasks_assignee_id_fkey(id, code, full_name, avatar_url),
          assigner:employees!tasks_assigner_id_fkey(id, full_name, position_id)
        `).eq("status","finished");if(t)throw t;const{data:n,error:a}=await se.from("task_self_evaluations").select("task_id");if(a)throw a;const i=new Set(n?.map(l=>l.task_id)||[]),o=new Set;(r||[]).forEach(l=>{const d=l.assigner,f=Array.isArray(d)?d[0]?.position_id:d?.position_id;f&&o.add(f)});const c=new Map;if(o.size>0){const{data:l}=await se.from("positions").select("id, level").in("id",Array.from(o));l?.forEach(d=>c.set(d.id,d.level))}let u=(r||[]).filter(l=>!i.has(l.id)).map(l=>{const d=l.assigner,f=Array.isArray(d)?d[0]:d,p=f?.position_id&&c.get(f.position_id)||1;return{...l,department:Array.isArray(l.department)?l.department[0]:l.department,assignee:Array.isArray(l.assignee)?l.assignee[0]:l.assignee,assigner:f?{...f,position:{level:p}}:null}});if(e){const{userLevel:l,userDepartmentId:d,isAdmin:f}=e;if(Rf(l)==="employee"&&!f)return console.log(" [approvalService] User is EMPLOYEE, returning empty"),{data:[],error:null};u=u.map(h=>{const y=h.department_id||"",g=h.assigner?.position?.level||1,m=J2(l,d,g,y,f);return{...h,canApprove:m.canApprove,permissionReason:m.reason}}).filter(h=>h.canApprove),console.log(` [approvalService] Filtered to ${u.length} approvable tasks`)}return console.log(" [approvalService] Found",u.length,"completed tasks without evaluation"),{data:u,error:null}}catch(r){return console.error(" [approvalService] getCompletedWithoutEvaluation error:",r),{data:[],error:r}}},async getApprovalStats(e){console.log(" [approvalService] getApprovalStats");try{const{data:r}=await this.getPendingEvaluations(e),t=r?.length||0,{data:n}=await this.getCompletedWithoutEvaluation(e),a=n?.length||0,i=new Date;i.setDate(i.getDate()-i.getDay()),i.setHours(0,0,0,0);const{data:o}=await se.from("task_approvals").select("id").eq("action","approved").gte("created_at",i.toISOString()),{data:c}=await se.from("task_approvals").select("id").eq("action","rejected").gte("created_at",i.toISOString());return{pending_evaluations:t,completed_without_eval:a,approved_this_week:o?.length||0,rejected_this_week:c?.length||0}}catch(r){return console.error(" [approvalService] getApprovalStats error:",r),{pending_evaluations:0,completed_without_eval:0,approved_this_week:0,rejected_this_week:0}}},async checkApprovalPermission(e,r){try{const{data:t,error:n}=await se.from("tasks").select(`
          id, department_id,
          assigner:employees!tasks_assigner_id_fkey(id, position_id)
        `).eq("id",e).maybeSingle();if(n||!t)return{canApprove:!1,reason:"Khng tm thy cng vic"};let a=1;const i=t.assigner,o=Array.isArray(i)?i[0]?.position_id:i?.position_id;if(o){const{data:c}=await se.from("positions").select("level").eq("id",o).maybeSingle();c?.level&&(a=c.level)}return J2(r.userLevel,r.userDepartmentId,a,t.department_id,r.isAdmin)}catch(t){return console.error("Error checking approval permission:",t),{canApprove:!1,reason:"Li kim tra quyn"}}},async approve(e){return Rme({task_id:e.task_id,approver_id:e.approver_id,score:e.score,comments:e.comments,self_evaluation_id:e.self_evaluation_id})},async reject(e){return Lme({task_id:e.task_id,approver_id:e.approver_id,rejection_reason:e.rejection_reason,comments:e.comments,self_evaluation_id:e.self_evaluation_id})},async requestRevision(e){return Dme({task_id:e.task_id,approver_id:e.approver_id,additional_request:e.revision_request,self_evaluation_id:e.self_evaluation_id})},async quickApprove(e){console.log(" [approvalService] quickApprove:",e);try{const r=WD(e.score),{error:t}=await se.from("task_self_evaluations").insert({task_id:e.task_id,employee_id:e.employee_id,completion_percentage:100,self_score:e.score,quality_assessment:r,status:"approved",revision_count:0,submitted_at:new Date().toISOString()});if(t)throw t;const{error:n}=await se.from("task_approvals").insert({task_id:e.task_id,approver_id:e.approver_id,action:"approved",approved_score:e.score,original_score:e.score,rating:r,comments:e.comments||"Ph duyt nhanh bi Manager"});if(n)throw n;return await se.from("tasks").update({evaluation_status:"approved"}).eq("id",e.task_id),console.log(" [approvalService] Quick approved successfully (participants scores updated via trigger)"),{success:!0,error:null}}catch(r){return console.error(" [approvalService] quickApprove error:",r),{success:!1,error:r}}}};var yy=e=>e.type==="checkbox",wf=e=>e instanceof Date,yo=e=>e==null;const KD=e=>typeof e=="object";var ka=e=>!yo(e)&&!Array.isArray(e)&&KD(e)&&!wf(e),Fme=e=>ka(e)&&e.target?yy(e.target)?e.target.checked:e.target.value:e,Bme=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,$me=(e,r)=>e.has(Bme(r)),qme=e=>{const r=e.constructor&&e.constructor.prototype;return ka(r)&&r.hasOwnProperty("isPrototypeOf")},a6=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function La(e){if(e instanceof Date)return new Date(e);const r=typeof FileList<"u"&&e instanceof FileList;if(a6&&(e instanceof Blob||r))return e;const t=Array.isArray(e);if(!t&&!(ka(e)&&qme(e)))return e;const n=t?[]:Object.create(Object.getPrototypeOf(e));for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=La(e[a]));return n}var q1=e=>/^\w*$/.test(e),Os=e=>e===void 0,i6=e=>Array.isArray(e)?e.filter(Boolean):[],o6=e=>i6(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ur=(e,r,t)=>{if(!r||!ka(e))return t;const n=(q1(r)?[r]:o6(r)).reduce((a,i)=>yo(a)?a:a[i],e);return Os(n)||n===e?Os(e[r])?t:e[r]:n},$c=e=>typeof e=="boolean",ic=e=>typeof e=="function",gs=(e,r,t)=>{let n=-1;const a=q1(r)?[r]:o6(r),i=a.length,o=i-1;for(;++n<i;){const c=a[n];let u=t;if(n!==o){const l=e[c];u=ka(l)||Array.isArray(l)?l:isNaN(+a[n+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;e[c]=u,e=e[c]}};const VE={BLUR:"blur",FOCUS_OUT:"focusout"},oc={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Lu={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},zme=sa.createContext(null);zme.displayName="HookFormControlContext";var Ume=(e,r,t,n=!0)=>{const a={defaultValues:r._defaultValues};for(const i in e)Object.defineProperty(a,i,{get:()=>{const o=i;return r._proxyFormState[o]!==oc.all&&(r._proxyFormState[o]=!n||oc.all),e[o]}});return a};const Hme=typeof window<"u"?sa.useLayoutEffect:sa.useEffect;var Ko=e=>typeof e=="string",Vme=(e,r,t,n,a)=>Ko(e)?(n&&r.watch.add(e),ur(t,e,a)):Array.isArray(e)?e.map(i=>(n&&r.watch.add(i),ur(t,i))):(n&&(r.watchAll=!0),t),s4=e=>yo(e)||!KD(e);function ch(e,r,t=new WeakSet){if(s4(e)||s4(r))return Object.is(e,r);if(wf(e)&&wf(r))return Object.is(e.getTime(),r.getTime());const n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return!1;if(t.has(e)||t.has(r))return!0;t.add(e),t.add(r);for(const i of n){const o=e[i];if(!a.includes(i))return!1;if(i!=="ref"){const c=r[i];if(wf(o)&&wf(c)||ka(o)&&ka(c)||Array.isArray(o)&&Array.isArray(c)?!ch(o,c,t):!Object.is(o,c))return!1}}return!0}const Wme=sa.createContext(null);Wme.displayName="HookFormContext";var Kme=(e,r,t,n,a)=>r?{...t[e],types:{...t[e]&&t[e].types?t[e].types:{},[n]:a||!0}}:{},tg=e=>Array.isArray(e)?e:[e],WE=()=>{let e=[];return{get observers(){return e},next:a=>{for(const i of e)i.next&&i.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(i=>i!==a)}}),unsubscribe:()=>{e=[]}}};function GD(e,r){const t={};for(const n in e)if(e.hasOwnProperty(n)){const a=e[n],i=r[n];if(a&&ka(a)&&i){const o=GD(a,i);ka(o)&&(t[n]=o)}else e[n]&&(t[n]=i)}return t}var Zi=e=>ka(e)&&!Object.keys(e).length,l6=e=>e.type==="file",bb=e=>{if(!a6)return!1;const r=e?e.ownerDocument:0;return e instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},XD=e=>e.type==="select-multiple",c6=e=>e.type==="radio",Gme=e=>c6(e)||yy(e),z_=e=>bb(e)&&e.isConnected;function Xme(e,r){const t=r.slice(0,-1).length;let n=0;for(;n<t;)e=Os(e)?n++:e[r[n++]];return e}function Yme(e){for(const r in e)if(e.hasOwnProperty(r)&&!Os(e[r]))return!1;return!0}function xa(e,r){const t=Array.isArray(r)?r:q1(r)?[r]:o6(r),n=t.length===1?e:Xme(e,t),a=t.length-1,i=t[a];return n&&delete n[i],a!==0&&(ka(n)&&Zi(n)||Array.isArray(n)&&Yme(n))&&xa(e,t.slice(0,-1)),e}var Qme=e=>{for(const r in e)if(ic(e[r]))return!0;return!1};function YD(e){return Array.isArray(e)||ka(e)&&!Qme(e)}function a4(e,r={}){for(const t in e){const n=e[t];YD(n)?(r[t]=Array.isArray(n)?[]:{},a4(n,r[t])):Os(n)||(r[t]=!0)}return r}function Qp(e,r,t){t||(t=a4(r));for(const n in e){const a=e[n];if(YD(a))Os(r)||s4(t[n])?t[n]=a4(a,Array.isArray(a)?[]:{}):Qp(a,yo(r)?{}:r[n],t[n]);else{const i=r[n];t[n]=!ch(a,i)}}return t}const KE={value:!1,isValid:!1},GE={value:!0,isValid:!0};var QD=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Os(e[0].attributes.value)?Os(e[0].value)||e[0].value===""?GE:{value:e[0].value,isValid:!0}:GE:KE}return KE},ZD=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:n})=>Os(e)?e:r?e===""?NaN:e&&+e:t&&Ko(e)?new Date(e):n?n(e):e;const XE={isValid:!1,value:null};var JD=e=>Array.isArray(e)?e.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,XE):XE;function YE(e){const r=e.ref;return l6(r)?r.files:c6(r)?JD(e.refs).value:XD(r)?[...r.selectedOptions].map(({value:t})=>t):yy(r)?QD(e.refs).value:ZD(Os(r.value)?e.ref.value:r.value,e)}var Zme=(e,r,t,n)=>{const a={};for(const i of e){const o=ur(r,i);o&&gs(a,i,o._f)}return{criteriaMode:t,names:[...e],fields:a,shouldUseNativeValidation:n}},wb=e=>e instanceof RegExp,I0=e=>Os(e)?e:wb(e)?e.source:ka(e)?wb(e.value)?e.value.source:e.value:e,QE=e=>({isOnSubmit:!e||e===oc.onSubmit,isOnBlur:e===oc.onBlur,isOnChange:e===oc.onChange,isOnAll:e===oc.all,isOnTouch:e===oc.onTouched});const ZE="AsyncFunction";var Jme=e=>!!e&&!!e.validate&&!!(ic(e.validate)&&e.validate.constructor.name===ZE||ka(e.validate)&&Object.values(e.validate).find(r=>r.constructor.name===ZE)),e0e=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),JE=(e,r,t)=>!t&&(r.watchAll||r.watch.has(e)||[...r.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const rg=(e,r,t,n)=>{for(const a of t||Object.keys(e)){const i=ur(e,a);if(i){const{_f:o,...c}=i;if(o){if(o.refs&&o.refs[0]&&r(o.refs[0],a)&&!n)return!0;if(o.ref&&r(o.ref,o.name)&&!n)return!0;if(rg(c,r))break}else if(ka(c)&&rg(c,r))break}}};function eT(e,r,t){const n=ur(e,t);if(n||q1(t))return{error:n,name:t};const a=t.split(".");for(;a.length;){const i=a.join("."),o=ur(r,i),c=ur(e,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(c&&c.type)return{name:i,error:c};if(c&&c.root&&c.root.type)return{name:`${i}.root`,error:c.root};a.pop()}return{name:t}}var t0e=(e,r,t,n)=>{t(e);const{name:a,...i}=e;return Zi(i)||Object.keys(i).length>=Object.keys(r).length||Object.keys(i).find(o=>r[o]===(!n||oc.all))},r0e=(e,r,t)=>!e||!r||e===r||tg(e).some(n=>n&&(t?n===r:n.startsWith(r)||r.startsWith(n))),n0e=(e,r,t,n,a)=>a.isOnAll?!1:!t&&a.isOnTouch?!(r||e):(t?n.isOnBlur:a.isOnBlur)?!e:(t?n.isOnChange:a.isOnChange)?e:!0,s0e=(e,r)=>!i6(ur(e,r)).length&&xa(e,r),a0e=(e,r,t)=>{const n=tg(ur(e,t));return gs(n,"root",r[t]),gs(e,t,n),e};function tT(e,r,t="validate"){if(Ko(e)||Array.isArray(e)&&e.every(Ko)||$c(e)&&!e)return{type:t,message:Ko(e)?e:"",ref:r}}var $p=e=>ka(e)&&!wb(e)?e:{value:e,message:""},rT=async(e,r,t,n,a,i)=>{const{ref:o,refs:c,required:u,maxLength:l,minLength:d,min:f,max:p,pattern:h,validate:y,name:g,valueAsNumber:m,mount:x}=e._f,v=ur(t,g);if(!x||r.has(g))return{};const w=c?c[0]:o,_=z=>{a&&w.reportValidity&&(w.setCustomValidity($c(z)?"":z||""),w.reportValidity())},A={},P=c6(o),B=yy(o),T=P||B,I=(m||l6(o))&&Os(o.value)&&Os(v)||bb(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,U=Kme.bind(null,g,n,A),H=(z,O,L,E=Lu.maxLength,k=Lu.minLength)=>{const N=z?O:L;A[g]={type:z?E:k,message:N,ref:o,...U(z?E:k,N)}};if(i?!Array.isArray(v)||!v.length:u&&(!T&&(I||yo(v))||$c(v)&&!v||B&&!QD(c).isValid||P&&!JD(c).isValid)){const{value:z,message:O}=Ko(u)?{value:!!u,message:u}:$p(u);if(z&&(A[g]={type:Lu.required,message:O,ref:w,...U(Lu.required,O)},!n))return _(O),A}if(!I&&(!yo(f)||!yo(p))){let z,O;const L=$p(p),E=$p(f);if(!yo(v)&&!isNaN(v)){const k=o.valueAsNumber||v&&+v;yo(L.value)||(z=k>L.value),yo(E.value)||(O=k<E.value)}else{const k=o.valueAsDate||new Date(v),N=D=>new Date(new Date().toDateString()+" "+D),S=o.type=="time",C=o.type=="week";Ko(L.value)&&v&&(z=S?N(v)>N(L.value):C?v>L.value:k>new Date(L.value)),Ko(E.value)&&v&&(O=S?N(v)<N(E.value):C?v<E.value:k<new Date(E.value))}if((z||O)&&(H(!!z,L.message,E.message,Lu.max,Lu.min),!n))return _(A[g].message),A}if((l||d)&&!I&&(Ko(v)||i&&Array.isArray(v))){const z=$p(l),O=$p(d),L=!yo(z.value)&&v.length>+z.value,E=!yo(O.value)&&v.length<+O.value;if((L||E)&&(H(L,z.message,O.message),!n))return _(A[g].message),A}if(h&&!I&&Ko(v)){const{value:z,message:O}=$p(h);if(wb(z)&&!v.match(z)&&(A[g]={type:Lu.pattern,message:O,ref:o,...U(Lu.pattern,O)},!n))return _(O),A}if(y){if(ic(y)){const z=await y(v,t),O=tT(z,w);if(O&&(A[g]={...O,...U(Lu.validate,O.message)},!n))return _(O.message),A}else if(ka(y)){let z={};for(const O in y){if(!Zi(z)&&!n)break;const L=tT(await y[O](v,t),w,O);L&&(z={...L,...U(O,L.message)},_(L.message),n&&(A[g]=z))}if(!Zi(z)&&(A[g]={ref:w,...z},!n))return A}}return _(!0),A};const i0e={mode:oc.onSubmit,reValidateMode:oc.onChange,shouldFocusError:!0};function o0e(e={}){let r={...i0e,...e},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ic(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},n={},a=ka(r.defaultValues)||ka(r.values)?La(r.defaultValues||r.values)||{}:{},i=r.shouldUnregister?{}:La(a),o={action:!1,mount:!1,watch:!1,keepIsValid:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u,l=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},f={...d};let p={...f};const h={array:WE(),state:WE()},y=r.criteriaMode===oc.all,g=fe=>xe=>{clearTimeout(l),l=setTimeout(fe,xe)},m=async fe=>{if(!o.keepIsValid&&!r.disabled&&(f.isValid||p.isValid||fe)){let xe;r.resolver?(xe=Zi((await T()).errors),x()):xe=await U(n,!0),xe!==t.isValid&&h.state.next({isValid:xe})}},x=(fe,xe)=>{!r.disabled&&(f.isValidating||f.validatingFields||p.isValidating||p.validatingFields)&&((fe||Array.from(c.mount)).forEach(je=>{je&&(xe?gs(t.validatingFields,je,xe):xa(t.validatingFields,je))}),h.state.next({validatingFields:t.validatingFields,isValidating:!Zi(t.validatingFields)}))},v=(fe,xe=[],je,Oe,Ie=!0,Le=!0)=>{if(Oe&&je&&!r.disabled){if(o.action=!0,Le&&Array.isArray(ur(n,fe))){const He=je(ur(n,fe),Oe.argA,Oe.argB);Ie&&gs(n,fe,He)}if(Le&&Array.isArray(ur(t.errors,fe))){const He=je(ur(t.errors,fe),Oe.argA,Oe.argB);Ie&&gs(t.errors,fe,He),s0e(t.errors,fe)}if((f.touchedFields||p.touchedFields)&&Le&&Array.isArray(ur(t.touchedFields,fe))){const He=je(ur(t.touchedFields,fe),Oe.argA,Oe.argB);Ie&&gs(t.touchedFields,fe,He)}(f.dirtyFields||p.dirtyFields)&&(t.dirtyFields=Qp(a,i)),h.state.next({name:fe,isDirty:z(fe,xe),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else gs(i,fe,xe)},w=(fe,xe)=>{gs(t.errors,fe,xe),h.state.next({errors:t.errors})},_=fe=>{t.errors=fe,h.state.next({errors:t.errors,isValid:!1})},A=(fe,xe,je,Oe)=>{const Ie=ur(n,fe);if(Ie){const Le=ur(i,fe,Os(je)?ur(a,fe):je);Os(Le)||Oe&&Oe.defaultChecked||xe?gs(i,fe,xe?Le:YE(Ie._f)):E(fe,Le),o.mount&&!o.action&&m()}},P=(fe,xe,je,Oe,Ie)=>{let Le=!1,He=!1;const Qe={name:fe};if(!r.disabled){if(!je||Oe){(f.isDirty||p.isDirty)&&(He=t.isDirty,t.isDirty=Qe.isDirty=z(),Le=He!==Qe.isDirty);const Je=ch(ur(a,fe),xe);He=!!ur(t.dirtyFields,fe),Je?xa(t.dirtyFields,fe):gs(t.dirtyFields,fe,!0),Qe.dirtyFields=t.dirtyFields,Le=Le||(f.dirtyFields||p.dirtyFields)&&He!==!Je}if(je){const Je=ur(t.touchedFields,fe);Je||(gs(t.touchedFields,fe,je),Qe.touchedFields=t.touchedFields,Le=Le||(f.touchedFields||p.touchedFields)&&Je!==je)}Le&&Ie&&h.state.next(Qe)}return Le?Qe:{}},B=(fe,xe,je,Oe)=>{const Ie=ur(t.errors,fe),Le=(f.isValid||p.isValid)&&$c(xe)&&t.isValid!==xe;if(r.delayError&&je?(u=g(()=>w(fe,je)),u(r.delayError)):(clearTimeout(l),u=null,je?gs(t.errors,fe,je):xa(t.errors,fe)),(je?!ch(Ie,je):Ie)||!Zi(Oe)||Le){const He={...Oe,...Le&&$c(xe)?{isValid:xe}:{},errors:t.errors,name:fe};t={...t,...He},h.state.next(He)}},T=async fe=>(x(fe,!0),await r.resolver(i,r.context,Zme(fe||c.mount,n,r.criteriaMode,r.shouldUseNativeValidation))),I=async fe=>{const{errors:xe}=await T(fe);if(x(fe),fe)for(const je of fe){const Oe=ur(xe,je);Oe?gs(t.errors,je,Oe):xa(t.errors,je)}else t.errors=xe;return xe},U=async(fe,xe,je={valid:!0})=>{for(const Oe in fe){const Ie=fe[Oe];if(Ie){const{_f:Le,...He}=Ie;if(Le){const Qe=c.array.has(Le.name),Je=Ie._f&&Jme(Ie._f);Je&&f.validatingFields&&x([Le.name],!0);const ct=await rT(Ie,c.disabled,i,y,r.shouldUseNativeValidation&&!xe,Qe);if(Je&&f.validatingFields&&x([Le.name]),ct[Le.name]&&(je.valid=!1,xe||e.shouldUseNativeValidation))break;!xe&&(ur(ct,Le.name)?Qe?a0e(t.errors,ct,Le.name):gs(t.errors,Le.name,ct[Le.name]):xa(t.errors,Le.name))}!Zi(He)&&await U(He,xe,je)}}return je.valid},H=()=>{for(const fe of c.unMount){const xe=ur(n,fe);xe&&(xe._f.refs?xe._f.refs.every(je=>!z_(je)):!z_(xe._f.ref))&&W(fe)}c.unMount=new Set},z=(fe,xe)=>!r.disabled&&(fe&&xe&&gs(i,fe,xe),!ch(q(),a)),O=(fe,xe,je)=>Vme(fe,c,{...o.mount?i:Os(xe)?a:Ko(fe)?{[fe]:xe}:xe},je,xe),L=fe=>i6(ur(o.mount?i:a,fe,r.shouldUnregister?ur(a,fe,[]):[])),E=(fe,xe,je={})=>{const Oe=ur(n,fe);let Ie=xe;if(Oe){const Le=Oe._f;Le&&(!Le.disabled&&gs(i,fe,ZD(xe,Le)),Ie=bb(Le.ref)&&yo(xe)?"":xe,XD(Le.ref)?[...Le.ref.options].forEach(He=>He.selected=Ie.includes(He.value)):Le.refs?yy(Le.ref)?Le.refs.forEach(He=>{(!He.defaultChecked||!He.disabled)&&(Array.isArray(Ie)?He.checked=!!Ie.find(Qe=>Qe===He.value):He.checked=Ie===He.value||!!Ie)}):Le.refs.forEach(He=>He.checked=He.value===Ie):l6(Le.ref)?Le.ref.value="":(Le.ref.value=Ie,Le.ref.type||h.state.next({name:fe,values:La(i)})))}(je.shouldDirty||je.shouldTouch)&&P(fe,Ie,je.shouldTouch,je.shouldDirty,!0),je.shouldValidate&&D(fe)},k=(fe,xe,je)=>{for(const Oe in xe){if(!xe.hasOwnProperty(Oe))return;const Ie=xe[Oe],Le=fe+"."+Oe,He=ur(n,Le);(c.array.has(fe)||ka(Ie)||He&&!He._f)&&!wf(Ie)?k(Le,Ie,je):E(Le,Ie,je)}},N=(fe,xe,je={})=>{const Oe=ur(n,fe),Ie=c.array.has(fe),Le=La(xe);gs(i,fe,Le),Ie?(h.array.next({name:fe,values:La(i)}),(f.isDirty||f.dirtyFields||p.isDirty||p.dirtyFields)&&je.shouldDirty&&h.state.next({name:fe,dirtyFields:Qp(a,i),isDirty:z(fe,Le)})):Oe&&!Oe._f&&!yo(Le)?k(fe,Le,je):E(fe,Le,je),JE(fe,c)?h.state.next({...t,name:fe,values:La(i)}):h.state.next({name:o.mount?fe:void 0,values:La(i)})},S=async fe=>{o.mount=!0;const xe=fe.target;let je=xe.name,Oe=!0;const Ie=ur(n,je),Le=Je=>{Oe=Number.isNaN(Je)||wf(Je)&&isNaN(Je.getTime())||ch(Je,ur(i,je,Je))},He=QE(r.mode),Qe=QE(r.reValidateMode);if(Ie){let Je,ct;const it=xe.type?YE(Ie._f):Fme(fe),At=fe.type===VE.BLUR||fe.type===VE.FOCUS_OUT,pt=!e0e(Ie._f)&&!r.resolver&&!ur(t.errors,je)&&!Ie._f.deps||n0e(At,ur(t.touchedFields,je),t.isSubmitted,Qe,He),nt=JE(je,c,At);gs(i,je,it),At?(!xe||!xe.readOnly)&&(Ie._f.onBlur&&Ie._f.onBlur(fe),u&&u(0)):Ie._f.onChange&&Ie._f.onChange(fe);const ht=P(je,it,At),St=!Zi(ht)||nt;if(!At&&h.state.next({name:je,type:fe.type,values:La(i)}),pt)return(f.isValid||p.isValid)&&(r.mode==="onBlur"?At&&m():At||m()),St&&h.state.next({name:je,...nt?{}:ht});if(!At&&nt&&h.state.next({...t}),r.resolver){const{errors:ot}=await T([je]);if(x([je]),Le(it),Oe){const Bt=eT(t.errors,n,je),Tt=eT(ot,n,Bt.name||je);Je=Tt.error,je=Tt.name,ct=Zi(ot)}}else x([je],!0),Je=(await rT(Ie,c.disabled,i,y,r.shouldUseNativeValidation))[je],x([je]),Le(it),Oe&&(Je?ct=!1:(f.isValid||p.isValid)&&(ct=await U(n,!0)));Oe&&(Ie._f.deps&&(!Array.isArray(Ie._f.deps)||Ie._f.deps.length>0)&&D(Ie._f.deps),B(je,ct,Je,ht))}},C=(fe,xe)=>{if(ur(t.errors,xe)&&fe.focus)return fe.focus(),1},D=async(fe,xe={})=>{let je,Oe;const Ie=tg(fe);if(r.resolver){const Le=await I(Os(fe)?fe:Ie);je=Zi(Le),Oe=fe?!Ie.some(He=>ur(Le,He)):je}else fe?(Oe=(await Promise.all(Ie.map(async Le=>{const He=ur(n,Le);return await U(He&&He._f?{[Le]:He}:He)}))).every(Boolean),!(!Oe&&!t.isValid)&&m()):Oe=je=await U(n);return h.state.next({...!Ko(fe)||(f.isValid||p.isValid)&&je!==t.isValid?{}:{name:fe},...r.resolver||!fe?{isValid:je}:{},errors:t.errors}),xe.shouldFocus&&!Oe&&rg(n,C,fe?Ie:c.mount),Oe},q=(fe,xe)=>{let je={...o.mount?i:a};return xe&&(je=GD(xe.dirtyFields?t.dirtyFields:t.touchedFields,je)),Os(fe)?je:Ko(fe)?ur(je,fe):fe.map(Oe=>ur(je,Oe))},M=(fe,xe)=>({invalid:!!ur((xe||t).errors,fe),isDirty:!!ur((xe||t).dirtyFields,fe),error:ur((xe||t).errors,fe),isValidating:!!ur(t.validatingFields,fe),isTouched:!!ur((xe||t).touchedFields,fe)}),G=fe=>{fe&&tg(fe).forEach(xe=>xa(t.errors,xe)),h.state.next({errors:fe?t.errors:{}})},X=(fe,xe,je)=>{const Oe=(ur(n,fe,{_f:{}})._f||{}).ref,Ie=ur(t.errors,fe)||{},{ref:Le,message:He,type:Qe,...Je}=Ie;gs(t.errors,fe,{...Je,...xe,ref:Oe}),h.state.next({name:fe,errors:t.errors,isValid:!1}),je&&je.shouldFocus&&Oe&&Oe.focus&&Oe.focus()},re=(fe,xe)=>ic(fe)?h.state.subscribe({next:je=>"values"in je&&fe(O(void 0,xe),je)}):O(fe,xe,!0),V=fe=>h.state.subscribe({next:xe=>{r0e(fe.name,xe.name,fe.exact)&&t0e(xe,fe.formState||f,pe,fe.reRenderRoot)&&fe.callback({values:{...i},...t,...xe,defaultValues:a})}}).unsubscribe,J=fe=>(o.mount=!0,p={...p,...fe.formState},V({...fe,formState:{...d,...fe.formState}})),W=(fe,xe={})=>{for(const je of fe?tg(fe):c.mount)c.mount.delete(je),c.array.delete(je),xe.keepValue||(xa(n,je),xa(i,je)),!xe.keepError&&xa(t.errors,je),!xe.keepDirty&&xa(t.dirtyFields,je),!xe.keepTouched&&xa(t.touchedFields,je),!xe.keepIsValidating&&xa(t.validatingFields,je),!r.shouldUnregister&&!xe.keepDefaultValue&&xa(a,je);h.state.next({values:La(i)}),h.state.next({...t,...xe.keepDirty?{isDirty:z()}:{}}),!xe.keepIsValid&&m()},F=({disabled:fe,name:xe})=>{if($c(fe)&&o.mount||fe||c.disabled.has(xe)){const Ie=c.disabled.has(xe)!==!!fe;fe?c.disabled.add(xe):c.disabled.delete(xe),Ie&&o.mount&&!o.action&&m()}},Q=(fe,xe={})=>{let je=ur(n,fe);const Oe=$c(xe.disabled)||$c(r.disabled);return gs(n,fe,{...je||{},_f:{...je&&je._f?je._f:{ref:{name:fe}},name:fe,mount:!0,...xe}}),c.mount.add(fe),je?F({disabled:$c(xe.disabled)?xe.disabled:r.disabled,name:fe}):A(fe,!0,xe.value),{...Oe?{disabled:xe.disabled||r.disabled}:{},...r.progressive?{required:!!xe.required,min:I0(xe.min),max:I0(xe.max),minLength:I0(xe.minLength),maxLength:I0(xe.maxLength),pattern:I0(xe.pattern)}:{},name:fe,onChange:S,onBlur:S,ref:Ie=>{if(Ie){Q(fe,xe),je=ur(n,fe);const Le=Os(Ie.value)&&Ie.querySelectorAll&&Ie.querySelectorAll("input,select,textarea")[0]||Ie,He=Gme(Le),Qe=je._f.refs||[];if(He?Qe.find(Je=>Je===Le):Le===je._f.ref)return;gs(n,fe,{_f:{...je._f,...He?{refs:[...Qe.filter(z_),Le,...Array.isArray(ur(a,fe))?[{}]:[]],ref:{type:Le.type,name:fe}}:{ref:Le}}}),A(fe,!1,void 0,Le)}else je=ur(n,fe,{}),je._f&&(je._f.mount=!1),(r.shouldUnregister||xe.shouldUnregister)&&!($me(c.array,fe)&&o.action)&&c.unMount.add(fe)}}},ne=()=>r.shouldFocusError&&rg(n,C,c.mount),ie=fe=>{$c(fe)&&(h.state.next({disabled:fe}),rg(n,(xe,je)=>{const Oe=ur(n,je);Oe&&(xe.disabled=Oe._f.disabled||fe,Array.isArray(Oe._f.refs)&&Oe._f.refs.forEach(Ie=>{Ie.disabled=Oe._f.disabled||fe}))},0,!1))},ce=(fe,xe)=>async je=>{let Oe;je&&(je.preventDefault&&je.preventDefault(),je.persist&&je.persist());let Ie=La(i);if(h.state.next({isSubmitting:!0}),r.resolver){const{errors:Le,values:He}=await T();x(),t.errors=Le,Ie=La(He)}else await U(n);if(c.disabled.size)for(const Le of c.disabled)xa(Ie,Le);if(xa(t.errors,"root"),Zi(t.errors)){h.state.next({errors:{}});try{await fe(Ie,je)}catch(Le){Oe=Le}}else xe&&await xe({...t.errors},je),ne(),setTimeout(ne);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Zi(t.errors)&&!Oe,submitCount:t.submitCount+1,errors:t.errors}),Oe)throw Oe},de=(fe,xe={})=>{ur(n,fe)&&(Os(xe.defaultValue)?N(fe,La(ur(a,fe))):(N(fe,xe.defaultValue),gs(a,fe,La(xe.defaultValue))),xe.keepTouched||xa(t.touchedFields,fe),xe.keepDirty||(xa(t.dirtyFields,fe),t.isDirty=xe.defaultValue?z(fe,La(ur(a,fe))):z()),xe.keepError||(xa(t.errors,fe),f.isValid&&m()),h.state.next({...t}))},le=(fe,xe={})=>{const je=fe?La(fe):a,Oe=La(je),Ie=Zi(fe),Le=Ie?a:Oe;if(xe.keepDefaultValues||(a=je),!xe.keepValues){if(xe.keepDirtyValues){const He=new Set([...c.mount,...Object.keys(Qp(a,i))]);for(const Qe of Array.from(He)){const Je=ur(t.dirtyFields,Qe),ct=ur(i,Qe),it=ur(Le,Qe);Je&&!Os(ct)?gs(Le,Qe,ct):!Je&&!Os(it)&&N(Qe,it)}}else{if(a6&&Os(fe))for(const He of c.mount){const Qe=ur(n,He);if(Qe&&Qe._f){const Je=Array.isArray(Qe._f.refs)?Qe._f.refs[0]:Qe._f.ref;if(bb(Je)){const ct=Je.closest("form");if(ct){ct.reset();break}}}}if(xe.keepFieldsRef)for(const He of c.mount)N(He,ur(Le,He));else n={}}i=r.shouldUnregister?xe.keepDefaultValues?La(a):{}:La(Le),h.array.next({values:{...Le}}),h.state.next({values:{...Le}})}c={mount:xe.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!f.isValid||!!xe.keepIsValid||!!xe.keepDirtyValues||!r.shouldUnregister&&!Zi(Le),o.watch=!!r.shouldUnregister,o.keepIsValid=!!xe.keepIsValid,o.action=!1,xe.keepErrors||(t.errors={}),h.state.next({submitCount:xe.keepSubmitCount?t.submitCount:0,isDirty:Ie?!1:xe.keepDirty?t.isDirty:!!(xe.keepDefaultValues&&!ch(fe,a)),isSubmitted:xe.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Ie?{}:xe.keepDirtyValues?xe.keepDefaultValues&&i?Qp(a,i):t.dirtyFields:xe.keepDefaultValues&&fe?Qp(a,fe):xe.keepDirty?t.dirtyFields:{},touchedFields:xe.keepTouched?t.touchedFields:{},errors:xe.keepErrors?t.errors:{},isSubmitSuccessful:xe.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},_e=(fe,xe)=>le(ic(fe)?fe(i):fe,{...r.resetOptions,...xe}),ue=(fe,xe={})=>{const je=ur(n,fe),Oe=je&&je._f;if(Oe){const Ie=Oe.refs?Oe.refs[0]:Oe.ref;Ie.focus&&setTimeout(()=>{Ie.focus(),xe.shouldSelect&&ic(Ie.select)&&Ie.select()})}},pe=fe=>{t={...t,...fe}},Ce={control:{register:Q,unregister:W,getFieldState:M,handleSubmit:ce,setError:X,_subscribe:V,_runSchema:T,_updateIsValidating:x,_focusError:ne,_getWatch:O,_getDirty:z,_setValid:m,_setFieldArray:v,_setDisabledField:F,_setErrors:_,_getFieldArray:L,_reset:le,_resetDefaultValues:()=>ic(r.defaultValues)&&r.defaultValues().then(fe=>{_e(fe,r.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:H,_disableForm:ie,_subjects:h,_proxyFormState:f,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(fe){o=fe},get _defaultValues(){return a},get _names(){return c},set _names(fe){c=fe},get _formState(){return t},get _options(){return r},set _options(fe){r={...r,...fe}}},subscribe:J,trigger:D,register:Q,handleSubmit:ce,watch:re,setValue:N,getValues:q,reset:_e,resetField:de,clearErrors:G,unregister:W,setError:X,setFocus:ue,getFieldState:M};return{...Ce,formControl:Ce}}function yc(e={}){const r=sa.useRef(void 0),t=sa.useRef(void 0),[n,a]=sa.useState({isDirty:!1,isValidating:!1,isLoading:ic(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:ic(e.defaultValues)?void 0:e.defaultValues});if(!r.current)if(e.formControl)r.current={...e.formControl,formState:n},e.defaultValues&&!ic(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:o,...c}=o0e(e);r.current={...c,formState:n}}const i=r.current.control;return i._options=e,Hme(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0});return a(c=>({...c,isReady:!0})),i._formState.isReady=!0,o},[i]),sa.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),sa.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),sa.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),sa.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),sa.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),sa.useEffect(()=>{var o;e.values&&!ch(e.values,t.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),!((o=i._options.resetOptions)===null||o===void 0)&&o.keepIsValid||i._setValid(),t.current=e.values,a(c=>({...c}))):i._resetDefaultValues()},[i,e.values]),sa.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),r.current.formState=sa.useMemo(()=>Ume(n,i),[i,n]),r.current}function l0e(e){return e?{code:e.code??"",name:e.name??"",description:e.description??"",status:e.status??"active"}:{code:"",name:"",description:"",status:"active"}}function c0e({department:e,onSuccess:r,onCancel:t}){const n=!!e,{register:a,handleSubmit:i,formState:{errors:o}}=yc({defaultValues:l0e(e)}),c=nn({mutationFn:l=>n?zi.update(e.id,l):zi.create(l),onSuccess:r}),u=l=>{c.mutate(l)};return s.jsxs("form",{onSubmit:i(u),className:"space-y-4",children:[s.jsx(Dt,{label:"M phng ban *",...a("code",{required:"Vui lng nhp m"}),error:o.code?.message,disabled:n}),s.jsx(Dt,{label:"Tn phng ban *",...a("name",{required:"Vui lng nhp tn"}),error:o.name?.message}),s.jsx(Dt,{label:"M t",...a("description")}),s.jsx(Kn,{label:"Trng thi",...a("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),c.error&&s.jsx("p",{className:"text-danger text-sm",children:c.error.message}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:c.isPending,children:n?"Cp nht":"Thm mi"})]})]})}function u0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(!1),[c,u]=R.useState(null),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["departments",r,n],queryFn:()=>zi.getAll({page:r,pageSize:10,search:n})}),h=nn({mutationFn:zi.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["departments"]}),d(null)}}),y=[{key:"code",title:"M"},{key:"name",title:"Tn phng ban"},{key:"description",title:"M t"},{key:"status",title:"Trng thi",render:v=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Hot ng":"Ngng"})},{key:"actions",title:"Thao tc",render:v=>s.jsx("div",{className:"flex gap-2",children:s.jsxs(s.Fragment,{children:[s.jsxs(Lt,{size:"sm",variant:"outline",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Sa"]}),s.jsxs(Lt,{size:"sm",variant:"danger",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Xa"]})]})})}],g=()=>{u(null),o(!0)},m=()=>{o(!1),u(null)},x=()=>{e.invalidateQueries({queryKey:["departments"]}),m()};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l Phng ban"}),s.jsx(Lt,{onClick:g,children:"+ Thm phng ban"})]}),s.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2 text-amber-700",children:[s.jsx(da,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Chc nng Sa/Xa ang tm thi b kha  m bo tnh ton vn d liu."})]}),s.jsxs(is,{children:[s.jsx("div",{className:"mb-4",children:s.jsx(Dt,{placeholder:"Tm kim theo m hoc tn...",value:n,onChange:v=>a(v.target.value),className:"max-w-md"})}),s.jsx(Gf,{columns:y,data:f?.data||[],isLoading:p,emptyMessage:"Cha c phng ban no"}),f&&s.jsx(El,{currentPage:f.page,totalPages:f.totalPages,onPageChange:t})]}),s.jsx(ji,{isOpen:i,onClose:m,title:c?"Sa phng ban":"Thm phng ban",children:s.jsx(c0e,{department:c,onSuccess:x,onCancel:m})}),s.jsx(mc,{isOpen:!!l,onClose:()=>d(null),onConfirm:()=>l&&h.mutate(l),title:"Xc nhn xa",message:"Bn c chc mun xa phng ban ny?",isLoading:h.isPending})]})}function d0e(e){return e?{code:e.code??"",name:e.name??"",level:e.level??1,description:e.description??"",status:e.status??"active"}:{code:"",name:"",level:1,description:"",status:"active"}}function h0e({position:e,onSuccess:r,onCancel:t}){const n=!!e,{register:a,handleSubmit:i,formState:{errors:o}}=yc({defaultValues:d0e(e)}),c=nn({mutationFn:l=>n?Lg.update(e.id,l):Lg.create(l),onSuccess:r}),u=l=>{c.mutate(l)};return s.jsxs("form",{onSubmit:i(u),className:"space-y-4",children:[s.jsx(Dt,{label:"M chc v *",...a("code",{required:"Vui lng nhp m"}),error:o.code?.message,disabled:n}),s.jsx(Dt,{label:"Tn chc v *",...a("name",{required:"Vui lng nhp tn"}),error:o.name?.message}),s.jsx(Dt,{label:"Cp bc",type:"number",...a("level",{valueAsNumber:!0})}),s.jsx(Dt,{label:"M t",...a("description")}),s.jsx(Kn,{label:"Trng thi",...a("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),c.error&&s.jsx("p",{className:"text-danger text-sm",children:c.error.message}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:c.isPending,children:n?"Cp nht":"Thm mi"})]})]})}function f0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(!1),[c,u]=R.useState(null),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["positions",r,n],queryFn:()=>Lg.getAll({page:r,pageSize:10,search:n})}),h=nn({mutationFn:Lg.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["positions"]}),d(null)}}),y=[{key:"code",title:"M"},{key:"name",title:"Tn chc v"},{key:"level",title:"Cp bc"},{key:"description",title:"M t"},{key:"status",title:"Trng thi",render:v=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${v.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:v.status==="active"?"Hot ng":"Ngng"})},{key:"actions",title:"Thao tc",render:v=>s.jsx("div",{className:"flex gap-2",children:s.jsxs(s.Fragment,{children:[s.jsxs(Lt,{size:"sm",variant:"outline",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Sa"]}),s.jsxs(Lt,{size:"sm",variant:"danger",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Xa"]})]})})}],g=()=>{u(null),o(!0)},m=()=>{o(!1),u(null)},x=()=>{e.invalidateQueries({queryKey:["positions"]}),m()};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l Chc v"}),s.jsx(Lt,{onClick:g,children:"+ Thm chc v"})]}),s.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2 text-amber-700",children:[s.jsx(da,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Chc nng Sa/Xa ang tm thi b kha  m bo tnh ton vn d liu."})]}),s.jsxs(is,{children:[s.jsx("div",{className:"mb-4",children:s.jsx(Dt,{placeholder:"Tm kim theo m hoc tn...",value:n,onChange:v=>a(v.target.value),className:"max-w-md"})}),s.jsx(Gf,{columns:y,data:f?.data||[],isLoading:p,emptyMessage:"Cha c chc v no"}),f&&s.jsx(El,{currentPage:f.page,totalPages:f.totalPages,onPageChange:t})]}),s.jsx(ji,{isOpen:i,onClose:m,title:c?"Sa chc v":"Thm chc v",children:s.jsx(h0e,{position:c,onSuccess:x,onCancel:m})}),s.jsx(mc,{isOpen:!!l,onClose:()=>d(null),onConfirm:()=>l&&h.mutate(l),title:"Xc nhn xa",message:"Bn c chc mun xa chc v ny?",isLoading:h.isPending})]})}function p0e(e){if(!e)return{code:"",full_name:"",date_of_birth:"",gender:"male",phone:"",email:"",department_id:"",position_id:"",hire_date:"",status:"active"};const r=e.gender==="male"||e.gender==="female"||e.gender==="other"?e.gender:"male";return{code:e.code??"",full_name:e.full_name??"",date_of_birth:e.date_of_birth??"",gender:r,phone:e.phone??"",email:e.email??"",department_id:e.department_id??"",position_id:e.position_id??"",hire_date:e.hire_date??"",status:e.status??"active"}}function m0e({employee:e,onSuccess:r,onCancel:t}){const n=!!e,{register:a,handleSubmit:i,setValue:o,formState:{errors:c}}=yc({defaultValues:p0e(e)}),{data:u}=gr({queryKey:["departments-active"],queryFn:zi.getAllActive}),{data:l}=gr({queryKey:["positions-active"],queryFn:Lg.getAllActive});R.useEffect(()=>{n||uc.generateCode().then(p=>o("code",p))},[n,o]);const d=nn({mutationFn:p=>n?uc.update(e.id,p):uc.create(p),onSuccess:r}),f=p=>{d.mutate(p)};return s.jsxs("form",{onSubmit:i(f),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"M nhn vin *",...a("code",{required:"Vui lng nhp m"}),error:c.code?.message,disabled:n}),s.jsx(Dt,{label:"H v tn *",...a("full_name",{required:"Vui lng nhp h tn"}),error:c.full_name?.message})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Ngy sinh",type:"date",...a("date_of_birth")}),s.jsx(Kn,{label:"Gii tnh",...a("gender"),options:[{value:"male",label:"Nam"},{value:"female",label:"N"},{value:"other",label:"Khc"}]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"S in thoi",...a("phone")}),s.jsx(Dt,{label:"Email",type:"email",...a("email")})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Kn,{label:"Phng ban",...a("department_id"),options:[{value:"",label:"-- Chn phng ban --"},...u?.map(p=>({value:p.id,label:p.name}))||[]]}),s.jsx(Kn,{label:"Chc v",...a("position_id"),options:[{value:"",label:"-- Chn chc v --"},...l?.map(p=>({value:p.id,label:p.name}))||[]]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Ngy vo lm",type:"date",...a("hire_date")}),s.jsx(Kn,{label:"Trng thi",...a("status"),options:[{value:"active",label:"ang lm vic"},{value:"inactive",label:"Tm ngh"},{value:"terminated",label:" ngh vic"}]})]}),d.error&&s.jsx("p",{className:"text-danger text-sm",children:d.error.message}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:d.isPending,children:n?"Cp nht":"Thm mi"})]})]})}function g0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(""),[c,u]=R.useState(!1),[l,d]=R.useState(null),[f,p]=R.useState(null),{data:h,isLoading:y}=gr({queryKey:["employees",r,n,i],queryFn:()=>uc.getAll({page:r,pageSize:10,search:n,department_id:i||void 0})}),{data:g}=gr({queryKey:["departments-active"],queryFn:zi.getAllActive}),m=nn({mutationFn:uc.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["employees"]}),p(null)}}),x=[{key:"code",title:"M NV"},{key:"full_name",title:"H v tn"},{key:"department",title:"Phng ban",render:A=>A.department?.name||"-"},{key:"position",title:"Chc v",render:A=>A.position?.name||"-"},{key:"phone",title:"in thoi"},{key:"status",title:"Trng thi",render:A=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${A.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.status==="active"?"ang lm":"Ngh vic"})},{key:"actions",title:"Thao tc",render:A=>s.jsx("div",{className:"flex gap-2",children:s.jsxs(s.Fragment,{children:[s.jsxs(Lt,{size:"sm",variant:"outline",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Sa"]}),s.jsxs(Lt,{size:"sm",variant:"danger",disabled:!0,className:"opacity-50 cursor-not-allowed",title:"Chc nng tm kha",children:[s.jsx(da,{className:"w-3 h-3 mr-1"}),"Xa"]})]})})}],v=()=>{d(null),u(!0)},w=()=>{u(!1),d(null)},_=()=>{e.invalidateQueries({queryKey:["employees"]}),w()};return s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l Nhn vin"}),s.jsx(Lt,{onClick:v,children:"+ Thm nhn vin"})]}),s.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center gap-2 text-amber-700",children:[s.jsx(da,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Chc nng Sa/Xa ang tm thi b kha  m bo tnh ton vn d liu."})]}),s.jsxs(is,{children:[s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsx(Dt,{placeholder:"Tm kim theo m, tn, email...",value:n,onChange:A=>a(A.target.value),className:"max-w-md"}),s.jsx(Kn,{value:i,onChange:A=>o(A.target.value),options:[{value:"",label:"Tt c phng ban"},...g?.map(A=>({value:A.id,label:A.name}))||[]],className:"w-48"})]}),s.jsx(Gf,{columns:x,data:h?.data||[],isLoading:y,emptyMessage:"Cha c nhn vin no"}),h&&s.jsx(El,{currentPage:h.page,totalPages:h.totalPages,onPageChange:t})]}),s.jsx(ji,{isOpen:c,onClose:w,title:l?"Sa nhn vin":"Thm nhn vin",size:"lg",children:s.jsx(m0e,{employee:l,onSuccess:_,onCancel:w})}),s.jsx(mc,{isOpen:!!f,onClose:()=>p(null),onConfirm:()=>f&&m.mutate(f),title:"Xc nhn xa",message:"Bn c chc mun xa nhn vin ny?",isLoading:m.isPending})]})}function y0e({initialData:e,onSuccess:r,onCancel:t}){const{register:n,handleSubmit:a,watch:i,formState:{errors:o}}=yc({defaultValues:e?{...e,description:e.description??void 0,duration_months:e.duration_months??void 0}:{code:"",name:"",description:"",duration_months:12,is_permanent:!1,status:"active"}}),c=i("is_permanent"),u=nn({mutationFn:d=>e?Dg.update(e.id,d):Dg.create(d),onSuccess:r}),l=d=>{d.is_permanent&&(d.duration_months=void 0),u.mutate(d)};return s.jsxs("form",{onSubmit:a(l),className:"space-y-4",children:[s.jsx(Dt,{label:"M loi hp ng *",...n("code",{required:"Vui lng nhp m"}),error:o.code?.message,disabled:!!e}),s.jsx(Dt,{label:"Tn loi hp ng *",...n("name",{required:"Vui lng nhp tn"}),error:o.name?.message}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"is_permanent",...n("is_permanent"),className:"rounded"}),s.jsx("label",{htmlFor:"is_permanent",children:"Hp ng khng xc nh thi hn"})]}),!c&&s.jsx(Dt,{label:"Thi hn (thng)",type:"number",...n("duration_months",{valueAsNumber:!0})}),s.jsx(Dt,{label:"M t",...n("description")}),s.jsx(Kn,{label:"Trng thi",...n("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:u.isPending,children:e?"Cp nht":"Thm mi"})]})]})}function x0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(!1),[c,u]=R.useState(null),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["contract-types",r,n],queryFn:()=>Dg.getAll({page:r,pageSize:10,search:n})}),h=nn({mutationFn:Dg.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["contract-types"]}),d(null)}}),y=[{key:"code",title:"M"},{key:"name",title:"Tn loi hp ng"},{key:"duration_months",title:"Thi hn",render:g=>g.is_permanent?"Khng xc nh":`${g.duration_months} thng`},{key:"status",title:"Trng thi",render:g=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${g.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.status==="active"?"Hot ng":"Ngng"})},{key:"actions",title:"Thao tc",render:g=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{u(g),o(!0)},children:"Sa"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>d(g.id),children:"Xa"})]})}];return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l loi hp ng"}),s.jsx(Lt,{onClick:()=>{u(null),o(!0)},children:"+ Thm loi hp ng"})]}),s.jsxs(is,{children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx(Dt,{placeholder:"Tm kim theo m hoc tn...",value:n,onChange:g=>{a(g.target.value),t(1)},className:"max-w-md"})}),s.jsx(Gf,{columns:y,data:f?.data||[],isLoading:p,emptyMessage:"Cha c loi hp ng no"}),f&&f.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:f.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:i,onClose:()=>o(!1),title:c?"Cp nht loi hp ng":"Thm loi hp ng",children:s.jsx(y0e,{initialData:c,onSuccess:()=>{o(!1),e.invalidateQueries({queryKey:["contract-types"]})},onCancel:()=>o(!1)})}),s.jsx(mc,{isOpen:!!l,onClose:()=>d(null),onConfirm:()=>l&&h.mutate(l),title:"Xc nhn xa",message:"Bn c chc chn mun xa loi hp ng ny?",isLoading:h.isPending})]})}function v0e(e){return{employee_id:e.employee_id,contract_type_id:e.contract_type_id,contract_number:e.contract_number??void 0,code:e.code??void 0,start_date:e.start_date,end_date:e.end_date??void 0,signed_date:e.signed_date??void 0,sign_date:e.sign_date??void 0,salary:e.salary??void 0,base_salary:e.base_salary??void 0,allowances:e.allowances??void 0,benefits:e.benefits??void 0,status:e.status??void 0,notes:e.notes??void 0}}function b0e({initialData:e,employeeId:r,onSuccess:t,onCancel:n}){const{register:a,handleSubmit:i,watch:o,setValue:c,formState:{errors:u}}=yc({defaultValues:e?v0e(e):{contract_number:"",employee_id:r||"",contract_type_id:"",start_date:new Date().toISOString().split("T")[0],end_date:"",base_salary:0,salary_currency:"VND",allowance_lunch:0,allowance_transport:0,allowance_phone:0,allowance_housing:0,allowance_other:0,job_title:"",work_location:"Huy Anh Rubber",working_hours:"8:00 - 17:00",status:"active",notes:""}}),{data:l}=gr({queryKey:["employees-active"],queryFn:()=>uc.getAll({page:1,pageSize:1e3,status:"active"})}),{data:d}=gr({queryKey:["contract-types-active"],queryFn:Dg.getAllActive});R.useEffect(()=>{e||J0.generateContractNumber().then(g=>{c("contract_number",g)})},[e,c]);const f=o("contract_type_id"),p=o("start_date");R.useEffect(()=>{if(f&&p&&d){const g=d.find(m=>m.id===f);if(g&&g.is_renewable!==!1&&g.duration_months){const m=new Date(p);m.setMonth(m.getMonth()+g.duration_months),c("end_date",m.toISOString().split("T")[0])}else g?.is_renewable===!1&&c("end_date","")}},[f,p,d,c]);const h=nn({mutationFn:g=>{const m={...g,contract_number:g.contract_number||"",employee_id:g.employee_id,contract_type_id:g.contract_type_id,start_date:g.start_date};return e?J0.update(e.id,m):J0.create(m)},onSuccess:t}),y=g=>{h.mutate(g)};return s.jsxs("form",{onSubmit:i(y),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"S hp ng *",...a("contract_number",{required:"Vui lng nhp s hp ng"}),error:u.contract_number?.message,disabled:!!e}),s.jsx(Kn,{label:"Nhn vin *",...a("employee_id",{required:"Vui lng chn nhn vin"}),error:u.employee_id?.message,disabled:!!r||!!e,options:[{value:"",label:"-- Chn nhn vin --"},...(l?.data||[]).map(g=>({value:g.id,label:`${g.code} - ${g.full_name}`}))]}),s.jsx(Kn,{label:"Loi hp ng *",...a("contract_type_id",{required:"Vui lng chn loi hp ng"}),error:u.contract_type_id?.message,options:[{value:"",label:"-- Chn loi hp ng --"},...(d||[]).map(g=>({value:g.id,label:g.name}))]}),s.jsx(Kn,{label:"Trng thi",...a("status"),options:[{value:"active",label:"ang hiu lc"},{value:"expired",label:"Ht hn"},{value:"terminated",label:"Chm dt"},{value:"renewed",label:" gia hn"}]}),s.jsx(Dt,{label:"Ngy bt u *",type:"date",...a("start_date",{required:"Vui lng chn ngy"}),error:u.start_date?.message}),s.jsx(Dt,{label:"Ngy kt thc",type:"date",...a("end_date")})]}),s.jsx("hr",{className:"my-4"}),s.jsx("h3",{className:"font-semibold",children:"Thng tin lng"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Lng c bn *",type:"number",...a("base_salary",{required:"Vui lng nhp lng",valueAsNumber:!0}),error:u.base_salary?.message}),s.jsx(Dt,{label:"Ph cp n tra",type:"number",...a("allowance_lunch",{valueAsNumber:!0})}),s.jsx(Dt,{label:"Ph cp i li",type:"number",...a("allowance_transport",{valueAsNumber:!0})}),s.jsx(Dt,{label:"Ph cp in thoi",type:"number",...a("allowance_phone",{valueAsNumber:!0})}),s.jsx(Dt,{label:"Ph cp nh ",type:"number",...a("allowance_housing",{valueAsNumber:!0})}),s.jsx(Dt,{label:"Ph cp khc",type:"number",...a("allowance_other",{valueAsNumber:!0})})]}),s.jsx("hr",{className:"my-4"}),s.jsx("h3",{className:"font-semibold",children:"Thng tin cng vic"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Chc danh",...a("job_title")}),s.jsx(Dt,{label:"a im lm vic",...a("work_location")}),s.jsx(Dt,{label:"Gi lm vic",...a("working_hours"),placeholder:"VD: 8:00 - 17:00"})]}),s.jsx(Dt,{label:"Ghi ch",...a("notes")}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:n,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:h.isPending,children:e?"Cp nht":"Thm mi"})]})]})}function w0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(""),[c,u]=R.useState(!1),[l,d]=R.useState(null),[f,p]=R.useState(null),{data:h,isLoading:y}=gr({queryKey:["contracts",r,n,i],queryFn:()=>J0.getAll({page:r,pageSize:10,search:n,status:i||void 0})}),g=nn({mutationFn:J0.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["contracts"]}),p(null)}}),m=w=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(w),x=w=>new Date(w).toLocaleDateString("vi-VN"),v=[{key:"contract_number",title:"S hp ng"},{key:"employee",title:"Nhn vin",render:w=>w.employee?.full_name||"-"},{key:"contract_type",title:"Loi H",render:w=>w.contract_type?.name||"-"},{key:"period",title:"Thi hn",render:w=>s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{children:x(w.start_date)}),s.jsx("div",{className:"text-gray-500",children:w.end_date?`n ${x(w.end_date)}`:"Khng xc nh"})]})},{key:"base_salary",title:"Lng c bn",render:w=>m(w.base_salary??0)},{key:"status",title:"Trng thi",render:w=>{const _={active:"bg-green-100 text-green-800",expired:"bg-yellow-100 text-yellow-800",terminated:"bg-red-100 text-red-800",renewed:"bg-blue-100 text-blue-800"},A={active:"Hiu lc",expired:"Ht hn",terminated:"Chm dt",renewed:" gia hn"};return s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${_[w.status]}`,children:A[w.status]})}},{key:"actions",title:"Thao tc",render:w=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{d(w),u(!0)},children:"Sa"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>p(w.id),children:"Xa"})]})}];return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l hp ng lao ng"}),s.jsx(Lt,{onClick:()=>{d(null),u(!0)},children:"+ Thm hp ng"})]}),s.jsxs(is,{children:[s.jsxs("div",{className:"p-4 border-b flex gap-4",children:[s.jsx(Dt,{placeholder:"Tm kim theo s hp ng...",value:n,onChange:w=>{a(w.target.value),t(1)},className:"max-w-xs"}),s.jsx(Kn,{value:i,onChange:w=>{o(w.target.value),t(1)},options:[{value:"",label:"Tt c trng thi"},{value:"active",label:"ang hiu lc"},{value:"expired",label:"Ht hn"},{value:"terminated",label:" chm dt"},{value:"renewed",label:" gia hn"}],className:"w-48"})]}),s.jsx(Gf,{columns:v,data:h?.data||[],isLoading:y,emptyMessage:"Cha c hp ng no"}),h&&h.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:h.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:c,onClose:()=>u(!1),title:l?"Cp nht hp ng":"Thm hp ng mi",size:"lg",children:s.jsx(b0e,{initialData:l,onSuccess:()=>{u(!1),e.invalidateQueries({queryKey:["contracts"]})},onCancel:()=>u(!1)})}),s.jsx(mc,{isOpen:!!f,onClose:()=>p(null),onConfirm:()=>f&&g.mutate(f),title:"Xc nhn xa",message:"Bn c chc chn mun xa hp ng ny? Hnh ng ny khng th hon tc.",isLoading:g.isPending})]})}const _0e=[{value:"#10B981",label:"Xanh l"},{value:"#3B82F6",label:"Xanh dng"},{value:"#F59E0B",label:"Vng cam"},{value:"#EF4444",label:""},{value:"#8B5CF6",label:"Tm"},{value:"#EC4899",label:"Hng"},{value:"#06B6D4",label:"Cyan"},{value:"#6B7280",label:"Xm"}];function j0e({initialData:e,onSuccess:r,onCancel:t}){const{register:n,handleSubmit:a,watch:i,formState:{errors:o}}=yc({defaultValues:e?{...e,description:e.description??void 0,max_days_per_year:e.max_days_per_year??void 0,default_days:e.default_days??void 0,color:e.color??void 0}:{code:"",name:"",description:"",default_days:0,is_paid:!0,requires_approval:!0,color:"#3B82F6",status:"active"}}),c=i("color"),u=nn({mutationFn:l=>e?Fg.update(e.id,l):Fg.create(l),onSuccess:r});return s.jsxs("form",{onSubmit:a(l=>u.mutate(l)),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"M loi ngh *",...n("code",{required:"Vui lng nhp m"}),error:o.code?.message,disabled:!!e}),s.jsx(Dt,{label:"Tn loi ngh *",...n("name",{required:"Vui lng nhp tn"}),error:o.name?.message})]}),s.jsx(Dt,{label:"M t",...n("description")}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"S ngy mc nh/nm",type:"number",...n("default_days",{valueAsNumber:!0})}),s.jsx(Dt,{label:"S ngy ngh lin tc ti a",type:"number",...n("max_consecutive_days",{valueAsNumber:!0})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"is_paid",...n("is_paid"),className:"rounded"}),s.jsx("label",{htmlFor:"is_paid",children:"C lng"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"requires_approval",...n("requires_approval"),className:"rounded"}),s.jsx("label",{htmlFor:"requires_approval",children:"Cn ph duyt"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mu hin th"}),s.jsx("div",{className:"flex gap-2 flex-wrap",children:_0e.map(l=>s.jsx("label",{className:`w-8 h-8 rounded cursor-pointer border-2 ${c===l.value?"border-gray-800":"border-transparent"}`,style:{backgroundColor:l.value},children:s.jsx("input",{type:"radio",value:l.value,...n("color"),className:"sr-only"})},l.value))})]}),s.jsx(Kn,{label:"Trng thi",...n("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:u.isPending,children:e?"Cp nht":"Thm mi"})]})]})}function N0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(!1),[c,u]=R.useState(null),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["leave-types",r,n],queryFn:()=>Fg.getAll({page:r,pageSize:10,search:n})}),h=nn({mutationFn:Fg.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["leave-types"]}),d(null)}}),y=[{key:"code",title:"M"},{key:"name",title:"Tn loi ngh php"},{key:"color",title:"Mu",render:g=>s.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:g.color??void 0}})},{key:"default_days",title:"S ngy/nm",render:g=>g.default_days||"-"},{key:"is_paid",title:"C lng",render:g=>g.is_paid?"":""},{key:"status",title:"Trng thi",render:g=>s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${g.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.status==="active"?"Hot ng":"Ngng"})},{key:"actions",title:"Thao tc",render:g=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{u(g),o(!0)},children:"Sa"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>d(g.id),children:"Xa"})]})}];return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l loi ngh php"}),s.jsx(Lt,{onClick:()=>{u(null),o(!0)},children:"+ Thm loi ngh php"})]}),s.jsxs(is,{children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx(Dt,{placeholder:"Tm kim theo m hoc tn...",value:n,onChange:g=>{a(g.target.value),t(1)},className:"max-w-md"})}),s.jsx(Gf,{columns:y,data:f?.data||[],isLoading:p,emptyMessage:"Cha c loi ngh php no"}),f&&f.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:f.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:i,onClose:()=>o(!1),title:c?"Cp nht loi ngh php":"Thm loi ngh php",children:s.jsx(j0e,{initialData:c,onSuccess:()=>{o(!1),e.invalidateQueries({queryKey:["leave-types"]})},onCancel:()=>o(!1)})}),s.jsx(mc,{isOpen:!!l,onClose:()=>d(null),onConfirm:()=>l&&h.mutate(l),title:"Xc nhn xa",message:"Bn c chc chn mun xa loi ngh php ny?",isLoading:h.isPending})]})}function k0e({initialData:e,onSuccess:r,onCancel:t}){const{user:n}=xn(),{register:a,handleSubmit:i,watch:o,setValue:c,formState:{errors:u}}=yc({defaultValues:e?{employee_id:e.employee_id||"",leave_type_id:e.leave_type_id||"",start_date:e.start_date||new Date().toISOString().split("T")[0],end_date:e.end_date||new Date().toISOString().split("T")[0],total_days:e.total_days||1,is_half_day:e.is_half_day||!1,reason:e.reason||""}:{employee_id:n?.employee_id||"",leave_type_id:"",start_date:new Date().toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0],total_days:1,is_half_day:!1,reason:""}}),{data:l,isLoading:d}=gr({queryKey:["leave-types-active"],queryFn:Fg.getAllActive}),{data:f,isLoading:p}=gr({queryKey:["employees-active"],queryFn:()=>uc.getAll({page:1,pageSize:1e3,status:"active"})}),h=o("start_date"),y=o("end_date"),g=o("is_half_day");R.useEffect(()=>{if(h&&y){const x=new Date(h),v=new Date(y);let w=Math.ceil((v.getTime()-x.getTime())/(1e3*60*60*24))+1;g&&(w=.5),w>0&&c("total_days",w)}},[h,y,g,c]);const m=nn({mutationFn:x=>e?eg.update(e.id,x):eg.create(x),onSuccess:r});return e&&e.status!=="pending"?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"M n"}),s.jsx("p",{className:"font-medium",children:e.request_number})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Nhn vin"}),s.jsx("p",{className:"font-medium",children:e.employee?.full_name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Loi ngh"}),s.jsx("p",{className:"font-medium",children:e.leave_type?.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"S ngy"}),s.jsxs("p",{className:"font-medium",children:[e.total_days," ngy"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"T ngy"}),s.jsx("p",{className:"font-medium",children:new Date(e.start_date).toLocaleDateString("vi-VN")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"n ngy"}),s.jsx("p",{className:"font-medium",children:new Date(e.end_date).toLocaleDateString("vi-VN")})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"L do"}),s.jsx("p",{className:"font-medium",children:e.reason})]}),e.approval_notes&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Ghi ch ph duyt"}),s.jsx("p",{className:"font-medium",children:e.approval_notes})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(Lt,{variant:"outline",onClick:t,children:"ng"})})]}):d||p?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"text-gray-500",children:"ang ti d liu..."})}):s.jsxs("form",{onSubmit:i(x=>m.mutate(x)),className:"space-y-4",children:[s.jsx(Kn,{label:"Nhn vin *",...a("employee_id",{required:"Vui lng chn nhn vin"}),error:u.employee_id?.message,options:[{value:"",label:"-- Chn nhn vin --"},...(f?.data||[]).map(x=>({value:x.id,label:`${x.code} - ${x.full_name}`}))]}),s.jsx(Kn,{label:"Loi ngh php *",...a("leave_type_id",{required:"Vui lng chn loi ngh"}),error:u.leave_type_id?.message,options:[{value:"",label:"-- Chn loi ngh --"},...(l||[]).map(x=>({value:x.id,label:x.name}))]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"T ngy *",type:"date",...a("start_date",{required:"Vui lng chn ngy bt u"}),error:u.start_date?.message}),s.jsx(Dt,{label:"n ngy *",type:"date",...a("end_date",{required:"Vui lng chn ngy kt thc"}),error:u.end_date?.message})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Tng s ngy ngh",type:"number",step:"0.5",...a("total_days",{valueAsNumber:!0}),disabled:!0}),s.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[s.jsx("input",{type:"checkbox",id:"is_half_day",...a("is_half_day"),className:"rounded"}),s.jsx("label",{htmlFor:"is_half_day",children:"Ngh na ngy"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"L do ngh *"}),s.jsx("textarea",{...a("reason",{required:"Vui lng nhp l do"}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Nhp l do xin ngh php..."}),u.reason&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.reason.message})]}),m.isError&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:["C li xy ra: ",m.error?.message||"Khng th to n ngh php"]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:m.isPending,children:e?"Cp nht":"To n"})]})]})}function S0e(){const e=Is(),{user:r}=xn(),[t,n]=R.useState(1),[a,i]=R.useState(""),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState(null),[p,h]=R.useState(null),[y,g]=R.useState(""),{data:m,isLoading:x}=gr({queryKey:["leave-requests",t,a],queryFn:()=>eg.getAll({page:t,pageSize:10,status:a||void 0})}),v=nn({mutationFn:P=>eg.approve(P,r.id),onSuccess:()=>{e.invalidateQueries({queryKey:["leave-requests"]}),f(null)}}),w=nn({mutationFn:({id:P,reason:B})=>eg.reject(P,r.id,B),onSuccess:()=>{e.invalidateQueries({queryKey:["leave-requests"]}),h(null),g("")}}),_=P=>new Date(P).toLocaleDateString("vi-VN"),A=[{key:"request_number",title:"M n"},{key:"employee",title:"Nhn vin",render:P=>P.employee?.full_name||"-"},{key:"leave_type",title:"Loi ngh",render:P=>s.jsx("span",{className:"px-2 py-1 rounded text-xs text-white",style:{backgroundColor:P.leave_type?.color},children:P.leave_type?.name})},{key:"period",title:"Thi gian",render:P=>s.jsxs("div",{className:"text-sm",children:[s.jsxs("div",{children:[_(P.start_date)," - ",_(P.end_date)]}),s.jsxs("div",{className:"text-gray-500",children:[P.total_days," ngy"]})]})},{key:"status",title:"Trng thi",render:P=>{const B={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"},T={pending:"Ch duyt",approved:" duyt",rejected:"T chi",cancelled:" hy"};return s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${B[P.status]}`,children:T[P.status]})}},{key:"actions",title:"Thao tc",render:P=>s.jsxs("div",{className:"flex gap-2",children:[P.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(Lt,{size:"sm",variant:"primary",onClick:()=>f(P.id),children:"Duyt"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>h(P.id),children:"T chi"})]}),s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{l(P),c(!0)},children:"Chi tit"})]})}];return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l n ngh php"}),s.jsx(Lt,{onClick:()=>{l(null),c(!0)},children:"+ To n ngh php"})]}),s.jsxs(is,{children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx(Kn,{value:a,onChange:P=>{i(P.target.value),n(1)},options:[{value:"",label:"Tt c trng thi"},{value:"pending",label:"Ch duyt"},{value:"approved",label:" duyt"},{value:"rejected",label:"T chi"},{value:"cancelled",label:" hy"}],className:"w-48"})}),s.jsx(Gf,{columns:A,data:m?.data||[],isLoading:x,emptyMessage:"Cha c n ngh php no"}),m&&m.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:t,totalPages:m.totalPages,onPageChange:n})})]}),s.jsx(ji,{isOpen:o,onClose:()=>c(!1),title:u?"Chi tit n ngh php":"To n ngh php",size:"lg",children:s.jsx(k0e,{initialData:u,onSuccess:()=>{c(!1),e.invalidateQueries({queryKey:["leave-requests"]})},onCancel:()=>c(!1)})}),s.jsx(mc,{isOpen:!!d,onClose:()=>f(null),onConfirm:()=>d&&v.mutate(d),title:"Xc nhn duyt",message:"Bn c chc chn mun duyt n ngh php ny?",isLoading:v.isPending}),s.jsx(ji,{isOpen:!!p,onClose:()=>{h(null),g("")},title:"T chi n ngh php",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(Dt,{label:"L do t chi *",value:y,onChange:P=>g(P.target.value),placeholder:"Nhp l do t chi..."}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(Lt,{variant:"outline",onClick:()=>{h(null),g("")},children:"Hy"}),s.jsx(Lt,{variant:"danger",onClick:()=>p&&w.mutate({id:p,reason:y}),disabled:!y,isLoading:w.isPending,children:"T chi"})]})]})})]})}function C0e(){const e=navigator.userAgent||navigator.vendor||window.opera||"",t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(e),n="ontouchstart"in window||navigator.maxTouchPoints>0,a=window.innerWidth<1024;return t||n&&a}function A0e(){const e=navigator.userAgent||"";return/iPad|Android(?!.*Mobile)/i.test(e)?"tablet":/iPhone|Android.*Mobile|webOS|BlackBerry|IEMobile|Opera Mini/i.test(e)||navigator.maxTouchPoints>0&&window.innerWidth<768?"mobile":navigator.maxTouchPoints>0&&window.innerWidth<1024?"tablet":"desktop"}function nT(e,r,t,n){const i=(t-e)*Math.PI/180,o=(n-r)*Math.PI/180,c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function E0e({onGPSReady:e,onStatusChange:r,gpsConfig:t,autoHideOnReady:n=!1,compact:a=!1}){const[i,o]=R.useState("checking"),[c,u]=R.useState(null),[l,d]=R.useState(null),[f,p]=R.useState(""),[h,y]=R.useState(!1),[g,m]=R.useState(null),[x,v]=R.useState(!1),[w,_]=R.useState("desktop"),A=R.useCallback(z=>{o(z),r?.(z)},[r]),P=R.useCallback(z=>{if(!t?.enabled||!t.locations.length)return{valid:!0,distance:0,location_name:"N/A"};for(const L of t.locations){const E=nT(z.latitude,z.longitude,L.latitude,L.longitude);if(E<=L.radius_meters)return{valid:!0,distance:Math.round(E),location_name:L.name}}const O=t.locations.reduce((L,E)=>{const k=nT(z.latitude,z.longitude,E.latitude,E.longitude);return k<L.distance?{distance:k,name:E.name}:L},{distance:1/0,name:""});return{valid:!1,distance:Math.round(O.distance),location_name:O.name}},[t]),B=R.useCallback(z=>{const O={latitude:z.coords.latitude,longitude:z.coords.longitude,accuracy:z.coords.accuracy};u(O);const L=P(O);d(L),L.valid?(A("available"),e?.(O)):A("out_of_range")},[P,A,e]),T=R.useCallback(z=>{switch(z.code){case z.PERMISSION_DENIED:A("denied"),p("Bn  t chi quyn truy cp v tr. Vui lng bt li trong ci t trnh duyt.");break;case z.POSITION_UNAVAILABLE:A("error"),p("Khng th xc nh v tr. Vui lng kim tra GPS thit b.");break;case z.TIMEOUT:A("error"),p("Ht thi gian ch GPS. Vui lng th li.");break;default:A("error"),p("Li GPS khng xc nh. Vui lng th li.")}},[A]),I=R.useCallback(()=>{if(!navigator.geolocation){A("unavailable"),p("Trnh duyt khng h tr GPS. Vui lng s dng Chrome hoc Safari.");return}A("requesting"),navigator.geolocation.getCurrentPosition(B,T,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4});const z=navigator.geolocation.watchPosition(B,T,{enableHighAccuracy:!0,timeout:3e4,maximumAge:1e4});m(z)},[B,T,A]);if(R.useEffect(()=>{const z=C0e(),O=A0e();if(v(!z),_(O),!z){A("desktop_bypass"),e?.(null);return}if(!navigator.geolocation){A("unavailable"),p("Trnh duyt khng h tr nh v GPS.");return}return navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(L=>{L.state==="granted"?I():L.state==="denied"?(A("denied"),p("Quyn GPS  b t chi. Vui lng bt li trong ci t trnh duyt.")):A("checking"),L.onchange=()=>{L.state==="granted"?I():L.state==="denied"&&A("denied")}}).catch(()=>{A("checking")}):A("checking"),()=>{g!==null&&navigator.geolocation.clearWatch(g)}},[]),n&&(i==="available"||i==="desktop_bypass"))return null;if(i==="desktop_bypass")return a?s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-slate-50 text-slate-600",children:[s.jsx(bv,{size:14}),s.jsx("span",{className:"font-medium",children:"My tnh  GPS khng bt buc"})]}):s.jsx("div",{className:"rounded-xl border-2 bg-slate-50 border-slate-200 overflow-hidden",children:s.jsx("div",{className:"px-4 py-3 sm:px-5 sm:py-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:s.jsx(bv,{className:"text-slate-500",size:20})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold text-slate-700",children:"ang dng my tnh"}),s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[s.jsx(Un,{size:10}),"Sn sng"]})]}),s.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"GPS khng bt buc trn my tnh bn. Bn c th check-in ngay."}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:" Nu s dng in thoi, h thng s yu cu bt GPS  xc minh v tr."})]})]})})});if(a)return s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${i==="available"?"bg-green-50 text-green-700":i==="out_of_range"||i==="denied"||i==="unavailable"?"bg-red-50 text-red-700":i==="checking"||i==="requesting"?"bg-blue-50 text-blue-700":"bg-yellow-50 text-yellow-700"}`,children:[i==="available"&&s.jsx(Un,{size:14}),i==="out_of_range"&&s.jsx(SS,{size:14}),(i==="denied"||i==="unavailable")&&s.jsx(ua,{size:14}),(i==="checking"||i==="requesting")&&s.jsx(Mt,{size:14,className:"animate-spin"}),i==="error"&&s.jsx(Kr,{size:14}),s.jsxs("span",{className:"font-medium",children:[i==="available"&&` GPS: ${l?.location_name} (${l?.distance}m)`,i==="out_of_range"&&` Ngoi phm vi (${l?.distance}m)`,i==="denied"&&"GPS b t chi",i==="unavailable"&&"GPS khng kh dng",i==="checking"&&"ang kim tra GPS...",i==="requesting"&&"ang ly v tr...",i==="error"&&"Li GPS"]}),(i==="denied"||i==="error")&&s.jsx("button",{onClick:I,className:"ml-auto p-1 hover:bg-white/50 rounded",title:"Th li",children:s.jsx(Vr,{size:12})})]});const H=(()=>{switch(i){case"available":return{bg:"bg-green-50 border-green-200",icon:s.jsx(Un,{className:"text-green-600",size:24}),title:"GPS  sn sng",titleColor:"text-green-800"};case"out_of_range":return{bg:"bg-red-50 border-red-200",icon:s.jsx(SS,{className:"text-red-600",size:24}),title:"Ngoi khu vc cng ty",titleColor:"text-red-800"};case"denied":return{bg:"bg-red-50 border-red-200",icon:s.jsx(ua,{className:"text-red-600",size:24}),title:"GPS b t chi  Khng th im danh",titleColor:"text-red-800"};case"unavailable":return{bg:"bg-red-50 border-red-200",icon:s.jsx(ua,{className:"text-red-600",size:24}),title:"GPS khng kh dng",titleColor:"text-red-800"};case"error":return{bg:"bg-yellow-50 border-yellow-200",icon:s.jsx(Kr,{className:"text-yellow-600",size:24}),title:"Li GPS",titleColor:"text-yellow-800"};default:return{bg:"bg-blue-50 border-blue-200",icon:s.jsx(pK,{className:"text-blue-600 animate-pulse",size:24}),title:i==="requesting"?"ang ly v tr...":"ang kim tra GPS...",titleColor:"text-blue-800"}}})();return s.jsxs("div",{className:`rounded-xl border-2 ${H.bg} overflow-hidden`,children:[s.jsx("div",{className:"px-4 py-3 sm:px-5 sm:py-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:i==="checking"||i==="requesting"?s.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(Mt,{className:"text-blue-600 animate-spin",size:20})}):s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${i==="available"?"bg-green-100":i==="out_of_range"||i==="denied"||i==="unavailable"?"bg-red-100":"bg-yellow-100"}`,children:H.icon})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("h3",{className:`font-semibold ${H.titleColor}`,children:H.title}),i==="available"&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[s.jsx(Qc,{size:10}),"Xc minh"]}),s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded-full",children:[s.jsx(X2,{size:10}),w==="tablet"?"Tablet":"Di ng"]})]}),s.jsxs("div",{className:"mt-1 text-sm",children:[i==="available"&&l&&s.jsxs("p",{className:"text-green-700",children:["Khu vc: ",s.jsx("strong",{children:l.location_name}),"  Khong cch: ",s.jsxs("strong",{children:[l.distance,"m"]}),c?.accuracy&&s.jsxs("span",{className:"text-green-600 ml-2",children:["(",Math.round(c.accuracy),"m)"]})]}),i==="out_of_range"&&l&&s.jsxs("div",{children:[s.jsxs("p",{className:"text-red-700",children:["Khong cch n ",s.jsx("strong",{children:l.location_name}),": ",s.jsxs("strong",{children:[l.distance,"m"]})]}),s.jsxs("p",{className:"text-red-600 mt-1",children:["Cn  trong phm vi ",s.jsxs("strong",{children:[t?.locations?.[0]?.radius_meters||200,"m"]}),"  check-in."]})]}),(i==="checking"||i==="requesting")&&s.jsx("p",{className:"text-blue-700",children:i==="checking"?"ang kim tra quyn GPS trn thit b di ng...":"ang xc nh v tr. Vui lng ch..."}),i==="denied"&&s.jsx("p",{className:"text-red-700",children:f}),i==="unavailable"&&s.jsx("p",{className:"text-red-700",children:f}),i==="error"&&s.jsx("p",{className:"text-yellow-700",children:f})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[i==="checking"&&s.jsxs("button",{onClick:I,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[s.jsx(dc,{size:16}),"Cho php truy cp GPS"]}),(i==="error"||i==="out_of_range")&&s.jsxs("button",{onClick:I,className:`inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors shadow-sm ${i==="error"?"bg-yellow-600 text-white hover:bg-yellow-700":"bg-red-600 text-white hover:bg-red-700"}`,children:[s.jsx(Vr,{size:16}),"Th li"]}),(i==="denied"||i==="unavailable"||i==="error"||i==="checking")&&s.jsxs("button",{onClick:()=>y(!h),className:"inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-white/60 rounded-lg transition-colors",children:[h?s.jsx(si,{size:14}):s.jsx(Gs,{size:14}),"Hng dn bt GPS"]})]})]})]})}),h&&s.jsxs("div",{className:"border-t border-gray-200 bg-white/60 px-4 py-4 sm:px-5",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 font-medium text-gray-800",children:[s.jsx(X2,{size:16}),"Hng dn bt GPS trn in thoi"]}),s.jsxs("ol",{className:"text-sm text-gray-600 space-y-1.5 ml-6 list-decimal",children:[s.jsxs("li",{children:["M ",s.jsx("strong",{children:"Ci t"})," in thoi"]}),s.jsxs("li",{children:["Vo ",s.jsx("strong",{children:"Quyn ring t"}),"  ",s.jsx("strong",{children:"V tr / Location"})]}),s.jsxs("li",{children:["Bt ",s.jsx("strong",{children:"Dch v v tr"})," (Location Services)"]}),s.jsxs("li",{children:["Quay li trnh duyt v ",s.jsx("strong",{children:"ti li trang"})]}),s.jsxs("li",{children:["Nhn ",s.jsx("strong",{children:'"Cho php"'})," khi trnh duyt hi"]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-amber-800",children:[s.jsx("strong",{children:" Lu :"})," GPS bt buc trn in thoi/tablet  xc minh v tr. Nu dng ",s.jsx("strong",{children:"my tnh bn"}),", h thng s t ng b qua bc ny."]})})]}),i!=="available"&&i!=="checking"&&i!=="requesting"&&s.jsx("div",{className:"px-4 py-2 bg-gray-800 text-white text-center text-sm",children:s.jsxs("span",{className:"inline-flex items-center gap-2",children:[s.jsx(X2,{size:14,className:"text-yellow-400"}),s.jsx("strong",{children:"Thit b di ng:"})," Bt buc bt GPS v  trong khu vc cng ty mi c im danh"]})})]})}function sT(e){return e.substring(0,5)}function aT(e){return new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function U_(e){const r=Math.floor(e/60),t=e%60;return`${r}h ${t.toString().padStart(2,"0")}p`}function T0e(){const{user:e}=xn(),r=Is(),t=e?.employee_id,[n,a]=R.useState("checking"),[i,o]=R.useState(null),[c,u]=R.useState(0),l=R.useRef(null),{data:d}=gr({queryKey:["gps-config"],queryFn:async()=>{const{data:z,error:O}=await se.from("attendance_settings").select("setting_value").eq("setting_key","gps_config").maybeSingle();return O||!z?null:z.setting_value},staleTime:300*1e3}),{data:f,isLoading:p}=gr({queryKey:["today-shift",t],queryFn:async()=>{if(!t)return null;const z=new Date().toISOString().split("T")[0],{data:O,error:L}=await se.from("shift_assignments").select(`
          shift_id,
          shift:shifts!shift_assignments_shift_id_fkey(
            id, code, name, start_time, end_time,
            crosses_midnight, standard_hours, break_minutes
          )
        `).eq("employee_id",t).eq("date",z).maybeSingle();return L||!O?.shift?null:Array.isArray(O.shift)?O.shift[0]:O.shift},enabled:!!t}),{data:h,isLoading:y}=gr({queryKey:["today-attendance",t],queryFn:async()=>t?D_.getTodayAttendance(t):null,enabled:!!t,refetchInterval:6e4});R.useEffect(()=>{if(h?.check_in_time&&!h.check_out_time){const z=new Date(h.check_in_time),O=()=>{u(Math.floor((new Date().getTime()-z.getTime())/(1e3*60)))};return O(),l.current=setInterval(O,6e4),()=>{l.current&&clearInterval(l.current)}}else u(0)},[h]);const g=nn({mutationFn:async()=>{if(!t)throw new Error("Khng tm thy thng tin nhn vin");return D_.checkIn(t,i?{latitude:i.latitude,longitude:i.longitude}:void 0)},onSuccess:()=>{r.invalidateQueries({queryKey:["today-attendance"]})}}),m=nn({mutationFn:async()=>{if(!t)throw new Error("Khng tm thy thng tin nhn vin");return D_.checkOut(t,i?{latitude:i.latitude,longitude:i.longitude}:void 0)},onSuccess:()=>{r.invalidateQueries({queryKey:["today-attendance"]})}}),x=R.useCallback(z=>{o(z)},[]),v=R.useCallback(z=>{a(z)},[]),w=!!h?.check_in_time,_=!!h?.check_out_time,A=w&&_,P=n==="available"||n==="desktop_bypass",B=P&&!w,T=w&&!_,U=(()=>{if(!f||!w||A)return 0;const z=f.standard_hours*60;return Math.min(100,Math.round(c/z*100))})(),H=p||y;return t?s.jsxs("div",{className:"space-y-4",children:[!A&&s.jsx(E0e,{gpsConfig:d,onGPSReady:x,onStatusChange:v,autoHideOnReady:!1,compact:w}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-5 py-4 bg-gradient-to-r from-blue-600 to-blue-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:s.jsx(Xr,{className:"text-white",size:20})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chm cng hm nay"}),s.jsx("p",{className:"text-blue-100 text-sm",children:new Date().toLocaleDateString("vi-VN",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]})]}),h&&s.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${h.status==="present"?"bg-green-500/20 text-green-100":h.status==="late"?"bg-yellow-500/20 text-yellow-100":h.status==="early_leave"?"bg-orange-500/20 text-orange-100":"bg-white/20 text-white"}`,children:[h.status==="present"&&" ng gi",h.status==="late"&&` Tr ${h.late_minutes}p`,h.status==="early_leave"&&` V sm ${h.early_leave_minutes}p`,h.status==="absent"&&" Vng"]})]})}),s.jsx("div",{className:"p-5",children:H?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(Mt,{className:"animate-spin text-blue-500",size:24}),s.jsx("span",{className:"ml-2 text-gray-500",children:"ang ti..."})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx(dn,{className:"text-gray-400",size:18}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Ca lm vic: "}),f?s.jsxs("span",{className:"font-medium text-gray-800",children:[f.name," (",sT(f.start_time)," - ",sT(f.end_time),")"]}):s.jsx("span",{className:"text-orange-600 font-medium",children:" Cha c phn ca"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:`p-3 rounded-lg border ${w?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(kS,{size:14,className:w?"text-green-600":"text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium",children:"Check-in"})]}),s.jsx("p",{className:`text-lg font-semibold ${w?"text-green-700":"text-gray-400"}`,children:w?aT(h.check_in_time):"::"}),w&&s.jsx("span",{className:`inline-flex items-center gap-1 text-xs mt-1 ${h.is_gps_verified?"text-green-600":"text-slate-500"}`,children:h.is_gps_verified?s.jsxs(s.Fragment,{children:[s.jsx(dc,{size:10})," GPS "]}):s.jsxs(s.Fragment,{children:[s.jsx(bv,{size:10})," Desktop"]})})]}),s.jsxs("div",{className:`p-3 rounded-lg border ${_?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(J5,{size:14,className:_?"text-blue-600":"text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500 uppercase font-medium",children:"Check-out"})]}),s.jsx("p",{className:`text-lg font-semibold ${_?"text-blue-700":"text-gray-400"}`,children:_?aT(h.check_out_time):"::"})]})]}),w&&!_&&f&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xm,{size:14,className:"text-blue-600"}),s.jsxs("span",{className:"font-medium text-gray-700",children:[" lm: ",U_(c)]})]}),s.jsxs("span",{className:"text-gray-500",children:["/ ",f.standard_hours,"h (",U,"%)"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:s.jsx("div",{className:`h-2.5 rounded-full transition-all duration-500 ${U>=100?"bg-green-500":U>=75?"bg-blue-500":U>=50?"bg-blue-400":"bg-blue-300"}`,style:{width:`${Math.min(U,100)}%`}})})]}),A&&h&&s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Gi lm: "}),s.jsx("span",{className:"font-semibold text-gray-800",children:U_(h.working_minutes||0)})]}),(h.overtime_minutes||0)>0&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Tng ca: "}),s.jsx("span",{className:"font-semibold text-orange-600",children:U_(h.overtime_minutes||0)})]})]})}),(g.isError||m.isError)&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-700 text-sm",children:[s.jsx(Cr,{size:16}),s.jsx("span",{children:g.error?.message||m.error?.message||" xy ra li"})]})}),s.jsxs("div",{className:"pt-2",children:[!w&&s.jsxs("button",{onClick:()=>g.mutate(),disabled:!B||g.isPending,className:`w-full flex items-center justify-center gap-2 px-6 py-3 rounded-lg text-base font-semibold transition-all ${B?"bg-green-600 text-white hover:bg-green-700 shadow-lg shadow-green-200 active:scale-[0.98]":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[g.isPending?s.jsx(Mt,{size:20,className:"animate-spin"}):s.jsx(kS,{size:20}),g.isPending?"ang x l...":"Check-in"]}),T&&s.jsxs("button",{onClick:()=>m.mutate(),disabled:m.isPending,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg text-base font-semibold hover:bg-blue-700 shadow-lg shadow-blue-200 active:scale-[0.98] transition-all",children:[m.isPending?s.jsx(Mt,{size:20,className:"animate-spin"}):s.jsx(J5,{size:20}),m.isPending?"ang x l...":"Check-out"]}),A&&s.jsxs("div",{className:"flex items-center justify-center gap-2 py-3 text-green-700",children:[s.jsx(Un,{size:20}),s.jsx("span",{className:"font-semibold",children:" hon thnh ca hm nay"})]}),!w&&!P&&s.jsx("p",{className:"text-center text-sm text-red-500 mt-2",children:" Vui lng bt GPS trn in thoi v di chuyn n khu vc cng ty"})]})]})})]})]}):null}function iT(e){return e?new Date(e).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):""}function oT(e){if(!e||e<=0)return"";const r=Math.floor(e/60),t=e%60;return r===0?`${t}p`:`${r}h${t>0?` ${String(t).padStart(2,"0")}p`:""}`}function P0e(e){switch(e){case"present":return{label:"ng gi",color:"bg-green-100 text-green-700"};case"late":return{label:"i tr",color:"bg-yellow-100 text-yellow-700"};case"early_leave":return{label:"V sm",color:"bg-orange-100 text-orange-700"};case"absent":return{label:"Vng",color:"bg-red-100 text-red-700"};default:return{label:e,color:"bg-gray-100 text-gray-600"}}}function O0e({isVerified:e,isAutoCheckout:r,hasCoords:t}){return r?s.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-orange-100 text-orange-700 text-xs font-medium rounded",title:"T ng checkout",children:s.jsx(PO,{size:10})}):e||t?s.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded",title:"GPS  xc minh",children:[s.jsx(dc,{size:10}),s.jsx("span",{className:"text-[10px]",children:""})]}):s.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-slate-100 text-slate-500 text-xs font-medium rounded",title:"Desktop / Khng GPS",children:s.jsx(bv,{size:10})})}function M0e(){const{user:e}=xn(),r=e?.role==="admin",t=e?.role==="admin"||e?.role==="manager"||e?.is_manager,a=(e?.position_level||7)<=3,i=r||a||t,[o,c]=R.useState(1),[u]=R.useState(20),[l,d]=R.useState(""),[f,p]=R.useState("all"),[h,y]=R.useState("all"),[g,m]=R.useState(""),[x,v]=R.useState(!i),[w,_]=R.useState(()=>{const N=new Date;return N.setDate(1),N.toISOString().split("T")[0]}),[A,P]=R.useState(()=>new Date().toISOString().split("T")[0]),{data:B}=gr({queryKey:["departments-attendance-filter"],queryFn:async()=>{const{data:N,error:S}=await se.from("departments").select("id, code, name").eq("status","active").order("name");if(S)throw S;return N||[]},enabled:i}),T=B||[],{data:I}=gr({queryKey:["shifts-options"],queryFn:async()=>{const{data:N,error:S}=await se.from("shifts").select("id, code, name").eq("is_active",!0).order("name");if(S)throw S;return N||[]}}),U=I||[],{data:H,isLoading:z}=gr({queryKey:["attendance-list-v3",o,u,f,h,w,A,g,x,e?.employee_id],queryFn:async()=>{const N=(o-1)*u,S=N+u-1;let C=se.from("attendance").select(`
          *,
          employee:employees!attendance_employee_id_fkey(
            id, code, full_name, department_id,
            department:departments!employees_department_id_fkey(id, name, code)
          ),
          shift:shifts(
            id, code, name, start_time, end_time
          )
        `,{count:"exact"});(x||!r&&!a&&!t)&&(C=C.eq("employee_id",e?.employee_id||"")),f!=="all"&&(C=C.eq("status",f)),w&&(C=C.gte("date",w)),A&&(C=C.lte("date",A)),h!=="all"&&h!=="none"&&(C=C.eq("shift_id",h)),h==="none"&&(C=C.is("shift_id",null));const{data:D,error:q,count:M}=await C.order("date",{ascending:!1}).order("check_in_time",{ascending:!1}).range(N,S);if(q)throw q;let G=D||[];if(!x&&g&&(G=G.filter(X=>(Array.isArray(X.employee?.department)?(X.employee?.department)[0]:X.employee?.department)?.id===g)),!x&&t&&!a&&!r&&!g){const X=e?.department_id;X&&(G=G.filter(re=>(Array.isArray(re.employee?.department)?(re.employee?.department)[0]:re.employee?.department)?.id===X))}if(l.trim()){const X=l.toLowerCase().trim();G=G.filter(re=>re.employee?.full_name?.toLowerCase().includes(X)||re.employee?.code?.toLowerCase().includes(X))}return{data:G,total:M||0,page:o,pageSize:u,totalPages:Math.ceil((M||0)/u)}},enabled:!!e?.employee_id}),O=H?.data||[],L=H?.totalPages||1,E=H?.total||0,k=R.useMemo(()=>x?"Chm cng ca ti":r||a?"Tt c nhn vin":t?"Phng ban ca bn":"Chm cng ca bn",[x,r,a,t]);return s.jsxs("div",{className:"p-4 lg:p-6 max-w-[1500px] mx-auto space-y-5",children:[s.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bng chm cng"}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:k})]})}),s.jsx(T0e,{}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsxs("button",{onClick:()=>{v(N=>!N),c(1)},className:`inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium transition-all border
              ${x?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}
            `,title:x?"ang xem chm cng ca ti":"Bm  xem chm cng ca ti",children:[s.jsx(ls,{size:15}),"Ca ti"]}),i&&!x&&s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx($r,{size:15,className:"text-gray-400"}),s.jsxs("select",{value:g,onChange:N=>{m(N.target.value),c(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),T.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id))]})]}),i&&!x&&s.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:15}),s.jsx("input",{type:"text",placeholder:"Tm nhn vin...",value:l,onChange:N=>d(N.target.value),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(dn,{size:15,className:"text-gray-400"}),s.jsx("input",{type:"date",value:w,onChange:N=>{_(N.target.value),c(1)},className:"px-2.5 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"text-gray-400 text-xs",children:""}),s.jsx("input",{type:"date",value:A,onChange:N=>{P(N.target.value),c(1)},className:"px-2.5 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("select",{value:f,onChange:N=>{p(N.target.value),c(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c trng thi"}),s.jsx("option",{value:"present",children:"ng gi"}),s.jsx("option",{value:"late",children:"i tr"}),s.jsx("option",{value:"early_leave",children:"V sm"}),s.jsx("option",{value:"absent",children:"Vng"})]}),s.jsxs("select",{value:h,onChange:N=>{y(N.target.value),c(1)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c ca"}),U.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id)),s.jsx("option",{value:"none",children:"Khng c ca"})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[s.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Ngy"}),i&&!x&&s.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Nhn vin"}),s.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Ca"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Check-in"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Check-out"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Gi lm"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Tr"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"V sm"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"OT"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"GPS"}),s.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-600 whitespace-nowrap",children:"Trng thi"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:z?s.jsx("tr",{children:s.jsx("td",{colSpan:11,className:"text-center py-16",children:s.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-500",children:[s.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full"}),"ang ti d liu..."]})})}):O.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:11,className:"text-center py-16 text-gray-400",children:"Khng c d liu chm cng trong khong thi gian ny"})}):O.map(N=>{const S=P0e(N.status),C=Array.isArray(N.shift)?N.shift[0]:N.shift,D=Array.isArray(N.employee?.department)?(N.employee?.department)[0]:N.employee?.department,q=N.check_in_lat!=null&&N.check_in_lng!=null;return s.jsxs("tr",{className:"hover:bg-gray-50/70 transition-colors",children:[s.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:s.jsx("span",{className:"font-medium text-gray-800 text-xs",children:new Date(N.date+"T00:00:00").toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit"})})}),i&&!x&&s.jsx("td",{className:"px-4 py-2.5",children:s.jsxs("div",{className:"min-w-[140px]",children:[s.jsx("p",{className:"font-medium text-gray-800 text-xs truncate",children:N.employee?.full_name||""}),s.jsxs("p",{className:"text-[10px] text-gray-400 truncate",children:[N.employee?.code,D?.name?`  ${D.name}`:""]})]})}),s.jsx("td",{className:"px-4 py-2.5",children:C?s.jsxs("div",{className:"min-w-[90px]",children:[s.jsx("p",{className:"font-medium text-gray-700 text-xs",children:C.name}),s.jsxs("p",{className:"text-[10px] text-gray-400",children:[C.start_time?.substring(0,5)," - ",C.end_time?.substring(0,5)]})]}):s.jsx("span",{className:"text-xs text-gray-300",children:""})}),s.jsx("td",{className:"px-4 py-2.5 text-center whitespace-nowrap",children:s.jsx("span",{className:N.status==="late"?"text-yellow-600 font-medium text-xs":"text-gray-700 text-xs",children:iT(N.check_in_time)})}),s.jsx("td",{className:"px-4 py-2.5 text-center whitespace-nowrap",children:s.jsxs("div",{className:"inline-flex items-center gap-1",children:[s.jsx("span",{className:N.status==="early_leave"?"text-orange-600 font-medium text-xs":"text-gray-700 text-xs",children:iT(N.check_out_time)}),N.auto_checkout&&s.jsx("span",{title:"T ng checkout",children:s.jsx(PO,{size:11,className:"text-orange-500"})})]})}),s.jsx("td",{className:"px-4 py-2.5 text-center whitespace-nowrap",children:s.jsx("span",{className:"font-medium text-gray-700 text-xs",children:oT(N.working_minutes)})}),s.jsx("td",{className:"px-4 py-2.5 text-center",children:N.late_minutes>0?s.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-yellow-100 text-yellow-700 text-[11px] font-medium rounded",children:[s.jsx(Kr,{size:9}),N.late_minutes,"p"]}):s.jsx("span",{className:"text-gray-300 text-xs",children:""})}),s.jsx("td",{className:"px-4 py-2.5 text-center",children:N.early_leave_minutes>0?s.jsxs("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-orange-100 text-orange-700 text-[11px] font-medium rounded",children:[N.early_leave_minutes,"p"]}):s.jsx("span",{className:"text-gray-300 text-xs",children:""})}),s.jsx("td",{className:"px-4 py-2.5 text-center",children:(N.overtime_minutes||0)>0?s.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-purple-100 text-purple-700 text-[11px] font-medium rounded",children:oT(N.overtime_minutes)}):s.jsx("span",{className:"text-gray-300 text-xs",children:""})}),s.jsx("td",{className:"px-4 py-2.5 text-center",children:s.jsx(O0e,{isVerified:N.is_gps_verified,isAutoCheckout:N.auto_checkout,hasCoords:q})}),s.jsx("td",{className:"px-4 py-2.5 text-center",children:s.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-[11px] font-medium rounded ${S.color}`,children:S.label})})]},N.id)})})]})}),s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-gray-50/50",children:[s.jsx("p",{className:"text-xs text-gray-500",children:E>0?`Trang ${o}/${L}  ${E} bn ghi`:"Khng c bn ghi"}),L>1&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>c(N=>Math.max(1,N-1)),disabled:o<=1,className:"p-1.5 rounded-lg border border-gray-300 hover:bg-white disabled:opacity-40 disabled:cursor-not-allowed",children:s.jsx(su,{size:15})}),Array.from({length:Math.min(5,L)},(N,S)=>{const D=Math.max(1,Math.min(o-2,L-4))+S;return D>L?null:s.jsx("button",{onClick:()=>c(D),className:`w-8 h-8 text-xs font-medium rounded-lg transition-colors
                      ${D===o?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}
                    `,children:D},D)}),s.jsx("button",{onClick:()=>c(N=>Math.min(L,N+1)),disabled:o>=L,className:"p-1.5 rounded-lg border border-gray-300 hover:bg-white disabled:opacity-40 disabled:cursor-not-allowed",children:s.jsx(Ks,{size:15})})]})]})]})]})}function I0e({initialData:e,onSuccess:r,onCancel:t}){const{register:n,handleSubmit:a,formState:{errors:i}}=yc({defaultValues:e?{...e,min_salary:e.min_salary??void 0,max_salary:e.max_salary??void 0,description:e.description??void 0}:{code:"",name:"",level:1,min_salary:0,max_salary:0,base_salary:0,allowance_rate:0,description:"",status:"active"}}),o=nn({mutationFn:c=>e?vb.update(e.id,c):vb.create(c),onSuccess:r});return s.jsxs("form",{onSubmit:a(c=>o.mutate(c)),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"M bc lng *",...n("code",{required:"Vui lng nhp m"}),error:i.code?.message,disabled:!!e}),s.jsx(Dt,{label:"Tn bc lng *",...n("name",{required:"Vui lng nhp tn"}),error:i.name?.message})]}),s.jsx(Dt,{label:"Cp bc *",type:"number",...n("level",{required:!0,valueAsNumber:!0}),error:i.level?.message}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(Dt,{label:"Lng ti thiu *",type:"number",...n("min_salary",{required:!0,valueAsNumber:!0})}),s.jsx(Dt,{label:"Lng ti a *",type:"number",...n("max_salary",{required:!0,valueAsNumber:!0})}),s.jsx(Dt,{label:"Lng c bn",type:"number",...n("base_salary",{valueAsNumber:!0})})]}),s.jsx(Dt,{label:"T l ph cp (%)",type:"number",step:"0.01",...n("allowance_rate",{valueAsNumber:!0})}),s.jsx(Dt,{label:"M t",...n("description")}),s.jsx(Kn,{label:"Trng thi",...n("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),o.isError&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:["C li xy ra: ",o.error?.message||"Khng th lu bc lng"]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:o.isPending,children:e?"Cp nht":"Thm mi"})]})]})}function R0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(""),[c,u]=R.useState(!1),[l,d]=R.useState(null),[f,p]=R.useState(null),{data:h,isLoading:y}=gr({queryKey:["salary-grades",r,n,i],queryFn:()=>vb.getAll({page:r,pageSize:10,search:n||void 0,status:i||void 0})}),g=nn({mutationFn:vb.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["salary-grades"]}),p(null)}}),m=x=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(x);return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l bc lng"}),s.jsx(Lt,{onClick:()=>{d(null),u(!0)},children:"+ Thm bc lng"})]}),s.jsxs(is,{children:[s.jsxs("div",{className:"p-4 border-b flex gap-4",children:[s.jsx(Dt,{placeholder:"Tm kim...",value:n,onChange:x=>{a(x.target.value),t(1)},className:"w-64"}),s.jsx(Kn,{value:i,onChange:x=>{o(x.target.value),t(1)},options:[{value:"",label:"Tt c trng thi"},{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}],className:"w-48"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn bc lng"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Cp"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Lng ti thiu"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Lng ti a"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Lng c bn"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:y?s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):h?.data?.length?h.data.map(x=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm",children:x.code}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:x.name}),s.jsx("td",{className:"px-4 py-3 text-sm",children:x.level}),s.jsx("td",{className:"px-4 py-3 text-sm",children:m(x.min_salary??0)}),s.jsx("td",{className:"px-4 py-3 text-sm",children:m(x.max_salary??0)}),s.jsx("td",{className:"px-4 py-3 text-sm",children:x.base_salary?m(x.base_salary):"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${x.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:x.status==="active"?"Hot ng":"Ngng"})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{d(x),u(!0)},children:"Sa"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>p(x.id),children:"Xa"})]})})]},x.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"Cha c bc lng no"})})})]})}),h&&h.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:h.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:c,onClose:()=>u(!1),title:l?"Cp nht bc lng":"Thm bc lng mi",children:s.jsx(I0e,{initialData:l,onSuccess:()=>{u(!1),e.invalidateQueries({queryKey:["salary-grades"]})},onCancel:()=>u(!1)})}),s.jsx(mc,{isOpen:!!f,onClose:()=>p(null),onConfirm:()=>f&&g.mutate(f),title:"Xc nhn xa",message:"Bn c chc chn mun xa bc lng ny?",isLoading:g.isPending})]})}function L0e({initialData:e,onSuccess:r,onCancel:t}){const{user:n}=xn(),a=new Date,i=a.getFullYear(),o=a.getMonth()+1,c=(h,y)=>new Date(h,y,0).getDate(),{register:u,handleSubmit:l,formState:{errors:d}}=yc({defaultValues:e?{code:e.code,name:e.name,year:e.year,month:e.month,start_date:e.start_date,end_date:e.end_date,payment_date:e.payment_date||"",notes:e.notes||""}:{code:`KL${i}-${String(o).padStart(2,"0")}`,name:`K lng thng ${String(o).padStart(2,"0")}/${i}`,year:i,month:o,start_date:`${i}-${String(o).padStart(2,"0")}-01`,end_date:`${i}-${String(o).padStart(2,"0")}-${c(i,o)}`,payment_date:"",notes:""}}),f=nn({mutationFn:h=>e?Ef.updatePeriod(e.id,h):Ef.createPeriod(h,n?.employee_id||""),onSuccess:r}),p=h=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(h);return e?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"M k"}),s.jsx("p",{className:"font-medium",children:e.code})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Tn k"}),s.jsx("p",{className:"font-medium",children:e.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Thng/Nm"}),s.jsxs("p",{className:"font-medium",children:[String(e.month).padStart(2,"0"),"/",e.year]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"S nhn vin"}),s.jsx("p",{className:"font-medium",children:e.total_employees})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Tng lng"}),s.jsx("p",{className:"font-medium text-green-600",children:p(e.total_amount??0)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Trng thi"}),s.jsx("p",{className:"font-medium capitalize",children:e.status})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"T ngy"}),s.jsx("p",{className:"font-medium",children:new Date(e.start_date).toLocaleDateString("vi-VN")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"n ngy"}),s.jsx("p",{className:"font-medium",children:new Date(e.end_date).toLocaleDateString("vi-VN")})]})]}),e.notes&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Ghi ch"}),s.jsx("p",{className:"font-medium",children:e.notes})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(Lt,{variant:"outline",onClick:t,children:"ng"})})]}):s.jsxs("form",{onSubmit:l(h=>f.mutate(h)),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"M k lng *",...u("code",{required:"Vui lng nhp m"}),error:d.code?.message}),s.jsx(Dt,{label:"Tn k lng *",...u("name",{required:"Vui lng nhp tn"}),error:d.name?.message})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"Nm *",type:"number",...u("year",{required:!0,valueAsNumber:!0})}),s.jsx(Dt,{label:"Thng *",type:"number",min:1,max:12,...u("month",{required:!0,valueAsNumber:!0})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"T ngy *",type:"date",...u("start_date",{required:!0})}),s.jsx(Dt,{label:"n ngy *",type:"date",...u("end_date",{required:!0})})]}),s.jsx(Dt,{label:"Ngy tr lng",type:"date",...u("payment_date")}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),s.jsx("textarea",{...u("notes"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"})]}),f.isError&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:["C li xy ra: ",f.error?.message||"Khng th to k lng"]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:f.isPending,children:"To k lng"})]})]})}const lT={draft:{label:"Nhp",color:"bg-gray-100 text-gray-800"},processing:{label:"ang x l",color:"bg-yellow-100 text-yellow-800"},confirmed:{label:" xc nhn",color:"bg-green-100 text-green-800"},paid:{label:" tr",color:"bg-blue-100 text-blue-800"}};function D0e(){const{user:e}=xn(),r=Is(),[t,n]=R.useState(1),[a,i]=R.useState(new Date().getFullYear()),[o,c]=R.useState(""),[u,l]=R.useState(!1),[d,f]=R.useState(null),[p,h]=R.useState(null),{data:y,isLoading:g}=gr({queryKey:["payroll-periods",t,a,o],queryFn:()=>Ef.getPeriods({page:t,pageSize:10,year:a,status:o||void 0})}),m=nn({mutationFn:Ef.generatePayslips,onSuccess:_=>{alert(` to ${_} phiu lng`),r.invalidateQueries({queryKey:["payroll-periods"]}),h(null)},onError:_=>{alert(`Li: ${_.message}`),h(null)}}),x=nn({mutationFn:_=>Ef.confirmPeriod(_,e?.employee_id||""),onSuccess:()=>{r.invalidateQueries({queryKey:["payroll-periods"]})}}),v=_=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(_),w=Array.from({length:5},(_,A)=>{const P=new Date().getFullYear()-A;return{value:P.toString(),label:P.toString()}});return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Qun l k lng"}),s.jsx(Lt,{onClick:()=>{f(null),l(!0)},children:"+ To k lng"})]}),s.jsxs(is,{children:[s.jsxs("div",{className:"p-4 border-b flex gap-4",children:[s.jsx(Kn,{value:a.toString(),onChange:_=>{i(parseInt(_.target.value)),n(1)},options:w,className:"w-32"}),s.jsx(Kn,{value:o,onChange:_=>{c(_.target.value),n(1)},options:[{value:"",label:"Tt c trng thi"},{value:"draft",label:"Nhp"},{value:"processing",label:"ang x l"},{value:"confirmed",label:" xc nhn"},{value:"paid",label:" tr"}],className:"w-48"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M k"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn k lng"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Thng/Nm"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"S NV"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tng lng"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:g?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):y?.data?.length?y.data.map(_=>{const A=lT[_.status]||lT.draft;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:_.code}),s.jsx("td",{className:"px-4 py-3 text-sm",children:_.name}),s.jsxs("td",{className:"px-4 py-3 text-sm",children:[String(_.month).padStart(2,"0"),"/",_.year]}),s.jsx("td",{className:"px-4 py-3 text-sm",children:_.total_employees}),s.jsx("td",{className:"px-4 py-3 text-sm",children:v(_.total_amount??0)}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${A.color}`,children:A.label})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsxs("div",{className:"flex gap-1",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{f(_),l(!0)},children:"Chi tit"}),_.status==="draft"&&s.jsx(Lt,{size:"sm",onClick:()=>h(_.id),children:"To phiu"}),_.status==="processing"&&s.jsx(Lt,{size:"sm",variant:"primary",onClick:()=>x.mutate(_.id),disabled:x.isPending,children:"Xc nhn"})]})})]},_.id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"Cha c k lng no"})})})]})}),y&&y.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:t,totalPages:y.totalPages,onPageChange:n})})]}),s.jsx(ji,{isOpen:u,onClose:()=>l(!1),title:d?"Chi tit k lng":"To k lng mi",children:s.jsx(L0e,{initialData:d,onSuccess:()=>{l(!1),r.invalidateQueries({queryKey:["payroll-periods"]})},onCancel:()=>l(!1)})}),s.jsx(mc,{isOpen:!!p,onClose:()=>h(null),onConfirm:()=>p&&m.mutate(p),title:"To phiu lng",message:"H thng s to phiu lng cho tt c nhn vin ang hot ng. Tip tc?",isLoading:m.isPending})]})}function F0e({payslipId:e,onClose:r}){const{data:t,isLoading:n}=gr({queryKey:["payslip",e],queryFn:()=>Ef.getPayslipById(e)}),a=i=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(i);return n?s.jsx("div",{className:"p-4 text-center",children:"ang ti..."}):t?s.jsxs("div",{className:"space-y-6",children:[s.jsxs(is,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-3 text-gray-700",children:"Thng tin nhn vin"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"M NV:"}),s.jsx("span",{className:"ml-2 font-medium",children:t.employee_code})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"H tn:"}),s.jsx("span",{className:"ml-2 font-medium",children:t.employee_name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Phng ban:"}),s.jsx("span",{className:"ml-2",children:t.department_name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Chc v:"}),s.jsx("span",{className:"ml-2",children:t.position_name||"-"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Bc lng:"}),s.jsx("span",{className:"ml-2",children:t.salary_grade_name||"-"})]})]})]}),s.jsxs(is,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-3 text-gray-700",children:"Ngy cng"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ngy cng chun:"}),s.jsx("span",{className:"ml-2 font-medium",children:t.working_days})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ngy cng thc t:"}),s.jsx("span",{className:"ml-2 font-medium",children:t.actual_days})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ngy ngh php:"}),s.jsx("span",{className:"ml-2",children:t.leave_days})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ngh khng lng:"}),s.jsx("span",{className:"ml-2",children:t.unpaid_leave_days})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Gi tng ca:"}),s.jsx("span",{className:"ml-2",children:t.overtime_hours})]})]})]}),s.jsxs(is,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-3 text-green-600",children:"Thu nhp"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lng c bn"}),s.jsx("span",{className:"font-medium",children:a(t.base_salary)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Ph cp"}),s.jsx("span",{children:a(t.allowances)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Tin tng ca"}),s.jsx("span",{children:a(t.overtime_pay)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Thng"}),s.jsx("span",{children:a(t.bonus)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Thu nhp khc"}),s.jsx("span",{children:a(t.other_income)})]}),s.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[s.jsx("span",{children:"Tng thu nhp"}),s.jsx("span",{className:"text-green-600",children:a(t.gross_salary)})]})]})]}),s.jsxs(is,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-3 text-red-600",children:"Khu tr"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"BHXH (8%)"}),s.jsx("span",{children:a(t.social_insurance)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"BHYT (1.5%)"}),s.jsx("span",{children:a(t.health_insurance)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"BHTN (1%)"}),s.jsx("span",{children:a(t.unemployment_insurance)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Thu TNCN"}),s.jsx("span",{children:a(t.personal_income_tax)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Khu tr khc"}),s.jsx("span",{children:a(t.other_deductions)})]}),s.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[s.jsx("span",{children:"Tng khu tr"}),s.jsx("span",{className:"text-red-600",children:a(t.total_deductions)})]})]})]}),s.jsx(is,{className:"p-4 bg-blue-50",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-lg font-semibold",children:"THC LNH"}),s.jsx("span",{className:"text-2xl font-bold text-blue-600",children:a(t.net_salary)})]})}),s.jsx("div",{className:"flex justify-end",children:s.jsx(Lt,{variant:"outline",onClick:r,children:"ng"})})]}):s.jsx("div",{className:"p-4 text-center",children:"Khng tm thy phiu lng"})}const cT={draft:{label:"Nhp",color:"bg-gray-100 text-gray-800"},confirmed:{label:" xc nhn",color:"bg-green-100 text-green-800"},paid:{label:" tr",color:"bg-blue-100 text-blue-800"}};function B0e(){const[e,r]=R.useState(1),[t,n]=R.useState(""),[a,i]=R.useState(""),[o,c]=R.useState(null),{data:u,isLoading:l}=gr({queryKey:["payslips",e,t,a],queryFn:()=>Ef.getPayslips({page:e,pageSize:10,search:t||void 0,status:a||void 0})}),d=f=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(f);return s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"flex justify-between items-center mb-6",children:s.jsx("h1",{className:"text-2xl font-bold",children:"Phiu lng"})}),s.jsxs(is,{children:[s.jsxs("div",{className:"p-4 border-b flex gap-4",children:[s.jsx(Dt,{placeholder:"Tm kim m phiu, tn NV...",value:t,onChange:f=>{n(f.target.value),r(1)},className:"w-64"}),s.jsx(Kn,{value:a,onChange:f=>{i(f.target.value),r(1)},options:[{value:"",label:"Tt c trng thi"},{value:"draft",label:"Nhp"},{value:"confirmed",label:" xc nhn"},{value:"paid",label:" tr"}],className:"w-48"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M phiu"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Phng ban"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"K lng"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Tng thu nhp"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Khu tr"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Thc lnh"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"TT"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:l?s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):u?.data?.length?u.data.map(f=>{const p=cT[f.status]||cT.draft;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:f.payslip_number}),s.jsxs("td",{className:"px-4 py-3 text-sm",children:[f.employee_code," - ",f.employee_name]}),s.jsx("td",{className:"px-4 py-3 text-sm",children:f.department_name||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:f.payroll_period?.name||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-right",children:d(f.gross_salary)}),s.jsxs("td",{className:"px-4 py-3 text-sm text-right text-red-600",children:["-",d(f.total_deductions)]}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-green-600",children:d(f.net_salary)}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${p.color}`,children:p.label})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>c(f),children:"Xem"})})]},f.id)}):s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"Cha c phiu lng no"})})})]})}),u&&u.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:e,totalPages:u.totalPages,onPageChange:r})})]}),s.jsx(ji,{isOpen:!!o,onClose:()=>c(null),title:`Phiu lng: ${o?.payslip_number||""}`,size:"lg",children:o&&s.jsx(F0e,{payslipId:o.id,onClose:()=>c(null)})})]})}function $0e(e){return e?{code:e.code??"",name:e.name??"",description:e.description??"",category:e.category??"work_quality",weight:e.weight??20,max_score:e.max_score??5,is_required:e.is_required??!0,status:e.status??"active",sort_order:e.sort_order??0}:{code:"",name:"",description:"",category:"work_quality",weight:20,max_score:5,is_required:!0,status:"active",sort_order:0}}function q0e({initialData:e,onSuccess:r,onCancel:t}){const{register:n,handleSubmit:a,formState:{errors:i}}=yc({defaultValues:$0e(e)}),o=nn({mutationFn:c=>e?Sm.updateCriteria(e.id,c):Sm.createCriteria(c),onSuccess:r});return s.jsxs("form",{onSubmit:a(c=>o.mutate(c)),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"M tiu ch *",...n("code",{required:"Vui lng nhp m"}),error:i.code?.message,disabled:!!e}),s.jsx(Kn,{label:"Nhm",...n("category"),options:[{value:"work_quality",label:"Cht lng cng vic"},{value:"attitude",label:"Thi  lm vic"},{value:"skill",label:"K nng"},{value:"teamwork",label:"Lm vic nhm"},{value:"initiative",label:"Sng kin"}]})]}),s.jsx(Dt,{label:"Tn tiu ch *",...n("name",{required:"Vui lng nhp tn"}),error:i.name?.message}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{...n("description"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(Dt,{label:"Trng s (%) *",type:"number",...n("weight",{required:!0,valueAsNumber:!0})}),s.jsx(Dt,{label:"im ti a",type:"number",...n("max_score",{valueAsNumber:!0})}),s.jsx(Dt,{label:"Th t",type:"number",...n("sort_order",{valueAsNumber:!0})})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",...n("is_required"),className:"rounded border-gray-300"}),s.jsx("span",{className:"text-sm",children:"Bt buc"})]})}),s.jsx(Kn,{label:"Trng thi",...n("status"),options:[{value:"active",label:"Hot ng"},{value:"inactive",label:"Ngng hot ng"}]}),o.isError&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:["C li xy ra: ",o.error?.message||"Khng th lu tiu ch"]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:o.isPending,children:e?"Cp nht":"Thm mi"})]})]})}const z0e={work_quality:"Cht lng cng vic",attitude:"Thi  lm vic",skill:"K nng",teamwork:"Lm vic nhm",initiative:"Sng kin"};function U0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(!1),[c,u]=R.useState(null),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["performance-criteria",r,n],queryFn:()=>Sm.getCriteria({page:r,pageSize:10,search:n||void 0})}),h=nn({mutationFn:Sm.deleteCriteria,onSuccess:()=>{e.invalidateQueries({queryKey:["performance-criteria"]}),d(null)}});return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Tiu ch nh gi"}),s.jsx(Lt,{onClick:()=>{u(null),o(!0)},children:"+ Thm tiu ch"})]}),s.jsxs(is,{children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx(Dt,{placeholder:"Tm kim...",value:n,onChange:y=>{a(y.target.value),t(1)},className:"w-64"})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Tn tiu ch"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhm"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Trng s"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"im ti a"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:p?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):f?.data?.length?f.data.map(y=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:y.code}),s.jsx("td",{className:"px-4 py-3 text-sm",children:y.name}),s.jsx("td",{className:"px-4 py-3 text-sm",children:z0e[y.category||""]||y.category||"-"}),s.jsxs("td",{className:"px-4 py-3 text-sm",children:[y.weight,"%"]}),s.jsx("td",{className:"px-4 py-3 text-sm",children:y.max_score}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${y.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:y.status==="active"?"Hot ng":"Ngng"})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>{u(y),o(!0)},children:"Sa"}),s.jsx(Lt,{size:"sm",variant:"danger",onClick:()=>d(y.id),children:"Xa"})]})})]},y.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"Cha c tiu ch no"})})})]})}),f&&f.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:f.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:i,onClose:()=>o(!1),title:c?"Cp nht tiu ch":"Thm tiu ch mi",children:s.jsx(q0e,{initialData:c,onSuccess:()=>{o(!1),e.invalidateQueries({queryKey:["performance-criteria"]})},onCancel:()=>o(!1)})}),s.jsx(mc,{isOpen:!!l,onClose:()=>d(null),onConfirm:()=>l&&h.mutate(l),title:"Xc nhn xa",message:"Bn c chc chn mun xa tiu ch ny?",isLoading:h.isPending})]})}const H0e={A:"bg-green-500 text-white",B:"bg-blue-500 text-white",C:"bg-yellow-500 text-white",D:"bg-orange-500 text-white",E:"bg-red-500 text-white"};function V0e(e){const r=new Date().getFullYear(),t=Math.ceil((new Date().getMonth()+1)/3);return e?{employee_id:e.employee_id??"",reviewer_id:e.reviewer_id??"",review_period:e.review_period??"",period_type:e.period_type??"quarterly",start_date:e.start_date??"",end_date:e.end_date??"",strengths:e.strengths??"",weaknesses:e.weaknesses??"",goals:e.goals??"",reviewer_comments:e.reviewer_comments??""}:{employee_id:"",reviewer_id:"",review_period:`Q${t}-${r}`,period_type:"quarterly",start_date:"",end_date:"",strengths:"",weaknesses:"",goals:"",reviewer_comments:""}}function uT(e){try{return new Date(e).toLocaleDateString("vi-VN")}catch{return e}}function W0e({initialData:e,onSuccess:r,onCancel:t}){const{register:n,handleSubmit:a,formState:{errors:i}}=yc({defaultValues:V0e(e)}),{data:o}=gr({queryKey:["employees-active"],queryFn:()=>uc.getAll({page:1,pageSize:1e3,status:"active"})}),c=nn({mutationFn:d=>Sm.createReview(d),onSuccess:r}),u=d=>{c.mutate(d)};if(e)return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Nhn vin"}),s.jsxs("p",{className:"font-medium",children:[e.employee?.code," - ",e.employee?.full_name]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"K nh gi"}),s.jsx("p",{className:"font-medium",children:e.review_period})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"im tng"}),s.jsx("p",{className:"font-medium text-lg",children:e.total_score!=null?e.total_score.toFixed(1):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Xp loi"}),e.grade?s.jsx("span",{className:`inline-block px-3 py-1 rounded text-sm font-bold ${H0e[e.grade]||""}`,children:e.grade}):s.jsx("p",{children:"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"T ngy"}),s.jsx("p",{className:"font-medium",children:uT(e.start_date)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"n ngy"}),s.jsx("p",{className:"font-medium",children:uT(e.end_date)})]})]}),e.scores&&e.scores.length>0&&s.jsxs(is,{className:"p-4",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Chi tit im"}),s.jsx("div",{className:"space-y-2",children:e.scores.map(d=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:d.criteria?.name||"N/A"}),s.jsxs("span",{className:"font-medium",children:[d.score,"/",d.criteria?.max_score||0]})]},d.id))})]}),e.strengths&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"im mnh"}),s.jsx("p",{className:"p-2 bg-green-50 rounded",children:e.strengths})]}),e.weaknesses&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"im cn ci thin"}),s.jsx("p",{className:"p-2 bg-yellow-50 rounded",children:e.weaknesses})]}),e.goals&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Mc tiu k ti"}),s.jsx("p",{className:"p-2 bg-blue-50 rounded",children:e.goals})]}),e.reviewer_comments&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Nhn xt ca qun l"}),s.jsx("p",{className:"p-2 bg-gray-50 rounded",children:e.reviewer_comments})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(Lt,{variant:"outline",onClick:t,children:"ng"})})]});const l=[{value:"",label:"-- Chn nhn vin --"},...(o?.data||[]).map(d=>({value:d.id,label:`${d.code} - ${d.full_name}`}))];return s.jsxs("form",{onSubmit:a(u),className:"space-y-4",children:[s.jsx(Kn,{label:"Nhn vin *",...n("employee_id",{required:"Vui lng chn nhn vin"}),error:i.employee_id?.message,options:l}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"K nh gi *",placeholder:"VD: Q1-2026",...n("review_period",{required:"Vui lng nhp k"}),error:i.review_period?.message}),s.jsx(Kn,{label:"Loi k",...n("period_type"),options:[{value:"quarterly",label:"Theo qu"},{value:"yearly",label:"Theo nm"}]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Dt,{label:"T ngy *",type:"date",...n("start_date",{required:"Vui lng chn ngy bt u"}),error:i.start_date?.message}),s.jsx(Dt,{label:"n ngy *",type:"date",...n("end_date",{required:"Vui lng chn ngy kt thc"}),error:i.end_date?.message})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im mnh"}),s.jsx("textarea",{...n("strengths"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Nhp im mnh ca nhn vin..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"im cn ci thin"}),s.jsx("textarea",{...n("weaknesses"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Nhp im cn ci thin..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mc tiu k ti"}),s.jsx("textarea",{...n("goals"),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Nhp mc tiu cho k nh gi tip theo..."})]}),c.isError&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:["C li xy ra: ",c.error?.message||"Khng th to nh gi"]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(Lt,{type:"button",variant:"outline",onClick:t,children:"Hy"}),s.jsx(Lt,{type:"submit",isLoading:c.isPending,children:"To nh gi"})]})]})}const dT={draft:{label:"Nhp",color:"bg-gray-100 text-gray-800"},submitted:{label:" np",color:"bg-yellow-100 text-yellow-800"},reviewed:{label:" nh gi",color:"bg-green-100 text-green-800"},acknowledged:{label:"NV xc nhn",color:"bg-blue-100 text-blue-800"}},K0e={A:"bg-green-500 text-white",B:"bg-blue-500 text-white",C:"bg-yellow-500 text-white",D:"bg-orange-500 text-white",E:"bg-red-500 text-white"};function G0e(){const e=Is(),[r,t]=R.useState(1),[n,a]=R.useState(""),[i,o]=R.useState(""),[c,u]=R.useState(!1),[l,d]=R.useState(null),{data:f,isLoading:p}=gr({queryKey:["performance-reviews",r,n,i],queryFn:()=>Sm.getReviews({page:r,pageSize:10,period:n||void 0,status:i||void 0})}),h=f?.data||[],y=_=>{a(_.target.value),t(1)},g=_=>{o(_.target.value),t(1)},m=()=>{d(null),u(!0)},x=_=>{d(_),u(!0)},v=()=>{u(!1),e.invalidateQueries({queryKey:["performance-reviews"]})},w=()=>{u(!1)};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"nh gi hiu sut"}),s.jsx(Lt,{onClick:m,children:"+ To nh gi"})]}),s.jsxs(is,{children:[s.jsxs("div",{className:"p-4 border-b flex gap-4",children:[s.jsx("div",{className:"w-48",children:s.jsx(Dt,{placeholder:"K nh gi (VD: Q1-2026)",value:n,onChange:y})}),s.jsx("div",{className:"w-48",children:s.jsx(Kn,{value:i,onChange:g,options:[{value:"",label:"Tt c trng thi"},{value:"draft",label:"Nhp"},{value:"submitted",label:" np"},{value:"reviewed",label:" nh gi"},{value:"acknowledged",label:"NV xc nhn"}]})})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"M nh gi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Nhn vin"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"K nh gi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"im"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Xp loi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:p?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"ang ti..."})}):h.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"Cha c nh gi no"})}):s.jsx(s.Fragment,{children:h.map(_=>{const A=dT[_.status||"draft"]||dT.draft;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:_.review_code||"-"}),s.jsxs("td",{className:"px-4 py-3 text-sm",children:[_.employee?.code," - ",_.employee?.full_name]}),s.jsx("td",{className:"px-4 py-3 text-sm",children:_.review_period}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:_.total_score!=null?_.total_score.toFixed(1):"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:_.grade?s.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${K0e[_.grade]||""}`,children:_.grade}):"-"}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`px-2 py-1 rounded text-xs ${A.color}`,children:A.label})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx(Lt,{size:"sm",variant:"outline",onClick:()=>x(_),children:"Chi tit"})})]},_.id)})})})]})}),f&&f.totalPages>1&&s.jsx("div",{className:"p-4 border-t",children:s.jsx(El,{currentPage:r,totalPages:f.totalPages,onPageChange:t})})]}),s.jsx(ji,{isOpen:c,onClose:w,title:l?`nh gi: ${l.review_code||"N/A"}`:"To nh gi mi",size:"lg",children:s.jsx(W0e,{initialData:l,onSuccess:v,onCancel:w})})]})}const nh={search:"",status:[],priority:[],assignee_id:null,department_id:null,due_date_from:null,due_date_to:null,created_date_from:null,created_date_to:null,tags:[]},hT=[{value:"draft",label:"Nhp",color:"bg-gray-100 text-gray-600"},{value:"in_progress",label:"ang thc hin",color:"bg-blue-100 text-blue-700"},{value:"paused",label:"Tm dng",color:"bg-yellow-100 text-yellow-700"},{value:"finished",label:"Hon thnh",color:"bg-green-100 text-green-700"},{value:"cancelled",label:" hy",color:"bg-red-100 text-red-700"}],fT=[{value:"low",label:"Thp",color:"bg-gray-100 text-gray-700"},{value:"medium",label:"Trung bnh",color:"bg-blue-100 text-blue-700"},{value:"high",label:"Cao",color:"bg-orange-100 text-orange-700"},{value:"urgent",label:"Khn cp",color:"bg-red-100 text-red-700"}],X0e=({value:e=nh,onChange:r,employees:t=[],departments:n=[],availableTags:a=[],isLoading:i=!1,compact:o=!1,className:c="",disableDepartmentFilter:u=!1})=>{const l={search:e?.search??"",status:e?.status??[],priority:e?.priority??[],assignee_id:e?.assignee_id??null,department_id:e?.department_id??null,due_date_from:e?.due_date_from??null,due_date_to:e?.due_date_to??null,created_date_from:e?.created_date_from??null,created_date_to:e?.created_date_to??null,tags:e?.tags??[]},[d,f]=R.useState(!o),[p,h]=R.useState(l.search);R.useEffect(()=>{const w=setTimeout(()=>{p!==l.search&&(console.log(" [TaskFilters] Search changed:",p),r({...l,search:p}))},300);return()=>clearTimeout(w)},[p]),R.useEffect(()=>{h(l.search)},[l.search]);const y=[l.status.length>0,l.priority.length>0,l.assignee_id,!u&&l.department_id,l.due_date_from||l.due_date_to,l.created_date_from||l.created_date_to,l.tags.length>0].filter(Boolean).length,g=(w,_)=>{const A=l[w],P=A.includes(_)?A.filter(B=>B!==_):[...A,_];console.log(` [TaskFilters] Toggle ${w}:`,_,"",P),r({...l,[w]:P})},m=(w,_)=>{console.log(` [TaskFilters] Change ${w}:`,_),r({...l,[w]:_||null})},x=()=>{console.log(" [TaskFilters] Clear all filters"),r(nh),h("")},v=y>0||l.search;return s.jsxs("div",{className:`bg-white rounded-lg border border-gray-200 ${c}`,children:[s.jsxs("div",{className:"p-4 flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),s.jsx("input",{type:"text",value:p,onChange:w=>h(w.target.value),placeholder:"Tm kim cng vic...",disabled:i,className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),p&&s.jsx("button",{onClick:()=>{h(""),r({...l,search:""})},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(Br,{size:16})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>f(!d),className:`
              flex items-center gap-2 px-4 py-2.5 rounded-lg border transition-colors
              ${d?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}
            `,children:[s.jsx(Al,{size:18}),s.jsx("span",{children:"B lc"}),y>0&&s.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium bg-blue-600 text-white rounded-full",children:y}),d?s.jsx(si,{size:16}):s.jsx(Gs,{size:16})]}),v&&s.jsxs("button",{onClick:x,className:"flex items-center gap-1 px-3 py-2.5 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[s.jsx(Br,{size:16}),s.jsx("span",{className:"hidden sm:inline",children:"Xa lc"})]})]})]}),d&&s.jsxs("div",{className:"px-4 pb-4 border-t border-gray-100 pt-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trng thi"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:hT.map(w=>s.jsx("button",{onClick:()=>g("status",w.value),className:`
                      px-3 py-1.5 text-sm rounded-full transition-all
                      ${l.status.includes(w.value)?`${w.color} ring-2 ring-offset-1 ring-blue-500`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}
                    `,children:w.label},w.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mc  u tin"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:fT.map(w=>s.jsx("button",{onClick:()=>g("priority",w.value),className:`
                      px-3 py-1.5 text-sm rounded-full transition-all
                      ${l.priority.includes(w.value)?`${w.color} ring-2 ring-offset-1 ring-blue-500`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}
                    `,children:w.label},w.value))})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Phng ban",u&&s.jsxs("span",{className:"ml-2 inline-flex items-center gap-1 text-xs text-blue-600 font-normal",children:[s.jsx(da,{size:12}),"Gii hn theo quyn"]})]}),s.jsxs("select",{value:l.department_id||"",onChange:w=>m("department_id",w.target.value),disabled:u,className:`
                  w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500
                  ${u?"bg-gray-100 text-gray-500 cursor-not-allowed":"bg-white"}
                `,children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),n.map(w=>s.jsx("option",{value:w.id,children:w.name},w.id))]}),u&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Bn ch xem c cng vic trong phng ban ca mnh"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngi thc hin"}),s.jsxs("select",{value:l.assignee_id||"",onChange:w=>m("assignee_id",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[s.jsx("option",{value:"",children:"Tt c nhn vin"}),t.map(w=>s.jsx("option",{value:w.id,children:w.full_name},w.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngy ht hn"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",value:l.due_date_from||"",onChange:w=>m("due_date_from",w.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("input",{type:"date",value:l.due_date_to||"",onChange:w=>m("due_date_to",w.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngy to"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",value:l.created_date_from||"",onChange:w=>m("created_date_from",w.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("input",{type:"date",value:l.created_date_to||"",onChange:w=>m("created_date_to",w.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),a.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhn (Tags)"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(w=>s.jsxs("button",{onClick:()=>g("tags",w),className:`
                      px-3 py-1.5 text-sm rounded-full transition-all
                      ${l.tags.includes(w)?"bg-blue-100 text-blue-700 ring-2 ring-offset-1 ring-blue-500":"bg-gray-100 text-gray-600 hover:bg-gray-200"}
                    `,children:["#",w]},w))})]}),s.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lc nhanh"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(R0,{label:"Qu hn",icon:"",active:!1,onClick:()=>{const w=new Date,_=new Date(w);_.setDate(w.getDate()-1);const A=_.toISOString().split("T")[0];r({...nh,due_date_to:A,status:["draft","in_progress","paused"]})}}),s.jsx(R0,{label:"n hn hm nay",icon:"",active:!1,onClick:()=>{const w=new Date().toISOString().split("T")[0];r({...nh,due_date_from:w,due_date_to:w})}}),s.jsx(R0,{label:"Tun ny",icon:"",active:!1,onClick:()=>{const w=new Date,_=new Date(w);_.setDate(w.getDate()-w.getDay()+1);const A=new Date(_);A.setDate(_.getDate()+6),r({...nh,due_date_from:_.toISOString().split("T")[0],due_date_to:A.toISOString().split("T")[0]})}}),s.jsx(R0,{label:"ang thc hin",icon:"",active:l.status.includes("in_progress"),onClick:()=>r({...nh,status:["in_progress"]})}),s.jsx(R0,{label:"u tin cao",icon:"",active:l.priority.includes("high")||l.priority.includes("urgent"),onClick:()=>r({...nh,priority:["high","urgent"]})})]})]})]}),!d&&v&&s.jsxs("div",{className:"px-4 pb-3 flex flex-wrap gap-2",children:[l.status.map(w=>s.jsx(L0,{label:hT.find(_=>_.value===w)?.label||w,onRemove:()=>g("status",w)},w)),l.priority.map(w=>s.jsx(L0,{label:fT.find(_=>_.value===w)?.label||w,onRemove:()=>g("priority",w)},w)),!u&&l.department_id&&s.jsx(L0,{label:n.find(w=>w.id===l.department_id)?.name||"Phng ban",onRemove:()=>m("department_id",null)}),l.assignee_id&&s.jsx(L0,{label:t.find(w=>w.id===l.assignee_id)?.full_name||"Nhn vin",onRemove:()=>m("assignee_id",null)}),(l.due_date_from||l.due_date_to)&&s.jsx(L0,{label:`Hn: ${l.due_date_from||"..."}  ${l.due_date_to||"..."}`,onRemove:()=>r({...l,due_date_from:null,due_date_to:null})})]})]})};function R0({label:e,icon:r,active:t,onClick:n}){return s.jsxs("button",{onClick:n,className:`
        flex items-center gap-1.5 px-3 py-1.5 text-sm rounded-lg transition-all
        ${t?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
      `,children:[s.jsx("span",{children:r}),s.jsx("span",{children:e})]})}function L0({label:e,onRemove:r}){return s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:[e,s.jsx("button",{onClick:r,className:"hover:text-blue-900",children:s.jsx(Br,{size:12})})]})}const Y0e={draft:{label:"Bn nhp",color:"text-gray-700",bg:"bg-gray-100 border border-gray-300"},in_progress:{label:"ang thc hin",color:"text-blue-700",bg:"bg-blue-100"},paused:{label:"Tm dng",color:"text-yellow-700",bg:"bg-yellow-100"},finished:{label:"Hon thnh",color:"text-green-700",bg:"bg-green-100"},cancelled:{label:" hy",color:"text-red-700",bg:"bg-red-100"},pending:{label:"Ch x l",color:"text-gray-700",bg:"bg-gray-100"},new:{label:"Mi",color:"text-purple-700",bg:"bg-purple-100"},completed:{label:"Hon thnh",color:"text-green-700",bg:"bg-green-100"},pending_review:{label:"Ch nh gi",color:"text-orange-700",bg:"bg-orange-100"},on_hold:{label:"Tm dng",color:"text-yellow-700",bg:"bg-yellow-100"}};function eF({status:e}){const r=Y0e[e];return r?s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${r.bg} ${r.color}`,children:[s.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${e==="draft"?"bg-gray-400":e==="in_progress"?"bg-blue-500":e==="paused"||e==="on_hold"?"bg-yellow-500":e==="finished"||e==="completed"?"bg-green-500":e==="cancelled"?"bg-red-500":e==="pending_review"?"bg-orange-500":"bg-gray-400"}`}),r.label]}):s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-gray-400"}),e]})}const pT={low:{label:"Thp",icon:"",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-300"},medium:{label:"Trung bnh",icon:"",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-300"},high:{label:"Cao",icon:"",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-300"},urgent:{label:"Khn cp",icon:"",bgColor:"bg-red-100",textColor:"text-red-700",borderColor:"border-red-300"}},mT={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-1 text-sm",lg:"px-3 py-1.5 text-base"},tF=({priority:e,size:r="md",showIcon:t=!0,showLabel:n=!0,className:a=""})=>{const i=pT[e]||pT.medium,o=mT[r]||mT.md;return s.jsxs("span",{className:`
        inline-flex items-center gap-1
        font-medium rounded-full
        ${i.bgColor}
        ${i.textColor}
        ${o}
        ${a}
      `.trim().replace(/\s+/g," "),children:[t&&s.jsx("span",{children:i.icon}),n&&s.jsx("span",{children:i.label})]})};async function Q0e(e){const{data:r,error:t}=await se.from("tasks").select("id, status").eq("parent_task_id",e);if(t)throw t;const n=r||[];return{total:n.length,completed:n.filter(a=>a.status==="completed").length}}function Z0e({taskId:e,showZero:r=!1,size:t="sm"}){const{data:n,isLoading:a}=gr({queryKey:["subtask-count",e],queryFn:()=>Q0e(e),enabled:!!e,staleTime:3e4});if(!a&&(!n||n.total===0)&&!r)return null;const i=t==="sm"?"text-xs px-1.5 py-0.5 gap-1":"text-sm px-2 py-1 gap-1.5",o=t==="sm"?"w-3 h-3":"w-4 h-4";if(a)return s.jsx("span",{className:`inline-flex items-center ${i} bg-gray-100 text-gray-400 rounded-full`,children:s.jsx(Mt,{className:`${o} animate-spin`})});if(!n||n.total===0)return s.jsxs("span",{className:`inline-flex items-center ${i} bg-gray-100 text-gray-400 rounded-full`,children:[s.jsx(jS,{className:o}),s.jsx("span",{children:"0"})]});const c=n.completed/n.total;let u="bg-purple-100",l="text-purple-700";return c===1?(u="bg-green-100",l="text-green-700"):c>=.5&&(u="bg-blue-100",l="text-blue-700"),s.jsxs("span",{className:`inline-flex items-center ${i} ${u} ${l} rounded-full font-medium`,title:`${n.completed}/${n.total} cng vic con hon thnh`,children:[s.jsx(jS,{className:o}),s.jsxs("span",{children:[n.completed,"/",n.total]})]})}const J0e={draft:"#9ca3af",in_progress:"#3b82f6",paused:"#8b5cf6",finished:"#22c55e",cancelled:"#ef4444"},ege={draft:"Nhp",in_progress:"ang lm",paused:"Tm dng",finished:"Hon thnh",cancelled:" hy"},tge={urgent:"#ef4444",high:"#f97316",medium:"#3b82f6",low:"#6b7280"},rge={urgent:"Khn cp",high:"Cao",medium:"Trung bnh",low:"Thp"};function nge(e,r){if(!e||r==="finished"||r==="cancelled")return!1;const t=new Date(e);return t.setHours(23,59,59,999),t<new Date}function sge(e){const r=new Date(e),n=new Date().getTime()-r.getTime();return Math.ceil(n/(1e3*60*60*24))}async function age(e){console.log(" [taskStatsService] getOverviewStats:",e);try{let r=se.from("tasks").select(`
        id,
        code,
        name,
        status,
        priority,
        due_date,
        department_id,
        assignee_id,
        evaluation_status,
        department:departments(id, name)
      `).gte("created_at",e.from_date).lte("created_at",e.to_date+"T23:59:59");e.department_id&&e.department_id!=="all"&&(r=r.eq("department_id",e.department_id));const{data:t,error:n}=await r;if(n)throw n;if(!t||t.length===0)return{data:{total_tasks:0,completed:0,in_progress:0,pending:0,on_hold:0,cancelled:0,overdue:0,approved:0,completion_rate:0,average_score:0,by_department:[],by_status:[],by_priority:[]},error:null};const a=t.map(I=>I.id),{data:i}=await se.from("task_approvals").select("task_id, approved_score").in("task_id",a).eq("action","approved"),o=new Map;i?.forEach(I=>{I.approved_score&&o.set(I.task_id,I.approved_score)});let c=0,u=0,l=0,d=0,f=0,p=0,h=0,y=0,g=0;const m=new Map,x={},v={};t.forEach(I=>{const U=Array.isArray(I.department)?I.department[0]:I.department,H=U?.id||"unknown",z=U?.name||"Khng xc nh";m.has(H)||m.set(H,{id:H,name:z,total:0,completed:0,in_progress:0,pending:0,on_hold:0,cancelled:0,overdue:0,scores:[]});const O=m.get(H);switch(O.total++,x[I.status]=(x[I.status]||0)+1,v[I.priority]=(v[I.priority]||0)+1,I.status){case"finished":c++,O.completed++;break;case"in_progress":u++,O.in_progress++;break;case"draft":l++,O.pending++;break;case"paused":d++,O.on_hold++;break;case"cancelled":f++,O.cancelled++;break}nge(I.due_date,I.status)&&(p++,O.overdue++),I.evaluation_status==="approved"&&h++;const L=o.get(I.id);L&&(y+=L,g++,O.scores.push(L))});const w=Array.from(m.values()).map(I=>({department_id:I.id,department_name:I.name,total_tasks:I.total,completed:I.completed,in_progress:I.in_progress,pending:I.pending,on_hold:I.on_hold,cancelled:I.cancelled,overdue:I.overdue,completion_rate:I.total>0?Math.round(I.completed/I.total*100):0,average_score:I.scores.length>0?Math.round(I.scores.reduce((U,H)=>U+H,0)/I.scores.length):0})).sort((I,U)=>U.total_tasks-I.total_tasks),_=Object.entries(x).map(([I,U])=>({status:ege[I]||I,count:U,color:J0e[I]||"#6b7280"})),A=Object.entries(v).map(([I,U])=>({priority:rge[I]||I,count:U,color:tge[I]||"#6b7280"})),P=t.length,B=P>0?Math.round(c/P*100):0,T=g>0?Math.round(y/g):0;return console.log(" [taskStatsService] Stats calculated:",{total_tasks:P,completed:c,in_progress:u,pending:l,on_hold:d,overdue:p,approved:h}),{data:{total_tasks:P,completed:c,in_progress:u,pending:l,on_hold:d,cancelled:f,overdue:p,approved:h,completion_rate:B,average_score:T,by_department:w,by_status:_,by_priority:A},error:null}}catch(r){return console.error(" [taskStatsService] getOverviewStats error:",r),{data:null,error:r}}}async function ige(e,r=5){console.log(" [taskStatsService] getTopEmployees:",e);try{let t=se.from("tasks").select(`
        assignee_id,
        assignee:employees!tasks_assignee_id_fkey(id, full_name, department:departments(name))
      `).eq("status","finished").gte("created_at",e.from_date).lte("created_at",e.to_date+"T23:59:59");e.department_id&&e.department_id!=="all"&&(t=t.eq("department_id",e.department_id));const{data:n,error:a}=await t;if(a)throw a;const i=new Map;return n?.forEach(c=>{const u=Array.isArray(c.assignee)?c.assignee[0]:c.assignee;if(!u)return;const l=u.id,d=Array.isArray(u.department)?u.department[0]:u.department;i.has(l)||i.set(l,{id:l,name:u.full_name,department:d?.name||"",count:0}),i.get(l).count++}),{data:Array.from(i.values()).sort((c,u)=>u.count-c.count).slice(0,r).map(c=>({employee_id:c.id,employee_name:c.name,department_name:c.department,completed_count:c.count,average_score:0})),error:null}}catch(t){return console.error(" [taskStatsService] getTopEmployees error:",t),{data:[],error:t}}}async function oge(e,r=10){console.log(" [taskStatsService] getOverdueTasks:",e);try{const t=new Date().toISOString().split("T")[0];let n=se.from("tasks").select(`
        id,
        code,
        name,
        due_date,
        assignee:employees!tasks_assignee_id_fkey(full_name),
        department:departments(name)
      `).lt("due_date",t).not("status","in",'("finished","cancelled")').gte("created_at",e.from_date).lte("created_at",e.to_date+"T23:59:59").order("due_date",{ascending:!0}).limit(r);e.department_id&&e.department_id!=="all"&&(n=n.eq("department_id",e.department_id));const{data:a,error:i}=await n;if(i)throw i;return{data:(a||[]).map(c=>{const u=Array.isArray(c.assignee)?c.assignee[0]:c.assignee,l=Array.isArray(c.department)?c.department[0]:c.department;return{id:c.id,code:c.code,name:c.name,assignee_name:u?.full_name||"Cha giao",department_name:l?.name||"",due_date:c.due_date,days_overdue:sge(c.due_date)}}),error:null}}catch(t){return console.error(" [taskStatsService] getOverdueTasks error:",t),{data:[],error:t}}}const lge={getOverviewStats:age,getTopEmployees:ige,getOverdueTasks:oge},H_={finished:"#22c55e",in_progress:"#3b82f6",overdue:"#dc2626"},Ex=["#22c55e","#3b82f6","#f59e0b","#8b5cf6","#ef4444"];function i4(e=0){const r=new Date,t=r.getFullYear(),n=r.getMonth()-e,a=new Date(t,n,1),i=new Date(t,n+1,0);return{from:a.toISOString().split("T")[0],to:i.toISOString().split("T")[0]}}function cge(){const e=new Date,r=Math.floor(e.getMonth()/3),t=e.getFullYear(),n=r*3,a=new Date(t,n,1),i=new Date(t,n+3,0);return{from:a.toISOString().split("T")[0],to:i.toISOString().split("T")[0]}}function uge(){const e=new Date().getFullYear();return{from:`${e}-01-01`,to:`${e}-12-31`}}function gT(e){return new Date(e).toLocaleDateString("vi-VN")}function rF(e){return e>=90?{label:"Xut sc",color:"text-emerald-600"}:e>=70?{label:"Tt",color:"text-blue-600"}:e>=50?{label:"Kh",color:"text-yellow-600"}:{label:"Cn ci thin",color:"text-red-600"}}const qp=({icon:e,label:r,value:t,subValue:n,color:a,bgColor:i})=>s.jsx("div",{className:`${i} rounded-xl p-4 border border-gray-100`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2.5 rounded-lg bg-white shadow-sm ${a}`,children:e}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 truncate",children:r}),s.jsx("p",{className:`text-2xl font-bold ${a}`,children:t}),n&&s.jsx("p",{className:"text-xs text-gray-500",children:n})]})]})}),dge=({active:e,onSelect:r})=>{const t=[{key:"this_month",label:"Thng ny",getRange:()=>i4(0)},{key:"last_month",label:"Thng trc",getRange:()=>i4(1)},{key:"this_quarter",label:"Qu ny",getRange:cge},{key:"this_year",label:"Nm nay",getRange:uge}];return s.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(n=>s.jsx("button",{onClick:()=>r(n.key,n.getRange()),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${e===n.key?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:n.label},n.key))})},hge=({data:e,onDepartmentClick:r})=>e.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Khng c d liu"}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Tng"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Hon thnh"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"ang lm"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Qu hn"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"T l HT"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"im TB"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map(t=>{const n=rF(t.average_score);return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>r?.(t.department_id),children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($r,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"font-medium text-gray-900",children:t.department_name})]})}),s.jsx("td",{className:"px-4 py-3 text-center font-semibold text-gray-700",children:t.total_tasks}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("span",{className:"text-green-600 font-medium",children:t.completed})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("span",{className:"text-blue-600 font-medium",children:t.in_progress})}),s.jsx("td",{className:"px-4 py-3 text-center",children:t.overdue>0?s.jsxs("span",{className:"inline-flex items-center gap-1 text-red-600 font-medium",children:[s.jsx(Kr,{className:"w-3.5 h-3.5"}),t.overdue]}):s.jsx("span",{className:"text-gray-400",children:"0"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${t.completion_rate>=80?"bg-green-500":t.completion_rate>=50?"bg-blue-500":"bg-amber-500"}`,style:{width:`${t.completion_rate}%`}})}),s.jsxs("span",{className:"text-sm font-medium text-gray-700 w-10",children:[t.completion_rate,"%"]})]})}),s.jsx("td",{className:"px-4 py-3 text-center",children:t.average_score>0?s.jsx("span",{className:`font-semibold ${n.color}`,children:t.average_score}):s.jsx("span",{className:"text-gray-400",children:"-"})})]},t.department_id)})}),s.jsx("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:"Tng cng"}),s.jsx("td",{className:"px-4 py-3 text-center font-bold text-gray-900",children:e.reduce((t,n)=>t+n.total_tasks,0)}),s.jsx("td",{className:"px-4 py-3 text-center font-bold text-green-600",children:e.reduce((t,n)=>t+n.completed,0)}),s.jsx("td",{className:"px-4 py-3 text-center font-bold text-blue-600",children:e.reduce((t,n)=>t+n.in_progress,0)}),s.jsx("td",{className:"px-4 py-3 text-center font-bold text-red-600",children:e.reduce((t,n)=>t+n.overdue,0)}),s.jsx("td",{className:"px-4 py-3 text-center",children:(()=>{const t=e.reduce((i,o)=>i+o.total_tasks,0),n=e.reduce((i,o)=>i+o.completed,0),a=t>0?Math.round(n/t*100):0;return s.jsxs("span",{className:"font-bold text-gray-700",children:[a,"%"]})})()}),s.jsx("td",{className:"px-4 py-3 text-center",children:(()=>{const t=e.filter(a=>a.average_score>0).map(a=>a.average_score),n=t.length>0?Math.round(t.reduce((a,i)=>a+i,0)/t.length):0;return n>0?s.jsx("span",{className:"font-bold text-purple-600",children:n}):s.jsx("span",{className:"text-gray-400",children:"-"})})()})]})})]})}),fge=({active:e,payload:r,label:t})=>!e||!r?.length?null:s.jsxs("div",{className:"bg-white px-3 py-2 shadow-lg rounded-lg border border-gray-200",children:[s.jsx("p",{className:"font-medium text-gray-900 mb-1",children:t}),r.map((n,a)=>s.jsxs("p",{className:"text-sm",style:{color:n.color},children:[n.name,": ",s.jsx("span",{className:"font-semibold",children:n.value})]},a))]}),pge=({userDepartmentId:e,canViewAllDepartments:r=!1})=>{const[t,n]=R.useState(!0),[a,i]=R.useState(null),[o,c]=R.useState([]),[u,l]=R.useState("this_month"),[d,f]=R.useState(()=>{const{from:w,to:_}=i4(0);return{from_date:w,to_date:_,department_id:r?"all":e}});R.useEffect(()=>{(async()=>{if(r)try{const{data:_}=await zi.getAll();c(_||[])}catch(_){console.error("Error loading departments:",_)}})()},[r]),R.useEffect(()=>{(async()=>{n(!0);try{const{data:_,error:A}=await lge.getOverviewStats(d);if(A)throw A;i(_)}catch(_){console.error("Error loading stats:",_)}finally{n(!1)}})()},[d]);const p=(w,_)=>{l(w),f(A=>({...A,from_date:_.from,to_date:_.to}))},h=(w,_)=>{l(""),f(A=>({...A,[w]:_}))},y=w=>{f(_=>({..._,department_id:w}))},g=()=>{f(w=>({...w}))},m=R.useMemo(()=>a?.by_department?a.by_department.map(w=>({name:w.department_name.length>10?w.department_name.substring(0,10)+"...":w.department_name,fullName:w.department_name,"Hon thnh":w.completed,"ang lm":w.in_progress,"Ch x l":w.pending,"Qu hn":w.overdue})):[],[a]),x=R.useMemo(()=>a?.by_status?a.by_status.filter(w=>w.count>0):[],[a]);if(t&&!a)return s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx(Vr,{className:"w-6 h-6 text-gray-400 animate-spin"})});const v=a?rF(a.average_score):{label:"-",color:"text-gray-400"};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4 space-y-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dn,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-600",children:"T:"}),s.jsx("input",{type:"date",value:d.from_date,onChange:w=>h("from_date",w.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:"n:"}),s.jsx("input",{type:"date",value:d.to_date,onChange:w=>h("to_date",w.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),r&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($r,{className:"w-4 h-4 text-gray-400"}),s.jsxs("select",{value:d.department_id||"all",onChange:w=>y(w.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c phng ban"}),o.map(w=>s.jsx("option",{value:w.id,children:w.name},w.id))]})]}),s.jsx("button",{onClick:g,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Lm mi",children:s.jsx(Vr,{className:`w-4 h-4 ${t?"animate-spin":""}`})})]}),s.jsx(dge,{active:u,onSelect:p})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[s.jsx(qp,{icon:s.jsx(vr,{className:"w-5 h-5"}),label:"Tng cng vic",value:a?.total_tasks||0,color:"text-gray-700",bgColor:"bg-gray-50"}),s.jsx(qp,{icon:s.jsx(hn,{className:"w-5 h-5"}),label:"Hon thnh",value:a?.completed||0,subValue:`${a?.completion_rate||0}%`,color:"text-green-600",bgColor:"bg-green-50"}),s.jsx(qp,{icon:s.jsx(Xr,{className:"w-5 h-5"}),label:"ang lm",value:a?.in_progress||0,color:"text-blue-600",bgColor:"bg-blue-50"}),s.jsx(qp,{icon:s.jsx(Kr,{className:"w-5 h-5"}),label:"Qu hn",value:a?.overdue||0,color:"text-red-600",bgColor:"bg-red-50"}),s.jsx(qp,{icon:s.jsx(md,{className:"w-5 h-5"}),label:" duyt",value:a?.approved||0,color:"text-purple-600",bgColor:"bg-purple-50"}),s.jsx(qp,{icon:s.jsx(Mm,{className:"w-5 h-5"}),label:"im TB",value:a?.average_score||"-",subValue:a?.average_score?v.label:void 0,color:a?.average_score?v.color:"text-gray-400",bgColor:"bg-indigo-50"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl border border-gray-200 p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cng vic theo phng ban"}),m.length>0?s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(yb,{data:m,margin:{top:20,right:30,left:0,bottom:5},children:[s.jsx(Sf,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),s.jsx(Cf,{dataKey:"name",tick:{fontSize:12},interval:0,angle:-20,textAnchor:"end",height:60}),s.jsx(Af,{tick:{fontSize:12}}),s.jsx(Xu,{content:s.jsx(fge,{})}),s.jsx(lm,{}),s.jsx(zc,{dataKey:"Hon thnh",fill:H_.finished,radius:[4,4,0,0]}),s.jsx(zc,{dataKey:"ang lm",fill:H_.in_progress,radius:[4,4,0,0]}),s.jsx(zc,{dataKey:"Qu hn",fill:H_.overdue,radius:[4,4,0,0]})]})}):s.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:"Khng c d liu"})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Phn b trng thi"}),x.length>0?s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(s6,{children:[s.jsx(B1,{data:x,cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:3,dataKey:"count",nameKey:"status",label:w=>`${w.name} (${(w.percent*100).toFixed(0)}%)`,labelLine:!1,children:x.map((w,_)=>s.jsx(Jf,{fill:w.color||Ex[_%Ex.length]},`cell-${_}`))}),s.jsx(Xu,{})]})}):s.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",children:"Khng c d liu"}),s.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-2",children:x.map((w,_)=>s.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w.color||Ex[_%Ex.length]}}),s.jsxs("span",{className:"text-gray-600",children:[w.status,": ",w.count]})]},_))})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Chi tit theo phng ban"})}),s.jsx(hge,{data:a?.by_department||[],onDepartmentClick:w=>{r&&y(w)}})]}),s.jsxs("div",{className:"text-center text-sm text-gray-500",children:["D liu t ",gT(d.from_date)," n ",gT(d.to_date),d.department_id&&d.department_id!=="all"&&s.jsx("span",{children:"  Lc theo phng ban"})]})]})};async function mge(e,r,t){console.log(" [useTasks] fetchTasks called:",{page:e,pageSize:r,filter:t});const n=(e-1)*r,a=n+r-1;let i=se.from("tasks").select(`
      *,
      department:departments(id, code, name),
      assigner:employees!tasks_assigner_id_fkey(id, code, full_name),
      assignee:employees!tasks_assignee_id_fkey(id, code, full_name)
    `,{count:"exact"});if(t?.search){const d=`%${t.search}%`;i=i.or(`name.ilike.${d},description.ilike.${d}`),console.log(" Applied search:",t.search)}t?.department_id&&(i=i.eq("department_id",t.department_id),console.log(" Applied department:",t.department_id)),t?.assignee_id&&(i=i.eq("assignee_id",t.assignee_id),console.log(" Applied assignee:",t.assignee_id)),t?.status&&(i=i.eq("status",t.status),console.log(" Applied status:",t.status)),t?.priority&&(i=i.eq("priority",t.priority),console.log(" Applied priority:",t.priority));const{data:o,error:c,count:u}=await i.order("created_at",{ascending:!1}).range(n,a);if(c)throw console.error(" [useTasks] Error:",c),c;const l=(o||[]).map(d=>({...d,title:d.name||d.title||""}));return console.log(" [useTasks] Result:",{count:u,returned:l.length}),{data:l,total:u||0,page:e,pageSize:r,totalPages:Math.ceil((u||0)/r)}}async function gge(e){const{data:r,error:t}=await se.from("tasks").select(`
      *,
      department:departments(id, code, name),
      assigner:employees!tasks_assigner_id_fkey(id, code, full_name),
      assignee:employees!tasks_assignee_id_fkey(id, code, full_name)
    `).eq("id",e).single();if(t)throw t;return r?{...r,title:r.name||r.title}:null}async function yge(e){const{error:r}=await se.from("tasks").delete().eq("id",e);if(r)throw r}function xge(e=1,r=10,t){return gr({queryKey:["tasks",e,r,t],queryFn:()=>mge(e,r,t)})}function vge(e){return gr({queryKey:["task",e],queryFn:()=>gge(e),enabled:!!e})}function nF(){const e=Is();return nn({mutationFn:r=>yge(r),onSuccess:()=>{e.invalidateQueries({queryKey:["tasks"]})}})}function bge(){return gr({queryKey:["departments"],queryFn:()=>zi.getAll({page:1,pageSize:100})})}function wge(){return gr({queryKey:["employees"],queryFn:()=>uc.getAll({page:1,pageSize:100})})}function _ge(){const{user:e,isLoading:r}=xn(),t=R.useMemo(()=>e?.role?e.role==="admin"?"admin":e.role==="manager"||e.is_manager?"manager":"employee":"employee",[e?.role,e?.is_manager]),n=e?.position_level??null,a=e?.department_id??null,i=e?.employee_id??null,o=t==="admin",c=Rf(n),u=Xg(n),l=t==="manager"||t==="admin"||Uc(n),d=!l&&!o,f=R.useMemo(()=>g=>Kb(g,t,a,n,o),[t,a,n,o]),p=R.useMemo(()=>(g,m)=>o?{canApprove:!0}:Uc(n)?u?{canApprove:!0}:m===a?{canApprove:!0}:{canApprove:!1,reason:"Khng c quyn ph duyt cng vic ngoi phng ban"}:{canApprove:!1,reason:"Ch qun l mi c quyn ph duyt"},[n,a,o,u]),h=R.useMemo(()=>g=>o?{canAssign:!0}:u?{canAssign:!0}:Uc(n)?!g||g===a?{canAssign:!0}:{canAssign:!1,reason:"Ch c th giao vic trong phng ban ca mnh"}:{canAssign:!1,reason:"Nhn vin khng c quyn giao vic"},[n,a,o,u]),y=R.useMemo(()=>g=>!(!xl(g.status)||vg(g.evaluation_status)),[]);return{userRole:t,userGroup:c,userLevel:n,userDepartmentId:a,userEmployeeId:i,isAdmin:o,isLoading:r??!1,isExecutive:u,isManager:l,isEmployee:d,getPermissions:f,canApprove:p,canApproveTask:p,canAssignTo:h,canEvaluateTask:y,isTaskLocked:vg,canTaskBeEvaluated:xl}}const jge=[{id:"list",label:"Danh sch",icon:s.jsx(eK,{className:"w-4 h-4"})},{id:"overview",label:"Tng quan",icon:s.jsx(If,{className:"w-4 h-4"})}],sF=["finished","cancelled"];function yT(e){if(!e.due_date||sF.includes(e.status))return!1;const r=new Date;r.setHours(0,0,0,0);const t=new Date(e.due_date);return t.setHours(0,0,0,0),t<r}function xT(e){if(!e.due_date||sF.includes(e.status))return!1;const r=new Date;r.setHours(0,0,0,0);const t=new Date(e.due_date);return t.setHours(0,0,0,0),t.getTime()===r.getTime()}function Nge(e){const r=new Date;r.setHours(0,0,0,0);const t=new Date(e);return t.setHours(0,0,0,0),Math.ceil((r.getTime()-t.getTime())/(1e3*60*60*24))}function vT(e){let r=null;return e.assigner_level!=null?r=e.assigner_level:e.assigner?.position?.level!=null?r=e.assigner.position.level:Array.isArray(e.assigner?.position)&&e.assigner.position[0]?.level!=null&&(r=e.assigner.position[0].level),{id:e.id,status:e.status,evaluation_status:e.evaluation_status||null,assignee_id:e.assignee_id||e.assignee?.id||null,assigner_id:e.assigner_id||e.assigner?.id||null,department_id:e.department_id||e.department?.id||null,is_self_assigned:e.is_self_assigned||!1,assigner_level:r}}function kge(){const[e,r]=Ib(),t=e.get("tab")||"list",[n,a]=R.useState(1),[i,o]=R.useState(nh),[c,u]=R.useState(null),[l,d]=R.useState(null),[f,p]=R.useState(null),[h,y]=R.useState(null),{user:g}=xn(),{isLoading:m,userLevel:x,userDepartmentId:v,isExecutive:w,isManager:_,isEmployee:A,isAdmin:P,getPermissions:B,canAssignTo:T}=_ge(),I=R.useMemo(()=>P||w?i.department_id||void 0:v||i.department_id||void 0,[P,w,v,i.department_id]),U=R.useMemo(()=>{const ue={};return i.search?.trim()&&(ue.search=i.search.trim()),i.status?.length>0&&(ue.status=i.status),i.priority?.length>0&&(ue.priority=i.priority),i.assignee_id&&(ue.assignee_id=i.assignee_id),I&&(ue.department_id=I),i.due_date_from&&(ue.due_date_from=i.due_date_from),i.due_date_to&&(ue.due_date_to=i.due_date_to),i.created_date_from&&(ue.created_date_from=i.created_date_from),i.created_date_to&&(ue.created_date_to=i.created_date_to),ue},[i,I]),{data:H,isLoading:z,isFetching:O,error:L,refetch:E}=xge(n,10,m?void 0:U),{data:k}=bge(),{data:N}=wge(),S=nF(),C=R.useMemo(()=>!v||!k?.data?"":k.data.find(pe=>pe.id===v)?.name||"",[v,k]);R.useEffect(()=>{if(h){const ue=setTimeout(()=>y(null),5e3);return()=>clearTimeout(ue)}},[h]);const D=ue=>{if(!ue)return"-";try{return new Date(ue).toLocaleDateString("vi-VN")}catch{return"-"}},q=ue=>ue.title||ue.name||"Khng c tiu ",M=ue=>{if(ue.status!=="draft"||!ue.assignee_id)return!1;if(A)return ue.is_self_assigned&&ue.assigner_id===g?.employee_id;const pe=ue.assignee?.department_id||ue.department_id,{canAssign:me}=T(pe);return me},G=async ue=>{if(!ue.assignee_id){p("Cng vic cha c ngi ph trch");return}if(!g?.employee_id){p("Khng xc nh c ngi dng");return}if(A){if(!(ue.is_self_assigned&&ue.assigner_id===g.employee_id)){p("Bn ch c th giao vic cho cng vic do mnh to");return}}else{const me=ue.assignee?.department_id||ue.department_id,{canAssign:Ce,reason:fe}=T(me);if(!Ce){p(fe||"Bn khng c quyn giao vic ny");return}}const pe=ue.is_self_assigned?`Xc nhn bt u cng vic "${q(ue)}"?`:`Giao cng vic "${q(ue)}" cho nhn vin?`;if(window.confirm(pe)){d(ue.id),p(null),y(null);try{await mme.assignTask(ue.id,ue.assignee_id,g.employee_id);const me=ue.is_self_assigned?` bt u cng vic "${q(ue)}"!`:` giao vic "${q(ue)}" thnh cng!`;y(me),E()}catch(me){p(me.message||"C li khi giao vic")}finally{d(null)}}},X=ue=>{const pe=vT(ue),me=B(pe);if(!me.canDelete){p(me.deleteDisabledReason||"Bn khng c quyn xa");return}u(ue.id)},re=H?.data||[],V=H?.totalPages||1,J=H?.total||0,W=Array.isArray(k?.data)?k.data:[],F=Array.isArray(N?.data)?N.data:[],Q=R.useMemo(()=>P||w?F:v?F.filter(ue=>ue.department_id===v):F,[F,P,w,v]),ne=R.useMemo(()=>re.filter(yT).length,[re]),ie=R.useMemo(()=>re.filter(xT).length,[re]),ce=[i.search,i.status?.length>0,i.priority?.length>0,i.assignee_id,(P||w)&&i.department_id,i.due_date_from||i.due_date_to,i.created_date_from||i.created_date_to].filter(Boolean).length,de=P?"Admin":w?"Ban Gim c":_?"Qun l":"Nhn vin",le=P?"bg-red-100 text-red-700":w?"bg-purple-100 text-purple-700":_?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700",_e=P||w;return L?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:["Li: ",L.message]})}):m?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-center h-64",children:[s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-500",children:"ang ti quyn hn..."})]})}):s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l cng vic"}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 text-xs font-medium rounded-full ${le}`,children:[s.jsx(Qc,{className:"w-3 h-3"}),de," (L",x,")"]})]}),t==="list"&&s.jsxs("p",{className:"text-gray-600 mt-1",children:["Tng: ",J," cng vic",ne>0&&s.jsxs("span",{className:"ml-2 text-red-600",children:["(",ne," qu hn)"]}),ie>0&&s.jsxs("span",{className:"ml-2 text-amber-600",children:["(",ie," n hn hm nay)"]})]})]}),s.jsx("div",{className:"flex items-center gap-3",children:t==="list"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>E(),disabled:O,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg disabled:opacity-50",title:"Lm mi",children:s.jsx(Vr,{size:20,className:O?"animate-spin":""})}),A?s.jsxs($a,{to:"/tasks/create?mode=self",className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[s.jsx(An,{size:20}),"To vic c nhn"]}):s.jsxs($a,{to:"/tasks/create",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:20}),"To cng vic"]})]})})]}),s.jsx("div",{className:"flex items-center gap-1 mb-6 border-b border-gray-200",children:jge.map(ue=>s.jsxs("button",{onClick:()=>r({tab:ue.id}),className:`flex items-center gap-2 px-4 py-3 font-medium text-sm border-b-2 transition-colors ${t===ue.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[ue.icon,ue.label]},ue.id))}),t==="overview"?s.jsx(pge,{userDepartmentId:_e?void 0:v??void 0,canViewAllDepartments:_e}):s.jsxs(s.Fragment,{children:[h&&s.jsxs("div",{className:"mb-4 p-4 bg-green-100 border border-green-300 text-green-700 rounded-lg flex justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hn,{size:20}),h]}),s.jsx("button",{onClick:()=>y(null),className:"text-green-500 hover:text-green-700 text-xl",children:""})]}),f&&s.jsxs("div",{className:"mb-4 p-4 bg-red-100 border border-red-300 text-red-700 rounded-lg flex justify-between",children:[f,s.jsx("button",{onClick:()=>p(null),className:"text-red-500 hover:text-red-700 text-xl",children:""})]}),(_||A)&&!P&&C&&s.jsxs("div",{className:`mb-4 p-4 rounded-lg flex items-start gap-3 ${_?"bg-blue-50 border border-blue-200":"bg-green-50 border border-green-200"}`,children:[s.jsx($r,{className:`w-5 h-5 mt-0.5 ${_?"text-blue-500":"text-green-500"}`}),s.jsxs("div",{children:[s.jsxs("p",{className:`font-medium ${_?"text-blue-800":"text-green-800"}`,children:["Phm vi: ",C]}),s.jsx("p",{className:`text-sm mt-1 ${_?"text-blue-600":"text-green-600"}`,children:_?"Bn ch thao tc c cng vic trong phng ban. Khng th sa/xa cng vic do Ban Gim c to.":"Bn c th xem cng vic trong phng ban v to cng vic c nhn cho chnh mnh."})]})]}),s.jsx(X0e,{value:i,onChange:ue=>{o(ue),a(1)},departments:W,employees:Q,disableDepartmentFilter:(_||A)&&!P}),s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden mt-4",children:z?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]}):re.length===0?s.jsx("div",{className:"p-8 text-center text-gray-500",children:ce>0?"Khng tm thy cng vic no":"Khng c cng vic no"}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tn"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ngi PT"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"u tin"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hn"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tin "}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:re.map(ue=>{const pe=yT(ue),me=xT(ue),Ce=pe?Nge(ue.due_date):0,fe=vT(ue),xe=B(fe),je=M(ue),Oe=A?ue.status==="draft"&&ue.assigner_id===g?.employee_id:ue.status==="draft"&&xe.canDelete,Ie=pe?"bg-red-50/50":me?"bg-amber-50/50":"";return s.jsxs("tr",{className:`hover:bg-gray-50 ${Ie}`,children:[s.jsxs("td",{className:"px-4 py-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx($a,{to:`/tasks/${ue.id}`,className:"text-blue-600 hover:underline font-medium",children:q(ue)}),s.jsx(Z0e,{taskId:ue.id}),ue.is_self_assigned&&s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"T giao"}),pe&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:[s.jsx(Kr,{size:12}),"Qu hn"]}),me&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium bg-amber-100 text-amber-700 rounded-full",children:[s.jsx(Xr,{size:12}),"Hm nay"]})]}),ue.code&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:ue.code})]}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:ue.department?.name||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:ue.assignee?.full_name||"-"}),s.jsx("td",{className:"px-4 py-3",children:s.jsx(eF,{status:ue.status})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx(tF,{priority:ue.priority})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:`text-sm ${pe?"text-red-600 font-semibold":me?"text-amber-600 font-semibold":"text-gray-500"}`,children:D(ue.due_date)}),pe&&s.jsxs("span",{className:"text-xs text-red-500 mt-0.5",children:[Ce," ngy trc"]}),me&&s.jsx("span",{className:"text-xs text-amber-500 mt-0.5",children:"Deadline hm nay"})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-16 rounded-full h-2 ${pe?"bg-red-200":me?"bg-amber-200":"bg-gray-200"}`,children:s.jsx("div",{className:`h-2 rounded-full ${pe?"bg-red-500":me?"bg-amber-500":"bg-blue-600"}`,style:{width:`${Math.min(ue.progress||0,100)}%`}})}),s.jsxs("span",{className:`text-sm ${pe?"text-red-600":me?"text-amber-600":"text-gray-500"}`,children:[ue.progress||0,"%"]})]})}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsxs("div",{className:"flex justify-end items-center gap-1",children:[s.jsx($a,{to:`/tasks/${ue.id}`,className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Xem chi tit",children:s.jsx(ja,{size:18})}),xe.canEdit?s.jsx($a,{to:`/tasks/${ue.id}/edit`,className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded",title:"Chnh sa",children:s.jsx(ad,{size:18})}):s.jsx("button",{disabled:!0,className:"p-1.5 text-gray-300 cursor-not-allowed rounded",title:xe.editDisabledReason||"Khng c quyn sa",children:s.jsx(ad,{size:18})}),je&&s.jsxs("button",{onClick:()=>G(ue),disabled:l===ue.id,className:"ml-1 px-2.5 py-1 rounded bg-green-500 hover:bg-green-600 text-white text-xs font-medium flex items-center gap-1 disabled:opacity-50",title:ue.is_self_assigned?"Bt u cng vic":"Giao vic",children:[l===ue.id?s.jsx(Mt,{size:14,className:"animate-spin"}):s.jsx(Hb,{size:14}),ue.is_self_assigned?"Bt u":"Giao vic"]}),Oe?s.jsx("button",{onClick:()=>X(ue),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Xa",children:s.jsx(En,{size:18})}):ue.status==="draft"&&s.jsx("button",{disabled:!0,className:"p-1.5 text-gray-300 cursor-not-allowed rounded",title:xe.deleteDisabledReason||"Khng c quyn xa",children:s.jsx(En,{size:18})})]})})]},ue.id)})})]})})}),V>1&&s.jsxs("div",{className:"flex justify-between items-center mt-4",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:["Trang ",n,"/",V]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>a(ue=>Math.max(1,ue-1)),disabled:n===1,className:"px-3 py-1 border rounded disabled:opacity-50 hover:bg-gray-50",children:"Trc"}),s.jsx("button",{onClick:()=>a(ue=>Math.min(V,ue+1)),disabled:n===V,className:"px-3 py-1 border rounded disabled:opacity-50 hover:bg-gray-50",children:"Sau"})]})]}),c&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Xc nhn xa?"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Bn c chc mun xa cng vic ny?"}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"Hy"}),s.jsx("button",{onClick:async()=>{await S.mutateAsync(c),u(null)},disabled:S.isPending,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:S.isPending?"ang xa...":"Xa"})]})]})})]})]})}const Sge=[{value:"low",label:"Thp",color:"text-gray-600"},{value:"medium",label:"Trung bnh",color:"text-yellow-600"},{value:"high",label:"Cao",color:"text-orange-600"},{value:"urgent",label:"Khn cp",color:"text-red-600"}];function Cge({mode:e="create",task:r,departments:t=[],employees:n=[],onSubmit:a,onCancel:i,isLoading:o=!1,isSelfMode:c=!1,initialData:u,currentUser:l,isDepartmentLocked:d=!1}){const[f,p]=R.useState({name:"",description:"",department_id:u?.department_id||"",assignee_id:u?.assignee_id||"",priority:"medium",start_date:"",due_date:"",notes:"",initial_progress:0,parent_task_id:"",tags:[]}),[h,y]=R.useState("");R.useEffect(()=>{r&&p({name:r.name||r.title||"",description:r.description||"",department_id:r.department_id||"",assignee_id:r.assignee_id||"",priority:r.priority||"medium",start_date:r.start_date?r.start_date.split("T")[0]:"",due_date:r.due_date?r.due_date.split("T")[0]:"",notes:r.notes||"",initial_progress:r.progress||0,parent_task_id:r.parent_task_id||"",tags:r.tags||[]})},[r]),R.useEffect(()=>{e==="create"&&u&&p(_=>({..._,department_id:u.department_id||_.department_id,assignee_id:u.assignee_id||_.assignee_id}))},[c,d,u,e]);const g=f.department_id?n.filter(_=>_.department_id===f.department_id):d?n:[],m=_=>{const{name:A,value:P}=_.target;p(B=>({...B,[A]:P})),A==="department_id"&&!c&&!d&&p(B=>({...B,assignee_id:""}))},x=()=>f.name.trim()?f.start_date&&f.due_date&&new Date(f.start_date)>new Date(f.due_date)?(y("Ngy bt u phi trc hn hon thnh"),!1):(y(""),!0):(y("Vui lng nhp tn cng vic"),!1),v=_=>{_.preventDefault(),x()&&a(f)},w=()=>l?.department_name?l.department_name:t.find(A=>A.id===f.department_id)?.name||"Cha chn phng ban";return s.jsxs("form",{onSubmit:v,className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"p-6 space-y-6",children:[h&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-red-600",children:h})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide border-b pb-2",children:"Thng tin cng vic"}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(vr,{className:"w-4 h-4 inline mr-1"}),"Tn cng vic ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:f.name,onChange:m,placeholder:"Nhp tn cng vic",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:f.description,onChange:m,placeholder:"M t chi tit cng vic",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]})]}),!c&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide border-b pb-2",children:"Phn cng"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(ph,{className:"w-4 h-4 inline mr-1"}),"Phng ban",d&&s.jsx("span",{title:" kha",children:s.jsx(da,{className:"w-3 h-3 inline ml-1 text-blue-500"})})]}),d?s.jsxs("div",{className:"w-full px-3 py-2 border border-blue-200 rounded-lg bg-blue-50 text-blue-700 font-medium flex items-center gap-2",children:[s.jsx(ph,{className:"w-4 h-4"}),w(),s.jsx("span",{className:"ml-auto text-xs text-blue-500",children:"(C nh)"})]}):s.jsxs("select",{name:"department_id",value:f.department_id,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:[s.jsx("option",{value:"",children:"-- Chn phng ban --"}),t.map(_=>s.jsx("option",{value:_.id,children:_.name},_.id))]}),d&&s.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"Bn ch c th phn cng trong phng ban ca mnh"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(ls,{className:"w-4 h-4 inline mr-1"}),"Ngi ph trch"]}),s.jsxs("select",{name:"assignee_id",value:f.assignee_id,onChange:m,disabled:!d&&!f.department_id,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${!d&&!f.department_id?"bg-gray-100 border-gray-200 text-gray-400 cursor-not-allowed":"bg-white border-gray-300"}`,children:[s.jsx("option",{value:"",children:!d&&!f.department_id?"-- Chn phng ban trc --":"-- Chn ngi ph trch --"}),g.map(_=>s.jsxs("option",{value:_.id,children:[_.full_name," ",_.code?`(${_.code})`:""]},_.id))]}),!d&&!f.department_id&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Vui lng chn phng ban  xem danh sch nhn vin"}),(f.department_id||d)&&g.length===0&&s.jsx("p",{className:"text-xs text-orange-500 mt-1",children:"Khng c nhn vin trong phng ban ny"}),(f.department_id||d)&&g.length>0&&s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g.length," nhn vin trong phng ban"]})]})]})]}),c&&l&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide border-b pb-2",children:"Phn cng"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(ph,{className:"w-4 h-4 inline mr-1"}),"Phng ban"]}),s.jsx("div",{className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-700",children:l.department_name||"Cha c phng ban"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(ls,{className:"w-4 h-4 inline mr-1"}),"Ngi ph trch"]}),s.jsxs("div",{className:"w-full px-3 py-2 border border-green-200 rounded-lg bg-green-50 text-green-700 font-medium",children:[l.full_name||"Bn"," (Bn)"]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide border-b pb-2",children:"Thi gian & u tin"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Ub,{className:"w-4 h-4 inline mr-1"})," u tin"]}),s.jsx("select",{name:"priority",value:f.priority,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",children:Sge.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(dn,{className:"w-4 h-4 inline mr-1"}),"Ngy bt u"]}),s.jsx("input",{type:"date",name:"start_date",value:f.start_date,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(Xr,{className:"w-4 h-4 inline mr-1"}),"Hn hon thnh"]}),s.jsx("input",{type:"date",name:"due_date",value:f.due_date,onChange:m,min:f.start_date||void 0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide border-b pb-2",children:"Ghi ch"}),s.jsx("div",{children:s.jsx("textarea",{name:"notes",value:f.notes,onChange:m,placeholder:"Ghi ch thm (ty chn)",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50 rounded-b-lg",children:[s.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",disabled:o,children:"Hy"}),s.jsxs("button",{type:"submit",disabled:o||!f.name.trim(),className:`px-6 py-2 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors ${c?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,children:[o&&s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),o?"ang lu...":e==="edit"?"Cp nht":c?"To vic c nhn":"To cng vic"]})]})]})}const bT=()=>{const e=ts(),[r]=Ib(),{user:t}=xn(),n=r.get("mode")==="self",a=t?.position_level||6,i=t?.role==="admin",o=Xg(a),c=Uc(a)&&!o,[u,l]=R.useState([]),[d,f]=R.useState([]),[p,h]=R.useState(!0),[y,g]=R.useState(!1),[m,x]=R.useState(null),[v,w]=R.useState(!1);R.useEffect(()=>{(async()=>{h(!0);try{if(i||o){const{data:I,error:U}=await se.from("departments").select("id, name").eq("status","active").order("name");U&&console.warn("Departments query error:",U),l(I||[])}else if(c&&t?.department_id){const{data:I,error:U}=await se.from("departments").select("id, name").eq("id",t.department_id).single();U?(console.warn("Department query error:",U),t.department_name&&l([{id:t.department_id,name:t.department_name}])):l(I?[I]:[])}else l([]);if(i||o){const{data:I,error:U}=await se.from("employees").select("id, full_name, department_id").eq("status","active").order("full_name");U&&console.warn("Employees query error:",U),f(I||[])}else if(c&&t?.department_id){const{data:I,error:U}=await se.from("employees").select("id, full_name, department_id").eq("department_id",t.department_id).eq("status","active").order("full_name");U&&console.warn("Employees query error:",U),f(I||[])}else f([])}catch(I){console.error("Error loading data:",I),x("Khng th ti d liu. Vui lng th li.")}finally{h(!1)}})()},[i,o,c,t?.department_id,t?.department_name]);const _=R.useMemo(()=>{if(n&&t)return{department_id:t.department_id||"",assignee_id:t.employee_id||""};if(c&&t?.department_id)return{department_id:t.department_id,assignee_id:""}},[n,c,t]),A=c&&!i&&!o,P=async T=>{x(null),g(!0);try{const I={name:T.name,description:T.description||null,priority:T.priority||"medium",start_date:T.start_date||null,due_date:T.due_date||null,notes:T.notes||null,status:"draft",progress:0,progress_mode:"manual"};n?(I.assignee_id=t?.employee_id||null,I.assigner_id=t?.employee_id||null,I.department_id=t?.department_id||null,I.is_self_assigned=!0):(A&&t?.department_id?I.department_id=t.department_id:I.department_id=T.department_id||null,I.assignee_id=T.assignee_id||null,I.assigner_id=t?.employee_id||null,I.is_self_assigned=!1);const{data:U,error:H}=await se.from("tasks").insert(I).select("*").single();if(H)throw console.error(" Create error:",H),new Error(H.message);w(!0),setTimeout(()=>{e(`/tasks/${U.id}`)},1500)}catch(I){console.error(" Error creating task:",I),x(I.message||"C li xy ra khi to cng vic")}finally{g(!1)}},B=()=>{e("/tasks")};return v?s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px]",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(hn,{className:"w-8 h-8 text-green-600"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:n?"To cng vic c nhn thnh cng!":"To cng vic thnh cng!"}),s.jsx("p",{className:"text-gray-500",children:"ang chuyn hng..."})]}):s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:B,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[s.jsx(wo,{className:"w-4 h-4"}),"Quay li danh sch"]}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n?"To cng vic c nhn":"To cng vic mi"}),s.jsx("p",{className:"text-gray-500 mt-1",children:n?"To cng vic v t giao cho chnh bn":"in thng tin  to cng vic mi"})]}),n&&t&&s.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ls,{className:"w-5 h-5 text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-green-800",children:"Cng vic c nhn"}),s.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Ngi ph trch: ",s.jsx("strong",{children:t.full_name}),t.department_name&&s.jsxs("span",{className:"ml-2",children:[" Phng ban: ",s.jsx("strong",{children:t.department_name})]})]})]})]})}),!n&&A&&t&&s.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qc,{className:"w-5 h-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-blue-800",children:"Phn cng trong phng ban"}),s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Bn ch c th phn cng cng vic cho nhn vin trong phng ",s.jsx("strong",{children:t.department_name})]})]})]})}),m&&s.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 flex items-start gap-2",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:m})]}),p?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-500",children:"ang ti d liu..."})]}):s.jsx(Cge,{mode:"create",onSubmit:P,onCancel:B,departments:u,employees:d,isLoading:y,isSelfMode:n,isDepartmentLocked:A,initialData:_,currentUser:t})]})},Age=[{value:"draft",label:"Bn nhp"},{value:"in_progress",label:"ang thc hin"},{value:"on_hold",label:"Tm dng"},{value:"completed",label:"Hon thnh"},{value:"cancelled",label:" hy"}],Ege=[{value:"low",label:"Thp"},{value:"medium",label:"Trung bnh"},{value:"high",label:"Cao"},{value:"urgent",label:"Khn cp"}];function Tge(){const{id:e}=_h(),r=ts(),{user:t}=xn(),[n,a]=R.useState(null),[i,o]=R.useState([]),[c,u]=R.useState([]),[l,d]=R.useState(!0),[f,p]=R.useState(!1),[h,y]=R.useState(null),[g,m]=R.useState(null),[x,v]=R.useState(6),[w,_]=R.useState({canEdit:!0}),[A,P]=R.useState(0),[B,T]=R.useState(!1),[I,U]=R.useState(null),[H,z]=R.useState({name:"",description:"",department_id:"",assignee_id:"",start_date:"",due_date:"",status:"in_progress",priority:"medium",progress:0,notes:""}),[O,L]=R.useState("");R.useEffect(()=>{(async()=>{if(!e){y("Khng c ID cng vic"),d(!1);return}try{console.log(" [TaskEditPage] Fetching task:",e);let M=6;if(t?.position_id){const{data:ce}=await se.from("positions").select("level").eq("id",t.position_id).maybeSingle();M=ce?.level||6}v(M),console.log(" [TaskEditPage] User position level:",M);const{data:G,error:X}=await se.from("tasks").select(`
            *,
            department:departments(id, name),
            assigner:employees!tasks_assigner_id_fkey(id, full_name, position_id),
            assignee:employees!tasks_assignee_id_fkey(id, full_name)
          `).eq("id",e).single();if(X)throw console.error(" [TaskEditPage] Task error:",X),new Error("Khng tm thy cng vic");console.log(" [TaskEditPage] Task loaded:",G);let re=null;if(G.assigner?.position_id){const{data:ce}=await se.from("positions").select("level").eq("id",G.assigner.position_id).maybeSingle();re=ce?.level||null}const V={...G,assigner_level:re};console.log(" [TaskEditPage] Assigner level:",re);const J={id:V.id,status:V.status,evaluation_status:V.evaluation_status,assignee_id:V.assignee_id,assigner_id:V.assigner_id,department_id:V.department_id,is_self_assigned:V.is_self_assigned,assigner_level:re},W=Kb(J,t?.role||"employee",t?.department_id||null,M,t?.role==="admin");console.log(" [TaskEditPage] Permissions:",W),_({canEdit:W.canEdit,reason:W.editDisabledReason});const F=await ys.getSubtaskCount(e);P(F),T(F>0);const{data:Q}=await se.from("departments").select("id, code, name").order("name"),{data:ne}=await se.from("employees").select("id, code, full_name, department_id").order("full_name");a(V),o(Q||[]),u(ne||[]);const ie=G.status||"in_progress";L(ie),z({name:G.name||"",description:G.description||"",department_id:G.department_id||"",assignee_id:G.assignee_id||"",start_date:G.start_date?G.start_date.split("T")[0]:"",due_date:G.due_date?G.due_date.split("T")[0]:"",status:ie,priority:G.priority||"medium",progress:G.progress||0,notes:G.notes||""})}catch(M){console.error(" [TaskEditPage] Error:",M),y(M.message||"C li xy ra")}finally{d(!1)}})()},[e,t]);const E=q=>{const{name:M,value:G,type:X}=q.target;z(re=>({...re,[M]:X==="number"?parseInt(G)||0:G}))},k=async q=>{if(z(M=>({...M,status:q})),U(null),B&&q!==O){const M=await HE.canChangeStatus(e,q);if(!M.canChange){y(M.reason||"Khng th thay i trng thi"),z(G=>({...G,status:O}));return}M.warnings&&M.warnings.length>0&&U(M.warnings.join(`
`))}},N=async q=>{if(q.preventDefault(),!!e){if(!w.canEdit){y(w.reason||"Khng c quyn chnh sa cng vic ny");return}p(!0),y(null),m(null);try{console.log(" [TaskEditPage] Saving:",H);const M=H.status!==O;if(M&&B){const re=await HE.changeTaskStatus(e,H.status);if(!re.success)throw new Error(re.error||"Khng th thay i trng thi");re.warnings&&re.warnings.length>0&&m(re.warnings.join(`
`)),re.cascadedChildren&&re.cascadedChildren>0&&console.log(`  cascade ${re.cascadedChildren} cng vic con`)}const G={name:H.name,description:H.description||null,department_id:H.department_id||null,assignee_id:H.assignee_id||null,start_date:H.start_date||null,due_date:H.due_date||null,priority:H.priority,progress:H.progress,notes:H.notes||null,updated_at:new Date().toISOString()};(!M||!B)&&(G.status=H.status,H.status==="completed"&&H.progress>=100&&(G.completed_date=new Date().toISOString()));const{error:X}=await se.from("tasks").update(G).eq("id",e);if(X)throw console.error(" [TaskEditPage] Update error:",X),X;console.log(" [TaskEditPage] Saved successfully"),r("/tasks")}catch(M){console.error(" [TaskEditPage] Error:",M),y(M.message||"Khng th cp nht cng vic")}finally{p(!1)}}},S=Rf(x),C=t?.role==="admin"?"Admin":S==="executive"?"Ban Gim c":S==="manager"?"Qun l":"Nhn vin",D=t?.role==="admin"?"bg-red-100 text-red-700":S==="executive"?"bg-purple-100 text-purple-700":S==="manager"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700";return l?s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsx(Mt,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"ang ti..."})]})})}):w.canEdit?n?s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>r("/tasks"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sa cng vic"}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${D}`,children:[s.jsx(Qc,{className:"w-3 h-3"}),C]}),B&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full flex items-center gap-1",children:[s.jsx(_i,{className:"w-3 h-3"}),"C ",A," con"]})]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[n.code," - ",n.name]})]})]}),h&&s.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4 text-red-700 flex items-start gap-2",children:[s.jsx(Kr,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"whitespace-pre-line",children:h})]}),g&&s.jsxs("div",{className:"mb-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-yellow-700 flex items-start gap-2",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"whitespace-pre-line",children:g})]}),B&&s.jsx("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-2 text-blue-700",children:[s.jsx(_i,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:["Cng vic cha vi ",A," cng vic con"]}),s.jsxs("p",{className:"text-sm mt-1",children:[" Tin  v trng thi c tnh t ng t cc cng vic con",s.jsx("br",{}),' Thay i trng thi "Tm dng" hoc " hy" s p dng cho tt c cng vic con']})]})]})}),I&&s.jsxs("div",{className:"mb-4 bg-orange-50 border border-orange-200 rounded-lg p-4 text-orange-700 flex items-start gap-2",children:[s.jsx(Kr,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:"Cnh bo cascade"}),s.jsx("p",{className:"text-sm whitespace-pre-line mt-1",children:I})]})]}),s.jsx("form",{onSubmit:N,className:"max-w-4xl",children:s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Thng tin c bn"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn cng vic ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:H.name,onChange:E,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhp tn cng vic"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:H.description,onChange:E,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"M t chi tit cng vic"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),s.jsxs("select",{name:"department_id",value:H.department_id,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"-- Chn phng ban --"}),i.map(q=>s.jsx("option",{value:q.id,children:q.name},q.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngi thc hin"}),s.jsxs("select",{name:"assignee_id",value:H.assignee_id,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"-- Chn ngi thc hin --"}),c.map(q=>s.jsx("option",{value:q.id,children:q.full_name},q.id))]})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Thi gian"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy bt u"}),s.jsx("input",{type:"date",name:"start_date",value:H.start_date,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy ht hn"}),s.jsx("input",{type:"date",name:"due_date",value:H.due_date,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Trng thi & u tin"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Trng thi",B&&s.jsx("span",{className:"text-xs text-blue-600 ml-1",children:"(c nh hng con)"})]}),s.jsx("select",{name:"status",value:H.status,onChange:q=>k(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:Age.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" u tin"}),s.jsx("select",{name:"priority",value:H.priority,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:Ege.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tin  (%)",B&&s.jsx("span",{className:"text-xs text-blue-600 ml-1",children:"(t ng t con)"})]}),s.jsx("input",{type:"number",name:"progress",value:H.progress,onChange:E,min:0,max:100,disabled:B,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]}),s.jsx("div",{className:"mt-3",children:s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full transition-all ${H.progress>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(H.progress,100)}%`}})})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ghi ch"}),s.jsx("textarea",{name:"notes",value:H.notes,onChange:E,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi ch thm..."})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:()=>r("/tasks"),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Hy"}),s.jsxs("button",{type:"submit",disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[f?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(ai,{className:"w-4 h-4"}),"Lu thay i"]})]})]})})]}):s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-yellow-700",children:[s.jsx("p",{className:"font-medium",children:"Khng tm thy cng vic"}),s.jsx("p",{className:"text-sm mt-1",children:h||"Cng vic khng tn ti hoc  b xa."})]}),s.jsxs("button",{onClick:()=>r("/tasks"),className:"mt-4 flex items-center gap-2 text-blue-600 hover:text-blue-800",children:[s.jsx(wo,{className:"w-4 h-4"}),"Quay li danh sch"]})]})}):s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("button",{onClick:()=>r(-1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Khng th chnh sa"}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${D}`,children:[s.jsx(Qc,{className:"w-3 h-3"}),C]})]}),n&&s.jsxs("p",{className:"text-sm text-gray-500",children:[n.code," - ",n.name]})]})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(da,{className:"w-8 h-8 text-yellow-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-yellow-800 mb-2",children:"Cng vic b kha chnh sa"}),s.jsx("p",{className:"text-yellow-700 mb-4",children:w.reason}),n?.evaluation_status&&n.evaluation_status!=="none"&&s.jsx("div",{className:"bg-yellow-100 rounded-lg p-3 mb-4",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Trng thi nh gi:"})," ",n.evaluation_status==="pending_approval"&&"Ch ph duyt",n.evaluation_status==="approved"&&" duyt",n.evaluation_status==="rejected"&&" t chi"]})}),n?.assigner_level&&n.assigner_level<=3&&S==="manager"&&s.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 mb-4",children:[s.jsxs("p",{className:"text-sm text-purple-800",children:[s.jsx("strong",{children:"Ngi giao:"})," ",n.assigner?.full_name||"Ban Gim c"," (Level ",n.assigner_level,")"]}),s.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Qun l khng c php sa cng vic do Ban Gim c to."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>r(`/tasks/${e}`),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Xem chi tit"}),s.jsx("button",{onClick:()=>r("/tasks"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Quay li danh sch"})]})]})]})})]})})}const wT={draft:{label:"Nhp",color:"text-gray-600",bg:"bg-gray-100",icon:Xr},in_progress:{label:"ang lm",color:"text-blue-600",bg:"bg-blue-100",icon:Xr},pending_review:{label:"Ch duyt",color:"text-yellow-600",bg:"bg-yellow-100",icon:Cr},completed:{label:"Hon thnh",color:"text-green-600",bg:"bg-green-100",icon:hn},cancelled:{label:" hy",color:"text-red-600",bg:"bg-red-100",icon:Br},on_hold:{label:"Tm dng",color:"text-orange-600",bg:"bg-orange-100",icon:Kr}},_T={low:{label:"Thp",color:"text-gray-600",bg:"bg-gray-100"},medium:{label:"Trung bnh",color:"text-yellow-600",bg:"bg-yellow-100"},high:{label:"Cao",color:"text-orange-600",bg:"bg-orange-100"},urgent:{label:"Khn cp",color:"text-red-600",bg:"bg-red-100"}};async function Pge(){const{data:e,error:r}=await se.from("departments").select("id, code, name").order("name");if(r)throw r;return e||[]}async function Oge(e){let r=se.from("employees").select("id, code, full_name, department_id").eq("status","active").order("full_name");e&&(r=r.eq("department_id",e));const{data:t,error:n}=await r;if(n)throw n;return t||[]}function Mge({parentTaskId:e,parentTaskCode:r,parentDepartmentId:t,parentStartDate:n,parentDueDate:a,canEdit:i=!0,onSubtaskCreated:o,onSubtaskDeleted:c}){const u=Is(),[l,d]=R.useState(!0),[f,p]=R.useState(!1),[h,y]=R.useState(null),{data:g}=gr({queryKey:["date-constraints",e],queryFn:()=>ys.getDateConstraints(e),enabled:!!e}),m=n||g?.minStartDate||null,x=a||g?.maxDueDate||null,{data:v=[],isLoading:w}=gr({queryKey:["subtasks",e],queryFn:()=>ys.getSubtasks(e),enabled:!!e}),{data:_}=gr({queryKey:["subtasks-summary",e],queryFn:()=>ys.getSubtaskSummary(e),enabled:!!e}),A=nn({mutationFn:I=>ys.createSubtask(I),onSuccess:()=>{u.invalidateQueries({queryKey:["subtasks",e]}),u.invalidateQueries({queryKey:["subtasks-summary",e]}),u.invalidateQueries({queryKey:["task",e]}),p(!1),o?.()}}),P=nn({mutationFn:I=>ys.deleteTask(I),onSuccess:()=>{u.invalidateQueries({queryKey:["subtasks",e]}),u.invalidateQueries({queryKey:["subtasks-summary",e]}),u.invalidateQueries({queryKey:["task",e]}),y(null),c?.()}}),B=I=>I?new Date(I).toLocaleDateString("vi-VN"):"-",T=I=>I.title||I.name||"Khng c tiu ";return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 cursor-pointer",onClick:()=>d(!l),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:v.length})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Cng vic con"}),_&&_.total>0&&s.jsxs("p",{className:"text-xs text-gray-500",children:[_.completed,"/",_.total," hon thnh",_.overdue>0&&s.jsxs("span",{className:"text-red-500 ml-2",children:[" ",_.overdue," qu hn"]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[i&&s.jsxs("button",{onClick:I=>{I.stopPropagation(),p(!0),d(!0)},className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm con"]}),l?s.jsx(si,{className:"w-5 h-5 text-gray-400"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-400"})]})]}),l&&s.jsxs("div",{className:"divide-y divide-gray-100",children:[_&&_.total>0&&s.jsxs("div",{className:"px-4 py-3 bg-gray-50 grid grid-cols-4 gap-4 text-center text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900",children:_.total}),s.jsx("div",{className:"text-xs text-gray-500",children:"Tng s"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-green-600",children:_.completed}),s.jsx("div",{className:"text-xs text-gray-500",children:"Hon thnh"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-blue-600",children:_.inProgress}),s.jsx("div",{className:"text-xs text-gray-500",children:"ang lm"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-red-600",children:_.overdue}),s.jsx("div",{className:"text-xs text-gray-500",children:"Qu hn"})]})]}),f&&s.jsx(Ige,{parentTaskId:e,parentDepartmentId:t,parentStartDate:m,parentDueDate:x,isLoading:A.isPending,error:A.error?.message,onSubmit:I=>A.mutate(I),onCancel:()=>{p(!1),A.reset()}}),w&&s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(Mt,{className:"w-6 h-6 animate-spin mx-auto text-gray-400"}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"ang ti..."})]}),!w&&v.length===0&&!f&&s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(An,{className:"w-6 h-6 text-gray-400"})}),s.jsx("p",{className:"text-gray-500",children:"Cha c cng vic con"}),i&&s.jsx("button",{onClick:()=>p(!0),className:"mt-3 text-sm text-purple-600 hover:text-purple-700",children:"+ Thm cng vic con u tin"})]}),!w&&v.length>0&&s.jsx("div",{className:"divide-y divide-gray-100",children:v.map(I=>{const U=wT[I.status]||wT.draft,H=_T[I.priority]||_T.medium,z=U.icon,O=I.due_date&&new Date(I.due_date)<new Date&&I.status!=="completed"&&I.status!=="cancelled",L=x&&I.due_date&&new Date(I.due_date)>new Date(x);return s.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors ${L?"bg-red-50":""}`,children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.code&&s.jsx("span",{className:"text-xs text-gray-400 font-mono",children:I.code}),s.jsx($a,{to:`/tasks/${I.id}`,className:"font-medium text-gray-900 hover:text-blue-600 truncate",children:T(I)}),L&&s.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-1",children:[s.jsx(Kr,{className:"w-3 h-3"}),"Vt hn cha!"]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-500",children:[I.assignee&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ls,{className:"w-3 h-3"}),I.assignee.full_name]}),I.department&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ph,{className:"w-3 h-3"}),I.department.name]}),I.due_date&&s.jsxs("span",{className:`flex items-center gap-1 ${O?"text-red-500":""}`,children:[s.jsx(dn,{className:"w-3 h-3"}),B(I.due_date),O&&" (Qu hn)"]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full ${I.progress>=100?"bg-green-500":I.progress>=50?"bg-blue-500":"bg-gray-400"}`,style:{width:`${Math.min(I.progress,100)}%`}})}),s.jsxs("span",{className:"text-xs text-gray-500 w-8",children:[I.progress,"%"]})]}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs ${U.bg} ${U.color}`,children:[s.jsx(z,{className:"w-3 h-3"}),U.label]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${H.bg} ${H.color}`,children:H.label}),i&&s.jsx("button",{onClick:()=>y(I.id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})]})},I.id)})})]}),h&&s.jsx(Rge,{taskName:v.find(I=>I.id===h)?.name||"",isLoading:P.isPending,error:P.error?.message,onConfirm:()=>P.mutate(h),onCancel:()=>{y(null),P.reset()}})]})}function Ige({parentTaskId:e,parentDepartmentId:r,parentStartDate:t,parentDueDate:n,isLoading:a,error:i,onSubmit:o,onCancel:c}){const[u,l]=R.useState(""),[d,f]=R.useState(""),[p,h]=R.useState("medium"),[y,g]=R.useState(""),[m,x]=R.useState(""),[v,w]=R.useState(r||""),[_,A]=R.useState(""),[P,B]=R.useState(""),{data:T}=gr({queryKey:["departments"],queryFn:Pge}),I=Array.isArray(T)?T:[],{data:U,isLoading:H}=gr({queryKey:["employees",v],queryFn:()=>Oge(v||null),enabled:!0}),z=Array.isArray(U)?U:[];R.useEffect(()=>{r&&!v&&w(r)},[r]),R.useEffect(()=>{A("")},[v]);const O=N=>N?new Date(N).toLocaleDateString("vi-VN"):"",L=N=>N?new Date(N).toISOString().split("T")[0]:"";R.useEffect(()=>{let N="";if(y&&t){const S=new Date(y),C=new Date(t);S.setHours(0,0,0,0),C.setHours(0,0,0,0),S<C&&(N=`Ngy bt u khng c trc ${O(t)} (ngy bt u ca cng vic cha)`)}if(m&&n){const S=new Date(m),C=new Date(n);S.setHours(0,0,0,0),C.setHours(0,0,0,0),S>C&&(N=`Hn hon thnh khng c sau ${O(n)} (hn ca cng vic cha)`)}if(y&&m){const S=new Date(y),C=new Date(m);S.setHours(0,0,0,0),C.setHours(0,0,0,0),S>C&&(N="Ngy bt u phi trc hoc bng hn hon thnh")}B(N)},[y,m,t,n]);const E=N=>{if(N.preventDefault(),!u.trim()){B("Vui lng nhp tn cng vic");return}P||o({parent_task_id:e,name:u.trim(),description:d.trim()||void 0,priority:p,start_date:y||void 0,due_date:m||void 0,department_id:v||void 0,assignee_id:_||void 0})},k=v?z.filter(N=>N.department_id===v):z;return s.jsxs("form",{onSubmit:E,className:"p-4 bg-purple-50 border-b border-purple-100",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Thm cng vic con"}),(i||P)&&s.jsxs("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[s.jsx(Cr,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-red-600",children:i||P})]}),s.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Q4,{className:"w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-xs text-blue-700",children:[s.jsx("strong",{className:"block mb-1",children:" Rng buc ngy vi cng vic cha:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[t?s.jsxs("li",{children:["Ngy bt u: ",s.jsxs("strong",{children:[" ",O(t)]})]}):s.jsxs("li",{children:["Ngy bt u: ",s.jsx("span",{className:"text-gray-500",children:"Khng gii hn"})]}),n?s.jsxs("li",{children:["Hn hon thnh: ",s.jsxs("strong",{children:[" ",O(n)]})]}):s.jsxs("li",{children:["Hn hon thnh: ",s.jsx("span",{className:"text-gray-500",children:"Khng gii hn"})]})]})]})]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:["Tn cng vic ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:u,onChange:N=>l(N.target.value),placeholder:"Nhp tn cng vic con",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",autoFocus:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"M t"}),s.jsx("textarea",{value:d,onChange:N=>f(N.target.value),placeholder:"M t cng vic (ty chn)",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[s.jsx(ph,{className:"w-3 h-3 inline mr-1"}),"Phng ban",r&&s.jsx("span",{className:"text-purple-500 ml-1",children:"(k tha t cha)"})]}),s.jsxs("select",{value:v,onChange:N=>w(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"",children:"-- Chn phng ban --"}),I.map(N=>s.jsx("option",{value:N.id,children:N.name},N.id))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:[s.jsx(ls,{className:"w-3 h-3 inline mr-1"}),"Ngi ph trch"]}),s.jsxs("select",{value:_,onChange:N=>A(N.target.value),disabled:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100",children:[s.jsx("option",{value:"",children:"-- Chn ngi ph trch --"}),k.map(N=>s.jsxs("option",{value:N.id,children:[N.full_name," (",N.code,")"]},N.id))]}),v&&k.length===0&&!H&&s.jsx("p",{className:"text-xs text-orange-500 mt-1",children:"Khng c nhn vin trong phng ban ny"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:" u tin"}),s.jsxs("select",{value:p,onChange:N=>h(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[s.jsx("option",{value:"low",children:"Thp"}),s.jsx("option",{value:"medium",children:"Trung bnh"}),s.jsx("option",{value:"high",children:"Cao"}),s.jsx("option",{value:"urgent",children:"Khn cp"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:["Ngy bt u",t&&s.jsxs("span",{className:"text-blue-500 ml-1 text-[10px]",children:["( ",O(t),")"]})]}),s.jsx("input",{type:"date",value:y,onChange:N=>g(N.target.value),min:t?L(t):void 0,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 ${P.includes("bt u")?"border-red-500 bg-red-50":"border-gray-300"}`})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:["Hn hon thnh",n&&s.jsxs("span",{className:"text-blue-500 ml-1 text-[10px]",children:["( ",O(n),")"]})]}),s.jsx("input",{type:"date",value:m,onChange:N=>x(N.target.value),max:n?L(n):void 0,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 ${P.includes("Hn hon thnh")?"border-red-500 bg-red-50":"border-gray-300"}`})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[s.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",disabled:a,children:"Hy"}),s.jsxs("button",{type:"submit",disabled:a||!u.trim()||!!P,className:"px-4 py-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[a&&s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),a?"ang to...":"To cng vic con"]})]})]})]})}function Rge({taskName:e,isLoading:r,error:t,onConfirm:n,onCancel:a}){return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(Kr,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Xa cng vic con"}),s.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Bn c chc chn mun xa cng vic ",s.jsxs("strong",{children:['"',e,'"']}),"? Hnh ng ny khng th hon tc."]}),t&&s.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[s.jsx(Cr,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-sm text-red-600",children:t})]}),s.jsxs("div",{className:"mt-4 flex justify-end gap-3",children:[s.jsx("button",{onClick:a,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",disabled:r,children:"Hy"}),s.jsxs("button",{onClick:n,disabled:r,className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center gap-2",children:[r&&s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),r?"ang xa...":"Xa"]})]})]})]})})})}const Tx={draft:{label:"Nhp",color:"text-gray-600",bg:"bg-gray-100"},in_progress:{label:"ang lm",color:"text-blue-600",bg:"bg-blue-100"},pending_review:{label:"Ch duyt",color:"text-yellow-600",bg:"bg-yellow-100"},completed:{label:"Hon thnh",color:"text-green-600",bg:"bg-green-100"},cancelled:{label:" hy",color:"text-red-600",bg:"bg-red-100"},on_hold:{label:"Tm dng",color:"text-orange-600",bg:"bg-orange-100"}};async function Lge(e){const{data:r,error:t}=await se.from("tasks").select("id, code, name, status, progress, start_date, due_date").eq("id",e).single();return t?(console.error("Error fetching parent task:",t),null):r}function Dge({parentTaskId:e,currentTaskId:r}){const[t,n]=R.useState(!1),{data:a,isLoading:i}=gr({queryKey:["parent-task",e],queryFn:()=>Lge(e),enabled:!!e}),{data:o=[],isLoading:c}=gr({queryKey:["siblings",r],queryFn:()=>ys.getSiblings(r),enabled:!!r&&t});if(i)return s.jsx("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-sm",children:"ang ti thng tin cng vic cha..."})]})});if(!a)return s.jsx("div",{className:"bg-yellow-50 rounded-lg border border-yellow-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-yellow-600",children:[s.jsx(Kr,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Khng tm thy cng vic cha"})]})});const u=Tx[a.status]||Tx.draft;return s.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-200 overflow-hidden",children:[s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600 mb-1",children:[s.jsx(Q5,{className:"w-3 h-3"}),s.jsx("span",{children:"Thuc cng vic cha"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[a.code&&s.jsx("span",{className:"text-xs text-gray-500 font-mono",children:a.code}),s.jsx($a,{to:`/tasks/${a.id}`,className:"font-medium text-gray-900 hover:text-blue-600",children:a.name})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${u.bg} ${u.color}`,children:u.label}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-16 h-1.5 bg-blue-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.progress}%`}})}),s.jsxs("span",{className:"text-xs text-gray-500",children:[a.progress,"%"]})]})]}),(a.start_date||a.due_date)&&s.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-500",children:[a.start_date&&s.jsxs("span",{children:["Bt u: ",new Date(a.start_date).toLocaleDateString("vi-VN")]}),a.due_date&&s.jsxs("span",{children:["Hn: ",new Date(a.due_date).toLocaleDateString("vi-VN")]})]})]}),s.jsxs($a,{to:`/tasks/${a.id}`,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",children:["Xem cha",s.jsx(Q5,{className:"w-4 h-4"})]})]}),s.jsx("div",{className:"mt-3 p-2 bg-yellow-100 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-yellow-700",children:[s.jsx(Kr,{className:"w-4 h-4 flex-shrink-0"}),s.jsx("span",{className:"text-xs",children:"y l cng vic con. Khng th to thm cng vic con bn di."})]})}),s.jsxs("button",{onClick:()=>n(!t),className:"flex items-center gap-2 mt-3 text-sm text-blue-600 hover:text-blue-700",children:[s.jsx(_i,{className:"w-4 h-4"}),"Cng vic anh em",t?s.jsx(si,{className:"w-4 h-4"}):s.jsx(Gs,{className:"w-4 h-4"})]})]}),t&&s.jsx("div",{className:"border-t border-blue-200 bg-white",children:c?s.jsxs("div",{className:"p-4 text-center",children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin mx-auto text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"ang ti..."})]}):o.length===0?s.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:"Khng c cng vic anh em"}):s.jsx("div",{className:"divide-y divide-gray-100",children:o.map(l=>{const d=Tx[l.status]||Tx.draft;return s.jsxs($a,{to:`/tasks/${l.id}`,className:"flex items-center justify-between p-3 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[l.code&&s.jsx("span",{className:"text-xs text-gray-400 font-mono",children:l.code}),s.jsx("span",{className:"text-sm text-gray-700",children:l.title||l.name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${d.bg} ${d.color}`,children:d.label}),s.jsxs("span",{className:"text-xs text-gray-500",children:[l.progress,"%"]})]})]},l.id)})})})]})}const es={MAX_FILE_SIZE:10*1024*1024,MAX_FILES_PER_TASK:10,MAX_TOTAL_SIZE_PER_TASK:50*1024*1024,BUCKET_NAME:"task-attachments",ALLOWED_TYPES:{"application/pdf":{label:"PDF",icon:""},"application/msword":{label:"Word",icon:""},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{label:"Word",icon:""},"application/vnd.ms-excel":{label:"Excel",icon:""},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{label:"Excel",icon:""},"application/vnd.ms-powerpoint":{label:"PowerPoint",icon:""},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{label:"PowerPoint",icon:""},"image/jpeg":{label:"JPEG",icon:""},"image/png":{label:"PNG",icon:""},"image/gif":{label:"GIF",icon:""},"image/webp":{label:"WebP",icon:""},"application/zip":{label:"ZIP",icon:""},"application/x-rar-compressed":{label:"RAR",icon:""},"application/x-7z-compressed":{label:"7Z",icon:""},"text/plain":{label:"Text",icon:""},"text/csv":{label:"CSV",icon:""}}};function Yc(e){if(e===0)return"0 B";const r=1024,t=["B","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,n)).toFixed(1))+" "+t[n]}function Fge(e){return e&&es.ALLOWED_TYPES[e]?.icon||""}function Bge(e){return e&&es.ALLOWED_TYPES[e]?.label||"File"}function u6(e){return e in es.ALLOWED_TYPES}function d6(e){return e?e.startsWith("image/"):!1}function $ge(e,r,t){const n=Date.now(),a=t.replace(/[^a-zA-Z0-9.-]/g,"_");return`${e}/${r}_${n}_${a}`}async function qge(e){console.log(" [taskAttachmentService] getTaskAttachments:",e);try{const{data:r,error:t}=await se.from("task_attachments").select(`
        *,
        uploader:employees!task_attachments_uploaded_by_fkey(
          id,
          full_name,
          avatar_url
        )
      `).eq("task_id",e).eq("is_deleted",!1).order("uploaded_at",{ascending:!1});if(t)throw t;const n=(r||[]).map(a=>({...a,uploader:Array.isArray(a.uploader)?a.uploader[0]:a.uploader}));return console.log(" [taskAttachmentService] Found",n.length,"attachments"),{data:n,error:null}}catch(r){return console.error(" [taskAttachmentService] getTaskAttachments error:",r),{data:[],error:r}}}async function aF(e){console.log(" [taskAttachmentService] getAttachmentStats:",e);try{const{data:r,error:t}=await se.from("task_attachments").select("file_size").eq("task_id",e).eq("is_deleted",!1);if(t)throw t;const n=r?.length||0,a=r?.reduce((i,o)=>i+(o.file_size||0),0)||0;return{count:n,totalSize:a,maxCount:es.MAX_FILES_PER_TASK,maxTotalSize:es.MAX_TOTAL_SIZE_PER_TASK,canUpload:n<es.MAX_FILES_PER_TASK&&a<es.MAX_TOTAL_SIZE_PER_TASK}}catch(r){return console.error(" [taskAttachmentService] getAttachmentStats error:",r),{count:0,totalSize:0,maxCount:es.MAX_FILES_PER_TASK,maxTotalSize:es.MAX_TOTAL_SIZE_PER_TASK,canUpload:!0}}}async function zge(e){console.log(" [taskAttachmentService] uploadAttachment:",{task_id:e.task_id,file_name:e.file.name,file_size:e.file.size,file_type:e.file.type});try{if(!u6(e.file.type))throw new Error(`Loi file khng c h tr: ${e.file.type}`);if(e.file.size>es.MAX_FILE_SIZE)throw new Error(`File qu ln. Ti a ${Yc(es.MAX_FILE_SIZE)}`);const r=await aF(e.task_id);if(r.count>=es.MAX_FILES_PER_TASK)throw new Error(` t gii hn ${es.MAX_FILES_PER_TASK} file/task`);if(r.totalSize+e.file.size>es.MAX_TOTAL_SIZE_PER_TASK)throw new Error(` t gii hn dung lng ${Yc(es.MAX_TOTAL_SIZE_PER_TASK)}/task`);const t=$ge(e.task_id,e.uploaded_by,e.file.name),{error:n}=await se.storage.from(es.BUCKET_NAME).upload(t,e.file,{cacheControl:"3600",upsert:!1});if(n)throw console.error(" Storage upload error:",n),new Error("Li upload file: "+n.message);const{data:a,error:i}=await se.from("task_attachments").insert({task_id:e.task_id,file_name:e.file.name,file_path:t,file_size:e.file.size,file_type:e.file.type,description:e.description||null,uploaded_by:e.uploaded_by}).select(`
        *,
        uploader:employees!task_attachments_uploaded_by_fkey(
          id,
          full_name,
          avatar_url
        )
      `).single();if(i)throw await se.storage.from(es.BUCKET_NAME).remove([t]),i;return console.log(" [taskAttachmentService] Upload success:",a.id),{data:{...a,uploader:Array.isArray(a.uploader)?a.uploader[0]:a.uploader},error:null}}catch(r){return console.error(" [taskAttachmentService] uploadAttachment error:",r),{data:null,error:r}}}async function Uge(e,r){console.log(" [taskAttachmentService] deleteAttachment:",e);try{const{error:t}=await se.from("task_attachments").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:r}).eq("id",e);if(t)throw t;return console.log(" [taskAttachmentService] Delete success"),{success:!0,error:null}}catch(t){return console.error(" [taskAttachmentService] deleteAttachment error:",t),{success:!1,error:t}}}async function Hge(e){console.log(" [taskAttachmentService] getDownloadUrl:",e);try{const{data:r,error:t}=await se.storage.from(es.BUCKET_NAME).createSignedUrl(e,3600);if(t)throw t;return{url:r.signedUrl,error:null}}catch(r){return console.error(" [taskAttachmentService] getDownloadUrl error:",r),{url:null,error:r}}}function Vge(e){const{data:r}=se.storage.from(es.BUCKET_NAME).getPublicUrl(e,{transform:{width:400,height:400,resize:"contain"}});return r.publicUrl}const ff={getTaskAttachments:qge,getAttachmentStats:aF,uploadAttachment:zge,deleteAttachment:Uge,getDownloadUrl:Hge,getImagePreviewUrl:Vge,formatFileSize:Yc,getFileIcon:Fge,getFileTypeLabel:Bge,isAllowedFileType:u6,isImageFile:d6,config:es},Wge=({fileType:e,className:r="w-8 h-8"})=>d6(e)?s.jsx(Kg,{className:`${r} text-green-500`}):e?.includes("pdf")?s.jsx(vr,{className:`${r} text-red-500`}):e?.includes("word")||e?.includes("document")?s.jsx(vr,{className:`${r} text-blue-500`}):e?.includes("excel")||e?.includes("sheet")?s.jsx(vr,{className:`${r} text-green-600`}):e?.includes("powerpoint")||e?.includes("presentation")?s.jsx(vr,{className:`${r} text-orange-500`}):e?.includes("zip")||e?.includes("rar")||e?.includes("7z")?s.jsx(mg,{className:`${r} text-yellow-600`}):s.jsx(mg,{className:`${r} text-gray-500`}),Kge=({attachment:e,onClose:r,onDownload:t})=>{const[n,a]=R.useState(null),[i,o]=R.useState(!0);return R.useEffect(()=>{(async()=>{const{url:u}=await ff.getDownloadUrl(e.file_path);a(u),o(!1)})()},[e.file_path]),s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",onClick:r,children:s.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] bg-white rounded-lg overflow-hidden shadow-2xl",onClick:c=>c.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx(Kg,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-900 truncate",children:e.file_name}),s.jsxs("span",{className:"text-sm text-gray-500",children:["(",Yc(e.file_size),")"]})]}),s.jsx("button",{onClick:r,className:"p-1 text-gray-500 hover:text-gray-700 rounded-lg hover:bg-gray-200",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"p-4 flex items-center justify-center bg-gray-100 min-h-[300px]",children:i?s.jsx(Mt,{className:"w-8 h-8 text-gray-400 animate-spin"}):n?s.jsx("img",{src:n,alt:e.file_name,className:"max-w-full max-h-[70vh] object-contain"}):s.jsx("p",{className:"text-gray-500",children:"Khng th ti hnh nh"})}),s.jsx("div",{className:"flex items-center justify-end gap-2 px-4 py-3 border-t bg-gray-50",children:s.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[s.jsx(Wg,{className:"w-4 h-4"}),"Ti xung"]})})]})})},Gge=({attachment:e,canDelete:r,onDelete:t,onPreview:n})=>{const[a,i]=R.useState(!1),[o,c]=R.useState(!1),u=async()=>{i(!0);try{const{url:f,error:p}=await ff.getDownloadUrl(e.file_path);if(p||!f){alert("Li ti file: "+(p?.message||"Khng th to link download"));return}const h=document.createElement("a");h.href=f,h.download=e.file_name,h.target="_blank",document.body.appendChild(h),h.click(),document.body.removeChild(h)}finally{i(!1)}},l=async()=>{confirm(`Xa file "${e.file_name}"?`)&&(c(!0),t(e.id))},d=d6(e.file_type);return s.jsxs("div",{className:"group flex items-center gap-3 p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Wge,{fileType:e.file_type,className:"w-10 h-10"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",title:e.file_name,children:e.file_name}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[s.jsx("span",{children:Yc(e.file_size)}),e.uploader&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:e.uploader.full_name})]}),s.jsx("span",{children:""}),s.jsx("span",{children:new Date(e.uploaded_at).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),e.description&&s.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",title:e.description,children:e.description})]}),s.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[d&&s.jsx("button",{onClick:()=>n(e),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem trc",children:s.jsx(ja,{className:"w-4 h-4"})}),s.jsx("button",{onClick:u,disabled:a,className:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Ti xung",children:a?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(Wg,{className:"w-4 h-4"})}),r&&s.jsx("button",{onClick:l,disabled:o,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Xa",children:o?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(En,{className:"w-4 h-4"})})]})]})},Xge=({onFilesSelected:e,disabled:r,stats:t})=>{const n=R.useRef(null),[a,i]=R.useState(!1),o=R.useCallback(f=>{f.preventDefault(),f.stopPropagation(),f.type==="dragenter"||f.type==="dragover"?i(!0):f.type==="dragleave"&&i(!1)},[]),c=R.useCallback(f=>{f.preventDefault(),f.stopPropagation(),i(!1),f.dataTransfer.files&&f.dataTransfer.files.length>0&&e(f.dataTransfer.files)},[e]),u=()=>{n.current?.click()},l=f=>{f.target.files&&f.target.files.length>0&&(e(f.target.files),f.target.value="")},d=Object.keys(es.ALLOWED_TYPES).join(",");return s.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer
        ${a?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}
        ${r?"opacity-50 cursor-not-allowed":""}
      `,onDragEnter:o,onDragLeave:o,onDragOver:o,onDrop:c,onClick:r?void 0:u,children:[s.jsx("input",{ref:n,type:"file",multiple:!0,accept:d,onChange:l,className:"hidden",disabled:r}),s.jsx(Gg,{className:`w-10 h-10 mx-auto mb-3 ${a?"text-blue-500":"text-gray-400"}`}),s.jsx("p",{className:"text-sm font-medium text-gray-700",children:a?"Th file vo y":"Ko th file hoc click  chn"}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["PDF, Word, Excel, Hnh nh, ZIP (ti a ",Yc(es.MAX_FILE_SIZE),"/file)"]}),s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:[" dng: ",t.count,"/",t.maxCount," file  ",Yc(t.totalSize),"/",Yc(t.maxTotalSize)]})]})},Yge=({item:e,onCancel:r})=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex-shrink-0",children:[e.status==="uploading"&&s.jsx(Mt,{className:"w-8 h-8 text-blue-500 animate-spin"}),e.status==="success"&&s.jsx(hn,{className:"w-8 h-8 text-green-500"}),e.status==="error"&&s.jsx(Cr,{className:"w-8 h-8 text-red-500"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-gray-900 truncate",children:e.file.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[Yc(e.file.size),e.status==="uploading"&&"  ang ti ln...",e.status==="success"&&"  Hon tt",e.status==="error"&&s.jsxs("span",{className:"text-red-500",children:["  ",e.error||"Li"]})]})]}),e.status==="uploading"&&r&&s.jsx("button",{onClick:r,className:"p-1 text-gray-500 hover:text-red-500 rounded",title:"Hy",children:s.jsx(Br,{className:"w-4 h-4"})})]}),Qge=({taskId:e,currentUserId:r,canEdit:t=!1,className:n=""})=>{const[a,i]=R.useState([]),[o,c]=R.useState({count:0,totalSize:0,maxCount:es.MAX_FILES_PER_TASK,maxTotalSize:es.MAX_TOTAL_SIZE_PER_TASK,canUpload:!0}),[u,l]=R.useState(!0),[d,f]=R.useState([]),[p,h]=R.useState(null),[y,g]=R.useState(!0),m=R.useCallback(async()=>{l(!0);try{const[P,B]=await Promise.all([ff.getTaskAttachments(e),ff.getAttachmentStats(e)]);i(P.data),c(B)}catch(P){console.error("Error loading attachments:",P)}finally{l(!1)}},[e]);R.useEffect(()=>{m()},[m]);const x=async P=>{const B=Array.from(P),T=[];for(const U of B){if(!u6(U.type)){alert(`File "${U.name}" khng c h tr`);continue}if(U.size>es.MAX_FILE_SIZE){alert(`File "${U.name}" qu ln (max ${Yc(es.MAX_FILE_SIZE)})`);continue}T.push(U)}if(T.length===0)return;if(o.count+T.length>o.maxCount){alert(`Ch c th upload thm ${o.maxCount-o.count} file`);return}const I=T.map(U=>({id:`${Date.now()}_${U.name}`,file:U,progress:0,status:"uploading"}));f(U=>[...U,...I]);for(const U of I)try{const{data:H,error:z}=await ff.uploadAttachment({task_id:e,file:U.file,uploaded_by:r});z||!H?f(O=>O.map(L=>L.id===U.id?{...L,status:"error",error:z?.message||"Li upload"}:L)):(f(O=>O.map(L=>L.id===U.id?{...L,status:"success"}:L)),i(O=>[H,...O]),c(O=>({...O,count:O.count+1,totalSize:O.totalSize+H.file_size,canUpload:O.count+1<O.maxCount})))}catch{f(z=>z.map(O=>O.id===U.id?{...O,status:"error",error:"Li khng xc nh"}:O))}setTimeout(()=>{f(U=>U.filter(H=>H.status==="uploading"))},3e3)},v=async P=>{const B=a.find(U=>U.id===P);if(!B)return;const{success:T,error:I}=await ff.deleteAttachment(P,r);T?(i(U=>U.filter(H=>H.id!==P)),c(U=>({...U,count:U.count-1,totalSize:U.totalSize-B.file_size,canUpload:!0}))):alert("Li xa file: "+(I?.message||"Khng xc nh"))},w=P=>{h(P)},_=async()=>{if(!p)return;const{url:P}=await ff.getDownloadUrl(p.file_path);P&&window.open(P,"_blank")},A=P=>t||P.uploaded_by===r;return s.jsxs("div",{className:`bg-white rounded-xl border border-gray-200 overflow-hidden ${n}`,children:[s.jsxs("button",{onClick:()=>g(!y),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(AS,{className:"w-5 h-5 text-gray-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"File nh km"}),a.length>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:a.length})]}),y?s.jsx(si,{className:"w-5 h-5 text-gray-500"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-500"})]}),y&&s.jsxs("div",{className:"p-4 space-y-4",children:[t&&s.jsx(Xge,{onFilesSelected:x,disabled:!o.canUpload,stats:o}),d.length>0&&s.jsx("div",{className:"space-y-2",children:d.map(P=>s.jsx(Yge,{item:P},P.id))}),u?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(Mt,{className:"w-6 h-6 text-gray-400 animate-spin"})}):a.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(AS,{className:"w-10 h-10 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"Cha c file nh km"})]}):s.jsx("div",{className:"space-y-2",children:a.map(P=>s.jsx(Gge,{attachment:P,canDelete:A(P),onDelete:v,onPreview:w},P.id))})]}),p&&s.jsx(Kge,{attachment:p,onClose:()=>h(null),onDownload:_})]})};function iF(e){const r=new Date(e),n=new Date().getTime()-r.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),o=Math.floor(i/60),c=Math.floor(o/24);return a<60?"Va xong":i<60?`${i} pht trc`:o<24?`${o} gi trc`:c===1?"Hm qua":c<7?`${c} ngy trc`:r.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function Zge(e){console.log(" [taskCommentService] getComments for task:",e);try{const{data:r,error:t}=await se.from("task_comments").select(`
        *,
        author:employees!task_comments_author_id_fkey(
          id,
          full_name,
          avatar_url,
          email
        )
      `).eq("task_id",e).eq("is_deleted",!1).order("created_at",{ascending:!0});if(t)throw t;const n=(r||[]).map(c=>({...c,author:Array.isArray(c.author)?c.author[0]:c.author})),a=[],i={};n.forEach(c=>{c.parent_comment_id?(i[c.parent_comment_id]||(i[c.parent_comment_id]=[]),i[c.parent_comment_id].push(c)):a.push(c)});const o=a.map(c=>({...c,replies:i[c.id]||[]}));return console.log(" [taskCommentService] Found",o.length,"root comments"),{data:o,error:null}}catch(r){return console.error(" [taskCommentService] getComments error:",r),{data:[],error:r}}}async function Jge(e){console.log(" [taskCommentService] createComment:",e);try{if(!e.content||e.content.trim().length===0)throw new Error("Ni dung bnh lun khng c  trng");if(e.content.length>5e3)throw new Error("Ni dung bnh lun khng c vt qu 5000 k t");const{data:r,error:t}=await se.from("task_comments").insert({task_id:e.task_id,content:e.content.trim(),author_id:e.author_id,parent_comment_id:e.parent_comment_id||null}).select(`
        *,
        author:employees!task_comments_author_id_fkey(
          id,
          full_name,
          avatar_url,
          email
        )
      `).single();if(t)throw t;const n={...r,author:Array.isArray(r.author)?r.author[0]:r.author,replies:[]};return console.log(" [taskCommentService] Comment created:",n.id),{data:n,error:null}}catch(r){return console.error(" [taskCommentService] createComment error:",r),{data:null,error:r}}}async function eye(e,r){console.log(" [taskCommentService] updateComment:",e);try{if(!r.content||r.content.trim().length===0)throw new Error("Ni dung bnh lun khng c  trng");if(r.content.length>5e3)throw new Error("Ni dung bnh lun khng c vt qu 5000 k t");const{data:t,error:n}=await se.from("task_comments").update({content:r.content.trim(),is_edited:!0,edited_at:new Date().toISOString()}).eq("id",e).select(`
        *,
        author:employees!task_comments_author_id_fkey(
          id,
          full_name,
          avatar_url,
          email
        )
      `).single();if(n)throw n;const a={...t,author:Array.isArray(t.author)?t.author[0]:t.author};return console.log(" [taskCommentService] Comment updated:",e),{data:a,error:null}}catch(t){return console.error(" [taskCommentService] updateComment error:",t),{data:null,error:t}}}async function tye(e){console.log(" [taskCommentService] deleteComment:",e);try{const{error:r}=await se.from("task_comments").update({is_deleted:!0,deleted_at:new Date().toISOString()}).eq("id",e);if(r)throw r;return await se.from("task_comments").update({is_deleted:!0,deleted_at:new Date().toISOString()}).eq("parent_comment_id",e),console.log(" [taskCommentService] Comment deleted:",e),{success:!0,error:null}}catch(r){return console.error(" [taskCommentService] deleteComment error:",r),{success:!1,error:r}}}async function rye(e){try{const{count:r,error:t}=await se.from("task_comments").select("*",{count:"exact",head:!0}).eq("task_id",e).eq("is_deleted",!1);if(t)throw t;return r||0}catch(r){return console.error(" [taskCommentService] getCommentCount error:",r),0}}async function nye(e){try{const{data:r,error:t}=await se.from("task_comments").select("id, parent_comment_id").eq("task_id",e).eq("is_deleted",!1);if(t)throw t;const n=r||[],a=n.filter(o=>!o.parent_comment_id).length,i=n.filter(o=>o.parent_comment_id).length;return{total:n.length,rootComments:a,replies:i}}catch(r){return console.error(" [taskCommentService] getCommentStats error:",r),{total:0,rootComments:0,replies:0}}}const Px={getComments:Zge,createComment:Jge,updateComment:eye,deleteComment:tye,getCommentCount:rye,getCommentStats:nye,formatRelativeTime:iF};function oF({comment:e,currentUserId:r,canComment:t,onReply:n,onEdit:a,onDelete:i,isReply:o=!1}){const[c,u]=R.useState(!1),l=R.useRef(null),d=e.author_id===r,f=e.author?.full_name||"Ngi dng",p=f.charAt(0).toUpperCase();return R.useEffect(()=>{function h(y){l.current&&!l.current.contains(y.target)&&u(!1)}return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),s.jsxs("div",{className:`flex gap-3 ${o?"ml-10 mt-3":""}`,children:[s.jsx("div",{className:`flex-shrink-0 ${o?"w-8 h-8":"w-10 h-10"} rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-medium ${o?"text-xs":"text-sm"}`,children:e.author?.avatar_url?s.jsx("img",{src:e.author.avatar_url,alt:f,className:"w-full h-full rounded-full object-cover"}):p}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:`font-medium text-gray-900 ${o?"text-sm":""}`,children:f}),s.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[s.jsx(Xr,{size:12}),iF(e.created_at)]}),e.is_edited&&s.jsx("span",{className:"text-xs text-gray-400 italic",children:"( chnh sa)"})]}),s.jsx("div",{className:`mt-1 text-gray-700 whitespace-pre-wrap break-words ${o?"text-sm":""}`,children:e.content}),s.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[t&&!o&&s.jsxs("button",{onClick:()=>n(e.id),className:"text-xs text-gray-500 hover:text-blue-600 flex items-center gap-1 transition-colors",children:[s.jsx(SO,{size:14}),"Tr li"]}),d&&s.jsxs("div",{className:"relative",ref:l,children:[s.jsx("button",{onClick:()=>u(!c),className:"text-xs text-gray-400 hover:text-gray-600 p-1 rounded transition-colors",children:s.jsx($b,{size:16})}),c&&s.jsxs("div",{className:"absolute left-0 top-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10 min-w-[100px]",children:[s.jsxs("button",{onClick:()=>{a(e),u(!1)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(yg,{size:14}),"Sa"]}),s.jsxs("button",{onClick:()=>{i(e.id),u(!1)},className:"w-full px-3 py-1.5 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[s.jsx(En,{size:14}),"Xa"]})]})]})]}),e.replies&&e.replies.length>0&&s.jsx("div",{className:"mt-3 space-y-3 border-l-2 border-gray-100 pl-3",children:e.replies.map(h=>s.jsx(oF,{comment:h,currentUserId:r,canComment:t,onReply:n,onEdit:a,onDelete:i,isReply:!0},h.id))})]})]})}function sye({taskId:e,currentUserId:r,canComment:t=!0}){const[n,a]=R.useState([]),[i,o]=R.useState(!0),[c,u]=R.useState(null),[l,d]=R.useState(!1),[f,p]=R.useState(""),[h,y]=R.useState(!1),[g,m]=R.useState(null),[x,v]=R.useState(null),[w,_]=R.useState(""),[A,P]=R.useState(null),B=R.useRef(null),T=async()=>{o(!0),u(null);const{data:S,error:C}=await Px.getComments(e);C?u(C.message):a(S),o(!1)};R.useEffect(()=>{e&&T()},[e]);const I=async S=>{if(S.preventDefault(),!f.trim()||h)return;y(!0),u(null);const{data:C,error:D}=await Px.createComment({task_id:e,content:f.trim(),author_id:r,parent_comment_id:g});D?u(D.message):C&&(a(g?q=>q.map(M=>M.id===g?{...M,replies:[...M.replies||[],C]}:M):q=>[...q,C]),p(""),m(null)),y(!1)},U=async S=>{if(S.preventDefault(),!x||!w.trim()||h)return;y(!0),u(null);const{data:C,error:D}=await Px.updateComment(x.id,{content:w.trim()});D?u(D.message):C&&(a(q=>q.map(M=>M.id===C.id?{...M,...C}:M.replies?{...M,replies:M.replies.map(G=>G.id===C.id?{...G,...C}:G)}:M)),v(null),_("")),y(!1)},H=async()=>{if(!A)return;y(!0);const{success:S,error:C}=await Px.deleteComment(A);C?u(C.message):S&&a(D=>D.filter(q=>q.id!==A).map(q=>({...q,replies:q.replies?.filter(M=>M.id!==A)||[]}))),P(null),y(!1)},z=S=>{m(S),v(null),B.current?.focus()},O=S=>{v(S),_(S.content),m(null)},L=()=>{m(null)},E=()=>{v(null),_("")},k=g?n.find(S=>S.id===g):null,N=n.reduce((S,C)=>S+1+(C.replies?.length||0),0);return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("button",{onClick:()=>d(!l),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(vv,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Bnh lun"}),N>0&&s.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:N})]}),l?s.jsx(Gs,{className:"w-5 h-5 text-gray-400"}):s.jsx(si,{className:"w-5 h-5 text-gray-400"})]}),!l&&s.jsxs("div",{className:"px-4 pb-4",children:[c&&s.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex items-center gap-2",children:[s.jsx(Cr,{size:16}),c]}),t&&!x&&s.jsxs("form",{onSubmit:I,className:"mb-4",children:[g&&k&&s.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-lg",children:[s.jsx(SO,{size:14}),s.jsxs("span",{children:["ang tr li"," ",s.jsx("span",{className:"font-medium text-gray-700",children:k.author?.full_name||"Ngi dng"})]}),s.jsx("button",{type:"button",onClick:L,className:"ml-auto text-gray-400 hover:text-gray-600",children:s.jsx(Br,{size:16})})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center text-white font-medium text-sm",children:s.jsx(ls,{size:18})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("textarea",{ref:B,value:f,onChange:S=>p(S.target.value),placeholder:g?"Vit tr li...":"Vit bnh lun...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none text-sm",disabled:h}),s.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-gray-400",children:[f.length,"/5000 k t"]}),s.jsxs("button",{type:"submit",disabled:!f.trim()||h,className:"flex items-center gap-1.5 px-4 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[s.jsx(Hb,{size:14}),h?"ang gi...":"Gi"]})]})]})]})]}),x&&s.jsxs("form",{onSubmit:U,className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm text-yellow-700",children:[s.jsx(yg,{size:14}),s.jsx("span",{children:"Chnh sa bnh lun"})]}),s.jsx("textarea",{value:w,onChange:S=>_(S.target.value),rows:3,className:"w-full px-3 py-2 border border-yellow-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 resize-none text-sm",disabled:h,autoFocus:!0}),s.jsxs("div",{className:"mt-2 flex items-center justify-end gap-2",children:[s.jsx("button",{type:"button",onClick:E,className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800",disabled:h,children:"Hy"}),s.jsx("button",{type:"submit",disabled:!w.trim()||h,className:"px-4 py-1.5 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"ang lu...":"Lu thay i"})]})]}),i?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"ang ti bnh lun..."})]}):n.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx(vv,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Cha c bnh lun no"}),t&&s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Hy l ngi u tin bnh lun!"})]}):s.jsx("div",{className:"space-y-4",children:n.map(S=>s.jsx(oF,{comment:S,currentUserId:r,canComment:t,onReply:z,onEdit:O,onDelete:P},S.id))})]}),A&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4 shadow-xl",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xc nhn xa"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Bn c chc mun xa bnh lun ny? Hnh ng ny khng th hon tc."}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:h,children:"Hy"}),s.jsx("button",{onClick:H,disabled:h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:h?"ang xa...":"Xa"})]})]})})]})}const h6={created:{label:" to cng vic",icon:"",color:"text-green-600",bgColor:"bg-green-100"},updated:{label:" cp nht cng vic",icon:"",color:"text-blue-600",bgColor:"bg-blue-100"},assigned:{label:" giao vic cho",icon:"",color:"text-purple-600",bgColor:"bg-purple-100"},unassigned:{label:" hy giao vic",icon:"",color:"text-gray-600",bgColor:"bg-gray-100"},status_changed:{label:" chuyn trng thi",icon:"",color:"text-blue-600",bgColor:"bg-blue-100"},progress_updated:{label:" cp nht tin ",icon:"",color:"text-cyan-600",bgColor:"bg-cyan-100"},priority_changed:{label:" i  u tin",icon:"",color:"text-orange-600",bgColor:"bg-orange-100"},due_date_changed:{label:" i hn hon thnh",icon:"",color:"text-yellow-600",bgColor:"bg-yellow-100"},comment_added:{label:" thm bnh lun",icon:"",color:"text-blue-600",bgColor:"bg-blue-100"},comment_edited:{label:" sa bnh lun",icon:"",color:"text-gray-600",bgColor:"bg-gray-100"},comment_deleted:{label:" xa bnh lun",icon:"",color:"text-red-600",bgColor:"bg-red-100"},attachment_added:{label:" nh km file",icon:"",color:"text-indigo-600",bgColor:"bg-indigo-100"},attachment_deleted:{label:" xa file nh km",icon:"",color:"text-red-600",bgColor:"bg-red-100"},self_eval_submitted:{label:" np t nh gi",icon:"",color:"text-yellow-600",bgColor:"bg-yellow-100"},self_eval_updated:{label:" cp nht t nh gi",icon:"",color:"text-yellow-600",bgColor:"bg-yellow-100"},approved:{label:" ph duyt",icon:"",color:"text-green-600",bgColor:"bg-green-100"},rejected:{label:" t chi",icon:"",color:"text-red-600",bgColor:"bg-red-100"},revision_requested:{label:" yu cu chnh sa",icon:"",color:"text-orange-600",bgColor:"bg-orange-100"},subtask_added:{label:" thm cng vic con",icon:"",color:"text-purple-600",bgColor:"bg-purple-100"},subtask_removed:{label:" xa cng vic con",icon:"",color:"text-red-600",bgColor:"bg-red-100"},subtask_completed:{label:" hon thnh cng vic con",icon:"",color:"text-green-600",bgColor:"bg-green-100"}},o4={draft:"Nhp",new:"Mi",in_progress:"ang lm",paused:"Tm dng",pending_review:"Ch review",completed:"Hon thnh",finished:"Hon thnh",cancelled:" hy",accepted:" duyt"},l4={low:"Thp",medium:"Trung bnh",high:"Cao",urgent:"Khn cp"};function lF(e){const r=new Date(e),n=new Date().getTime()-r.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),o=Math.floor(i/60),c=Math.floor(o/24);return a<60?"Va xong":i<60?`${i} pht trc`:o<24?`${o} gi trc`:c===1?"Hm qua":c<7?`${c} ngy trc`:r.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function aye(e){if(e===0)return"0 B";const r=1024,t=["B","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,n)).toFixed(1))+" "+t[n]}function cF(e){const r=h6[e.action]||{label:e.action},t=e.details||{};switch(e.action){case"assigned":return`${r.label} ${t.assignee_name||"ngi dng"}`;case"unassigned":return`${r.label} (trc : ${t.old_assignee_name||"khng r"})`;case"status_changed":const n=o4[t.old_status]||t.old_status,a=o4[t.new_status]||t.new_status;return`${r.label} ${n}  ${a}`;case"progress_updated":return`${r.label} ${t.old_progress||0}%  ${t.new_progress||0}%`;case"priority_changed":const i=l4[t.old_priority]||t.old_priority,o=l4[t.new_priority]||t.new_priority;return`${r.label} ${i}  ${o}`;case"attachment_added":return`${r.label} "${t.file_name||"file"}"`;case"comment_added":return t.is_reply?" tr li bnh lun":r.label;case"approved":return t.score?`${r.label} (${t.score} im)`:r.label;case"self_eval_submitted":return t.self_score?`${r.label} (t chm ${t.self_score} im)`:r.label;default:return r.label}}async function iye(e){console.log(" [taskActivityService] getActivities:",e);try{let r=se.from("task_activities").select(`
        *,
        actor:employees!task_activities_actor_id_fkey(
          id,
          full_name,
          avatar_url
        )
      `,{count:"exact"}).eq("task_id",e.task_id).order("created_at",{ascending:!1});e.actions&&e.actions.length>0&&(r=r.in("action",e.actions)),e.actor_id&&(r=r.eq("actor_id",e.actor_id)),e.from_date&&(r=r.gte("created_at",e.from_date)),e.to_date&&(r=r.lte("created_at",e.to_date)),e.limit&&(r=r.limit(e.limit)),e.offset&&(r=r.range(e.offset,e.offset+(e.limit||10)-1));const{data:t,count:n,error:a}=await r;if(a)throw a;const i=(t||[]).map(o=>({...o,actor:Array.isArray(o.actor)?o.actor[0]:o.actor}));return console.log(" [taskActivityService] Found",i.length,"activities"),{data:i,total:n||0,error:null}}catch(r){return console.error(" [taskActivityService] getActivities error:",r),{data:[],total:0,error:r}}}async function oye(e){console.log(" [taskActivityService] createActivity:",e);try{const{data:r,error:t}=await se.from("task_activities").insert({task_id:e.task_id,action:e.action,actor_id:e.actor_id,details:e.details||{}}).select(`
        *,
        actor:employees!task_activities_actor_id_fkey(
          id,
          full_name,
          avatar_url
        )
      `).single();if(t)throw t;const n={...r,actor:Array.isArray(r.actor)?r.actor[0]:r.actor};return console.log(" [taskActivityService] Activity created:",n.id),{data:n,error:null}}catch(r){return console.error(" [taskActivityService] createActivity error:",r),{data:null,error:r}}}async function lye(e){try{const{count:r,error:t}=await se.from("task_activities").select("*",{count:"exact",head:!0}).eq("task_id",e);if(t)throw t;return r||0}catch(r){return console.error(" [taskActivityService] getActivityCount error:",r),0}}const uF={getActivities:iye,createActivity:oye,getActivityCount:lye,formatRelativeTime:lF,formatFileSize:aye,generateActivityDescription:cF,ACTION_CONFIG:h6,STATUS_LABELS:o4,PRIORITY_LABELS:l4};function cye({activity:e}){const r=h6[e.action]||{label:e.action,icon:"",color:"text-gray-600",bgColor:"bg-gray-100"},t=e.actor?.full_name||"H thng",n=cF(e);return s.jsxs("div",{className:"flex gap-3 group",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm ${r.bgColor}`,children:r.icon}),s.jsx("div",{className:"w-0.5 bg-gray-200 flex-1 mt-2 group-last:hidden"})]}),s.jsx("div",{className:"flex-1 pb-6 group-last:pb-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-medium text-gray-900",children:t})," ",s.jsx("span",{className:r.color,children:n})]}),e.details?.content_preview&&s.jsxs("p",{className:"mt-1 text-xs text-gray-500 italic line-clamp-2",children:['"',e.details.content_preview,'..."']}),e.details?.file_name&&s.jsxs("p",{className:"mt-1 text-xs text-gray-500 flex items-center gap-1",children:[" ",e.details.file_name,e.details.file_size&&s.jsxs("span",{className:"text-gray-400",children:["(",uF.formatFileSize(e.details.file_size),")"]})]}),e.details?.comments&&e.action==="approved"&&s.jsxs("p",{className:"mt-1 text-xs text-gray-500 italic",children:['"',e.details.comments,'"']})]}),s.jsxs("span",{className:"text-xs text-gray-400 whitespace-nowrap flex items-center gap-1",children:[s.jsx(Xr,{size:12}),lF(e.created_at)]})]})})]})}const uye=[{value:"all",label:"Tt c"},{value:"status_changed",label:"Trng thi"},{value:"progress_updated",label:"Tin "},{value:"assigned",label:"Giao vic"},{value:"comment_added",label:"Bnh lun"},{value:"attachment_added",label:"File"},{value:"approved",label:"Ph duyt"}];function dye({taskId:e,maxItems:r=10,showFilters:t=!0}){const[n,a]=R.useState([]),[i,o]=R.useState(0),[c,u]=R.useState(!0),[l,d]=R.useState(null),[f,p]=R.useState(!1),[h,y]=R.useState(!1),[g,m]=R.useState("all"),[x,v]=R.useState(0),w=n.length<i,_=async(I=!1)=>{I?(u(!0),v(0)):y(!0),d(null);const U=I?0:x,H={task_id:e,limit:r,offset:U};g!=="all"&&(g==="approved"?H.actions=["approved","rejected","revision_requested"]:g==="assigned"?H.actions=["assigned","unassigned"]:g==="comment_added"?H.actions=["comment_added","comment_edited","comment_deleted"]:g==="attachment_added"?H.actions=["attachment_added","attachment_deleted"]:H.actions=[g]);const{data:z,total:O,error:L}=await uF.getActivities(H);L?d(L.message):(a(I?z:E=>[...E,...z]),o(O),v(U+z.length)),u(!1),y(!1)};R.useEffect(()=>{e&&_(!0)},[e,g]);const A=()=>{!h&&w&&_(!1)},P=I=>{I.stopPropagation(),_(!0)},B=I=>{m(I)},T=()=>{p(!f)};return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{onClick:T,className:"flex items-center gap-2 flex-1 cursor-pointer",children:[s.jsx(Z5,{className:"w-5 h-5 text-indigo-600"}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Lch s hot ng"}),i>0&&s.jsx("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:i})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:P,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Lm mi",children:s.jsx(Vr,{size:16,className:c?"animate-spin":""})}),s.jsx("button",{onClick:T,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",children:f?s.jsx(Gs,{className:"w-5 h-5"}):s.jsx(si,{className:"w-5 h-5"})})]})]}),!f&&s.jsxs("div",{className:"px-4 pb-4",children:[t&&s.jsxs("div",{className:"mb-4 flex items-center gap-2 flex-wrap",children:[s.jsx(Al,{size:14,className:"text-gray-400"}),uye.map(I=>s.jsx("button",{onClick:()=>B(I.value),className:`px-2.5 py-1 text-xs font-medium rounded-full transition-colors ${g===I.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:I.label},I.value))]}),l&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:l}),c?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"ang ti lch s..."})]}):n.length===0?s.jsxs("div",{className:"py-8 text-center",children:[s.jsx(Z5,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"Cha c hot ng no"}),g!=="all"&&s.jsx("button",{onClick:()=>m("all"),className:"mt-2 text-sm text-indigo-600 hover:text-indigo-700",children:"Xem tt c hot ng"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-0",children:n.map(I=>s.jsx(cye,{activity:I},I.id))}),w&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("button",{onClick:A,disabled:h,className:"px-4 py-2 text-sm text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 rounded-lg disabled:opacity-50",children:h?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Vr,{size:14,className:"animate-spin"}),"ang ti..."]}):`Xem thm (cn ${i-n.length})`})}),!w&&n.length>0&&s.jsxs("p",{className:"mt-4 text-center text-xs text-gray-400",children:[" hin th tt c ",i," hot ng"]})]})]})]})}const rd={async getParticipants(e){console.log(" [taskParticipantService] getParticipants for task:",e);try{const{data:r,error:t}=await se.from("task_assignments").select(`
          id,
          task_id,
          employee_id,
          role,
          status,
          note,
          invited_by,
          invitation_note,
          assigned_at,
          accepted_at,
          responded_at,
          created_at,
          employee:employees!task_assignments_employee_id_fkey(
            id,
            code,
            full_name,
            email,
            department_id,
            department:departments!employees_department_id_fkey(name),
            position:positions(name, level)
          ),
          inviter:employees!task_assignments_invited_by_fkey(full_name)
        `).eq("task_id",e).eq("role","participant").not("status","in","(removed,declined)").order("created_at",{ascending:!0});if(t)throw t;const n=(r||[]).map(a=>({id:a.id,task_id:a.task_id,employee_id:a.employee_id,role:a.role,status:a.status,note:a.note,invited_by:a.invited_by,invitation_note:a.invitation_note,assigned_at:a.assigned_at,accepted_at:a.accepted_at,responded_at:a.responded_at,created_at:a.created_at,employee_code:a.employee?.code,employee_name:a.employee?.full_name,employee_email:a.employee?.email,employee_department_id:a.employee?.department_id,employee_department_name:a.employee?.department?.name,employee_position_name:a.employee?.position?.name,employee_position_level:a.employee?.position?.level,inviter_name:a.inviter?.full_name}));return console.log(" [taskParticipantService] Found",n.length,"participants"),{data:n,error:null}}catch(r){return console.error(" [taskParticipantService] getParticipants error:",r),{data:[],error:r}}},async checkCanAddParticipant(e,r,t){console.log(" [taskParticipantService] checkCanAddParticipant:",{requesterId:e,targetEmployeeId:r,taskId:t});try{const{data:n,error:a}=await se.from("employees").select(`
          id,
          department_id,
          position:positions(level)
        `).eq("id",e).single();if(a||!n)return{can_add:!1,add_type:null,reason:"Khng tm thy thng tin ngi yu cu"};const{data:i,error:o}=await se.from("employees").select("id, department_id").eq("id",r).single();if(o||!i)return{can_add:!1,add_type:null,reason:"Khng tm thy nhn vin"};const{data:c,error:u}=await se.from("tasks").select("id, department_id, assignee_id").eq("id",t).single();if(u||!c)return{can_add:!1,add_type:null,reason:"Khng tm thy cng vic"};const{data:l}=await se.from("task_assignments").select("id").eq("task_id",t).eq("employee_id",r).not("status","in","(removed,declined)").single();if(l)return{can_add:!1,add_type:null,reason:"Nhn vin  l ngi tham gia"};if(c.assignee_id===r)return{can_add:!1,add_type:null,reason:"Nhn vin  l ngi ph trch chnh"};const d=n.position?.level||99,f=n.department_id,p=i.department_id;return d<=3?{can_add:!0,add_type:"direct",reason:"c php thm trc tip"}:d<=5?f===p?{can_add:!0,add_type:"direct",reason:"c php thm trc tip (cng phng)"}:{can_add:!1,add_type:null,reason:"Ch c thm nhn vin trong phng ban ca bn"}:f===p?{can_add:!0,add_type:"request",reason:"Gi yu cu tham gia"}:{can_add:!1,add_type:null,reason:"Ch c mi ng nghip cng phng ban"}}catch(n){return console.error(" [taskParticipantService] checkCanAddParticipant error:",n),{can_add:!1,add_type:null,reason:"C li xy ra"}}},async addParticipant(e){console.log(" [taskParticipantService] addParticipant:",e);try{const r=await this.checkCanAddParticipant(e.invited_by,e.employee_id,e.task_id);if(!r.can_add)return{success:!1,error:r.reason};const t=r.add_type==="direct"?"accepted":"pending",n=r.add_type==="direct"?new Date().toISOString():null,{data:a,error:i}=await se.from("task_assignments").insert({task_id:e.task_id,employee_id:e.employee_id,role:"participant",status:t,invited_by:e.invited_by,invitation_note:e.invitation_note||null,assigned_at:new Date().toISOString(),accepted_at:n}).select(`
          id,
          task_id,
          employee_id,
          role,
          status,
          invited_by,
          invitation_note,
          assigned_at,
          accepted_at,
          created_at,
          employee:employees!task_assignments_employee_id_fkey(
            code,
            full_name,
            department:departments!employees_department_id_fkey(name),
            position:positions(name, level)
          )
        `).single();if(i)throw i;return console.log(" [taskParticipantService] Added participant:",a.id,"status:",t),{success:!0,data:{id:a.id,task_id:a.task_id,employee_id:a.employee_id,role:a.role,status:a.status,invited_by:a.invited_by,invitation_note:a.invitation_note,assigned_at:a.assigned_at,accepted_at:a.accepted_at,created_at:a.created_at,employee_code:a.employee?.code,employee_name:a.employee?.full_name,employee_department_name:a.employee?.department?.name,employee_position_name:a.employee?.position?.name,employee_position_level:a.employee?.position?.level}}}catch(r){return console.error(" [taskParticipantService] addParticipant error:",r),{success:!1,error:r.message||"Khng th thm ngi tham gia"}}},async removeParticipant(e){console.log(" [taskParticipantService] removeParticipant:",e);try{const{error:r}=await se.from("task_assignments").update({status:"removed",responded_at:new Date().toISOString()}).eq("id",e);if(r)throw r;return console.log(" [taskParticipantService] Removed participant:",e),{success:!0}}catch(r){return console.error(" [taskParticipantService] removeParticipant error:",r),{success:!1,error:r.message||"Khng th xa ngi tham gia"}}},async getPendingRequests(e){console.log(" [taskParticipantService] getPendingRequests for:",e);try{const{data:r,error:t}=await se.from("task_assignments").select(`
          id,
          task_id,
          employee_id,
          invited_by,
          invitation_note,
          created_at,
          task:tasks(
            code,
            name,
            description,
            status,
            priority,
            due_date,
            progress
          ),
          inviter:employees!task_assignments_invited_by_fkey(
            full_name,
            code,
            department:departments!employees_department_id_fkey(name)
          )
        `).eq("employee_id",e).eq("status","pending").eq("role","participant").order("created_at",{ascending:!1});if(t)throw t;const n=(r||[]).map(a=>({id:a.id,task_id:a.task_id,employee_id:a.employee_id,invited_by:a.invited_by,invitation_note:a.invitation_note,requested_at:a.created_at,task_code:a.task?.code,task_name:a.task?.name,task_description:a.task?.description,task_status:a.task?.status,task_priority:a.task?.priority,task_due_date:a.task?.due_date,task_progress:a.task?.progress||0,inviter_name:a.inviter?.full_name,inviter_code:a.inviter?.code,inviter_department_name:a.inviter?.department?.name}));return console.log(" [taskParticipantService] Found",n.length,"pending requests"),{data:n,error:null}}catch(r){return console.error(" [taskParticipantService] getPendingRequests error:",r),{data:[],error:r}}},async countPendingRequests(e){try{const{count:r,error:t}=await se.from("task_assignments").select("id",{count:"exact",head:!0}).eq("employee_id",e).eq("status","pending").eq("role","participant");if(t)throw t;return r||0}catch(r){return console.error(" [taskParticipantService] countPendingRequests error:",r),0}},async acceptRequest(e){console.log(" [taskParticipantService] acceptRequest:",e);try{const{error:r}=await se.from("task_assignments").update({status:"accepted",accepted_at:new Date().toISOString(),responded_at:new Date().toISOString()}).eq("id",e);if(r)throw r;return console.log(" [taskParticipantService] Accepted request:",e),{success:!0}}catch(r){return console.error(" [taskParticipantService] acceptRequest error:",r),{success:!1,error:r.message||"Khng th chp nhn yu cu"}}},async rejectRequest(e,r){console.log(" [taskParticipantService] rejectRequest:",e);try{const{error:t}=await se.from("task_assignments").update({status:"declined",note:r||null,responded_at:new Date().toISOString()}).eq("id",e);if(t)throw t;return console.log(" [taskParticipantService] Rejected request:",e),{success:!0}}catch(t){return console.error(" [taskParticipantService] rejectRequest error:",t),{success:!1,error:t.message||"Khng th t chi yu cu"}}},async getAvailableEmployees(e,r){console.log(" [taskParticipantService] getAvailableEmployees for task:",e,"requester:",r);try{const{data:t,error:n}=await se.from("employees").select(`
          id,
          department_id,
          position:positions(level)
        `).eq("id",r).single();if(n)return console.error(" [taskParticipantService] Error fetching requester:",n),{data:[],error:new Error("Khng tm thy thng tin ngi dng")};if(!t)return console.error(" [taskParticipantService] Requester not found"),{data:[],error:new Error("Khng tm thy thng tin ngi dng")};console.log(" [taskParticipantService] Requester info:",t);const{data:a,error:i}=await se.from("tasks").select("id, assignee_id").eq("id",e).single();if(i||!a)return console.error(" [taskParticipantService] Task not found:",i),{data:[],error:new Error("Khng tm thy cng vic")};console.log(" [taskParticipantService] Task info:",a);const{data:o}=await se.from("task_assignments").select("employee_id").eq("task_id",e).not("status","in","(removed,declined)"),c=new Set;c.add(r),a.assignee_id&&c.add(a.assignee_id),o&&o.forEach(g=>{g.employee_id&&c.add(g.employee_id)}),console.log(" [taskParticipantService] Excluded IDs:",Array.from(c));const u=t.position?.level||99,l=t.department_id;console.log(" [taskParticipantService] Requester level:",u,"dept:",l);let d=se.from("employees").select(`
          id,
          code,
          full_name,
          email,
          department_id,
          department:departments!employees_department_id_fkey(name),
          position:positions(name, level)
        `).eq("status","active").order("full_name",{ascending:!0});u>3&&l&&(console.log(" [taskParticipantService] Filtering by department:",l),d=d.eq("department_id",l));const{data:f,error:p}=await d;if(p)throw console.error(" [taskParticipantService] Query error:",p),p;console.log(" [taskParticipantService] Raw query returned:",f?.length||0,"employees");const h=(f||[]).filter(g=>!c.has(g.id));console.log(" [taskParticipantService] After filtering excluded:",h.length,"employees");const y=h.map(g=>({id:g.id,code:g.code,full_name:g.full_name,email:g.email,department_id:g.department_id,department_name:g.department?.name||"",position_name:g.position?.name,position_level:g.position?.level}));return console.log(" [taskParticipantService] Found",y.length,"available employees"),{data:y,error:null}}catch(t){return console.error(" [taskParticipantService] getAvailableEmployees error:",t),{data:[],error:t}}}},jT={accepted:{label:"ang tham gia",color:"text-green-700",bgColor:"bg-green-100",icon:s.jsx($i,{className:"w-3 h-3"})},pending:{label:"Ch xc nhn",color:"text-yellow-700",bgColor:"bg-yellow-100",icon:s.jsx(Xr,{className:"w-3 h-3"})},declined:{label:" t chi",color:"text-red-700",bgColor:"bg-red-100",icon:s.jsx(ua,{className:"w-3 h-3"})},completed:{label:"Hon thnh",color:"text-blue-700",bgColor:"bg-blue-100",icon:s.jsx($i,{className:"w-3 h-3"})}},hye=({participant:e,canRemove:r,onRemove:t,isRemoving:n})=>{const a=jT[e.status]||jT.accepted;return s.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all ${e.status==="accepted"||e.status==="completed"?"bg-white border-gray-200 hover:border-gray-300":e.status==="pending"?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200 opacity-60"}`,children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium ${e.status==="accepted"||e.status==="completed"?"bg-blue-500":"bg-gray-400"}`,children:e.employee_name?.charAt(0)?.toUpperCase()||"?"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-gray-900 text-sm truncate",children:e.employee_name}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium ${a.bgColor} ${a.color}`,children:[a.icon,a.label]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[e.employee_department_name&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx($r,{className:"w-3 h-3"}),e.employee_department_name]}),e.employee_position_name&&s.jsxs("span",{children:[" ",e.employee_position_name]})]})]}),r&&e.status!=="declined"&&s.jsx("button",{onClick:t,disabled:n,className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Xa khi cng vic",children:n?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(Br,{className:"w-4 h-4"})})]})},fye=({isOpen:e,onClose:r,taskId:t,requesterId:n,onSuccess:a})=>{const[i,o]=R.useState([]),[c,u]=R.useState(!0),[l,d]=R.useState(""),[f,p]=R.useState([]),[h,y]=R.useState(""),[g,m]=R.useState(!1),[x,v]=R.useState(null),[w,_]=R.useState(null);R.useEffect(()=>{if(!e)return;(async()=>{u(!0),v(null);const{data:I,error:U}=await rd.getAvailableEmployees(t,n);if(U)v(U.message);else if(o(I),I.length>0){const H=await rd.checkCanAddParticipant(n,I[0].id,t);_(H.add_type)}u(!1)})()},[e,t,n]);const A=i.filter(T=>T.full_name.toLowerCase().includes(l.toLowerCase())||T.code.toLowerCase().includes(l.toLowerCase())||T.department_name.toLowerCase().includes(l.toLowerCase())),P=T=>{p(I=>I.includes(T)?I.filter(U=>U!==T):[...I,T])},B=async()=>{if(f.length===0)return;m(!0),v(null);let T=0;const I=[];for(const U of f){const H=await rd.addParticipant({task_id:t,employee_id:U,invited_by:n,invitation_note:h||void 0});H.success?T++:I.push(H.error||"Li khng xc nh")}m(!1),T>0&&(a(),r(),p([]),y("")),I.length>0&&v(I.join(", "))};return e?s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[80vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:w==="request"?"Yu cu thm ngi tham gia":"Thm ngi tham gia"}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:w==="request"?"Gi yu cu cho ng nghip tham gia cng vic":"Chn nhn vin  thm vo cng vic"})]}),s.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s.jsxs("div",{className:"relative mb-4",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm kim nhn vin...",value:l,onChange:T=>d(T.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),x&&s.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700 text-sm",children:[s.jsx(Cr,{className:"w-4 h-4 flex-shrink-0"}),x]}),c?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Mt,{className:"w-6 h-6 animate-spin text-gray-400"})}):i.length===0?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(_i,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{children:"Khng c nhn vin no c th thm"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-2 mb-4",children:A.map(T=>s.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${f.includes(T.id)?"bg-blue-50 border-blue-300 ring-1 ring-blue-200":"bg-white border-gray-200 hover:border-gray-300"}`,children:[s.jsx("input",{type:"checkbox",checked:f.includes(T.id),onChange:()=>P(T.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),s.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-medium",children:T.full_name.charAt(0).toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-gray-900",children:T.full_name}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[s.jsx("span",{children:T.code}),s.jsx("span",{children:""}),s.jsx("span",{children:T.department_name}),T.position_name&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:T.position_name})]})]})]})]},T.id))}),w==="request"&&f.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do yu cu ",s.jsx("span",{className:"text-gray-400",children:"(ty chn)"})]}),s.jsx("textarea",{value:h,onChange:T=>y(T.target.value),placeholder:"Nu l do bn mun mi ngi ny tham gia...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),w==="request"&&s.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm text-yellow-700",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),s.jsx("p",{children:"Yu cu s c gi n ngi c chn. H cn chp nhn  tham gia cng vic."})]})})]})]}),s.jsxs("div",{className:"px-6 py-4 border-t bg-gray-50 rounded-b-xl flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:[" chn: ",s.jsx("strong",{children:f.length})," ngi"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),s.jsxs("button",{onClick:B,disabled:g||f.length===0,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[g?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(Wb,{className:"w-4 h-4"}),w==="request"?"Gi yu cu":"Thm ngay"]})]})]})]})]})}):null},dF=({taskId:e,taskAssigneeId:r,onParticipantChange:t})=>{const{user:n}=xn(),[a,i]=R.useState([]),[o,c]=R.useState(!0),[u,l]=R.useState(!0),[d,f]=R.useState(!1),[p,h]=R.useState(null),y=n?.role==="admin"||n?.role==="manager",m=n?.employee_id===r||y,x=R.useCallback(async()=>{c(!0);const{data:A}=await rd.getParticipants(e);i(A),c(!1)},[e]);R.useEffect(()=>{x()},[x]);const v=async A=>{if(!confirm("Bn c chc mun xa ngi ny khi cng vic?"))return;h(A);const P=await rd.removeParticipant(A);P.success?(await x(),t?.()):alert(P.error||"Khng th xa ngi tham gia"),h(null)},w=a.filter(A=>A.status==="accepted"||A.status==="completed").length,_=a.filter(A=>A.status==="pending").length;return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>l(!u),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(_i,{className:"w-5 h-5 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Ngi tham gia"}),s.jsxs("p",{className:"text-sm text-gray-500",children:[w>0?`${w} ngi ang tham gia`:"Cha c ngi tham gia",_>0&&s.jsxs("span",{className:"text-yellow-600",children:["  ",_," ang ch"]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[m&&s.jsxs("button",{onClick:A=>{A.stopPropagation(),f(!0)},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[s.jsx(Wb,{className:"w-4 h-4"}),"Thm"]}),u?s.jsx(si,{className:"w-5 h-5 text-gray-400"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-400"})]})]}),u&&s.jsx("div",{className:"px-6 pb-6",children:o?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(Mt,{className:"w-6 h-6 animate-spin text-gray-400"})}):a.length===0?s.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[s.jsx(_i,{className:"w-10 h-10 mx-auto mb-2 text-gray-300"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Cha c ngi tham gia"}),m&&s.jsx("button",{onClick:()=>f(!0),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Thm ngi tham gia"})]}):s.jsx("div",{className:"grid gap-2 sm:grid-cols-2",children:a.map(A=>s.jsx(hye,{participant:A,canRemove:y,onRemove:()=>v(A.id),isRemoving:p===A.id},A.id))})}),s.jsx(fye,{isOpen:d,onClose:()=>f(!1),taskId:e,requesterId:n?.employee_id||"",onSuccess:()=>{x(),t?.()}})]})},NT={none:{label:"Cha nh gi",color:"text-gray-600",bgColor:"bg-gray-100"},pending_self_eval:{label:"Ch t nh gi",color:"text-yellow-600",bgColor:"bg-yellow-100"},pending_approval:{label:"Ch duyt",color:"text-blue-600",bgColor:"bg-blue-100"},approved:{label:" duyt",color:"text-green-600",bgColor:"bg-green-100"},rejected:{label:"T chi",color:"text-red-600",bgColor:"bg-red-100"},revision_required:{label:"Cn sa",color:"text-orange-600",bgColor:"bg-orange-100"}};function pye(e,r){const t=e?.evaluation_status||"none",n=e?.status||"draft";return t==="pending_approval"?{canEdit:!1,canDelete:!1,editDisabledReason:"Cng vic ang ch ph duyt, khng th sa",deleteDisabledReason:"Cng vic ang ch ph duyt, khng th xa",isLocked:!0,lockMessage:"Cng vic ang ch ph duyt nh gi"}:t==="approved"?{canEdit:!1,canDelete:!1,editDisabledReason:"Cng vic  c duyt, khng th sa",deleteDisabledReason:"Cng vic  c duyt, khng th xa",isLocked:!0,lockMessage:"Cng vic  hon tt quy trnh nh gi"}:n==="cancelled"?{canEdit:!1,canDelete:r==="admin",editDisabledReason:"Cng vic  hy, khng th sa",deleteDisabledReason:r!=="admin"?"Ch admin mi c th xa cng vic  hy":void 0,isLocked:!1}:{canEdit:!0,canDelete:!0,isLocked:!1}}function mye(){const{id:e}=_h(),r=ts(),[t,n]=R.useState(!1),{user:a}=xn(),[i,o]=R.useState(!1),[,c]=R.useState(!0),[u,l]=R.useState(0),{data:d,isLoading:f,error:p,refetch:h}=vge(e||""),y=nF();R.useEffect(()=>{(async()=>{if(!d||!e)return;const I=d;if(o(!!I.parent_task_id),I.parent_task_id)c(!1);else{const U=await ys.canHaveChildren(e);c(U.canCreate);const H=await ys.getSubtaskCount(e);l(H)}})()},[d,e]);const g=T=>{if(!T)return"-";try{return new Date(T).toLocaleString("vi-VN")}catch{return"-"}},m=async()=>{if(e){if(u>0){alert(`Khng th xa cng vic ny v cn ${u} cng vic con. Vui lng xa cng vic con trc.`),n(!1);return}try{await y.mutateAsync(e),r("/tasks")}catch(T){console.error("Delete error:",T)}}},x=()=>{h()};if(f)return s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"animate-pulse space-y-4",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});if(p)return s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:["Li: ",p.message]})});if(!d)return s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:"Khng tm thy cng vic"})});const v=d,w=v.title||v.name||"Khng c tiu ",_=v.progress||0,A=v.evaluation_status||"none",P=NT[A]||NT.none,B=pye(v,a?.role);return s.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>r("/tasks"),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(wo,{size:20})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:w}),i&&s.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:"Cng vic con"}),u>0&&s.jsxs("span",{className:"px-2 py-1 text-xs bg-purple-100 text-purple-700 rounded-full flex items-center gap-1",children:[s.jsx(_i,{size:12}),u," con"]})]}),v.code&&s.jsxs("p",{className:"text-gray-500 text-sm",children:["M: ",v.code]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[B.canEdit?s.jsxs($a,{to:`/tasks/${e}/edit`,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(ad,{size:18})," Sa"]}):s.jsxs("button",{disabled:!0,title:B.editDisabledReason,className:"flex items-center gap-2 px-4 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed",children:[s.jsx(da,{size:18})," Sa"]}),B.canDelete?s.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[s.jsx(En,{size:18})," Xa"]}):s.jsxs("button",{disabled:!0,title:B.deleteDisabledReason,className:"flex items-center gap-2 px-4 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed",children:[s.jsx(da,{size:18})," Xa"]})]})]}),B.isLocked&&B.lockMessage&&s.jsxs("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(Kr,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:B.lockMessage}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Cng vic ang trong quy trnh nh gi, mt s thao tc b hn ch."})]})]}),i&&v.parent_task_id&&s.jsx("div",{className:"mb-6",children:s.jsx(Dge,{parentTaskId:v.parent_task_id,currentTaskId:e||""})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsx(is,{className:"p-4",children:s.jsxs("div",{className:"flex flex-wrap gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi:"}),s.jsx(eF,{status:v.status})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"u tin:"}),s.jsx(tF,{priority:v.priority})]}),A!=="none"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"nh gi:"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.bgColor} ${P.color}`,children:P.label})]})]})}),s.jsxs(is,{className:"p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Ub,{size:20,className:"text-gray-400"}),"Chi tit cng vic"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"M t"}),s.jsx("p",{className:"mt-1 text-gray-700 whitespace-pre-wrap",children:v.description||"Khng c m t"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ph,{size:18,className:"text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Phng ban"}),s.jsx("p",{className:"font-medium",children:v.department?.name||"-"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ls,{size:18,className:"text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Ngi ph trch"}),s.jsx("p",{className:"font-medium",children:v.assignee?.full_name||"-"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(dn,{size:18,className:"text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Ngy bt u"}),s.jsx("p",{className:"font-medium",children:g(v.start_date)})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(dn,{size:18,className:"text-red-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Hn hon thnh"}),s.jsx("p",{className:"font-medium",children:g(v.due_date)})]})]})]}),v.notes&&s.jsxs("div",{className:"pt-4 border-t",children:[s.jsx("label",{className:"text-sm text-gray-500",children:"Ghi ch"}),s.jsx("p",{className:"mt-1 text-gray-700 whitespace-pre-wrap bg-gray-50 p-3 rounded-lg",children:v.notes})]})]})]}),e&&s.jsx(dF,{taskId:e,taskAssigneeId:v.assignee_id,onParticipantChange:()=>h()}),!i&&e&&s.jsx(Mge,{parentTaskId:e,parentTaskCode:v.code,parentDepartmentId:v.department_id,parentStartDate:v.start_date,parentDueDate:v.due_date,canEdit:B.canEdit,onSubtaskCreated:x,onSubtaskDeleted:x}),e&&s.jsx(Qge,{taskId:e,currentUserId:a?.employee_id||"",canEdit:B.canEdit}),e&&s.jsx(sye,{taskId:e,currentUserId:a?.employee_id||"",canComment:!0}),e&&s.jsx(dye,{taskId:e,maxItems:10,showFilters:!0})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(is,{className:"p-0 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 p-4",children:s.jsx("h2",{className:"text-white font-semibold",children:"Tin  cng vic"})}),s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"flex flex-col items-center py-4",children:[s.jsxs("div",{className:"relative w-32 h-32",children:[s.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[s.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"#e5e7eb",strokeWidth:"12",fill:"none"}),s.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:_>=100?"#22c55e":"#3b82f6",strokeWidth:"12",fill:"none",strokeLinecap:"round",strokeDasharray:`${_/100*352} 352`})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("span",{className:"text-3xl font-bold text-gray-800",children:[_,"%"]})})]}),s.jsxs("p",{className:"mt-3 text-sm text-gray-500",children:[_===0&&"Cha bt u",_>0&&_<100&&"ang thc hin",_>=100&&"Hon thnh"]}),u>0&&s.jsxs("p",{className:"mt-1 text-xs text-blue-600",children:["(Tnh trung bnh t ",u," cng vic con)"]})]})})]}),s.jsxs(is,{className:"p-4",children:[s.jsxs("h2",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[s.jsx(Xr,{size:16}),"Thi gian"]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Ngy to"}),s.jsx("span",{className:"font-medium",children:g(v.created_at)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Cp nht"}),s.jsx("span",{className:"font-medium",children:g(v.updated_at)})]}),v.completed_date&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Hon thnh"}),s.jsx("span",{className:"font-medium text-green-600",children:g(v.completed_date)})]})]})]}),s.jsxs(is,{className:"p-4",children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Thao tc nhanh"}),s.jsx("div",{className:"space-y-2",children:B.isLocked?s.jsxs("div",{className:"text-center py-4",children:[s.jsx(da,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Cng vic ang trong quy trnh nh gi"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Mt s thao tc b hn ch"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{className:"w-full px-3 py-2 text-left text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100",children:" nh du hon thnh"}),s.jsx("button",{className:"w-full px-3 py-2 text-left text-sm bg-yellow-50 text-yellow-700 rounded-lg hover:bg-yellow-100",children:" Tm dng cng vic"})]})})]})]})]}),t&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-500 mb-4",children:['Bn c chc mun xa "',w,'"?']}),u>0&&s.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-700 text-sm",children:[" Cng vic ny c ",u," cng vic con. Vui lng xa cng vic con trc."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>n(!1),className:"px-4 py-2 border rounded-lg",children:"Hy"}),s.jsx("button",{onClick:m,disabled:y.isPending||u>0,className:"px-4 py-2 bg-red-600 text-white rounded-lg disabled:opacity-50",children:y.isPending?"ang xa...":"Xa"})]})]})})]})}const kT={low:{label:"Thp",color:"text-gray-600",bgColor:"bg-gray-100"},medium:{label:"Trung bnh",color:"text-blue-600",bgColor:"bg-blue-100"},high:{label:"Cao",color:"text-orange-600",bgColor:"bg-orange-100"},urgent:{label:"Khn cp",color:"text-red-600",bgColor:"bg-red-100"}};function hF(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}function gye(e){const r=new Date(e),n=new Date().getTime()-r.getTime(),a=Math.floor(n/6e4),i=Math.floor(n/36e5),o=Math.floor(n/864e5);return a<1?"Va xong":a<60?`${a} pht trc`:i<24?`${i} gi trc`:o<7?`${o} ngy trc`:hF(e)}const yye=({request:e,onAccept:r,onReject:t,onView:n,isProcessing:a})=>{const i=kT[e.task_priority]||kT.medium;return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all overflow-hidden",children:[s.jsx("div",{className:"px-5 py-4 border-b border-gray-100 bg-gradient-to-r from-purple-50 to-indigo-50",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:"text-xs font-mono text-gray-500",children:e.task_code}),s.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${i.bgColor} ${i.color}`,children:[s.jsx(Ub,{className:"w-3 h-3 inline mr-1"}),i.label]})]}),s.jsx("h3",{className:"font-semibold text-gray-900 mt-1 truncate",children:e.task_name})]}),s.jsxs("div",{className:"text-right text-xs text-gray-500",children:[s.jsx(Xr,{className:"w-3.5 h-3.5 inline mr-1"}),gye(e.requested_at)]})]})}),s.jsxs("div",{className:"px-5 py-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-medium",children:e.inviter_name?.charAt(0)?.toUpperCase()||"?"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Yu cu t"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.inviter_name}),e.inviter_department_name&&s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1 mt-0.5",children:[s.jsx($r,{className:"w-3 h-3"}),e.inviter_department_name]})]})]}),e.invitation_note&&s.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-100 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(vv,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-yellow-700 mb-1",children:"Li nhn:"}),s.jsx("p",{className:"text-sm text-yellow-800",children:e.invitation_note})]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(dn,{className:"w-4 h-4 text-gray-400"}),s.jsxs("span",{children:["Hn: ",hF(e.task_due_date)]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:s.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500",style:{opacity:e.task_progress/100||.2}})}),s.jsxs("span",{children:["Tin : ",e.task_progress||0,"%"]})]})]}),e.task_description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.task_description})]}),s.jsxs("div",{className:"px-5 py-3 border-t border-gray-100 bg-gray-50 flex items-center gap-2",children:[s.jsxs("button",{onClick:n,className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(ja,{className:"w-4 h-4"}),"Xem chi tit"]}),s.jsx("div",{className:"flex-1"}),s.jsxs("button",{onClick:t,disabled:a,className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50",children:[a?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(ua,{className:"w-4 h-4"}),"T chi"]}),s.jsxs("button",{onClick:r,disabled:a,className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[a?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(hn,{className:"w-4 h-4"}),"Chp nhn"]})]})]})},xye=({onCountChange:e})=>{const r=ts(),{user:t}=xn(),[n,a]=R.useState([]),[i,o]=R.useState(!0),[c,u]=R.useState(null),[l,d]=R.useState(null),f=R.useCallback(async()=>{if(!t?.employee_id)return;o(!0),d(null);const{data:g,error:m}=await rd.getPendingRequests(t.employee_id);m?d(m.message):(a(g),e?.(g.length)),o(!1)},[t?.employee_id,e]);R.useEffect(()=>{f()},[f]);const p=async g=>{u(g);const m=await rd.acceptRequest(g);m.success?await f():alert(m.error||"Khng th chp nhn yu cu"),u(null)},h=async g=>{const m=prompt("L do t chi (ty chn):");if(m===null)return;u(g);const x=await rd.rejectRequest(g,m||void 0);x.success?await f():alert(x.error||"Khng th t chi yu cu"),u(null)},y=g=>{r(`/tasks/${g}`)};return i?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsx(Mt,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"ang ti..."})]})}):l?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[s.jsx(Cr,{className:"w-12 h-12 text-red-400 mb-3"}),s.jsx("p",{className:"text-red-600 mb-3",children:l}),s.jsx("button",{onClick:f,className:"text-blue-600 hover:underline",children:"Th li"})]}):n.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:s.jsx(Wb,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Khng c yu cu no"}),s.jsx("p",{className:"text-gray-500 text-center max-w-sm",children:"Khi ng nghip mi bn tham gia cng vic, yu cu s hin th  y"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between px-1",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Bn c ",s.jsx("strong",{className:"text-purple-600",children:n.length})," yu cu tham gia cng vic"]}),s.jsx("button",{onClick:f,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Lm mi"})]}),s.jsx("div",{className:"grid gap-4",children:n.map(g=>s.jsx(yye,{request:g,onAccept:()=>p(g.id),onReject:()=>h(g.id),onView:()=>y(g.task_id),isProcessing:c===g.id},g.id))})]})},vye=2,au={async canRequestExtension(e,r){const{data:t,error:n}=await se.rpc("can_request_extension",{p_task_id:e,p_requester_id:r});if(n)throw console.error("Error checking extension eligibility:",n),new Error("Khng th kim tra iu kin gia hn");return!t||t.length===0?{can_request:!1,reason:"Khng th xc nh iu kin gia hn",current_count:0,max_count:vye}:t[0]},async getApprover(e){const{data:r,error:t}=await se.rpc("get_extension_approver",{p_requester_id:e});if(t)throw console.error("Error getting approver:",t),new Error("Khng th xc nh ngi ph duyt");return!r||r.length===0?null:r[0]},async createRequest(e){const r=await this.canRequestExtension(e.task_id,e.requester_id);if(!r.can_request)throw new Error(r.reason);const{data:t,error:n}=await se.from("task_extension_requests").insert({task_id:e.task_id,requester_id:e.requester_id,requester_level:e.requester_level,original_due_date:e.original_due_date,requested_due_date:e.requested_due_date,reason:e.reason,attachment_url:e.attachment_url||null,attachment_name:e.attachment_name||null,approver_id:e.approver_id,extension_number:r.current_count+1,status:"pending"}).select().single();if(n)throw console.error("Error creating extension request:",n),new Error("Khng th to yu cu gia hn: "+n.message);return t},async createAndAutoApprove(e){const r=await this.createRequest(e),{data:t,error:n}=await se.from("task_extension_requests").update({status:"approved",approved_at:new Date().toISOString(),approver_comment:"T ng duyt (Ban Gim c)"}).eq("id",r.id).select().single();if(n)throw console.error("Error auto-approving:",n),new Error("Khng th t ng duyt");return t},async approveOrReject(e){const r={status:e.status,approved_at:new Date().toISOString()};e.approver_comment&&(r.approver_comment=e.approver_comment);const{data:t,error:n}=await se.from("task_extension_requests").update(r).eq("id",e.id).eq("status","pending").select().single();if(n)throw console.error("Error approving/rejecting:",n),new Error("Khng th x l yu cu: "+n.message);return t},async cancelRequest(e){const{data:r,error:t}=await se.from("task_extension_requests").update({status:"cancelled"}).eq("id",e).eq("status","pending").select().single();if(t)throw console.error("Error cancelling request:",t),new Error("Khng th hy yu cu");return r},async getPendingRequests(e){const{data:r,error:t}=await se.from("task_extension_requests").select(`
        *,
        task:tasks(
          id,
          name,
          code,
          status,
          department_id,
          department:departments(name)
        ),
        requester:employees!task_extension_requests_requester_id_fkey(
          id,
          full_name,
          code,
          position:positions(name, level)
        )
      `).eq("status","pending").eq("approver_id",e).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching pending requests:",t),new Error("Khng th ti danh sch yu cu");return(r||[]).map(n=>({...n,task_name:n.task?.name,task_code:n.task?.code,task_status:n.task?.status,department_id:n.task?.department_id,department_name:n.task?.department?.name,requester_name:n.requester?.full_name,requester_code:n.requester?.code,requester_position:n.requester?.position?.name,requester_level:n.requester?.position?.level}))},async getPendingRequestsForManager(e){const{data:r,error:t}=await se.from("task_extension_requests").select(`
        *,
        task:tasks!inner(
          id,
          name,
          code,
          status,
          department_id,
          department:departments(name)
        ),
        requester:employees!task_extension_requests_requester_id_fkey(
          id,
          full_name,
          code,
          position:positions(name, level)
        )
      `).eq("status","pending").eq("task.department_id",e).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching pending requests for manager:",t),new Error("Khng th ti danh sch yu cu");return(r||[]).map(n=>({...n,task_name:n.task?.name,task_code:n.task?.code,task_status:n.task?.status,department_id:n.task?.department_id,department_name:n.task?.department?.name,requester_name:n.requester?.full_name,requester_code:n.requester?.code,requester_position:n.requester?.position?.name,requester_level:n.requester?.position?.level}))},async getAllPendingRequests(){const{data:e,error:r}=await se.from("task_extension_requests").select(`
        *,
        task:tasks(
          id,
          name,
          code,
          status,
          department_id,
          department:departments(name)
        ),
        requester:employees!task_extension_requests_requester_id_fkey(
          id,
          full_name,
          code,
          position:positions(name, level)
        )
      `).eq("status","pending").order("created_at",{ascending:!1});if(r)throw console.error("Error fetching all pending requests:",r),new Error("Khng th ti danh sch yu cu");return(e||[]).map(t=>({...t,task_name:t.task?.name,task_code:t.task?.code,task_status:t.task?.status,department_id:t.task?.department_id,department_name:t.task?.department?.name,requester_name:t.requester?.full_name,requester_code:t.requester?.code,requester_position:t.requester?.position?.name,requester_level:t.requester?.position?.level}))},async getTaskExtensionHistory(e){const{data:r,error:t}=await se.from("task_extension_requests").select(`
        id,
        extension_number,
        original_due_date,
        requested_due_date,
        extension_days,
        reason,
        status,
        approver_comment,
        created_at,
        approved_at,
        requester:employees!task_extension_requests_requester_id_fkey(full_name),
        approver:employees!task_extension_requests_approver_id_fkey(full_name)
      `).eq("task_id",e).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching extension history:",t),new Error("Khng th ti lch s gia hn");return(r||[]).map(n=>({id:n.id,extension_number:n.extension_number,original_due_date:n.original_due_date,requested_due_date:n.requested_due_date,extension_days:n.extension_days,reason:n.reason,status:n.status,requester_name:n.requester?.full_name||"",approver_name:n.approver?.full_name||null,approver_comment:n.approver_comment,created_at:n.created_at,approved_at:n.approved_at}))},async getTaskPendingRequest(e){const{data:r,error:t}=await se.from("task_extension_requests").select("*").eq("task_id",e).eq("status","pending").maybeSingle();return t?(console.error("Error fetching pending request:",t),null):r},async countPendingRequests(e){const{count:r,error:t}=await se.from("task_extension_requests").select("*",{count:"exact",head:!0}).eq("status","pending").eq("approver_id",e);return t?(console.error("Error counting pending requests:",t),0):r||0},async countPendingRequestsByRole(e,r,t){try{if(r<=3){const{count:n,error:a}=await se.from("task_extension_requests").select("*",{count:"exact",head:!0}).eq("status","pending");if(a)throw a;return n||0}if(r<=5&&t){const{data:n,error:a}=await se.from("task_extension_requests").select(`
            id,
            approver_id,
            task:tasks!inner(department_id)
          `).eq("status","pending");if(a)throw a;return(n||[]).filter(o=>o.approver_id===e||o.task?.department_id===t).length}return 0}catch(n){return console.error("Error counting pending requests by role:",n),0}},async uploadAttachment(e,r){const t=e.name.split(".").pop(),a=`extension-attachments/${`${r}_${Date.now()}.${t}`}`,{data:i,error:o}=await se.storage.from("extension-attachments").upload(a,e,{cacheControl:"3600",upsert:!1});if(o)throw console.error("Error uploading file:",o),new Error("Khng th ti ln file: "+o.message);const{data:c}=se.storage.from("extension-attachments").getPublicUrl(i.path);return{url:c.publicUrl,name:e.name}},async getMyRequests(e){const{data:r,error:t}=await se.from("task_extension_requests").select(`
        *,
        task:tasks(
          id,
          name,
          code,
          status,
          department:departments(name)
        ),
        approver:employees!task_extension_requests_approver_id_fkey(
          full_name,
          position:positions(name)
        )
      `).eq("requester_id",e).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching my requests:",t),new Error("Khng th ti danh sch yu cu");return(r||[]).map(n=>({...n,task_name:n.task?.name,task_code:n.task?.code,task_status:n.task?.status,department_name:n.task?.department?.name,approver_name:n.approver?.full_name,approver_position:n.approver?.position?.name}))}},aa={all:["extensions"],pending:e=>[...aa.all,"pending",e],pendingDept:e=>[...aa.all,"pending-dept",e],pendingAll:()=>[...aa.all,"pending-all"],history:e=>[...aa.all,"history",e],canRequest:(e,r)=>[...aa.all,"can-request",e,r],approver:e=>[...aa.all,"approver",e],taskPending:e=>[...aa.all,"task-pending",e],myRequests:e=>[...aa.all,"my-requests",e],count:e=>[...aa.all,"count",e]};function bye(e,r){return gr({queryKey:aa.canRequest(e,r),queryFn:()=>au.canRequestExtension(e,r),enabled:!!e&&!!r,staleTime:30*1e3})}function wye(e){return gr({queryKey:aa.approver(e),queryFn:()=>au.getApprover(e),enabled:!!e,staleTime:300*1e3})}function _ye(e){return gr({queryKey:aa.pending(e),queryFn:()=>au.getPendingRequests(e),enabled:!!e,refetchInterval:60*1e3})}function jye(e){return gr({queryKey:aa.pendingDept(e),queryFn:()=>au.getPendingRequestsForManager(e),enabled:!!e,refetchInterval:60*1e3})}function Nye(){return gr({queryKey:aa.pendingAll(),queryFn:()=>au.getAllPendingRequests(),refetchInterval:60*1e3})}function kye(){const e=Is();return nn({mutationFn:r=>au.createRequest(r),onSuccess:(r,t)=>{e.invalidateQueries({queryKey:aa.all}),e.invalidateQueries({queryKey:aa.canRequest(t.task_id,t.requester_id)}),e.invalidateQueries({queryKey:aa.history(t.task_id)})}})}function Sye(){const e=Is();return nn({mutationFn:r=>au.createAndAutoApprove(r),onSuccess:(r,t)=>{e.invalidateQueries({queryKey:aa.all}),e.invalidateQueries({queryKey:aa.canRequest(t.task_id,t.requester_id)}),e.invalidateQueries({queryKey:aa.history(t.task_id)}),e.invalidateQueries({queryKey:["tasks"]})}})}function Cye(){const e=Is();return nn({mutationFn:r=>au.approveOrReject(r),onSuccess:()=>{e.invalidateQueries({queryKey:aa.all}),e.invalidateQueries({queryKey:["tasks"]})}})}function Aye(){return nn({mutationFn:({file:e,requesterId:r})=>au.uploadAttachment(e,r)})}function Eye(e){return new Date(e).toLocaleDateString("vi-VN")}function Tye(e,r){const t=new Date(e),n=new Date(r);return Math.ceil((n.getTime()-t.getTime())/(1e3*60*60*24))}function Pye({isOpen:e,onClose:r,task:t,onSuccess:n}){const{user:a}=xn(),i=a?.employee_id||"",o=a?.position_level||6,[c,u]=R.useState(""),[l,d]=R.useState(""),[f,p]=R.useState(null),[h,y]=R.useState(null),{data:g,isLoading:m}=bye(t.id,i),{data:x,isLoading:v}=wye(i),w=kye(),_=Sye(),A=Aye();R.useEffect(()=>{e&&(u(""),d(""),p(null),y(null))},[e]);const P=c?Tye(t.due_date,c):0,B=x?.approval_type==="self",T=H=>{const z=H.target.files?.[0];if(z){if(z.size>10*1024*1024){y("File khng c vt qu 10MB");return}p(z),y(null)}},I=async H=>{if(H.preventDefault(),y(null),!c){y("Vui lng chn ngy gia hn");return}if(P<=0){y("Ngy gia hn phi sau hn hin ti");return}if(!l.trim()){y("Vui lng nhp l do xin gia hn");return}if(l.trim().length<10){y("L do phi c t nht 10 k t");return}if(!x){y("Khng xc nh c ngi ph duyt");return}try{let z=null,O=null;if(f){const E=await A.mutateAsync({file:f,requesterId:i});z=E.url,O=E.name}const L={task_id:t.id,requester_id:i,requester_level:o,original_due_date:t.due_date,requested_due_date:c,reason:l.trim(),attachment_url:z,attachment_name:O,approver_id:x.approver_id,extension_number:(g?.current_count||0)+1};B?await _.mutateAsync(L):await w.mutateAsync(L),n?.(),r()}catch(z){y(z.message||"C li xy ra")}},U=m||v||w.isPending||_.isPending||A.isPending;return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:r}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:" Xin gia hn cng vic"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[t.code&&`${t.code} - `,t.name]})]}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Br,{size:20,className:"text-gray-500"})})]}),s.jsx("div",{className:"p-4",children:m?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(Mt,{className:"w-6 h-6 animate-spin text-blue-600"}),s.jsx("span",{className:"ml-2 text-gray-500",children:"ang kim tra..."})]}):g&&!g.can_request?s.jsx("div",{className:"py-8",children:s.jsxs("div",{className:"flex flex-col items-center text-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mb-3",children:s.jsx(Kr,{className:"w-6 h-6 text-red-600"})}),s.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:"Khng th xin gia hn"}),s.jsx("p",{className:"text-gray-500",children:g.reason}),s.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[" gia hn: ",g.current_count,"/",g.max_count," ln"]})]})}):s.jsxs("form",{onSubmit:I,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hn hin ti"}),s.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:Eye(t.due_date)})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hn mi yu cu ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"date",value:c,onChange:H=>u(H.target.value),min:t.due_date,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),P>0&&s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["+ ",P," ngy so vi hn hin ti"]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["L do xin gia hn ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:l,onChange:H=>d(H.target.value),placeholder:"Nhp l do chi tit...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",required:!0}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Ti thiu 10 k t (",l.length,"/10)"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File nh km (ty chn)"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"file",onChange:T,className:"hidden",id:"extension-attachment",accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg"}),s.jsxs("label",{htmlFor:"extension-attachment",className:"flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[s.jsx(Gg,{size:20,className:"text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:f?f.name:"Chn file minh chng"})]})]}),f&&s.jsxs("div",{className:"flex items-center justify-between mt-2 px-3 py-2 bg-blue-50 rounded-lg",children:[s.jsx("span",{className:"text-sm text-blue-700 truncate",children:f.name}),s.jsx("button",{type:"button",onClick:()=>p(null),className:"text-blue-600 hover:text-blue-800",children:s.jsx(Br,{size:16})})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PDF, Word, Excel, Hnh nh. Ti a 10MB."})]}),x&&s.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ls,{size:16,className:"text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-600",children:B?s.jsx("span",{className:"text-green-600 font-medium",children:"T ng duyt (Ban Gim c)"}):s.jsxs(s.Fragment,{children:["Ngi ph duyt:"," ",s.jsx("span",{className:"font-medium text-gray-900",children:x.approver_name})]})})]})}),g&&s.jsxs("div",{className:"text-sm text-gray-500",children:["S ln  gia hn: ",g.current_count,"/",g.max_count]}),h&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:U,children:"Hy"}),s.jsx("button",{type:"submit",disabled:U||!g?.can_request,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:U?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{size:18,className:"animate-spin"}),"ang x l..."]}):B?s.jsxs(s.Fragment,{children:[s.jsx(hn,{size:18}),"Gia hn ngay"]}):"Gi yu cu"})]})]})})]})]}):null}const ST=[{key:"in_progress",label:"ang lm",icon:s.jsx(Xr,{className:"w-4 h-4"}),color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-500"},{key:"awaiting_eval",label:"Ch t nh gi",icon:s.jsx(vr,{className:"w-4 h-4"}),color:"text-amber-600",bgColor:"bg-amber-50",borderColor:"border-amber-500"},{key:"pending_approval",label:"Ch ph duyt",icon:s.jsx(Cr,{className:"w-4 h-4"}),color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-500"},{key:"approved",label:" duyt",icon:s.jsx(hn,{className:"w-4 h-4"}),color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-500"},{key:"participation_requests",label:"Yu cu tham gia",icon:s.jsx(Wb,{className:"w-4 h-4"}),color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-500"}],_b={urgent:{label:"Khn cp",color:"text-red-700",bg:"bg-red-100",sortOrder:1},high:{label:"Cao",color:"text-orange-700",bg:"bg-orange-100",sortOrder:2},medium:{label:"Trung bnh",color:"text-blue-700",bg:"bg-blue-100",sortOrder:3},low:{label:"Thp",color:"text-gray-600",bg:"bg-gray-100",sortOrder:4}},av={excellent:{label:"Xut sc",color:"text-emerald-600"},good:{label:"Tt",color:"text-blue-600"},average:{label:"Kh",color:"text-yellow-600"},below_average:{label:"Trung bnh",color:"text-orange-600"}},V_=[{key:"all",label:"Tt c",icon:s.jsx(Al,{className:"w-3.5 h-3.5"})},{key:"overdue",label:"Qu hn",icon:s.jsx(Kr,{className:"w-3.5 h-3.5"})},{key:"today",label:"Hm nay",icon:s.jsx(pg,{className:"w-3.5 h-3.5"})},{key:"high_priority",label:"u tin cao",icon:s.jsx(wO,{className:"w-3.5 h-3.5"})},{key:"this_week",label:"Tun ny",icon:s.jsx(dn,{className:"w-3.5 h-3.5"})}],Oye=[25,50,75,100];function fF(e){return e>=90?"excellent":e>=70?"good":e>=50?"average":"below_average"}function Mye(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}function W_(e,r){if(!e||r==="finished"||r==="cancelled")return!1;const t=new Date(e);return t.setHours(23,59,59,999),t<new Date}function Iye(e){if(!e)return!1;const r=new Date(e),t=new Date;return r.toDateString()===t.toDateString()}function Rye(e){if(!e)return!1;const r=new Date(e),t=new Date,n=new Date(t);n.setDate(t.getDate()-t.getDay()+1);const a=new Date(n);return a.setDate(n.getDate()+6),r>=n&&r<=a}function Lye(e){if(!e)return{text:"-",isOverdue:!1,daysCount:0};const r=new Date(e);r.setHours(23,59,59,999);const t=new Date;t.setHours(0,0,0,0);const n=r.getTime()-t.getTime(),a=Math.ceil(n/(1e3*60*60*24));return a<0?{text:`Qu ${Math.abs(a)} ngy`,isOverdue:!0,daysCount:a}:a===0?{text:"Hm nay",isOverdue:!1,daysCount:0}:a===1?{text:"Ngy mai",isOverdue:!1,daysCount:1}:{text:`Cn ${a} ngy`,isOverdue:!1,daysCount:a}}const Dye=({task:e,isOpen:r,onClose:t,onUpdate:n})=>{const[a,i]=R.useState(e?.progress||0),[o,c]=R.useState(!1);R.useEffect(()=>{r&&e&&i(e.progress||0)},[r,e]);const u=async()=>{if(e){c(!0);try{await n(e.id,a),t()}catch{}finally{c(!1)}}};return!r||!e?null:s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center",children:[s.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),s.jsxs("div",{className:"relative inline-block w-full max-w-md p-6 my-8 text-left bg-white rounded-xl shadow-xl transform transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cp nht tin "}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.code})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Tin  hin ti"}),s.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[a,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-4",children:s.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${a>=100?"bg-green-500":a>=50?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${Math.min(a,100)}%`}})}),s.jsx("input",{type:"range",min:"0",max:"100",value:a,onChange:l=>i(Number(l.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Chn nhanh:"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:Oye.map(l=>s.jsxs("button",{onClick:()=>i(l),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${a===l?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l,"%"]},l))})]}),a>=100&&s.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(hn,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Cng vic s c nh du hon thnh"})]}),s.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Sau khi cp nht, bn c th tin hnh t nh gi"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Hy"}),s.jsxs("button",{onClick:u,disabled:o||a===e.progress,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 rounded-lg transition-colors",children:[o?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx($i,{className:"w-4 h-4"}),"Cp nht"]})]})]})]})})},D0=({icon:e,label:r,value:t,color:n,bgColor:a,isActive:i,onClick:o})=>s.jsx("button",{onClick:o,className:`w-full text-left rounded-xl p-4 border-2 transition-all hover:shadow-md ${a} ${i?"border-current ring-2 ring-offset-1":"border-transparent"} ${n}`,children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2.5 rounded-lg bg-white/80 shadow-sm ${n}`,children:e}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 truncate",children:r}),s.jsx("p",{className:`text-2xl font-bold ${n}`,children:t})]})]})}),Fye=({score:e,label:r})=>{const t=e>0,n=t?fF(e):"none",a=av[n];return s.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4 border border-purple-100",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2.5 rounded-lg bg-white shadow-sm",children:s.jsx(Mm,{className:"w-5 h-5 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"im TB"}),s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-2xl font-bold text-purple-700",children:t?e:"-"}),t&&s.jsx("span",{className:`text-sm font-medium ${a?.color||"text-gray-600"}`,children:r}),!t&&s.jsx("span",{className:"text-sm text-gray-400",children:"Cha c"})]})]})]})})},Bye=({priority:e})=>{const r=_b[e]||_b.medium;return s.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${r.bg} ${r.color}`,children:[e==="urgent"&&s.jsx(wO,{className:"w-3 h-3 mr-1"}),r.label]})},$ye=({progress:e,size:r="sm"})=>{const t=r==="sm"?"h-1.5":"h-2",n=e>=100?"bg-green-500":e>=50?"bg-blue-500":"bg-amber-500";return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`flex-1 ${t} bg-gray-200 rounded-full overflow-hidden`,children:s.jsx("div",{className:`${t} ${n} rounded-full transition-all duration-300`,style:{width:`${Math.min(e,100)}%`}})}),s.jsxs("span",{className:"text-xs font-medium text-gray-600 w-8 text-right",children:[e,"%"]})]})},F0=({label:e,field:r,currentSort:t,currentOrder:n,onSort:a,className:i=""})=>s.jsx("th",{className:`px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider cursor-pointer hover:bg-gray-100 select-none ${i}`,onClick:()=>a(r),children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{children:e}),t===r?n==="asc"?s.jsx(si,{className:"w-3.5 h-3.5 text-blue-600"}):s.jsx(Gs,{className:"w-3.5 h-3.5 text-blue-600"}):s.jsx(pO,{className:"w-3.5 h-3.5 text-gray-400"})]})}),qye=({icon:e,title:r,description:t})=>s.jsxs("div",{className:"py-16 text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 text-gray-400 mb-4",children:e}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:r}),s.jsx("p",{className:"text-gray-500",children:t})]}),zye=()=>{const e=ts(),[r,t]=Ib(),{user:n}=xn(),[a,i]=R.useState([]),[o,c]=R.useState(!0),[u,l]=R.useState(!1),[d,f]=R.useState(""),[p,h]=R.useState(()=>r.get("tab")||"in_progress"),[y,g]=R.useState("all"),[m,x]=R.useState("due_date"),[v,w]=R.useState("asc"),[_,A]=R.useState(new Map),[P,B]=R.useState(!1),[T,I]=R.useState(null),[U,H]=R.useState(0),[z,O]=R.useState(!1),[L,E]=R.useState(null),k=R.useCallback(async()=>{if(n?.employee_id)try{const ie=await Ime.getMyTasks(n.employee_id);i(ie.data||[])}catch{i([])}},[n?.employee_id]),N=R.useCallback(async()=>{if(n?.employee_id)try{const{data:ie,error:ce}=await se.from("tasks").select("id").eq("assignee_id",n.employee_id);if(ce||!ie||ie.length===0)return;const de=ie.map(ue=>ue.id),{data:le,error:_e}=await se.from("task_approvals").select(`
          task_id,
          approved_score,
          original_score,
          rating,
          comments,
          action,
          created_at,
          approver:employees!task_approvals_approver_id_fkey(full_name)
        `).in("task_id",de).eq("action","approved");if(!_e&&le&&le.length>0){const ue=new Map;le.forEach(pe=>{ue.set(pe.task_id,{task_id:pe.task_id,score:pe.approved_score,rating:pe.rating,comments:pe.comments,approval_date:pe.created_at,approver_name:pe.approver?.full_name})}),A(ue)}}catch{}},[n?.employee_id]),S=R.useCallback(async()=>{if(n?.employee_id)try{const ie=await rd.countPendingRequests(n.employee_id);H(ie)}catch{H(0)}},[n?.employee_id]);R.useEffect(()=>{(async()=>(c(!0),await Promise.all([k(),N(),S()]),c(!1)))()},[k,N,S]),R.useEffect(()=>{t({tab:p})},[p,t]);const C=async()=>{l(!0),await Promise.all([k(),N(),S()]),l(!1)},D=R.useMemo(()=>{const ie=a.filter(ue=>ue.status==="in_progress"&&ue.evaluation_status!=="approved").length,ce=a.filter(ue=>ue.status==="finished"&&(!ue.evaluation_status||ue.evaluation_status==="none"||ue.evaluation_status==="pending_self_eval")).length,de=a.filter(ue=>ue.evaluation_status==="pending_approval").length,le=a.filter(ue=>ue.evaluation_status==="approved").length,_e=a.filter(ue=>W_(ue.due_date,ue.status)&&ue.evaluation_status!=="approved").length;return{total:a.length,inProgress:ie,awaitingEval:ce,pendingApproval:de,approved:le,overdue:_e}},[a]),q=R.useMemo(()=>{if(_.size===0)return{averageScore:0,rating:"-"};let ie=0,ce=0;_.forEach(ue=>{ue.score&&ue.score>0&&(ie+=ue.score,ce++)});const de=ce>0?Math.round(ie/ce):0,le=fF(de),_e=av[le]?.label||"-";return{averageScore:de,rating:_e}},[_]),M={in_progress:D.inProgress,awaiting_eval:D.awaitingEval,pending_approval:D.pendingApproval,approved:D.approved,participation_requests:U},G=R.useMemo(()=>{if(p==="participation_requests")return[];let ie=a.filter(ce=>{switch(p){case"in_progress":return ce.status==="in_progress"&&ce.evaluation_status!=="approved";case"awaiting_eval":return ce.status==="finished"&&(!ce.evaluation_status||ce.evaluation_status==="none"||ce.evaluation_status==="pending_self_eval");case"pending_approval":return ce.evaluation_status==="pending_approval";case"approved":return ce.evaluation_status==="approved";default:return!0}});if(y!=="all"&&(ie=ie.filter(ce=>{switch(y){case"overdue":return W_(ce.due_date,ce.status);case"today":return Iye(ce.due_date);case"high_priority":return ce.priority==="high"||ce.priority==="urgent";case"this_week":return Rye(ce.due_date);default:return!0}})),d.trim()){const ce=d.toLowerCase();ie=ie.filter(de=>de.name?.toLowerCase().includes(ce)||de.code?.toLowerCase().includes(ce)||de.description?.toLowerCase().includes(ce))}return ie.sort((ce,de)=>{let le=0;switch(m){case"code":le=(ce.code||"").localeCompare(de.code||"");break;case"name":le=(ce.name||"").localeCompare(de.name||"");break;case"priority":const _e=_b[ce.priority]?.sortOrder||99,ue=_b[de.priority]?.sortOrder||99;le=_e-ue;break;case"due_date":const pe=ce.due_date?new Date(ce.due_date).getTime():1/0,me=de.due_date?new Date(de.due_date).getTime():1/0;le=pe-me;break;case"progress":le=(ce.progress||0)-(de.progress||0);break;case"status":le=(ce.status||"").localeCompare(de.status||"");break;default:le=0}return v==="asc"?le:-le}),ie},[a,p,y,d,m,v]),X=ie=>{m===ie?w(ce=>ce==="asc"?"desc":"asc"):(x(ie),w("asc"))},re=ie=>{e(`/tasks/${ie}`)},V=ie=>{e(`/evaluations/self-evaluation?task_id=${ie.id}`)},J=ie=>{I(ie),B(!0)},W=async(ie,ce)=>{let de="in_progress";ce>=100?de="finished":ce===0&&(de="draft");const{error:le}=await se.from("tasks").update({progress:ce,status:de}).eq("id",ie);if(le)throw le;await k()},F=ie=>{H(ie)},Q=ie=>{E(ie),O(!0)},ne=()=>{O(!1),E(null),k()};return o?s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsx(Vr,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"ang ti..."})]})}):s.jsxs("div",{className:"p-6 space-y-6 max-w-[1600px] mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cng vic ca ti"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l v theo di tin  cng vic"})]}),s.jsxs("button",{onClick:C,disabled:u,className:"inline-flex items-center gap-2 px-4 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 shadow-sm",children:[s.jsx(Vr,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Lm mi"]})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4",children:[s.jsx(D0,{icon:s.jsx(vr,{className:"w-5 h-5"}),label:"Tng cng vic",value:D.total,color:"text-gray-700",bgColor:"bg-gray-50"}),s.jsx(D0,{icon:s.jsx(Xr,{className:"w-5 h-5"}),label:"ang lm",value:D.inProgress,color:"text-blue-600",bgColor:"bg-blue-50",isActive:p==="in_progress",onClick:()=>h("in_progress")}),s.jsx(D0,{icon:s.jsx(yg,{className:"w-5 h-5"}),label:"Ch t G",value:D.awaitingEval,color:"text-amber-600",bgColor:"bg-amber-50",isActive:p==="awaiting_eval",onClick:()=>h("awaiting_eval")}),s.jsx(D0,{icon:s.jsx(Cr,{className:"w-5 h-5"}),label:"Ch duyt",value:D.pendingApproval,color:"text-orange-600",bgColor:"bg-orange-50",isActive:p==="pending_approval",onClick:()=>h("pending_approval")}),s.jsx(D0,{icon:s.jsx(hn,{className:"w-5 h-5"}),label:" duyt",value:D.approved,color:"text-green-600",bgColor:"bg-green-50",isActive:p==="approved",onClick:()=>h("approved")}),s.jsx(Fye,{score:q.averageScore,label:q.rating})]}),D.overdue>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx(Kr,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-red-800 font-medium",children:["Bn c ",s.jsx("strong",{children:D.overdue})," cng vic  qu hn"]}),s.jsx("p",{className:"text-red-600 text-sm",children:"Vui lng x l sm hoc xin gia hn nu cn thit"})]}),s.jsx("button",{onClick:()=>{h("in_progress"),g("overdue")},className:"px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 transition-colors",children:"Xem ngay"})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[p!=="participation_requests"&&s.jsxs("div",{className:"p-4 border-b border-gray-200 space-y-4",children:[s.jsxs("div",{className:"relative max-w-md",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn cng vic...",value:d,onChange:ie=>f(ie.target.value),className:"w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),d&&s.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(Br,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500 mr-1",children:"Lc nhanh:"}),V_.map(ie=>s.jsxs("button",{onClick:()=>g(ie.key),className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${y===ie.key?"bg-blue-100 text-blue-700 border border-blue-300":"bg-gray-100 text-gray-600 border border-transparent hover:bg-gray-200"}`,children:[ie.icon,ie.label,ie.key==="overdue"&&D.overdue>0&&s.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:D.overdue})]},ie.key))]})]}),s.jsx("div",{className:"flex border-b border-gray-200 overflow-x-auto bg-gray-50",children:ST.map(ie=>s.jsxs("button",{onClick:()=>{h(ie.key),g("all")},className:`flex items-center gap-2 px-5 py-3.5 text-sm font-medium whitespace-nowrap border-b-2 transition-all ${p===ie.key?`${ie.borderColor} ${ie.color} ${ie.bgColor}`:"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[ie.icon,s.jsx("span",{children:ie.label}),M[ie.key]>0&&s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${p===ie.key?"bg-white/80 shadow-sm":ie.key==="participation_requests"?"bg-purple-500 text-white":"bg-gray-200 text-gray-600"}`,children:M[ie.key]})]},ie.key))}),p==="participation_requests"?s.jsx(xye,{onCountChange:F}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:G.length===0?s.jsx(qye,{icon:d?s.jsx(ii,{className:"w-8 h-8"}):y!=="all"?s.jsx(Al,{className:"w-8 h-8"}):sa.cloneElement(ST.find(ie=>ie.key===p)?.icon||s.jsx(vr,{className:"w-8 h-8"}),{className:"w-8 h-8"}),title:d?"Khng tm thy cng vic":y!=="all"?`Khng c cng vic ${V_.find(ie=>ie.key===y)?.label.toLowerCase()}`:p==="in_progress"?"Khng c cng vic ang lm":p==="awaiting_eval"?"Khng c cng vic ch t nh gi":p==="pending_approval"?"Khng c cng vic ch ph duyt":"Cha c cng vic c duyt",description:d?"Th thay i t kha tm kim":y!=="all"?"Th b b lc  xem tt c":"Khi c cng vic mi, chng s hin th  y"}):s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"w-8 px-3 py-3"}),s.jsx(F0,{label:"M",field:"code",currentSort:m,currentOrder:v,onSort:X,className:"w-28"}),s.jsx(F0,{label:"Tn cng vic",field:"name",currentSort:m,currentOrder:v,onSort:X}),s.jsx(F0,{label:"u tin",field:"priority",currentSort:m,currentOrder:v,onSort:X,className:"w-28"}),s.jsx(F0,{label:"Hn",field:"due_date",currentSort:m,currentOrder:v,onSort:X,className:"w-32"}),s.jsx(F0,{label:"Tin ",field:"progress",currentSort:m,currentOrder:v,onSort:X,className:"w-32"}),p==="approved"&&s.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider w-24",children:"im"}),s.jsx("th",{className:"px-3 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider w-44",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:G.map(ie=>{const ce=W_(ie.due_date,ie.status)&&ie.evaluation_status!=="approved",de=Lye(ie.due_date),le=_.get(ie.id),_e=p==="in_progress"&&ie.status==="in_progress"&&ie.due_date;return s.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${ce?"bg-red-50/50":""}`,children:[s.jsx("td",{className:"px-3 py-3.5",children:ce&&s.jsx("span",{title:"Qu hn",children:s.jsx(Kr,{className:"w-4 h-4 text-red-500"})})}),s.jsx("td",{className:"px-3 py-3.5",children:s.jsx("span",{className:"font-mono text-sm text-gray-600",children:ie.code})}),s.jsx("td",{className:"px-3 py-3.5",children:s.jsxs("div",{className:"min-w-0",children:[s.jsx("button",{onClick:()=>re(ie.id),className:"font-medium text-gray-900 hover:text-blue-600 text-left truncate max-w-[300px] block",title:ie.name,children:ie.name}),ie.department?.name&&s.jsxs("div",{className:"flex items-center gap-1 mt-0.5 text-xs text-gray-500",children:[s.jsx($r,{className:"w-3 h-3"}),ie.department.name]})]})}),s.jsx("td",{className:"px-3 py-3.5",children:s.jsx(Bye,{priority:ie.priority})}),s.jsx("td",{className:"px-3 py-3.5",children:s.jsxs("div",{className:"text-sm",children:[s.jsx("div",{className:ce?"text-red-600 font-medium":"text-gray-900",children:Mye(ie.due_date)}),s.jsx("div",{className:`text-xs ${de.isOverdue?"text-red-500 font-medium":"text-gray-500"}`,children:de.text})]})}),s.jsx("td",{className:"px-3 py-3.5",children:s.jsx($ye,{progress:ie.progress||0})}),p==="approved"&&s.jsx("td",{className:"px-3 py-3.5",children:le?.score?s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-lg font-bold text-purple-600",children:le.score}),le.rating&&s.jsx("div",{className:`text-xs ${av[le.rating]?.color||"text-gray-500"}`,children:av[le.rating]?.label||le.rating})]}):s.jsx("span",{className:"text-gray-400",children:"-"})}),s.jsx("td",{className:"px-3 py-3.5 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-1",children:[s.jsx("button",{onClick:()=>re(ie.id),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Xem chi tit",children:s.jsx(ja,{className:"w-4 h-4"})}),p==="in_progress"&&s.jsxs("button",{onClick:()=>J(ie),className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",title:"Cp nht tin ",children:[s.jsx(md,{className:"w-3.5 h-3.5"}),"Cp nht"]}),_e&&s.jsxs("button",{onClick:()=>Q(ie),className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors",title:"Xin gia hn",children:[s.jsx(GV,{className:"w-3.5 h-3.5"}),"Gia hn"]}),p==="awaiting_eval"&&s.jsxs("button",{onClick:()=>V(ie),className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 rounded-lg transition-colors",title:"T nh gi",children:[s.jsx(yg,{className:"w-3.5 h-3.5"}),"T nh gi"]}),p==="approved"&&s.jsxs("button",{onClick:()=>re(ie.id),className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-xs font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",title:"Xem kt qu",children:[s.jsx(qb,{className:"w-3.5 h-3.5"}),"Xem kt qu"]})]})})]},ie.id)})})]})}),G.length>0&&s.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50 text-sm text-gray-500",children:["Hin th ",s.jsx("strong",{children:G.length})," cng vic",d&&` ph hp vi "${d}"`,y!=="all"&&`  ${V_.find(ie=>ie.key===y)?.label}`]})]})]}),s.jsx(Dye,{task:T,isOpen:P,onClose:()=>{B(!1),I(null)},onUpdate:W}),L&&s.jsx(Pye,{isOpen:z,onClose:()=>{O(!1),E(null)},task:{id:L.id,name:L.name,code:L.code,due_date:L.due_date||""},onSuccess:ne})]})};function CT(e){return new Date(e).toLocaleDateString("vi-VN")}function Uye(e){return new Date(e).toLocaleString("vi-VN")}function Hye(e,r){const t=["jpg","jpeg","png","gif","webp","bmp","svg"];if(e){const n=e.split(".").pop()?.toLowerCase();if(n&&t.includes(n))return!0}if(r){const a=r.split("?")[0].split(".").pop()?.toLowerCase();if(a&&t.includes(a))return!0}return!1}function Vye(e){if(!e)return s.jsx(mg,{size:16,className:"text-gray-400"});switch(e.split(".").pop()?.toLowerCase()){case"pdf":return s.jsx(vr,{size:16,className:"text-red-500"});case"doc":case"docx":return s.jsx(vr,{size:16,className:"text-blue-500"});case"xls":case"xlsx":return s.jsx(zb,{size:16,className:"text-green-500"});case"jpg":case"jpeg":case"png":case"gif":case"webp":return s.jsx(Kg,{size:16,className:"text-purple-500"});default:return s.jsx(mg,{size:16,className:"text-gray-400"})}}function Wye({imageUrl:e,fileName:r,onClose:t}){return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",onClick:t,children:s.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] m-4",onClick:n=>n.stopPropagation(),children:[s.jsx("button",{onClick:t,className:"absolute -top-10 right-0 p-2 text-white hover:text-gray-300 transition-colors",children:s.jsx(Br,{size:24})}),s.jsx("img",{src:e,alt:r||"Preview",className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl"}),s.jsxs("div",{className:"absolute -bottom-10 left-0 right-0 flex items-center justify-between text-white text-sm",children:[s.jsx("span",{className:"truncate",children:r||"Hnh nh nh km"}),s.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1 bg-white/20 rounded hover:bg-white/30 transition-colors",children:[s.jsx(Wg,{size:14}),"Ti xung"]})]})]})})}function Kye({url:e,fileName:r}){const[t,n]=R.useState(!1);return Hye(r,e)?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"File nh km:"}),s.jsxs("div",{className:"relative group cursor-pointer inline-block",onClick:()=>n(!0),children:[s.jsx("img",{src:e,alt:r||"Attachment",className:"max-w-[200px] max-h-[120px] object-cover rounded-lg border border-gray-200 shadow-sm"}),s.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center gap-1 text-white text-sm font-medium",children:[s.jsx(CG,{size:16}),"Xem nh"]})})]}),r&&s.jsx("p",{className:"text-xs text-gray-400 mt-1 truncate max-w-[200px]",children:r})]}),t&&s.jsx(Wye,{imageUrl:e,fileName:r||void 0,onClose:()=>n(!1)})]}):s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"File nh km:"}),s.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700 hover:bg-gray-100 hover:border-gray-300 transition-colors",children:[Vye(r),s.jsx("span",{className:"truncate max-w-[180px]",children:r||"File nh km"}),s.jsx(qb,{size:14,className:"text-gray-400 flex-shrink-0"})]})]})}function Gye({request:e,onApprove:r,onReject:t,isProcessing:n}){const[a,i]=R.useState(""),[o,c]=R.useState(!1);return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs($a,{to:`/tasks/${e.task_id}`,className:"text-blue-600 hover:underline font-medium flex items-center gap-1",children:[e.task_name,s.jsx(qb,{size:14})]}),e.task_code&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:e.task_code})]}),s.jsxs("span",{className:"text-xs text-gray-400",children:["Ln ",e.extension_number,"/2"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(ls,{size:14,className:"text-gray-400"}),s.jsx("span",{children:e.requester_name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx($r,{size:14,className:"text-gray-400"}),s.jsx("span",{children:e.department_name||"-"})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg mb-3",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Hn c"}),s.jsx("p",{className:"font-medium text-gray-700",children:CT(e.original_due_date)})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-0.5 bg-gray-300"}),s.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:["+",e.extension_days," ngy"]}),s.jsx("div",{className:"w-8 h-0.5 bg-gray-300"})]})}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Hn mi"}),s.jsx("p",{className:"font-medium text-blue-600",children:CT(e.requested_due_date)})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"L do:"}),s.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-2 rounded",children:e.reason})]}),e.attachment_url&&s.jsx(Kye,{url:e.attachment_url,fileName:e.attachment_name}),s.jsxs("p",{className:"text-xs text-gray-400 mb-3",children:[s.jsx(Xr,{size:12,className:"inline mr-1"}),"Yu cu lc: ",Uye(e.created_at)]}),o?s.jsxs("div",{className:"space-y-3 pt-3 border-t",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Nhn xt (bt buc khi t chi)"}),s.jsx("textarea",{value:a,onChange:u=>i(u.target.value),placeholder:"Nhp nhn xt...",rows:2,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c(!1),className:"px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm",disabled:n,children:"Hy"}),s.jsxs("button",{onClick:()=>t(e.id,a),disabled:n,className:"flex-1 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm font-medium disabled:opacity-50 flex items-center justify-center gap-2",children:[n?s.jsx(Mt,{size:16,className:"animate-spin"}):s.jsx(ua,{size:16}),"T chi"]}),s.jsxs("button",{onClick:()=>r(e.id,a),disabled:n,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium disabled:opacity-50 flex items-center justify-center gap-2",children:[n?s.jsx(Mt,{size:16,className:"animate-spin"}):s.jsx(hn,{size:16}),"Duyt"]})]})]}):s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:()=>c(!0),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium",children:"Xem xt"})})]})}function Xye({userLevel:e,userDepartmentId:r,onCountChange:t}){const{user:n}=xn(),a=n?.employee_id||"",i=e<=3,{data:o,isLoading:c}=_ye(a),{data:u,isLoading:l}=jye(r||""),{data:d,isLoading:f}=Nye(),p=Cye();let h=[],y=!1;if(i)h=d||[],y=f;else if(e<=5){const x=u||[],v=o||[],w=[...x];v.forEach(_=>{w.find(A=>A.id===_.id)||w.push(_)}),h=w,y=c||l}else h=[];R.useEffect(()=>{t&&t(h.length)},[h.length,t]);const g=async(x,v)=>{try{await p.mutateAsync({id:x,status:"approved",approver_id:a,approver_comment:v||void 0})}catch(w){console.error("Error approving:",w)}},m=async(x,v)=>{if(!v?.trim()){alert("Vui lng nhp l do t chi");return}try{await p.mutateAsync({id:x,status:"rejected",approver_id:a,approver_comment:v})}catch(w){console.error("Error rejecting:",w)}};return y?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-500",children:"ang ti..."})]}):h.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 flex items-center justify-center",children:s.jsx(dn,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Khng c yu cu gia hn"}),s.jsx("p",{className:"text-gray-500",children:"Hin ti khng c yu cu gia hn no cn ph duyt."})]}):s.jsxs("div",{className:"space-y-4 p-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h3",{className:"font-medium text-gray-900",children:["Yu cu gia hn ch duyt (",h.length,")"]})}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:h.map(x=>s.jsx(Gye,{request:x,onApprove:g,onReject:m,isProcessing:p.isPending},x.id))})]})}const Yye={excellent:"Xut sc",good:"Tt",average:"Trung bnh",below_average:"Cn ci thin"};function AT(e){return e?Yye[e]||e:""}function Qye(e){return e&&{excellent:"bg-green-100 text-green-700",good:"bg-blue-100 text-blue-700",average:"bg-yellow-100 text-yellow-700",below_average:"bg-red-100 text-red-700"}[e]||"bg-gray-100 text-gray-600"}function Zye(e){return e>=90?"Xut sc":e>=70?"Tt":e>=50?"Trung bnh":"Cn ci thin"}function Ox(e){return new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})}function ET({priority:e}){const r={low:"bg-gray-100 text-gray-600",medium:"bg-blue-100 text-blue-600",high:"bg-orange-100 text-orange-600",urgent:"bg-red-100 text-red-600"},t={low:"Thp",medium:"Trung bnh",high:"Cao",urgent:"Khn cp"};return s.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(r[e]||"bg-gray-100"),children:t[e]||e})}function Jye(){const e=ts();return s.jsx("div",{className:"min-h-[60vh] flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(nu,{className:"w-10 h-10 text-red-500"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Khng c quyn truy cp"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"Bn khng c quyn ph duyt cng vic. Chc nng ny ch dnh cho Qun l (Trng phng tr ln)."}),s.jsxs("button",{onClick:()=>e("/my-tasks"),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:["i n Cng vic ca ti",s.jsx(Ks,{className:"w-4 h-4"})]})]})})}const exe=()=>{ts();const{user:e}=xn(),{group:r,isAdmin:t}=VO(),[n,a]=R.useState("pending"),[i,o]=R.useState([]),[c,u]=R.useState([]),[l,d]=R.useState(null),[f,p]=R.useState(!0),[h,y]=R.useState(null),[g,m]=R.useState(null),[x,v]=R.useState(0),[w,_]=R.useState(null),[A,P]=R.useState(!1),[B,T]=R.useState({score:80,comments:"",rejection_reason:"",revision_request:""}),I={userLevel:e?.position_level||6,userDepartmentId:e?.department_id||"",isAdmin:t},U=t||r==="executive"||r==="manager",H=R.useCallback(async()=>{if(!(!e?.employee_id||!U))try{const X=await au.countPendingRequestsByRole(e.employee_id,e.position_level||6,e.department_id||null);v(X)}catch(X){console.error("Error fetching extension count:",X),v(0)}},[e?.employee_id,e?.position_level,e?.department_id,U]);R.useEffect(()=>{U?(z(),H()):p(!1)},[U,H]);const z=async()=>{p(!0),y(null);try{const X=await Ql.getPendingEvaluations(I);if(X.error)throw X.error;o(X.data);const re=await Ql.getCompletedWithoutEvaluation(I);if(re.error)throw re.error;u(re.data);const V=await Ql.getApprovalStats(I);d(V)}catch(X){y(X.message||"Khng th ti d liu")}finally{p(!1)}},O=()=>{z(),H()},L=X=>{v(X)};R.useEffect(()=>{if(g){const X=setTimeout(()=>m(null),5e3);return()=>clearTimeout(X)}},[g]);const E=async()=>{if(!(!w||!e?.employee_id)){P(!0);try{const X=w.item,re=await Ql.checkApprovalPermission(X.task_id,I);if(!re.canApprove)throw new Error(re.reason||"Khng c quyn ph duyt");const V=await Ql.approve({self_evaluation_id:X.id,task_id:X.task_id,approver_id:e.employee_id,score:B.score,comments:B.comments});if(!V.success)throw new Error(V.error?.message||"Khng th ph duyt");m(" ph duyt thnh cng!"),_(null),C(),z()}catch(X){y(X.message||"Khng th ph duyt")}finally{P(!1)}}},k=async()=>{if(!(!w||!e?.employee_id||!B.rejection_reason)){P(!0);try{const X=w.item,re=await Ql.checkApprovalPermission(X.task_id,I);if(!re.canApprove)throw new Error(re.reason||"Khng c quyn t chi");const V=await Ql.reject({self_evaluation_id:X.id,task_id:X.task_id,approver_id:e.employee_id,rejection_reason:B.rejection_reason,comments:B.comments});if(!V.success)throw new Error(V.error?.message||"Khng th t chi");m(" t chi thnh cng!"),_(null),C(),z()}catch(X){y(X.message||"Khng th t chi")}finally{P(!1)}}},N=async()=>{if(!(!w||!e?.employee_id||!B.revision_request)){P(!0);try{const X=w.item,re=await Ql.checkApprovalPermission(X.task_id,I);if(!re.canApprove)throw new Error(re.reason||"Khng c quyn yu cu chnh sa");const V=await Ql.requestRevision({self_evaluation_id:X.id,task_id:X.task_id,approver_id:e.employee_id,revision_request:B.revision_request});if(!V.success)throw new Error(V.error?.message||"Khng th yu cu chnh sa");m(" yu cu chnh sa!"),_(null),C(),z()}catch(X){y(X.message||"Khng th yu cu chnh sa")}finally{P(!1)}}},S=async()=>{if(!(!w||!e?.employee_id)){P(!0);try{const X=w.item;if(!X.assignee_id)throw new Error("Cng vic cha c ngi thc hin");const re=await Ql.checkApprovalPermission(X.id,I);if(!re.canApprove)throw new Error(re.reason||"Khng c quyn ph duyt nhanh");const V=await Ql.quickApprove({task_id:X.id,employee_id:X.assignee_id,approver_id:e.employee_id,score:B.score,comments:B.comments});if(!V.success)throw new Error(V.error?.message||"Khng th ph duyt nhanh");m(" ph duyt nhanh thnh cng!"),_(null),C(),z()}catch(X){y(X.message||"Khng th ph duyt nhanh")}finally{P(!1)}}},C=()=>{T({score:80,comments:"",rejection_reason:"",revision_request:""})},D=(X,re)=>{"self_score"in re&&re.self_score&&T(V=>({...V,score:re.self_score})),_({type:X,item:re})},q=()=>{const X="rounded-lg border-2 p-4";return l&&l.pending_evaluations>0?X+" bg-orange-50 border-orange-200":X+" bg-white border-gray-100"},M=()=>{const X="rounded-lg border-2 p-4";return l&&l.completed_without_eval>0?X+" bg-yellow-50 border-yellow-200":X+" bg-white border-gray-100"},G=()=>{const X="rounded-lg border-2 p-4";return x>0?X+" bg-purple-50 border-purple-200":X+" bg-white border-gray-100"};return U?s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ph duyt cng vic"}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${r==="executive"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:[s.jsx(Qc,{className:"w-3 h-3"}),r==="executive"?"Ton cng ty":"Phng ban"]})]}),s.jsx("p",{className:"text-gray-500 mt-1",children:r==="executive"?"Xem xt v ph duyt cng vic ca ton b nhn vin":"Xem xt v ph duyt cng vic ca nhn vin trong phng ban"})]}),s.jsxs("button",{onClick:O,disabled:f,className:"inline-flex items-center gap-2 px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[s.jsx(Vr,{className:`w-4 h-4 ${f?"animate-spin":""}`}),"Lm mi"]})]}),r==="manager"&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[s.jsx(Qc,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-800 font-medium",children:"Phm vi ph duyt"}),s.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Bn ch c th ph duyt cng vic trong phng ban ca mnh. Cng vic do Ban Gim c to s c Ban Gim c ph duyt."})]})]}),l&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[s.jsxs("div",{className:q(),children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Ch ph duyt"}),s.jsx("p",{className:"text-2xl font-bold "+(l.pending_evaluations>0?"text-orange-600":"text-gray-900"),children:l.pending_evaluations})]}),s.jsxs("div",{className:M(),children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Cha t nh gi"}),s.jsx("p",{className:"text-2xl font-bold "+(l.completed_without_eval>0?"text-yellow-600":"text-gray-900"),children:l.completed_without_eval})]}),s.jsxs("div",{className:G(),children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Yu cu gia hn"}),s.jsx("p",{className:`text-2xl font-bold ${x>0?"text-purple-600":"text-gray-900"}`,children:x})]}),s.jsxs("div",{className:"rounded-lg border-2 p-4 bg-green-50 border-green-200",children:[s.jsx("p",{className:"text-sm text-gray-500",children:" duyt (tun)"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.approved_this_week})]}),s.jsxs("div",{className:"rounded-lg border-2 p-4 bg-white border-gray-100",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"T chi (tun)"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.rejected_this_week})]})]}),g&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(hn,{className:"w-5 h-5 text-green-500"}),s.jsx("p",{className:"text-green-700",children:g})]}),h&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(ua,{className:"w-5 h-5 text-red-500"}),s.jsx("p",{className:"text-red-700",children:h}),s.jsx("button",{onClick:()=>y(null),className:"ml-auto text-red-500 hover:text-red-700",children:""})]}),s.jsx("div",{className:"border-b border-gray-200",children:s.jsxs("nav",{className:"-mb-px flex gap-6",children:[s.jsxs("button",{onClick:()=>a("pending"),className:"py-3 px-1 border-b-2 font-medium text-sm transition-colors "+(n==="pending"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Ch ph duyt",i.length>0&&s.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-orange-100 text-orange-700 rounded-full",children:i.length})]}),s.jsxs("button",{onClick:()=>a("no-self-evaluation"),className:"py-3 px-1 border-b-2 font-medium text-sm transition-colors "+(n==="no-self-evaluation"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["Hon thnh cha t nh gi",c.length>0&&s.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded-full",children:c.length})]}),s.jsxs("button",{onClick:()=>a("extensions"),className:"py-3 px-1 border-b-2 font-medium text-sm transition-colors flex items-center gap-1.5 "+(n==="extensions"?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[s.jsx(yO,{className:"w-4 h-4"}),"Yu cu gia hn",x>0&&s.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-purple-100 text-purple-700 rounded-full",children:x})]})]})}),f&&n!=="extensions"?s.jsxs("div",{className:"flex justify-center items-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-500",children:"ang ti..."})]}):s.jsxs(s.Fragment,{children:[n==="pending"&&s.jsx("div",{className:"space-y-4",children:i.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(hn,{className:"w-12 h-12 text-green-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Khng c nh gi no ch ph duyt"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:r==="manager"&&"Trong phm vi phng ban ca bn"})]}):i.map(X=>s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:X.task?.name||"Cng vic khng xc nh"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ls,{className:"w-4 h-4"}),X.employee?.full_name]}),X.task?.priority&&s.jsx(ET,{priority:X.task.priority}),X.task?.assigner&&s.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:["Giao bi: ",X.task.assigner.full_name]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"im t chm"}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:X.self_score})]}),s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Qye(X.quality_assessment)}`,children:AT(X.quality_assessment)})]})]}),X.achievements&&s.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Thnh tu t c"}),s.jsx("p",{className:"text-sm text-gray-700",children:X.achievements})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-4 text-sm text-gray-500",children:[X.task?.due_date&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(dn,{className:"w-4 h-4"}),"Hn: ",Ox(X.task.due_date)]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Xr,{className:"w-4 h-4"}),"nh gi: ",Ox(X.created_at)]})]}),s.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 pt-3 border-t",children:[s.jsxs("button",{onClick:()=>D("approve",X),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-white bg-green-600 rounded-lg hover:bg-green-700",children:[s.jsx(hn,{className:"w-4 h-4"}),"Ph duyt"]}),s.jsxs("button",{onClick:()=>D("revision",X),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-orange-700 bg-orange-100 rounded-lg hover:bg-orange-200",children:[s.jsx(Vr,{className:"w-4 h-4"}),"Yu cu sa"]}),s.jsxs("button",{onClick:()=>D("reject",X),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-red-700 bg-red-100 rounded-lg hover:bg-red-200",children:[s.jsx(ua,{className:"w-4 h-4"}),"T chi"]})]})]})},X.id))}),n==="no-self-evaluation"&&s.jsx("div",{className:"space-y-4",children:c.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[s.jsx(hn,{className:"w-12 h-12 text-green-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Khng c cng vic hon thnh no cha t nh gi"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:r==="manager"&&"Trong phm vi phng ban ca bn"})]}):c.map(X=>s.jsx("div",{className:"bg-white rounded-lg border border-yellow-200 shadow-sm hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:X.name}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ls,{className:"w-4 h-4"}),X.assignee?.full_name||"Cha giao"]}),X.priority&&s.jsx(ET,{priority:X.priority}),X.assigner&&s.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:["Giao bi: ",X.assigner.full_name]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-700 rounded-full",children:"Cha t nh gi"})})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-4 text-sm text-gray-500",children:[X.due_date&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(dn,{className:"w-4 h-4"}),"Hn: ",Ox(X.due_date)]}),X.completed_date&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(hn,{className:"w-4 h-4"}),"Hon thnh: ",Ox(X.completed_date)]})]}),s.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 rounded-lg text-sm text-yellow-700 flex items-start gap-2",children:[s.jsx(Kr,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Nhn vin cha t nh gi. Bn c th ph duyt nhanh hoc ch nhn vin t nh gi."})]}),s.jsx("div",{className:"mt-4 flex flex-wrap items-center gap-2 pt-3 border-t",children:s.jsxs("button",{onClick:()=>D("quick-approve",X),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[s.jsx(_o,{className:"w-4 h-4"}),"Ph duyt nhanh"]})})]})},X.id))}),n==="extensions"&&s.jsx(Xye,{userLevel:e?.position_level||6,userDepartmentId:e?.department_id||null,onCountChange:L})]}),w&&s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>{_(null),C()}}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-lg w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[w.type==="approve"&&s.jsxs(s.Fragment,{children:[s.jsx(hn,{className:"w-5 h-5 text-green-500"})," Ph duyt nh gi"]}),w.type==="reject"&&s.jsxs(s.Fragment,{children:[s.jsx(ua,{className:"w-5 h-5 text-red-500"})," T chi nh gi"]}),w.type==="revision"&&s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-5 h-5 text-orange-500"})," Yu cu chnh sa"]}),w.type==="quick-approve"&&s.jsxs(s.Fragment,{children:[s.jsx(_o,{className:"w-5 h-5 text-blue-500"})," Ph duyt nhanh"]})]}),s.jsx("button",{onClick:()=>{_(null),C()},className:"text-gray-400 hover:text-gray-600",children:""})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Cng vic"}),s.jsx("p",{className:"font-medium text-gray-900",children:"task"in w.item&&w.item.task?w.item.task.name:"name"in w.item?w.item.name:""}),"employee"in w.item&&w.item.employee&&s.jsxs("div",{className:"mt-2",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin thc hin"}),s.jsx("p",{className:"text-gray-900",children:w.item.employee.full_name})]}),"assignee"in w.item&&w.item.assignee&&s.jsxs("div",{className:"mt-2",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Nhn vin thc hin"}),s.jsx("p",{className:"text-gray-900",children:w.item.assignee.full_name})]}),"self_score"in w.item&&w.item.self_score&&s.jsxs("div",{className:"mt-3 pt-3 border-t",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Thng tin t nh gi"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"im t chm"}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:w.item.self_score})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Xp loi"}),s.jsx("p",{className:"font-medium",children:AT(w.item.quality_assessment)})]})]})]}),w.type==="quick-approve"&&s.jsx("div",{className:"mt-3 pt-3 border-t",children:s.jsxs("div",{className:"flex items-start gap-2 text-sm text-yellow-700 bg-yellow-50 p-2 rounded",children:[s.jsx(Kr,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),s.jsx("p",{children:"Ph duyt nhanh s b qua bc t nh gi ca nhn vin. im s do qun l chm trc tip."})]})})]}),s.jsxs("div",{className:"space-y-4",children:[(w.type==="approve"||w.type==="quick-approve")&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["im nh gi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("input",{type:"range",min:"0",max:"100",value:B.score,onChange:X=>T(re=>({...re,score:Number(X.target.value)})),className:"flex-1"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"number",min:"0",max:"100",value:B.score,onChange:X=>T(re=>({...re,score:Number(X.target.value)})),className:"w-20 px-3 py-2 border border-gray-300 rounded-lg text-center"}),s.jsx("span",{className:"text-gray-500",children:"/100"})]})]}),s.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Xp loi: ",s.jsx("span",{className:"font-medium",children:Zye(B.score)})]})]}),(w.type==="approve"||w.type==="reject"||w.type==="quick-approve")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhn xt"}),s.jsx("textarea",{value:B.comments,onChange:X=>T(re=>({...re,comments:X.target.value})),rows:3,placeholder:"Nhn xt v cng vic...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),w.type==="reject"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["L do t chi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:B.rejection_reason,onChange:X=>T(re=>({...re,rejection_reason:X.target.value})),rows:3,placeholder:"Nu r l do t chi...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),w.type==="revision"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Yu cu chnh sa ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:B.revision_request,onChange:X=>T(re=>({...re,revision_request:X.target.value})),rows:3,placeholder:"M t nhng iu cn chnh sa trong t nh gi...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Nhn vin s nhn c thng bo v cn cp nht li t nh gi"})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6 pt-4 border-t",children:[s.jsx("button",{onClick:()=>{_(null),C()},disabled:A,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Hy"}),w.type==="approve"&&s.jsx("button",{onClick:E,disabled:A,className:"inline-flex items-center gap-2 px-4 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hn,{className:"w-4 h-4"}),"Ph duyt"]})}),w.type==="reject"&&s.jsx("button",{onClick:k,disabled:A||!B.rejection_reason,className:"inline-flex items-center gap-2 px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ua,{className:"w-4 h-4"}),"T chi"]})}),w.type==="revision"&&s.jsx("button",{onClick:N,disabled:A||!B.revision_request,className:"inline-flex items-center gap-2 px-4 py-2 text-white bg-orange-600 rounded-lg hover:bg-orange-700 disabled:opacity-50",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4"}),"Yu cu sa"]})}),w.type==="quick-approve"&&s.jsx("button",{onClick:S,disabled:A,className:"inline-flex items-center gap-2 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:A?s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(_o,{className:"w-4 h-4"}),"Ph duyt nhanh"]})})]})]})]})})]}):s.jsx("div",{className:"p-6",children:s.jsx(Jye,{})})},B0={pending:{label:"Ch duyt",color:"text-yellow-700",bg:"bg-yellow-100",icon:s.jsx(Xr,{className:"w-4 h-4"})},approved:{label:" duyt",color:"text-green-700",bg:"bg-green-100",icon:s.jsx(hn,{className:"w-4 h-4"})},rejected:{label:"T chi",color:"text-red-700",bg:"bg-red-100",icon:s.jsx(ua,{className:"w-4 h-4"})},revision_requested:{label:"Cn sa",color:"text-orange-700",bg:"bg-orange-100",icon:s.jsx(Cr,{className:"w-4 h-4"})}},txe=[{value:"excellent",label:"Xut sc",description:"Vt k vng",color:"border-emerald-500 bg-emerald-50 text-emerald-700"},{value:"good",label:"Tt",description:"t yu cu tt",color:"border-blue-500 bg-blue-50 text-blue-700"},{value:"average",label:"Kh",description:"t yu cu c bn",color:"border-yellow-500 bg-yellow-50 text-yellow-700"},{value:"below_average",label:"Trung bnh",description:"Cn ci thin",color:"border-orange-500 bg-orange-50 text-orange-700"}],$0={excellent:{label:"Xut sc",color:"text-emerald-700",bg:"bg-emerald-100"},good:{label:"Tt",color:"text-blue-700",bg:"bg-blue-100"},average:{label:"Kh",color:"text-yellow-700",bg:"bg-yellow-100"},below_average:{label:"Trung bnh",color:"text-orange-700",bg:"bg-orange-100"}};function K_(e){return e>=90?"excellent":e>=70?"good":e>=50?"average":"below_average"}function TT(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function G_(e){return e>=90?"text-emerald-600":e>=70?"text-blue-600":e>=50?"text-yellow-600":"text-orange-600"}const PT=()=>{const e=jo(),r=ts(),[t]=Ib(),{user:n}=xn(),[a,i]=R.useState("list"),[o,c]=R.useState([]),[u,l]=R.useState(null),[d,f]=R.useState(null),[p,h]=R.useState([]),[y,g]=R.useState(!0),[m,x]=R.useState(!1),[v,w]=R.useState(!1),[_,A]=R.useState(null),[P,B]=R.useState(null),[T,I]=R.useState({completion_percentage:100,self_score:80,quality_assessment:"good",achievements:"",difficulties:"",solutions:"",recommendations:""}),[U,H]=R.useState({}),[z,O]=R.useState(""),[L,E]=R.useState("all"),k=n?.employee_id;R.useEffect(()=>{const pe=t.get("task_id");pe&&k&&(console.log(" [SelfEvaluationPage] task_id from URL:",pe),N(pe))},[t,k]),R.useEffect(()=>{const pe=e.state;pe?.selectedTask?(f(pe.selectedTask),i("create"),D()):pe?.selectedTaskId&&k&&N(pe.selectedTaskId)},[e.state,k]),R.useEffect(()=>{k&&S()},[k]),R.useEffect(()=>{a==="select-task"&&k&&C()},[a,k]),R.useEffect(()=>{if(P){const pe=setTimeout(()=>B(null),5e3);return()=>clearTimeout(pe)}},[P]);const N=async pe=>{try{g(!0),A(null);const{data:me,error:Ce}=await se.from("tasks").select(`
          id, code, name, description, status, priority, progress, due_date, department_id,
          department:departments(id, name)
        `).eq("id",pe).single();if(Ce)throw new Error("Khng tm thy cng vic");if(!(me.status==="finished"||me.status==="completed"||me.progress>=100)){A(`Cng vic cha hon thnh (tin : ${me.progress}%). Vui lng hon thnh trc khi t nh gi.`),i("list");return}const{data:xe}=await se.from("task_self_evaluations").select("id, status").eq("task_id",pe).eq("employee_id",k).maybeSingle();if(xe&&xe.status!=="revision_requested"){A(" c t nh gi cho cng vic ny."),i("list"),await S();return}const je={...me,department:Array.isArray(me.department)?me.department[0]:me.department};f(je),i("create"),D()}catch(me){A(me.message||"Khng th ti thng tin cng vic"),i("list")}finally{g(!1)}},S=async()=>{if(k)try{g(!0);const{data:pe,error:me}=await se.from("task_self_evaluations").select(`
          *,
          task:tasks(id, code, name, status, progress, department_id,
            department:departments(id, name)
          )
        `).eq("employee_id",k).order("created_at",{ascending:!1});if(me)throw me;const Ce=(pe||[]).map(fe=>({...fe,task:fe.task?{...fe.task,department:Array.isArray(fe.task.department)?fe.task.department[0]:fe.task.department}:null}));c(Ce)}catch(pe){A(pe.message||"Khng th ti danh sch t nh gi")}finally{g(!1)}},C=async()=>{if(k){w(!0);try{const{data:pe,error:me}=await se.from("tasks").select(`
          id, code, name, status, priority, progress, due_date, department_id,
          department:departments(id, name)
        `).eq("assignee_id",k).or("status.eq.finished,status.eq.completed,progress.gte.100");if(me)throw me;const{data:Ce}=await se.from("task_self_evaluations").select("task_id, status").eq("employee_id",k),fe=new Map;Ce?.forEach(je=>fe.set(je.task_id,je.status));const xe=pe?.filter(je=>{const Oe=fe.get(je.id);return!Oe||Oe==="revision_requested"}).map(je=>({...je,department:Array.isArray(je.department)?je.department[0]:je.department}))||[];h(xe)}catch(pe){A(pe.message||"Khng th ti danh sch cng vic")}finally{w(!1)}}},D=()=>{I({completion_percentage:100,self_score:80,quality_assessment:"good",achievements:"",difficulties:"",solutions:"",recommendations:""}),H({})},q=pe=>{I({completion_percentage:pe.completion_percentage||100,self_score:pe.self_score||80,quality_assessment:pe.quality_assessment||"good",achievements:pe.achievements||"",difficulties:pe.difficulties||"",solutions:pe.solutions||"",recommendations:pe.recommendations||""}),H({})},M=(pe,me)=>{I(Ce=>({...Ce,[pe]:me})),U[pe]&&H(Ce=>{const fe={...Ce};return delete fe[pe],fe})},G=()=>{const pe={};return(T.completion_percentage<0||T.completion_percentage>100)&&(pe.completion_percentage="T l hon thnh phi t 0 n 100"),(T.self_score<0||T.self_score>100)&&(pe.self_score="im t nh gi phi t 0 n 100"),T.quality_assessment||(pe.quality_assessment="Vui lng chn mc nh gi cht lng"),H(pe),Object.keys(pe).length===0},X=async()=>{if(!(!d||!k)&&G()){x(!0),A(null);try{const pe={task_id:d.id,employee_id:k,self_score:T.self_score,quality_assessment:K_(T.self_score),achievements:T.achievements||null,difficulties:T.difficulties||null,solutions:T.solutions||null,recommendations:T.recommendations||null,status:"pending"};console.log(" [SelfEvaluationPage] Inserting:",pe);const{data:me,error:Ce}=await se.from("task_self_evaluations").insert(pe).select();if(Ce)throw console.error(" Insert error:",Ce),Ce;console.log(" Inserted:",me),B(" gi t nh gi thnh cng!"),f(null),i("list"),r("/evaluations/self-evaluation",{replace:!0}),await S()}catch(pe){console.error(" Error:",pe),A(pe.message||"Khng th to t nh gi")}finally{x(!1)}}},re=async()=>{if(u&&G()){x(!0),A(null);try{const pe={self_score:T.self_score,quality_assessment:K_(T.self_score),achievements:T.achievements||null,difficulties:T.difficulties||null,solutions:T.solutions||null,recommendations:T.recommendations||null};u.status==="revision_requested"&&(pe.status="pending"),console.log(" [SelfEvaluationPage] Updating:",pe);const{error:me}=await se.from("task_self_evaluations").update(pe).eq("id",u.id);if(me)throw console.error(" Update error:",me),me;B(" cp nht t nh gi thnh cng!"),l(null),i("list"),await S()}catch(pe){console.error(" Error:",pe),A(pe.message||"Khng th cp nht t nh gi")}finally{x(!1)}}},V=async pe=>{if(confirm("Bn c chc mun xa t nh gi ny?"))try{const{error:me}=await se.from("task_self_evaluations").delete().eq("id",pe.id);if(me)throw me;B(" xa t nh gi"),await S()}catch(me){A(me.message||"Khng th xa t nh gi")}},J=pe=>{l(pe),q(pe),i("edit")},W=pe=>{l(pe),i("view")},F=()=>{i("list"),l(null),f(null),A(null),r("/evaluations/self-evaluation",{replace:!0})},Q=()=>{i("select-task"),A(null)},ne=pe=>{f(pe),D(),i("create")},ie=o.filter(pe=>{if(z){const me=z.toLowerCase(),Ce=(pe.task?.name||"").toLowerCase(),fe=(pe.task?.code||"").toLowerCase();if(!Ce.includes(me)&&!fe.includes(me))return!1}return!(L!=="all"&&pe.status!==L)}),ce=()=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Chn cng vic  nh gi"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Chn cng vic  hon thnh  t nh gi"})]}),s.jsx("button",{onClick:F,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{className:"w-5 h-5"})})]}),v?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Vr,{className:"w-5 h-5 animate-spin text-gray-400"})}):p.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Khng c cng vic no cn t nh gi"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Hon thnh cng vic (100%)  c th t nh gi"})]}):s.jsx("div",{className:"space-y-3",children:p.map(pe=>s.jsx("button",{onClick:()=>ne(pe),className:"w-full p-4 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-left transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-xs font-mono text-gray-500",children:pe.code}),s.jsxs("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded",children:[pe.progress,"%"]})]}),s.jsx("p",{className:"font-medium text-gray-900",children:pe.name}),pe.department?.name&&s.jsx("p",{className:"text-sm text-gray-500",children:pe.department.name})]}),s.jsx("div",{className:"text-blue-600",children:""})]})},pe.id))})]}),de=()=>{const pe=a==="edit",me=pe?u?.task:d;return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:pe?"Chnh sa t nh gi":"To t nh gi mi"})]}),me&&s.jsx("div",{className:"bg-gray-50 rounded-xl p-4 mb-6 border border-gray-200",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(vr,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Cng vic ang nh gi"}),s.jsxs("p",{className:"font-semibold text-gray-900",children:[me.code&&s.jsx("span",{className:"text-gray-500 mr-2",children:me.code}),me.name||me.title]}),me.department?.name&&s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Phng: ",me.department.name]})]})]})}),_&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-500"}),s.jsx("p",{className:"text-red-700",children:_})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Vb,{className:"w-5 h-5 text-blue-600"}),"Kt qu cng vic"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["T l hon thnh (%) ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"number",min:0,max:100,value:T.completion_percentage,onChange:Ce=>M("completion_percentage",parseInt(Ce.target.value)||0),className:`w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 ${U.completion_percentage?"border-red-300":"border-gray-300"}`}),U.completion_percentage&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:U.completion_percentage}),s.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${T.completion_percentage>=100?"bg-green-500":"bg-blue-500"}`,style:{width:`${Math.min(T.completion_percentage,100)}%`}})})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["im t nh gi (0-100) ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"number",min:0,max:100,value:T.self_score,onChange:Ce=>M("self_score",parseInt(Ce.target.value)||0),className:`w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 ${U.self_score?"border-red-300":"border-gray-300"}`}),U.self_score&&s.jsx("p",{className:"text-sm text-red-500 mt-1",children:U.self_score}),s.jsx("input",{type:"range",min:0,max:100,value:T.self_score,onChange:Ce=>M("self_score",parseInt(Ce.target.value)),className:"w-full mt-2"}),s.jsxs("p",{className:`text-sm font-medium mt-1 ${G_(T.self_score)}`,children:["Xp loi: ",$0[K_(T.self_score)]?.label]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Mm,{className:"w-5 h-5 text-yellow-600"}),"nh gi cht lng ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:txe.map(Ce=>s.jsxs("button",{type:"button",onClick:()=>M("quality_assessment",Ce.value),className:`p-4 rounded-xl border-2 text-left transition-all ${T.quality_assessment===Ce.value?Ce.color+" border-current":"bg-white border-gray-200 hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-semibold",children:Ce.label}),T.quality_assessment===Ce.value&&s.jsx(hn,{className:"w-5 h-5"})]}),s.jsx("p",{className:"text-sm opacity-75",children:Ce.description})]},Ce.value))}),U.quality_assessment&&s.jsx("p",{className:"text-sm text-red-500 mt-2",children:U.quality_assessment})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(_o,{className:"w-5 h-5 text-amber-500"}),"Thnh tch t c"]}),s.jsx("textarea",{value:T.achievements,onChange:Ce=>M("achievements",Ce.target.value),rows:3,placeholder:"M t cc thnh tch, kt qu ni bt...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Cr,{className:"w-5 h-5 text-orange-500"}),"Kh khn & Gii php"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kh khn gp phi"}),s.jsx("textarea",{value:T.difficulties,onChange:Ce=>M("difficulties",Ce.target.value),rows:3,placeholder:"M t cc kh khn, thch thc...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gii php  p dng"}),s.jsx("textarea",{value:T.solutions,onChange:Ce=>M("solutions",Ce.target.value),rows:3,placeholder:"M t cc gii php  p dng...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-5",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(ZW,{className:"w-5 h-5 text-green-500"})," xut & Kin ngh"]}),s.jsx("textarea",{value:T.recommendations,onChange:Ce=>M("recommendations",Ce.target.value),rows:3,placeholder:"Cc  xut, kin ngh  ci thin...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:F,disabled:m,className:"px-5 py-2.5 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsxs("button",{type:"button",onClick:pe?re:X,disabled:m,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[m?s.jsx(Vr,{className:"w-4 h-4 animate-spin"}):s.jsx(Hb,{className:"w-4 h-4"}),pe?"Cp nht":"Gi nh gi"]})]})]})]})},le=()=>{if(!u)return null;const pe=B0[u.status]||B0.pending,me=$0[u.quality_assessment]||$0.average;return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Chi tit t nh gi"}),s.jsx("button",{onClick:F,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Thng tin cng vic"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[u.task?.code," - ",u.task?.name]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[u.completion_percentage,"%"]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Hon thnh"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${G_(u.self_score)}`,children:u.self_score}),s.jsx("div",{className:"text-sm text-gray-500",children:"im t G"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${me.bg} ${me.color}`,children:me.label}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Xp loi"})]})]}),u.achievements&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Thnh tch t c"}),s.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:u.achievements})]}),u.difficulties&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Kh khn gp phi"}),s.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:u.difficulties})]}),u.solutions&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Gii php  p dng"}),s.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:u.solutions})]}),u.recommendations&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:" xut, kin ngh"}),s.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:u.recommendations})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Trng thi:"}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${pe.bg} ${pe.color}`,children:[pe.icon,pe.label]})]}),s.jsxs("div",{className:"text-sm text-gray-500 border-t pt-4 mt-4",children:[u.submitted_at&&s.jsxs("p",{children:["Ngy gi: ",TT(u.submitted_at)]}),u.revision_count>0&&s.jsxs("p",{children:["S ln chnh sa: ",u.revision_count]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[s.jsx("button",{onClick:F,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"ng"}),(u.status==="pending"||u.status==="revision_requested")&&s.jsx("button",{onClick:()=>J(u),className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Chnh sa"})]})]})]})},_e=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm kim theo tn cng vic...",value:z,onChange:pe=>O(pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Al,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsxs("select",{value:L,onChange:pe=>E(pe.target.value),className:"pl-9 pr-8 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",children:[s.jsx("option",{value:"all",children:"Tt c trng thi"}),Object.entries(B0).map(([pe,me])=>s.jsx("option",{value:pe,children:me.label},pe))]})]})]}),ie.length===0?s.jsxs("div",{className:"bg-gray-50 rounded-xl p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(vr,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Cha c t nh gi no"}),s.jsx("p",{className:"text-sm text-gray-500",children:z||L!=="all"?"Th thay i b lc  xem thm":"Hon thnh cng vic  bt u t nh gi"})]}):s.jsx("div",{className:"space-y-3",children:ie.map(pe=>{const me=B0[pe.status]||B0.pending,Ce=$0[pe.quality_assessment]||$0.average,fe=pe.status==="pending"||pe.status==="revision_requested";return s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-xs font-mono text-gray-500",children:pe.task?.code}),s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${me.bg} ${me.color}`,children:[me.icon,me.label]})]}),s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:pe.task?.name}),pe.task?.department?.name&&s.jsx("p",{className:"text-sm text-gray-500",children:pe.task.department.name})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[pe.completion_percentage,"%"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Hon thnh"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-lg font-bold ${G_(pe.self_score)}`,children:pe.self_score}),s.jsx("div",{className:"text-xs text-gray-500",children:"im"})]}),s.jsx("div",{className:"text-center",children:s.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${Ce.bg} ${Ce.color}`,children:Ce.label})})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(dn,{className:"w-4 h-4"}),s.jsx("span",{children:TT(pe.submitted_at||pe.created_at)})]}),pe.revision_count>0&&s.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:[" sa ",pe.revision_count," ln"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>W(pe),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"Xem chi tit",children:s.jsx(ja,{className:"w-4 h-4"})}),fe&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>J(pe),className:"p-2 text-gray-500 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg",title:"Chnh sa",children:s.jsx(yg,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>V(pe),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})]})]})},pe.id)})}),ie.length>0&&s.jsxs("div",{className:"text-sm text-gray-500 text-center",children:["Hin th ",ie.length," / ",o.length," t nh gi"]})]}),ue=()=>{switch(a){case"select-task":return ce();case"create":case"edit":return de();case"view":return le();default:return _e()}};return y&&a==="list"&&o.length===0?s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-3 text-gray-500",children:[s.jsx(Vr,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"ang ti..."})]})})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"T nh gi"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l t nh gi cng vic ca bn"})]}),a==="list"&&s.jsxs("button",{onClick:Q,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{className:"w-5 h-5"}),"To t nh gi"]})]}),P&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(hn,{className:"w-5 h-5 text-green-500"}),s.jsx("p",{className:"text-green-700",children:P})]}),_&&a==="list"&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-500"}),s.jsx("p",{className:"text-red-700",children:_})]}),ue()]})},OT={draft:{label:"Nhp",color:"text-gray-600",bgColor:"bg-gray-100"},in_progress:{label:"ang lm",color:"text-blue-600",bgColor:"bg-blue-100"},paused:{label:"Tm dng",color:"text-yellow-600",bgColor:"bg-yellow-100"},finished:{label:"Hon thnh",color:"text-green-600",bgColor:"bg-green-100"},cancelled:{label:" hy",color:"text-red-600",bgColor:"bg-red-100"}},MT={low:{label:"Thp",color:"text-gray-600",bgColor:"bg-gray-100"},medium:{label:"Trung bnh",color:"text-blue-600",bgColor:"bg-blue-100"},high:{label:"Cao",color:"text-orange-600",bgColor:"bg-orange-100"},urgent:{label:"Khn cp",color:"text-red-600",bgColor:"bg-red-100"}},Mx={A:{label:"Xut sc",color:"text-green-600"},B:{label:"Tt",color:"text-blue-600"},C:{label:"t",color:"text-yellow-600"},D:{label:"Cn ci thin",color:"text-orange-600"},F:{label:"Khng t",color:"text-red-600"}},rxe=({status:e})=>{const r=OT[e]||OT.draft;return s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.bgColor} ${r.color}`,children:[s.jsx("span",{className:"w-2 h-2 rounded-full bg-current mr-2"}),r.label]})},nxe=({priority:e})=>{const r=MT[e]||MT.medium;return s.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r.bgColor} ${r.color}`,children:[s.jsx(Ub,{className:"w-3 h-3 mr-1"}),r.label]})},sxe=({progress:e,size:r=120})=>{const t=(r-12)/2,n=2*Math.PI*t,a=n-e/100*n,i=o=>o>=100?"#22c55e":o>=75?"#3b82f6":o>=50?"#f59e0b":"#ef4444";return s.jsxs("div",{className:"relative",style:{width:r,height:r},children:[s.jsxs("svg",{className:"transform -rotate-90",width:r,height:r,children:[s.jsx("circle",{cx:r/2,cy:r/2,r:t,stroke:"#e5e7eb",strokeWidth:"8",fill:"none"}),s.jsx("circle",{cx:r/2,cy:r/2,r:t,stroke:i(e),strokeWidth:"8",fill:"none",strokeDasharray:n,strokeDashoffset:a,strokeLinecap:"round",className:"transition-all duration-500"})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsxs("span",{className:"text-2xl font-bold",style:{color:i(e)},children:[e,"%"]}),s.jsx("span",{className:"text-xs text-gray-500",children:"Hon thnh"})]})]})},zp=({icon:e,label:r,value:t})=>s.jsxs("div",{className:"flex items-start gap-3 py-3 border-b border-gray-100 last:border-0",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-gray-500",children:e}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-gray-500",children:r}),s.jsx("div",{className:"text-sm font-medium text-gray-900 mt-0.5",children:t||"-"})]})]}),axe=({message:e})=>s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3",children:[s.jsx(da,{className:"w-5 h-5 text-yellow-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:e}),s.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Cng vic ang trong quy trnh nh gi, mt s thao tc b hn ch."})]})]}),IT=({isOpen:e,title:r,message:t,confirmText:n="Xc nhn",cancelText:a="Hy",confirmColor:i="blue",onConfirm:o,onCancel:c,loading:u=!1})=>{if(!e)return null;const l={red:"bg-red-600 hover:bg-red-700",blue:"bg-blue-600 hover:bg-blue-700",green:"bg-green-600 hover:bg-green-700"};return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30",onClick:c}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),s.jsx("p",{className:"text-gray-600 mb-6",children:t}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:c,disabled:u,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:a}),s.jsxs("button",{onClick:o,disabled:u,className:`px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors flex items-center gap-2 ${l[i]}`,children:[u&&s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),n]})]})]})]})})},RT=()=>{const e=_h(),r=e.taskId||e.id,t=ts(),{user:n}=xn(),[a,i]=R.useState(null),[o,c]=R.useState(null),[u,l]=R.useState(null),[d,f]=R.useState(!0),[p,h]=R.useState(null),[y,g]=R.useState(null),[m,x]=R.useState(!1),[v,w]=R.useState(!1),[_,A]=R.useState(!1),P=R.useCallback(async()=>{if(r){f(!0),h(null);try{const{data:O,error:L}=await se.from("tasks").select(`
          *,
          department:departments(id, code, name),
          assigner:employees!tasks_assigner_id_fkey(id, code, full_name),
          assignee:employees!tasks_assignee_id_fkey(id, code, full_name),
          parent_task:tasks!tasks_parent_task_id_fkey(id, code, name)
        `).eq("id",r).single();if(L)throw L;if(!O)throw new Error("Khng tm thy cng vic");if(i(O),n){const k=Kb(O,n.role||"employee",n.department_id,void 0,n.role==="admin");g(k)}const{data:E}=await se.from("task_self_evaluations").select("*, employee:employees(full_name)").eq("task_id",r).order("created_at",{ascending:!1}).limit(1).single();if(E){c(E);const{data:k}=await se.from("task_approvals").select("*, approver:employees(full_name)").eq("self_evaluation_id",E.id).single();k&&l(k)}}catch(O){console.error("Error fetching task:",O),h(O.message||"C li xy ra khi ti d liu")}finally{f(!1)}}},[r,n]);R.useEffect(()=>{P()},[P]);const B=()=>{a&&y?.canEdit&&t(`/tasks/${a.id}/edit`)},T=async()=>{if(!(!a||!y?.canDelete)){A(!0);try{const{error:O}=await se.from("tasks").delete().eq("id",a.id);if(O)throw O;t("/tasks",{replace:!0})}catch(O){alert("C li xy ra khi xa cng vic: "+O.message)}finally{A(!1),x(!1)}}},I=async()=>{if(!(!a||!y?.canCancel)){A(!0);try{const{error:O}=await se.from("tasks").update({status:"cancelled"}).eq("id",a.id);if(O)throw O;await P()}catch(O){alert("C li xy ra khi hy cng vic: "+O.message)}finally{A(!1),w(!1)}}},U=()=>{a&&t(`/my-tasks?tab=awaiting_eval&taskId=${a.id}`)},H=()=>{a&&t(`/approvals?taskId=${a.id}`)};if(d)return s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500",children:"ang ti..."})]})});if(p||!a)return s.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px]",children:[s.jsx(Cr,{className:"w-12 h-12 text-red-500 mb-4"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:p||"Khng tm thy cng vic"}),s.jsx("button",{onClick:()=>t(-1),className:"text-blue-600 hover:underline",children:"Quay li"})]});const z=AX(a);return s.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[s.jsx(wo,{className:"w-4 h-4"}),"Quay li"]}),s.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[s.jsx("span",{className:"text-sm text-gray-500 font-mono",children:a.code}),s.jsx(rxe,{status:a.status}),s.jsx(nxe,{priority:a.priority}),a.evaluation_status&&a.evaluation_status!=="none"&&s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${EX(a.evaluation_status)}`,children:TX(a.evaluation_status)})]}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.name})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(Vr,{className:"w-4 h-4"}),"Lm mi"]}),y?.canEdit?s.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ad,{className:"w-4 h-4"}),"Sa"]}):s.jsxs("button",{disabled:!0,title:y?.editDisabledReason||"Khng c quyn sa",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-400 bg-gray-100 rounded-lg cursor-not-allowed",children:[s.jsx(da,{className:"w-4 h-4"}),"Sa"]}),y?.canDelete?s.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors",children:[s.jsx(En,{className:"w-4 h-4"}),"Xa"]}):s.jsxs("button",{disabled:!0,title:y?.deleteDisabledReason||"Khng c quyn xa",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-400 bg-gray-100 rounded-lg cursor-not-allowed",children:[s.jsx(da,{className:"w-4 h-4"}),"Xa"]})]})]})]}),z&&s.jsx("div",{className:"mb-6",children:s.jsx(axe,{message:z})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(vr,{className:"w-5 h-5 text-gray-400"}),"Chi tit cng vic"]}),s.jsx("div",{className:"prose prose-sm max-w-none text-gray-600",children:a.description||s.jsx("span",{className:"text-gray-400 italic",children:"Cha c m t"})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(_i,{className:"w-5 h-5 text-gray-400"}),"Thng tin phn cng"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8",children:[s.jsx(zp,{icon:s.jsx($r,{className:"w-4 h-4"}),label:"Phng ban",value:a.department?.name}),s.jsx(zp,{icon:s.jsx(ls,{className:"w-4 h-4"}),label:"Ngi giao",value:a.assigner?.full_name}),s.jsx(zp,{icon:s.jsx(ls,{className:"w-4 h-4"}),label:"Ngi thc hin",value:a.assignee?.full_name}),s.jsx(zp,{icon:s.jsx(dn,{className:"w-4 h-4"}),label:"Ngy bt u",value:a.start_date?new Date(a.start_date).toLocaleDateString("vi-VN"):null}),s.jsx(zp,{icon:s.jsx(dn,{className:"w-4 h-4"}),label:"Hn hon thnh",value:a.due_date?new Date(a.due_date).toLocaleString("vi-VN"):null}),s.jsx(zp,{icon:s.jsx(hn,{className:"w-4 h-4"}),label:"Ngy hon thnh",value:a.completed_date?new Date(a.completed_date).toLocaleString("vi-VN"):null})]})]}),s.jsx(dF,{taskId:a.id,taskAssigneeId:a.assignee_id,onParticipantChange:P}),o&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(_o,{className:"w-5 h-5 text-yellow-500"}),"T nh gi"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"im t nh gi"}),s.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[o.score,"/100"]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Xp loi"}),s.jsxs("p",{className:`text-xl font-bold ${Mx[o.rating]?.color||"text-gray-600"}`,children:[o.rating," - ",Mx[o.rating]?.label||o.rating]})]})]}),o.achievements&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Thnh tu t c"}),s.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:o.achievements})]}),o.challenges&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Kh khn gp phi"}),s.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:o.challenges})]}),o.comments&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Nhn xt"}),s.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:o.comments})]}),s.jsxs("div",{className:"text-xs text-gray-400 pt-2",children:["Gi bi: ",o.employee?.full_name,"  ",o.submitted_at&&new Date(o.submitted_at).toLocaleString("vi-VN")]})]})]}),u&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Mm,{className:"w-5 h-5 text-green-500"}),"Kt qu ph duyt"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[u.score!==null&&s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"im duyt"}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[u.score,"/100"]})]}),u.rating&&s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Xp loi cui"}),s.jsxs("p",{className:`text-xl font-bold ${Mx[u.rating]?.color||"text-gray-600"}`,children:[u.rating," - ",Mx[u.rating]?.label||u.rating]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Quyt nh"}),s.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${u.decision==="approved"?"bg-green-100 text-green-800":u.decision==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:u.decision==="approved"?" duyt":u.decision==="rejected"?"T chi":"Yu cu sa"})]})]}),u.comments&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Nhn xt ca ngi duyt"}),s.jsx("p",{className:"text-sm text-gray-600 bg-green-50 p-3 rounded-lg",children:u.comments})]}),s.jsxs("div",{className:"text-xs text-gray-400 pt-2",children:["Duyt bi: ",u.approver?.full_name,"  ",u.approved_at&&new Date(u.approved_at).toLocaleString("vi-VN")]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(md,{className:"w-5 h-5 text-blue-500"}),"Tin  cng vic"]}),s.jsx("div",{className:"flex justify-center py-4",children:s.jsx(sxe,{progress:a.progress})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Xr,{className:"w-5 h-5 text-gray-400"}),"Thi gian"]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Ngy to"}),s.jsx("span",{className:"font-medium",children:a.created_at?new Date(a.created_at).toLocaleString("vi-VN"):"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Cp nht"}),s.jsx("span",{className:"font-medium",children:a.updated_at?new Date(a.updated_at).toLocaleString("vi-VN"):"-"})]}),a.completed_date&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Hon thnh"}),s.jsx("span",{className:"font-medium text-green-600",children:new Date(a.completed_date).toLocaleString("vi-VN")})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Thao tc nhanh"}),s.jsxs("div",{className:"space-y-2",children:[y?.canSelfEvaluate&&s.jsxs("button",{onClick:U,className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[s.jsx(_o,{className:"w-5 h-5"}),"T nh gi cng vic"]}),y?.canApprove&&s.jsxs("button",{onClick:H,className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[s.jsx(hn,{className:"w-5 h-5"}),"Ph duyt nh gi"]}),y?.canMarkComplete&&s.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors",children:[s.jsx(hn,{className:"w-5 h-5"}),"nh du hon thnh"]}),y?.canPause&&s.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-yellow-700 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors",children:[s.jsx(vK,{className:"w-5 h-5"}),"Tm dng cng vic"]}),y?.canResume&&s.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:[s.jsx(kO,{className:"w-5 h-5"}),"Tip tc cng vic"]}),y?.canCancel&&s.jsxs("button",{onClick:()=>w(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-left text-sm font-medium text-red-700 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[s.jsx(ua,{className:"w-5 h-5"}),"Hy cng vic"]}),!y?.canSelfEvaluate&&!y?.canApprove&&!y?.canMarkComplete&&!y?.canPause&&!y?.canResume&&!y?.canCancel&&s.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Khng c thao tc no kh dng"})]})]}),a.notes&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(vv,{className:"w-5 h-5 text-gray-400"}),"Ghi ch"]}),s.jsx("p",{className:"text-sm text-gray-600",children:a.notes})]})]})]}),s.jsx(IT,{isOpen:m,title:"Xc nhn xa cng vic",message:`Bn c chc chn mun xa cng vic "${a.name}"? Hnh ng ny khng th hon tc.`,confirmText:"Xa",confirmColor:"red",onConfirm:T,onCancel:()=>x(!1),loading:_}),s.jsx(IT,{isOpen:v,title:"Xc nhn hy cng vic",message:`Bn c chc chn mun hy cng vic "${a.name}"? Cng vic s chuyn sang trng thi " hy".`,confirmText:"Hy cng vic",confirmColor:"red",onConfirm:I,onCancel:()=>w(!1),loading:_})]})},Yu={async getCompletionByDepartment(e={}){console.log("[taskReportService.getCompletionByDepartment] Filter:",e);const{data:r,error:t}=await se.rpc("get_completion_by_department",{p_start_date:e.start_date||null,p_end_date:e.end_date||null});if(t)throw console.error("[taskReportService.getCompletionByDepartment] Error:",t),t;return console.log("[taskReportService.getCompletionByDepartment] Result:",r?.length||0),r||[]},async getCompletionByPosition(e={}){console.log("[taskReportService.getCompletionByPosition] Filter:",e);const{data:r,error:t}=await se.rpc("get_completion_by_position",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null});if(t)throw console.error("[taskReportService.getCompletionByPosition] Error:",t),t;return console.log("[taskReportService.getCompletionByPosition] Result:",r?.length||0),r||[]},async getCompletionByEmployee(e={}){console.log("[taskReportService.getCompletionByEmployee] Filter:",e);const{data:r,error:t}=await se.rpc("get_completion_by_employee",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null});if(t)throw console.error("[taskReportService.getCompletionByEmployee] Error:",t),t;return console.log("[taskReportService.getCompletionByEmployee] Result:",r?.length||0),r||[]},async getCompletionTimeline(e={}){console.log("[taskReportService.getCompletionTimeline] Filter:",e);const{data:r,error:t}=await se.rpc("get_completion_timeline",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null,p_group_by:e.group_by||"month"});if(t)throw console.error("[taskReportService.getCompletionTimeline] Error:",t),t;return console.log("[taskReportService.getCompletionTimeline] Result:",r?.length||0),r||[]},async getPerformanceMetrics(e={}){console.log("[taskReportService.getPerformanceMetrics] Filter:",e);const{data:r,error:t}=await se.rpc("get_performance_metrics",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null});if(t)throw console.error("[taskReportService.getPerformanceMetrics] Error:",t),t;return console.log("[taskReportService.getPerformanceMetrics] Result:",r),(Array.isArray(r)?r[0]:r)||{total_tasks:0,finished_tasks:0,in_progress_tasks:0,cancelled_tasks:0,overdue_count:0,on_time_count:0,completion_rate:0,on_time_rate:0,overdue_rate:0,avg_score:null,avg_completion_days:null}},async getTopPerformers(e={}){console.log("[taskReportService.getTopPerformers] Filter:",e),console.log("[taskReportService.getTopPerformers] Limit:",e.limit||10);const{data:r,error:t}=await se.rpc("get_top_performers",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null,p_limit:e.limit||10});if(t)throw console.error("[taskReportService.getTopPerformers] Error:",t),t;return console.log("[taskReportService.getTopPerformers] Result:",r?.length||0),r||[]},async getOverdueTasks(e={}){console.log("[taskReportService.getOverdueTasks] Filter:",e);const{data:r,error:t}=await se.rpc("get_overdue_tasks",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null,p_limit:e.limit||50});if(t)throw console.error("[taskReportService.getOverdueTasks] Error:",t),t;return console.log("[taskReportService.getOverdueTasks] Result:",r?.length||0),r||[]},async getTimeSeriesData(e={}){console.log("[taskReportService.getTimeSeriesData] Filter:",e);try{const{data:r,error:t}=await se.rpc("get_completion_timeline",{p_department_id:e.department_id||null,p_start_date:e.start_date||null,p_end_date:e.end_date||null,p_group_by:"day"});if(t)throw t;return console.log("[taskReportService.getTimeSeriesData] Result:",r?.length||0),r||[]}catch(r){return console.error("[taskReportService.getTimeSeriesData] Error:",r),[]}}};function Ix(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var X_={exports:{}};var LT;function ixe(){return LT||(LT=1,(function(e,r){(function(t){e.exports=t()})((function(){return(function t(n,a,i){function o(l,d){if(!a[l]){if(!n[l]){var f=typeof Ix=="function"&&Ix;if(!d&&f)return f(l,!0);if(c)return c(l,!0);var p=new Error("Cannot find module '"+l+"'");throw p.code="MODULE_NOT_FOUND",p}var h=a[l]={exports:{}};n[l][0].call(h.exports,(function(y){return o(n[l][1][y]||y)}),h,h.exports,t,n,a,i)}return a[l].exports}for(var c=typeof Ix=="function"&&Ix,u=0;u<i.length;u++)o(i[u]);return o})({1:[function(t,n,a){const i=t("fs"),o=t("fast-csv"),c=t("dayjs/plugin/customParseFormat"),u=t("dayjs/plugin/utc"),l=t("dayjs").extend(c).extend(u),d=t("../utils/stream-buf"),{fs:{exists:f}}=t("../utils/utils"),p={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(h){this.workbook=h,this.worksheet=null}async readFile(h,y){if(y=y||{},!await f(h))throw new Error("File not found: "+h);const g=i.createReadStream(h),m=await this.read(g,y);return g.close(),m}read(h,y){return y=y||{},new Promise((g,m)=>{const x=this.workbook.addWorksheet(y.sheetName),v=y.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],w=y.map||function(A){if(A==="")return null;const P=Number(A);if(!Number.isNaN(P)&&P!==1/0)return P;const B=v.reduce((I,U)=>{if(I)return I;const H=l(A,U,!0);return H.isValid()?H:null},null);if(B)return new Date(B.valueOf());const T=p[A];return T!==void 0?T:A},_=o.parse(y.parserOptions).on("data",A=>{x.addRow(A.map(w))}).on("end",()=>{_.emit("worksheet",x)});_.on("worksheet",g).on("error",m),h.pipe(_)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(h,y){return new Promise((g,m)=>{y=y||{};const x=this.workbook.getWorksheet(y.sheetName||y.sheetId),v=o.format(y.formatterOptions);h.on("finish",()=>{g()}),v.on("error",m),v.pipe(h);const{dateFormat:w,dateUTC:_}=y,A=y.map||(T=>{if(T){if(T.text||T.hyperlink)return T.hyperlink||T.text||"";if(T.formula||T.result)return T.result||"";if(T instanceof Date)return w?_?l.utc(T).format(w):l(T).format(w):_?l.utc(T).format():l(T).format();if(T.error)return T.error;if(typeof T=="object")return JSON.stringify(T)}return T}),P=y.includeEmptyRows===void 0||y.includeEmptyRows;let B=1;x&&x.eachRow((T,I)=>{if(P)for(;B++<I-1;)v.write([]);const{values:U}=T;U.shift(),v.write(U.map(A)),B=I}),v.end()})}writeFile(h,y){const g={encoding:(y=y||{}).encoding||"utf8"},m=i.createWriteStream(h,g);return this.write(m,y)}async writeBuffer(h){const y=new d;return await this.write(y,h),y.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(t,n,a){const i=t("../utils/col-cache");class o{constructor(u,l){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=u,l)if(typeof l=="string"){const f=i.decodeAddress(l);this.nativeCol=f.col+d,this.nativeColOff=0,this.nativeRow=f.row+d,this.nativeRowOff=0}else l.nativeCol!==void 0?(this.nativeCol=l.nativeCol||0,this.nativeColOff=l.nativeColOff||0,this.nativeRow=l.nativeRow||0,this.nativeRowOff=l.nativeRowOff||0):l.col!==void 0?(this.col=l.col+d,this.row=l.row+d):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(u){return u instanceof o||u==null?u:new o(u)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(u){this.nativeCol=Math.floor(u),this.nativeColOff=Math.floor((u-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(u){this.nativeRow=Math.floor(u),this.nativeRowOff=Math.floor((u-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(u){this.nativeCol=u.nativeCol,this.nativeColOff=u.nativeColOff,this.nativeRow=u.nativeRow,this.nativeRowOff=u.nativeRowOff}}n.exports=o},{"../utils/col-cache":19}],3:[function(t,n,a){const i=t("../utils/col-cache"),o=t("../utils/under-dash"),c=t("./enums"),{slideFormula:u}=t("../utils/shared-formula"),l=t("./note");class d{constructor(h,y,g){if(!h||!y)throw new Error("A Cell needs a Row");this._row=h,this._column=y,i.validateAddress(g),this._address=g,this._value=f.create(d.Types.Null,this),this.style=this._mergeStyle(h.style,y.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(h){this.style.numFmt=h}get font(){return this.style.font}set font(h){this.style.font=h}get alignment(){return this.style.alignment}set alignment(h){this.style.alignment=h}get border(){return this.style.border}set border(h){this.style.border=h}get fill(){return this.style.fill}set fill(h){this.style.fill=h}get protection(){return this.style.protection}set protection(h){this.style.protection=h}_mergeStyle(h,y,g){const m=h&&h.numFmt||y&&y.numFmt;m&&(g.numFmt=m);const x=h&&h.font||y&&y.font;x&&(g.font=x);const v=h&&h.alignment||y&&y.alignment;v&&(g.alignment=v);const w=h&&h.border||y&&y.border;w&&(g.border=w);const _=h&&h.fill||y&&y.fill;_&&(g.fill=_);const A=h&&h.protection||y&&y.protection;return A&&(g.protection=A),g}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===d.Types.Merge}merge(h,y){this._value.release(),this._value=f.create(d.Types.Merge,this,h),y||(this.style=h.style)}unmerge(){this.type===d.Types.Merge&&(this._value.release(),this._value=f.create(d.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(h){return this._value.type===d.Types.Merge&&this._value.isMergedTo(h)}get master(){return this.type===d.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===d.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(h){this.type!==d.Types.Merge?(this._value.release(),this._value=f.create(f.getType(h),this,h)):this._value.master.value=h}get note(){return this._comment&&this._comment.note}set note(h){this._comment=new l(h)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(h){this.type===d.Types.String&&(this._value=f.create(d.Types.Hyperlink,this,{text:this._value.value,hyperlink:h}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:h}=this._row;return{sheetName:h.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(h){this.names=[h]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(h){const{definedNames:y}=this.workbook;y.removeAllNames(this.fullAddress),h.forEach(g=>{y.addEx(this.fullAddress,g)})}addName(h){this.workbook.definedNames.addEx(this.fullAddress,h)}removeName(h){this.workbook.definedNames.removeEx(this.fullAddress,h)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(h){this._dataValidations.add(this.address,h)}get model(){const{model:h}=this._value;return h.style=this.style,this._comment&&(h.comment=this._comment.model),h}set model(h){this._value.release(),this._value=f.create(h.type,this),this._value.model=h,h.comment&&h.comment.type==="note"&&(this._comment=l.fromModel(h.comment)),h.style?this.style=h.style:this.style={}}}d.Types=c.ValueType;const f={getType:p=>p==null?d.Types.Null:p instanceof String||typeof p=="string"?d.Types.String:typeof p=="number"?d.Types.Number:typeof p=="boolean"?d.Types.Boolean:p instanceof Date?d.Types.Date:p.text&&p.hyperlink?d.Types.Hyperlink:p.formula||p.sharedFormula?d.Types.Formula:p.richText?d.Types.RichText:p.sharedString?d.Types.SharedString:p.error?d.Types.Error:d.Types.JSON,types:[{t:d.Types.Null,f:class{constructor(p){this.model={address:p.address,type:d.Types.Null}}get value(){return null}set value(p){}get type(){return d.Types.Null}get effectiveType(){return d.Types.Null}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return""}release(){}toString(){return""}}},{t:d.Types.Number,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Number,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Number}get effectiveType(){return d.Types.Number}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.String,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:d.Types.Date,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Date,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Date}get effectiveType(){return d.Types.Date}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Hyperlink,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Hyperlink,text:h?h.text:void 0,hyperlink:h?h.hyperlink:void 0},h&&h.tooltip&&(this.model.tooltip=h.tooltip)}get value(){const p={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(p.tooltip=this.model.tooltip),p}set value(p){this.model={text:p.text,hyperlink:p.hyperlink},p.tooltip&&(this.model.tooltip=p.tooltip)}get text(){return this.model.text}set text(p){this.model.text=p}get hyperlink(){return this.model.hyperlink}set hyperlink(p){this.model.hyperlink=p}get type(){return d.Types.Hyperlink}get effectiveType(){return d.Types.Hyperlink}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:d.Types.Formula,f:class{constructor(p,h){this.cell=p,this.model={address:p.address,type:d.Types.Formula,shareType:h?h.shareType:void 0,ref:h?h.ref:void 0,formula:h?h.formula:void 0,sharedFormula:h?h.sharedFormula:void 0,result:h?h.result:void 0}}_copyModel(p){const h={},y=g=>{const m=p[g];m&&(h[g]=m)};return y("formula"),y("result"),y("ref"),y("shareType"),y("sharedFormula"),h}get value(){return this._copyModel(this.model)}set value(p){this.model=this._copyModel(p)}validate(p){switch(f.getType(p)){case d.Types.Null:case d.Types.String:case d.Types.Number:case d.Types.Date:break;case d.Types.Hyperlink:case d.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(p){this.model.formula=p}get formulaType(){return this.model.formula?c.FormulaType.Master:this.model.sharedFormula?c.FormulaType.Shared:c.FormulaType.None}get result(){return this.model.result}set result(p){this.model.result=p}get type(){return d.Types.Formula}get effectiveType(){const p=this.model.result;return p==null?c.ValueType.Null:p instanceof String||typeof p=="string"?c.ValueType.String:typeof p=="number"?c.ValueType.Number:p instanceof Date?c.ValueType.Date:p.text&&p.hyperlink?c.ValueType.Hyperlink:p.formula?c.ValueType.Formula:c.ValueType.Null}get address(){return this.model.address}set address(p){this.model.address=p}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:p}=this.cell,h=p.findCell(this.model.sharedFormula);this._translatedFormula=h&&u(h.formula,h.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:d.Types.Merge,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Merge,master:h?h.address:void 0},this._master=h,h&&h.addMergeRef()}get value(){return this._master.value}set value(p){p instanceof d?(this._master&&this._master.releaseMergeRef(),p.addMergeRef(),this._master=p):this._master.value=p}isMergedTo(p){return p===this._master}get master(){return this._master}get type(){return d.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:d.Types.JSON,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:JSON.stringify(h),rawValue:h}}get value(){return this.model.rawValue}set value(p){this.model.rawValue=p,this.model.value=JSON.stringify(p)}get type(){return d.Types.String}get effectiveType(){return d.Types.String}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:d.Types.SharedString,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.SharedString,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.SharedString}get effectiveType(){return d.Types.SharedString}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.RichText,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.String,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}toString(){return this.model.value.richText.map(p=>p.text).join("")}get type(){return d.Types.RichText}get effectiveType(){return d.Types.RichText}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:d.Types.Boolean,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Boolean,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Boolean}get effectiveType(){return d.Types.Boolean}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:d.Types.Error,f:class{constructor(p,h){this.model={address:p.address,type:d.Types.Error,value:h}}get value(){return this.model.value}set value(p){this.model.value=p}get type(){return d.Types.Error}get effectiveType(){return d.Types.Error}get address(){return this.model.address}set address(p){this.model.address=p}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((p,h)=>(p[h.t]=h.f,p),[]),create(p,h,y){const g=this.types[p];if(!g)throw new Error("Could not create Value of type "+p);return new g(h,y)}};n.exports=d},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(t,n,a){const i=t("../utils/under-dash"),o=t("./enums"),c=t("../utils/col-cache");class u{constructor(d,f,p){this._worksheet=d,this._number=f,p!==!1&&(this.defn=p)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return c.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(d){d?(this.key=d.key,this.width=d.width!==void 0?d.width:9,this.outlineLevel=d.outlineLevel,d.style?this.style=d.style:this.style={},this.header=d.header,this._hidden=!!d.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(d){d!==void 0?(this._header=d,this.headers.forEach((f,p)=>{this._worksheet.getCell(p+1,this.number).value=f})):this._header=void 0}get key(){return this._key}set key(d){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=d,d&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(d){this._hidden=d}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(d){this._outlineLevel=d}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(d){return this.width===d.width&&this.hidden===d.hidden&&this.outlineLevel===d.outlineLevel&&i.isEqual(this.style,d.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const d=this.style;return!d||!(d.font||d.numFmt||d.alignment||d.border||d.fill||d.protection)}get headerCount(){return this.headers.length}eachCell(d,f){const p=this.number;f||(f=d,d=null),this._worksheet.eachRow(d,(h,y)=>{f(h.getCell(p),y)})}get values(){const d=[];return this.eachCell((f,p)=>{f&&f.type!==o.ValueType.Null&&(d[p]=f.value)}),d}set values(d){if(!d)return;const f=this.number;let p=0;d.hasOwnProperty("0")&&(p=1),d.forEach((h,y)=>{this._worksheet.getCell(y+p,f).value=h})}_applyStyle(d,f){return this.style[d]=f,this.eachCell(p=>{p[d]=f}),f}get numFmt(){return this.style.numFmt}set numFmt(d){this._applyStyle("numFmt",d)}get font(){return this.style.font}set font(d){this._applyStyle("font",d)}get alignment(){return this.style.alignment}set alignment(d){this._applyStyle("alignment",d)}get protection(){return this.style.protection}set protection(d){this._applyStyle("protection",d)}get border(){return this.style.border}set border(d){this._applyStyle("border",d)}get fill(){return this.style.fill}set fill(d){this._applyStyle("fill",d)}static toModel(d){const f=[];let p=null;return d&&d.forEach((h,y)=>{h.isDefault?p&&(p=null):p&&h.equivalentTo(p)?p.max=y+1:(p={min:y+1,max:y+1,width:h.width!==void 0?h.width:9,style:h.style,isCustomWidth:h.isCustomWidth,hidden:h.hidden,outlineLevel:h.outlineLevel,collapsed:h.collapsed},f.push(p))}),f.length?f:void 0}static fromModel(d,f){const p=[];let h=1,y=0;for(f=(f=f||[]).sort((function(g,m){return g.min-m.min}));y<f.length;){const g=f[y++];for(;h<g.min;)p.push(new u(d,h++));for(;h<=g.max;)p.push(new u(d,h++,g))}return p.length?p:null}}n.exports=u},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(t,n,a){n.exports=class{constructor(i){this.model=i||{}}add(i,o){return this.model[i]=o}find(i){return this.model[i]}remove(i){this.model[i]=void 0}}},{}],6:[function(t,n,a){const i=t("../utils/under-dash"),o=t("../utils/col-cache"),c=t("../utils/cell-matrix"),u=t("./range"),l=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(d){return this.matrixMap[d]||(this.matrixMap[d]=new c)}add(d,f){const p=o.decodeEx(d);this.addEx(p,f)}addEx(d,f){const p=this.getMatrix(f);if(d.top)for(let h=d.left;h<=d.right;h++)for(let y=d.top;y<=d.bottom;y++){const g={sheetName:d.sheetName,address:o.n2l(h)+y,row:y,col:h};p.addCellEx(g)}else p.addCellEx(d)}remove(d,f){const p=o.decodeEx(d);this.removeEx(p,f)}removeEx(d,f){this.getMatrix(f).removeCellEx(d)}removeAllNames(d){i.each(this.matrixMap,f=>{f.removeCellEx(d)})}forEach(d){i.each(this.matrixMap,(f,p)=>{f.forEach(h=>{d(p,h)})})}getNames(d){return this.getNamesEx(o.decodeEx(d))}getNamesEx(d){return i.map(this.matrixMap,(f,p)=>f.findCellEx(d)&&p).filter(Boolean)}_explore(d,f){f.mark=!1;const{sheetName:p}=f,h=new u(f.row,f.col,f.row,f.col,p);let y,g;function m(v,w){const _=d.findCellAt(p,v,f.col);return!(!_||!_.mark)&&(h[w]=v,_.mark=!1,!0)}for(g=f.row-1;m(g,"top");g--);for(g=f.row+1;m(g,"bottom");g++);function x(v,w){const _=[];for(g=h.top;g<=h.bottom;g++){const A=d.findCellAt(p,g,v);if(!A||!A.mark)return!1;_.push(A)}h[w]=v;for(let A=0;A<_.length;A++)_[A].mark=!1;return!0}for(y=f.col-1;x(y,"left");y--);for(y=f.col+1;x(y,"right");y++);return h}getRanges(d,f){return(f=f||this.matrixMap[d])?(f.forEach(p=>{p.mark=!0}),{name:d,ranges:f.map(p=>p.mark&&this._explore(f,p)).filter(Boolean).map(p=>p.$shortRange)}):{name:d,ranges:[]}}normaliseMatrix(d,f){d.forEachInSheet(f,(p,h,y)=>{p&&(p.row===h&&p.col===y||(p.row=h,p.col=y,p.address=o.n2l(y)+h))})}spliceRows(d,f,p,h){i.each(this.matrixMap,y=>{y.spliceRows(d,f,p,h),this.normaliseMatrix(y,d)})}spliceColumns(d,f,p,h){i.each(this.matrixMap,y=>{y.spliceColumns(d,f,p,h),this.normaliseMatrix(y,d)})}get model(){return i.map(this.matrixMap,(d,f)=>this.getRanges(f,d)).filter(d=>d.ranges.length)}set model(d){const f=this.matrixMap={};d.forEach(p=>{const h=f[p.name]=new c;p.ranges.forEach(y=>{l.test(y.split("!").pop()||"")&&h.addCell(y)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(t,n,a){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(t,n,a){const i=t("../utils/col-cache"),o=t("./anchor");n.exports=class{constructor(c,u){this.worksheet=c,this.model=u}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(c){let{type:u,imageId:l,range:d,hyperlinks:f}=c;if(this.type=u,this.imageId=l,u==="image")if(typeof d=="string"){const p=i.decode(d);this.range={tl:new o(this.worksheet,{col:p.left,row:p.top},-1),br:new o(this.worksheet,{col:p.right,row:p.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,d.tl,0),br:d.br&&new o(this.worksheet,d.br,0),ext:d.ext,editAs:d.editAs,hyperlinks:f||d.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(t,n,a){const i=t("../utils/under-dash");class o{constructor(u){this.note=u}get model(){let u=null;return typeof this.note==="string"?u={type:"note",note:{texts:[{text:this.note}]}}:u={type:"note",note:this.note},i.deepMerge({},o.DEFAULT_CONFIGS,u)}set model(u){const{note:l}=u,{texts:d}=l;d.length===1&&Object.keys(d[0]).length===1?this.note=d[0].text:this.note=l}static fromModel(u){const l=new o;return l.model=u,l}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=o},{"../utils/under-dash":26}],10:[function(t,n,a){const i=t("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(u,l,d,f,p){if(arguments.length<4){const h=i.decodeAddress(u),y=i.decodeAddress(l);this.model={top:Math.min(h.row,y.row),left:Math.min(h.col,y.col),bottom:Math.max(h.row,y.row),right:Math.max(h.col,y.col),sheetName:d},this.setTLBR(h.row,h.col,y.row,y.col,p)}else this.model={top:Math.min(u,d),left:Math.min(l,f),bottom:Math.max(u,d),right:Math.max(l,f),sheetName:p}}decode(u){switch(u.length){case 5:this.setTLBR(u[0],u[1],u[2],u[3],u[4]);break;case 4:this.setTLBR(u[0],u[1],u[2],u[3]);break;case 3:this.setTLBR(u[0],u[1],u[2]);break;case 2:this.setTLBR(u[0],u[1]);break;case 1:{const l=u[0];if(l instanceof o)this.model={top:l.model.top,left:l.model.left,bottom:l.model.bottom,right:l.model.right,sheetName:l.sheetName};else if(l instanceof Array)this.decode(l);else if(l.top&&l.left&&l.bottom&&l.right)this.model={top:l.top,left:l.left,bottom:l.bottom,right:l.right,sheetName:l.sheetName};else{const d=i.decodeEx(l);d.top?this.model={top:d.top,left:d.left,bottom:d.bottom,right:d.right,sheetName:d.sheetName}:this.model={top:d.row,left:d.col,bottom:d.row,right:d.col,sheetName:d.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+u.length)}}get top(){return this.model.top||1}set top(u){this.model.top=u}get left(){return this.model.left||1}set left(u){this.model.left=u}get bottom(){return this.model.bottom||1}set bottom(u){this.model.bottom=u}get right(){return this.model.right||1}set right(u){this.model.right=u}get sheetName(){return this.model.sheetName}set sheetName(u){this.model.sheetName=u}get _serialisedSheetName(){const{sheetName:u}=this.model;return u?/^[a-zA-Z0-9]*$/.test(u)?u+"!":`'${u}'!`:""}expand(u,l,d,f){(!this.model.top||u<this.top)&&(this.top=u),(!this.model.left||l<this.left)&&(this.left=l),(!this.model.bottom||d>this.bottom)&&(this.bottom=d),(!this.model.right||f>this.right)&&(this.right=f)}expandRow(u){if(u){const{dimensions:l,number:d}=u;l&&this.expand(d,l.min,d,l.max)}}expandToAddress(u){const l=i.decodeEx(u);this.expand(l.row,l.col,l.row,l.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&!(u.bottom<this.top)&&!(u.top>this.bottom)&&!(u.right<this.left)&&!(u.left>this.right)}contains(u){const l=i.decodeEx(u);return this.containsEx(l)}containsEx(u){return(!u.sheetName||!this.sheetName||u.sheetName===this.sheetName)&&u.row>=this.top&&u.row<=this.bottom&&u.col>=this.left&&u.col<=this.right}forEachAddress(u){for(let l=this.left;l<=this.right;l++)for(let d=this.top;d<=this.bottom;d++)u(i.encodeAddress(d,l),d,l)}}n.exports=o},{"../utils/col-cache":19}],11:[function(t,n,a){const i=t("../utils/under-dash"),o=t("./enums"),c=t("../utils/col-cache"),u=t("./cell");n.exports=class{constructor(l,d){this._worksheet=l,this._number=d,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(l){return this._cells[l-1]}getCellEx(l){let d=this._cells[l.col-1];if(!d){const f=this._worksheet.getColumn(l.col);d=new u(this,f,l.address),this._cells[l.col-1]=d}return d}getCell(l){if(typeof l=="string"){const d=this._worksheet.getColumnKey(l);l=d?d.number:c.l2n(l)}return this._cells[l-1]||this.getCellEx({address:c.encodeAddress(this._number,l),row:this._number,col:l})}splice(l,d){const f=l+d;for(var p=arguments.length,h=new Array(p>2?p-2:0),y=2;y<p;y++)h[y-2]=arguments[y];const g=h.length-d,m=this._cells.length;let x,v,w;if(g<0)for(x=l+h.length;x<=m;x++)w=this._cells[x-1],v=this._cells[x-g-1],v?(w=this.getCell(x),w.value=v.value,w.style=v.style,w._comment=v._comment):w&&(w.value=null,w.style={},w._comment=void 0);else if(g>0)for(x=m;x>=f;x--)v=this._cells[x-1],v?(w=this.getCell(x+g),w.value=v.value,w.style=v.style,w._comment=v._comment):this._cells[x+g-1]=void 0;for(x=0;x<h.length;x++)w=this.getCell(l+x),w.value=h[x],w.style={},w._comment=void 0}eachCell(l,d){if(d||(d=l,l=null),l&&l.includeEmpty){const f=this._cells.length;for(let p=1;p<=f;p++)d(this.getCell(p),p)}else this._cells.forEach((f,p)=>{f&&f.type!==o.ValueType.Null&&d(f,p+1)})}addPageBreak(l,d){const f=this._worksheet,p=Math.max(0,l-1)||0,h=Math.max(0,d-1)||16838,y={id:this._number,max:h,man:1};p&&(y.min=p),f.rowBreaks.push(y)}get values(){const l=[];return this._cells.forEach(d=>{d&&d.type!==o.ValueType.Null&&(l[d.col]=d.value)}),l}set values(l){if(this._cells=[],l)if(l instanceof Array){let d=0;l.hasOwnProperty("0")&&(d=1),l.forEach((f,p)=>{f!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,p+d),row:this._number,col:p+d}).value=f)})}else this._worksheet.eachColumnKey((d,f)=>{l[f]!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,d.number),row:this._number,col:d.number}).value=l[f])})}get hasValues(){return i.some(this._cells,l=>l&&l.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let l=0;return this.eachCell(()=>{l++}),l}get dimensions(){let l=0,d=0;return this._cells.forEach(f=>{f&&f.type!==o.ValueType.Null&&((!l||l>f.col)&&(l=f.col),d<f.col&&(d=f.col))}),l>0?{min:l,max:d}:null}_applyStyle(l,d){return this.style[l]=d,this._cells.forEach(f=>{f&&(f[l]=d)}),d}get numFmt(){return this.style.numFmt}set numFmt(l){this._applyStyle("numFmt",l)}get font(){return this.style.font}set font(l){this._applyStyle("font",l)}get alignment(){return this.style.alignment}set alignment(l){this._applyStyle("alignment",l)}get protection(){return this.style.protection}set protection(l){this._applyStyle("protection",l)}get border(){return this.style.border}set border(l){this._applyStyle("border",l)}get fill(){return this.style.fill}set fill(l){this._applyStyle("fill",l)}get hidden(){return!!this._hidden}set hidden(l){this._hidden=l}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(l){this._outlineLevel=l}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const l=[];let d=0,f=0;return this._cells.forEach(p=>{if(p){const h=p.model;h&&((!d||d>p.col)&&(d=p.col),f<p.col&&(f=p.col),l.push(h))}}),this.height||l.length?{cells:l,number:this.number,min:d,max:f,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(l){if(l.number!==this._number)throw new Error("Invalid row number in model");let d;this._cells=[],l.cells.forEach(f=>{switch(f.type){case u.Types.Merge:break;default:{let p;if(f.address)p=c.decodeAddress(f.address);else if(d){const{row:h}=d,y=d.col+1;p={row:h,col:y,address:c.encodeAddress(h,y),$col$row:`$${c.n2l(y)}$${h}`}}d=p,this.getCellEx(p).model=f;break}}}),l.height?this.height=l.height:delete this.height,this.hidden=l.hidden,this.outlineLevel=l.outlineLevel||0,this.style=l.style&&JSON.parse(JSON.stringify(l.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(t,n,a){const i=t("../utils/col-cache");class o{constructor(u,l,d){this.table=u,this.column=l,this.index=d}_set(u,l){this.table.cacheState(),this.column[u]=l}get name(){return this.column.name}set name(u){this._set("name",u)}get filterButton(){return this.column.filterButton}set filterButton(u){this.column.filterButton=u}get style(){return this.column.style}set style(u){this.column.style=u}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(u){this._set("totalsRowLabel",u)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(u){this._set("totalsRowFunction",u)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(u){this._set("totalsRowResult",u)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(u){this._set("totalsRowFormula",u)}}n.exports=class{constructor(c,u){this.worksheet=c,u&&(this.table=u,this.validate(),this.store())}getFormula(c){switch(c.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${c.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${c.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${c.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${c.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${c.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${c.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${c.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${c.name}])`;case"custom":return c.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+c.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:c}=this,u=(g,m,x)=>{g[m]===void 0&&(g[m]=x)};u(c,"headerRow",!0),u(c,"totalsRow",!1),u(c,"style",{}),u(c.style,"theme","TableStyleMedium2"),u(c.style,"showFirstColumn",!1),u(c.style,"showLastColumn",!1),u(c.style,"showRowStripes",!1),u(c.style,"showColumnStripes",!1);const l=(g,m)=>{if(!g)throw new Error(m)};l(c.ref,"Table must have ref"),l(c.columns,"Table must have column definitions"),l(c.rows,"Table must have row definitions"),c.tl=i.decodeAddress(c.ref);const{row:d,col:f}=c.tl;l(d>0,"Table must be on valid row"),l(f>0,"Table must be on valid col");const{width:p,filterHeight:h,tableHeight:y}=this;c.autoFilterRef=i.encode(d,f,d+h-1,f+p-1),c.tableRef=i.encode(d,f,d+y-1,f+p-1),c.columns.forEach((g,m)=>{l(g.name,`Column ${m} must have a name`),m===0?u(g,"totalsRowLabel","Total"):(u(g,"totalsRowFunction","none"),g.totalsRowFormula=this.getFormula(g))})}store(){const c=(h,y)=>{y&&Object.keys(y).forEach(g=>{h[g]=y[g]})},{worksheet:u,table:l}=this,{row:d,col:f}=l.tl;let p=0;if(l.headerRow){const h=u.getRow(d+p++);l.columns.forEach((y,g)=>{const{style:m,name:x}=y,v=h.getCell(f+g);v.value=x,c(v,m)})}if(l.rows.forEach(h=>{const y=u.getRow(d+p++);h.forEach((g,m)=>{const x=y.getCell(f+m);x.value=g,c(x,l.columns[m].style)})}),l.totalsRow){const h=u.getRow(d+p++);l.columns.forEach((y,g)=>{const m=h.getCell(f+g);if(g===0)m.value=y.totalsRowLabel;else{const x=this.getFormula(y);m.value=x?{formula:y.totalsRowFormula,result:y.totalsRowResult}:null}c(m,y.style)})}}load(c){const{table:u}=this,{row:l,col:d}=u.tl;let f=0;if(u.headerRow){const p=c.getRow(l+f++);u.columns.forEach((h,y)=>{p.getCell(d+y).value=h.name})}if(u.rows.forEach(p=>{const h=c.getRow(l+f++);p.forEach((y,g)=>{h.getCell(d+g).value=y})}),u.totalsRow){const p=c.getRow(l+f++);u.columns.forEach((h,y)=>{const g=p.getCell(d+y);y===0?g.value=h.totalsRowLabel:this.getFormula(h)&&(g.value={formula:h.totalsRowFormula,result:h.totalsRowResult})})}}get model(){return this.table}set model(c){this.table=c}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const c=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let u=0;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=0;d<this._cache.width;d++)l.getCell(c.col+d).value=null}else{for(let u=this.tableHeight;u<this._cache.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=0;d<this._cache.width;d++)l.getCell(c.col+d).value=null}for(let u=0;u<this.tableHeight;u++){const l=this.worksheet.getRow(c.row+u);for(let d=this.width;d<this._cache.width;d++)l.getCell(c.col+d).value=null}}this.store()}addRow(c,u){this.cacheState(),u===void 0?this.table.rows.push(c):this.table.rows.splice(u,0,c)}removeRows(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(c,u)}getColumn(c){const u=this.table.columns[c];return new o(this,u,c)}addColumn(c,u,l){this.cacheState(),l===void 0?(this.table.columns.push(c),this.table.rows.forEach((d,f)=>{d.push(u[f])})):(this.table.columns.splice(l,0,c),this.table.rows.forEach((d,f)=>{d.splice(l,0,u[f])}))}removeColumns(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(c,u),this.table.rows.forEach(l=>{l.splice(c,u)})}_assign(c,u,l){this.cacheState(),c[u]=l}get ref(){return this.table.ref}set ref(c){this._assign(this.table,"ref",c)}get name(){return this.table.name}set name(c){this.table.name=c}get displayName(){return this.table.displyName||this.table.name}set displayNamename(c){this.table.displayName=c}get headerRow(){return this.table.headerRow}set headerRow(c){this._assign(this.table,"headerRow",c)}get totalsRow(){return this.table.totalsRow}set totalsRow(c){this._assign(this.table,"totalsRow",c)}get theme(){return this.table.style.name}set theme(c){this.table.style.name=c}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(c){this.table.style.showFirstColumn=c}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(c){this.table.style.showLastColumn=c}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(c){this.table.style.showRowStripes=c}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(c){this.table.style.showColumnStripes=c}}},{"../utils/col-cache":19}],13:[function(t,n,a){const i=t("./worksheet"),o=t("./defined-names"),c=t("../xlsx/xlsx"),u=t("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new c(this)),this._xlsx}get csv(){return this._csv||(this._csv=new u(this)),this._csv}get nextId(){for(let l=1;l<this._worksheets.length;l++)if(!this._worksheets[l])return l;return this._worksheets.length||1}addWorksheet(l,d){const f=this.nextId;d&&(typeof d=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),d={properties:{tabColor:{argb:d}}}):(d.argb||d.theme||d.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),d={properties:{tabColor:d}}));const p=this._worksheets.reduce((g,m)=>(m&&m.orderNo)>g?m.orderNo:g,0),h=Object.assign({},d,{id:f,name:l,orderNo:p+1,workbook:this}),y=new i(h);return this._worksheets[f]=y,y}removeWorksheetEx(l){delete this._worksheets[l.id]}removeWorksheet(l){const d=this.getWorksheet(l);d&&d.destroy()}getWorksheet(l){return l===void 0?this._worksheets.find(Boolean):typeof l=="number"?this._worksheets[l]:typeof l=="string"?this._worksheets.find(d=>d&&d.name===l):void 0}get worksheets(){return this._worksheets.slice(1).sort((l,d)=>l.orderNo-d.orderNo).filter(Boolean)}eachSheet(l){this.worksheets.forEach(d=>{l(d,d.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(l){const d=this.media.length;return this.media.push(Object.assign({},l,{type:"image"})),d}getImage(l){return this.media[l]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(l=>l.model),sheets:this.worksheets.map(l=>l.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(l){this.creator=l.creator,this.lastModifiedBy=l.lastModifiedBy,this.lastPrinted=l.lastPrinted,this.created=l.created,this.modified=l.modified,this.company=l.company,this.manager=l.manager,this.title=l.title,this.subject=l.subject,this.keywords=l.keywords,this.category=l.category,this.description=l.description,this.language=l.language,this.revision=l.revision,this.contentStatus=l.contentStatus,this.properties=l.properties,this.calcProperties=l.calcProperties,this._worksheets=[],l.worksheets.forEach(d=>{const{id:f,name:p,state:h}=d,y=l.sheets&&l.sheets.findIndex(g=>g.id===f);(this._worksheets[f]=new i({id:f,name:p,orderNo:y,state:h,workbook:this})).model=d}),this._definedNames.model=l.definedNames,this.views=l.views,this._themes=l.themes,this.media=l.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(t,n,a){const i=t("../utils/under-dash"),o=t("../utils/col-cache"),c=t("./range"),u=t("./row"),l=t("./column"),d=t("./enums"),f=t("./image"),p=t("./table"),h=t("./data-validations"),y=t("../utils/encryptor"),{copyStyle:g}=t("../utils/copy-style");n.exports=class{constructor(m){m=m||{},this._workbook=m.workbook,this.id=m.id,this.orderNo=m.orderNo,this.name=m.name,this.state=m.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},m.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!m.pageSetup||!m.pageSetup.fitToWidth&&!m.pageSetup.fitToHeight||m.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},m.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},m.headerFooter),this.dataValidations=new h,this.views=m.views||[],this.autoFilter=m.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(m){if(m===void 0&&(m="sheet"+this.id),this._name!==m){if(typeof m!="string")throw new Error("The name has to be a string.");if(m==="")throw new Error("The name can't be empty.");if(m==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(m))throw new Error(`Worksheet name ${m} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(m))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+m);if(m&&m.length>31&&(console.warn(`Worksheet name ${m} exceeds 31 chars. This will be truncated`),m=m.substring(0,31)),this._workbook._worksheets.find(x=>x&&x.name.toLowerCase()===m.toLowerCase()))throw new Error("Worksheet name already exists: "+m);this._name=m}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const m=new c;return this._rows.forEach(x=>{if(x){const v=x.dimensions;v&&m.expand(x.number,v.min,x.number,v.max)}}),m}get columns(){return this._columns}set columns(m){this._headerRowCount=m.reduce((w,_)=>{const A=(_.header?1:_.headers&&_.headers.length)||0;return Math.max(w,A)},0);let x=1;const v=this._columns=[];m.forEach(w=>{const _=new l(this,x++,!1);v.push(_),_.defn=w})}getColumnKey(m){return this._keys[m]}setColumnKey(m,x){this._keys[m]=x}deleteColumnKey(m){delete this._keys[m]}eachColumnKey(m){i.each(this._keys,m)}getColumn(m){if(typeof m=="string"){const x=this._keys[m];if(x)return x;m=o.l2n(m)}if(this._columns||(this._columns=[]),m>this._columns.length){let x=this._columns.length+1;for(;x<=m;)this._columns.push(new l(this,x++))}return this._columns[m-1]}spliceColumns(m,x){const v=this._rows.length;for(var w=arguments.length,_=new Array(w>2?w-2:0),A=2;A<w;A++)_[A-2]=arguments[A];if(_.length>0)for(let I=0;I<v;I++){const U=[m,x];_.forEach(z=>{U.push(z[I]||null)});const H=this.getRow(I+1);H.splice.apply(H,U)}else this._rows.forEach(I=>{I&&I.splice(m,x)});const P=_.length-x,B=m+x,T=this._columns.length;if(P<0)for(let I=m+_.length;I<=T;I++)this.getColumn(I).defn=this.getColumn(I-P).defn;else if(P>0)for(let I=T;I>=B;I--)this.getColumn(I+P).defn=this.getColumn(I).defn;for(let I=m;I<m+_.length;I++)this.getColumn(I).defn=null;this.workbook.definedNames.spliceColumns(this.name,m,x,_.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let m=0;return this.eachRow(x=>{m=Math.max(m,x.cellCount)}),m}get actualColumnCount(){const m=[];let x=0;return this.eachRow(v=>{v.eachCell(w=>{let{col:_}=w;m[_]||(m[_]=!0,x++)})}),x}_commitRow(){}get _lastRowNumber(){const m=this._rows;let x=m.length;for(;x>0&&m[x-1]===void 0;)x--;return x}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(m){return this._rows[m-1]}findRows(m,x){return this._rows.slice(m-1,m-1+x)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let m=0;return this.eachRow(()=>{m++}),m}getRow(m){let x=this._rows[m-1];return x||(x=this._rows[m-1]=new u(this,m)),x}getRows(m,x){if(x<1)return;const v=[];for(let w=m;w<m+x;w++)v.push(this.getRow(w));return v}addRow(m){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const v=this._nextRow,w=this.getRow(v);return w.values=m,this._setStyleOption(v,x[0]==="i"?x:"n"),w}addRows(m){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const v=[];return m.forEach(w=>{v.push(this.addRow(w,x))}),v}insertRow(m,x){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(m,0,x),this._setStyleOption(m,v),this.getRow(m)}insertRows(m,x){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(m,0,...x),v!=="n")for(let w=0;w<x.length;w++)v[0]==="o"&&this.findRow(x.length+m+w)!==void 0?this._copyStyle(x.length+m+w,m+w,v[1]==="+"):v[0]==="i"&&this.findRow(m-1)!==void 0&&this._copyStyle(m-1,m+w,v[1]==="+");return this.getRows(m,x.length)}_setStyleOption(m){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";x[0]==="o"&&this.findRow(m+1)!==void 0?this._copyStyle(m+1,m,x[1]==="+"):x[0]==="i"&&this.findRow(m-1)!==void 0&&this._copyStyle(m-1,m,x[1]==="+")}_copyStyle(m,x){let v=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const w=this.getRow(m),_=this.getRow(x);_.style=g(w.style),w.eachCell({includeEmpty:v},(A,P)=>{_.getCell(P).style=g(A.style)}),_.height=w.height}duplicateRow(m,x){let v=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const w=this._rows[m-1],_=new Array(x).fill(w.values);this.spliceRows(m+1,v?0:x,..._);for(let A=0;A<x;A++){const P=this._rows[m+A];P.style=w.style,P.height=w.height,w.eachCell({includeEmpty:!0},(B,T)=>{P.getCell(T).style=B.style})}}spliceRows(m,x){const v=m+x;for(var w=arguments.length,_=new Array(w>2?w-2:0),A=2;A<w;A++)_[A-2]=arguments[A];const P=_.length,B=P-x,T=this._rows.length;let I,U;if(B<0)for(m===T&&(this._rows[T-1]=void 0),I=v;I<=T;I++)if(U=this._rows[I-1],U){const H=this.getRow(I+B);H.values=U.values,H.style=U.style,H.height=U.height,U.eachCell({includeEmpty:!0},(z,O)=>{H.getCell(O).style=z.style}),this._rows[I-1]=void 0}else this._rows[I+B-1]=void 0;else if(B>0)for(I=T;I>=v;I--)if(U=this._rows[I-1],U){const H=this.getRow(I+B);H.values=U.values,H.style=U.style,H.height=U.height,U.eachCell({includeEmpty:!0},(z,O)=>{if(H.getCell(O).style=z.style,z._value.constructor.name==="MergeValue"){const L=this.getRow(z._row._number+P).getCell(O),E=z._value._master,k=this.getRow(E._row._number+P).getCell(E._column._number);L.merge(k)}})}else this._rows[I+B-1]=void 0;for(I=0;I<P;I++){const H=this.getRow(m+I);H.style={},H.values=_[I]}this.workbook.definedNames.spliceRows(this.name,m,x,P)}eachRow(m,x){if(x||(x=m,m=void 0),m&&m.includeEmpty){const v=this._rows.length;for(let w=1;w<=v;w++)x(this.getRow(w),w)}else this._rows.forEach(v=>{v&&v.hasValues&&x(v,v.number)})}getSheetValues(){const m=[];return this._rows.forEach(x=>{x&&(m[x.number]=x.values)}),m}findCell(m,x){const v=o.getAddress(m,x),w=this._rows[v.row-1];return w?w.findCell(v.col):void 0}getCell(m,x){const v=o.getAddress(m,x);return this.getRow(v.row).getCellEx(v)}mergeCells(){for(var m=arguments.length,x=new Array(m),v=0;v<m;v++)x[v]=arguments[v];const w=new c(x);this._mergeCellsInternal(w)}mergeCellsWithoutStyle(){for(var m=arguments.length,x=new Array(m),v=0;v<m;v++)x[v]=arguments[v];const w=new c(x);this._mergeCellsInternal(w,!0)}_mergeCellsInternal(m,x){i.each(this._merges,w=>{if(w.intersects(m))throw new Error("Cannot merge already merged cells")});const v=this.getCell(m.top,m.left);for(let w=m.top;w<=m.bottom;w++)for(let _=m.left;_<=m.right;_++)(w>m.top||_>m.left)&&this.getCell(w,_).merge(v,x);this._merges[v.address]=m}_unMergeMaster(m){const x=this._merges[m.address];if(x){for(let v=x.top;v<=x.bottom;v++)for(let w=x.left;w<=x.right;w++)this.getCell(v,w).unmerge();delete this._merges[m.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(){for(var m=arguments.length,x=new Array(m),v=0;v<m;v++)x[v]=arguments[v];const w=new c(x);for(let _=w.top;_<=w.bottom;_++)for(let A=w.left;A<=w.right;A++){const P=this.findCell(_,A);P&&(P.type===d.ValueType.Merge?this._unMergeMaster(P.master):this._merges[P.address]&&this._unMergeMaster(P))}}fillFormula(m,x,v){let w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const _=o.decode(m),{top:A,left:P,bottom:B,right:T}=_,I=T-P+1,U=o.encodeAddress(A,P),H=w==="shared";let z;z=typeof v=="function"?v:Array.isArray(v)?Array.isArray(v[0])?(L,E)=>v[L-A][E-P]:(L,E)=>v[(L-A)*I+(E-P)]:()=>{};let O=!0;for(let L=A;L<=B;L++)for(let E=P;E<=T;E++)O?(this.getCell(L,E).value={shareType:w,formula:x,ref:m,result:z(L,E)},O=!1):this.getCell(L,E).value=H?{sharedFormula:U,result:z(L,E)}:z(L,E)}addImage(m,x){const v={type:"image",imageId:m,range:x};this._media.push(new f(this,v))}getImages(){return this._media.filter(m=>m.type==="image")}addBackgroundImage(m){const x={type:"background",imageId:m};this._media.push(new f(this,x))}getBackgroundImageId(){const m=this._media.find(x=>x.type==="background");return m&&m.imageId}protect(m,x){return new Promise(v=>{this.sheetProtection={sheet:!0},x&&"spinCount"in x&&(x.spinCount=Number.isFinite(x.spinCount)?Math.round(Math.max(0,x.spinCount)):1e5),m&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=y.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=x&&"spinCount"in x?x.spinCount:1e5,this.sheetProtection.hashValue=y.convertPasswordToHash(m,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),x&&(this.sheetProtection=Object.assign(this.sheetProtection,x),!m&&"spinCount"in x&&delete this.sheetProtection.spinCount),v()})}unprotect(){this.sheetProtection=null}addTable(m){const x=new p(this,m);return this.tables[m.name]=x,x}getTable(m){return this.tables[m]}removeTable(m){delete this.tables[m]}getTables(){return Object.values(this.tables)}addConditionalFormatting(m){this.conditionalFormattings.push(m)}removeConditionalFormatting(m){typeof m=="number"?this.conditionalFormattings.splice(m,1):this.conditionalFormattings=m instanceof Function?this.conditionalFormattings.filter(m):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(m){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=m}get model(){const m={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(w=>w.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(w=>w.model),conditionalFormattings:this.conditionalFormattings};m.cols=l.toModel(this.columns);const x=m.rows=[],v=m.dimensions=new c;return this._rows.forEach(w=>{const _=w&&w.model;_&&(v.expand(_.number,_.min,_.number,_.max),x.push(_))}),m.merges=[],i.each(this._merges,w=>{m.merges.push(w.range)}),m}_parseRows(m){this._rows=[],m.rows.forEach(x=>{const v=new u(this,x.number);this._rows[v.number-1]=v,v.model=x})}_parseMergeCells(m){i.each(m.mergeCells,x=>{this.mergeCellsWithoutStyle(x)})}set model(m){this.name=m.name,this._columns=l.fromModel(this,m.cols),this._parseRows(m),this._parseMergeCells(m),this.dataValidations=new h(m.dataValidations),this.properties=m.properties,this.pageSetup=m.pageSetup,this.headerFooter=m.headerFooter,this.views=m.views,this.autoFilter=m.autoFilter,this._media=m.media.map(x=>new f(this,x)),this.sheetProtection=m.sheetProtection,this.tables=m.tables.reduce((x,v)=>{const w=new p;return w.model=v,x[v.name]=w,x},{}),this.conditionalFormattings=m.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(t,n,a){t("core-js/modules/es.promise"),t("core-js/modules/es.promise.finally"),t("core-js/modules/es.object.assign"),t("core-js/modules/es.object.keys"),t("core-js/modules/es.object.values"),t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.async-iterator"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.includes"),t("core-js/modules/es.array.find-index"),t("core-js/modules/es.array.find"),t("core-js/modules/es.string.from-code-point"),t("core-js/modules/es.string.includes"),t("core-js/modules/es.number.is-nan"),t("regenerator-runtime/runtime");const i={Workbook:t("./doc/workbook")},o=t("./doc/enums");Object.keys(o).forEach(c=>{i[c]=o[c]}),n.exports=i},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(t,n,a){const i=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");a.bufferToString=function(o){return typeof o=="string"?o:i?i.decode(o):o.toString()}},{}],17:[function(t,n,a){const i=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:o}=t("buffer");a.stringToBuffer=function(c){return typeof c!="string"?c:i?o.from(i.encode(c).buffer):o.from(c)}},{buffer:220}],18:[function(t,n,a){const i=t("./under-dash"),o=t("./col-cache");n.exports=class{constructor(c){this.template=c,this.sheets={}}addCell(c){this.addCellEx(o.decodeEx(c))}getCell(c){return this.findCellEx(o.decodeEx(c),!0)}findCell(c){return this.findCellEx(o.decodeEx(c),!1)}findCellAt(c,u,l){const d=this.sheets[c],f=d&&d[u];return f&&f[l]}addCellEx(c){if(c.top)for(let u=c.top;u<=c.bottom;u++)for(let l=c.left;l<=c.right;l++)this.getCellAt(c.sheetName,u,l);else this.findCellEx(c,!0)}getCellEx(c){return this.findCellEx(c,!0)}findCellEx(c,u){const l=this.findSheet(c,u),d=this.findSheetRow(l,c,u);return this.findRowCell(d,c,u)}getCellAt(c,u,l){const d=this.sheets[c]||(this.sheets[c]=[]),f=d[u]||(d[u]=[]);return f[l]||(f[l]={sheetName:c,address:o.n2l(l)+u,row:u,col:l})}removeCellEx(c){const u=this.findSheet(c);if(!u)return;const l=this.findSheetRow(u,c);l&&delete l[c.col]}forEachInSheet(c,u){const l=this.sheets[c];l&&l.forEach((d,f)=>{d&&d.forEach((p,h)=>{p&&u(p,f,h)})})}forEach(c){i.each(this.sheets,(u,l)=>{this.forEachInSheet(l,c)})}map(c){const u=[];return this.forEach(l=>{u.push(c(l))}),u}findSheet(c,u){const l=c.sheetName;return this.sheets[l]?this.sheets[l]:u?this.sheets[l]=[]:void 0}findSheetRow(c,u,l){const{row:d}=u;return c&&c[d]?c[d]:l?c[d]=[]:void 0}findRowCell(c,u,l){const{col:d}=u;return c&&c[d]?c[d]:l?c[d]=this.template?Object.assign(u,JSON.parse(JSON.stringify(this.template))):u:void 0}spliceRows(c,u,l,d){const f=this.sheets[c];if(f){const p=[];for(let h=0;h<d;h++)p.push([]);f.splice(u,l,...p)}}spliceColumns(c,u,l,d){const f=this.sheets[c];if(f){const p=[];for(let h=0;h<d;h++)p.push(null);i.each(f,h=>{h.splice(u,l,...p)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(t,n,a){const i=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:c=>c<=26?1:c<=676?2:3,_fill(c){let u,l,d,f,p,h=1;if(c>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&c>=1){for(;h<=26;)u=this._dictionary[h-1],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=1}if(this._l2nFill<2&&c>=2){for(h=27;h<=702;)l=h-27,d=l%26,f=Math.floor(l/26),u=this._dictionary[f]+this._dictionary[d],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=2}if(this._l2nFill<3&&c>=3){for(h=703;h<=16384;)l=h-703,d=l%26,f=Math.floor(l/26)%26,p=Math.floor(l/676),u=this._dictionary[p]+this._dictionary[f]+this._dictionary[d],this._n2l[h]=u,this._l2n[u]=h,h++;this._l2nFill=3}},l2n(c){if(this._l2n[c]||this._fill(c.length),!this._l2n[c])throw new Error("Out of bounds. Invalid column letter: "+c);return this._l2n[c]},n2l(c){if(c<1||c>16384)throw new Error(c+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[c]||this._fill(this._level(c)),this._n2l[c]},_hash:{},validateAddress(c){if(!i.test(c))throw new Error("Invalid Address: "+c);return!0},decodeAddress(c){const u=c.length<5&&this._hash[c];if(u)return u;let l=!1,d="",f=0,p=!1,h="",y=0;for(let m,x=0;x<c.length;x++)if(m=c.charCodeAt(x),!p&&m>=65&&m<=90)l=!0,d+=c[x],f=26*f+m-64;else if(m>=48&&m<=57)p=!0,h+=c[x],y=10*y+m-48;else if(p&&l&&m!==36)break;if(l){if(f>16384)throw new Error("Out of bounds. Invalid column letter: "+d)}else f=void 0;p||(y=void 0);const g={address:c=d+h,col:f,row:y,$col$row:`$${d}$${h}`};return f<=100&&y<=100&&(this._hash[c]=g,this._hash[g.$col$row]=g),g},getAddress(c,u){if(u){const l=this.n2l(u)+c;return this.decodeAddress(l)}return this.decodeAddress(c)},decode(c){const u=c.split(":");if(u.length===2){const l=this.decodeAddress(u[0]),d=this.decodeAddress(u[1]),f={top:Math.min(l.row,d.row),left:Math.min(l.col,d.col),bottom:Math.max(l.row,d.row),right:Math.max(l.col,d.col)};return f.tl=this.n2l(f.left)+f.top,f.br=this.n2l(f.right)+f.bottom,f.dimensions=`${f.tl}:${f.br}`,f}return this.decodeAddress(c)},decodeEx(c){const u=c.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),l=u[1]||u[2],d=u[3],f=d.split(":");if(f.length>1){let h=this.decodeAddress(f[0]),y=this.decodeAddress(f[1]);const g=Math.min(h.row,y.row),m=Math.min(h.col,y.col),x=Math.max(h.row,y.row),v=Math.max(h.col,y.col);return h=this.n2l(m)+g,y=this.n2l(v)+x,{top:g,left:m,bottom:x,right:v,sheetName:l,tl:{address:h,col:m,row:g,$col$row:`$${this.n2l(m)}$${g}`,sheetName:l},br:{address:y,col:v,row:x,$col$row:`$${this.n2l(v)}$${x}`,sheetName:l},dimensions:`${h}:${y}`}}if(d.startsWith("#"))return l?{sheetName:l,error:d}:{error:d};const p=this.decodeAddress(d);return l?{sheetName:l,...p}:p},encodeAddress:(c,u)=>o.n2l(u)+c,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(c,u){const[l,d,,f,p]=c,[h,y]=u;return h>=l&&h<=f&&y>=d&&y<=p}};n.exports=o},{}],20:[function(t,n,a){const i=(c,u)=>({...c,...u.reduce((l,d)=>(c[d]&&(l[d]={...c[d]}),l),{})}),o=function(c,u,l){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];c[l]&&(u[l]=i(c[l],d))};a.copyStyle=c=>{if(!c)return c;if(u=c,Object.keys(u).length===0)return{};var u;const l={...c};return o(c,l,"font",["color"]),o(c,l,"alignment"),o(c,l,"protection"),c.border&&(o(c,l,"border"),o(c.border,l.border,"top",["color"]),o(c.border,l.border,"left",["color"]),o(c.border,l.border,"bottom",["color"]),o(c.border,l.border,"right",["color"]),o(c.border,l.border,"diagonal",["color"])),c.fill&&(o(c,l,"fill",["fgColor","bgColor","center"]),c.fill.stops&&(l.fill.stops=c.fill.stops.map(d=>i(d,["color"])))),l}},{}],21:[function(t,n,a){(function(i){(function(){const o=t("crypto"),c={hash(u){const l=o.createHash(u);for(var d=arguments.length,f=new Array(d>1?d-1:0),p=1;p<d;p++)f[p-1]=arguments[p];return l.update(i.concat(f)),l.digest()},convertPasswordToHash(u,l,d,f){if(l=l.toLowerCase(),o.getHashes().indexOf(l)<0)throw new Error(`Hash algorithm '${l}' not supported!`);const p=i.from(u,"utf16le");let h=this.hash(l,i.from(d,"base64"),p);for(let y=0;y<f;y++){const g=i.alloc(4);g.writeUInt32LE(y,0),h=this.hash(l,h,g)}return h.toString("base64")},randomBytes:u=>o.randomBytes(u)};n.exports=c}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(t,n,a){const{SaxesParser:i}=t("saxes"),{PassThrough:o}=t("readable-stream"),{bufferToString:c}=t("./browser-buffer-decode");n.exports=async function*(u){u.pipe&&!u[Symbol.asyncIterator]&&(u=u.pipe(new o));const l=new i;let d;l.on("error",p=>{d=p});let f=[];l.on("opentag",p=>f.push({eventType:"opentag",value:p})),l.on("text",p=>f.push({eventType:"text",value:p})),l.on("closetag",p=>f.push({eventType:"closetag",value:p}));for await(const p of u){if(l.write(c(p)),d)throw d;yield f,f=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(t,n,a){const i=t("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,c=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(u,l,d){const f=i.decode(l),p=i.decode(d);return u.replace(o,(h,y,g,m,x)=>{if(x)return h;const v=c.exec(m);if(v){const w=v[1],_=v[2].toUpperCase(),A=v[3],P=v[4];if(_.length>3||_.length===3&&_>"XFD")return h;let B=i.l2n(_),T=parseInt(P,10);return w||(B+=p.col-f.col),A||(T+=p.row-f.row),(y||"")+(w||"")+i.n2l(B)+(A||"")+T}return h})}}},{"./col-cache":19}],24:[function(t,n,a){(function(i,o){(function(){const c=t("readable-stream"),u=t("./utils"),l=t("./string-buf");class d{constructor(m,x){this._data=m,this._encoding=x}get length(){return this.toBuffer().length}copy(m,x,v,w){return this.toBuffer().copy(m,x,v,w)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class f{constructor(m){this._data=m}get length(){return this._data.length}copy(m,x,v,w){return this._data._buf.copy(m,x,v,w)}toBuffer(){return this._data.toBuffer()}}class p{constructor(m){this._data=m}get length(){return this._data.length}copy(m,x,v,w){this._data.copy(m,x,v,w)}toBuffer(){return this._data}}class h{constructor(m){this.size=m,this.buffer=o.alloc(m),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const m=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(m,0,this.iRead,this.iWrite),m}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(m){let x;return m===0?null:m===void 0||m>=this.length?(x=this.toBuffer(),this.iRead=this.iWrite,x):(x=o.alloc(m),this.buffer.copy(x,0,this.iRead,m),this.iRead+=m,x)}write(m,x,v){const w=Math.min(v,this.size-this.iWrite);return m.copy(this.buffer,this.iWrite,x,x+w),this.iWrite+=w,w}}const y=function(g){g=g||{},this.bufSize=g.bufSize||1048576,this.buffers=[],this.batch=g.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};u.inherits(y,c.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(g=>g.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const m=this.buffers[this.buffers.length-1];if(!m.full)return m}const g=new h(this.bufSize);return this.buffers.push(g),g},async _pipe(g){await Promise.all(this.pipes.map((function(m){return new Promise(x=>{m.write(g.toBuffer(),()=>{x()})})})))},_writeToBuffers(g){let m=0;const x=g.length;for(;m<x;)m+=this._getWritableBuffer().write(g,m,x-m)},async write(g,m,x){let v;if(m instanceof Function&&(x=m,m="utf8"),x=x||u.nop,g instanceof l)v=new f(g);else if(g instanceof o)v=new p(g);else{if(!(typeof g=="string"||g instanceof String||g instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");v=new d(g,m)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(v);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(v),i.nextTick(x)):(await this._pipe(v),x());else this.paused||this.emit("data",v.toBuffer()),this._writeToBuffers(v),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(g,m,x){const v=w=>{w?x(w):(this._flush(),this.pipes.forEach(_=>{_.end()}),this.emit("finish"))};g?this.write(g,m,v):v()},read(g){let m;if(g){for(m=[];g&&this.buffers.length&&!this.buffers[0].eod;){const x=this.buffers[0],v=x.read(g);g-=v.length,m.push(v),x.eod&&x.full&&this.buffers.shift()}return o.concat(m)}return m=this.buffers.map(x=>x.toBuffer()).filter(Boolean),this.buffers=[],o.concat(m)},setEncoding(g){this.encoding=g},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(g){this.pipes.push(g),!this.paused&&this.buffers.length&&this.end()},unpipe(g){this.pipes=this.pipes.filter(m=>m!==g)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=y}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(t,n,a){(function(i){(function(){n.exports=class{constructor(o){this._buf=i.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=i.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let c=2*this._buf.length;for(;c<o;)c*=2;const u=i.alloc(c);this._buf.copy(u,0),this._buf=u}addText(o){this._buffer=void 0;let c=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;c>=this._buf.length-4;)this._grow(this._inPos+o.length),c=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=c}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],26:[function(t,n,a){const{toString:i}=Object.prototype,o=/["&<>]/,c={each:function(u,l){u&&(Array.isArray(u)?u.forEach(l):Object.keys(u).forEach(d=>{l(u[d],d)}))},some:function(u,l){return!!u&&(Array.isArray(u)?u.some(l):Object.keys(u).some(d=>l(u[d],d)))},every:function(u,l){return!u||(Array.isArray(u)?u.every(l):Object.keys(u).every(d=>l(u[d],d)))},map:function(u,l){return u?Array.isArray(u)?u.map(l):Object.keys(u).map(d=>l(u[d],d)):[]},keyBy:(u,l)=>u.reduce((d,f)=>(d[f[l]]=f,d),{}),isEqual:function(u,l){const d=typeof u,f=typeof l,p=Array.isArray(u),h=Array.isArray(l);let y;if(d!==f)return!1;switch(typeof u){case"object":if(p||h)return!(!p||!h)&&u.length===l.length&&u.every((g,m)=>{const x=l[m];return c.isEqual(g,x)});if(u===null||l===null)return u===l;if(y=Object.keys(u),Object.keys(l).length!==y.length)return!1;for(const g of y)if(!l.hasOwnProperty(g))return!1;return c.every(u,(g,m)=>{const x=l[m];return c.isEqual(g,x)});default:return u===l}},escapeHtml(u){const l=o.exec(u);if(!l)return u;let d="",f="",p=0,h=l.index;for(;h<u.length;h++){switch(u.charAt(h)){case'"':f="&quot;";break;case"&":f="&amp;";break;case"'":f="&apos;";break;case"<":f="&lt;";break;case">":f="&gt;";break;default:continue}p!==h&&(d+=u.substring(p,h)),p=h+1,d+=f}return p!==h?d+u.substring(p,h):d},strcmp:(u,l)=>u<l?-1:u>l?1:0,isUndefined:u=>i.call(u)==="[object Undefined]",isObject:u=>i.call(u)==="[object Object]",deepMerge(){const u=arguments[0]||{},{length:l}=arguments;let d,f,p;function h(y,g){d=u[g],p=Array.isArray(y),c.isObject(y)||p?(p?(p=!1,f=d&&Array.isArray(d)?d:[]):f=d&&c.isObject(d)?d:{},u[g]=c.deepMerge(f,y)):c.isUndefined(y)||(u[g]=y)}for(let y=0;y<l;y++)c.each(arguments[y],h);return u}};n.exports=c},{}],27:[function(t,n,a){(function(i,o){(function(){const c=t("fs"),u=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,l={nop(){},promiseImmediate:d=>new Promise(f=>{i.setImmediate?o(()=>{f(d)}):setTimeout(()=>{f(d)},1)}),inherits:function(d,f,p,h){d.super_=f,h||(h=p,p=null),p&&Object.keys(p).forEach(g=>{Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(p,g))});const y={constructor:{value:d,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(g=>{y[g]=Object.getOwnPropertyDescriptor(h,g)}),d.prototype=Object.create(f.prototype,y)},dateToExcel:(d,f)=>25569+d.getTime()/864e5-(f?1462:0),excelToDate(d,f){const p=Math.round(24*(d-25569+(f?1462:0))*3600*1e3);return new Date(p)},parsePath(d){const f=d.lastIndexOf("/");return{path:d.substring(0,f),name:d.substring(f+1)}},getRelsPath(d){const f=l.parsePath(d);return`${f.path}/_rels/${f.name}.rels`},xmlEncode(d){const f=u.exec(d);if(!f)return d;let p="",h="",y=0,g=f.index;for(;g<d.length;g++){const m=d.charCodeAt(g);switch(m){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(m<=31&&(m<=8||m>=11&&m!==13)){h="";break}continue}y!==g&&(p+=d.substring(y,g)),y=g+1,h&&(p+=h)}return y!==g?p+d.substring(y,g):p},xmlDecode:d=>d.replace(/&([a-z]*);/g,f=>{switch(f){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return f}}),validInt(d){const f=parseInt(d,10);return Number.isNaN(f)?0:f},isDateFmt(d){return d?(d=(d=d.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:d=>new Promise(f=>{c.access(d,c.constants.F_OK,p=>{f(!p)})})},toIsoDateString:d=>d.toIsoString().subsstr(0,10),parseBoolean:d=>d===!0||d==="true"||d===1||d==="1"};n.exports=l}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{fs:216,timers:523}],28:[function(t,n,a){const i=t("./under-dash"),o=t("./utils");function c(d,f,p){d.push(` ${f}="${o.xmlEncode(p.toString())}"`)}function u(d,f){if(f){const p=[];i.each(f,(h,y)=>{h!==void 0&&c(p,y,h)}),d.push(p.join(""))}}class l{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(f){const p=this._xml;p.push("<?xml"),u(p,f),p.push(`?>
`)}openNode(f,p){const h=this.tos,y=this._xml;h&&this.open&&y.push(">"),this._stack.push(f),y.push("<"),y.push(f),u(y,p),this.leaf=!0,this.open=!0}addAttribute(f,p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");p!==void 0&&c(this._xml,f,p)}addAttributes(f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");u(this._xml,f)}writeText(f){const p=this._xml;this.open&&(p.push(">"),this.open=!1),this.leaf=!1,p.push(o.xmlEncode(f.toString()))}writeXml(f){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(f)}closeNode(){const f=this._stack.pop(),p=this._xml;this.leaf?p.push("/>"):(p.push("</"),p.push(f),p.push(">")),this.open=!1,this.leaf=!1}leafNode(f,p,h){this.openNode(f,p),h!==void 0&&this.writeText(h),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const f=this._rollbacks.pop();this._xml.length>f.xml&&this._xml.splice(f.xml,this._xml.length-f.xml),this._stack.length>f.stack&&this._stack.splice(f.stack,this._stack.length-f.stack),this.leaf=f.leaf,this.open=f.open}get xml(){return this.closeAll(),this._xml.join("")}}l.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=l},{"./under-dash":26,"./utils":27}],29:[function(t,n,a){(function(i){(function(){const o=t("events"),c=t("jszip"),u=t("./stream-buf"),{stringToBuffer:l}=t("./browser-buffer-encode");class d extends o.EventEmitter{constructor(p){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},p),this.zip=new c,this.stream=new u}append(p,h){h.hasOwnProperty("base64")&&h.base64?this.zip.file(h.name,p,{base64:!0}):(i.browser&&typeof p=="string"&&(p=l(p)),this.zip.file(h.name,p))}async finalize(){const p=await this.zip.generateAsync(this.options);this.stream.end(p),this.emit("finish")}read(p){return this.stream.read(p)}setEncoding(p){return this.stream.setEncoding(p)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(p,h){return this.stream.pipe(p,h)}unpipe(p){return this.stream.unpipe(p)}unshift(p){return this.stream.unshift(p)}wrap(p){return this.stream.wrap(p)}}n.exports={ZipWriter:d}}).call(this)}).call(this,t("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(t,n,a){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(t,n,a){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(t,n,a){const i=t("../../utils/parse-sax"),o=t("../../utils/xml-stream");class c{prepare(){}render(){}parseOpen(l){}parseText(l){}parseClose(l){}reconcile(l,d){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(l=>{l instanceof c?l.reset():l.xform&&l.xform.reset()})}mergeModel(l){this.model=Object.assign(this.model||{},l)}async parse(l){for await(const d of l)for(const{eventType:f,value:p}of d)if(f==="opentag")this.parseOpen(p);else if(f==="text")this.parseText(p);else if(f==="closetag"&&!this.parseClose(p.name))return this.model;return this.model}async parseStream(l){return this.parse(i(l))}get xml(){return this.toXml(this.model)}toXml(l){const d=new o;return this.render(d,l),d.xml}static toAttribute(l,d){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(f)return d}else if(f||l!==d)return l.toString()}static toStringAttribute(l,d){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,f)}static toStringValue(l,d){return l===void 0?d:l}static toBoolAttribute(l,d){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(f)return d}else if(f||l!==d)return l?"1":"0"}static toBoolValue(l,d){return l===void 0?d:l==="1"}static toIntAttribute(l,d){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,f)}static toIntValue(l,d){return l===void 0?d:parseInt(l,10)}static toFloatAttribute(l,d){let f=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,d,f)}static toFloatValue(l,d){return l===void 0?d:parseFloat(l)}}n.exports=c},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(t,n,a){const i=t("../base-xform"),o=t("../../../utils/col-cache");function c(l){try{return o.decodeEx(l),!0}catch{return!1}}function u(l){const d=[];let f=!1,p="";return l.split(",").forEach(h=>{if(!h)return;const y=(h.match(/'/g)||[]).length;if(!y)return void(f?p+=h+",":c(h)&&d.push(h));const g=y%2==0;!f&&g&&c(h)?d.push(h):f&&!g?(f=!1,c(p+h)&&d.push(p+h),p=""):(f=!0,p+=h+",")}),d}n.exports=class extends i{render(l,d){l.openNode("definedName",{name:d.name,localSheetId:d.localSheetId}),l.writeText(d.ranges.join(",")),l.closeNode()}parseOpen(l){return l.name==="definedName"?(this._parsedName=l.attributes.name,this._parsedLocalSheetId=l.attributes.localSheetId,this._parsedText=[],!0):!1}parseText(l){this._parsedText.push(l)}parseClose(){return this.model={name:this._parsedName,ranges:u(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(t,n,a){const i=t("../../../utils/utils"),o=t("../base-xform");n.exports=class extends o{render(c,u){c.leafNode("sheet",{sheetId:u.id,name:u.name,state:u.state,"r:id":u.rId})}parseOpen(c){return c.name==="sheet"&&(this.model={name:i.xmlDecode(c.attributes.name),id:parseInt(c.attributes.sheetId,10),state:c.attributes.state,rId:c.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:c.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){o.leafNode("workbookPr",{date1904:c.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){const u={xWindow:c.x||0,yWindow:c.y||0,windowWidth:c.width||12e3,windowHeight:c.height||24e3,firstSheet:c.firstSheet,activeTab:c.activeTab};c.visibility&&c.visibility!=="visible"&&(u.visibility=c.visibility),o.leafNode("workbookView",u)}parseOpen(o){if(o.name==="workbookView"){const c=this.model={},u=function(d,f,p){const h=f!==void 0?c[d]=f:p;h!==void 0&&(c[d]=h)},l=function(d,f,p){const h=f!==void 0?c[d]=parseInt(f,10):p;h!==void 0&&(c[d]=h)};return l("x",o.attributes.xWindow,0),l("y",o.attributes.yWindow,0),l("width",o.attributes.windowWidth,25e3),l("height",o.attributes.windowHeight,1e4),u("visibility",o.attributes.visibility,"visible"),l("activeTab",o.attributes.activeTab,void 0),l("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../../../utils/col-cache"),c=t("../../../utils/xml-stream"),u=t("../base-xform"),l=t("../static-xform"),d=t("../list-xform"),f=t("./defined-name-xform"),p=t("./sheet-xform"),h=t("./workbook-view-xform"),y=t("./workbook-properties-xform"),g=t("./workbook-calc-properties-xform");class m extends u{constructor(){super(),this.map={fileVersion:m.STATIC_XFORMS.fileVersion,workbookPr:new y,bookViews:new d({tag:"bookViews",count:!1,childXform:new h}),sheets:new d({tag:"sheets",count:!1,childXform:new p}),definedNames:new d({tag:"definedNames",count:!1,childXform:new f}),calcPr:new g}}prepare(v){v.sheets=v.worksheets;const w=[];let _=0;v.sheets.forEach(A=>{if(A.pageSetup&&A.pageSetup.printArea&&A.pageSetup.printArea.split("&&").forEach(P=>{const B=P.split(":"),T={name:"_xlnm.Print_Area",ranges:[`'${A.name}'!$${B[0]}:$${B[1]}`],localSheetId:_};w.push(T)}),A.pageSetup&&(A.pageSetup.printTitlesRow||A.pageSetup.printTitlesColumn)){const P=[];if(A.pageSetup.printTitlesColumn){const T=A.pageSetup.printTitlesColumn.split(":");P.push(`'${A.name}'!$${T[0]}:$${T[1]}`)}if(A.pageSetup.printTitlesRow){const T=A.pageSetup.printTitlesRow.split(":");P.push(`'${A.name}'!$${T[0]}:$${T[1]}`)}const B={name:"_xlnm.Print_Titles",ranges:P,localSheetId:_};w.push(B)}_++}),w.length&&(v.definedNames=v.definedNames.concat(w)),(v.media||[]).forEach((A,P)=>{A.name=A.type+(P+1)})}render(v,w){v.openXml(c.StdDocAttributes),v.openNode("workbook",m.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(v),this.map.workbookPr.render(v,w.properties),this.map.bookViews.render(v,w.views),this.map.sheets.render(v,w.sheets),this.map.definedNames.render(v,w.definedNames),this.map.calcPr.render(v,w.calcProperties),v.closeNode()}parseOpen(v){return this.parser?(this.parser.parseOpen(v),!0):(v.name==="workbook"||(this.parser=this.map[v.name],this.parser&&this.parser.parseOpen(v)),!0)}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){return this.parser?(this.parser.parseClose(v)||(this.parser=void 0),!0):v==="workbook"?(this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1):!0}reconcile(v){const w=(v.workbookRels||[]).reduce((T,I)=>(T[I.Id]=I,T),{}),_=[];let A,P=0;(v.sheets||[]).forEach(T=>{const I=w[T.rId];I&&(A=v.worksheetHash["xl/"+I.Target.replace(/^(\s|\/xl\/)+/,"")],A&&(A.name=T.name,A.id=T.id,A.state=T.state,_[P++]=A))});const B=[];i.each(v.definedNames,T=>{if(T.name==="_xlnm.Print_Area"){if(A=_[T.localSheetId],A){A.pageSetup||(A.pageSetup={});const I=o.decodeEx(T.ranges[0]);A.pageSetup.printArea=A.pageSetup.printArea?`${A.pageSetup.printArea}&&${I.dimensions}`:I.dimensions}}else if(T.name==="_xlnm.Print_Titles"){if(A=_[T.localSheetId],A){A.pageSetup||(A.pageSetup={});const I=T.ranges.join(","),U=/\$/g,H=/\$\d+:\$\d+/,z=I.match(H);if(z&&z.length){const E=z[0];A.pageSetup.printTitlesRow=E.replace(U,"")}const O=/\$[A-Z]+:\$[A-Z]+/,L=I.match(O);if(L&&L.length){const E=L[0];A.pageSetup.printTitlesColumn=E.replace(U,"")}}}else B.push(T)}),v.definedNames=B,v.media.forEach((T,I)=>{T.index=I})}}m.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},m.STATIC_XFORMS={fileVersion:new l({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=m},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(t,n,a){const i=t("../strings/rich-text-xform"),o=t("../../../utils/utils"),c=t("../base-xform"),u=n.exports=function(l){this.model=l};o.inherits(u,c,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(l,d){d=d||this.model,l.openNode("comment",{ref:d.ref,authorId:0}),l.openNode("text"),d&&d.note&&d.note.texts&&d.note.texts.forEach(f=>{this.richTextXform.render(l,f)}),l.closeNode(),l.closeNode()},parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"comment":return this.model={type:"note",note:{texts:[]},...l.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(l),!0;default:return!1}},parseText(l){this.parser&&this.parser.parseText(l)},parseClose(l){switch(l){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(l),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../../../utils/utils"),c=t("../base-xform"),u=t("./comment-xform"),l=n.exports=function(){this.map={comment:new u}};o.inherits(l,c,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(d,f){f=f||this.model,d.openXml(i.StdDocAttributes),d.openNode("comments",l.COMMENTS_ATTRIBUTES),d.openNode("authors"),d.leafNode("author",null,"Author"),d.closeNode(),d.openNode("commentList"),f.comments.forEach(p=>{this.map.comment.render(d,p)}),d.closeNode(),d.closeNode()},parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(d),!0;default:return!1}},parseText(d){this.parser&&this.parser.parseText(d)},parseClose(d){switch(d){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,c,u){(c===u[2]||this.tag==="x:SizeWithCells"&&c===u[1])&&o.leafNode(this.tag)}parseOpen(o){return o.name===this.tag?(this.model={},this.model[this.tag]=!0,!0):!1}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"x:Anchor"}getAnchorRect(o){const c=Math.floor(o.left),u=Math.floor(68*(o.left-c)),l=Math.floor(o.top),d=Math.floor(18*(o.top-l)),f=Math.floor(o.right),p=Math.floor(68*(o.right-f)),h=Math.floor(o.bottom);return[c,u,l,d,f,p,h,Math.floor(18*(o.bottom-h))]}getDefaultRect(o){const c=o.col,u=Math.max(o.row-2,0);return[c,6,u,14,c+2,2,u+4,16]}render(o,c){const u=c.anchor?this.getAnchorRect(c.anchor):this.getDefaultRect(c.refAddress);o.leafNode("x:Anchor",null,u.join(", "))}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(t,n,a){const i=t("../base-xform"),o=t("./vml-anchor-xform"),c=t("./style/vml-protection-xform"),u=t("./style/vml-position-xform"),l=["twoCells","oneCells","absolute"];n.exports=class extends i{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new c({tag:"x:Locked"}),"x:LockText":new c({tag:"x:LockText"}),"x:SizeWithCells":new u({tag:"x:SizeWithCells"}),"x:MoveWithCells":new u({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(d,f){const{protection:p,editAs:h}=f.note;d.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(d,h,l),this.map["x:SizeWithCells"].render(d,h,l),this.map["x:Anchor"].render(d,f),this.map["x:Locked"].render(d,p.locked),d.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(d,p.lockText),d.leafNode("x:Row",null,f.refAddress.row-1),d.leafNode("x:Column",null,f.refAddress.col-1),d.closeNode()}parseOpen(d){return d.name===this.tag?(this.reset(),this.model={anchor:[],protection:{},editAs:""}):(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)),!0}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d===this.tag?(this.normalizeModel(),!1):!0}normalizeModel(){const d=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),f=Object.keys(d).length;this.model.editAs=l[f],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("./vml-shape-xform");class u extends o{constructor(){super(),this.map={"v:shape":new c}}get tag(){return"xml"}render(d,f){d.openXml(i.StdDocAttributes),d.openNode(this.tag,u.DRAWING_ATTRIBUTES),d.openNode("o:shapelayout",{"v:ext":"edit"}),d.leafNode("o:idmap",{"v:ext":"edit",data:1}),d.closeNode(),d.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),d.leafNode("v:stroke",{joinstyle:"miter"}),d.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),d.closeNode(),f.comments.forEach((p,h)=>{this.map["v:shape"].render(d,p,h)}),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):(d.name===this.tag?(this.reset(),this.model={comments:[]}):(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0):d!==this.tag}reconcile(d,f){d.anchors.forEach(p=>{p.br?this.map["xdr:twoCellAnchor"].reconcile(p,f):this.map["xdr:oneCellAnchor"].reconcile(p,f)})}}u.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(t,n,a){const i=t("../base-xform"),o=t("./vml-textbox-xform"),c=t("./vml-client-data-xform");class u extends i{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new c}}get tag(){return"v:shape"}render(d,f,p){d.openNode("v:shape",u.V_SHAPE_ATTRIBUTES(f,p)),d.leafNode("v:fill",{color2:"infoBackground [80]"}),d.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),d.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(d,f),this.map["x:ClientData"].render(d,f),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):(d.name===this.tag?(this.reset(),this.model={margins:{insetmode:d.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}}):(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d===this.tag?(this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1):!0}}u.V_SHAPE_ATTRIBUTES=(l,d)=>({id:"_x0000_s"+(1025+d),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":l.note.margins&&l.note.margins.insetmode}),n.exports=u},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"v:textbox"}conversionUnit(o,c,u){return`${parseFloat(o)*c.toFixed(2)}${u}`}reverseConversionUnit(o){return(o||"").split(",").map(c=>Number(parseFloat(this.conversionUnit(parseFloat(c),.1,"")).toFixed(2)))}render(o,c){const u={style:"mso-direction-alt:auto"};if(c&&c.note){let{inset:l}=c.note&&c.note.margins;Array.isArray(l)&&(l=l.map(d=>this.conversionUnit(d,10,"mm")).join(",")),l&&(u.inset=l)}o.openNode("v:textbox",u),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={inset:this.reverseConversionUnit(o.attributes.inset)}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],48:[function(t,n,a){const i=t("./base-xform");n.exports=class extends i{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,c){this.model[o]=c.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,c.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:c.length,baseType:"lpstr"}),c.forEach(u=>{o.leafNode("vt:lpstr",void 0,u.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("../simple/string-xform"),u=t("./app-heading-pairs-xform"),l=t("./app-titles-of-parts-xform");class d extends o{constructor(){super(),this.map={Company:new c({tag:"Company"}),Manager:new c({tag:"Manager"}),HeadingPairs:new u,TitleOfParts:new l}}render(p,h){p.openXml(i.StdDocAttributes),p.openNode("Properties",d.PROPERTY_ATTRIBUTES),p.leafNode("Application",void 0,"Microsoft Excel"),p.leafNode("DocSecurity",void 0,"0"),p.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(p,h.worksheets),this.map.TitleOfParts.render(p,h.worksheets),this.map.Company.render(p,h.company||""),this.map.Manager.render(p,h.manager),p.leafNode("LinksUpToDate",void 0,"false"),p.leafNode("SharedDoc",void 0,"false"),p.leafNode("HyperlinksChanged",void 0,"false"),p.leafNode("AppVersion",void 0,"16.0300"),p.closeNode()}parseOpen(p){return this.parser?(this.parser.parseOpen(p),!0):p.name==="Properties"?!0:(this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0))}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return this.parser?(this.parser.parseClose(p)||(this.parser=void 0),!0):p==="Properties"?(this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1):!0}}d.DateFormat=function(f){return f.toISOString().replace(/[.]\d{3,6}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform");class c extends o{render(l,d){l.openXml(i.StdDocAttributes),l.openNode("Types",c.PROPERTY_ATTRIBUTES);const f={};(d.media||[]).forEach(p=>{if(p.type==="image"){const h=p.extension;f[h]||(f[h]=!0,l.leafNode("Default",{Extension:h,ContentType:"image/"+h}))}}),l.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),l.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),l.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),d.worksheets.forEach(p=>{const h=`/xl/worksheets/sheet${p.id}.xml`;l.leafNode("Override",{PartName:h,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),l.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),l.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),d.sharedStrings&&d.sharedStrings.count&&l.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),d.tables&&d.tables.forEach(p=>{l.leafNode("Override",{PartName:"/xl/tables/"+p.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),d.drawings&&d.drawings.forEach(p=>{l.leafNode("Override",{PartName:`/xl/drawings/${p.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),d.commentRefs&&(l.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),d.commentRefs.forEach(p=>{let{commentName:h}=p;l.leafNode("Override",{PartName:`/xl/${h}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),l.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),l.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),l.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("../simple/date-xform"),u=t("../simple/string-xform"),l=t("../simple/integer-xform");class d extends o{constructor(){super(),this.map={"dc:creator":new u({tag:"dc:creator"}),"dc:title":new u({tag:"dc:title"}),"dc:subject":new u({tag:"dc:subject"}),"dc:description":new u({tag:"dc:description"}),"dc:identifier":new u({tag:"dc:identifier"}),"dc:language":new u({tag:"dc:language"}),"cp:keywords":new u({tag:"cp:keywords"}),"cp:category":new u({tag:"cp:category"}),"cp:lastModifiedBy":new u({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new c({tag:"cp:lastPrinted",format:d.DateFormat}),"cp:revision":new l({tag:"cp:revision"}),"cp:version":new u({tag:"cp:version"}),"cp:contentStatus":new u({tag:"cp:contentStatus"}),"cp:contentType":new u({tag:"cp:contentType"}),"dcterms:created":new c({tag:"dcterms:created",attrs:d.DateAttrs,format:d.DateFormat}),"dcterms:modified":new c({tag:"dcterms:modified",attrs:d.DateAttrs,format:d.DateFormat})}}render(p,h){p.openXml(i.StdDocAttributes),p.openNode("cp:coreProperties",d.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(p,h.creator),this.map["dc:title"].render(p,h.title),this.map["dc:subject"].render(p,h.subject),this.map["dc:description"].render(p,h.description),this.map["dc:identifier"].render(p,h.identifier),this.map["dc:language"].render(p,h.language),this.map["cp:keywords"].render(p,h.keywords),this.map["cp:category"].render(p,h.category),this.map["cp:lastModifiedBy"].render(p,h.lastModifiedBy),this.map["cp:lastPrinted"].render(p,h.lastPrinted),this.map["cp:revision"].render(p,h.revision),this.map["cp:version"].render(p,h.version),this.map["cp:contentStatus"].render(p,h.contentStatus),this.map["cp:contentType"].render(p,h.contentType),this.map["dcterms:created"].render(p,h.created),this.map["dcterms:modified"].render(p,h.modified),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[p.name],this.parser)return this.parser.parseOpen(p),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(p))}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser)return this.parser.parseClose(p)||(this.parser=void 0),!0;switch(p){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+p)}}}d.DateFormat=function(f){return f.toISOString().replace(/[.]\d{3}/,"")},d.DateAttrs={"xsi:type":"dcterms:W3CDTF"},d.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{render(o,c){o.leafNode("Relationship",c)}parseOpen(o){return o.name==="Relationship"?(this.model=o.attributes,!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("./relationship-xform");class u extends o{constructor(){super(),this.map={Relationship:new c}}render(d,f){f=f||this._values,d.openXml(i.StdDocAttributes),d.openNode("Relationships",u.RELATIONSHIPS_ATTRIBUTES),f.forEach(p=>{this.map.Relationship.render(d,p)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[d.name],this.parser)return this.parser.parseOpen(d),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.push(this.parser.model),this.parser=void 0),!0;if(d==="Relationships")return!1;throw new Error("Unexpected xml node in parseClose: "+d)}}u.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):(o.name===this.tag?(this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}}):(this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)),!0)}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,c){if(o&&o.rId){const u=c.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(u){const l=u[1],d=c.mediaIndex[l];return c.media[d]}}}}},{"../base-xform":32}],57:[function(t,n,a){const i=t("../base-xform"),o=t("./blip-xform");n.exports=class extends i{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(c,u){c.openNode(this.tag),this.map["a:blip"].render(c,u),c.openNode("a:stretch"),c.leafNode("a:fillRect"),c.closeNode(),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):(c.name===this.tag?this.reset():(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0)}parseText(){}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model=this.map["a:blip"].model,!1):!0}}},{"../base-xform":32,"./blip-xform":58}],58:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"a:blip"}render(o,c){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":c.rId,cstate:"print"})}parseOpen(o){return o.name===this.tag&&(this.model={rId:o.attributes["r:embed"]}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],59:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],60:[function(t,n,a){const i=t("../base-xform"),o=t("./hlink-click-xform"),c=t("./ext-lst-xform");n.exports=class extends i{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new c}}get tag(){return"xdr:cNvPr"}render(u,l){u.openNode(this.tag,{id:l.index,name:"Picture "+l.index}),this.map["a:hlinkClick"].render(u,l),this.map["a:extLst"].render(u,l),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):(u.name===this.tag?this.reset():(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0)}parseText(){}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model=this.map["a:hlinkClick"].model,!1):!0}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(t,n,a){const i=t("../base-xform"),o=t("../simple/integer-xform");n.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(c,u){c.openNode(this.tag),this.map["xdr:col"].render(c,u.nativeCol),this.map["xdr:colOff"].render(c,u.nativeColOff),this.map["xdr:row"].render(c,u.nativeRow),this.map["xdr:rowOff"].render(c,u.nativeRowOff),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):(c.name===this.tag?this.reset():(this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1):!0}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(t,n,a){const i=t("../../../utils/col-cache"),o=t("../../../utils/xml-stream"),c=t("../base-xform"),u=t("./two-cell-anchor-xform"),l=t("./one-cell-anchor-xform");class d extends c{constructor(){super(),this.map={"xdr:twoCellAnchor":new u,"xdr:oneCellAnchor":new l}}prepare(p){p.anchors.forEach((h,y)=>{h.anchorType=(function(g){return(typeof g.range=="string"?i.decode(g.range):g.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"})(h),this.map[h.anchorType].prepare(h,{index:y})})}get tag(){return"xdr:wsDr"}render(p,h){p.openXml(o.StdDocAttributes),p.openNode(this.tag,d.DRAWING_ATTRIBUTES),h.anchors.forEach(y=>{this.map[y.anchorType].render(p,y)}),p.closeNode()}parseOpen(p){return this.parser?(this.parser.parseOpen(p),!0):(p.name===this.tag?(this.reset(),this.model={anchors:[]}):(this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p)),!0)}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return this.parser?(this.parser.parseClose(p)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0):p!==this.tag}reconcile(p,h){p.anchors.forEach(y=>{y.br?this.map["xdr:twoCellAnchor"].reconcile(y,h):this.map["xdr:oneCellAnchor"].reconcile(y,h)})}}d.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=d},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],64:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,c){o.openNode(this.tag);const u=Math.floor(9525*c.width),l=Math.floor(9525*c.height);o.addAttribute("cx",u),o.addAttribute("cy",l),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"a:hlinkClick"}render(o,c){c.hyperlinks&&c.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":c.hyperlinks.rId,tooltip:c.hyperlinks.tooltip})}parseOpen(o){return o.name===this.tag&&(this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}}),!0}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(t,n,a){const i=t("../base-xform"),o=t("./c-nv-pr-xform"),c=t("./c-nv-pic-pr-xform");n.exports=class extends i{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new c}}get tag(){return"xdr:nvPicPr"}render(u,l){u.openNode(this.tag),this.map["xdr:cNvPr"].render(u,l),this.map["xdr:cNvPicPr"].render(u,l),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):(u.name===this.tag?this.reset():(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0)}parseText(){}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model=this.map["xdr:cNvPr"].model,!1):!0}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(t,n,a){const i=t("./base-cell-anchor-xform"),o=t("../static-xform"),c=t("./cell-position-xform"),u=t("./ext-xform"),l=t("./pic-xform");n.exports=class extends i{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:ext":new u({tag:"xdr:ext"}),"xdr:pic":new l,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(d,f){this.map["xdr:pic"].prepare(d.picture,f)}render(d,f){d.openNode(this.tag,{editAs:f.range.editAs||"oneCell"}),this.map["xdr:from"].render(d,f.range.tl),this.map["xdr:ext"].render(d,f.range.ext),this.map["xdr:pic"].render(d,f.picture),this.map["xdr:clientData"].render(d,{}),d.closeNode()}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(d,f){d.medium=this.reconcilePicture(d.picture,f)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(t,n,a){const i=t("../base-xform"),o=t("../static-xform"),c=t("./blip-fill-xform"),u=t("./nv-pic-pr-xform"),l=t("./sp-pr");n.exports=class extends i{constructor(){super(),this.map={"xdr:nvPicPr":new u,"xdr:blipFill":new c,"xdr:spPr":new o(l)}}get tag(){return"xdr:pic"}prepare(d,f){d.index=f.index+1}render(d,f){d.openNode(this.tag),this.map["xdr:nvPicPr"].render(d,f),this.map["xdr:blipFill"].render(d,f),this.map["xdr:spPr"].render(d,f),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):(d.name===this.tag?this.reset():(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)),!0)}parseText(){}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.mergeModel(this.parser.model),this.parser=void 0),!0):d!==this.tag}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(t,n,a){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(t,n,a){const i=t("./base-cell-anchor-xform"),o=t("../static-xform"),c=t("./cell-position-xform"),u=t("./pic-xform");n.exports=class extends i{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:to":new c({tag:"xdr:to"}),"xdr:pic":new u,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(l,d){this.map["xdr:pic"].prepare(l.picture,d)}render(l,d){l.openNode(this.tag,{editAs:d.range.editAs||"oneCell"}),this.map["xdr:from"].render(l,d.range.tl),this.map["xdr:to"].render(l,d.range.br),this.map["xdr:pic"].render(l,d.picture),this.map["xdr:clientData"].render(l,{}),l.closeNode()}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(l,d){l.medium=this.reconcilePicture(l.picture,d)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(t,n,a){const i=t("./base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,c){const{childXform:u}=this;o&&o.forEach((l,d)=>{c.index=d,u.prepare(l,c)})}render(o,c){if(this.always||c&&c.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,c&&c.length||0);const{childXform:u}=this;(c||[]).forEach((l,d)=>{u.render(o,l,d)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag?(this.model=[],!0):!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,c){if(o){const{childXform:u}=this;o.forEach(l=>{u.reconcile(l,c)})}}}},{"./base-xform":32}],72:[function(t,n,a){const i=t("../../../utils/col-cache"),o=t("../base-xform");n.exports=class extends o{get tag(){return"autoFilter"}render(c,u){if(u)if(typeof u=="string")c.leafNode("autoFilter",{ref:u});else{const l=function(p){return typeof p=="string"?p:i.getAddress(p.row,p.column).address},d=l(u.from),f=l(u.to);d&&f&&c.leafNode("autoFilter",{ref:`${d}:${f}`})}}parseOpen(c){c.name==="autoFilter"&&(this.model=c.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(t,n,a){const i=t("../../../utils/utils"),o=t("../base-xform"),c=t("../../../doc/range"),u=t("../../../doc/enums"),l=t("../strings/rich-text-xform");function d(f){if(f==null)return u.ValueType.Null;if(f instanceof String||typeof f=="string")return u.ValueType.String;if(typeof f=="number")return u.ValueType.Number;if(typeof f=="boolean")return u.ValueType.Boolean;if(f instanceof Date)return u.ValueType.Date;if(f.text&&f.hyperlink)return u.ValueType.Hyperlink;if(f.formula)return u.ValueType.Formula;if(f.error)return u.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends o{constructor(){super(),this.richTextXForm=new l}get tag(){return"c"}prepare(f,p){const h=p.styles.addStyleModel(f.style||{},(function(y){return y.type===u.ValueType.Formula?d(y.result):y.type})(f));switch(h&&(f.styleId=h),f.comment&&p.comments.push({...f.comment,ref:f.address}),f.type){case u.ValueType.String:case u.ValueType.RichText:p.sharedStrings&&(f.ssId=p.sharedStrings.add(f.value));break;case u.ValueType.Date:p.date1904&&(f.date1904=!0);break;case u.ValueType.Hyperlink:p.sharedStrings&&f.text!==void 0&&f.text!==null&&(f.ssId=p.sharedStrings.add(f.text)),p.hyperlinks.push({address:f.address,target:f.hyperlink,tooltip:f.tooltip});break;case u.ValueType.Merge:p.merges.add(f);break;case u.ValueType.Formula:if(p.date1904&&(f.date1904=!0),f.shareType==="shared"&&(f.si=p.siFormulae++),f.formula)p.formulae[f.address]=f;else if(f.sharedFormula){const y=p.formulae[f.sharedFormula];if(!y)throw new Error("Shared Formula master must exist above and or left of clone for cell "+f.address);y.si===void 0?(y.shareType="shared",y.si=p.siFormulae++,y.range=new c(y.address,f.address)):y.range&&y.range.expandToAddress(f.address),f.si=y.si}}}renderFormula(f,p){let h=null;switch(p.shareType){case"shared":h={t:"shared",ref:p.ref||p.range.range,si:p.si};break;case"array":h={t:"array",ref:p.ref};break;default:p.si!==void 0&&(h={t:"shared",si:p.si})}switch(d(p.result)){case u.ValueType.Null:f.leafNode("f",h,p.formula);break;case u.ValueType.String:f.addAttribute("t","str"),f.leafNode("f",h,p.formula),f.leafNode("v",null,p.result);break;case u.ValueType.Number:f.leafNode("f",h,p.formula),f.leafNode("v",null,p.result);break;case u.ValueType.Boolean:f.addAttribute("t","b"),f.leafNode("f",h,p.formula),f.leafNode("v",null,p.result?1:0);break;case u.ValueType.Error:f.addAttribute("t","e"),f.leafNode("f",h,p.formula),f.leafNode("v",null,p.result.error);break;case u.ValueType.Date:f.leafNode("f",h,p.formula),f.leafNode("v",null,i.dateToExcel(p.result,p.date1904));break;default:throw new Error("I could not understand type of value")}}render(f,p){if(p.type!==u.ValueType.Null||p.styleId){switch(f.openNode("c"),f.addAttribute("r",p.address),p.styleId&&f.addAttribute("s",p.styleId),p.type){case u.ValueType.Null:break;case u.ValueType.Number:f.leafNode("v",null,p.value);break;case u.ValueType.Boolean:f.addAttribute("t","b"),f.leafNode("v",null,p.value?"1":"0");break;case u.ValueType.Error:f.addAttribute("t","e"),f.leafNode("v",null,p.value.error);break;case u.ValueType.String:case u.ValueType.RichText:p.ssId!==void 0?(f.addAttribute("t","s"),f.leafNode("v",null,p.ssId)):p.value&&p.value.richText?(f.addAttribute("t","inlineStr"),f.openNode("is"),p.value.richText.forEach(h=>{this.richTextXForm.render(f,h)}),f.closeNode("is")):(f.addAttribute("t","str"),f.leafNode("v",null,p.value));break;case u.ValueType.Date:f.leafNode("v",null,i.dateToExcel(p.value,p.date1904));break;case u.ValueType.Hyperlink:p.ssId!==void 0?(f.addAttribute("t","s"),f.leafNode("v",null,p.ssId)):(f.addAttribute("t","str"),f.leafNode("v",null,p.text));break;case u.ValueType.Formula:this.renderFormula(f,p);break;case u.ValueType.Merge:}f.closeNode()}}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"c":return this.model={address:f.attributes.r},this.t=f.attributes.t,f.attributes.s&&(this.model.styleId=parseInt(f.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=f.attributes.si,this.model.shareType=f.attributes.t,this.model.ref=f.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){if(this.parser)this.parser.parseText(f);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+f:f;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+f:f:this.model.value=this.model.value?this.model.value+f:f}}parseClose(f){switch(f){case"c":{const{model:p}=this;if(p.formula||p.shareType)p.type=u.ValueType.Formula,p.value&&(this.t==="str"?p.result=i.xmlDecode(p.value):this.t==="b"?p.result=parseInt(p.value,10)!==0:this.t==="e"?p.result={error:p.value}:p.result=parseFloat(p.value),p.value=void 0);else if(p.value!==void 0)switch(this.t){case"s":p.type=u.ValueType.String,p.value=parseInt(p.value,10);break;case"str":p.type=u.ValueType.String,p.value=i.xmlDecode(p.value);break;case"inlineStr":p.type=u.ValueType.String;break;case"b":p.type=u.ValueType.Boolean,p.value=parseInt(p.value,10)!==0;break;case"e":p.type=u.ValueType.Error,p.value={error:p.value};break;default:p.type=u.ValueType.Number,p.value=parseFloat(p.value)}else p.styleId?p.type=u.ValueType.Null:p.type=u.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(f),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(f),!0)}}reconcile(f,p){const h=f.styleId&&p.styles&&p.styles.getStyleModel(f.styleId);switch(h&&(f.style=h),f.styleId!==void 0&&(f.styleId=void 0),f.type){case u.ValueType.String:typeof f.value=="number"&&p.sharedStrings&&(f.value=p.sharedStrings.getString(f.value)),f.value.richText&&(f.type=u.ValueType.RichText);break;case u.ValueType.Number:h&&i.isDateFmt(h.numFmt)&&(f.type=u.ValueType.Date,f.value=i.excelToDate(f.value,p.date1904));break;case u.ValueType.Formula:f.result!==void 0&&h&&i.isDateFmt(h.numFmt)&&(f.result=i.excelToDate(f.result,p.date1904)),f.shareType==="shared"&&(f.ref?p.formulae[f.si]=f.address:(f.sharedFormula=p.formulae[f.si],delete f.shareType),delete f.si)}const y=p.hyperlinkMap[f.address];y&&(f.type===u.ValueType.Formula?(f.text=f.result,f.result=void 0):(f.text=f.value,f.value=void 0),f.type=u.ValueType.Hyperlink,f.hyperlink=y);const g=p.commentsMap&&p.commentsMap[f.address];g&&(f.comment=g)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{get tag(){return"x14:cfIcon"}render(o,c){o.leafNode(this.tag,{iconSet:c.iconSet,iconId:c.iconId})}parseOpen(o){let{attributes:c}=o;this.model={iconSet:c.iconSet,iconId:i.toIntValue(c.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(t,n,a){const{v4:i}=t("uuid"),o=t("../../base-xform"),c=t("../../composite-xform"),u=t("./databar-ext-xform"),l=t("./icon-set-ext-xform"),d={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class f extends c{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new u,"x14:iconSet":this.iconSetXform=new l}}get tag(){return"x14:cfRule"}static isExt(h){return h.type==="dataBar"?u.isExt(h):!(h.type!=="iconSet"||!h.custom&&!d[h.iconSet])}prepare(h){f.isExt(h)&&(h.x14Id=`{${i()}}`.toUpperCase())}render(h,y){if(f.isExt(y))switch(y.type){case"dataBar":this.renderDataBar(h,y);break;case"iconSet":this.renderIconSet(h,y)}}renderDataBar(h,y){h.openNode(this.tag,{type:"dataBar",id:y.x14Id}),this.databarXform.render(h,y),h.closeNode()}renderIconSet(h,y){h.openNode(this.tag,{type:"iconSet",priority:y.priority,id:y.x14Id||`{${i()}}`}),this.iconSetXform.render(h,y),h.closeNode()}createNewModel(h){let{attributes:y}=h;return{type:y.type,x14Id:y.id,priority:o.toIntValue(y.priority)}}onParserClose(h,y){Object.assign(this.model,y.model)}}n.exports=f},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(t,n,a){const i=t("../../composite-xform"),o=t("./f-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(c,u){c.openNode(this.tag,{type:u.type}),u.value!==void 0&&this.fExtXform.render(c,u.value),c.closeNode()}createNewModel(c){return{type:c.attributes.type}}onParserClose(c,u){c==="xm:f"&&(this.model.value=u.model?parseFloat(u.model):0)}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(t,n,a){const i=t("../../composite-xform"),o=t("./sqref-ext-xform"),c=t("./cf-rule-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new c}}get tag(){return"x14:conditionalFormatting"}prepare(u,l){u.rules.forEach(d=>{this.cfRule.prepare(d,l)})}render(u,l){l.rules.some(c.isExt)&&(u.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),l.rules.filter(c.isExt).forEach(d=>this.cfRule.render(u,d)),this.sqRef.render(u,l.ref),u.closeNode())}createNewModel(){return{rules:[]}}onParserClose(u,l){switch(u){case"xm:sqref":this.model.ref=l.model;break;case"x14:cfRule":this.model.rules.push(l.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(t,n,a){const i=t("../../composite-xform"),o=t("./cf-rule-ext-xform"),c=t("./conditional-formatting-ext-xform");n.exports=class extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new c}}get tag(){return"x14:conditionalFormattings"}hasContent(u){return u.hasExtContent===void 0&&(u.hasExtContent=u.some(l=>l.rules.some(o.isExt))),u.hasExtContent}prepare(u,l){u.forEach(d=>{this.cfXform.prepare(d,l)})}render(u,l){this.hasContent(l)&&(u.openNode(this.tag),l.forEach(d=>this.cfXform.render(u,d)),u.closeNode())}createNewModel(){return[]}onParserClose(u,l){this.model.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(t,n,a){const i=t("../../base-xform"),o=t("../../composite-xform"),c=t("../../style/color-xform"),u=t("./cfvo-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new u,"x14:borderColor":this.borderColorXform=new c("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new c("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new c("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new c("x14:axisColor")}}static isExt(l){return!l.gradient}get tag(){return"x14:dataBar"}render(l,d){l.openNode(this.tag,{minLength:i.toIntAttribute(d.minLength,0,!0),maxLength:i.toIntAttribute(d.maxLength,100,!0),border:i.toBoolAttribute(d.border,!1),gradient:i.toBoolAttribute(d.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(d.axisPosition,"auto"),direction:i.toAttribute(d.direction,"leftToRight")}),d.cfvo.forEach(f=>{this.cfvoXform.render(l,f)}),this.borderColorXform.render(l,d.borderColor),this.negativeBorderColorXform.render(l,d.negativeBorderColor),this.negativeFillColorXform.render(l,d.negativeFillColor),this.axisColorXform.render(l,d.axisColor),l.closeNode()}createNewModel(l){let{attributes:d}=l;return{cfvo:[],minLength:i.toIntValue(d.minLength,0),maxLength:i.toIntValue(d.maxLength,100),border:i.toBoolValue(d.border,!1),gradient:i.toBoolValue(d.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(d.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(d.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(d.axisPosition,"auto"),direction:i.toStringValue(d.direction,"leftToRight")}}onParserClose(l,d){const[,f]=l.split(":");f==="cfvo"?this.model.cfvo.push(d.model):this.model[f]=d.model}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{get tag(){return"xm:f"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(t,n,a){const i=t("../../base-xform"),o=t("../../composite-xform"),c=t("./cfvo-ext-xform"),u=t("./cf-icon-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:cfIcon":this.cfIconXform=new u}}get tag(){return"x14:iconSet"}render(l,d){l.openNode(this.tag,{iconSet:i.toStringAttribute(d.iconSet),reverse:i.toBoolAttribute(d.reverse,!1),showValue:i.toBoolAttribute(d.showValue,!0),custom:i.toBoolAttribute(d.icons,!1)}),d.cfvo.forEach(f=>{this.cfvoXform.render(l,f)}),d.icons&&d.icons.forEach((f,p)=>{f.iconId=p,this.cfIconXform.render(l,f)}),l.closeNode()}createNewModel(l){let{attributes:d}=l;return{cfvo:[],iconSet:i.toStringValue(d.iconSet,"3TrafficLights"),reverse:i.toBoolValue(d.reverse,!1),showValue:i.toBoolValue(d.showValue,!0)}}onParserClose(l,d){const[,f]=l.split(":");switch(f){case"cfvo":this.model.cfvo.push(d.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(d.model);break;default:this.model[f]=d.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{get tag(){return"xm:sqref"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(t,n,a){const i=t("../../base-xform"),o=t("../../composite-xform"),c=t("../../../../doc/range"),u=t("./databar-xform"),l=t("./ext-lst-ref-xform"),d=t("./formula-xform"),f=t("./color-scale-xform"),p=t("./icon-set-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},y=m=>{const{type:x,operator:v}=m;switch(x){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:x};default:return{type:x,operator:v}}};class g extends o{constructor(){super(),this.map={dataBar:this.databarXform=new u,extLst:this.extLstRefXform=new l,formula:this.formulaXform=new d,colorScale:this.colorScaleXform=new f,iconSet:this.iconSetXform=new p}}get tag(){return"cfRule"}static isPrimitive(x){return x.type!=="iconSet"||!x.custom&&!h[x.iconSet]}render(x,v){switch(v.type){case"expression":this.renderExpression(x,v);break;case"cellIs":this.renderCellIs(x,v);break;case"top10":this.renderTop10(x,v);break;case"aboveAverage":this.renderAboveAverage(x,v);break;case"dataBar":this.renderDataBar(x,v);break;case"colorScale":this.renderColorScale(x,v);break;case"iconSet":this.renderIconSet(x,v);break;case"containsText":this.renderText(x,v);break;case"timePeriod":this.renderTimePeriod(x,v)}}renderExpression(x,v){x.openNode(this.tag,{type:"expression",dxfId:v.dxfId,priority:v.priority}),this.formulaXform.render(x,v.formulae[0]),x.closeNode()}renderCellIs(x,v){x.openNode(this.tag,{type:"cellIs",dxfId:v.dxfId,priority:v.priority,operator:v.operator}),v.formulae.forEach(w=>{this.formulaXform.render(x,w)}),x.closeNode()}renderTop10(x,v){x.leafNode(this.tag,{type:"top10",dxfId:v.dxfId,priority:v.priority,percent:i.toBoolAttribute(v.percent,!1),bottom:i.toBoolAttribute(v.bottom,!1),rank:i.toIntValue(v.rank,10,!0)})}renderAboveAverage(x,v){x.leafNode(this.tag,{type:"aboveAverage",dxfId:v.dxfId,priority:v.priority,aboveAverage:i.toBoolAttribute(v.aboveAverage,!0)})}renderDataBar(x,v){x.openNode(this.tag,{type:"dataBar",priority:v.priority}),this.databarXform.render(x,v),this.extLstRefXform.render(x,v),x.closeNode()}renderColorScale(x,v){x.openNode(this.tag,{type:"colorScale",priority:v.priority}),this.colorScaleXform.render(x,v),x.closeNode()}renderIconSet(x,v){g.isPrimitive(v)&&(x.openNode(this.tag,{type:"iconSet",priority:v.priority}),this.iconSetXform.render(x,v),x.closeNode())}renderText(x,v){x.openNode(this.tag,{type:v.operator,dxfId:v.dxfId,priority:v.priority,operator:i.toStringAttribute(v.operator,"containsText")});const w=(_=>{if(_.formulae&&_.formulae[0])return _.formulae[0];const A=new c(_.ref),{tl:P}=A;switch(_.operator){case"containsText":return`NOT(ISERROR(SEARCH("${_.text}",${P})))`;case"containsBlanks":return`LEN(TRIM(${P}))=0`;case"notContainsBlanks":return`LEN(TRIM(${P}))>0`;case"containsErrors":return`ISERROR(${P})`;case"notContainsErrors":return`NOT(ISERROR(${P}))`;default:return}})(v);w&&this.formulaXform.render(x,w),x.closeNode()}renderTimePeriod(x,v){x.openNode(this.tag,{type:"timePeriod",dxfId:v.dxfId,priority:v.priority,timePeriod:v.timePeriod});const w=(_=>{if(_.formulae&&_.formulae[0])return _.formulae[0];const A=new c(_.ref),{tl:P}=A;switch(_.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${P},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${P},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${P},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${P},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${P},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${P},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${P},1)=TODAY()-1`;case"today":return`FLOOR(${P},1)=TODAY()`;case"tomorrow":return`FLOOR(${P},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${P},1)<=6,FLOOR(${P},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${P})=MONTH(EDATE(TODAY(),0-1)),YEAR(${P})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${P})=MONTH(TODAY()),YEAR(${P})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${P})=MONTH(EDATE(TODAY(),0+1)),YEAR(${P})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(v);w&&this.formulaXform.render(x,w),x.closeNode()}createNewModel(x){let{attributes:v}=x;return{...y(v),dxfId:i.toIntValue(v.dxfId),priority:i.toIntValue(v.priority),timePeriod:v.timePeriod,percent:i.toBoolValue(v.percent),bottom:i.toBoolValue(v.bottom),rank:i.toIntValue(v.rank),aboveAverage:i.toBoolValue(v.aboveAverage)}}onParserClose(x,v){switch(x){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,v.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(v.model)}}}n.exports=g},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{get tag(){return"cfvo"}render(o,c){o.leafNode(this.tag,{type:c.type,val:c.value})}parseOpen(o){this.model={type:o.attributes.type,value:i.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(t,n,a){const i=t("../../composite-xform"),o=t("../../style/color-xform"),c=t("./cfvo-xform");n.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new o}}get tag(){return"colorScale"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),l.color.forEach(d=>{this.colorXform.render(u,d)}),u.closeNode()}createNewModel(u){return{cfvo:[],color:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(t,n,a){const i=t("../../composite-xform"),o=t("./cf-rule-xform");n.exports=class extends i{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(c,u){u.rules.some(o.isPrimitive)&&(c.openNode(this.tag,{sqref:u.ref}),u.rules.forEach(l=>{o.isPrimitive(l)&&(l.ref=u.ref,this.map.cfRule.render(c,l))}),c.closeNode())}createNewModel(c){let{attributes:u}=c;return{ref:u.sqref,rules:[]}}onParserClose(c,u){this.model.rules.push(u.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(t,n,a){const i=t("../../base-xform"),o=t("./conditional-formatting-xform");n.exports=class extends i{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(c,u){let l=c.reduce((d,f)=>Math.max(d,...f.rules.map(p=>p.priority||0)),1);c.forEach(d=>{d.rules.forEach(f=>{f.priority||(f.priority=l++),f.style&&(f.dxfId=u.styles.addDxfStyle(f.style))})})}render(c,u){u.forEach(l=>{this.cfXform.render(c,l)})}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):c.name==="conditionalFormatting"?(this.parser=this.cfXform,this.parser.parseOpen(c),!0):!1}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return!!this.parser&&(!!this.parser.parseClose(c)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(c,u){c.forEach(l=>{l.rules.forEach(d=>{d.dxfId!==void 0&&(d.style=u.styles.getDxfStyle(d.dxfId),delete d.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(t,n,a){const i=t("../../composite-xform"),o=t("../../style/color-xform"),c=t("./cfvo-xform");n.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new o}}get tag(){return"dataBar"}render(u,l){u.openNode(this.tag),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),this.colorXform.render(u,l.color),u.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(u,l){switch(u){case"cfvo":this.model.cfvo.push(l.model);break;case"color":this.model.color=l.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(t,n,a){const i=t("../../base-xform"),o=t("../../composite-xform");class c extends i{get tag(){return"x14:id"}render(d,f){d.leafNode(this.tag,null,f)}parseOpen(){this.model=""}parseText(d){this.model+=d}parseClose(d){return d!==this.tag}}class u extends o{constructor(){super(),this.map={"x14:id":this.idXform=new c}}get tag(){return"ext"}render(d,f){d.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(d,f.x14Id),d.closeNode()}createNewModel(){return{}}onParserClose(d,f){this.model.x14Id=f.model}}n.exports=class extends o{constructor(){super(),this.map={ext:new u}}get tag(){return"extLst"}render(l,d){l.openNode(this.tag),this.map.ext.render(l,d),l.closeNode()}createNewModel(){return{}}onParserClose(l,d){Object.assign(this.model,d.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(t,n,a){const i=t("../../base-xform");n.exports=class extends i{get tag(){return"formula"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(t,n,a){const i=t("../../base-xform"),o=t("../../composite-xform"),c=t("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new c}}get tag(){return"iconSet"}render(u,l){u.openNode(this.tag,{iconSet:i.toStringAttribute(l.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(l.reverse,!1),showValue:i.toBoolAttribute(l.showValue,!0)}),l.cfvo.forEach(d=>{this.cfvoXform.render(u,d)}),u.closeNode()}createNewModel(u){let{attributes:l}=u;return{iconSet:i.toStringValue(l.iconSet,"3TrafficLights"),reverse:i.toBoolValue(l.reverse),showValue:i.toBoolValue(l.showValue),cfvo:[]}}onParserClose(u,l){this.model[u].push(l.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(t,n,a){const i=t("../../../utils/utils"),o=t("../base-xform");n.exports=class extends o{get tag(){return"col"}prepare(c,u){const l=u.styles.addStyleModel(c.style||{});l&&(c.styleId=l)}render(c,u){c.openNode("col"),c.addAttribute("min",u.min),c.addAttribute("max",u.max),u.width&&c.addAttribute("width",u.width),u.styleId&&c.addAttribute("style",u.styleId),u.hidden&&c.addAttribute("hidden","1"),u.bestFit&&c.addAttribute("bestFit","1"),u.outlineLevel&&c.addAttribute("outlineLevel",u.outlineLevel),u.collapsed&&c.addAttribute("collapsed","1"),c.addAttribute("customWidth","1"),c.closeNode()}parseOpen(c){if(c.name==="col"){const u=this.model={min:parseInt(c.attributes.min||"0",10),max:parseInt(c.attributes.max||"0",10),width:c.attributes.width===void 0?void 0:parseFloat(c.attributes.width||"0")};return c.attributes.style&&(u.styleId=parseInt(c.attributes.style,10)),i.parseBoolean(c.attributes.hidden)&&(u.hidden=!0),i.parseBoolean(c.attributes.bestFit)&&(u.bestFit=!0),c.attributes.outlineLevel&&(u.outlineLevel=parseInt(c.attributes.outlineLevel,10)),i.parseBoolean(c.attributes.collapsed)&&(u.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(c,u){c.styleId&&(c.style=u.styles.getStyleModel(c.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../../../utils/utils"),c=t("../../../utils/col-cache"),u=t("../base-xform"),l=t("../../../doc/range");function d(p,h,y,g){const m=h[y];m!==void 0?p[y]=m:g!==void 0&&(p[y]=g)}function f(p,h,y,g){const m=h[y];m!==void 0&&(p[y]=o.parseBoolean(m))}n.exports=class extends u{get tag(){return"dataValidations"}render(p,h){const y=(function(g){const m=i.map(g,(w,_)=>({address:_,dataValidation:w,marked:!1})).sort((w,_)=>i.strcmp(w.address,_.address)),x=i.keyBy(m,"address"),v=(w,_,A)=>{for(let P=0;P<_;P++){const B=c.encodeAddress(w.row+P,A);if(!g[B]||!i.isEqual(g[w.address],g[B]))return!1}return!0};return m.map(w=>{if(!w.marked){const _=c.decodeEx(w.address);if(_.dimensions)return x[_.dimensions].marked=!0,{...w.dataValidation,sqref:w.address};let A=1,P=c.encodeAddress(_.row+A,_.col);for(;g[P]&&i.isEqual(w.dataValidation,g[P]);)A++,P=c.encodeAddress(_.row+A,_.col);let B=1;for(;v(_,A,_.col+B);)B++;for(let T=0;T<A;T++)for(let I=0;I<B;I++)P=c.encodeAddress(_.row+T,_.col+I),x[P].marked=!0;if(A>1||B>1){const T=_.row+(A-1),I=_.col+(B-1);return{...w.dataValidation,sqref:`${w.address}:${c.encodeAddress(T,I)}`}}return{...w.dataValidation,sqref:w.address}}return null}).filter(Boolean)})(h);y.length&&(p.openNode("dataValidations",{count:y.length}),y.forEach(g=>{p.openNode("dataValidation"),g.type!=="any"&&(p.addAttribute("type",g.type),g.operator&&g.type!=="list"&&g.operator!=="between"&&p.addAttribute("operator",g.operator),g.allowBlank&&p.addAttribute("allowBlank","1")),g.showInputMessage&&p.addAttribute("showInputMessage","1"),g.promptTitle&&p.addAttribute("promptTitle",g.promptTitle),g.prompt&&p.addAttribute("prompt",g.prompt),g.showErrorMessage&&p.addAttribute("showErrorMessage","1"),g.errorStyle&&p.addAttribute("errorStyle",g.errorStyle),g.errorTitle&&p.addAttribute("errorTitle",g.errorTitle),g.error&&p.addAttribute("error",g.error),p.addAttribute("sqref",g.sqref),(g.formulae||[]).forEach((m,x)=>{p.openNode("formula"+(x+1)),g.type==="date"?p.writeText(o.dateToExcel(new Date(m))):p.writeText(m),p.closeNode()}),p.closeNode()}),p.closeNode())}parseOpen(p){switch(p.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=p.attributes.sqref;const h={type:p.attributes.type||"any",formulae:[]};switch(p.attributes.type&&f(h,p.attributes,"allowBlank"),f(h,p.attributes,"showInputMessage"),f(h,p.attributes,"showErrorMessage"),h.type){case"any":case"list":case"custom":break;default:d(h,p.attributes,"operator","between")}return d(h,p.attributes,"promptTitle"),d(h,p.attributes,"prompt"),d(h,p.attributes,"errorStyle"),d(h,p.attributes,"errorTitle"),d(h,p.attributes,"error"),this._dataValidation=h,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(p){this._formula&&this._formula.push(p)}parseClose(p){switch(p){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(h=>{h.includes(":")?new l(h).forEachAddress(y=>{this.model[y]=this._dataValidation}):this.model[h]=this._dataValidation}),!0;case"formula1":case"formula2":{let h=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":h=parseInt(h,10);break;case"decimal":h=parseFloat(h);break;case"date":h=o.excelToDate(parseFloat(h))}return this._dataValidation.formulae.push(h),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"dimension"}render(o,c){c&&o.leafNode("dimension",{ref:c})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"drawing"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(t,n,a){const i=t("../composite-xform"),o=t("./cf-ext/conditional-formattings-ext-xform");class c extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(l){return this.conditionalFormattings.hasContent(l.conditionalFormattings)}prepare(l,d){this.conditionalFormattings.prepare(l.conditionalFormattings,d)}render(l,d){l.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(l,d.conditionalFormattings),l.closeNode()}createNewModel(){return{}}onParserClose(l,d){this.model[l]=d.model}}n.exports=class extends i{constructor(){super(),this.map={ext:this.ext=new c}}get tag(){return"extLst"}prepare(u,l){this.ext.prepare(u,l)}hasContent(u){return this.ext.hasContent(u)}render(u,l){this.hasContent(l)&&(u.openNode("extLst"),this.ext.render(u,l),u.closeNode())}createNewModel(){return{}}onParserClose(u,l){Object.assign(this.model,l.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"headerFooter"}render(o,c){if(c){o.addRollback();let u=!1;o.openNode("headerFooter"),c.differentFirst&&(o.addAttribute("differentFirst","1"),u=!0),c.differentOddEven&&(o.addAttribute("differentOddEven","1"),u=!0),c.oddHeader&&typeof c.oddHeader=="string"&&(o.leafNode("oddHeader",null,c.oddHeader),u=!0),c.oddFooter&&typeof c.oddFooter=="string"&&(o.leafNode("oddFooter",null,c.oddFooter),u=!0),c.evenHeader&&typeof c.evenHeader=="string"&&(o.leafNode("evenHeader",null,c.evenHeader),u=!0),c.evenFooter&&typeof c.evenFooter=="string"&&(o.leafNode("evenFooter",null,c.evenFooter),u=!0),c.firstHeader&&typeof c.firstHeader=="string"&&(o.leafNode("firstHeader",null,c.firstHeader),u=!0),c.firstFooter&&typeof c.firstFooter=="string"&&(o.leafNode("firstFooter",null,c.firstFooter),u=!0),u?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"hyperlink"}render(o,c){this.isInternalLink(c)?o.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip,location:c.target}):o.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"mergeCell"}render(o,c){o.leafNode("mergeCell",{ref:c})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../../../doc/range"),c=t("../../../utils/col-cache"),u=t("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(l){if(this.merges[l.master])this.merges[l.master].expandToAddress(l.address);else{const d=`${l.master}:${l.address}`;this.merges[l.master]=new o(d)}}get mergeCells(){return i.map(this.merges,l=>l.range)}reconcile(l,d){i.each(l,f=>{const p=c.decode(f);for(let h=p.top;h<=p.bottom;h++){const y=d[h-1];for(let g=p.left;g<=p.right;g++){const m=y.cells[g-1];m?m.type===u.ValueType.Merge&&(m.master=p.tl):y.cells[g]={type:u.ValueType.Null,address:c.encodeAddress(h,g)}}}})}getMasterAddress(l){const d=this.hash[l];return d&&d.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(t,n,a){const i=t("../base-xform"),o=c=>c!==void 0;n.exports=class extends i{get tag(){return"outlinePr"}render(c,u){return!(!u||!o(u.summaryBelow)&&!o(u.summaryRight))&&(c.leafNode(this.tag,{summaryBelow:o(u.summaryBelow)?Number(u.summaryBelow):void 0,summaryRight:o(u.summaryRight)?Number(u.summaryRight):void 0}),!0)}parseOpen(c){return c.name===this.tag&&(this.model={summaryBelow:o(c.attributes.summaryBelow)?!!Number(c.attributes.summaryBelow):void 0,summaryRight:o(c.attributes.summaryRight)?!!Number(c.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"brk"}render(o,c){o.leafNode("brk",c)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../base-xform");n.exports=class extends o{get tag(){return"pageMargins"}render(c,u){if(u){const l={left:u.left,right:u.right,top:u.top,bottom:u.bottom,header:u.header,footer:u.footer};i.some(l,d=>d!==void 0)&&c.leafNode(this.tag,l)}}parseOpen(c){return c.name===this.tag?(this.model={left:parseFloat(c.attributes.left||.7),right:parseFloat(c.attributes.right||.7),top:parseFloat(c.attributes.top||.75),bottom:parseFloat(c.attributes.bottom||.75),header:parseFloat(c.attributes.header||.3),footer:parseFloat(c.attributes.footer||.3)},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"pageSetUpPr"}render(o,c){return!(!c||!c.fitToPage)&&(o.leafNode(this.tag,{fitToPage:c.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../base-xform");function c(f){return f?"1":void 0}function u(f){if(f==="overThenDown")return f}function l(f){switch(f){case"atEnd":case"asDisplyed":return f;default:return}}function d(f){switch(f){case"dash":case"blank":case"NA":return f;default:return}}n.exports=class extends o{get tag(){return"pageSetup"}render(f,p){if(p){const h={paperSize:p.paperSize,orientation:p.orientation,horizontalDpi:p.horizontalDpi,verticalDpi:p.verticalDpi,pageOrder:u(p.pageOrder),blackAndWhite:c(p.blackAndWhite),draft:c(p.draft),cellComments:l(p.cellComments),errors:d(p.errors),scale:p.scale,fitToWidth:p.fitToWidth,fitToHeight:p.fitToHeight,firstPageNumber:p.firstPageNumber,useFirstPageNumber:c(p.firstPageNumber),usePrinterDefaults:c(p.usePrinterDefaults),copies:p.copies};i.some(h,y=>y!==void 0)&&f.leafNode(this.tag,h)}}parseOpen(f){if(f.name===this.tag)return this.model={paperSize:(p=f.attributes.paperSize,p!==void 0?parseInt(p,10):void 0),orientation:f.attributes.orientation||"portrait",horizontalDpi:parseInt(f.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(f.attributes.verticalDpi||"4294967295",10),pageOrder:f.attributes.pageOrder||"downThenOver",blackAndWhite:f.attributes.blackAndWhite==="1",draft:f.attributes.draft==="1",cellComments:f.attributes.cellComments||"None",errors:f.attributes.errors||"displayed",scale:parseInt(f.attributes.scale||"100",10),fitToWidth:parseInt(f.attributes.fitToWidth||"1",10),fitToHeight:parseInt(f.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(f.attributes.firstPageNumber||"1",10),useFirstPageNumber:f.attributes.useFirstPageNumber==="1",usePrinterDefaults:f.attributes.usePrinterDefaults==="1",copies:parseInt(f.attributes.copies||"1",10)},!0;return!1;var p}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"picture"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../base-xform");function c(u){return u?"1":void 0}n.exports=class extends o{get tag(){return"printOptions"}render(u,l){if(l){const d={headings:c(l.showRowColHeaders),gridLines:c(l.showGridLines),horizontalCentered:c(l.horizontalCentered),verticalCentered:c(l.verticalCentered)};i.some(d,f=>f!==void 0)&&u.leafNode(this.tag,d)}}parseOpen(u){return u.name===this.tag?(this.model={showRowColHeaders:u.attributes.headings==="1",showGridLines:u.attributes.gridLines==="1",horizontalCentered:u.attributes.horizontalCentered==="1",verticalCentered:u.attributes.verticalCentered==="1"},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(t,n,a){const i=t("./page-breaks-xform"),o=t("../list-xform");n.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(c,u){if(u&&u.length){c.openNode(this.tag,this.$),this.count&&(c.addAttribute(this.$count,u.length),c.addAttribute("manualBreakCount",u.length));const{childXform:l}=this;u.forEach(d=>{l.render(c,d)}),c.closeNode()}else this.empty&&c.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(t,n,a){const i=t("../base-xform"),o=t("../../../utils/utils"),c=t("./cell-xform");n.exports=class extends i{constructor(u){super(),this.maxItems=u&&u.maxItems,this.map={c:new c}}get tag(){return"row"}prepare(u,l){const d=l.styles.addStyleModel(u.style);d&&(u.styleId=d);const f=this.map.c;u.cells.forEach(p=>{f.prepare(p,l)})}render(u,l,d){u.openNode("row"),u.addAttribute("r",l.number),l.height&&(u.addAttribute("ht",l.height),u.addAttribute("customHeight","1")),l.hidden&&u.addAttribute("hidden","1"),l.min>0&&l.max>0&&l.min<=l.max&&u.addAttribute("spans",`${l.min}:${l.max}`),l.styleId&&(u.addAttribute("s",l.styleId),u.addAttribute("customFormat","1")),u.addAttribute("x14ac:dyDescent","0.25"),l.outlineLevel&&u.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&u.addAttribute("collapsed","1");const f=this.map.c;l.cells.forEach(p=>{f.render(u,p,d)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;if(u.name==="row"){this.numRowsSeen+=1;const l=u.attributes.spans?u.attributes.spans.split(":").map(f=>parseInt(f,10)):[void 0,void 0],d=this.model={number:parseInt(u.attributes.r,10),min:l[0],max:l[1],cells:[]};return u.attributes.s&&(d.styleId=parseInt(u.attributes.s,10)),o.parseBoolean(u.attributes.hidden)&&(d.hidden=!0),o.parseBoolean(u.attributes.bestFit)&&(d.bestFit=!0),u.attributes.ht&&(d.height=parseFloat(u.attributes.ht)),u.attributes.outlineLevel&&(d.outlineLevel=parseInt(u.attributes.outlineLevel,10)),o.parseBoolean(u.attributes.collapsed)&&(d.collapsed=!0),!0}return this.parser=this.map[u.name],!!this.parser&&(this.parser.parseOpen(u),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(u,l){u.style=u.styleId?l.styles.getStyleModel(u.styleId):{},u.styleId!==void 0&&(u.styleId=void 0);const d=this.map.c;u.cells.forEach(f=>{d.reconcile(f,l)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../base-xform");n.exports=class extends o{get tag(){return"sheetFormatPr"}render(c,u){if(u){const l={defaultRowHeight:u.defaultRowHeight,outlineLevelRow:u.outlineLevelRow,outlineLevelCol:u.outlineLevelCol,"x14ac:dyDescent":u.dyDescent};u.defaultColWidth&&(l.defaultColWidth=u.defaultColWidth),u.defaultRowHeight&&u.defaultRowHeight===15||(l.customHeight="1"),i.some(l,d=>d!==void 0)&&c.leafNode("sheetFormatPr",l)}}parseOpen(c){return c.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(c.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(c.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(c.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(c.attributes.outlineLevelCol||"0",10)},c.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(c.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(t,n,a){const i=t("../base-xform"),o=t("../style/color-xform"),c=t("./page-setup-properties-xform"),u=t("./outline-properties-xform");n.exports=class extends i{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new c,outlinePr:new u}}get tag(){return"sheetPr"}render(l,d){if(d){l.addRollback(),l.openNode("sheetPr");let f=!1;f=this.map.tabColor.render(l,d.tabColor)||f,f=this.map.pageSetUpPr.render(l,d.pageSetup)||f,f=this.map.outlinePr.render(l,d.outlineProperties)||f,f?(l.closeNode(),l.commit()):l.rollback()}}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):l.name===this.tag?(this.reset(),!0):!!this.map[l.name]&&(this.parser=this.map[l.name],this.parser.parseOpen(l),!0)}parseText(l){return!!this.parser&&(this.parser.parseText(l),!0)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../base-xform");function c(l,d){return l?d:void 0}function u(l,d){return l===d||void 0}n.exports=class extends o{get tag(){return"sheetProtection"}render(l,d){if(d){const f={sheet:c(d.sheet,"1"),selectLockedCells:d.selectLockedCells===!1?"1":void 0,selectUnlockedCells:d.selectUnlockedCells===!1?"1":void 0,formatCells:c(d.formatCells,"0"),formatColumns:c(d.formatColumns,"0"),formatRows:c(d.formatRows,"0"),insertColumns:c(d.insertColumns,"0"),insertRows:c(d.insertRows,"0"),insertHyperlinks:c(d.insertHyperlinks,"0"),deleteColumns:c(d.deleteColumns,"0"),deleteRows:c(d.deleteRows,"0"),sort:c(d.sort,"0"),autoFilter:c(d.autoFilter,"0"),pivotTables:c(d.pivotTables,"0")};d.sheet&&(f.algorithmName=d.algorithmName,f.hashValue=d.hashValue,f.saltValue=d.saltValue,f.spinCount=d.spinCount,f.objects=c(d.objects===!1,"1"),f.scenarios=c(d.scenarios===!1,"1")),i.some(f,p=>p!==void 0)&&l.leafNode(this.tag,f)}}parseOpen(l){return l.name===this.tag?(this.model={sheet:u(l.attributes.sheet,"1"),objects:l.attributes.objects!=="1"&&void 0,scenarios:l.attributes.scenarios!=="1"&&void 0,selectLockedCells:l.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:l.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:u(l.attributes.formatCells,"0"),formatColumns:u(l.attributes.formatColumns,"0"),formatRows:u(l.attributes.formatRows,"0"),insertColumns:u(l.attributes.insertColumns,"0"),insertRows:u(l.attributes.insertRows,"0"),insertHyperlinks:u(l.attributes.insertHyperlinks,"0"),deleteColumns:u(l.attributes.deleteColumns,"0"),deleteRows:u(l.attributes.deleteRows,"0"),sort:u(l.attributes.sort,"0"),autoFilter:u(l.attributes.autoFilter,"0"),pivotTables:u(l.attributes.pivotTables,"0")},l.attributes.algorithmName&&(this.model.algorithmName=l.attributes.algorithmName,this.model.hashValue=l.attributes.hashValue,this.model.saltValue=l.attributes.saltValue,this.model.spinCount=parseInt(l.attributes.spinCount,10)),!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(t,n,a){const i=t("../../../utils/col-cache"),o=t("../base-xform"),c={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends o{get tag(){return"sheetView"}prepare(u){switch(u.state){case"frozen":case"split":break;default:u.state="normal"}}render(u,l){u.openNode("sheetView",{workbookViewId:l.workbookViewId||0});const d=function(g,m,x){x&&u.addAttribute(g,m)};let f,p,h,y;switch(d("rightToLeft","1",l.rightToLeft===!0),d("tabSelected","1",l.tabSelected),d("showRuler","0",l.showRuler===!1),d("showRowColHeaders","0",l.showRowColHeaders===!1),d("showGridLines","0",l.showGridLines===!1),d("zoomScale",l.zoomScale,l.zoomScale),d("zoomScaleNormal",l.zoomScaleNormal,l.zoomScaleNormal),d("view",l.style,l.style),l.state){case"frozen":p=l.xSplit||0,h=l.ySplit||0,f=l.topLeftCell||i.getAddress(h+1,p+1).address,y=(l.xSplit&&l.ySplit?"bottomRight":l.xSplit&&"topRight")||"bottomLeft",u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:f,activePane:y,state:"frozen"}),u.leafNode("selection",{pane:y,activeCell:l.activeCell,sqref:l.activeCell});break;case"split":l.activePane==="topLeft"&&(l.activePane=void 0),u.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:l.topLeftCell,activePane:l.activePane}),u.leafNode("selection",{pane:l.activePane,activeCell:l.activeCell,sqref:l.activeCell});break;case"normal":l.activeCell&&u.leafNode("selection",{activeCell:l.activeCell,sqref:l.activeCell})}u.closeNode()}parseOpen(u){switch(u.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(u.attributes.workbookViewId,10),rightToLeft:u.attributes.rightToLeft==="1",tabSelected:u.attributes.tabSelected==="1",showRuler:u.attributes.showRuler!=="0",showRowColHeaders:u.attributes.showRowColHeaders!=="0",showGridLines:u.attributes.showGridLines!=="0",zoomScale:parseInt(u.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(u.attributes.zoomScaleNormal||"100",10),style:u.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(u.attributes.xSplit||"0",10),ySplit:parseInt(u.attributes.ySplit||"0",10),topLeftCell:u.attributes.topLeftCell,activePane:u.attributes.activePane||"topLeft",state:u.attributes.state},!0;case"selection":{const l=u.attributes.pane||"topLeft";return this.selections[l]={pane:l,activeCell:u.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(u){let l,d;return u==="sheetView"?(this.sheetView&&this.pane?(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:c[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(l.activePane=this.pane.activePane),d=this.selections[this.pane.activePane],d&&d.activeCell&&(l.activeCell=d.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)):(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},d=this.selections.topLeft,d&&d.activeCell&&(l.activeCell=d.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)),!1):!0}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"tablePart"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../../../utils/col-cache"),c=t("../../../utils/xml-stream"),u=t("../../rel-type"),l=t("./merges"),d=t("../base-xform"),f=t("../list-xform"),p=t("./row-xform"),h=t("./col-xform"),y=t("./dimension-xform"),g=t("./hyperlink-xform"),m=t("./merge-cell-xform"),x=t("./data-validations-xform"),v=t("./sheet-properties-xform"),w=t("./sheet-format-properties-xform"),_=t("./sheet-view-xform"),A=t("./sheet-protection-xform"),P=t("./page-margins-xform"),B=t("./page-setup-xform"),T=t("./print-options-xform"),I=t("./auto-filter-xform"),U=t("./picture-xform"),H=t("./drawing-xform"),z=t("./table-part-xform"),O=t("./row-breaks-xform"),L=t("./header-footer-xform"),E=t("./cf/conditional-formattings-xform"),k=t("./ext-lst-xform"),N=(C,D)=>{if(!D||!D.length)return C;if(!C||!C.length)return D;const q={},M={};return C.forEach(G=>{q[G.ref]=G,G.rules.forEach(X=>{const{x14Id:re}=X;re&&(M[re]=X)})}),D.forEach(G=>{G.rules.forEach(X=>{const re=M[X.x14Id];re?((V,J)=>{Object.keys(J).forEach(W=>{const F=V[W],Q=J[W];F===void 0&&Q!==void 0&&(V[W]=Q)})})(re,X):q[G.ref]?q[G.ref].rules.push(X):C.push({ref:G.ref,rules:[X]})})}),C};class S extends d{constructor(D){super();const{maxRows:q,maxCols:M,ignoreNodes:G}=D||{};this.ignoreNodes=G||[],this.map={sheetPr:new v,dimension:new y,sheetViews:new f({tag:"sheetViews",count:!1,childXform:new _}),sheetFormatPr:new w,cols:new f({tag:"cols",count:!1,childXform:new h}),sheetData:new f({tag:"sheetData",count:!1,empty:!0,childXform:new p({maxItems:M}),maxItems:q}),autoFilter:new I,mergeCells:new f({tag:"mergeCells",count:!0,childXform:new m}),rowBreaks:new O,hyperlinks:new f({tag:"hyperlinks",count:!1,childXform:new g}),pageMargins:new P,dataValidations:new x,pageSetup:new B,headerFooter:new L,printOptions:new T,picture:new U,drawing:new H,sheetProtection:new A,tableParts:new f({tag:"tableParts",count:!0,childXform:new z}),conditionalFormatting:new E,extLst:new k}}prepare(D,q){q.merges=new l,D.hyperlinks=q.hyperlinks=[],D.comments=q.comments=[],q.formulae={},q.siFormulae=0,this.map.cols.prepare(D.cols,q),this.map.sheetData.prepare(D.rows,q),this.map.conditionalFormatting.prepare(D.conditionalFormattings,q),D.mergeCells=q.merges.mergeCells;const M=D.rels=[];function G(V){return"rId"+(V.length+1)}if(D.hyperlinks.forEach(V=>{const J=G(M);V.rId=J,M.push({Id:J,Type:u.Hyperlink,Target:V.target,TargetMode:"External"})}),D.comments.length>0){const V={Id:G(M),Type:u.Comments,Target:`../comments${D.id}.xml`};M.push(V);const J={Id:G(M),Type:u.VmlDrawing,Target:`../drawings/vmlDrawing${D.id}.vml`};M.push(J),D.comments.forEach(W=>{W.refAddress=o.decodeAddress(W.ref)}),q.commentRefs.push({commentName:"comments"+D.id,vmlDrawing:"vmlDrawing"+D.id})}const X=[];let re;D.media.forEach(V=>{if(V.type==="background"){const J=G(M);re=q.media[V.imageId],M.push({Id:J,Type:u.Image,Target:`../media/${re.name}.${re.extension}`}),D.background={rId:J},D.image=q.media[V.imageId]}else if(V.type==="image"){let{drawing:J}=D;re=q.media[V.imageId],J||(J=D.drawing={rId:G(M),name:"drawing"+ ++q.drawingsCount,anchors:[],rels:[]},q.drawings.push(J),M.push({Id:J.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${J.name}.xml`}));let W=this.preImageId===V.imageId?X[V.imageId]:X[J.rels.length];W||(W=G(J.rels),X[J.rels.length]=W,J.rels.push({Id:W,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const F={picture:{rId:W},range:V.range};if(V.hyperlinks&&V.hyperlinks.hyperlink){const Q=G(J.rels);X[J.rels.length]=Q,F.picture.hyperlinks={tooltip:V.hyperlinks.tooltip,rId:Q},J.rels.push({Id:Q,Type:u.Hyperlink,Target:V.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=V.imageId,J.anchors.push(F)}}),D.tables.forEach(V=>{const J=G(M);V.rId=J,M.push({Id:J,Type:u.Table,Target:"../tables/"+V.target}),V.columns.forEach(W=>{const{style:F}=W;F&&(W.dxfId=q.styles.addDxfStyle(F))})}),this.map.extLst.prepare(D,q)}render(D,q){D.openXml(c.StdDocAttributes),D.openNode("worksheet",S.WORKSHEET_ATTRIBUTES);const M=q.properties?{defaultRowHeight:q.properties.defaultRowHeight,dyDescent:q.properties.dyDescent,outlineLevelCol:q.properties.outlineLevelCol,outlineLevelRow:q.properties.outlineLevelRow}:void 0;q.properties&&q.properties.defaultColWidth&&(M.defaultColWidth=q.properties.defaultColWidth);const G={outlineProperties:q.properties&&q.properties.outlineProperties,tabColor:q.properties&&q.properties.tabColor,pageSetup:q.pageSetup&&q.pageSetup.fitToPage?{fitToPage:q.pageSetup.fitToPage}:void 0},X=q.pageSetup&&q.pageSetup.margins,re={showRowColHeaders:q.pageSetup&&q.pageSetup.showRowColHeaders,showGridLines:q.pageSetup&&q.pageSetup.showGridLines,horizontalCentered:q.pageSetup&&q.pageSetup.horizontalCentered,verticalCentered:q.pageSetup&&q.pageSetup.verticalCentered},V=q.sheetProtection;this.map.sheetPr.render(D,G),this.map.dimension.render(D,q.dimensions),this.map.sheetViews.render(D,q.views),this.map.sheetFormatPr.render(D,M),this.map.cols.render(D,q.cols),this.map.sheetData.render(D,q.rows),this.map.sheetProtection.render(D,V),this.map.autoFilter.render(D,q.autoFilter),this.map.mergeCells.render(D,q.mergeCells),this.map.conditionalFormatting.render(D,q.conditionalFormattings),this.map.dataValidations.render(D,q.dataValidations),this.map.hyperlinks.render(D,q.hyperlinks),this.map.printOptions.render(D,re),this.map.pageMargins.render(D,X),this.map.pageSetup.render(D,q.pageSetup),this.map.headerFooter.render(D,q.headerFooter),this.map.rowBreaks.render(D,q.rowBreaks),this.map.drawing.render(D,q.drawing),this.map.picture.render(D,q.background),this.map.tableParts.render(D,q.tables),this.map.extLst.render(D,q),q.rels&&q.rels.forEach(J=>{J.Type===u.VmlDrawing&&D.leafNode("legacyDrawing",{"r:id":J.Id})}),D.closeNode()}parseOpen(D){return this.parser?(this.parser.parseOpen(D),!0):D.name==="worksheet"?(i.each(this.map,q=>{q.reset()}),!0):(this.map[D.name]&&!this.ignoreNodes.includes(D.name)&&(this.parser=this.map[D.name],this.parser.parseOpen(D)),!0)}parseText(D){this.parser&&this.parser.parseText(D)}parseClose(D){if(this.parser)return this.parser.parseClose(D)||(this.parser=void 0),!0;if(D==="worksheet"){const q=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(q.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(q.outlineProperties=this.map.sheetPr.model.outlineProperties);const M={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},G=Object.assign(M,this.map.pageSetup.model,this.map.printOptions.model),X=N(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:q,views:this.map.sheetViews.model,pageSetup:G,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:X},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}else return!0}reconcile(D,q){const M=(D.relationships||[]).reduce((X,re)=>{if(X[re.Id]=re,re.Type===u.Comments&&(D.comments=q.comments[re.Target].comments),re.Type===u.VmlDrawing&&D.comments&&D.comments.length){const V=q.vmlDrawings[re.Target].comments;D.comments.forEach((J,W)=>{J.note=Object.assign({},J.note,V[W])})}return X},{});if(q.commentsMap=(D.comments||[]).reduce((X,re)=>(re.ref&&(X[re.ref]=re),X),{}),q.hyperlinkMap=(D.hyperlinks||[]).reduce((X,re)=>(re.rId&&(X[re.address]=M[re.rId].Target),X),{}),q.formulae={},D.rows=D.rows&&D.rows.filter(Boolean)||[],D.rows.forEach(X=>{X.cells=X.cells&&X.cells.filter(Boolean)||[]}),this.map.cols.reconcile(D.cols,q),this.map.sheetData.reconcile(D.rows,q),this.map.conditionalFormatting.reconcile(D.conditionalFormattings,q),D.media=[],D.drawing){const X=M[D.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(X){const re=X[1];q.drawings[re].anchors.forEach(V=>{if(V.medium){const J={type:"image",imageId:V.medium.index,range:V.range,hyperlinks:V.picture.hyperlinks};D.media.push(J)}})}}const G=D.background&&M[D.background.rId];if(G){const X=G.Target.split("/media/")[1],re=q.mediaIndex&&q.mediaIndex[X];re!==void 0&&D.media.push({type:"background",imageId:re})}D.tables=(D.tables||[]).map(X=>{const re=M[X.rId];return q.tables[re.Target]}),delete D.relationships,delete D.hyperlinks,delete D.comments}}S.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=S},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,c){c&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(c){try{return Number.isNaN(c.getTime())?"":c.toISOString()}catch{return""}},this._parse=o.parse||function(c){return new Date(c)}}render(o,c){c&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(c)):o.writeText(this._format(c)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,c){(c||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,c):o.writeText(c),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,c){c!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,c):o.writeText(c),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(t,n,a){const i=t("./base-xform"),o=t("../../utils/xml-stream");n.exports=class extends i{constructor(c){super(),this._model=c}render(c){if(!this._xml){const u=new o;(function l(d,f){d.openNode(f.tag,f.$),f.c&&f.c.forEach(p=>{l(d,p)}),f.t&&d.writeText(f.t),d.closeNode()})(u,this._model),this._xml=u.xml}c.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(c){return c!==this._model.tag}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(t,n,a){const i=t("./text-xform"),o=t("./rich-text-xform"),c=t("../base-xform");n.exports=class extends c{constructor(){super(),this.map={r:new o,t:new i}}get tag(){return"rPh"}render(u,l){if(u.openNode(this.tag,{sb:l.sb||0,eb:l.eb||0}),l&&l.hasOwnProperty("richText")&&l.richText){const{r:d}=this.map;l.richText.forEach(f=>{d.render(u,f)})}else l&&this.map.t.render(u,l.text);u.closeNode()}parseOpen(u){const{name:l}=u;return this.parser?(this.parser.parseOpen(u),!0):l===this.tag?(this.model={sb:parseInt(u.attributes.sb,10),eb:parseInt(u.attributes.eb,10)},!0):(this.parser=this.map[l],!!this.parser&&(this.parser.parseOpen(u),!0))}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser){if(!this.parser.parseClose(u)){switch(u){case"r":{let l=this.model.richText;l||(l=this.model.richText=[]),l.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}return u!==this.tag}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(t,n,a){const i=t("./text-xform"),o=t("../style/font-xform"),c=t("../base-xform");class u extends c{constructor(d){super(),this.model=d}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new o(u.FONT_OPTIONS))}render(d,f){f=f||this.model,d.openNode("r"),f.font&&this.fontXform.render(d,f.font),this.textXform.render(d,f.text),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(d),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){switch(d){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}}u.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=u},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(t,n,a){const i=t("./text-xform"),o=t("./rich-text-xform"),c=t("./phonetic-text-xform"),u=t("../base-xform");n.exports=class extends u{constructor(l){super(),this.model=l,this.map={r:new o,t:new i,rPh:new c}}get tag(){return"si"}render(l,d){l.openNode(this.tag),d&&d.hasOwnProperty("richText")&&d.richText?d.richText.length?d.richText.forEach(f=>{this.map.r.render(l,f)}):this.map.t.render(l,""):d!=null&&this.map.t.render(l,d),l.closeNode()}parseOpen(l){const{name:d}=l;return this.parser?(this.parser.parseOpen(l),!0):d===this.tag?(this.model={},!0):(this.parser=this.map[d],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let d=this.model.richText;d||(d=this.model.richText=[]),d.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}return l!==this.tag}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("./shared-string-xform");n.exports=class extends o{constructor(u){super(),this.model=u||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new c)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(u){return this.model.values[u]}add(u){return u.richText?this.addRichText(u):this.addText(u)}addText(u){let l=this.hash[u];return l===void 0&&(l=this.hash[u]=this.model.values.length,this.model.values.push(u)),this.model.count++,l}addRichText(u){const l=this.sharedStringXform.toXml(u);let d=this.rich[l];return d===void 0&&(d=this.rich[l]=this.model.values.length,this.model.values.push(u)),this.model.count++,d}render(u,l){l=l||this._values,u.openXml(i.StdDocAttributes),u.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:l.count,uniqueCount:l.values.length});const d=this.sharedStringXform;l.values.forEach(f=>{d.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(u),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if(u==="sst")return!1;throw new Error("Unexpected xml node in parseClose: "+u)}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"t"}render(o,c){o.openNode("t"),/^\s|\n|\s$/.test(c)&&o.addAttribute("xml:space","preserve"),o.writeText(c),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,c)=>String.fromCharCode(parseInt(c,16)))}parseOpen(o){return o.name==="t"?(this._text=[],!0):!1}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(t,n,a){const i=t("../../../doc/enums"),o=t("../../../utils/utils"),c=t("../base-xform"),u={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((d,f)=>(d[f]=!0,d),{}),horizontal(d){return this.horizontalValues[d]?d:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((d,f)=>(d[f]=!0,d),{}),vertical(d){return d==="middle"?"center":this.verticalValues[d]?d:void 0},wrapText:d=>!!d||void 0,shrinkToFit:d=>!!d||void 0,textRotation(d){return d==="vertical"||(d=o.validInt(d))>=-90&&d<=90?d:void 0},indent:d=>(d=o.validInt(d),Math.max(0,d)),readingOrder(d){switch(d){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},l={toXml(d){if(d=u.textRotation(d)){if(d==="vertical")return 255;const f=Math.round(d);if(f>=0&&f<=90)return f;if(f<0&&f>=-90)return 90-f}},toModel(d){const f=o.validInt(d);if(f!==void 0){if(f===255)return"vertical";if(f>=0&&f<=90)return f;if(f>90&&f<=180)return 90-f}}};n.exports=class extends c{get tag(){return"alignment"}render(d,f){d.addRollback(),d.openNode("alignment");let p=!1;function h(y,g){g&&(d.addAttribute(y,g),p=!0)}h("horizontal",u.horizontal(f.horizontal)),h("vertical",u.vertical(f.vertical)),h("wrapText",!!u.wrapText(f.wrapText)&&"1"),h("shrinkToFit",!!u.shrinkToFit(f.shrinkToFit)&&"1"),h("indent",u.indent(f.indent)),h("textRotation",l.toXml(f.textRotation)),h("readingOrder",u.readingOrder(f.readingOrder)),d.closeNode(),p?d.commit():d.rollback()}parseOpen(d){const f={};let p=!1;function h(y,g,m){y&&(f[g]=m,p=!0)}h(d.attributes.horizontal,"horizontal",d.attributes.horizontal),h(d.attributes.vertical,"vertical",d.attributes.vertical==="center"?"middle":d.attributes.vertical),h(d.attributes.wrapText,"wrapText",o.parseBoolean(d.attributes.wrapText)),h(d.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(d.attributes.shrinkToFit)),h(d.attributes.indent,"indent",parseInt(d.attributes.indent,10)),h(d.attributes.textRotation,"textRotation",l.toModel(d.attributes.textRotation)),h(d.attributes.readingOrder,"readingOrder",d.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=p?f:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(t,n,a){const i=t("../base-xform"),o=t("../../../utils/utils"),c=t("./color-xform");class u extends i{constructor(d){super(),this.name=d,this.map={color:new c}}get tag(){return this.name}render(d,f,p){const h=f&&f.color||p||this.defaultColor;d.openNode(this.name),f&&f.style&&(d.addAttribute("style",f.style),h&&this.map.color.render(d,h)),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.name:{const{style:f}=d.attributes;return this.model=f?{style:f}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):(d===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(d){return u.validStyleValues[d]}}u.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((l,d)=>(l[d]=!0,l),{}),n.exports=class extends i{constructor(){super(),this.map={top:new u("top"),left:new u("left"),bottom:new u("bottom"),right:new u("right"),diagonal:new u("diagonal")}}render(l,d){const{color:f}=d;function p(h,y){h&&!h.color&&d.color&&(h={...h,color:d.color}),y.render(l,h,f)}l.openNode("border"),d.diagonal&&d.diagonal.style&&(d.diagonal.up&&l.addAttribute("diagonalUp","1"),d.diagonal.down&&l.addAttribute("diagonalDown","1")),p(d.left,this.map.left),p(d.right,this.map.right),p(d.top,this.map.top),p(d.bottom,this.map.bottom),p(d.diagonal,this.map.diagonal),l.closeNode()}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):l.name==="border"?(this.reset(),this.diagonalUp=o.parseBoolean(l.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(l.attributes.diagonalDown),!0):(this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;if(l==="border"){const d=this.model={},f=function(p,h,y){h&&(y&&Object.assign(h,y),d[p]=h)};f("left",this.map.left.model),f("right",this.map.right.model),f("top",this.map.top.model),f("bottom",this.map.bottom.model),f("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,c){return!!c&&(o.openNode(this.name),c.argb?o.addAttribute("rgb",c.argb):c.theme!==void 0?(o.addAttribute("theme",c.theme),c.tint!==void 0&&o.addAttribute("tint",c.tint)):c.indexed!==void 0?o.addAttribute("indexed",c.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(t,n,a){const i=t("../base-xform"),o=t("./alignment-xform"),c=t("./border-xform"),u=t("./fill-xform"),l=t("./font-xform"),d=t("./numfmt-xform"),f=t("./protection-xform");n.exports=class extends i{constructor(){super(),this.map={alignment:new o,border:new c,fill:new u,font:new l,numFmt:new d,protection:new f}}get tag(){return"dxf"}render(p,h){if(p.openNode(this.tag),h.font&&this.map.font.render(p,h.font),h.numFmt&&h.numFmtId){const y={id:h.numFmtId,formatCode:h.numFmt};this.map.numFmt.render(p,y)}h.fill&&this.map.fill.render(p,h.fill),h.alignment&&this.map.alignment.render(p,h.alignment),h.border&&this.map.border.render(p,h.border),h.protection&&this.map.protection.render(p,h.protection),p.closeNode()}parseOpen(p){return this.parser?(this.parser.parseOpen(p),!0):p.name===this.tag?(this.reset(),!0):(this.parser=this.map[p.name],this.parser&&this.parser.parseOpen(p),!0)}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return this.parser?(this.parser.parseClose(p)||(this.parser=void 0),!0):p!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(t,n,a){const i=t("../base-xform"),o=t("./color-xform");class c extends i{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(p,h){p.openNode("stop"),p.addAttribute("position",h.position),this.map.color.render(p,h.color),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"stop":return this.model={position:parseFloat(p.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(p),!0;default:return!1}}parseText(){}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class u extends i{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(p,h){p.openNode("patternFill"),p.addAttribute("patternType",h.pattern),h.fgColor&&this.map.fgColor.render(p,h.fgColor),h.bgColor&&this.map.bgColor.render(p,h.bgColor),p.closeNode()}parseOpen(p){return this.parser?(this.parser.parseOpen(p),!0):p.name==="patternFill"?(this.model={type:"pattern",pattern:p.attributes.patternType},!0):(this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0))}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.parser.model&&(this.model[p]=this.parser.model),this.parser=void 0),!0)}}class l extends i{constructor(){super(),this.map={stop:new c}}get name(){return"gradient"}get tag(){return"gradientFill"}render(p,h){switch(p.openNode("gradientFill"),h.gradient){case"angle":p.addAttribute("degree",h.degree);break;case"path":p.addAttribute("type","path"),h.center.left&&(p.addAttribute("left",h.center.left),h.center.right===void 0&&p.addAttribute("right",h.center.left)),h.center.right&&p.addAttribute("right",h.center.right),h.center.top&&(p.addAttribute("top",h.center.top),h.center.bottom===void 0&&p.addAttribute("bottom",h.center.top)),h.center.bottom&&p.addAttribute("bottom",h.center.bottom)}const y=this.map.stop;h.stops.forEach(g=>{y.render(p,g)}),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"gradientFill":{const h=this.model={stops:[]};return p.attributes.degree?(h.gradient="angle",h.degree=parseInt(p.attributes.degree,10)):p.attributes.type==="path"&&(h.gradient="path",h.center={left:p.attributes.left?parseFloat(p.attributes.left):0,top:p.attributes.top?parseFloat(p.attributes.top):0},p.attributes.right!==p.attributes.left&&(h.center.right=p.attributes.right?parseFloat(p.attributes.right):0),p.attributes.bottom!==p.attributes.top&&(h.center.bottom=p.attributes.bottom?parseFloat(p.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class d extends i{constructor(){super(),this.map={patternFill:new u,gradientFill:new l}}get tag(){return"fill"}render(p,h){switch(p.addRollback(),p.openNode("fill"),h.type){case"pattern":this.map.patternFill.render(p,h);break;case"gradient":this.map.gradientFill.render(p,h);break;default:return void p.rollback()}p.closeNode(),p.commit()}parseOpen(p){return this.parser?(this.parser.parseOpen(p),!0):p.name==="fill"?(this.model={},!0):(this.parser=this.map[p.name],!!this.parser&&(this.parser.parseOpen(p),!0))}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){return!!this.parser&&(this.parser.parseClose(p)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(p){return d.validPatternValues[p]}}d.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((f,p)=>(f[p]=!0,f),{}),d.StopXform=c,d.PatternFillXform=u,d.GradientFillXform=l,n.exports=d},{"../base-xform":32,"./color-xform":128}],131:[function(t,n,a){const i=t("./color-xform"),o=t("../simple/boolean-xform"),c=t("../simple/integer-xform"),u=t("../simple/string-xform"),l=t("./underline-xform"),d=t("../../../utils/under-dash"),f=t("../base-xform");class p extends f{constructor(y){super(),this.options=y||p.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new l},charset:{prop:"charset",xform:new c({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new c({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new u({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new u({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new c({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new u({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(y,g){const{map:m}=this;y.openNode(this.options.tagName),d.each(this.map,(x,v)=>{m[v].xform.render(y,g[x.prop])}),y.closeNode()}parseOpen(y){return this.parser?(this.parser.parseOpen(y),!0):this.map[y.name]?(this.parser=this.map[y.name].xform,this.parser.parseOpen(y)):y.name===this.options.tagName?(this.model={},!0):!1}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser&&!this.parser.parseClose(y)){const g=this.map[y];return this.parser.model&&(this.model[g.prop]=this.parser.model),this.parser=void 0,!0}return y!==this.options.tagName}}p.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=p},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(t,n,a){const i=t("../../../utils/under-dash"),o=t("../../defaultnumformats"),c=t("../base-xform"),u=(function(){const d={};return i.each(o,(f,p)=>{f.f&&(d[f.f]=parseInt(p,10))}),d})();class l extends c{constructor(f,p){super(),this.id=f,this.formatCode=p}get tag(){return"numFmt"}render(f,p){f.leafNode("numFmt",{numFmtId:p.id,formatCode:p.formatCode})}parseOpen(f){return f.name==="numFmt"?(this.model={id:parseInt(f.attributes.numFmtId,10),formatCode:f.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0):!1}parseText(){}parseClose(){return!1}}l.getDefaultFmtId=function(d){return u[d]},l.getDefaultFmtCode=function(d){return o[d]&&o[d].f},n.exports=l},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(t,n,a){const i=t("../base-xform"),o={boolean:(c,u)=>c===void 0?u:c};n.exports=class extends i{get tag(){return"protection"}render(c,u){c.addRollback(),c.openNode("protection");let l=!1;function d(f,p){p!==void 0&&(c.addAttribute(f,p),l=!0)}d("locked",o.boolean(u.locked,!0)?void 0:"0"),d("hidden",o.boolean(u.hidden,!1)?"1":void 0),c.closeNode(),l?c.commit():c.rollback()}parseOpen(c){const u={locked:c.attributes.locked!=="0",hidden:c.attributes.hidden==="1"},l=!u.locked||u.hidden;this.model=l?u:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(t,n,a){const i=t("../base-xform"),o=t("./alignment-xform"),c=t("./protection-xform");n.exports=class extends i{constructor(u){super(),this.xfId=!(!u||!u.xfId),this.map={alignment:new o,protection:new c}}get tag(){return"xf"}render(u,l){u.openNode("xf",{numFmtId:l.numFmtId||0,fontId:l.fontId||0,fillId:l.fillId||0,borderId:l.borderId||0}),this.xfId&&u.addAttribute("xfId",l.xfId||0),l.numFmtId&&u.addAttribute("applyNumberFormat","1"),l.fontId&&u.addAttribute("applyFont","1"),l.fillId&&u.addAttribute("applyFill","1"),l.borderId&&u.addAttribute("applyBorder","1"),l.alignment&&u.addAttribute("applyAlignment","1"),l.protection&&u.addAttribute("applyProtection","1"),l.alignment&&this.map.alignment.render(u,l.alignment),l.protection&&this.map.protection.render(u,l.protection),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"xf":return this.model={numFmtId:parseInt(u.attributes.numFmtId,10),fontId:parseInt(u.attributes.fontId,10),fillId:parseInt(u.attributes.fillId,10),borderId:parseInt(u.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(u.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(u),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):u!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(t,n,a){const i=t("../../../doc/enums"),o=t("../../../utils/xml-stream"),c=t("../base-xform"),u=t("../static-xform"),l=t("../list-xform"),d=t("./font-xform"),f=t("./fill-xform"),p=t("./border-xform"),h=t("./numfmt-xform"),y=t("./style-xform"),g=t("./dxf-xform");class m extends c{constructor(v){super(),this.map={numFmts:new l({tag:"numFmts",count:!0,childXform:new h}),fonts:new l({tag:"fonts",count:!0,childXform:new d,$:{"x14ac:knownFonts":1}}),fills:new l({tag:"fills",count:!0,childXform:new f}),borders:new l({tag:"borders",count:!0,childXform:new p}),cellStyleXfs:new l({tag:"cellStyleXfs",count:!0,childXform:new y}),cellXfs:new l({tag:"cellXfs",count:!0,childXform:new y({xfId:!0})}),dxfs:new l({tag:"dxfs",always:!0,count:!0,childXform:new g}),numFmt:new h,font:new d,fill:new f,border:new p,style:new y({xfId:!0}),cellStyles:m.STATIC_XFORMS.cellStyles,tableStyles:m.STATIC_XFORMS.tableStyles,extLst:m.STATIC_XFORMS.extLst},v&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(v,w){w=w||this.model,v.openXml(o.StdDocAttributes),v.openNode("styleSheet",m.STYLESHEET_ATTRIBUTES),this.index?(w.numFmts&&w.numFmts.length&&(v.openNode("numFmts",{count:w.numFmts.length}),w.numFmts.forEach(_=>{v.writeXml(_)}),v.closeNode()),w.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),v.openNode("fonts",{count:w.fonts.length,"x14ac:knownFonts":1}),w.fonts.forEach(_=>{v.writeXml(_)}),v.closeNode(),v.openNode("fills",{count:w.fills.length}),w.fills.forEach(_=>{v.writeXml(_)}),v.closeNode(),v.openNode("borders",{count:w.borders.length}),w.borders.forEach(_=>{v.writeXml(_)}),v.closeNode(),this.map.cellStyleXfs.render(v,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),v.openNode("cellXfs",{count:w.styles.length}),w.styles.forEach(_=>{v.writeXml(_)}),v.closeNode()):(this.map.numFmts.render(v,w.numFmts),this.map.fonts.render(v,w.fonts),this.map.fills.render(v,w.fills),this.map.borders.render(v,w.borders),this.map.cellStyleXfs.render(v,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(v,w.styles)),m.STATIC_XFORMS.cellStyles.render(v),this.map.dxfs.render(v,w.dxfs),m.STATIC_XFORMS.tableStyles.render(v),m.STATIC_XFORMS.extLst.render(v),v.closeNode()}parseOpen(v){return this.parser?(this.parser.parseOpen(v),!0):v.name==="styleSheet"?(this.initIndex(),!0):(this.parser=this.map[v.name],this.parser&&this.parser.parseOpen(v),!0)}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){if(this.parser)return this.parser.parseClose(v)||(this.parser=void 0),!0;switch(v){case"styleSheet":{this.model={};const w=(_,A)=>{A.model&&A.model.length&&(this.model[_]=A.model)};if(w("numFmts",this.map.numFmts),w("fonts",this.map.fonts),w("fills",this.map.fills),w("borders",this.map.borders),w("styles",this.map.cellXfs),w("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const _=this.index.numFmt;this.model.numFmts.forEach(A=>{_[A.id]=A.formatCode})}return!1}default:return!0}}addStyleModel(v,w){if(!v)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(v))return this.weakMap.get(v);const _={};if(w=w||i.ValueType.Number,v.numFmt)_.numFmtId=this._addNumFmtStr(v.numFmt);else switch(w){case i.ValueType.Number:_.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:_.numFmtId=this._addNumFmtStr("mm-dd-yy")}v.font&&(_.fontId=this._addFont(v.font)),v.border&&(_.borderId=this._addBorder(v.border)),v.fill&&(_.fillId=this._addFill(v.fill)),v.alignment&&(_.alignment=v.alignment),v.protection&&(_.protection=v.protection);const A=this._addStyle(_);return this.weakMap&&this.weakMap.set(v,A),A}getStyleModel(v){const w=this.model.styles[v];if(!w)return null;let _=this.index.model[v];if(_)return _;if(_=this.index.model[v]={},w.numFmtId){const P=this.index.numFmt[w.numFmtId]||h.getDefaultFmtCode(w.numFmtId);P&&(_.numFmt=P)}function A(P,B,T){if(T||T===0){const I=B[T];I&&(_[P]=I)}}return A("font",this.model.fonts,w.fontId),A("border",this.model.borders,w.borderId),A("fill",this.model.fills,w.fillId),w.alignment&&(_.alignment=w.alignment),w.protection&&(_.protection=w.protection),_}addDxfStyle(v){return v.numFmt&&(v.numFmtId=this._addNumFmtStr(v.numFmt)),this.model.dxfs.push(v),this.model.dxfs.length-1}getDxfStyle(v){return this.model.dxfs[v]}_addStyle(v){const w=this.map.style.toXml(v);let _=this.index.style[w];return _===void 0&&(_=this.index.style[w]=this.model.styles.length,this.model.styles.push(w)),_}_addNumFmtStr(v){let w=h.getDefaultFmtId(v);if(w!==void 0||(w=this.index.numFmt[v],w!==void 0))return w;w=this.index.numFmt[v]=164+this.model.numFmts.length;const _=this.map.numFmt.toXml({id:w,formatCode:v});return this.model.numFmts.push(_),w}_addFont(v){const w=this.map.font.toXml(v);let _=this.index.font[w];return _===void 0&&(_=this.index.font[w]=this.model.fonts.length,this.model.fonts.push(w)),_}_addBorder(v){const w=this.map.border.toXml(v);let _=this.index.border[w];return _===void 0&&(_=this.index.border[w]=this.model.borders.length,this.model.borders.push(w)),_}_addFill(v){const w=this.map.fill.toXml(v);let _=this.index.fill[w];return _===void 0&&(_=this.index.fill[w]=this.model.fills.length,this.model.fills.push(w)),_}}m.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},m.STATIC_XFORMS={cellStyles:new u({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new u({tag:"dxfs",$:{count:0}}),tableStyles:new u({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new u({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},m.Mock=class extends m{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(x){return x.autodrain(),Promise.resolve()}addStyleModel(x,v){return v===i.ValueType.Date?this.dateStyleId:0}get dateStyleId(){if(!this._dateStyleId){const x={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(x)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=m},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(t,n,a){const i=t("../base-xform");class o extends i{constructor(u){super(),this.model=u}get tag(){return"u"}render(u,l){if((l=l||this.model)===!0)u.leafNode("u");else{const d=o.Attributes[l];d&&u.leafNode("u",d)}}parseOpen(u){u.name==="u"&&(this.model=u.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=o},{"../base-xform":32}],137:[function(t,n,a){const i=t("../base-xform"),o=t("./filter-column-xform");n.exports=class extends i{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(c){c.columns.forEach((u,l)=>{this.map.filterColumn.prepare(u,{index:l})})}render(c,u){return c.openNode(this.tag,{ref:u.autoFilterRef}),u.columns.forEach(l=>{this.map.filterColumn.render(c,l)}),c.closeNode(),!0}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:return this.model={autoFilterRef:c.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(c===this.tag)return!1;throw new Error("Unexpected xml node in parseClose: "+c)}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"customFilter"}render(o,c){o.leafNode(this.tag,{val:c.val,operator:c.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(t,n,a){const i=t("../base-xform"),o=t("../list-xform"),c=t("./custom-filter-xform"),u=t("./filter-xform");n.exports=class extends i{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new c}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new u})}}get tag(){return"filterColumn"}prepare(l,d){l.colId=d.index.toString()}render(l,d){return d.customFilters?(l.openNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),this.map.customFilters.render(l,d.customFilters),l.closeNode(),!0):(l.leafNode(this.tag,{colId:d.colId,hiddenButton:d.filterButton?"0":"1"}),!0)}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;const{attributes:d}=l;switch(l.name){case this.tag:return this.model={filterButton:d.hiddenButton==="0"},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(){}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model.customFilters=this.map.customFilters.model,!1):!0}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"filter"}render(o,c){o.leafNode(this.tag,{val:c.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"tableColumn"}prepare(o,c){o.id=c.index+1}render(o,c){return o.leafNode(this.tag,{id:c.id.toString(),name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:c}=o;return this.model={name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(t,n,a){const i=t("../base-xform");n.exports=class extends i{get tag(){return"tableStyleInfo"}render(o,c){return o.leafNode(this.tag,{name:c.theme?c.theme:void 0,showFirstColumn:c.showFirstColumn?"1":"0",showLastColumn:c.showLastColumn?"1":"0",showRowStripes:c.showRowStripes?"1":"0",showColumnStripes:c.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:c}=o;return this.model={theme:c.name?c.name:null,showFirstColumn:c.showFirstColumn==="1",showLastColumn:c.showLastColumn==="1",showRowStripes:c.showRowStripes==="1",showColumnStripes:c.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(t,n,a){const i=t("../../../utils/xml-stream"),o=t("../base-xform"),c=t("../list-xform"),u=t("./auto-filter-xform"),l=t("./table-column-xform"),d=t("./table-style-info-xform");class f extends o{constructor(){super(),this.map={autoFilter:new u,tableColumns:new c({tag:"tableColumns",count:!0,empty:!0,childXform:new l}),tableStyleInfo:new d}}prepare(h,y){this.map.autoFilter.prepare(h),this.map.tableColumns.prepare(h.columns,y)}get tag(){return"table"}render(h,y){h.openXml(i.StdDocAttributes),h.openNode(this.tag,{...f.TABLE_ATTRIBUTES,id:y.id,name:y.name,displayName:y.displayName||y.name,ref:y.tableRef,totalsRowCount:y.totalsRow?"1":void 0,totalsRowShown:y.totalsRow?void 0:"1",headerRowCount:y.headerRow?"1":"0"}),this.map.autoFilter.render(h,y),this.map.tableColumns.render(h,y.columns),this.map.tableStyleInfo.render(h,y.style),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;const{name:y,attributes:g}=h;return y===this.tag?(this.reset(),this.model={name:g.name,displayName:g.displayName||g.name,tableRef:g.ref,totalsRow:g.totalsRowCount==="1",headerRow:g.headerRowCount==="1"}):(this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)),!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){return this.parser?(this.parser.parseClose(h)||(this.parser=void 0),!0):h===this.tag?(this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((y,g)=>{this.model.columns[g].filterButton=y.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1):!0}reconcile(h,y){h.columns.forEach(g=>{g.dxfId!==void 0&&(g.style=y.styles.getDxfStyle(g.dxfId))})}}f.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=f},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(t,n,a){(function(i,o){(function(){const c=t("fs"),u=t("jszip"),{PassThrough:l}=t("readable-stream"),d=t("../utils/zip-stream"),f=t("../utils/stream-buf"),p=t("../utils/utils"),h=t("../utils/xml-stream"),{bufferToString:y}=t("../utils/browser-buffer-decode"),g=t("./xform/style/styles-xform"),m=t("./xform/core/core-xform"),x=t("./xform/strings/shared-strings-xform"),v=t("./xform/core/relationships-xform"),w=t("./xform/core/content-types-xform"),_=t("./xform/core/app-xform"),A=t("./xform/book/workbook-xform"),P=t("./xform/sheet/worksheet-xform"),B=t("./xform/drawing/drawing-xform"),T=t("./xform/table/table-xform"),I=t("./xform/comment/comments-xform"),U=t("./xform/comment/vml-notes-xform"),H=t("./xml/theme1");class z{constructor(L){this.workbook=L}async readFile(L,E){if(!await p.fs.exists(L))throw new Error("File not found: "+L);const k=c.createReadStream(L);try{const N=await this.read(k,E);return k.close(),N}catch(N){throw k.close(),N}}parseRels(L){return new v().parseStream(L)}parseWorkbook(L){return new A().parseStream(L)}parseSharedStrings(L){return new x().parseStream(L)}reconcile(L,E){const k=new A,N=new P(E),S=new B,C=new T;k.reconcile(L);const D={media:L.media,mediaIndex:L.mediaIndex};Object.keys(L.drawings).forEach(G=>{const X=L.drawings[G],re=L.drawingRels[G];re&&(D.rels=re.reduce((V,J)=>(V[J.Id]=J,V),{}),(X.anchors||[]).forEach(V=>{const J=V.picture&&V.picture.hyperlinks;J&&D.rels[J.rId]&&(J.hyperlink=D.rels[J.rId].Target,delete J.rId)}),S.reconcile(X,D))});const q={styles:L.styles};Object.values(L.tables).forEach(G=>{C.reconcile(G,q)});const M={styles:L.styles,sharedStrings:L.sharedStrings,media:L.media,mediaIndex:L.mediaIndex,date1904:L.properties&&L.properties.date1904,drawings:L.drawings,comments:L.comments,tables:L.tables,vmlDrawings:L.vmlDrawings};L.worksheets.forEach(G=>{G.relationships=L.worksheetRels[G.sheetNo],N.reconcile(G,M)}),delete L.worksheetHash,delete L.worksheetRels,delete L.globalRels,delete L.sharedStrings,delete L.workbookRels,delete L.sheetDefs,delete L.styles,delete L.mediaIndex,delete L.drawings,delete L.drawingRels,delete L.vmlDrawings}async _processWorksheetEntry(L,E,k,N,S){const C=new P(N),D=await C.parseStream(L);D.sheetNo=k,E.worksheetHash[S]=D,E.worksheets.push(D)}async _processCommentEntry(L,E,k){const N=new I,S=await N.parseStream(L);E.comments[`../${k}.xml`]=S}async _processTableEntry(L,E,k){const N=new T,S=await N.parseStream(L);E.tables[`../tables/${k}.xml`]=S}async _processWorksheetRelsEntry(L,E,k){const N=new v,S=await N.parseStream(L);E.worksheetRels[k]=S}async _processMediaEntry(L,E,k){const N=k.lastIndexOf(".");if(N>=1){const S=k.substr(N+1),C=k.substr(0,N);await new Promise((D,q)=>{const M=new f;M.on("finish",()=>{E.mediaIndex[k]=E.media.length,E.mediaIndex[C]=E.media.length;const G={type:"image",name:C,extension:S,buffer:M.toBuffer()};E.media.push(G),D()}),L.on("error",G=>{q(G)}),L.pipe(M)})}}async _processDrawingEntry(L,E,k){const N=new B,S=await N.parseStream(L);E.drawings[k]=S}async _processDrawingRelsEntry(L,E,k){const N=new v,S=await N.parseStream(L);E.drawingRels[k]=S}async _processVmlDrawingEntry(L,E,k){const N=new U,S=await N.parseStream(L);E.vmlDrawings[`../drawings/${k}.vml`]=S}async _processThemeEntry(L,E,k){await new Promise((N,S)=>{const C=new f;L.on("error",S),C.on("error",S),C.on("finish",()=>{E.themes[k]=C.read().toString(),N()}),L.pipe(C)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(L,E){!L[Symbol.asyncIterator]&&L.pipe&&(L=L.pipe(new l));const k=[];for await(const N of L)k.push(N);return this.load(o.concat(k),E)}async load(L,E){let k;k=E&&E.base64?o.from(L.toString(),"base64"):L;const N={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},S=await u.loadAsync(k);for(const C of Object.values(S.files))if(!C.dir){let D,q=C.name;if(q[0]==="/"&&(q=q.substr(1)),q.match(/xl\/media\//)||q.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))D=new l,D.write(await C.async("nodebuffer"));else{let M;D=new l({writableObjectMode:!0,readableObjectMode:!0}),M=i.browser?y(await C.async("nodebuffer")):await C.async("string");const G=16384;for(let X=0;X<M.length;X+=G)D.write(M.substring(X,X+G))}switch(D.end(),q){case"_rels/.rels":N.globalRels=await this.parseRels(D);break;case"xl/workbook.xml":{const M=await this.parseWorkbook(D);N.sheets=M.sheets,N.definedNames=M.definedNames,N.views=M.views,N.properties=M.properties,N.calcProperties=M.calcProperties;break}case"xl/_rels/workbook.xml.rels":N.workbookRels=await this.parseRels(D);break;case"xl/sharedStrings.xml":N.sharedStrings=new x,await N.sharedStrings.parseStream(D);break;case"xl/styles.xml":N.styles=new g,await N.styles.parseStream(D);break;case"docProps/app.xml":{const M=new _,G=await M.parseStream(D);N.company=G.company,N.manager=G.manager;break}case"docProps/core.xml":{const M=new m,G=await M.parseStream(D);Object.assign(N,G);break}default:{let M=q.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(M){await this._processWorksheetEntry(D,N,M[1],E,q);break}if(M=q.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),M){await this._processWorksheetRelsEntry(D,N,M[1]);break}if(M=q.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),M){await this._processThemeEntry(D,N,M[1]);break}if(M=q.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),M){await this._processMediaEntry(D,N,M[1]);break}if(M=q.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),M){await this._processDrawingEntry(D,N,M[1]);break}if(M=q.match(/xl\/(comments\d+)[.]xml/),M){await this._processCommentEntry(D,N,M[1]);break}if(M=q.match(/xl\/tables\/(table\d+)[.]xml/),M){await this._processTableEntry(D,N,M[1]);break}if(M=q.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),M){await this._processDrawingRelsEntry(D,N,M[1]);break}if(M=q.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),M){await this._processVmlDrawingEntry(D,N,M[1]);break}}}}return this.reconcile(N,E),this.workbook.model=N,this.workbook}async addMedia(L,E){await Promise.all(E.media.map(async k=>{if(k.type==="image"){const N=`xl/media/${k.name}.${k.extension}`;if(k.filename){const S=await(function(C,D){return new Promise((q,M)=>{c.readFile(C,D,(G,X)=>{G?M(G):q(X)})})})(k.filename);return L.append(S,{name:N})}if(k.buffer)return L.append(k.buffer,{name:N});if(k.base64){const S=k.base64,C=S.substring(S.indexOf(",")+1);return L.append(C,{name:N,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(L,E){const k=new B,N=new v;E.worksheets.forEach(S=>{const{drawing:C}=S;if(C){k.prepare(C,{});let D=k.toXml(C);L.append(D,{name:`xl/drawings/${C.name}.xml`}),D=N.toXml(C.rels),L.append(D,{name:`xl/drawings/_rels/${C.name}.xml.rels`})}})}addTables(L,E){const k=new T;E.worksheets.forEach(N=>{const{tables:S}=N;S.forEach(C=>{k.prepare(C,{});const D=k.toXml(C);L.append(D,{name:"xl/tables/"+C.target})})})}async addContentTypes(L,E){const k=new w().toXml(E);L.append(k,{name:"[Content_Types].xml"})}async addApp(L,E){const k=new _().toXml(E);L.append(k,{name:"docProps/app.xml"})}async addCore(L,E){const k=new m;L.append(k.toXml(E),{name:"docProps/core.xml"})}async addThemes(L,E){const k=E.themes||{theme1:H};Object.keys(k).forEach(N=>{const S=k[N],C=`xl/theme/${N}.xml`;L.append(S,{name:C})})}async addOfficeRels(L){const E=new v().toXml([{Id:"rId1",Type:z.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:z.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:z.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);L.append(E,{name:"_rels/.rels"})}async addWorkbookRels(L,E){let k=1;const N=[{Id:"rId"+k++,Type:z.RelType.Styles,Target:"styles.xml"},{Id:"rId"+k++,Type:z.RelType.Theme,Target:"theme/theme1.xml"}];E.sharedStrings.count&&N.push({Id:"rId"+k++,Type:z.RelType.SharedStrings,Target:"sharedStrings.xml"}),E.worksheets.forEach(C=>{C.rId="rId"+k++,N.push({Id:C.rId,Type:z.RelType.Worksheet,Target:`worksheets/sheet${C.id}.xml`})});const S=new v().toXml(N);L.append(S,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(L,E){E.sharedStrings&&E.sharedStrings.count&&L.append(E.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(L,E){const{xml:k}=E.styles;k&&L.append(k,{name:"xl/styles.xml"})}async addWorkbook(L,E){const k=new A;L.append(k.toXml(E),{name:"xl/workbook.xml"})}async addWorksheets(L,E){const k=new P,N=new v,S=new I,C=new U;E.worksheets.forEach(D=>{let q=new h;k.render(q,D),L.append(q.xml,{name:`xl/worksheets/sheet${D.id}.xml`}),D.rels&&D.rels.length&&(q=new h,N.render(q,D.rels),L.append(q.xml,{name:`xl/worksheets/_rels/sheet${D.id}.xml.rels`})),D.comments.length>0&&(q=new h,S.render(q,D),L.append(q.xml,{name:`xl/comments${D.id}.xml`}),q=new h,C.render(q,D),L.append(q.xml,{name:`xl/drawings/vmlDrawing${D.id}.vml`}))})}_finalize(L){return new Promise((E,k)=>{L.on("finish",()=>{E(this)}),L.on("error",k),L.finalize()})}prepareModel(L,E){L.creator=L.creator||"ExcelJS",L.lastModifiedBy=L.lastModifiedBy||"ExcelJS",L.created=L.created||new Date,L.modified=L.modified||new Date,L.useSharedStrings=E.useSharedStrings===void 0||E.useSharedStrings,L.useStyles=E.useStyles===void 0||E.useStyles,L.sharedStrings=new x,L.styles=L.useStyles?new g(!0):new g.Mock;const k=new A,N=new P;k.prepare(L);const S={sharedStrings:L.sharedStrings,styles:L.styles,date1904:L.properties.date1904,drawingsCount:0,media:L.media};S.drawings=L.drawings=[],S.commentRefs=L.commentRefs=[];let C=0;L.tables=[],L.worksheets.forEach(D=>{D.tables.forEach(q=>{C++,q.target=`table${C}.xml`,q.id=C,L.tables.push(q)}),N.prepare(D,S)})}async write(L,E){E=E||{};const{model:k}=this.workbook,N=new d.ZipWriter(E.zip);return N.pipe(L),this.prepareModel(k,E),await this.addContentTypes(N,k),await this.addOfficeRels(N,k),await this.addWorkbookRels(N,k),await this.addWorksheets(N,k),await this.addSharedStrings(N,k),await this.addDrawings(N,k),await this.addTables(N,k),await Promise.all([this.addThemes(N,k),this.addStyles(N,k)]),await this.addMedia(N,k),await Promise.all([this.addApp(N,k),this.addCore(N,k)]),await this.addWorkbook(N,k),this._finalize(N)}writeFile(L,E){const k=c.createWriteStream(L);return new Promise((N,S)=>{k.on("finish",()=>{N()}),k.on("error",C=>{S(C)}),this.write(k,E).then(()=>{k.end()}).catch(C=>{S(C)})})}async writeBuffer(L){const E=new f;return await this.write(E,L),E.read()}}z.RelType=t("./rel-type"),n.exports=z}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(t,n,a){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(t,n,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvFormatterStream=void 0;const o=t("stream"),c=t("./formatter");class u extends o.Transform{constructor(d){super({writableObjectMode:d.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=d,this.rowFormatter=new c.RowFormatter(d),this.hasWrittenBOM=!d.writeBOM}transform(d){return this.rowFormatter.rowTransform=d,this}_transform(d,f,p){let h=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(d,(y,g)=>y?(h=!0,p(y)):(g&&g.forEach(m=>{this.push(i.from(m,"utf8"))}),h=!0,p()))}catch(y){if(h)throw y;p(y)}}_flush(d){this.rowFormatter.finish((f,p)=>f?d(f):(p&&p.forEach(h=>{this.push(i.from(h,"utf8"))}),d()))}}a.CsvFormatterStream=u}).call(this)}).call(this,t("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FormatterOptions=void 0,a.FormatterOptions=class{constructor(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,i||{}),i?.quoteHeaders===void 0&&(this.quoteHeaders=this.quoteColumns),i?.quote===!0?this.quote='"':i?.quote===!1&&(this.quote=""),typeof i?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=i.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(t,n,a){var i=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=void 0;const o=i(t("lodash.isboolean")),c=i(t("lodash.isnil")),u=i(t("lodash.escaperegexp"));a.FieldFormatter=class{constructor(l){this._headers=null,this.formatterOptions=l,l.headers!==null&&(this.headers=l.headers),this.REPLACE_REGEXP=new RegExp(l.quote,"g");const d=`[${l.delimiter}${u.default(l.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(d)}set headers(l){this._headers=l}shouldQuote(l,d){const f=d?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(f)?f:Array.isArray(f)?f[l]:this._headers!==null&&f[this._headers[l]]}format(l,d,f){const p=(""+(c.default(l)?"":l)).replace(/\0/g,""),{formatterOptions:h}=this;return h.quote!==""&&p.indexOf(h.quote)!==-1?this.quoteField(p.replace(this.REPLACE_REGEXP,h.escapedQuote)):p.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(d,f)?this.quoteField(p):p}quoteField(l){const{quote:d}=this.formatterOptions;return`${d}${l}${d}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(t,n,a){var i=function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowFormatter=void 0;const o=i(t("lodash.isfunction")),c=i(t("lodash.isequal")),u=t("./FieldFormatter"),l=t("../types");class d{constructor(p){this.rowCount=0,this.formatterOptions=p,this.fieldFormatter=new u.FieldFormatter(p),this.headers=p.headers,this.shouldWriteHeaders=p.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),p.transform&&(this.rowTransform=p.transform)}static isRowHashArray(p){return!!Array.isArray(p)&&Array.isArray(p[0])&&p[0].length===2}static isRowArray(p){return Array.isArray(p)&&!this.isRowHashArray(p)}static gatherHeaders(p){return d.isRowHashArray(p)?p.map(h=>h[0]):Array.isArray(p)?p:Object.keys(p)}static createTransform(p){return l.isSyncTransform(p)?(h,y)=>{let g=null;try{g=p(h)}catch(m){return y(m)}return y(null,g)}:(h,y)=>{p(h,y)}}set rowTransform(p){if(!o.default(p))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(p)}format(p,h){this.callTransformer(p,(y,g)=>{if(y)return h(y);if(!p)return h(null);const m=[];if(g){const{shouldFormatColumns:x,headers:v}=this.checkHeaders(g);if(this.shouldWriteHeaders&&v&&!this.hasWrittenHeaders&&(m.push(this.formatColumns(v,!0)),this.hasWrittenHeaders=!0),x){const w=this.gatherColumns(g);m.push(this.formatColumns(w,!1))}}return h(null,m)})}finish(p){const h=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return p(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));h.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&h.push(this.formatterOptions.rowDelimiter),p(null,h)}checkHeaders(p){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const h=d.gatherHeaders(p);return this.headers=h,this.fieldFormatter.headers=h,this.shouldWriteHeaders?{shouldFormatColumns:!c.default(h,p),headers:h}:{shouldFormatColumns:!0,headers:null}}gatherColumns(p){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(p)?d.isRowHashArray(p)?this.headers.map((h,y)=>{const g=p[y];return g?g[1]:""}):d.isRowArray(p)&&!this.shouldWriteHeaders?p:this.headers.map((h,y)=>p[y]):this.headers.map(h=>p[h])}callTransformer(p,h){return this._rowTransform?this._rowTransform(p,h):h(null,p)}formatColumns(p,h){const y=p.map((m,x)=>this.fieldFormatter.format(m,x,h)).join(this.formatterOptions.delimiter),{rowCount:g}=this;return this.rowCount+=1,g?[this.formatterOptions.rowDelimiter,y].join(""):y}}a.RowFormatter=d},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=a.RowFormatter=void 0;var i=t("./RowFormatter");Object.defineProperty(a,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var o=t("./FieldFormatter");Object.defineProperty(a,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(t,n,a){(function(i){(function(){var o=Object.create?function(x,v,w,_){_===void 0&&(_=w),Object.defineProperty(x,_,{enumerable:!0,get:function(){return v[w]}})}:function(x,v,w,_){_===void 0&&(_=w),x[_]=v[w]},c=Object.create?function(x,v){Object.defineProperty(x,"default",{enumerable:!0,value:v})}:function(x,v){x.default=v},u=function(x){if(x&&x.__esModule)return x;var v={};if(x!=null)for(var w in x)w!=="default"&&Object.prototype.hasOwnProperty.call(x,w)&&o(v,x,w);return c(v,x),v},l=function(x,v){for(var w in x)w==="default"||Object.prototype.hasOwnProperty.call(v,w)||o(v,x,w)};Object.defineProperty(a,"__esModule",{value:!0}),a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=a.FormatterOptions=a.CsvFormatterStream=void 0;const d=t("util"),f=t("stream"),p=u(t("fs")),h=t("./FormatterOptions"),y=t("./CsvFormatterStream");l(t("./types"),a);var g=t("./CsvFormatterStream");Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return g.CsvFormatterStream}});var m=t("./FormatterOptions");Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return m.FormatterOptions}}),a.format=x=>new y.CsvFormatterStream(new h.FormatterOptions(x)),a.write=(x,v)=>{const w=a.format(v),_=d.promisify((A,P)=>{w.write(A,void 0,P)});return x.reduce((A,P)=>A.then(()=>_(P)),Promise.resolve()).then(()=>w.end()).catch(A=>{w.emit("error",A)}),w},a.writeToStream=(x,v,w)=>a.write(v,w).pipe(x),a.writeToBuffer=function(x){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const w=[],_=new f.Writable({write(A,P,B){w.push(A),B()}});return new Promise((A,P)=>{_.on("error",P).on("finish",()=>A(i.concat(w))),a.write(x,v).pipe(_)})},a.writeToString=(x,v)=>a.writeToBuffer(x,v).then(w=>w.toString()),a.writeToPath=(x,v,w)=>{const _=p.createWriteStream(x,{encoding:"utf8"});return a.write(v,w).pipe(_)}}).call(this)}).call(this,t("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1},{}],153:[function(t,n,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=void 0;const o=t("string_decoder"),c=t("stream"),u=t("./transforms"),l=t("./parser");class d extends c.Transform{constructor(p){super({objectMode:p.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=p,this.parser=new l.Parser(p),this.headerTransformer=new u.HeaderTransformer(p),this.decoder=new o.StringDecoder(p.encoding),this.rowTransformerValidator=new u.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(p){return this.rowTransformerValidator.rowTransform=p,this}validate(p){return this.rowTransformerValidator.rowValidator=p,this}emit(p){if(p==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var h=arguments.length,y=new Array(h>1?h-1:0),g=1;g<h;g++)y[g-1]=arguments[g];return super.emit(p,...y)}_transform(p,h,y){if(this.hasHitRowLimit)return y();const g=d.wrapDoneCallback(y);try{const{lines:m}=this,x=m+this.decoder.write(p),v=this.parse(x,!0);return this.processRows(v,g)}catch(m){return g(m)}}_flush(p){const h=d.wrapDoneCallback(p);if(this.hasHitRowLimit)return h();try{const y=this.lines+this.decoder.end(),g=this.parse(y,!1);return this.processRows(g,h)}catch(y){return h(y)}}parse(p,h){if(!p)return[];const{line:y,rows:g}=this.parser.parse(p,h);return this.lines=y,g}processRows(p,h){const y=p.length,g=m=>{const x=_=>_?h(_):m%100!=0?g(m+1):void i(()=>g(m+1));if(this.checkAndEmitHeaders(),m>=y||this.hasHitRowLimit)return h();if(this.parsedLineCount+=1,this.shouldSkipLine)return x();const v=p[m];this.rowCount+=1,this.parsedRowCount+=1;const w=this.rowCount;return this.transformRow(v,(_,A)=>{if(_)return this.rowCount-=1,x(_);if(!A)return x(new Error("expected transform result"));if(A.isValid){if(A.row)return this.pushRow(A.row,x)}else this.emit("data-invalid",A.row,w,A.reason);return x()})};g(0)}transformRow(p,h){try{this.headerTransformer.transform(p,(y,g)=>y?h(y):g?g.isValid?g.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(g.row,h):this.skipRow(h):(this.rowCount-=1,this.parsedRowCount-=1,h(null,{row:null,isValid:!0})):this.shouldEmitRows?h(null,{isValid:!1,row:p}):this.skipRow(h):h(new Error("Expected result from header transform")))}catch(y){h(y)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(p){return this.rowCount-=1,p(null,{row:null,isValid:!0})}pushRow(p,h){try{this.parserOptions.objectMode?this.push(p):this.push(JSON.stringify(p)),h()}catch(y){h(y)}}static wrapDoneCallback(p){let h=!1;return function(y){if(y){if(h)throw y;return h=!0,void p(y)}for(var g=arguments.length,m=new Array(g>1?g-1:0),x=1;x<g;x++)m[x-1]=arguments[x];p(...m)}}}a.CsvParserStream=d}).call(this)}).call(this,t("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(t,n,a){var i=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParserOptions=void 0;const o=i(t("lodash.escaperegexp")),c=i(t("lodash.isnil"));a.ParserOptions=class{constructor(u){var l;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,u||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(l=this.escape)!==null&&l!==void 0?l:this.quote,this.supportsComments=!c.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(t,n,a){var i=Object.create?function(g,m,x,v){v===void 0&&(v=x),Object.defineProperty(g,v,{enumerable:!0,get:function(){return m[x]}})}:function(g,m,x,v){v===void 0&&(v=x),g[v]=m[x]},o=Object.create?function(g,m){Object.defineProperty(g,"default",{enumerable:!0,value:m})}:function(g,m){g.default=m},c=function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var x in g)x!=="default"&&Object.prototype.hasOwnProperty.call(g,x)&&i(m,g,x);return o(m,g),m},u=function(g,m){for(var x in g)x==="default"||Object.prototype.hasOwnProperty.call(m,x)||i(m,g,x)};Object.defineProperty(a,"__esModule",{value:!0}),a.parseString=a.parseFile=a.parseStream=a.parse=a.ParserOptions=a.CsvParserStream=void 0;const l=c(t("fs")),d=t("stream"),f=t("./ParserOptions"),p=t("./CsvParserStream");u(t("./types"),a);var h=t("./CsvParserStream");Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var y=t("./ParserOptions");Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return y.ParserOptions}}),a.parse=g=>new p.CsvParserStream(new f.ParserOptions(g)),a.parseStream=(g,m)=>g.pipe(new p.CsvParserStream(new f.ParserOptions(m))),a.parseFile=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return l.createReadStream(g).pipe(new p.CsvParserStream(new f.ParserOptions(m)))},a.parseString=(g,m)=>{const x=new d.Readable;return x.push(g),x.push(null),x.pipe(new p.CsvParserStream(new f.ParserOptions(m)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;const i=t("./Scanner"),o=t("./RowParser"),c=t("./Token");class u{constructor(d){this.parserOptions=d,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(d){return d&&d.charCodeAt(0)===65279?d.slice(1):d}parse(d,f){const p=new i.Scanner({line:u.removeBOM(d),parserOptions:this.parserOptions,hasMoreData:f});return this.parserOptions.supportsComments?this.parseWithComments(p):this.parseWithoutComments(p)}parseWithoutComments(d){const f=[];let p=!0;for(;p;)p=this.parseRow(d,f);return{line:d.line,rows:f}}parseWithComments(d){const{parserOptions:f}=this,p=[];for(let h=d.nextCharacterToken;h!==null;h=d.nextCharacterToken)if(c.Token.isTokenComment(h,f)){if(d.advancePastLine()===null)return{line:d.lineFromCursor,rows:p};if(!d.hasMoreCharacters)return{line:d.lineFromCursor,rows:p};d.truncateToCursor()}else if(!this.parseRow(d,p))break;return{line:d.line,rows:p}}parseRow(d,f){if(!d.nextNonSpaceToken)return!1;const p=this.rowParser.parse(d);return p!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(p)||f.push(p),!0)}}a.Parser=u},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RowParser=void 0;const i=t("./column"),o=t("./Token");a.RowParser=class{constructor(c){this.parserOptions=c,this.columnParser=new i.ColumnParser(c)}static isEmptyRow(c){return c.join("").replace(/\s+/g,"")===""}parse(c){const{parserOptions:u}=this,{hasMoreData:l}=c,d=c,f=[];let p=this.getStartToken(d,f);for(;p;){if(o.Token.isTokenRowDelimiter(p))return d.advancePastToken(p),!d.hasMoreCharacters&&o.Token.isTokenCarriageReturn(p,u)&&l?null:(d.truncateToCursor(),f);if(!this.shouldSkipColumnParse(d,p,f)){const h=this.columnParser.parse(d);if(h===null)return null;f.push(h)}p=d.nextNonSpaceToken}return l?null:(d.truncateToCursor(),f)}getStartToken(c,u){const l=c.nextNonSpaceToken;return l!==null&&o.Token.isTokenDelimiter(l,this.parserOptions)?(u.push(""),c.nextNonSpaceToken):l}shouldSkipColumnParse(c,u,l){const{parserOptions:d}=this;if(o.Token.isTokenDelimiter(u,d)){c.advancePastToken(u);const f=c.nextCharacterToken;if(!c.hasMoreCharacters||f!==null&&o.Token.isTokenRowDelimiter(f)||f!==null&&o.Token.isTokenDelimiter(f,d))return l.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Scanner=void 0;const i=t("./Token"),o=/((?:\r\n)|\n|\r)/;a.Scanner=class{constructor(c){this.cursor=0,this.line=c.line,this.lineLength=this.line.length,this.parserOptions=c.parserOptions,this.hasMoreData=c.hasMoreData,this.cursor=c.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:c}=this,u=this.parserOptions.NEXT_TOKEN_REGEXP;if(c.search(u)===-1)return null;const l=u.exec(c);if(l==null)return null;const d=l[1],f=this.cursor+(l.index||0);return new i.Token({token:d,startCursor:f,endCursor:f+d.length-1})}get nextCharacterToken(){const{cursor:c,lineLength:u}=this;return u<=c?null:new i.Token({token:this.line[c],startCursor:c,endCursor:c})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const c=o.exec(this.lineFromCursor);return c?(this.cursor+=(c.index||0)+c[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(c){return this.cursor=c,this}advanceToToken(c){return this.cursor=c.startCursor,this}advancePastToken(c){return this.cursor=c.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Token=void 0,a.Token=class{constructor(i){this.token=i.token,this.startCursor=i.startCursor,this.endCursor=i.endCursor}static isTokenRowDelimiter(i){const o=i.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(i,o){return i.token===o.carriageReturn}static isTokenComment(i,o){return o.supportsComments&&!!i&&i.token===o.comment}static isTokenEscapeCharacter(i,o){return i.token===o.escapeChar}static isTokenQuote(i,o){return i.token===o.quote}static isTokenDelimiter(i,o){return i.token===o.delimiter}}},{}],160:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=void 0,a.ColumnFormatter=class{constructor(i){i.trim?this.format=o=>o.trim():i.ltrim?this.format=o=>o.trimLeft():i.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnParser=void 0;const i=t("./NonQuotedColumnParser"),o=t("./QuotedColumnParser"),c=t("../Token");a.ColumnParser=class{constructor(u){this.parserOptions=u,this.quotedColumnParser=new o.QuotedColumnParser(u),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(u)}parse(u){const{nextNonSpaceToken:l}=u;return l!==null&&c.Token.isTokenQuote(l,this.parserOptions)?(u.advanceToToken(l),this.quotedColumnParser.parse(u)):this.nonQuotedColumnParser.parse(u)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.NonQuotedColumnParser=void 0;const i=t("./ColumnFormatter"),o=t("../Token");a.NonQuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new i.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const{parserOptions:u}=this,l=[];let d=c.nextCharacterToken;for(;d&&!o.Token.isTokenDelimiter(d,u)&&!o.Token.isTokenRowDelimiter(d);d=c.nextCharacterToken)l.push(d.token),c.advancePastToken(d);return this.columnFormatter.format(l.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=void 0;const i=t("./ColumnFormatter"),o=t("../Token");a.QuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new i.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const u=c.cursor,{foundClosingQuote:l,col:d}=this.gatherDataBetweenQuotes(c);if(!l){if(c.advanceTo(u),!c.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${c.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(c),d}gatherDataBetweenQuotes(c){const{parserOptions:u}=this;let l=!1,d=!1;const f=[];let p=c.nextCharacterToken;for(;!d&&p!==null;p=c.nextCharacterToken){const h=o.Token.isTokenQuote(p,u);if(!l&&h)l=!0;else if(l)if(o.Token.isTokenEscapeCharacter(p,u)){c.advancePastToken(p);const y=c.nextCharacterToken;y!==null&&(o.Token.isTokenQuote(y,u)||o.Token.isTokenEscapeCharacter(y,u))?(f.push(y.token),p=y):h?d=!0:f.push(p.token)}else h?d=!0:f.push(p.token);c.advancePastToken(p)}return{col:this.columnFormatter.format(f.join("")),foundClosingQuote:d}}checkForMalformedColumn(c){const{parserOptions:u}=this,{nextNonSpaceToken:l}=c;if(l){const d=o.Token.isTokenDelimiter(l,u),f=o.Token.isTokenRowDelimiter(l);if(!d&&!f){const p=c.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${u.escapedDelimiter}' OR new line got: '${l.token}'. at '${p}`)}c.advanceToToken(l)}else c.hasMoreData||c.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=void 0;var i=t("./ColumnParser");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var o=t("./NonQuotedColumnParser");Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var c=t("./QuotedColumnParser");Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}});var u=t("./ColumnFormatter");Object.defineProperty(a,"ColumnFormatter",{enumerable:!0,get:function(){return u.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=a.Token=a.Scanner=a.RowParser=a.Parser=void 0;var i=t("./Parser");Object.defineProperty(a,"Parser",{enumerable:!0,get:function(){return i.Parser}});var o=t("./RowParser");Object.defineProperty(a,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var c=t("./Scanner");Object.defineProperty(a,"Scanner",{enumerable:!0,get:function(){return c.Scanner}});var u=t("./Token");Object.defineProperty(a,"Token",{enumerable:!0,get:function(){return u.Token}});var l=t("./column");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return l.ColumnParser}}),Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return l.NonQuotedColumnParser}}),Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(t,n,a){var i=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=void 0;const o=i(t("lodash.isundefined")),c=i(t("lodash.isfunction")),u=i(t("lodash.uniq")),l=i(t("lodash.groupby"));a.HeaderTransformer=class{constructor(d){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=d,d.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(d.headers)?this.setHeaders(d.headers):c.default(d.headers)&&(this.headersTransform=d.headers)}transform(d,f){return this.shouldMapRow(d)?f(null,this.processRow(d)):f(null,{row:null,isValid:!0})}shouldMapRow(d){const{parserOptions:f}=this;if(!this.headersTransform&&f.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(d)){if(this.headersTransform)this.setHeaders(this.headersTransform(d));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(d)}return!1}return!0}processRow(d){if(!this.headers)return{row:d,isValid:!0};const{parserOptions:f}=this;if(!f.discardUnmappedColumns&&d.length>this.headersLength){if(!f.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${d.length}`);return{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}}return f.strictColumnHandling&&d.length<this.headersLength?{row:d,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${d.length}`}:{row:this.mapHeaders(d),isValid:!0}}mapHeaders(d){const f={},{headers:p,headersLength:h}=this;for(let y=0;y<h;y+=1){const g=p[y];if(!o.default(g)){const m=d[y];o.default(m)?f[g]="":f[g]=m}}return f}setHeaders(d){var f;const p=d.filter(h=>!!h);if(u.default(p).length!==p.length){const h=l.default(p),y=Object.keys(h).filter(g=>h[g].length>1);throw new Error("Duplicate headers found "+JSON.stringify(y))}this.headers=d,this.receivedHeaders=!0,this.headersLength=((f=this.headers)===null||f===void 0?void 0:f.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(t,n,a){var i=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowTransformerValidator=void 0;const o=i(t("lodash.isfunction")),c=t("../types");class u{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(d){return c.isSyncTransform(d)?(f,p)=>{let h=null;try{h=d(f)}catch(y){return p(y)}return p(null,h)}:d}static createValidator(d){return c.isSyncValidate(d)?(f,p)=>{p(null,{row:f,isValid:d(f)})}:(f,p)=>{d(f,(h,y,g)=>h?p(h):p(null,y?{row:f,isValid:y,reason:g}:{row:f,isValid:!1,reason:g}))}}set rowTransform(d){if(!o.default(d))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(d)}set rowValidator(d){if(!o.default(d))throw new TypeError("The validate should be a function");this._rowValidator=u.createValidator(d)}transformAndValidate(d,f){return this.callTransformer(d,(p,h)=>p?f(p):h?this.callValidator(h,(y,g)=>y?f(y):g&&!g.isValid?f(null,{row:h,isValid:!1,reason:g.reason}):f(null,{row:h,isValid:!0})):f(null,{row:null,isValid:!0}))}callTransformer(d,f){return this._rowTransform?this._rowTransform(d,f):f(null,d)}callValidator(d,f){return this._rowValidator?this._rowValidator(d,f):f(null,{row:d,isValid:!0})}}a.RowTransformerValidator=u},{"../types":169,"lodash.isfunction":446}],168:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=a.RowTransformerValidator=void 0;var i=t("./RowTransformerValidator");Object.defineProperty(a,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var o=t("./HeaderTransformer");Object.defineProperty(a,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncValidate=a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1,a.isSyncValidate=i=>i.length===1},{}],170:[function(t,n,a){const i=a;i.bignum=t("bn.js"),i.define=t("./asn1/api").define,i.base=t("./asn1/base"),i.constants=t("./asn1/constants"),i.decoders=t("./asn1/decoders"),i.encoders=t("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(t,n,a){const i=t("./encoders"),o=t("./decoders"),c=t("inherits");function u(l,d){this.name=l,this.body=d,this.decoders={},this.encoders={}}a.define=function(l,d){return new u(l,d)},u.prototype._createNamed=function(l){const d=this.name;function f(p){this._initNamed(p,d)}return c(f,l),f.prototype._initNamed=function(p,h){l.call(this,p,h)},new f(this)},u.prototype._getDecoder=function(l){return l=l||"der",this.decoders.hasOwnProperty(l)||(this.decoders[l]=this._createNamed(o[l])),this.decoders[l]},u.prototype.decode=function(l,d,f){return this._getDecoder(d).decode(l,f)},u.prototype._getEncoder=function(l){return l=l||"der",this.encoders.hasOwnProperty(l)||(this.encoders[l]=this._createNamed(i[l])),this.encoders[l]},u.prototype.encode=function(l,d,f){return this._getEncoder(d).encode(l,f)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(t,n,a){const i=t("inherits"),o=t("../base/reporter").Reporter,c=t("safer-buffer").Buffer;function u(d,f){o.call(this,f),c.isBuffer(d)?(this.base=d,this.offset=0,this.length=d.length):this.error("Input not Buffer")}function l(d,f){if(Array.isArray(d))this.length=0,this.value=d.map((function(p){return l.isEncoderBuffer(p)||(p=new l(p,f)),this.length+=p.length,p}),this);else if(typeof d=="number"){if(!(0<=d&&d<=255))return f.error("non-byte EncoderBuffer value");this.value=d,this.length=1}else if(typeof d=="string")this.value=d,this.length=c.byteLength(d);else{if(!c.isBuffer(d))return f.error("Unsupported type: "+typeof d);this.value=d,this.length=d.length}}i(u,o),a.DecoderBuffer=u,u.isDecoderBuffer=function(d){return d instanceof u?!0:typeof d=="object"&&c.isBuffer(d.base)&&d.constructor.name==="DecoderBuffer"&&typeof d.offset=="number"&&typeof d.length=="number"&&typeof d.save=="function"&&typeof d.restore=="function"&&typeof d.isEmpty=="function"&&typeof d.readUInt8=="function"&&typeof d.skip=="function"&&typeof d.raw=="function"},u.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},u.prototype.restore=function(d){const f=new u(this.base);return f.offset=d.offset,f.length=this.offset,this.offset=d.offset,o.prototype.restore.call(this,d.reporter),f},u.prototype.isEmpty=function(){return this.offset===this.length},u.prototype.readUInt8=function(d){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(d||"DecoderBuffer overrun")},u.prototype.skip=function(d,f){if(!(this.offset+d<=this.length))return this.error(f||"DecoderBuffer overrun");const p=new u(this.base);return p._reporterState=this._reporterState,p.offset=this.offset,p.length=this.offset+d,this.offset+=d,p},u.prototype.raw=function(d){return this.base.slice(d?d.offset:this.offset,this.length)},a.EncoderBuffer=l,l.isEncoderBuffer=function(d){return d instanceof l?!0:typeof d=="object"&&d.constructor.name==="EncoderBuffer"&&typeof d.length=="number"&&typeof d.join=="function"},l.prototype.join=function(d,f){return d||(d=c.alloc(this.length)),f||(f=0),this.length===0||(Array.isArray(this.value)?this.value.forEach((function(p){p.join(d,f),f+=p.length})):(typeof this.value=="number"?d[f]=this.value:typeof this.value=="string"?d.write(this.value,f):c.isBuffer(this.value)&&this.value.copy(d,f),f+=this.length)),d}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(t,n,a){const i=a;i.Reporter=t("./reporter").Reporter,i.DecoderBuffer=t("./buffer").DecoderBuffer,i.EncoderBuffer=t("./buffer").EncoderBuffer,i.Node=t("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(t,n,a){const i=t("../base/reporter").Reporter,o=t("../base/buffer").EncoderBuffer,c=t("../base/buffer").DecoderBuffer,u=t("minimalistic-assert"),l=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],d=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(l);function f(h,y,g){const m={};this._baseState=m,m.name=g,m.enc=h,m.parent=y||null,m.children=null,m.tag=null,m.args=null,m.reverseArgs=null,m.choice=null,m.optional=!1,m.any=!1,m.obj=!1,m.use=null,m.useDecoder=null,m.key=null,m.default=null,m.explicit=null,m.implicit=null,m.contains=null,m.parent||(m.children=[],this._wrap())}n.exports=f;const p=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];f.prototype.clone=function(){const h=this._baseState,y={};p.forEach((function(m){y[m]=h[m]}));const g=new this.constructor(y.parent);return g._baseState=y,g},f.prototype._wrap=function(){const h=this._baseState;d.forEach((function(y){this[y]=function(){const g=new this.constructor(this);return h.children.push(g),g[y].apply(g,arguments)}}),this)},f.prototype._init=function(h){const y=this._baseState;u(y.parent===null),h.call(this),y.children=y.children.filter((function(g){return g._baseState.parent===this}),this),u.equal(y.children.length,1,"Root node can have only one child")},f.prototype._useArgs=function(h){const y=this._baseState,g=h.filter((function(m){return m instanceof this.constructor}),this);h=h.filter((function(m){return!(m instanceof this.constructor)}),this),g.length!==0&&(u(y.children===null),y.children=g,g.forEach((function(m){m._baseState.parent=this}),this)),h.length!==0&&(u(y.args===null),y.args=h,y.reverseArgs=h.map((function(m){if(typeof m!="object"||m.constructor!==Object)return m;const x={};return Object.keys(m).forEach((function(v){v==(0|v)&&(v|=0);const w=m[v];x[w]=v})),x})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(h){f.prototype[h]=function(){const y=this._baseState;throw new Error(h+" not implemented for encoding: "+y.enc)}})),l.forEach((function(h){f.prototype[h]=function(){const y=this._baseState,g=Array.prototype.slice.call(arguments);return u(y.tag===null),y.tag=h,this._useArgs(g),this}})),f.prototype.use=function(h){u(h);const y=this._baseState;return u(y.use===null),y.use=h,this},f.prototype.optional=function(){return this._baseState.optional=!0,this},f.prototype.def=function(h){const y=this._baseState;return u(y.default===null),y.default=h,y.optional=!0,this},f.prototype.explicit=function(h){const y=this._baseState;return u(y.explicit===null&&y.implicit===null),y.explicit=h,this},f.prototype.implicit=function(h){const y=this._baseState;return u(y.explicit===null&&y.implicit===null),y.implicit=h,this},f.prototype.obj=function(){const h=this._baseState,y=Array.prototype.slice.call(arguments);return h.obj=!0,y.length!==0&&this._useArgs(y),this},f.prototype.key=function(h){const y=this._baseState;return u(y.key===null),y.key=h,this},f.prototype.any=function(){return this._baseState.any=!0,this},f.prototype.choice=function(h){const y=this._baseState;return u(y.choice===null),y.choice=h,this._useArgs(Object.keys(h).map((function(g){return h[g]}))),this},f.prototype.contains=function(h){const y=this._baseState;return u(y.use===null),y.contains=h,this},f.prototype._decode=function(h,y){const g=this._baseState;if(g.parent===null)return h.wrapResult(g.children[0]._decode(h,y));let m,x=g.default,v=!0,w=null;if(g.key!==null&&(w=h.enterKey(g.key)),g.optional){let _=null;if(g.explicit!==null?_=g.explicit:g.implicit!==null?_=g.implicit:g.tag!==null&&(_=g.tag),_!==null||g.any){if(v=this._peekTag(h,_,g.any),h.isError(v))return v}else{const A=h.save();try{g.choice===null?this._decodeGeneric(g.tag,h,y):this._decodeChoice(h,y),v=!0}catch{v=!1}h.restore(A)}}if(g.obj&&v&&(m=h.enterObject()),v){if(g.explicit!==null){const A=this._decodeTag(h,g.explicit);if(h.isError(A))return A;h=A}const _=h.offset;if(g.use===null&&g.choice===null){let A;g.any&&(A=h.save());const P=this._decodeTag(h,g.implicit!==null?g.implicit:g.tag,g.any);if(h.isError(P))return P;g.any?x=h.raw(A):h=P}if(y&&y.track&&g.tag!==null&&y.track(h.path(),_,h.length,"tagged"),y&&y.track&&g.tag!==null&&y.track(h.path(),h.offset,h.length,"content"),g.any||(x=g.choice===null?this._decodeGeneric(g.tag,h,y):this._decodeChoice(h,y)),h.isError(x))return x;if(g.any||g.choice!==null||g.children===null||g.children.forEach((function(A){A._decode(h,y)})),g.contains&&(g.tag==="octstr"||g.tag==="bitstr")){const A=new c(x);x=this._getUse(g.contains,h._reporterState.obj)._decode(A,y)}}return g.obj&&v&&(x=h.leaveObject(m)),g.key===null||x===null&&v!==!0?w!==null&&h.exitKey(w):h.leaveKey(w,g.key,x),x},f.prototype._decodeGeneric=function(h,y,g){const m=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(y,h,m.args[0],g):/str$/.test(h)?this._decodeStr(y,h,g):h==="objid"&&m.args?this._decodeObjid(y,m.args[0],m.args[1],g):h==="objid"?this._decodeObjid(y,null,null,g):h==="gentime"||h==="utctime"?this._decodeTime(y,h,g):h==="null_"?this._decodeNull(y,g):h==="bool"?this._decodeBool(y,g):h==="objDesc"?this._decodeStr(y,h,g):h==="int"||h==="enum"?this._decodeInt(y,m.args&&m.args[0],g):m.use!==null?this._getUse(m.use,y._reporterState.obj)._decode(y,g):y.error("unknown tag: "+h)},f.prototype._getUse=function(h,y){const g=this._baseState;return g.useDecoder=this._use(h,y),u(g.useDecoder._baseState.parent===null),g.useDecoder=g.useDecoder._baseState.children[0],g.implicit!==g.useDecoder._baseState.implicit&&(g.useDecoder=g.useDecoder.clone(),g.useDecoder._baseState.implicit=g.implicit),g.useDecoder},f.prototype._decodeChoice=function(h,y){const g=this._baseState;let m=null,x=!1;return Object.keys(g.choice).some((function(v){const w=h.save(),_=g.choice[v];try{const A=_._decode(h,y);if(h.isError(A))return!1;m={type:v,value:A},x=!0}catch{return h.restore(w),!1}return!0}),this),x?m:h.error("Choice not matched")},f.prototype._createEncoderBuffer=function(h){return new o(h,this.reporter)},f.prototype._encode=function(h,y,g){const m=this._baseState;if(m.default!==null&&m.default===h)return;const x=this._encodeValue(h,y,g);return x===void 0||this._skipDefault(x,y,g)?void 0:x},f.prototype._encodeValue=function(h,y,g){const m=this._baseState;if(m.parent===null)return m.children[0]._encode(h,y||new i);let x=null;if(this.reporter=y,m.optional&&h===void 0){if(m.default===null)return;h=m.default}let v=null,w=!1;if(m.any)x=this._createEncoderBuffer(h);else if(m.choice)x=this._encodeChoice(h,y);else if(m.contains)v=this._getUse(m.contains,g)._encode(h,y),w=!0;else if(m.children)v=m.children.map((function(_){if(_._baseState.tag==="null_")return _._encode(null,y,h);if(_._baseState.key===null)return y.error("Child should have a key");const A=y.enterKey(_._baseState.key);if(typeof h!="object")return y.error("Child expected, but input is not object");const P=_._encode(h[_._baseState.key],y,h);return y.leaveKey(A),P}),this).filter((function(_){return _})),v=this._createEncoderBuffer(v);else if(m.tag==="seqof"||m.tag==="setof"){if(!m.args||m.args.length!==1)return y.error("Too many args for : "+m.tag);if(!Array.isArray(h))return y.error("seqof/setof, but data is not Array");const _=this.clone();_._baseState.implicit=null,v=this._createEncoderBuffer(h.map((function(A){const P=this._baseState;return this._getUse(P.args[0],h)._encode(A,y)}),_))}else m.use!==null?x=this._getUse(m.use,g)._encode(h,y):(v=this._encodePrimitive(m.tag,h),w=!0);if(!m.any&&m.choice===null){const _=m.implicit!==null?m.implicit:m.tag,A=m.implicit===null?"universal":"context";_===null?m.use===null&&y.error("Tag could be omitted only for .use()"):m.use===null&&(x=this._encodeComposite(_,w,A,v))}return m.explicit!==null&&(x=this._encodeComposite(m.explicit,!1,"context",x)),x},f.prototype._encodeChoice=function(h,y){const g=this._baseState,m=g.choice[h.type];return m||u(!1,h.type+" not found in "+JSON.stringify(Object.keys(g.choice))),m._encode(h.value,y)},f.prototype._encodePrimitive=function(h,y){const g=this._baseState;if(/str$/.test(h))return this._encodeStr(y,h);if(h==="objid"&&g.args)return this._encodeObjid(y,g.reverseArgs[0],g.args[1]);if(h==="objid")return this._encodeObjid(y,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(y,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(y,g.args&&g.reverseArgs[0]);if(h==="bool")return this._encodeBool(y);if(h==="objDesc")return this._encodeStr(y,h);throw new Error("Unsupported tag: "+h)},f.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},f.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(t,n,a){const i=t("inherits");function o(u){this._reporterState={obj:null,path:[],options:u||{},errors:[]}}function c(u,l){this.path=u,this.rethrow(l)}a.Reporter=o,o.prototype.isError=function(u){return u instanceof c},o.prototype.save=function(){const u=this._reporterState;return{obj:u.obj,pathLen:u.path.length}},o.prototype.restore=function(u){const l=this._reporterState;l.obj=u.obj,l.path=l.path.slice(0,u.pathLen)},o.prototype.enterKey=function(u){return this._reporterState.path.push(u)},o.prototype.exitKey=function(u){const l=this._reporterState;l.path=l.path.slice(0,u-1)},o.prototype.leaveKey=function(u,l,d){const f=this._reporterState;this.exitKey(u),f.obj!==null&&(f.obj[l]=d)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const u=this._reporterState,l=u.obj;return u.obj={},l},o.prototype.leaveObject=function(u){const l=this._reporterState,d=l.obj;return l.obj=u,d},o.prototype.error=function(u){let l;const d=this._reporterState,f=u instanceof c;if(l=f?u:new c(d.path.map((function(p){return"["+JSON.stringify(p)+"]"})).join(""),u.message||u,u.stack),!d.options.partial)throw l;return f||d.errors.push(l),l},o.prototype.wrapResult=function(u){const l=this._reporterState;return l.options.partial?{result:this.isError(u)?null:u,errors:l.errors}:u},i(c,Error),c.prototype.rethrow=function(u){if(this.message=u+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,c),!this.stack)try{throw new Error(this.message)}catch(l){this.stack=l.stack}return this}},{inherits:440}],176:[function(t,n,a){function i(o){const c={};return Object.keys(o).forEach((function(u){(0|u)==u&&(u|=0);const l=o[u];c[l]=u})),c}a.tagClass={0:"universal",1:"application",2:"context",3:"private"},a.tagClassByName=i(a.tagClass),a.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},a.tagByName=i(a.tag)},{}],177:[function(t,n,a){const i=a;i._reverse=function(o){const c={};return Object.keys(o).forEach((function(u){(0|u)==u&&(u|=0);const l=o[u];c[l]=u})),c},i.der=t("./der")},{"./der":176}],178:[function(t,n,a){const i=t("inherits"),o=t("bn.js"),c=t("../base/buffer").DecoderBuffer,u=t("../base/node"),l=t("../constants/der");function d(y){this.enc="der",this.name=y.name,this.entity=y,this.tree=new f,this.tree._init(y.body)}function f(y){u.call(this,"der",y)}function p(y,g){let m=y.readUInt8(g);if(y.isError(m))return m;const x=l.tagClass[m>>6],v=(32&m)==0;if((31&m)==31){let w=m;for(m=0;(128&w)==128;){if(w=y.readUInt8(g),y.isError(w))return w;m<<=7,m|=127&w}}else m&=31;return{cls:x,primitive:v,tag:m,tagStr:l.tag[m]}}function h(y,g,m){let x=y.readUInt8(m);if(y.isError(x))return x;if(!g&&x===128)return null;if((128&x)==0)return x;const v=127&x;if(v>4)return y.error("length octect is too long");x=0;for(let w=0;w<v;w++){x<<=8;const _=y.readUInt8(m);if(y.isError(_))return _;x|=_}return x}n.exports=d,d.prototype.decode=function(y,g){return c.isDecoderBuffer(y)||(y=new c(y,g)),this.tree._decode(y,g)},i(f,u),f.prototype._peekTag=function(y,g,m){if(y.isEmpty())return!1;const x=y.save(),v=p(y,'Failed to peek tag: "'+g+'"');return y.isError(v)?v:(y.restore(x),v.tag===g||v.tagStr===g||v.tagStr+"of"===g||m)},f.prototype._decodeTag=function(y,g,m){const x=p(y,'Failed to decode tag of "'+g+'"');if(y.isError(x))return x;let v=h(y,x.primitive,'Failed to get length of "'+g+'"');if(y.isError(v))return v;if(!m&&x.tag!==g&&x.tagStr!==g&&x.tagStr+"of"!==g)return y.error('Failed to match tag: "'+g+'"');if(x.primitive||v!==null)return y.skip(v,'Failed to match body of: "'+g+'"');const w=y.save(),_=this._skipUntilEnd(y,'Failed to skip indefinite length body: "'+this.tag+'"');return y.isError(_)?_:(v=y.offset-w.offset,y.restore(w),y.skip(v,'Failed to match body of: "'+g+'"'))},f.prototype._skipUntilEnd=function(y,g){for(;;){const m=p(y,g);if(y.isError(m))return m;const x=h(y,m.primitive,g);if(y.isError(x))return x;let v;if(v=m.primitive||x!==null?y.skip(x):this._skipUntilEnd(y,g),y.isError(v))return v;if(m.tagStr==="end")break}},f.prototype._decodeList=function(y,g,m,x){const v=[];for(;!y.isEmpty();){const w=this._peekTag(y,"end");if(y.isError(w))return w;const _=m.decode(y,"der",x);if(y.isError(_)&&w)break;v.push(_)}return v},f.prototype._decodeStr=function(y,g){if(g==="bitstr"){const m=y.readUInt8();return y.isError(m)?m:{unused:m,data:y.raw()}}if(g==="bmpstr"){const m=y.raw();if(m.length%2==1)return y.error("Decoding of string type: bmpstr length mismatch");let x="";for(let v=0;v<m.length/2;v++)x+=String.fromCharCode(m.readUInt16BE(2*v));return x}if(g==="numstr"){const m=y.raw().toString("ascii");return this._isNumstr(m)?m:y.error("Decoding of string type: numstr unsupported characters")}if(g==="octstr"||g==="objDesc")return y.raw();if(g==="printstr"){const m=y.raw().toString("ascii");return this._isPrintstr(m)?m:y.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(g)?y.raw().toString():y.error("Decoding of string type: "+g+" unsupported")},f.prototype._decodeObjid=function(y,g,m){let x;const v=[];let w=0,_=0;for(;!y.isEmpty();)_=y.readUInt8(),w<<=7,w|=127&_,(128&_)==0&&(v.push(w),w=0);128&_&&v.push(w);const A=v[0]/40|0,P=v[0]%40;if(x=m?v:[A,P].concat(v.slice(1)),g){let B=g[x.join(" ")];B===void 0&&(B=g[x.join(".")]),B!==void 0&&(x=B)}return x},f.prototype._decodeTime=function(y,g){const m=y.raw().toString();let x,v,w,_,A,P;if(g==="gentime")x=0|m.slice(0,4),v=0|m.slice(4,6),w=0|m.slice(6,8),_=0|m.slice(8,10),A=0|m.slice(10,12),P=0|m.slice(12,14);else{if(g!=="utctime")return y.error("Decoding "+g+" time is not supported yet");x=0|m.slice(0,2),v=0|m.slice(2,4),w=0|m.slice(4,6),_=0|m.slice(6,8),A=0|m.slice(8,10),P=0|m.slice(10,12),x=x<70?2e3+x:1900+x}return Date.UTC(x,v-1,w,_,A,P,0)},f.prototype._decodeNull=function(){return null},f.prototype._decodeBool=function(y){const g=y.readUInt8();return y.isError(g)?g:g!==0},f.prototype._decodeInt=function(y,g){const m=y.raw();let x=new o(m);return g&&(x=g[x.toString(10)]||x),x},f.prototype._use=function(y,g){return typeof y=="function"&&(y=y(g)),y._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(t,n,a){const i=a;i.der=t("./der"),i.pem=t("./pem")},{"./der":178,"./pem":180}],180:[function(t,n,a){const i=t("inherits"),o=t("safer-buffer").Buffer,c=t("./der");function u(l){c.call(this,l),this.enc="pem"}i(u,c),n.exports=u,u.prototype.decode=function(l,d){const f=l.toString().split(/[\r\n]+/g),p=d.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/;let y=-1,g=-1;for(let v=0;v<f.length;v++){const w=f[v].match(h);if(w!==null&&w[2]===p){if(y!==-1){if(w[1]!=="END")break;g=v;break}if(w[1]!=="BEGIN")break;y=v}}if(y===-1||g===-1)throw new Error("PEM section not found for: "+p);const m=f.slice(y+1,g).join("");m.replace(/[^a-z0-9+/=]+/gi,"");const x=o.from(m,"base64");return c.prototype.decode.call(this,x,d)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(t,n,a){const i=t("inherits"),o=t("safer-buffer").Buffer,c=t("../base/node"),u=t("../constants/der");function l(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new d,this.tree._init(p.body)}function d(p){c.call(this,"der",p)}function f(p){return p<10?"0"+p:p}n.exports=l,l.prototype.encode=function(p,h){return this.tree._encode(p,h).join()},i(d,c),d.prototype._encodeComposite=function(p,h,y,g){const m=(function(w,_,A,P){let B;if(w==="seqof"?w="seq":w==="setof"&&(w="set"),u.tagByName.hasOwnProperty(w))B=u.tagByName[w];else{if(typeof w!="number"||(0|w)!==w)return P.error("Unknown tag: "+w);B=w}return B>=31?P.error("Multi-octet tag encoding unsupported"):(_||(B|=32),B|=u.tagClassByName[A||"universal"]<<6,B)})(p,h,y,this.reporter);if(g.length<128){const w=o.alloc(2);return w[0]=m,w[1]=g.length,this._createEncoderBuffer([w,g])}let x=1;for(let w=g.length;w>=256;w>>=8)x++;const v=o.alloc(2+x);v[0]=m,v[1]=128|x;for(let w=1+x,_=g.length;_>0;w--,_>>=8)v[w]=255&_;return this._createEncoderBuffer([v,g])},d.prototype._encodeStr=function(p,h){if(h==="bitstr")return this._createEncoderBuffer([0|p.unused,p.data]);if(h==="bmpstr"){const y=o.alloc(2*p.length);for(let g=0;g<p.length;g++)y.writeUInt16BE(p.charCodeAt(g),2*g);return this._createEncoderBuffer(y)}return h==="numstr"?this._isNumstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(p)?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(p):this.reporter.error("Encoding of string type: "+h+" unsupported")},d.prototype._encodeObjid=function(p,h,y){if(typeof p=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(p))return this.reporter.error("objid not found in values map");p=h[p].split(/[\s.]+/g);for(let v=0;v<p.length;v++)p[v]|=0}else if(Array.isArray(p)){p=p.slice();for(let v=0;v<p.length;v++)p[v]|=0}if(!Array.isArray(p))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(p));if(!y){if(p[1]>=40)return this.reporter.error("Second objid identifier OOB");p.splice(0,2,40*p[0]+p[1])}let g=0;for(let v=0;v<p.length;v++){let w=p[v];for(g++;w>=128;w>>=7)g++}const m=o.alloc(g);let x=m.length-1;for(let v=p.length-1;v>=0;v--){let w=p[v];for(m[x--]=127&w;(w>>=7)>0;)m[x--]=128|127&w}return this._createEncoderBuffer(m)},d.prototype._encodeTime=function(p,h){let y;const g=new Date(p);return h==="gentime"?y=[f(g.getUTCFullYear()),f(g.getUTCMonth()+1),f(g.getUTCDate()),f(g.getUTCHours()),f(g.getUTCMinutes()),f(g.getUTCSeconds()),"Z"].join(""):h==="utctime"?y=[f(g.getUTCFullYear()%100),f(g.getUTCMonth()+1),f(g.getUTCDate()),f(g.getUTCHours()),f(g.getUTCMinutes()),f(g.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(y,"octstr")},d.prototype._encodeNull=function(){return this._createEncoderBuffer("")},d.prototype._encodeInt=function(p,h){if(typeof p=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(p))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(p));p=h[p]}if(typeof p!="number"&&!o.isBuffer(p)){const m=p.toArray();!p.sign&&128&m[0]&&m.unshift(0),p=o.from(m)}if(o.isBuffer(p)){let m=p.length;p.length===0&&m++;const x=o.alloc(m);return p.copy(x),p.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(p<128)return this._createEncoderBuffer(p);if(p<256)return this._createEncoderBuffer([0,p]);let y=1;for(let m=p;m>=256;m>>=8)y++;const g=new Array(y);for(let m=g.length-1;m>=0;m--)g[m]=255&p,p>>=8;return 128&g[0]&&g.unshift(0),this._createEncoderBuffer(o.from(g))},d.prototype._encodeBool=function(p){return this._createEncoderBuffer(p?255:0)},d.prototype._use=function(p,h){return typeof p=="function"&&(p=p(h)),p._getEncoder("der").tree},d.prototype._skipDefault=function(p,h,y){const g=this._baseState;let m;if(g.default===null)return!1;const x=p.join();if(g.defaultBuffer===void 0&&(g.defaultBuffer=this._encodeValue(g.default,h,y).join()),x.length!==g.defaultBuffer.length)return!1;for(m=0;m<x.length;m++)if(x[m]!==g.defaultBuffer[m])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(t,n,a){const i=a;i.der=t("./der"),i.pem=t("./pem")},{"./der":181,"./pem":183}],183:[function(t,n,a){const i=t("inherits"),o=t("./der");function c(u){o.call(this,u),this.enc="pem"}i(c,o),n.exports=c,c.prototype.encode=function(u,l){const d=o.prototype.encode.call(this,u).toString("base64"),f=["-----BEGIN "+l.label+"-----"];for(let p=0;p<d.length;p+=64)f.push(d.slice(p,p+64));return f.push("-----END "+l.label+"-----"),f.join(`
`)}},{"./der":181,inherits:440}],184:[function(t,n,a){(function(i,o){function c(O,L){if(!O)throw new Error(L||"Assertion failed")}function u(O,L){O.super_=L;var E=function(){};E.prototype=L.prototype,O.prototype=new E,O.prototype.constructor=O}function l(O,L,E){if(l.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&(L!=="le"&&L!=="be"||(E=L,L=10),this._init(O||0,L||10,E||"be"))}var d;typeof i=="object"?i.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function f(O,L){var E=O.charCodeAt(L);return E>=65&&E<=70?E-55:E>=97&&E<=102?E-87:E-48&15}function p(O,L,E){var k=f(O,E);return E-1>=L&&(k|=f(O,E-1)<<4),k}function h(O,L,E,k){for(var N=0,S=Math.min(O.length,E),C=L;C<S;C++){var D=O.charCodeAt(C)-48;N*=k,N+=D>=49?D-49+10:D>=17?D-17+10:D}return N}l.isBN=function(O){return O instanceof l||O!==null&&typeof O=="object"&&O.constructor.wordSize===l.wordSize&&Array.isArray(O.words)},l.max=function(O,L){return O.cmp(L)>0?O:L},l.min=function(O,L){return O.cmp(L)<0?O:L},l.prototype._init=function(O,L,E){if(typeof O=="number")return this._initNumber(O,L,E);if(typeof O=="object")return this._initArray(O,L,E);L==="hex"&&(L=16),c(L===(0|L)&&L>=2&&L<=36);var k=0;(O=O.toString().replace(/\s+/g,""))[0]==="-"&&(k++,this.negative=1),k<O.length&&(L===16?this._parseHex(O,k,E):(this._parseBase(O,L,k),E==="le"&&this._initArray(this.toArray(),L,E)))},l.prototype._initNumber=function(O,L,E){O<0&&(this.negative=1,O=-O),O<67108864?(this.words=[67108863&O],this.length=1):O<4503599627370496?(this.words=[67108863&O,O/67108864&67108863],this.length=2):(c(O<9007199254740992),this.words=[67108863&O,O/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),L,E)},l.prototype._initArray=function(O,L,E){if(c(typeof O.length=="number"),O.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(O.length/3),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var N,S,C=0;if(E==="be")for(k=O.length-1,N=0;k>=0;k-=3)S=O[k]|O[k-1]<<8|O[k-2]<<16,this.words[N]|=S<<C&67108863,this.words[N+1]=S>>>26-C&67108863,(C+=24)>=26&&(C-=26,N++);else if(E==="le")for(k=0,N=0;k<O.length;k+=3)S=O[k]|O[k+1]<<8|O[k+2]<<16,this.words[N]|=S<<C&67108863,this.words[N+1]=S>>>26-C&67108863,(C+=24)>=26&&(C-=26,N++);return this.strip()},l.prototype._parseHex=function(O,L,E){this.length=Math.ceil((O.length-L)/6),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var N,S=0,C=0;if(E==="be")for(k=O.length-1;k>=L;k-=2)N=p(O,L,k)<<S,this.words[C]|=67108863&N,S>=18?(S-=18,C+=1,this.words[C]|=N>>>26):S+=8;else for(k=(O.length-L)%2==0?L+1:L;k<O.length;k+=2)N=p(O,L,k)<<S,this.words[C]|=67108863&N,S>=18?(S-=18,C+=1,this.words[C]|=N>>>26):S+=8;this.strip()},l.prototype._parseBase=function(O,L,E){this.words=[0],this.length=1;for(var k=0,N=1;N<=67108863;N*=L)k++;k--,N=N/L|0;for(var S=O.length-E,C=S%k,D=Math.min(S,S-C)+E,q=0,M=E;M<D;M+=k)q=h(O,M,M+k,L),this.imuln(N),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q);if(C!==0){var G=1;for(q=h(O,M,O.length,L),M=0;M<C;M++)G*=L;this.imuln(G),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q)}this.strip()},l.prototype.copy=function(O){O.words=new Array(this.length);for(var L=0;L<this.length;L++)O.words[L]=this.words[L];O.length=this.length,O.negative=this.negative,O.red=this.red},l.prototype.clone=function(){var O=new l(null);return this.copy(O),O},l.prototype._expand=function(O){for(;this.length<O;)this.words[this.length++]=0;return this},l.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},l.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function x(O,L,E){E.negative=L.negative^O.negative;var k=O.length+L.length|0;E.length=k,k=k-1|0;var N=0|O.words[0],S=0|L.words[0],C=N*S,D=67108863&C,q=C/67108864|0;E.words[0]=D;for(var M=1;M<k;M++){for(var G=q>>>26,X=67108863&q,re=Math.min(M,L.length-1),V=Math.max(0,M-O.length+1);V<=re;V++){var J=M-V|0;G+=(C=(N=0|O.words[J])*(S=0|L.words[V])+X)/67108864|0,X=67108863&C}E.words[M]=0|X,q=0|G}return q!==0?E.words[M]=0|q:E.length--,E.strip()}l.prototype.toString=function(O,L){var E;if(L=0|L||1,(O=O||10)===16||O==="hex"){E="";for(var k=0,N=0,S=0;S<this.length;S++){var C=this.words[S],D=(16777215&(C<<k|N)).toString(16);E=(N=C>>>24-k&16777215)!==0||S!==this.length-1?y[6-D.length]+D+E:D+E,(k+=2)>=26&&(k-=26,S--)}for(N!==0&&(E=N.toString(16)+E);E.length%L!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(O===(0|O)&&O>=2&&O<=36){var q=g[O],M=m[O];E="";var G=this.clone();for(G.negative=0;!G.isZero();){var X=G.modn(M).toString(O);E=(G=G.idivn(M)).isZero()?X+E:y[q-X.length]+X+E}for(this.isZero()&&(E="0"+E);E.length%L!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var O=this.words[0];return this.length===2?O+=67108864*this.words[1]:this.length===3&&this.words[2]===1?O+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-O:O},l.prototype.toJSON=function(){return this.toString(16)},l.prototype.toBuffer=function(O,L){return c(d!==void 0),this.toArrayLike(d,O,L)},l.prototype.toArray=function(O,L){return this.toArrayLike(Array,O,L)},l.prototype.toArrayLike=function(O,L,E){var k=this.byteLength(),N=E||Math.max(1,k);c(k<=N,"byte array longer than desired length"),c(N>0,"Requested array length <= 0"),this.strip();var S,C,D=L==="le",q=new O(N),M=this.clone();if(D){for(C=0;!M.isZero();C++)S=M.andln(255),M.iushrn(8),q[C]=S;for(;C<N;C++)q[C]=0}else{for(C=0;C<N-k;C++)q[C]=0;for(C=0;!M.isZero();C++)S=M.andln(255),M.iushrn(8),q[N-C-1]=S}return q},Math.clz32?l.prototype._countBits=function(O){return 32-Math.clz32(O)}:l.prototype._countBits=function(O){var L=O,E=0;return L>=4096&&(E+=13,L>>>=13),L>=64&&(E+=7,L>>>=7),L>=8&&(E+=4,L>>>=4),L>=2&&(E+=2,L>>>=2),E+L},l.prototype._zeroBits=function(O){if(O===0)return 26;var L=O,E=0;return(8191&L)==0&&(E+=13,L>>>=13),(127&L)==0&&(E+=7,L>>>=7),(15&L)==0&&(E+=4,L>>>=4),(3&L)==0&&(E+=2,L>>>=2),(1&L)==0&&E++,E},l.prototype.bitLength=function(){var O=this.words[this.length-1],L=this._countBits(O);return 26*(this.length-1)+L},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var O=0,L=0;L<this.length;L++){var E=this._zeroBits(this.words[L]);if(O+=E,E!==26)break}return O},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(O){return this.negative!==0?this.abs().inotn(O).iaddn(1):this.clone()},l.prototype.fromTwos=function(O){return this.testn(O-1)?this.notn(O).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(O){for(;this.length<O.length;)this.words[this.length++]=0;for(var L=0;L<O.length;L++)this.words[L]=this.words[L]|O.words[L];return this.strip()},l.prototype.ior=function(O){return c((this.negative|O.negative)==0),this.iuor(O)},l.prototype.or=function(O){return this.length>O.length?this.clone().ior(O):O.clone().ior(this)},l.prototype.uor=function(O){return this.length>O.length?this.clone().iuor(O):O.clone().iuor(this)},l.prototype.iuand=function(O){var L;L=this.length>O.length?O:this;for(var E=0;E<L.length;E++)this.words[E]=this.words[E]&O.words[E];return this.length=L.length,this.strip()},l.prototype.iand=function(O){return c((this.negative|O.negative)==0),this.iuand(O)},l.prototype.and=function(O){return this.length>O.length?this.clone().iand(O):O.clone().iand(this)},l.prototype.uand=function(O){return this.length>O.length?this.clone().iuand(O):O.clone().iuand(this)},l.prototype.iuxor=function(O){var L,E;this.length>O.length?(L=this,E=O):(L=O,E=this);for(var k=0;k<E.length;k++)this.words[k]=L.words[k]^E.words[k];if(this!==L)for(;k<L.length;k++)this.words[k]=L.words[k];return this.length=L.length,this.strip()},l.prototype.ixor=function(O){return c((this.negative|O.negative)==0),this.iuxor(O)},l.prototype.xor=function(O){return this.length>O.length?this.clone().ixor(O):O.clone().ixor(this)},l.prototype.uxor=function(O){return this.length>O.length?this.clone().iuxor(O):O.clone().iuxor(this)},l.prototype.inotn=function(O){c(typeof O=="number"&&O>=0);var L=0|Math.ceil(O/26),E=O%26;this._expand(L),E>0&&L--;for(var k=0;k<L;k++)this.words[k]=67108863&~this.words[k];return E>0&&(this.words[k]=~this.words[k]&67108863>>26-E),this.strip()},l.prototype.notn=function(O){return this.clone().inotn(O)},l.prototype.setn=function(O,L){c(typeof O=="number"&&O>=0);var E=O/26|0,k=O%26;return this._expand(E+1),this.words[E]=L?this.words[E]|1<<k:this.words[E]&~(1<<k),this.strip()},l.prototype.iadd=function(O){var L,E,k;if(this.negative!==0&&O.negative===0)return this.negative=0,L=this.isub(O),this.negative^=1,this._normSign();if(this.negative===0&&O.negative!==0)return O.negative=0,L=this.isub(O),O.negative=1,L._normSign();this.length>O.length?(E=this,k=O):(E=O,k=this);for(var N=0,S=0;S<k.length;S++)L=(0|E.words[S])+(0|k.words[S])+N,this.words[S]=67108863&L,N=L>>>26;for(;N!==0&&S<E.length;S++)L=(0|E.words[S])+N,this.words[S]=67108863&L,N=L>>>26;if(this.length=E.length,N!==0)this.words[this.length]=N,this.length++;else if(E!==this)for(;S<E.length;S++)this.words[S]=E.words[S];return this},l.prototype.add=function(O){var L;return O.negative!==0&&this.negative===0?(O.negative=0,L=this.sub(O),O.negative^=1,L):O.negative===0&&this.negative!==0?(this.negative=0,L=O.sub(this),this.negative=1,L):this.length>O.length?this.clone().iadd(O):O.clone().iadd(this)},l.prototype.isub=function(O){if(O.negative!==0){O.negative=0;var L=this.iadd(O);return O.negative=1,L._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(O),this.negative=1,this._normSign();var E,k,N=this.cmp(O);if(N===0)return this.negative=0,this.length=1,this.words[0]=0,this;N>0?(E=this,k=O):(E=O,k=this);for(var S=0,C=0;C<k.length;C++)S=(L=(0|E.words[C])-(0|k.words[C])+S)>>26,this.words[C]=67108863&L;for(;S!==0&&C<E.length;C++)S=(L=(0|E.words[C])+S)>>26,this.words[C]=67108863&L;if(S===0&&C<E.length&&E!==this)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=Math.max(this.length,C),E!==this&&(this.negative=1),this.strip()},l.prototype.sub=function(O){return this.clone().isub(O)};var v=function(O,L,E){var k,N,S,C=O.words,D=L.words,q=E.words,M=0,G=0|C[0],X=8191&G,re=G>>>13,V=0|C[1],J=8191&V,W=V>>>13,F=0|C[2],Q=8191&F,ne=F>>>13,ie=0|C[3],ce=8191&ie,de=ie>>>13,le=0|C[4],_e=8191&le,ue=le>>>13,pe=0|C[5],me=8191&pe,Ce=pe>>>13,fe=0|C[6],xe=8191&fe,je=fe>>>13,Oe=0|C[7],Ie=8191&Oe,Le=Oe>>>13,He=0|C[8],Qe=8191&He,Je=He>>>13,ct=0|C[9],it=8191&ct,At=ct>>>13,pt=0|D[0],nt=8191&pt,ht=pt>>>13,St=0|D[1],ot=8191&St,Bt=St>>>13,Tt=0|D[2],xt=8191&Tt,Kt=Tt>>>13,Pt=0|D[3],wt=8191&Pt,ar=Pt>>>13,qr=0|D[4],Ft=8191&qr,Er=qr>>>13,zr=0|D[5],vt=8191&zr,Tr=zr>>>13,Wr=0|D[6],Qt=8191&Wr,Me=Wr>>>13,Be=0|D[7],Ze=8191&Be,yt=Be>>>13,Gt=0|D[8],kt=8191&Gt,sr=Gt>>>13,Ut=0|D[9],It=8191&Ut,or=Ut>>>13;E.negative=O.negative^L.negative,E.length=19;var Zt=(M+(k=Math.imul(X,nt))|0)+((8191&(N=(N=Math.imul(X,ht))+Math.imul(re,nt)|0))<<13)|0;M=((S=Math.imul(re,ht))+(N>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,k=Math.imul(J,nt),N=(N=Math.imul(J,ht))+Math.imul(W,nt)|0,S=Math.imul(W,ht);var Nr=(M+(k=k+Math.imul(X,ot)|0)|0)+((8191&(N=(N=N+Math.imul(X,Bt)|0)+Math.imul(re,ot)|0))<<13)|0;M=((S=S+Math.imul(re,Bt)|0)+(N>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,k=Math.imul(Q,nt),N=(N=Math.imul(Q,ht))+Math.imul(ne,nt)|0,S=Math.imul(ne,ht),k=k+Math.imul(J,ot)|0,N=(N=N+Math.imul(J,Bt)|0)+Math.imul(W,ot)|0,S=S+Math.imul(W,Bt)|0;var an=(M+(k=k+Math.imul(X,xt)|0)|0)+((8191&(N=(N=N+Math.imul(X,Kt)|0)+Math.imul(re,xt)|0))<<13)|0;M=((S=S+Math.imul(re,Kt)|0)+(N>>>13)|0)+(an>>>26)|0,an&=67108863,k=Math.imul(ce,nt),N=(N=Math.imul(ce,ht))+Math.imul(de,nt)|0,S=Math.imul(de,ht),k=k+Math.imul(Q,ot)|0,N=(N=N+Math.imul(Q,Bt)|0)+Math.imul(ne,ot)|0,S=S+Math.imul(ne,Bt)|0,k=k+Math.imul(J,xt)|0,N=(N=N+Math.imul(J,Kt)|0)+Math.imul(W,xt)|0,S=S+Math.imul(W,Kt)|0;var Jr=(M+(k=k+Math.imul(X,wt)|0)|0)+((8191&(N=(N=N+Math.imul(X,ar)|0)+Math.imul(re,wt)|0))<<13)|0;M=((S=S+Math.imul(re,ar)|0)+(N>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,k=Math.imul(_e,nt),N=(N=Math.imul(_e,ht))+Math.imul(ue,nt)|0,S=Math.imul(ue,ht),k=k+Math.imul(ce,ot)|0,N=(N=N+Math.imul(ce,Bt)|0)+Math.imul(de,ot)|0,S=S+Math.imul(de,Bt)|0,k=k+Math.imul(Q,xt)|0,N=(N=N+Math.imul(Q,Kt)|0)+Math.imul(ne,xt)|0,S=S+Math.imul(ne,Kt)|0,k=k+Math.imul(J,wt)|0,N=(N=N+Math.imul(J,ar)|0)+Math.imul(W,wt)|0,S=S+Math.imul(W,ar)|0;var Tn=(M+(k=k+Math.imul(X,Ft)|0)|0)+((8191&(N=(N=N+Math.imul(X,Er)|0)+Math.imul(re,Ft)|0))<<13)|0;M=((S=S+Math.imul(re,Er)|0)+(N>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,k=Math.imul(me,nt),N=(N=Math.imul(me,ht))+Math.imul(Ce,nt)|0,S=Math.imul(Ce,ht),k=k+Math.imul(_e,ot)|0,N=(N=N+Math.imul(_e,Bt)|0)+Math.imul(ue,ot)|0,S=S+Math.imul(ue,Bt)|0,k=k+Math.imul(ce,xt)|0,N=(N=N+Math.imul(ce,Kt)|0)+Math.imul(de,xt)|0,S=S+Math.imul(de,Kt)|0,k=k+Math.imul(Q,wt)|0,N=(N=N+Math.imul(Q,ar)|0)+Math.imul(ne,wt)|0,S=S+Math.imul(ne,ar)|0,k=k+Math.imul(J,Ft)|0,N=(N=N+Math.imul(J,Er)|0)+Math.imul(W,Ft)|0,S=S+Math.imul(W,Er)|0;var Pn=(M+(k=k+Math.imul(X,vt)|0)|0)+((8191&(N=(N=N+Math.imul(X,Tr)|0)+Math.imul(re,vt)|0))<<13)|0;M=((S=S+Math.imul(re,Tr)|0)+(N>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,k=Math.imul(xe,nt),N=(N=Math.imul(xe,ht))+Math.imul(je,nt)|0,S=Math.imul(je,ht),k=k+Math.imul(me,ot)|0,N=(N=N+Math.imul(me,Bt)|0)+Math.imul(Ce,ot)|0,S=S+Math.imul(Ce,Bt)|0,k=k+Math.imul(_e,xt)|0,N=(N=N+Math.imul(_e,Kt)|0)+Math.imul(ue,xt)|0,S=S+Math.imul(ue,Kt)|0,k=k+Math.imul(ce,wt)|0,N=(N=N+Math.imul(ce,ar)|0)+Math.imul(de,wt)|0,S=S+Math.imul(de,ar)|0,k=k+Math.imul(Q,Ft)|0,N=(N=N+Math.imul(Q,Er)|0)+Math.imul(ne,Ft)|0,S=S+Math.imul(ne,Er)|0,k=k+Math.imul(J,vt)|0,N=(N=N+Math.imul(J,Tr)|0)+Math.imul(W,vt)|0,S=S+Math.imul(W,Tr)|0;var js=(M+(k=k+Math.imul(X,Qt)|0)|0)+((8191&(N=(N=N+Math.imul(X,Me)|0)+Math.imul(re,Qt)|0))<<13)|0;M=((S=S+Math.imul(re,Me)|0)+(N>>>13)|0)+(js>>>26)|0,js&=67108863,k=Math.imul(Ie,nt),N=(N=Math.imul(Ie,ht))+Math.imul(Le,nt)|0,S=Math.imul(Le,ht),k=k+Math.imul(xe,ot)|0,N=(N=N+Math.imul(xe,Bt)|0)+Math.imul(je,ot)|0,S=S+Math.imul(je,Bt)|0,k=k+Math.imul(me,xt)|0,N=(N=N+Math.imul(me,Kt)|0)+Math.imul(Ce,xt)|0,S=S+Math.imul(Ce,Kt)|0,k=k+Math.imul(_e,wt)|0,N=(N=N+Math.imul(_e,ar)|0)+Math.imul(ue,wt)|0,S=S+Math.imul(ue,ar)|0,k=k+Math.imul(ce,Ft)|0,N=(N=N+Math.imul(ce,Er)|0)+Math.imul(de,Ft)|0,S=S+Math.imul(de,Er)|0,k=k+Math.imul(Q,vt)|0,N=(N=N+Math.imul(Q,Tr)|0)+Math.imul(ne,vt)|0,S=S+Math.imul(ne,Tr)|0,k=k+Math.imul(J,Qt)|0,N=(N=N+Math.imul(J,Me)|0)+Math.imul(W,Qt)|0,S=S+Math.imul(W,Me)|0;var Ee=(M+(k=k+Math.imul(X,Ze)|0)|0)+((8191&(N=(N=N+Math.imul(X,yt)|0)+Math.imul(re,Ze)|0))<<13)|0;M=((S=S+Math.imul(re,yt)|0)+(N>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,k=Math.imul(Qe,nt),N=(N=Math.imul(Qe,ht))+Math.imul(Je,nt)|0,S=Math.imul(Je,ht),k=k+Math.imul(Ie,ot)|0,N=(N=N+Math.imul(Ie,Bt)|0)+Math.imul(Le,ot)|0,S=S+Math.imul(Le,Bt)|0,k=k+Math.imul(xe,xt)|0,N=(N=N+Math.imul(xe,Kt)|0)+Math.imul(je,xt)|0,S=S+Math.imul(je,Kt)|0,k=k+Math.imul(me,wt)|0,N=(N=N+Math.imul(me,ar)|0)+Math.imul(Ce,wt)|0,S=S+Math.imul(Ce,ar)|0,k=k+Math.imul(_e,Ft)|0,N=(N=N+Math.imul(_e,Er)|0)+Math.imul(ue,Ft)|0,S=S+Math.imul(ue,Er)|0,k=k+Math.imul(ce,vt)|0,N=(N=N+Math.imul(ce,Tr)|0)+Math.imul(de,vt)|0,S=S+Math.imul(de,Tr)|0,k=k+Math.imul(Q,Qt)|0,N=(N=N+Math.imul(Q,Me)|0)+Math.imul(ne,Qt)|0,S=S+Math.imul(ne,Me)|0,k=k+Math.imul(J,Ze)|0,N=(N=N+Math.imul(J,yt)|0)+Math.imul(W,Ze)|0,S=S+Math.imul(W,yt)|0;var ze=(M+(k=k+Math.imul(X,kt)|0)|0)+((8191&(N=(N=N+Math.imul(X,sr)|0)+Math.imul(re,kt)|0))<<13)|0;M=((S=S+Math.imul(re,sr)|0)+(N>>>13)|0)+(ze>>>26)|0,ze&=67108863,k=Math.imul(it,nt),N=(N=Math.imul(it,ht))+Math.imul(At,nt)|0,S=Math.imul(At,ht),k=k+Math.imul(Qe,ot)|0,N=(N=N+Math.imul(Qe,Bt)|0)+Math.imul(Je,ot)|0,S=S+Math.imul(Je,Bt)|0,k=k+Math.imul(Ie,xt)|0,N=(N=N+Math.imul(Ie,Kt)|0)+Math.imul(Le,xt)|0,S=S+Math.imul(Le,Kt)|0,k=k+Math.imul(xe,wt)|0,N=(N=N+Math.imul(xe,ar)|0)+Math.imul(je,wt)|0,S=S+Math.imul(je,ar)|0,k=k+Math.imul(me,Ft)|0,N=(N=N+Math.imul(me,Er)|0)+Math.imul(Ce,Ft)|0,S=S+Math.imul(Ce,Er)|0,k=k+Math.imul(_e,vt)|0,N=(N=N+Math.imul(_e,Tr)|0)+Math.imul(ue,vt)|0,S=S+Math.imul(ue,Tr)|0,k=k+Math.imul(ce,Qt)|0,N=(N=N+Math.imul(ce,Me)|0)+Math.imul(de,Qt)|0,S=S+Math.imul(de,Me)|0,k=k+Math.imul(Q,Ze)|0,N=(N=N+Math.imul(Q,yt)|0)+Math.imul(ne,Ze)|0,S=S+Math.imul(ne,yt)|0,k=k+Math.imul(J,kt)|0,N=(N=N+Math.imul(J,sr)|0)+Math.imul(W,kt)|0,S=S+Math.imul(W,sr)|0;var dt=(M+(k=k+Math.imul(X,It)|0)|0)+((8191&(N=(N=N+Math.imul(X,or)|0)+Math.imul(re,It)|0))<<13)|0;M=((S=S+Math.imul(re,or)|0)+(N>>>13)|0)+(dt>>>26)|0,dt&=67108863,k=Math.imul(it,ot),N=(N=Math.imul(it,Bt))+Math.imul(At,ot)|0,S=Math.imul(At,Bt),k=k+Math.imul(Qe,xt)|0,N=(N=N+Math.imul(Qe,Kt)|0)+Math.imul(Je,xt)|0,S=S+Math.imul(Je,Kt)|0,k=k+Math.imul(Ie,wt)|0,N=(N=N+Math.imul(Ie,ar)|0)+Math.imul(Le,wt)|0,S=S+Math.imul(Le,ar)|0,k=k+Math.imul(xe,Ft)|0,N=(N=N+Math.imul(xe,Er)|0)+Math.imul(je,Ft)|0,S=S+Math.imul(je,Er)|0,k=k+Math.imul(me,vt)|0,N=(N=N+Math.imul(me,Tr)|0)+Math.imul(Ce,vt)|0,S=S+Math.imul(Ce,Tr)|0,k=k+Math.imul(_e,Qt)|0,N=(N=N+Math.imul(_e,Me)|0)+Math.imul(ue,Qt)|0,S=S+Math.imul(ue,Me)|0,k=k+Math.imul(ce,Ze)|0,N=(N=N+Math.imul(ce,yt)|0)+Math.imul(de,Ze)|0,S=S+Math.imul(de,yt)|0,k=k+Math.imul(Q,kt)|0,N=(N=N+Math.imul(Q,sr)|0)+Math.imul(ne,kt)|0,S=S+Math.imul(ne,sr)|0;var mt=(M+(k=k+Math.imul(J,It)|0)|0)+((8191&(N=(N=N+Math.imul(J,or)|0)+Math.imul(W,It)|0))<<13)|0;M=((S=S+Math.imul(W,or)|0)+(N>>>13)|0)+(mt>>>26)|0,mt&=67108863,k=Math.imul(it,xt),N=(N=Math.imul(it,Kt))+Math.imul(At,xt)|0,S=Math.imul(At,Kt),k=k+Math.imul(Qe,wt)|0,N=(N=N+Math.imul(Qe,ar)|0)+Math.imul(Je,wt)|0,S=S+Math.imul(Je,ar)|0,k=k+Math.imul(Ie,Ft)|0,N=(N=N+Math.imul(Ie,Er)|0)+Math.imul(Le,Ft)|0,S=S+Math.imul(Le,Er)|0,k=k+Math.imul(xe,vt)|0,N=(N=N+Math.imul(xe,Tr)|0)+Math.imul(je,vt)|0,S=S+Math.imul(je,Tr)|0,k=k+Math.imul(me,Qt)|0,N=(N=N+Math.imul(me,Me)|0)+Math.imul(Ce,Qt)|0,S=S+Math.imul(Ce,Me)|0,k=k+Math.imul(_e,Ze)|0,N=(N=N+Math.imul(_e,yt)|0)+Math.imul(ue,Ze)|0,S=S+Math.imul(ue,yt)|0,k=k+Math.imul(ce,kt)|0,N=(N=N+Math.imul(ce,sr)|0)+Math.imul(de,kt)|0,S=S+Math.imul(de,sr)|0;var Rt=(M+(k=k+Math.imul(Q,It)|0)|0)+((8191&(N=(N=N+Math.imul(Q,or)|0)+Math.imul(ne,It)|0))<<13)|0;M=((S=S+Math.imul(ne,or)|0)+(N>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,k=Math.imul(it,wt),N=(N=Math.imul(it,ar))+Math.imul(At,wt)|0,S=Math.imul(At,ar),k=k+Math.imul(Qe,Ft)|0,N=(N=N+Math.imul(Qe,Er)|0)+Math.imul(Je,Ft)|0,S=S+Math.imul(Je,Er)|0,k=k+Math.imul(Ie,vt)|0,N=(N=N+Math.imul(Ie,Tr)|0)+Math.imul(Le,vt)|0,S=S+Math.imul(Le,Tr)|0,k=k+Math.imul(xe,Qt)|0,N=(N=N+Math.imul(xe,Me)|0)+Math.imul(je,Qt)|0,S=S+Math.imul(je,Me)|0,k=k+Math.imul(me,Ze)|0,N=(N=N+Math.imul(me,yt)|0)+Math.imul(Ce,Ze)|0,S=S+Math.imul(Ce,yt)|0,k=k+Math.imul(_e,kt)|0,N=(N=N+Math.imul(_e,sr)|0)+Math.imul(ue,kt)|0,S=S+Math.imul(ue,sr)|0;var jt=(M+(k=k+Math.imul(ce,It)|0)|0)+((8191&(N=(N=N+Math.imul(ce,or)|0)+Math.imul(de,It)|0))<<13)|0;M=((S=S+Math.imul(de,or)|0)+(N>>>13)|0)+(jt>>>26)|0,jt&=67108863,k=Math.imul(it,Ft),N=(N=Math.imul(it,Er))+Math.imul(At,Ft)|0,S=Math.imul(At,Er),k=k+Math.imul(Qe,vt)|0,N=(N=N+Math.imul(Qe,Tr)|0)+Math.imul(Je,vt)|0,S=S+Math.imul(Je,Tr)|0,k=k+Math.imul(Ie,Qt)|0,N=(N=N+Math.imul(Ie,Me)|0)+Math.imul(Le,Qt)|0,S=S+Math.imul(Le,Me)|0,k=k+Math.imul(xe,Ze)|0,N=(N=N+Math.imul(xe,yt)|0)+Math.imul(je,Ze)|0,S=S+Math.imul(je,yt)|0,k=k+Math.imul(me,kt)|0,N=(N=N+Math.imul(me,sr)|0)+Math.imul(Ce,kt)|0,S=S+Math.imul(Ce,sr)|0;var Ct=(M+(k=k+Math.imul(_e,It)|0)|0)+((8191&(N=(N=N+Math.imul(_e,or)|0)+Math.imul(ue,It)|0))<<13)|0;M=((S=S+Math.imul(ue,or)|0)+(N>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,k=Math.imul(it,vt),N=(N=Math.imul(it,Tr))+Math.imul(At,vt)|0,S=Math.imul(At,Tr),k=k+Math.imul(Qe,Qt)|0,N=(N=N+Math.imul(Qe,Me)|0)+Math.imul(Je,Qt)|0,S=S+Math.imul(Je,Me)|0,k=k+Math.imul(Ie,Ze)|0,N=(N=N+Math.imul(Ie,yt)|0)+Math.imul(Le,Ze)|0,S=S+Math.imul(Le,yt)|0,k=k+Math.imul(xe,kt)|0,N=(N=N+Math.imul(xe,sr)|0)+Math.imul(je,kt)|0,S=S+Math.imul(je,sr)|0;var Dr=(M+(k=k+Math.imul(me,It)|0)|0)+((8191&(N=(N=N+Math.imul(me,or)|0)+Math.imul(Ce,It)|0))<<13)|0;M=((S=S+Math.imul(Ce,or)|0)+(N>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,k=Math.imul(it,Qt),N=(N=Math.imul(it,Me))+Math.imul(At,Qt)|0,S=Math.imul(At,Me),k=k+Math.imul(Qe,Ze)|0,N=(N=N+Math.imul(Qe,yt)|0)+Math.imul(Je,Ze)|0,S=S+Math.imul(Je,yt)|0,k=k+Math.imul(Ie,kt)|0,N=(N=N+Math.imul(Ie,sr)|0)+Math.imul(Le,kt)|0,S=S+Math.imul(Le,sr)|0;var wr=(M+(k=k+Math.imul(xe,It)|0)|0)+((8191&(N=(N=N+Math.imul(xe,or)|0)+Math.imul(je,It)|0))<<13)|0;M=((S=S+Math.imul(je,or)|0)+(N>>>13)|0)+(wr>>>26)|0,wr&=67108863,k=Math.imul(it,Ze),N=(N=Math.imul(it,yt))+Math.imul(At,Ze)|0,S=Math.imul(At,yt),k=k+Math.imul(Qe,kt)|0,N=(N=N+Math.imul(Qe,sr)|0)+Math.imul(Je,kt)|0,S=S+Math.imul(Je,sr)|0;var yr=(M+(k=k+Math.imul(Ie,It)|0)|0)+((8191&(N=(N=N+Math.imul(Ie,or)|0)+Math.imul(Le,It)|0))<<13)|0;M=((S=S+Math.imul(Le,or)|0)+(N>>>13)|0)+(yr>>>26)|0,yr&=67108863,k=Math.imul(it,kt),N=(N=Math.imul(it,sr))+Math.imul(At,kt)|0,S=Math.imul(At,sr);var dr=(M+(k=k+Math.imul(Qe,It)|0)|0)+((8191&(N=(N=N+Math.imul(Qe,or)|0)+Math.imul(Je,It)|0))<<13)|0;M=((S=S+Math.imul(Je,or)|0)+(N>>>13)|0)+(dr>>>26)|0,dr&=67108863;var br=(M+(k=Math.imul(it,It))|0)+((8191&(N=(N=Math.imul(it,or))+Math.imul(At,It)|0))<<13)|0;return M=((S=Math.imul(At,or))+(N>>>13)|0)+(br>>>26)|0,br&=67108863,q[0]=Zt,q[1]=Nr,q[2]=an,q[3]=Jr,q[4]=Tn,q[5]=Pn,q[6]=js,q[7]=Ee,q[8]=ze,q[9]=dt,q[10]=mt,q[11]=Rt,q[12]=jt,q[13]=Ct,q[14]=Dr,q[15]=wr,q[16]=yr,q[17]=dr,q[18]=br,M!==0&&(q[19]=M,E.length++),E};function w(O,L,E){return new _().mulp(O,L,E)}function _(O,L){this.x=O,this.y=L}Math.imul||(v=x),l.prototype.mulTo=function(O,L){var E=this.length+O.length;return this.length===10&&O.length===10?v(this,O,L):E<63?x(this,O,L):E<1024?(function(k,N,S){S.negative=N.negative^k.negative,S.length=k.length+N.length;for(var C=0,D=0,q=0;q<S.length-1;q++){var M=D;D=0;for(var G=67108863&C,X=Math.min(q,N.length-1),re=Math.max(0,q-k.length+1);re<=X;re++){var V=q-re,J=(0|k.words[V])*(0|N.words[re]),W=67108863&J;G=67108863&(W=W+G|0),D+=(M=(M=M+(J/67108864|0)|0)+(W>>>26)|0)>>>26,M&=67108863}S.words[q]=G,C=M,M=D}return C!==0?S.words[q]=C:S.length--,S.strip()})(this,O,L):w(this,O,L)},_.prototype.makeRBT=function(O){for(var L=new Array(O),E=l.prototype._countBits(O)-1,k=0;k<O;k++)L[k]=this.revBin(k,E,O);return L},_.prototype.revBin=function(O,L,E){if(O===0||O===E-1)return O;for(var k=0,N=0;N<L;N++)k|=(1&O)<<L-N-1,O>>=1;return k},_.prototype.permute=function(O,L,E,k,N,S){for(var C=0;C<S;C++)k[C]=L[O[C]],N[C]=E[O[C]]},_.prototype.transform=function(O,L,E,k,N,S){this.permute(S,O,L,E,k,N);for(var C=1;C<N;C<<=1)for(var D=C<<1,q=Math.cos(2*Math.PI/D),M=Math.sin(2*Math.PI/D),G=0;G<N;G+=D)for(var X=q,re=M,V=0;V<C;V++){var J=E[G+V],W=k[G+V],F=E[G+V+C],Q=k[G+V+C],ne=X*F-re*Q;Q=X*Q+re*F,F=ne,E[G+V]=J+F,k[G+V]=W+Q,E[G+V+C]=J-F,k[G+V+C]=W-Q,V!==D&&(ne=q*X-M*re,re=q*re+M*X,X=ne)}},_.prototype.guessLen13b=function(O,L){var E=1|Math.max(L,O),k=1&E,N=0;for(E=E/2|0;E;E>>>=1)N++;return 1<<N+1+k},_.prototype.conjugate=function(O,L,E){if(!(E<=1))for(var k=0;k<E/2;k++){var N=O[k];O[k]=O[E-k-1],O[E-k-1]=N,N=L[k],L[k]=-L[E-k-1],L[E-k-1]=-N}},_.prototype.normalize13b=function(O,L){for(var E=0,k=0;k<L/2;k++){var N=8192*Math.round(O[2*k+1]/L)+Math.round(O[2*k]/L)+E;O[k]=67108863&N,E=N<67108864?0:N/67108864|0}return O},_.prototype.convert13b=function(O,L,E,k){for(var N=0,S=0;S<L;S++)N+=0|O[S],E[2*S]=8191&N,N>>>=13,E[2*S+1]=8191&N,N>>>=13;for(S=2*L;S<k;++S)E[S]=0;c(N===0),c((-8192&N)==0)},_.prototype.stub=function(O){for(var L=new Array(O),E=0;E<O;E++)L[E]=0;return L},_.prototype.mulp=function(O,L,E){var k=2*this.guessLen13b(O.length,L.length),N=this.makeRBT(k),S=this.stub(k),C=new Array(k),D=new Array(k),q=new Array(k),M=new Array(k),G=new Array(k),X=new Array(k),re=E.words;re.length=k,this.convert13b(O.words,O.length,C,k),this.convert13b(L.words,L.length,M,k),this.transform(C,S,D,q,k,N),this.transform(M,S,G,X,k,N);for(var V=0;V<k;V++){var J=D[V]*G[V]-q[V]*X[V];q[V]=D[V]*X[V]+q[V]*G[V],D[V]=J}return this.conjugate(D,q,k),this.transform(D,q,re,S,k,N),this.conjugate(re,S,k),this.normalize13b(re,k),E.negative=O.negative^L.negative,E.length=O.length+L.length,E.strip()},l.prototype.mul=function(O){var L=new l(null);return L.words=new Array(this.length+O.length),this.mulTo(O,L)},l.prototype.mulf=function(O){var L=new l(null);return L.words=new Array(this.length+O.length),w(this,O,L)},l.prototype.imul=function(O){return this.clone().mulTo(O,this)},l.prototype.imuln=function(O){c(typeof O=="number"),c(O<67108864);for(var L=0,E=0;E<this.length;E++){var k=(0|this.words[E])*O,N=(67108863&k)+(67108863&L);L>>=26,L+=k/67108864|0,L+=N>>>26,this.words[E]=67108863&N}return L!==0&&(this.words[E]=L,this.length++),this},l.prototype.muln=function(O){return this.clone().imuln(O)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(O){var L=(function(S){for(var C=new Array(S.bitLength()),D=0;D<C.length;D++){var q=D/26|0,M=D%26;C[D]=(S.words[q]&1<<M)>>>M}return C})(O);if(L.length===0)return new l(1);for(var E=this,k=0;k<L.length&&L[k]===0;k++,E=E.sqr());if(++k<L.length)for(var N=E.sqr();k<L.length;k++,N=N.sqr())L[k]!==0&&(E=E.mul(N));return E},l.prototype.iushln=function(O){c(typeof O=="number"&&O>=0);var L,E=O%26,k=(O-E)/26,N=67108863>>>26-E<<26-E;if(E!==0){var S=0;for(L=0;L<this.length;L++){var C=this.words[L]&N,D=(0|this.words[L])-C<<E;this.words[L]=D|S,S=C>>>26-E}S&&(this.words[L]=S,this.length++)}if(k!==0){for(L=this.length-1;L>=0;L--)this.words[L+k]=this.words[L];for(L=0;L<k;L++)this.words[L]=0;this.length+=k}return this.strip()},l.prototype.ishln=function(O){return c(this.negative===0),this.iushln(O)},l.prototype.iushrn=function(O,L,E){var k;c(typeof O=="number"&&O>=0),k=L?(L-L%26)/26:0;var N=O%26,S=Math.min((O-N)/26,this.length),C=67108863^67108863>>>N<<N,D=E;if(k-=S,k=Math.max(0,k),D){for(var q=0;q<S;q++)D.words[q]=this.words[q];D.length=S}if(S!==0)if(this.length>S)for(this.length-=S,q=0;q<this.length;q++)this.words[q]=this.words[q+S];else this.words[0]=0,this.length=1;var M=0;for(q=this.length-1;q>=0&&(M!==0||q>=k);q--){var G=0|this.words[q];this.words[q]=M<<26-N|G>>>N,M=G&C}return D&&M!==0&&(D.words[D.length++]=M),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},l.prototype.ishrn=function(O,L,E){return c(this.negative===0),this.iushrn(O,L,E)},l.prototype.shln=function(O){return this.clone().ishln(O)},l.prototype.ushln=function(O){return this.clone().iushln(O)},l.prototype.shrn=function(O){return this.clone().ishrn(O)},l.prototype.ushrn=function(O){return this.clone().iushrn(O)},l.prototype.testn=function(O){c(typeof O=="number"&&O>=0);var L=O%26,E=(O-L)/26,k=1<<L;return!(this.length<=E)&&!!(this.words[E]&k)},l.prototype.imaskn=function(O){c(typeof O=="number"&&O>=0);var L=O%26,E=(O-L)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(L!==0&&E++,this.length=Math.min(E,this.length),L!==0){var k=67108863^67108863>>>L<<L;this.words[this.length-1]&=k}return this.strip()},l.prototype.maskn=function(O){return this.clone().imaskn(O)},l.prototype.iaddn=function(O){return c(typeof O=="number"),c(O<67108864),O<0?this.isubn(-O):this.negative!==0?this.length===1&&(0|this.words[0])<O?(this.words[0]=O-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(O),this.negative=1,this):this._iaddn(O)},l.prototype._iaddn=function(O){this.words[0]+=O;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},l.prototype.isubn=function(O){if(c(typeof O=="number"),c(O<67108864),O<0)return this.iaddn(-O);if(this.negative!==0)return this.negative=0,this.iaddn(O),this.negative=1,this;if(this.words[0]-=O,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this.strip()},l.prototype.addn=function(O){return this.clone().iaddn(O)},l.prototype.subn=function(O){return this.clone().isubn(O)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(O,L,E){var k,N,S=O.length+E;this._expand(S);var C=0;for(k=0;k<O.length;k++){N=(0|this.words[k+E])+C;var D=(0|O.words[k])*L;C=((N-=67108863&D)>>26)-(D/67108864|0),this.words[k+E]=67108863&N}for(;k<this.length-E;k++)C=(N=(0|this.words[k+E])+C)>>26,this.words[k+E]=67108863&N;if(C===0)return this.strip();for(c(C===-1),C=0,k=0;k<this.length;k++)C=(N=-(0|this.words[k])+C)>>26,this.words[k]=67108863&N;return this.negative=1,this.strip()},l.prototype._wordDiv=function(O,L){var E=(this.length,O.length),k=this.clone(),N=O,S=0|N.words[N.length-1];(E=26-this._countBits(S))!==0&&(N=N.ushln(E),k.iushln(E),S=0|N.words[N.length-1]);var C,D=k.length-N.length;if(L!=="mod"){(C=new l(null)).length=D+1,C.words=new Array(C.length);for(var q=0;q<C.length;q++)C.words[q]=0}var M=k.clone()._ishlnsubmul(N,1,D);M.negative===0&&(k=M,C&&(C.words[D]=1));for(var G=D-1;G>=0;G--){var X=67108864*(0|k.words[N.length+G])+(0|k.words[N.length+G-1]);for(X=Math.min(X/S|0,67108863),k._ishlnsubmul(N,X,G);k.negative!==0;)X--,k.negative=0,k._ishlnsubmul(N,1,G),k.isZero()||(k.negative^=1);C&&(C.words[G]=X)}return C&&C.strip(),k.strip(),L!=="div"&&E!==0&&k.iushrn(E),{div:C||null,mod:k}},l.prototype.divmod=function(O,L,E){return c(!O.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&O.negative===0?(S=this.neg().divmod(O,L),L!=="mod"&&(k=S.div.neg()),L!=="div"&&(N=S.mod.neg(),E&&N.negative!==0&&N.iadd(O)),{div:k,mod:N}):this.negative===0&&O.negative!==0?(S=this.divmod(O.neg(),L),L!=="mod"&&(k=S.div.neg()),{div:k,mod:S.mod}):(this.negative&O.negative)!=0?(S=this.neg().divmod(O.neg(),L),L!=="div"&&(N=S.mod.neg(),E&&N.negative!==0&&N.isub(O)),{div:S.div,mod:N}):O.length>this.length||this.cmp(O)<0?{div:new l(0),mod:this}:O.length===1?L==="div"?{div:this.divn(O.words[0]),mod:null}:L==="mod"?{div:null,mod:new l(this.modn(O.words[0]))}:{div:this.divn(O.words[0]),mod:new l(this.modn(O.words[0]))}:this._wordDiv(O,L);var k,N,S},l.prototype.div=function(O){return this.divmod(O,"div",!1).div},l.prototype.mod=function(O){return this.divmod(O,"mod",!1).mod},l.prototype.umod=function(O){return this.divmod(O,"mod",!0).mod},l.prototype.divRound=function(O){var L=this.divmod(O);if(L.mod.isZero())return L.div;var E=L.div.negative!==0?L.mod.isub(O):L.mod,k=O.ushrn(1),N=O.andln(1),S=E.cmp(k);return S<0||N===1&&S===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},l.prototype.modn=function(O){c(O<=67108863);for(var L=(1<<26)%O,E=0,k=this.length-1;k>=0;k--)E=(L*E+(0|this.words[k]))%O;return E},l.prototype.idivn=function(O){c(O<=67108863);for(var L=0,E=this.length-1;E>=0;E--){var k=(0|this.words[E])+67108864*L;this.words[E]=k/O|0,L=k%O}return this.strip()},l.prototype.divn=function(O){return this.clone().idivn(O)},l.prototype.egcd=function(O){c(O.negative===0),c(!O.isZero());var L=this,E=O.clone();L=L.negative!==0?L.umod(O):L.clone();for(var k=new l(1),N=new l(0),S=new l(0),C=new l(1),D=0;L.isEven()&&E.isEven();)L.iushrn(1),E.iushrn(1),++D;for(var q=E.clone(),M=L.clone();!L.isZero();){for(var G=0,X=1;(L.words[0]&X)==0&&G<26;++G,X<<=1);if(G>0)for(L.iushrn(G);G-- >0;)(k.isOdd()||N.isOdd())&&(k.iadd(q),N.isub(M)),k.iushrn(1),N.iushrn(1);for(var re=0,V=1;(E.words[0]&V)==0&&re<26;++re,V<<=1);if(re>0)for(E.iushrn(re);re-- >0;)(S.isOdd()||C.isOdd())&&(S.iadd(q),C.isub(M)),S.iushrn(1),C.iushrn(1);L.cmp(E)>=0?(L.isub(E),k.isub(S),N.isub(C)):(E.isub(L),S.isub(k),C.isub(N))}return{a:S,b:C,gcd:E.iushln(D)}},l.prototype._invmp=function(O){c(O.negative===0),c(!O.isZero());var L=this,E=O.clone();L=L.negative!==0?L.umod(O):L.clone();for(var k,N=new l(1),S=new l(0),C=E.clone();L.cmpn(1)>0&&E.cmpn(1)>0;){for(var D=0,q=1;(L.words[0]&q)==0&&D<26;++D,q<<=1);if(D>0)for(L.iushrn(D);D-- >0;)N.isOdd()&&N.iadd(C),N.iushrn(1);for(var M=0,G=1;(E.words[0]&G)==0&&M<26;++M,G<<=1);if(M>0)for(E.iushrn(M);M-- >0;)S.isOdd()&&S.iadd(C),S.iushrn(1);L.cmp(E)>=0?(L.isub(E),N.isub(S)):(E.isub(L),S.isub(N))}return(k=L.cmpn(1)===0?N:S).cmpn(0)<0&&k.iadd(O),k},l.prototype.gcd=function(O){if(this.isZero())return O.abs();if(O.isZero())return this.abs();var L=this.clone(),E=O.clone();L.negative=0,E.negative=0;for(var k=0;L.isEven()&&E.isEven();k++)L.iushrn(1),E.iushrn(1);for(;;){for(;L.isEven();)L.iushrn(1);for(;E.isEven();)E.iushrn(1);var N=L.cmp(E);if(N<0){var S=L;L=E,E=S}else if(N===0||E.cmpn(1)===0)break;L.isub(E)}return E.iushln(k)},l.prototype.invm=function(O){return this.egcd(O).a.umod(O)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(O){return this.words[0]&O},l.prototype.bincn=function(O){c(typeof O=="number");var L=O%26,E=(O-L)/26,k=1<<L;if(this.length<=E)return this._expand(E+1),this.words[E]|=k,this;for(var N=k,S=E;N!==0&&S<this.length;S++){var C=0|this.words[S];N=(C+=N)>>>26,C&=67108863,this.words[S]=C}return N!==0&&(this.words[S]=N,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(O){var L,E=O<0;if(this.negative!==0&&!E)return-1;if(this.negative===0&&E)return 1;if(this.strip(),this.length>1)L=1;else{E&&(O=-O),c(O<=67108863,"Number is too big");var k=0|this.words[0];L=k===O?0:k<O?-1:1}return this.negative!==0?0|-L:L},l.prototype.cmp=function(O){if(this.negative!==0&&O.negative===0)return-1;if(this.negative===0&&O.negative!==0)return 1;var L=this.ucmp(O);return this.negative!==0?0|-L:L},l.prototype.ucmp=function(O){if(this.length>O.length)return 1;if(this.length<O.length)return-1;for(var L=0,E=this.length-1;E>=0;E--){var k=0|this.words[E],N=0|O.words[E];if(k!==N){k<N?L=-1:k>N&&(L=1);break}}return L},l.prototype.gtn=function(O){return this.cmpn(O)===1},l.prototype.gt=function(O){return this.cmp(O)===1},l.prototype.gten=function(O){return this.cmpn(O)>=0},l.prototype.gte=function(O){return this.cmp(O)>=0},l.prototype.ltn=function(O){return this.cmpn(O)===-1},l.prototype.lt=function(O){return this.cmp(O)===-1},l.prototype.lten=function(O){return this.cmpn(O)<=0},l.prototype.lte=function(O){return this.cmp(O)<=0},l.prototype.eqn=function(O){return this.cmpn(O)===0},l.prototype.eq=function(O){return this.cmp(O)===0},l.red=function(O){return new H(O)},l.prototype.toRed=function(O){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),O.convertTo(this)._forceRed(O)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(O){return this.red=O,this},l.prototype.forceRed=function(O){return c(!this.red,"Already a number in reduction context"),this._forceRed(O)},l.prototype.redAdd=function(O){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,O)},l.prototype.redIAdd=function(O){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,O)},l.prototype.redSub=function(O){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,O)},l.prototype.redISub=function(O){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,O)},l.prototype.redShl=function(O){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,O)},l.prototype.redMul=function(O){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.mul(this,O)},l.prototype.redIMul=function(O){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.imul(this,O)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(O){return c(this.red&&!O.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,O)};var A={k256:null,p224:null,p192:null,p25519:null};function P(O,L){this.name=O,this.p=new l(L,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function B(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function H(O){if(typeof O=="string"){var L=l._prime(O);this.m=L.p,this.prime=L}else c(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}function z(O){H.call(this,O),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}P.prototype._tmp=function(){var O=new l(null);return O.words=new Array(Math.ceil(this.n/13)),O},P.prototype.ireduce=function(O){var L,E=O;do this.split(E,this.tmp),L=(E=(E=this.imulK(E)).iadd(this.tmp)).bitLength();while(L>this.n);var k=L<this.n?-1:E.ucmp(this.p);return k===0?(E.words[0]=0,E.length=1):k>0?E.isub(this.p):E.strip!==void 0?E.strip():E._strip(),E},P.prototype.split=function(O,L){O.iushrn(this.n,0,L)},P.prototype.imulK=function(O){return O.imul(this.k)},u(B,P),B.prototype.split=function(O,L){for(var E=Math.min(O.length,9),k=0;k<E;k++)L.words[k]=O.words[k];if(L.length=E,O.length<=9)return O.words[0]=0,void(O.length=1);var N=O.words[9];for(L.words[L.length++]=4194303&N,k=10;k<O.length;k++){var S=0|O.words[k];O.words[k-10]=(4194303&S)<<4|N>>>22,N=S}N>>>=22,O.words[k-10]=N,N===0&&O.length>10?O.length-=10:O.length-=9},B.prototype.imulK=function(O){O.words[O.length]=0,O.words[O.length+1]=0,O.length+=2;for(var L=0,E=0;E<O.length;E++){var k=0|O.words[E];L+=977*k,O.words[E]=67108863&L,L=64*k+(L/67108864|0)}return O.words[O.length-1]===0&&(O.length--,O.words[O.length-1]===0&&O.length--),O},u(T,P),u(I,P),u(U,P),U.prototype.imulK=function(O){for(var L=0,E=0;E<O.length;E++){var k=19*(0|O.words[E])+L,N=67108863&k;k>>>=26,O.words[E]=N,L=k}return L!==0&&(O.words[O.length++]=L),O},l._prime=function(O){if(A[O])return A[O];var L;if(O==="k256")L=new B;else if(O==="p224")L=new T;else if(O==="p192")L=new I;else{if(O!=="p25519")throw new Error("Unknown prime "+O);L=new U}return A[O]=L,L},H.prototype._verify1=function(O){c(O.negative===0,"red works only with positives"),c(O.red,"red works only with red numbers")},H.prototype._verify2=function(O,L){c((O.negative|L.negative)==0,"red works only with positives"),c(O.red&&O.red===L.red,"red works only with red numbers")},H.prototype.imod=function(O){return this.prime?this.prime.ireduce(O)._forceRed(this):O.umod(this.m)._forceRed(this)},H.prototype.neg=function(O){return O.isZero()?O.clone():this.m.sub(O)._forceRed(this)},H.prototype.add=function(O,L){this._verify2(O,L);var E=O.add(L);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},H.prototype.iadd=function(O,L){this._verify2(O,L);var E=O.iadd(L);return E.cmp(this.m)>=0&&E.isub(this.m),E},H.prototype.sub=function(O,L){this._verify2(O,L);var E=O.sub(L);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},H.prototype.isub=function(O,L){this._verify2(O,L);var E=O.isub(L);return E.cmpn(0)<0&&E.iadd(this.m),E},H.prototype.shl=function(O,L){return this._verify1(O),this.imod(O.ushln(L))},H.prototype.imul=function(O,L){return this._verify2(O,L),this.imod(O.imul(L))},H.prototype.mul=function(O,L){return this._verify2(O,L),this.imod(O.mul(L))},H.prototype.isqr=function(O){return this.imul(O,O.clone())},H.prototype.sqr=function(O){return this.mul(O,O)},H.prototype.sqrt=function(O){if(O.isZero())return O.clone();var L=this.m.andln(3);if(c(L%2==1),L===3){var E=this.m.add(new l(1)).iushrn(2);return this.pow(O,E)}for(var k=this.m.subn(1),N=0;!k.isZero()&&k.andln(1)===0;)N++,k.iushrn(1);c(!k.isZero());var S=new l(1).toRed(this),C=S.redNeg(),D=this.m.subn(1).iushrn(1),q=this.m.bitLength();for(q=new l(2*q*q).toRed(this);this.pow(q,D).cmp(C)!==0;)q.redIAdd(C);for(var M=this.pow(q,k),G=this.pow(O,k.addn(1).iushrn(1)),X=this.pow(O,k),re=N;X.cmp(S)!==0;){for(var V=X,J=0;V.cmp(S)!==0;J++)V=V.redSqr();c(J<re);var W=this.pow(M,new l(1).iushln(re-J-1));G=G.redMul(W),M=W.redSqr(),X=X.redMul(M),re=J}return G},H.prototype.invm=function(O){var L=O._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},H.prototype.pow=function(O,L){if(L.isZero())return new l(1).toRed(this);if(L.cmpn(1)===0)return O.clone();var E=new Array(16);E[0]=new l(1).toRed(this),E[1]=O;for(var k=2;k<E.length;k++)E[k]=this.mul(E[k-1],O);var N=E[0],S=0,C=0,D=L.bitLength()%26;for(D===0&&(D=26),k=L.length-1;k>=0;k--){for(var q=L.words[k],M=D-1;M>=0;M--){var G=q>>M&1;N!==E[0]&&(N=this.sqr(N)),G!==0||S!==0?(S<<=1,S|=G,(++C===4||k===0&&M===0)&&(N=this.mul(N,E[S]),C=0,S=0)):C=0}D=26}return N},H.prototype.convertTo=function(O){var L=O.umod(this.m);return L===O?L.clone():L},H.prototype.convertFrom=function(O){var L=O.clone();return L.red=null,L},l.mont=function(O){return new z(O)},u(z,H),z.prototype.convertTo=function(O){return this.imod(O.ushln(this.shift))},z.prototype.convertFrom=function(O){var L=this.imod(O.mul(this.rinv));return L.red=null,L},z.prototype.imul=function(O,L){if(O.isZero()||L.isZero())return O.words[0]=0,O.length=1,O;var E=O.imul(L),k=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=E.isub(k).iushrn(this.shift),S=N;return N.cmp(this.m)>=0?S=N.isub(this.m):N.cmpn(0)<0&&(S=N.iadd(this.m)),S._forceRed(this)},z.prototype.mul=function(O,L){if(O.isZero()||L.isZero())return new l(0)._forceRed(this);var E=O.mul(L),k=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=E.isub(k).iushrn(this.shift),S=N;return N.cmp(this.m)>=0?S=N.isub(this.m):N.cmpn(0)<0&&(S=N.iadd(this.m)),S._forceRed(this)},z.prototype.invm=function(O){return this.imod(O._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(t,n,a){a.byteLength=function(h){var y=f(h),g=y[0],m=y[1];return 3*(g+m)/4-m},a.toByteArray=function(h){var y,g,m=f(h),x=m[0],v=m[1],w=new c((function(P,B,T){return 3*(B+T)/4-T})(0,x,v)),_=0,A=v>0?x-4:x;for(g=0;g<A;g+=4)y=o[h.charCodeAt(g)]<<18|o[h.charCodeAt(g+1)]<<12|o[h.charCodeAt(g+2)]<<6|o[h.charCodeAt(g+3)],w[_++]=y>>16&255,w[_++]=y>>8&255,w[_++]=255&y;return v===2&&(y=o[h.charCodeAt(g)]<<2|o[h.charCodeAt(g+1)]>>4,w[_++]=255&y),v===1&&(y=o[h.charCodeAt(g)]<<10|o[h.charCodeAt(g+1)]<<4|o[h.charCodeAt(g+2)]>>2,w[_++]=y>>8&255,w[_++]=255&y),w},a.fromByteArray=function(h){for(var y,g=h.length,m=g%3,x=[],v=0,w=g-m;v<w;v+=16383)x.push(p(h,v,v+16383>w?w:v+16383));return m===1?(y=h[g-1],x.push(i[y>>2]+i[y<<4&63]+"==")):m===2&&(y=(h[g-2]<<8)+h[g-1],x.push(i[y>>10]+i[y>>4&63]+i[y<<2&63]+"=")),x.join("")};for(var i=[],o=[],c=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,d=u.length;l<d;++l)i[l]=u[l],o[u.charCodeAt(l)]=l;function f(h){var y=h.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=h.indexOf("=");return g===-1&&(g=y),[g,g===y?0:4-g%4]}function p(h,y,g){for(var m,x,v=[],w=y;w<g;w+=3)m=(h[w]<<16&16711680)+(h[w+1]<<8&65280)+(255&h[w+2]),v.push(i[(x=m)>>18&63]+i[x>>12&63]+i[x>>6&63]+i[63&x]);return v.join("")}o[45]=62,o[95]=63},{}],186:[function(t,n,a){(function(i,o){function c(E,k){if(!E)throw new Error(k||"Assertion failed")}function u(E,k){E.super_=k;var N=function(){};N.prototype=k.prototype,E.prototype=new N,E.prototype.constructor=E}function l(E,k,N){if(l.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&(k!=="le"&&k!=="be"||(N=k,k=10),this._init(E||0,k||10,N||"be"))}var d;typeof i=="object"?i.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{d=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:t("buffer").Buffer}catch{}function f(E,k){var N=E.charCodeAt(k);return N>=48&&N<=57?N-48:N>=65&&N<=70?N-55:N>=97&&N<=102?N-87:void c(!1,"Invalid character in "+E)}function p(E,k,N){var S=f(E,N);return N-1>=k&&(S|=f(E,N-1)<<4),S}function h(E,k,N,S){for(var C=0,D=0,q=Math.min(E.length,N),M=k;M<q;M++){var G=E.charCodeAt(M)-48;C*=S,D=G>=49?G-49+10:G>=17?G-17+10:G,c(G>=0&&D<S,"Invalid character"),C+=D}return C}function y(E,k){E.words=k.words,E.length=k.length,E.negative=k.negative,E.red=k.red}if(l.isBN=function(E){return E instanceof l||E!==null&&typeof E=="object"&&E.constructor.wordSize===l.wordSize&&Array.isArray(E.words)},l.max=function(E,k){return E.cmp(k)>0?E:k},l.min=function(E,k){return E.cmp(k)<0?E:k},l.prototype._init=function(E,k,N){if(typeof E=="number")return this._initNumber(E,k,N);if(typeof E=="object")return this._initArray(E,k,N);k==="hex"&&(k=16),c(k===(0|k)&&k>=2&&k<=36);var S=0;(E=E.toString().replace(/\s+/g,""))[0]==="-"&&(S++,this.negative=1),S<E.length&&(k===16?this._parseHex(E,S,N):(this._parseBase(E,k,S),N==="le"&&this._initArray(this.toArray(),k,N)))},l.prototype._initNumber=function(E,k,N){E<0&&(this.negative=1,E=-E),E<67108864?(this.words=[67108863&E],this.length=1):E<4503599627370496?(this.words=[67108863&E,E/67108864&67108863],this.length=2):(c(E<9007199254740992),this.words=[67108863&E,E/67108864&67108863,1],this.length=3),N==="le"&&this._initArray(this.toArray(),k,N)},l.prototype._initArray=function(E,k,N){if(c(typeof E.length=="number"),E.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(E.length/3),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var C,D,q=0;if(N==="be")for(S=E.length-1,C=0;S>=0;S-=3)D=E[S]|E[S-1]<<8|E[S-2]<<16,this.words[C]|=D<<q&67108863,this.words[C+1]=D>>>26-q&67108863,(q+=24)>=26&&(q-=26,C++);else if(N==="le")for(S=0,C=0;S<E.length;S+=3)D=E[S]|E[S+1]<<8|E[S+2]<<16,this.words[C]|=D<<q&67108863,this.words[C+1]=D>>>26-q&67108863,(q+=24)>=26&&(q-=26,C++);return this._strip()},l.prototype._parseHex=function(E,k,N){this.length=Math.ceil((E.length-k)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var C,D=0,q=0;if(N==="be")for(S=E.length-1;S>=k;S-=2)C=p(E,k,S)<<D,this.words[q]|=67108863&C,D>=18?(D-=18,q+=1,this.words[q]|=C>>>26):D+=8;else for(S=(E.length-k)%2==0?k+1:k;S<E.length;S+=2)C=p(E,k,S)<<D,this.words[q]|=67108863&C,D>=18?(D-=18,q+=1,this.words[q]|=C>>>26):D+=8;this._strip()},l.prototype._parseBase=function(E,k,N){this.words=[0],this.length=1;for(var S=0,C=1;C<=67108863;C*=k)S++;S--,C=C/k|0;for(var D=E.length-N,q=D%S,M=Math.min(D,D-q)+N,G=0,X=N;X<M;X+=S)G=h(E,X,X+S,k),this.imuln(C),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(q!==0){var re=1;for(G=h(E,X,E.length,k),X=0;X<q;X++)re*=k;this.imuln(re),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this._strip()},l.prototype.copy=function(E){E.words=new Array(this.length);for(var k=0;k<this.length;k++)E.words[k]=this.words[k];E.length=this.length,E.negative=this.negative,E.red=this.red},l.prototype._move=function(E){y(E,this)},l.prototype.clone=function(){var E=new l(null);return this.copy(E),E},l.prototype._expand=function(E){for(;this.length<E;)this.words[this.length++]=0;return this},l.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{l.prototype[Symbol.for("nodejs.util.inspect.custom")]=g}catch{l.prototype.inspect=g}else l.prototype.inspect=g;function g(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];l.prototype.toString=function(E,k){var N;if(k=0|k||1,(E=E||10)===16||E==="hex"){N="";for(var S=0,C=0,D=0;D<this.length;D++){var q=this.words[D],M=(16777215&(q<<S|C)).toString(16);C=q>>>24-S&16777215,(S+=2)>=26&&(S-=26,D--),N=C!==0||D!==this.length-1?m[6-M.length]+M+N:M+N}for(C!==0&&(N=C.toString(16)+N);N.length%k!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}if(E===(0|E)&&E>=2&&E<=36){var G=x[E],X=v[E];N="";var re=this.clone();for(re.negative=0;!re.isZero();){var V=re.modrn(X).toString(E);N=(re=re.idivn(X)).isZero()?V+N:m[G-V.length]+V+N}for(this.isZero()&&(N="0"+N);N.length%k!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var E=this.words[0];return this.length===2?E+=67108864*this.words[1]:this.length===3&&this.words[2]===1?E+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-E:E},l.prototype.toJSON=function(){return this.toString(16,2)},d&&(l.prototype.toBuffer=function(E,k){return this.toArrayLike(d,E,k)}),l.prototype.toArray=function(E,k){return this.toArrayLike(Array,E,k)};function w(E,k,N){N.negative=k.negative^E.negative;var S=E.length+k.length|0;N.length=S,S=S-1|0;var C=0|E.words[0],D=0|k.words[0],q=C*D,M=67108863&q,G=q/67108864|0;N.words[0]=M;for(var X=1;X<S;X++){for(var re=G>>>26,V=67108863&G,J=Math.min(X,k.length-1),W=Math.max(0,X-E.length+1);W<=J;W++){var F=X-W|0;re+=(q=(C=0|E.words[F])*(D=0|k.words[W])+V)/67108864|0,V=67108863&q}N.words[X]=0|V,G=0|re}return G!==0?N.words[X]=0|G:N.length--,N._strip()}l.prototype.toArrayLike=function(E,k,N){this._strip();var S=this.byteLength(),C=N||Math.max(1,S);c(S<=C,"byte array longer than desired length"),c(C>0,"Requested array length <= 0");var D=(function(q,M){return q.allocUnsafe?q.allocUnsafe(M):new q(M)})(E,C);return this["_toArrayLike"+(k==="le"?"LE":"BE")](D,S),D},l.prototype._toArrayLikeLE=function(E,k){for(var N=0,S=0,C=0,D=0;C<this.length;C++){var q=this.words[C]<<D|S;E[N++]=255&q,N<E.length&&(E[N++]=q>>8&255),N<E.length&&(E[N++]=q>>16&255),D===6?(N<E.length&&(E[N++]=q>>24&255),S=0,D=0):(S=q>>>24,D+=2)}if(N<E.length)for(E[N++]=S;N<E.length;)E[N++]=0},l.prototype._toArrayLikeBE=function(E,k){for(var N=E.length-1,S=0,C=0,D=0;C<this.length;C++){var q=this.words[C]<<D|S;E[N--]=255&q,N>=0&&(E[N--]=q>>8&255),N>=0&&(E[N--]=q>>16&255),D===6?(N>=0&&(E[N--]=q>>24&255),S=0,D=0):(S=q>>>24,D+=2)}if(N>=0)for(E[N--]=S;N>=0;)E[N--]=0},Math.clz32?l.prototype._countBits=function(E){return 32-Math.clz32(E)}:l.prototype._countBits=function(E){var k=E,N=0;return k>=4096&&(N+=13,k>>>=13),k>=64&&(N+=7,k>>>=7),k>=8&&(N+=4,k>>>=4),k>=2&&(N+=2,k>>>=2),N+k},l.prototype._zeroBits=function(E){if(E===0)return 26;var k=E,N=0;return(8191&k)==0&&(N+=13,k>>>=13),(127&k)==0&&(N+=7,k>>>=7),(15&k)==0&&(N+=4,k>>>=4),(3&k)==0&&(N+=2,k>>>=2),(1&k)==0&&N++,N},l.prototype.bitLength=function(){var E=this.words[this.length-1],k=this._countBits(E);return 26*(this.length-1)+k},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var E=0,k=0;k<this.length;k++){var N=this._zeroBits(this.words[k]);if(E+=N,N!==26)break}return E},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(E){return this.negative!==0?this.abs().inotn(E).iaddn(1):this.clone()},l.prototype.fromTwos=function(E){return this.testn(E-1)?this.notn(E).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(E){for(;this.length<E.length;)this.words[this.length++]=0;for(var k=0;k<E.length;k++)this.words[k]=this.words[k]|E.words[k];return this._strip()},l.prototype.ior=function(E){return c((this.negative|E.negative)==0),this.iuor(E)},l.prototype.or=function(E){return this.length>E.length?this.clone().ior(E):E.clone().ior(this)},l.prototype.uor=function(E){return this.length>E.length?this.clone().iuor(E):E.clone().iuor(this)},l.prototype.iuand=function(E){var k;k=this.length>E.length?E:this;for(var N=0;N<k.length;N++)this.words[N]=this.words[N]&E.words[N];return this.length=k.length,this._strip()},l.prototype.iand=function(E){return c((this.negative|E.negative)==0),this.iuand(E)},l.prototype.and=function(E){return this.length>E.length?this.clone().iand(E):E.clone().iand(this)},l.prototype.uand=function(E){return this.length>E.length?this.clone().iuand(E):E.clone().iuand(this)},l.prototype.iuxor=function(E){var k,N;this.length>E.length?(k=this,N=E):(k=E,N=this);for(var S=0;S<N.length;S++)this.words[S]=k.words[S]^N.words[S];if(this!==k)for(;S<k.length;S++)this.words[S]=k.words[S];return this.length=k.length,this._strip()},l.prototype.ixor=function(E){return c((this.negative|E.negative)==0),this.iuxor(E)},l.prototype.xor=function(E){return this.length>E.length?this.clone().ixor(E):E.clone().ixor(this)},l.prototype.uxor=function(E){return this.length>E.length?this.clone().iuxor(E):E.clone().iuxor(this)},l.prototype.inotn=function(E){c(typeof E=="number"&&E>=0);var k=0|Math.ceil(E/26),N=E%26;this._expand(k),N>0&&k--;for(var S=0;S<k;S++)this.words[S]=67108863&~this.words[S];return N>0&&(this.words[S]=~this.words[S]&67108863>>26-N),this._strip()},l.prototype.notn=function(E){return this.clone().inotn(E)},l.prototype.setn=function(E,k){c(typeof E=="number"&&E>=0);var N=E/26|0,S=E%26;return this._expand(N+1),this.words[N]=k?this.words[N]|1<<S:this.words[N]&~(1<<S),this._strip()},l.prototype.iadd=function(E){var k,N,S;if(this.negative!==0&&E.negative===0)return this.negative=0,k=this.isub(E),this.negative^=1,this._normSign();if(this.negative===0&&E.negative!==0)return E.negative=0,k=this.isub(E),E.negative=1,k._normSign();this.length>E.length?(N=this,S=E):(N=E,S=this);for(var C=0,D=0;D<S.length;D++)k=(0|N.words[D])+(0|S.words[D])+C,this.words[D]=67108863&k,C=k>>>26;for(;C!==0&&D<N.length;D++)k=(0|N.words[D])+C,this.words[D]=67108863&k,C=k>>>26;if(this.length=N.length,C!==0)this.words[this.length]=C,this.length++;else if(N!==this)for(;D<N.length;D++)this.words[D]=N.words[D];return this},l.prototype.add=function(E){var k;return E.negative!==0&&this.negative===0?(E.negative=0,k=this.sub(E),E.negative^=1,k):E.negative===0&&this.negative!==0?(this.negative=0,k=E.sub(this),this.negative=1,k):this.length>E.length?this.clone().iadd(E):E.clone().iadd(this)},l.prototype.isub=function(E){if(E.negative!==0){E.negative=0;var k=this.iadd(E);return E.negative=1,k._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(E),this.negative=1,this._normSign();var N,S,C=this.cmp(E);if(C===0)return this.negative=0,this.length=1,this.words[0]=0,this;C>0?(N=this,S=E):(N=E,S=this);for(var D=0,q=0;q<S.length;q++)D=(k=(0|N.words[q])-(0|S.words[q])+D)>>26,this.words[q]=67108863&k;for(;D!==0&&q<N.length;q++)D=(k=(0|N.words[q])+D)>>26,this.words[q]=67108863&k;if(D===0&&q<N.length&&N!==this)for(;q<N.length;q++)this.words[q]=N.words[q];return this.length=Math.max(this.length,q),N!==this&&(this.negative=1),this._strip()},l.prototype.sub=function(E){return this.clone().isub(E)};var _=function(E,k,N){var S,C,D,q=E.words,M=k.words,G=N.words,X=0,re=0|q[0],V=8191&re,J=re>>>13,W=0|q[1],F=8191&W,Q=W>>>13,ne=0|q[2],ie=8191&ne,ce=ne>>>13,de=0|q[3],le=8191&de,_e=de>>>13,ue=0|q[4],pe=8191&ue,me=ue>>>13,Ce=0|q[5],fe=8191&Ce,xe=Ce>>>13,je=0|q[6],Oe=8191&je,Ie=je>>>13,Le=0|q[7],He=8191&Le,Qe=Le>>>13,Je=0|q[8],ct=8191&Je,it=Je>>>13,At=0|q[9],pt=8191&At,nt=At>>>13,ht=0|M[0],St=8191&ht,ot=ht>>>13,Bt=0|M[1],Tt=8191&Bt,xt=Bt>>>13,Kt=0|M[2],Pt=8191&Kt,wt=Kt>>>13,ar=0|M[3],qr=8191&ar,Ft=ar>>>13,Er=0|M[4],zr=8191&Er,vt=Er>>>13,Tr=0|M[5],Wr=8191&Tr,Qt=Tr>>>13,Me=0|M[6],Be=8191&Me,Ze=Me>>>13,yt=0|M[7],Gt=8191&yt,kt=yt>>>13,sr=0|M[8],Ut=8191&sr,It=sr>>>13,or=0|M[9],Zt=8191&or,Nr=or>>>13;N.negative=E.negative^k.negative,N.length=19;var an=(X+(S=Math.imul(V,St))|0)+((8191&(C=(C=Math.imul(V,ot))+Math.imul(J,St)|0))<<13)|0;X=((D=Math.imul(J,ot))+(C>>>13)|0)+(an>>>26)|0,an&=67108863,S=Math.imul(F,St),C=(C=Math.imul(F,ot))+Math.imul(Q,St)|0,D=Math.imul(Q,ot);var Jr=(X+(S=S+Math.imul(V,Tt)|0)|0)+((8191&(C=(C=C+Math.imul(V,xt)|0)+Math.imul(J,Tt)|0))<<13)|0;X=((D=D+Math.imul(J,xt)|0)+(C>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,S=Math.imul(ie,St),C=(C=Math.imul(ie,ot))+Math.imul(ce,St)|0,D=Math.imul(ce,ot),S=S+Math.imul(F,Tt)|0,C=(C=C+Math.imul(F,xt)|0)+Math.imul(Q,Tt)|0,D=D+Math.imul(Q,xt)|0;var Tn=(X+(S=S+Math.imul(V,Pt)|0)|0)+((8191&(C=(C=C+Math.imul(V,wt)|0)+Math.imul(J,Pt)|0))<<13)|0;X=((D=D+Math.imul(J,wt)|0)+(C>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,S=Math.imul(le,St),C=(C=Math.imul(le,ot))+Math.imul(_e,St)|0,D=Math.imul(_e,ot),S=S+Math.imul(ie,Tt)|0,C=(C=C+Math.imul(ie,xt)|0)+Math.imul(ce,Tt)|0,D=D+Math.imul(ce,xt)|0,S=S+Math.imul(F,Pt)|0,C=(C=C+Math.imul(F,wt)|0)+Math.imul(Q,Pt)|0,D=D+Math.imul(Q,wt)|0;var Pn=(X+(S=S+Math.imul(V,qr)|0)|0)+((8191&(C=(C=C+Math.imul(V,Ft)|0)+Math.imul(J,qr)|0))<<13)|0;X=((D=D+Math.imul(J,Ft)|0)+(C>>>13)|0)+(Pn>>>26)|0,Pn&=67108863,S=Math.imul(pe,St),C=(C=Math.imul(pe,ot))+Math.imul(me,St)|0,D=Math.imul(me,ot),S=S+Math.imul(le,Tt)|0,C=(C=C+Math.imul(le,xt)|0)+Math.imul(_e,Tt)|0,D=D+Math.imul(_e,xt)|0,S=S+Math.imul(ie,Pt)|0,C=(C=C+Math.imul(ie,wt)|0)+Math.imul(ce,Pt)|0,D=D+Math.imul(ce,wt)|0,S=S+Math.imul(F,qr)|0,C=(C=C+Math.imul(F,Ft)|0)+Math.imul(Q,qr)|0,D=D+Math.imul(Q,Ft)|0;var js=(X+(S=S+Math.imul(V,zr)|0)|0)+((8191&(C=(C=C+Math.imul(V,vt)|0)+Math.imul(J,zr)|0))<<13)|0;X=((D=D+Math.imul(J,vt)|0)+(C>>>13)|0)+(js>>>26)|0,js&=67108863,S=Math.imul(fe,St),C=(C=Math.imul(fe,ot))+Math.imul(xe,St)|0,D=Math.imul(xe,ot),S=S+Math.imul(pe,Tt)|0,C=(C=C+Math.imul(pe,xt)|0)+Math.imul(me,Tt)|0,D=D+Math.imul(me,xt)|0,S=S+Math.imul(le,Pt)|0,C=(C=C+Math.imul(le,wt)|0)+Math.imul(_e,Pt)|0,D=D+Math.imul(_e,wt)|0,S=S+Math.imul(ie,qr)|0,C=(C=C+Math.imul(ie,Ft)|0)+Math.imul(ce,qr)|0,D=D+Math.imul(ce,Ft)|0,S=S+Math.imul(F,zr)|0,C=(C=C+Math.imul(F,vt)|0)+Math.imul(Q,zr)|0,D=D+Math.imul(Q,vt)|0;var Ee=(X+(S=S+Math.imul(V,Wr)|0)|0)+((8191&(C=(C=C+Math.imul(V,Qt)|0)+Math.imul(J,Wr)|0))<<13)|0;X=((D=D+Math.imul(J,Qt)|0)+(C>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,S=Math.imul(Oe,St),C=(C=Math.imul(Oe,ot))+Math.imul(Ie,St)|0,D=Math.imul(Ie,ot),S=S+Math.imul(fe,Tt)|0,C=(C=C+Math.imul(fe,xt)|0)+Math.imul(xe,Tt)|0,D=D+Math.imul(xe,xt)|0,S=S+Math.imul(pe,Pt)|0,C=(C=C+Math.imul(pe,wt)|0)+Math.imul(me,Pt)|0,D=D+Math.imul(me,wt)|0,S=S+Math.imul(le,qr)|0,C=(C=C+Math.imul(le,Ft)|0)+Math.imul(_e,qr)|0,D=D+Math.imul(_e,Ft)|0,S=S+Math.imul(ie,zr)|0,C=(C=C+Math.imul(ie,vt)|0)+Math.imul(ce,zr)|0,D=D+Math.imul(ce,vt)|0,S=S+Math.imul(F,Wr)|0,C=(C=C+Math.imul(F,Qt)|0)+Math.imul(Q,Wr)|0,D=D+Math.imul(Q,Qt)|0;var ze=(X+(S=S+Math.imul(V,Be)|0)|0)+((8191&(C=(C=C+Math.imul(V,Ze)|0)+Math.imul(J,Be)|0))<<13)|0;X=((D=D+Math.imul(J,Ze)|0)+(C>>>13)|0)+(ze>>>26)|0,ze&=67108863,S=Math.imul(He,St),C=(C=Math.imul(He,ot))+Math.imul(Qe,St)|0,D=Math.imul(Qe,ot),S=S+Math.imul(Oe,Tt)|0,C=(C=C+Math.imul(Oe,xt)|0)+Math.imul(Ie,Tt)|0,D=D+Math.imul(Ie,xt)|0,S=S+Math.imul(fe,Pt)|0,C=(C=C+Math.imul(fe,wt)|0)+Math.imul(xe,Pt)|0,D=D+Math.imul(xe,wt)|0,S=S+Math.imul(pe,qr)|0,C=(C=C+Math.imul(pe,Ft)|0)+Math.imul(me,qr)|0,D=D+Math.imul(me,Ft)|0,S=S+Math.imul(le,zr)|0,C=(C=C+Math.imul(le,vt)|0)+Math.imul(_e,zr)|0,D=D+Math.imul(_e,vt)|0,S=S+Math.imul(ie,Wr)|0,C=(C=C+Math.imul(ie,Qt)|0)+Math.imul(ce,Wr)|0,D=D+Math.imul(ce,Qt)|0,S=S+Math.imul(F,Be)|0,C=(C=C+Math.imul(F,Ze)|0)+Math.imul(Q,Be)|0,D=D+Math.imul(Q,Ze)|0;var dt=(X+(S=S+Math.imul(V,Gt)|0)|0)+((8191&(C=(C=C+Math.imul(V,kt)|0)+Math.imul(J,Gt)|0))<<13)|0;X=((D=D+Math.imul(J,kt)|0)+(C>>>13)|0)+(dt>>>26)|0,dt&=67108863,S=Math.imul(ct,St),C=(C=Math.imul(ct,ot))+Math.imul(it,St)|0,D=Math.imul(it,ot),S=S+Math.imul(He,Tt)|0,C=(C=C+Math.imul(He,xt)|0)+Math.imul(Qe,Tt)|0,D=D+Math.imul(Qe,xt)|0,S=S+Math.imul(Oe,Pt)|0,C=(C=C+Math.imul(Oe,wt)|0)+Math.imul(Ie,Pt)|0,D=D+Math.imul(Ie,wt)|0,S=S+Math.imul(fe,qr)|0,C=(C=C+Math.imul(fe,Ft)|0)+Math.imul(xe,qr)|0,D=D+Math.imul(xe,Ft)|0,S=S+Math.imul(pe,zr)|0,C=(C=C+Math.imul(pe,vt)|0)+Math.imul(me,zr)|0,D=D+Math.imul(me,vt)|0,S=S+Math.imul(le,Wr)|0,C=(C=C+Math.imul(le,Qt)|0)+Math.imul(_e,Wr)|0,D=D+Math.imul(_e,Qt)|0,S=S+Math.imul(ie,Be)|0,C=(C=C+Math.imul(ie,Ze)|0)+Math.imul(ce,Be)|0,D=D+Math.imul(ce,Ze)|0,S=S+Math.imul(F,Gt)|0,C=(C=C+Math.imul(F,kt)|0)+Math.imul(Q,Gt)|0,D=D+Math.imul(Q,kt)|0;var mt=(X+(S=S+Math.imul(V,Ut)|0)|0)+((8191&(C=(C=C+Math.imul(V,It)|0)+Math.imul(J,Ut)|0))<<13)|0;X=((D=D+Math.imul(J,It)|0)+(C>>>13)|0)+(mt>>>26)|0,mt&=67108863,S=Math.imul(pt,St),C=(C=Math.imul(pt,ot))+Math.imul(nt,St)|0,D=Math.imul(nt,ot),S=S+Math.imul(ct,Tt)|0,C=(C=C+Math.imul(ct,xt)|0)+Math.imul(it,Tt)|0,D=D+Math.imul(it,xt)|0,S=S+Math.imul(He,Pt)|0,C=(C=C+Math.imul(He,wt)|0)+Math.imul(Qe,Pt)|0,D=D+Math.imul(Qe,wt)|0,S=S+Math.imul(Oe,qr)|0,C=(C=C+Math.imul(Oe,Ft)|0)+Math.imul(Ie,qr)|0,D=D+Math.imul(Ie,Ft)|0,S=S+Math.imul(fe,zr)|0,C=(C=C+Math.imul(fe,vt)|0)+Math.imul(xe,zr)|0,D=D+Math.imul(xe,vt)|0,S=S+Math.imul(pe,Wr)|0,C=(C=C+Math.imul(pe,Qt)|0)+Math.imul(me,Wr)|0,D=D+Math.imul(me,Qt)|0,S=S+Math.imul(le,Be)|0,C=(C=C+Math.imul(le,Ze)|0)+Math.imul(_e,Be)|0,D=D+Math.imul(_e,Ze)|0,S=S+Math.imul(ie,Gt)|0,C=(C=C+Math.imul(ie,kt)|0)+Math.imul(ce,Gt)|0,D=D+Math.imul(ce,kt)|0,S=S+Math.imul(F,Ut)|0,C=(C=C+Math.imul(F,It)|0)+Math.imul(Q,Ut)|0,D=D+Math.imul(Q,It)|0;var Rt=(X+(S=S+Math.imul(V,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(V,Nr)|0)+Math.imul(J,Zt)|0))<<13)|0;X=((D=D+Math.imul(J,Nr)|0)+(C>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,S=Math.imul(pt,Tt),C=(C=Math.imul(pt,xt))+Math.imul(nt,Tt)|0,D=Math.imul(nt,xt),S=S+Math.imul(ct,Pt)|0,C=(C=C+Math.imul(ct,wt)|0)+Math.imul(it,Pt)|0,D=D+Math.imul(it,wt)|0,S=S+Math.imul(He,qr)|0,C=(C=C+Math.imul(He,Ft)|0)+Math.imul(Qe,qr)|0,D=D+Math.imul(Qe,Ft)|0,S=S+Math.imul(Oe,zr)|0,C=(C=C+Math.imul(Oe,vt)|0)+Math.imul(Ie,zr)|0,D=D+Math.imul(Ie,vt)|0,S=S+Math.imul(fe,Wr)|0,C=(C=C+Math.imul(fe,Qt)|0)+Math.imul(xe,Wr)|0,D=D+Math.imul(xe,Qt)|0,S=S+Math.imul(pe,Be)|0,C=(C=C+Math.imul(pe,Ze)|0)+Math.imul(me,Be)|0,D=D+Math.imul(me,Ze)|0,S=S+Math.imul(le,Gt)|0,C=(C=C+Math.imul(le,kt)|0)+Math.imul(_e,Gt)|0,D=D+Math.imul(_e,kt)|0,S=S+Math.imul(ie,Ut)|0,C=(C=C+Math.imul(ie,It)|0)+Math.imul(ce,Ut)|0,D=D+Math.imul(ce,It)|0;var jt=(X+(S=S+Math.imul(F,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(F,Nr)|0)+Math.imul(Q,Zt)|0))<<13)|0;X=((D=D+Math.imul(Q,Nr)|0)+(C>>>13)|0)+(jt>>>26)|0,jt&=67108863,S=Math.imul(pt,Pt),C=(C=Math.imul(pt,wt))+Math.imul(nt,Pt)|0,D=Math.imul(nt,wt),S=S+Math.imul(ct,qr)|0,C=(C=C+Math.imul(ct,Ft)|0)+Math.imul(it,qr)|0,D=D+Math.imul(it,Ft)|0,S=S+Math.imul(He,zr)|0,C=(C=C+Math.imul(He,vt)|0)+Math.imul(Qe,zr)|0,D=D+Math.imul(Qe,vt)|0,S=S+Math.imul(Oe,Wr)|0,C=(C=C+Math.imul(Oe,Qt)|0)+Math.imul(Ie,Wr)|0,D=D+Math.imul(Ie,Qt)|0,S=S+Math.imul(fe,Be)|0,C=(C=C+Math.imul(fe,Ze)|0)+Math.imul(xe,Be)|0,D=D+Math.imul(xe,Ze)|0,S=S+Math.imul(pe,Gt)|0,C=(C=C+Math.imul(pe,kt)|0)+Math.imul(me,Gt)|0,D=D+Math.imul(me,kt)|0,S=S+Math.imul(le,Ut)|0,C=(C=C+Math.imul(le,It)|0)+Math.imul(_e,Ut)|0,D=D+Math.imul(_e,It)|0;var Ct=(X+(S=S+Math.imul(ie,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(ie,Nr)|0)+Math.imul(ce,Zt)|0))<<13)|0;X=((D=D+Math.imul(ce,Nr)|0)+(C>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,S=Math.imul(pt,qr),C=(C=Math.imul(pt,Ft))+Math.imul(nt,qr)|0,D=Math.imul(nt,Ft),S=S+Math.imul(ct,zr)|0,C=(C=C+Math.imul(ct,vt)|0)+Math.imul(it,zr)|0,D=D+Math.imul(it,vt)|0,S=S+Math.imul(He,Wr)|0,C=(C=C+Math.imul(He,Qt)|0)+Math.imul(Qe,Wr)|0,D=D+Math.imul(Qe,Qt)|0,S=S+Math.imul(Oe,Be)|0,C=(C=C+Math.imul(Oe,Ze)|0)+Math.imul(Ie,Be)|0,D=D+Math.imul(Ie,Ze)|0,S=S+Math.imul(fe,Gt)|0,C=(C=C+Math.imul(fe,kt)|0)+Math.imul(xe,Gt)|0,D=D+Math.imul(xe,kt)|0,S=S+Math.imul(pe,Ut)|0,C=(C=C+Math.imul(pe,It)|0)+Math.imul(me,Ut)|0,D=D+Math.imul(me,It)|0;var Dr=(X+(S=S+Math.imul(le,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(le,Nr)|0)+Math.imul(_e,Zt)|0))<<13)|0;X=((D=D+Math.imul(_e,Nr)|0)+(C>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,S=Math.imul(pt,zr),C=(C=Math.imul(pt,vt))+Math.imul(nt,zr)|0,D=Math.imul(nt,vt),S=S+Math.imul(ct,Wr)|0,C=(C=C+Math.imul(ct,Qt)|0)+Math.imul(it,Wr)|0,D=D+Math.imul(it,Qt)|0,S=S+Math.imul(He,Be)|0,C=(C=C+Math.imul(He,Ze)|0)+Math.imul(Qe,Be)|0,D=D+Math.imul(Qe,Ze)|0,S=S+Math.imul(Oe,Gt)|0,C=(C=C+Math.imul(Oe,kt)|0)+Math.imul(Ie,Gt)|0,D=D+Math.imul(Ie,kt)|0,S=S+Math.imul(fe,Ut)|0,C=(C=C+Math.imul(fe,It)|0)+Math.imul(xe,Ut)|0,D=D+Math.imul(xe,It)|0;var wr=(X+(S=S+Math.imul(pe,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(pe,Nr)|0)+Math.imul(me,Zt)|0))<<13)|0;X=((D=D+Math.imul(me,Nr)|0)+(C>>>13)|0)+(wr>>>26)|0,wr&=67108863,S=Math.imul(pt,Wr),C=(C=Math.imul(pt,Qt))+Math.imul(nt,Wr)|0,D=Math.imul(nt,Qt),S=S+Math.imul(ct,Be)|0,C=(C=C+Math.imul(ct,Ze)|0)+Math.imul(it,Be)|0,D=D+Math.imul(it,Ze)|0,S=S+Math.imul(He,Gt)|0,C=(C=C+Math.imul(He,kt)|0)+Math.imul(Qe,Gt)|0,D=D+Math.imul(Qe,kt)|0,S=S+Math.imul(Oe,Ut)|0,C=(C=C+Math.imul(Oe,It)|0)+Math.imul(Ie,Ut)|0,D=D+Math.imul(Ie,It)|0;var yr=(X+(S=S+Math.imul(fe,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(fe,Nr)|0)+Math.imul(xe,Zt)|0))<<13)|0;X=((D=D+Math.imul(xe,Nr)|0)+(C>>>13)|0)+(yr>>>26)|0,yr&=67108863,S=Math.imul(pt,Be),C=(C=Math.imul(pt,Ze))+Math.imul(nt,Be)|0,D=Math.imul(nt,Ze),S=S+Math.imul(ct,Gt)|0,C=(C=C+Math.imul(ct,kt)|0)+Math.imul(it,Gt)|0,D=D+Math.imul(it,kt)|0,S=S+Math.imul(He,Ut)|0,C=(C=C+Math.imul(He,It)|0)+Math.imul(Qe,Ut)|0,D=D+Math.imul(Qe,It)|0;var dr=(X+(S=S+Math.imul(Oe,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(Oe,Nr)|0)+Math.imul(Ie,Zt)|0))<<13)|0;X=((D=D+Math.imul(Ie,Nr)|0)+(C>>>13)|0)+(dr>>>26)|0,dr&=67108863,S=Math.imul(pt,Gt),C=(C=Math.imul(pt,kt))+Math.imul(nt,Gt)|0,D=Math.imul(nt,kt),S=S+Math.imul(ct,Ut)|0,C=(C=C+Math.imul(ct,It)|0)+Math.imul(it,Ut)|0,D=D+Math.imul(it,It)|0;var br=(X+(S=S+Math.imul(He,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(He,Nr)|0)+Math.imul(Qe,Zt)|0))<<13)|0;X=((D=D+Math.imul(Qe,Nr)|0)+(C>>>13)|0)+(br>>>26)|0,br&=67108863,S=Math.imul(pt,Ut),C=(C=Math.imul(pt,It))+Math.imul(nt,Ut)|0,D=Math.imul(nt,It);var Yr=(X+(S=S+Math.imul(ct,Zt)|0)|0)+((8191&(C=(C=C+Math.imul(ct,Nr)|0)+Math.imul(it,Zt)|0))<<13)|0;X=((D=D+Math.imul(it,Nr)|0)+(C>>>13)|0)+(Yr>>>26)|0,Yr&=67108863;var ln=(X+(S=Math.imul(pt,Zt))|0)+((8191&(C=(C=Math.imul(pt,Nr))+Math.imul(nt,Zt)|0))<<13)|0;return X=((D=Math.imul(nt,Nr))+(C>>>13)|0)+(ln>>>26)|0,ln&=67108863,G[0]=an,G[1]=Jr,G[2]=Tn,G[3]=Pn,G[4]=js,G[5]=Ee,G[6]=ze,G[7]=dt,G[8]=mt,G[9]=Rt,G[10]=jt,G[11]=Ct,G[12]=Dr,G[13]=wr,G[14]=yr,G[15]=dr,G[16]=br,G[17]=Yr,G[18]=ln,X!==0&&(G[19]=X,N.length++),N};function A(E,k,N){N.negative=k.negative^E.negative,N.length=E.length+k.length;for(var S=0,C=0,D=0;D<N.length-1;D++){var q=C;C=0;for(var M=67108863&S,G=Math.min(D,k.length-1),X=Math.max(0,D-E.length+1);X<=G;X++){var re=D-X,V=(0|E.words[re])*(0|k.words[X]),J=67108863&V;M=67108863&(J=J+M|0),C+=(q=(q=q+(V/67108864|0)|0)+(J>>>26)|0)>>>26,q&=67108863}N.words[D]=M,S=q,q=C}return S!==0?N.words[D]=S:N.length--,N._strip()}function P(E,k,N){return A(E,k,N)}Math.imul||(_=w),l.prototype.mulTo=function(E,k){var N=this.length+E.length;return this.length===10&&E.length===10?_(this,E,k):N<63?w(this,E,k):N<1024?A(this,E,k):P(this,E,k)},l.prototype.mul=function(E){var k=new l(null);return k.words=new Array(this.length+E.length),this.mulTo(E,k)},l.prototype.mulf=function(E){var k=new l(null);return k.words=new Array(this.length+E.length),P(this,E,k)},l.prototype.imul=function(E){return this.clone().mulTo(E,this)},l.prototype.imuln=function(E){var k=E<0;k&&(E=-E),c(typeof E=="number"),c(E<67108864);for(var N=0,S=0;S<this.length;S++){var C=(0|this.words[S])*E,D=(67108863&C)+(67108863&N);N>>=26,N+=C/67108864|0,N+=D>>>26,this.words[S]=67108863&D}return N!==0&&(this.words[S]=N,this.length++),k?this.ineg():this},l.prototype.muln=function(E){return this.clone().imuln(E)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(E){var k=(function(D){for(var q=new Array(D.bitLength()),M=0;M<q.length;M++){var G=M/26|0,X=M%26;q[M]=D.words[G]>>>X&1}return q})(E);if(k.length===0)return new l(1);for(var N=this,S=0;S<k.length&&k[S]===0;S++,N=N.sqr());if(++S<k.length)for(var C=N.sqr();S<k.length;S++,C=C.sqr())k[S]!==0&&(N=N.mul(C));return N},l.prototype.iushln=function(E){c(typeof E=="number"&&E>=0);var k,N=E%26,S=(E-N)/26,C=67108863>>>26-N<<26-N;if(N!==0){var D=0;for(k=0;k<this.length;k++){var q=this.words[k]&C,M=(0|this.words[k])-q<<N;this.words[k]=M|D,D=q>>>26-N}D&&(this.words[k]=D,this.length++)}if(S!==0){for(k=this.length-1;k>=0;k--)this.words[k+S]=this.words[k];for(k=0;k<S;k++)this.words[k]=0;this.length+=S}return this._strip()},l.prototype.ishln=function(E){return c(this.negative===0),this.iushln(E)},l.prototype.iushrn=function(E,k,N){var S;c(typeof E=="number"&&E>=0),S=k?(k-k%26)/26:0;var C=E%26,D=Math.min((E-C)/26,this.length),q=67108863^67108863>>>C<<C,M=N;if(S-=D,S=Math.max(0,S),M){for(var G=0;G<D;G++)M.words[G]=this.words[G];M.length=D}if(D!==0)if(this.length>D)for(this.length-=D,G=0;G<this.length;G++)this.words[G]=this.words[G+D];else this.words[0]=0,this.length=1;var X=0;for(G=this.length-1;G>=0&&(X!==0||G>=S);G--){var re=0|this.words[G];this.words[G]=X<<26-C|re>>>C,X=re&q}return M&&X!==0&&(M.words[M.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},l.prototype.ishrn=function(E,k,N){return c(this.negative===0),this.iushrn(E,k,N)},l.prototype.shln=function(E){return this.clone().ishln(E)},l.prototype.ushln=function(E){return this.clone().iushln(E)},l.prototype.shrn=function(E){return this.clone().ishrn(E)},l.prototype.ushrn=function(E){return this.clone().iushrn(E)},l.prototype.testn=function(E){c(typeof E=="number"&&E>=0);var k=E%26,N=(E-k)/26,S=1<<k;return!(this.length<=N)&&!!(this.words[N]&S)},l.prototype.imaskn=function(E){c(typeof E=="number"&&E>=0);var k=E%26,N=(E-k)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=N)return this;if(k!==0&&N++,this.length=Math.min(N,this.length),k!==0){var S=67108863^67108863>>>k<<k;this.words[this.length-1]&=S}return this._strip()},l.prototype.maskn=function(E){return this.clone().imaskn(E)},l.prototype.iaddn=function(E){return c(typeof E=="number"),c(E<67108864),E<0?this.isubn(-E):this.negative!==0?this.length===1&&(0|this.words[0])<=E?(this.words[0]=E-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(E),this.negative=1,this):this._iaddn(E)},l.prototype._iaddn=function(E){this.words[0]+=E;for(var k=0;k<this.length&&this.words[k]>=67108864;k++)this.words[k]-=67108864,k===this.length-1?this.words[k+1]=1:this.words[k+1]++;return this.length=Math.max(this.length,k+1),this},l.prototype.isubn=function(E){if(c(typeof E=="number"),c(E<67108864),E<0)return this.iaddn(-E);if(this.negative!==0)return this.negative=0,this.iaddn(E),this.negative=1,this;if(this.words[0]-=E,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var k=0;k<this.length&&this.words[k]<0;k++)this.words[k]+=67108864,this.words[k+1]-=1;return this._strip()},l.prototype.addn=function(E){return this.clone().iaddn(E)},l.prototype.subn=function(E){return this.clone().isubn(E)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(E,k,N){var S,C,D=E.length+N;this._expand(D);var q=0;for(S=0;S<E.length;S++){C=(0|this.words[S+N])+q;var M=(0|E.words[S])*k;q=((C-=67108863&M)>>26)-(M/67108864|0),this.words[S+N]=67108863&C}for(;S<this.length-N;S++)q=(C=(0|this.words[S+N])+q)>>26,this.words[S+N]=67108863&C;if(q===0)return this._strip();for(c(q===-1),q=0,S=0;S<this.length;S++)q=(C=-(0|this.words[S])+q)>>26,this.words[S]=67108863&C;return this.negative=1,this._strip()},l.prototype._wordDiv=function(E,k){var N=(this.length,E.length),S=this.clone(),C=E,D=0|C.words[C.length-1];(N=26-this._countBits(D))!==0&&(C=C.ushln(N),S.iushln(N),D=0|C.words[C.length-1]);var q,M=S.length-C.length;if(k!=="mod"){(q=new l(null)).length=M+1,q.words=new Array(q.length);for(var G=0;G<q.length;G++)q.words[G]=0}var X=S.clone()._ishlnsubmul(C,1,M);X.negative===0&&(S=X,q&&(q.words[M]=1));for(var re=M-1;re>=0;re--){var V=67108864*(0|S.words[C.length+re])+(0|S.words[C.length+re-1]);for(V=Math.min(V/D|0,67108863),S._ishlnsubmul(C,V,re);S.negative!==0;)V--,S.negative=0,S._ishlnsubmul(C,1,re),S.isZero()||(S.negative^=1);q&&(q.words[re]=V)}return q&&q._strip(),S._strip(),k!=="div"&&N!==0&&S.iushrn(N),{div:q||null,mod:S}},l.prototype.divmod=function(E,k,N){return c(!E.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&E.negative===0?(D=this.neg().divmod(E,k),k!=="mod"&&(S=D.div.neg()),k!=="div"&&(C=D.mod.neg(),N&&C.negative!==0&&C.iadd(E)),{div:S,mod:C}):this.negative===0&&E.negative!==0?(D=this.divmod(E.neg(),k),k!=="mod"&&(S=D.div.neg()),{div:S,mod:D.mod}):(this.negative&E.negative)!=0?(D=this.neg().divmod(E.neg(),k),k!=="div"&&(C=D.mod.neg(),N&&C.negative!==0&&C.isub(E)),{div:D.div,mod:C}):E.length>this.length||this.cmp(E)<0?{div:new l(0),mod:this}:E.length===1?k==="div"?{div:this.divn(E.words[0]),mod:null}:k==="mod"?{div:null,mod:new l(this.modrn(E.words[0]))}:{div:this.divn(E.words[0]),mod:new l(this.modrn(E.words[0]))}:this._wordDiv(E,k);var S,C,D},l.prototype.div=function(E){return this.divmod(E,"div",!1).div},l.prototype.mod=function(E){return this.divmod(E,"mod",!1).mod},l.prototype.umod=function(E){return this.divmod(E,"mod",!0).mod},l.prototype.divRound=function(E){var k=this.divmod(E);if(k.mod.isZero())return k.div;var N=k.div.negative!==0?k.mod.isub(E):k.mod,S=E.ushrn(1),C=E.andln(1),D=N.cmp(S);return D<0||C===1&&D===0?k.div:k.div.negative!==0?k.div.isubn(1):k.div.iaddn(1)},l.prototype.modrn=function(E){var k=E<0;k&&(E=-E),c(E<=67108863);for(var N=(1<<26)%E,S=0,C=this.length-1;C>=0;C--)S=(N*S+(0|this.words[C]))%E;return k?-S:S},l.prototype.modn=function(E){return this.modrn(E)},l.prototype.idivn=function(E){var k=E<0;k&&(E=-E),c(E<=67108863);for(var N=0,S=this.length-1;S>=0;S--){var C=(0|this.words[S])+67108864*N;this.words[S]=C/E|0,N=C%E}return this._strip(),k?this.ineg():this},l.prototype.divn=function(E){return this.clone().idivn(E)},l.prototype.egcd=function(E){c(E.negative===0),c(!E.isZero());var k=this,N=E.clone();k=k.negative!==0?k.umod(E):k.clone();for(var S=new l(1),C=new l(0),D=new l(0),q=new l(1),M=0;k.isEven()&&N.isEven();)k.iushrn(1),N.iushrn(1),++M;for(var G=N.clone(),X=k.clone();!k.isZero();){for(var re=0,V=1;(k.words[0]&V)==0&&re<26;++re,V<<=1);if(re>0)for(k.iushrn(re);re-- >0;)(S.isOdd()||C.isOdd())&&(S.iadd(G),C.isub(X)),S.iushrn(1),C.iushrn(1);for(var J=0,W=1;(N.words[0]&W)==0&&J<26;++J,W<<=1);if(J>0)for(N.iushrn(J);J-- >0;)(D.isOdd()||q.isOdd())&&(D.iadd(G),q.isub(X)),D.iushrn(1),q.iushrn(1);k.cmp(N)>=0?(k.isub(N),S.isub(D),C.isub(q)):(N.isub(k),D.isub(S),q.isub(C))}return{a:D,b:q,gcd:N.iushln(M)}},l.prototype._invmp=function(E){c(E.negative===0),c(!E.isZero());var k=this,N=E.clone();k=k.negative!==0?k.umod(E):k.clone();for(var S,C=new l(1),D=new l(0),q=N.clone();k.cmpn(1)>0&&N.cmpn(1)>0;){for(var M=0,G=1;(k.words[0]&G)==0&&M<26;++M,G<<=1);if(M>0)for(k.iushrn(M);M-- >0;)C.isOdd()&&C.iadd(q),C.iushrn(1);for(var X=0,re=1;(N.words[0]&re)==0&&X<26;++X,re<<=1);if(X>0)for(N.iushrn(X);X-- >0;)D.isOdd()&&D.iadd(q),D.iushrn(1);k.cmp(N)>=0?(k.isub(N),C.isub(D)):(N.isub(k),D.isub(C))}return(S=k.cmpn(1)===0?C:D).cmpn(0)<0&&S.iadd(E),S},l.prototype.gcd=function(E){if(this.isZero())return E.abs();if(E.isZero())return this.abs();var k=this.clone(),N=E.clone();k.negative=0,N.negative=0;for(var S=0;k.isEven()&&N.isEven();S++)k.iushrn(1),N.iushrn(1);for(;;){for(;k.isEven();)k.iushrn(1);for(;N.isEven();)N.iushrn(1);var C=k.cmp(N);if(C<0){var D=k;k=N,N=D}else if(C===0||N.cmpn(1)===0)break;k.isub(N)}return N.iushln(S)},l.prototype.invm=function(E){return this.egcd(E).a.umod(E)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(E){return this.words[0]&E},l.prototype.bincn=function(E){c(typeof E=="number");var k=E%26,N=(E-k)/26,S=1<<k;if(this.length<=N)return this._expand(N+1),this.words[N]|=S,this;for(var C=S,D=N;C!==0&&D<this.length;D++){var q=0|this.words[D];C=(q+=C)>>>26,q&=67108863,this.words[D]=q}return C!==0&&(this.words[D]=C,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(E){var k,N=E<0;if(this.negative!==0&&!N)return-1;if(this.negative===0&&N)return 1;if(this._strip(),this.length>1)k=1;else{N&&(E=-E),c(E<=67108863,"Number is too big");var S=0|this.words[0];k=S===E?0:S<E?-1:1}return this.negative!==0?0|-k:k},l.prototype.cmp=function(E){if(this.negative!==0&&E.negative===0)return-1;if(this.negative===0&&E.negative!==0)return 1;var k=this.ucmp(E);return this.negative!==0?0|-k:k},l.prototype.ucmp=function(E){if(this.length>E.length)return 1;if(this.length<E.length)return-1;for(var k=0,N=this.length-1;N>=0;N--){var S=0|this.words[N],C=0|E.words[N];if(S!==C){S<C?k=-1:S>C&&(k=1);break}}return k},l.prototype.gtn=function(E){return this.cmpn(E)===1},l.prototype.gt=function(E){return this.cmp(E)===1},l.prototype.gten=function(E){return this.cmpn(E)>=0},l.prototype.gte=function(E){return this.cmp(E)>=0},l.prototype.ltn=function(E){return this.cmpn(E)===-1},l.prototype.lt=function(E){return this.cmp(E)===-1},l.prototype.lten=function(E){return this.cmpn(E)<=0},l.prototype.lte=function(E){return this.cmp(E)<=0},l.prototype.eqn=function(E){return this.cmpn(E)===0},l.prototype.eq=function(E){return this.cmp(E)===0},l.red=function(E){return new O(E)},l.prototype.toRed=function(E){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),E.convertTo(this)._forceRed(E)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(E){return this.red=E,this},l.prototype.forceRed=function(E){return c(!this.red,"Already a number in reduction context"),this._forceRed(E)},l.prototype.redAdd=function(E){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,E)},l.prototype.redIAdd=function(E){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,E)},l.prototype.redSub=function(E){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,E)},l.prototype.redISub=function(E){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,E)},l.prototype.redShl=function(E){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,E)},l.prototype.redMul=function(E){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.mul(this,E)},l.prototype.redIMul=function(E){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,E),this.red.imul(this,E)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(E){return c(this.red&&!E.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,E)};var B={k256:null,p224:null,p192:null,p25519:null};function T(E,k){this.name=E,this.p=new l(k,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function I(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function U(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function H(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function z(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function O(E){if(typeof E=="string"){var k=l._prime(E);this.m=k.p,this.prime=k}else c(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}function L(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}T.prototype._tmp=function(){var E=new l(null);return E.words=new Array(Math.ceil(this.n/13)),E},T.prototype.ireduce=function(E){var k,N=E;do this.split(N,this.tmp),k=(N=(N=this.imulK(N)).iadd(this.tmp)).bitLength();while(k>this.n);var S=k<this.n?-1:N.ucmp(this.p);return S===0?(N.words[0]=0,N.length=1):S>0?N.isub(this.p):N.strip!==void 0?N.strip():N._strip(),N},T.prototype.split=function(E,k){E.iushrn(this.n,0,k)},T.prototype.imulK=function(E){return E.imul(this.k)},u(I,T),I.prototype.split=function(E,k){for(var N=Math.min(E.length,9),S=0;S<N;S++)k.words[S]=E.words[S];if(k.length=N,E.length<=9)return E.words[0]=0,void(E.length=1);var C=E.words[9];for(k.words[k.length++]=4194303&C,S=10;S<E.length;S++){var D=0|E.words[S];E.words[S-10]=(4194303&D)<<4|C>>>22,C=D}C>>>=22,E.words[S-10]=C,C===0&&E.length>10?E.length-=10:E.length-=9},I.prototype.imulK=function(E){E.words[E.length]=0,E.words[E.length+1]=0,E.length+=2;for(var k=0,N=0;N<E.length;N++){var S=0|E.words[N];k+=977*S,E.words[N]=67108863&k,k=64*S+(k/67108864|0)}return E.words[E.length-1]===0&&(E.length--,E.words[E.length-1]===0&&E.length--),E},u(U,T),u(H,T),u(z,T),z.prototype.imulK=function(E){for(var k=0,N=0;N<E.length;N++){var S=19*(0|E.words[N])+k,C=67108863&S;S>>>=26,E.words[N]=C,k=S}return k!==0&&(E.words[E.length++]=k),E},l._prime=function(E){if(B[E])return B[E];var k;if(E==="k256")k=new I;else if(E==="p224")k=new U;else if(E==="p192")k=new H;else{if(E!=="p25519")throw new Error("Unknown prime "+E);k=new z}return B[E]=k,k},O.prototype._verify1=function(E){c(E.negative===0,"red works only with positives"),c(E.red,"red works only with red numbers")},O.prototype._verify2=function(E,k){c((E.negative|k.negative)==0,"red works only with positives"),c(E.red&&E.red===k.red,"red works only with red numbers")},O.prototype.imod=function(E){return this.prime?this.prime.ireduce(E)._forceRed(this):(y(E,E.umod(this.m)._forceRed(this)),E)},O.prototype.neg=function(E){return E.isZero()?E.clone():this.m.sub(E)._forceRed(this)},O.prototype.add=function(E,k){this._verify2(E,k);var N=E.add(k);return N.cmp(this.m)>=0&&N.isub(this.m),N._forceRed(this)},O.prototype.iadd=function(E,k){this._verify2(E,k);var N=E.iadd(k);return N.cmp(this.m)>=0&&N.isub(this.m),N},O.prototype.sub=function(E,k){this._verify2(E,k);var N=E.sub(k);return N.cmpn(0)<0&&N.iadd(this.m),N._forceRed(this)},O.prototype.isub=function(E,k){this._verify2(E,k);var N=E.isub(k);return N.cmpn(0)<0&&N.iadd(this.m),N},O.prototype.shl=function(E,k){return this._verify1(E),this.imod(E.ushln(k))},O.prototype.imul=function(E,k){return this._verify2(E,k),this.imod(E.imul(k))},O.prototype.mul=function(E,k){return this._verify2(E,k),this.imod(E.mul(k))},O.prototype.isqr=function(E){return this.imul(E,E.clone())},O.prototype.sqr=function(E){return this.mul(E,E)},O.prototype.sqrt=function(E){if(E.isZero())return E.clone();var k=this.m.andln(3);if(c(k%2==1),k===3){var N=this.m.add(new l(1)).iushrn(2);return this.pow(E,N)}for(var S=this.m.subn(1),C=0;!S.isZero()&&S.andln(1)===0;)C++,S.iushrn(1);c(!S.isZero());var D=new l(1).toRed(this),q=D.redNeg(),M=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new l(2*G*G).toRed(this);this.pow(G,M).cmp(q)!==0;)G.redIAdd(q);for(var X=this.pow(G,S),re=this.pow(E,S.addn(1).iushrn(1)),V=this.pow(E,S),J=C;V.cmp(D)!==0;){for(var W=V,F=0;W.cmp(D)!==0;F++)W=W.redSqr();c(F<J);var Q=this.pow(X,new l(1).iushln(J-F-1));re=re.redMul(Q),X=Q.redSqr(),V=V.redMul(X),J=F}return re},O.prototype.invm=function(E){var k=E._invmp(this.m);return k.negative!==0?(k.negative=0,this.imod(k).redNeg()):this.imod(k)},O.prototype.pow=function(E,k){if(k.isZero())return new l(1).toRed(this);if(k.cmpn(1)===0)return E.clone();var N=new Array(16);N[0]=new l(1).toRed(this),N[1]=E;for(var S=2;S<N.length;S++)N[S]=this.mul(N[S-1],E);var C=N[0],D=0,q=0,M=k.bitLength()%26;for(M===0&&(M=26),S=k.length-1;S>=0;S--){for(var G=k.words[S],X=M-1;X>=0;X--){var re=G>>X&1;C!==N[0]&&(C=this.sqr(C)),re!==0||D!==0?(D<<=1,D|=re,(++q===4||S===0&&X===0)&&(C=this.mul(C,N[D]),q=0,D=0)):q=0}M=26}return C},O.prototype.convertTo=function(E){var k=E.umod(this.m);return k===E?k.clone():k},O.prototype.convertFrom=function(E){var k=E.clone();return k.red=null,k},l.mont=function(E){return new L(E)},u(L,O),L.prototype.convertTo=function(E){return this.imod(E.ushln(this.shift))},L.prototype.convertFrom=function(E){var k=this.imod(E.mul(this.rinv));return k.red=null,k},L.prototype.imul=function(E,k){if(E.isZero()||k.isZero())return E.words[0]=0,E.length=1,E;var N=E.imul(k),S=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=N.isub(S).iushrn(this.shift),D=C;return C.cmp(this.m)>=0?D=C.isub(this.m):C.cmpn(0)<0&&(D=C.iadd(this.m)),D._forceRed(this)},L.prototype.mul=function(E,k){if(E.isZero()||k.isZero())return new l(0)._forceRed(this);var N=E.mul(k),S=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=N.isub(S).iushrn(this.shift),D=C;return C.cmp(this.m)>=0?D=C.isub(this.m):C.cmpn(0)<0&&(D=C.iadd(this.m)),D._forceRed(this)},L.prototype.invm=function(E){return this.imod(E._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(t,n,a){var i;function o(u){this.rand=u}if(n.exports=function(u){return i||(i=new o(null)),i.generate(u)},n.exports.Rand=o,o.prototype.generate=function(u){return this._rand(u)},o.prototype._rand=function(u){if(this.rand.getBytes)return this.rand.getBytes(u);for(var l=new Uint8Array(u),d=0;d<l.length;d++)l[d]=this.rand.getByte();return l},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(u){var l=new Uint8Array(u);return self.crypto.getRandomValues(l),l}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(u){var l=new Uint8Array(u);return self.msCrypto.getRandomValues(l),l}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var c=t("crypto");if(typeof c.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(u){return c.randomBytes(u)}}catch{}},{crypto:188}],188:[function(t,n,a){},{}],189:[function(t,n,a){var i=t("safe-buffer").Buffer;function o(p){i.isBuffer(p)||(p=i.from(p));for(var h=p.length/4|0,y=new Array(h),g=0;g<h;g++)y[g]=p.readUInt32BE(4*g);return y}function c(p){for(;0<p.length;p++)p[0]=0}function u(p,h,y,g,m){for(var x,v,w,_,A=y[0],P=y[1],B=y[2],T=y[3],I=p[0]^h[0],U=p[1]^h[1],H=p[2]^h[2],z=p[3]^h[3],O=4,L=1;L<m;L++)x=A[I>>>24]^P[U>>>16&255]^B[H>>>8&255]^T[255&z]^h[O++],v=A[U>>>24]^P[H>>>16&255]^B[z>>>8&255]^T[255&I]^h[O++],w=A[H>>>24]^P[z>>>16&255]^B[I>>>8&255]^T[255&U]^h[O++],_=A[z>>>24]^P[I>>>16&255]^B[U>>>8&255]^T[255&H]^h[O++],I=x,U=v,H=w,z=_;return x=(g[I>>>24]<<24|g[U>>>16&255]<<16|g[H>>>8&255]<<8|g[255&z])^h[O++],v=(g[U>>>24]<<24|g[H>>>16&255]<<16|g[z>>>8&255]<<8|g[255&I])^h[O++],w=(g[H>>>24]<<24|g[z>>>16&255]<<16|g[I>>>8&255]<<8|g[255&U])^h[O++],_=(g[z>>>24]<<24|g[I>>>16&255]<<16|g[U>>>8&255]<<8|g[255&H])^h[O++],[x>>>=0,v>>>=0,w>>>=0,_>>>=0]}var l=[0,1,2,4,8,16,32,64,128,27,54],d=(function(){for(var p=new Array(256),h=0;h<256;h++)p[h]=h<128?h<<1:h<<1^283;for(var y=[],g=[],m=[[],[],[],[]],x=[[],[],[],[]],v=0,w=0,_=0;_<256;++_){var A=w^w<<1^w<<2^w<<3^w<<4;A=A>>>8^255&A^99,y[v]=A,g[A]=v;var P=p[v],B=p[P],T=p[B],I=257*p[A]^16843008*A;m[0][v]=I<<24|I>>>8,m[1][v]=I<<16|I>>>16,m[2][v]=I<<8|I>>>24,m[3][v]=I,I=16843009*T^65537*B^257*P^16843008*v,x[0][A]=I<<24|I>>>8,x[1][A]=I<<16|I>>>16,x[2][A]=I<<8|I>>>24,x[3][A]=I,v===0?v=w=1:(v=P^p[p[p[T^P]]],w^=p[p[w]])}return{SBOX:y,INV_SBOX:g,SUB_MIX:m,INV_SUB_MIX:x}})();function f(p){this._key=o(p),this._reset()}f.blockSize=16,f.keySize=32,f.prototype.blockSize=f.blockSize,f.prototype.keySize=f.keySize,f.prototype._reset=function(){for(var p=this._key,h=p.length,y=h+6,g=4*(y+1),m=[],x=0;x<h;x++)m[x]=p[x];for(x=h;x<g;x++){var v=m[x-1];x%h==0?(v=v<<8|v>>>24,v=d.SBOX[v>>>24]<<24|d.SBOX[v>>>16&255]<<16|d.SBOX[v>>>8&255]<<8|d.SBOX[255&v],v^=l[x/h|0]<<24):h>6&&x%h==4&&(v=d.SBOX[v>>>24]<<24|d.SBOX[v>>>16&255]<<16|d.SBOX[v>>>8&255]<<8|d.SBOX[255&v]),m[x]=m[x-h]^v}for(var w=[],_=0;_<g;_++){var A=g-_,P=m[A-(_%4?0:4)];w[_]=_<4||A<=4?P:d.INV_SUB_MIX[0][d.SBOX[P>>>24]]^d.INV_SUB_MIX[1][d.SBOX[P>>>16&255]]^d.INV_SUB_MIX[2][d.SBOX[P>>>8&255]]^d.INV_SUB_MIX[3][d.SBOX[255&P]]}this._nRounds=y,this._keySchedule=m,this._invKeySchedule=w},f.prototype.encryptBlockRaw=function(p){return u(p=o(p),this._keySchedule,d.SUB_MIX,d.SBOX,this._nRounds)},f.prototype.encryptBlock=function(p){var h=this.encryptBlockRaw(p),y=i.allocUnsafe(16);return y.writeUInt32BE(h[0],0),y.writeUInt32BE(h[1],4),y.writeUInt32BE(h[2],8),y.writeUInt32BE(h[3],12),y},f.prototype.decryptBlock=function(p){var h=(p=o(p))[1];p[1]=p[3],p[3]=h;var y=u(p,this._invKeySchedule,d.INV_SUB_MIX,d.INV_SBOX,this._nRounds),g=i.allocUnsafe(16);return g.writeUInt32BE(y[0],0),g.writeUInt32BE(y[3],4),g.writeUInt32BE(y[2],8),g.writeUInt32BE(y[1],12),g},f.prototype.scrub=function(){c(this._keySchedule),c(this._invKeySchedule),c(this._key)},n.exports.AES=f},{"safe-buffer":494}],190:[function(t,n,a){var i=t("./aes"),o=t("safe-buffer").Buffer,c=t("cipher-base"),u=t("inherits"),l=t("./ghash"),d=t("buffer-xor"),f=t("./incr32");function p(h,y,g,m){c.call(this);var x=o.alloc(4,0);this._cipher=new i.AES(y);var v=this._cipher.encryptBlock(x);this._ghash=new l(v),g=(function(w,_,A){if(_.length===12)return w._finID=o.concat([_,o.from([0,0,0,1])]),o.concat([_,o.from([0,0,0,2])]);var P=new l(A),B=_.length,T=B%16;P.update(_),T&&(T=16-T,P.update(o.alloc(T,0))),P.update(o.alloc(8,0));var I=8*B,U=o.alloc(8);U.writeUIntBE(I,0,8),P.update(U),w._finID=P.state;var H=o.from(w._finID);return f(H),H})(this,g,v),this._prev=o.from(g),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=m,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}u(p,c),p.prototype._update=function(h){if(!this._called&&this._alen){var y=16-this._alen%16;y<16&&(y=o.alloc(y,0),this._ghash.update(y))}this._called=!0;var g=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(g),this._len+=h.length,g},p.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=d(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&(function(y,g){var m=0;y.length!==g.length&&m++;for(var x=Math.min(y.length,g.length),v=0;v<x;++v)m+=y[v]^g[v];return m})(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},p.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},p.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},p.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},n.exports=p},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(t,n,a){var i=t("./encrypter"),o=t("./decrypter"),c=t("./modes/list.json");a.createCipher=a.Cipher=i.createCipher,a.createCipheriv=a.Cipheriv=i.createCipheriv,a.createDecipher=a.Decipher=o.createDecipher,a.createDecipheriv=a.Decipheriv=o.createDecipheriv,a.listCiphers=a.getCiphers=function(){return Object.keys(c)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(t,n,a){var i=t("./authCipher"),o=t("safe-buffer").Buffer,c=t("./modes"),u=t("./streamCipher"),l=t("cipher-base"),d=t("./aes"),f=t("evp_bytestokey");function p(g,m,x){l.call(this),this._cache=new h,this._last=void 0,this._cipher=new d.AES(m),this._prev=o.from(x),this._mode=g,this._autopadding=!0}function h(){this.cache=o.allocUnsafe(0)}function y(g,m,x){var v=c[g.toLowerCase()];if(!v)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=o.from(x)),v.mode!=="GCM"&&x.length!==v.iv)throw new TypeError("invalid iv length "+x.length);if(typeof m=="string"&&(m=o.from(m)),m.length!==v.key/8)throw new TypeError("invalid key length "+m.length);return v.type==="stream"?new u(v.module,m,x,!0):v.type==="auth"?new i(v.module,m,x,!0):new p(v.module,m,x)}t("inherits")(p,l),p.prototype._update=function(g){var m,x;this._cache.add(g);for(var v=[];m=this._cache.get(this._autopadding);)x=this._mode.decrypt(this,m),v.push(x);return o.concat(v)},p.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return(function(m){var x=m[15];if(x<1||x>16)throw new Error("unable to decrypt data");for(var v=-1;++v<x;)if(m[v+(16-x)]!==x)throw new Error("unable to decrypt data");if(x!==16)return m.slice(0,16-x)})(this._mode.decrypt(this,g));if(g)throw new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},h.prototype.add=function(g){this.cache=o.concat([this.cache,g])},h.prototype.get=function(g){var m;if(g){if(this.cache.length>16)return m=this.cache.slice(0,16),this.cache=this.cache.slice(16),m}else if(this.cache.length>=16)return m=this.cache.slice(0,16),this.cache=this.cache.slice(16),m;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},a.createDecipher=function(g,m){var x=c[g.toLowerCase()];if(!x)throw new TypeError("invalid suite type");var v=f(m,!1,x.key,x.iv);return y(g,v.key,v.iv)},a.createDecipheriv=y},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(t,n,a){var i=t("./modes"),o=t("./authCipher"),c=t("safe-buffer").Buffer,u=t("./streamCipher"),l=t("cipher-base"),d=t("./aes"),f=t("evp_bytestokey");function p(m,x,v){l.call(this),this._cache=new y,this._cipher=new d.AES(x),this._prev=c.from(v),this._mode=m,this._autopadding=!0}t("inherits")(p,l),p.prototype._update=function(m){var x,v;this._cache.add(m);for(var w=[];x=this._cache.get();)v=this._mode.encrypt(this,x),w.push(v);return c.concat(w)};var h=c.alloc(16,16);function y(){this.cache=c.allocUnsafe(0)}function g(m,x,v){var w=i[m.toLowerCase()];if(!w)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=c.from(x)),x.length!==w.key/8)throw new TypeError("invalid key length "+x.length);if(typeof v=="string"&&(v=c.from(v)),w.mode!=="GCM"&&v.length!==w.iv)throw new TypeError("invalid iv length "+v.length);return w.type==="stream"?new u(w.module,x,v):w.type==="auth"?new o(w.module,x,v):new p(w.module,x,v)}p.prototype._final=function(){var m=this._cache.flush();if(this._autopadding)return m=this._mode.encrypt(this,m),this._cipher.scrub(),m;if(!m.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},p.prototype.setAutoPadding=function(m){return this._autopadding=!!m,this},y.prototype.add=function(m){this.cache=c.concat([this.cache,m])},y.prototype.get=function(){if(this.cache.length>15){var m=this.cache.slice(0,16);return this.cache=this.cache.slice(16),m}return null},y.prototype.flush=function(){for(var m=16-this.cache.length,x=c.allocUnsafe(m),v=-1;++v<m;)x.writeUInt8(m,v);return c.concat([this.cache,x])},a.createCipheriv=g,a.createCipher=function(m,x){var v=i[m.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var w=f(x,!1,v.key,v.iv);return g(m,w.key,w.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(t,n,a){var i=t("safe-buffer").Buffer,o=i.alloc(16,0);function c(l){var d=i.allocUnsafe(16);return d.writeUInt32BE(l[0]>>>0,0),d.writeUInt32BE(l[1]>>>0,4),d.writeUInt32BE(l[2]>>>0,8),d.writeUInt32BE(l[3]>>>0,12),d}function u(l){this.h=l,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}u.prototype.ghash=function(l){for(var d=-1;++d<l.length;)this.state[d]^=l[d];this._multiply()},u.prototype._multiply=function(){for(var l,d,f,p=[(l=this.h).readUInt32BE(0),l.readUInt32BE(4),l.readUInt32BE(8),l.readUInt32BE(12)],h=[0,0,0,0],y=-1;++y<128;){for((this.state[~~(y/8)]&1<<7-y%8)!=0&&(h[0]^=p[0],h[1]^=p[1],h[2]^=p[2],h[3]^=p[3]),f=(1&p[3])!=0,d=3;d>0;d--)p[d]=p[d]>>>1|(1&p[d-1])<<31;p[0]=p[0]>>>1,f&&(p[0]=p[0]^225<<24)}this.state=c(h)},u.prototype.update=function(l){var d;for(this.cache=i.concat([this.cache,l]);this.cache.length>=16;)d=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(d)},u.prototype.final=function(l,d){return this.cache.length&&this.ghash(i.concat([this.cache,o],16)),this.ghash(c([0,l,0,d])),this.state},n.exports=u},{"safe-buffer":494}],195:[function(t,n,a){n.exports=function(i){for(var o,c=i.length;c--;){if((o=i.readUInt8(c))!==255){o++,i.writeUInt8(o,c);break}i.writeUInt8(0,c)}}},{}],196:[function(t,n,a){var i=t("buffer-xor");a.encrypt=function(o,c){var u=i(c,o._prev);return o._prev=o._cipher.encryptBlock(u),o._prev},a.decrypt=function(o,c){var u=o._prev;o._prev=c;var l=o._cipher.decryptBlock(c);return i(l,u)}},{"buffer-xor":219}],197:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("buffer-xor");function c(u,l,d){var f=l.length,p=o(l,u._cache);return u._cache=u._cache.slice(f),u._prev=i.concat([u._prev,d?l:p]),p}a.encrypt=function(u,l,d){for(var f,p=i.allocUnsafe(0);l.length;){if(u._cache.length===0&&(u._cache=u._cipher.encryptBlock(u._prev),u._prev=i.allocUnsafe(0)),!(u._cache.length<=l.length)){p=i.concat([p,c(u,l,d)]);break}f=u._cache.length,p=i.concat([p,c(u,l.slice(0,f),d)]),l=l.slice(f)}return p}},{"buffer-xor":219,"safe-buffer":494}],198:[function(t,n,a){var i=t("safe-buffer").Buffer;function o(u,l,d){for(var f,p,h=-1,y=0;++h<8;)f=l&1<<7-h?128:0,y+=(128&(p=u._cipher.encryptBlock(u._prev)[0]^f))>>h%8,u._prev=c(u._prev,d?f:p);return y}function c(u,l){var d=u.length,f=-1,p=i.allocUnsafe(u.length);for(u=i.concat([u,i.from([l])]);++f<d;)p[f]=u[f]<<1|u[f+1]>>7;return p}a.encrypt=function(u,l,d){for(var f=l.length,p=i.allocUnsafe(f),h=-1;++h<f;)p[h]=o(u,l[h],d);return p}},{"safe-buffer":494}],199:[function(t,n,a){var i=t("safe-buffer").Buffer;function o(c,u,l){var d=c._cipher.encryptBlock(c._prev)[0]^u;return c._prev=i.concat([c._prev.slice(1),i.from([l?u:d])]),d}a.encrypt=function(c,u,l){for(var d=u.length,f=i.allocUnsafe(d),p=-1;++p<d;)f[p]=o(c,u[p],l);return f}},{"safe-buffer":494}],200:[function(t,n,a){var i=t("buffer-xor"),o=t("safe-buffer").Buffer,c=t("../incr32");function u(l){var d=l._cipher.encryptBlockRaw(l._prev);return c(l._prev),d}a.encrypt=function(l,d){var f=Math.ceil(d.length/16),p=l._cache.length;l._cache=o.concat([l._cache,o.allocUnsafe(16*f)]);for(var h=0;h<f;h++){var y=u(l),g=p+16*h;l._cache.writeUInt32BE(y[0],g+0),l._cache.writeUInt32BE(y[1],g+4),l._cache.writeUInt32BE(y[2],g+8),l._cache.writeUInt32BE(y[3],g+12)}var m=l._cache.slice(0,d.length);return l._cache=l._cache.slice(d.length),i(d,m)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(t,n,a){a.encrypt=function(i,o){return i._cipher.encryptBlock(o)},a.decrypt=function(i,o){return i._cipher.decryptBlock(o)}},{}],202:[function(t,n,a){var i={ECB:t("./ecb"),CBC:t("./cbc"),CFB:t("./cfb"),CFB8:t("./cfb8"),CFB1:t("./cfb1"),OFB:t("./ofb"),CTR:t("./ctr"),GCM:t("./ctr")},o=t("./list.json");for(var c in o)o[c].module=i[o[c].mode];n.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(t,n,a){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(t,n,a){(function(i){(function(){var o=t("buffer-xor");function c(u){return u._prev=u._cipher.encryptBlock(u._prev),u._prev}a.encrypt=function(u,l){for(;u._cache.length<l.length;)u._cache=i.concat([u._cache,c(u)]);var d=u._cache.slice(0,l.length);return u._cache=u._cache.slice(l.length),o(l,d)}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(t,n,a){var i=t("./aes"),o=t("safe-buffer").Buffer,c=t("cipher-base");function u(l,d,f,p){c.call(this),this._cipher=new i.AES(d),this._prev=o.from(f),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=p,this._mode=l}t("inherits")(u,c),u.prototype._update=function(l){return this._mode.encrypt(this,l,this._decrypt)},u.prototype._final=function(){this._cipher.scrub()},n.exports=u},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(t,n,a){var i=t("browserify-des"),o=t("browserify-aes/browser"),c=t("browserify-aes/modes"),u=t("browserify-des/modes"),l=t("evp_bytestokey");function d(p,h,y){if(p=p.toLowerCase(),c[p])return o.createCipheriv(p,h,y);if(u[p])return new i({key:h,iv:y,mode:p});throw new TypeError("invalid suite type")}function f(p,h,y){if(p=p.toLowerCase(),c[p])return o.createDecipheriv(p,h,y);if(u[p])return new i({key:h,iv:y,mode:p,decrypt:!0});throw new TypeError("invalid suite type")}a.createCipher=a.Cipher=function(p,h){var y,g;if(p=p.toLowerCase(),c[p])y=c[p].key,g=c[p].iv;else{if(!u[p])throw new TypeError("invalid suite type");y=8*u[p].key,g=u[p].iv}var m=l(h,!1,y,g);return d(p,m.key,m.iv)},a.createCipheriv=a.Cipheriv=d,a.createDecipher=a.Decipher=function(p,h){var y,g;if(p=p.toLowerCase(),c[p])y=c[p].key,g=c[p].iv;else{if(!u[p])throw new TypeError("invalid suite type");y=8*u[p].key,g=u[p].iv}var m=l(h,!1,y,g);return f(p,m.key,m.iv)},a.createDecipheriv=a.Decipheriv=f,a.listCiphers=a.getCiphers=function(){return Object.keys(u).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(t,n,a){var i=t("cipher-base"),o=t("des.js"),c=t("inherits"),u=t("safe-buffer").Buffer,l={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function d(f){i.call(this);var p,h=f.mode.toLowerCase(),y=l[h];p=f.decrypt?"decrypt":"encrypt";var g=f.key;u.isBuffer(g)||(g=u.from(g)),h!=="des-ede"&&h!=="des-ede-cbc"||(g=u.concat([g,g.slice(0,8)]));var m=f.iv;u.isBuffer(m)||(m=u.from(m)),this._des=y.create({key:g,iv:m,type:p})}l.des=l["des-cbc"],l.des3=l["des-ede3-cbc"],n.exports=d,c(d,i),d.prototype._update=function(f){return u.from(this._des.update(f))},d.prototype._final=function(){return u.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(t,n,a){a["des-ecb"]={key:8,iv:0},a["des-cbc"]=a.des={key:8,iv:8},a["des-ede3-cbc"]=a.des3={key:24,iv:8},a["des-ede3"]={key:24,iv:0},a["des-ede-cbc"]={key:16,iv:8},a["des-ede"]={key:16,iv:0}},{}],209:[function(t,n,a){(function(i){(function(){var o=t("bn.js"),c=t("randombytes");function u(d){var f,p=d.modulus.byteLength();do f=new o(c(p));while(f.cmp(d.modulus)>=0||!f.umod(d.prime1)||!f.umod(d.prime2));return f}function l(d,f){var p=(function(B){var T=u(B);return{blinder:T.toRed(o.mont(B.modulus)).redPow(new o(B.publicExponent)).fromRed(),unblinder:T.invm(B.modulus)}})(f),h=f.modulus.byteLength(),y=new o(d).mul(p.blinder).umod(f.modulus),g=y.toRed(o.mont(f.prime1)),m=y.toRed(o.mont(f.prime2)),x=f.coefficient,v=f.prime1,w=f.prime2,_=g.redPow(f.exponent1).fromRed(),A=m.redPow(f.exponent2).fromRed(),P=_.isub(A).imul(x).umod(v).imul(w);return A.iadd(P).imul(p.unblinder).umod(f.modulus).toArrayLike(i,"be",h)}l.getr=u,n.exports=l}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(t,n,a){n.exports=t("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(t,n,a){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(t,n,a){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("create-hash"),c=t("readable-stream"),u=t("inherits"),l=t("./sign"),d=t("./verify"),f=t("./algorithms.json");function p(m){c.Writable.call(this);var x=f[m];if(!x)throw new Error("Unknown message digest");this._hashType=x.hash,this._hash=o(x.hash),this._tag=x.id,this._signType=x.sign}function h(m){c.Writable.call(this);var x=f[m];if(!x)throw new Error("Unknown message digest");this._hash=o(x.hash),this._tag=x.id,this._signType=x.sign}function y(m){return new p(m)}function g(m){return new h(m)}Object.keys(f).forEach((function(m){f[m].id=i.from(f[m].id,"hex"),f[m.toLowerCase()]=f[m]})),u(p,c.Writable),p.prototype._write=function(m,x,v){this._hash.update(m),v()},p.prototype.update=function(m,x){return typeof m=="string"&&(m=i.from(m,x)),this._hash.update(m),this},p.prototype.sign=function(m,x){this.end();var v=this._hash.digest(),w=l(v,m,this._hashType,this._signType,this._tag);return x?w.toString(x):w},u(h,c.Writable),h.prototype._write=function(m,x,v){this._hash.update(m),v()},h.prototype.update=function(m,x){return typeof m=="string"&&(m=i.from(m,x)),this._hash.update(m),this},h.prototype.verify=function(m,x,v){typeof x=="string"&&(x=i.from(x,v)),this.end();var w=this._hash.digest();return d(x,w,m,this._signType,this._tag)},n.exports={Sign:y,Verify:g,createSign:y,createVerify:g}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("create-hmac"),c=t("browserify-rsa"),u=t("elliptic").ec,l=t("bn.js"),d=t("parse-asn1"),f=t("./curves.json");function p(m,x,v,w){if((m=i.from(m.toArray())).length<x.byteLength()){var _=i.alloc(x.byteLength()-m.length);m=i.concat([_,m])}var A=v.length,P=(function(I,U){I=(I=h(I,U)).mod(U);var H=i.from(I.toArray());if(H.length<U.byteLength()){var z=i.alloc(U.byteLength()-H.length);H=i.concat([z,H])}return H})(v,x),B=i.alloc(A);B.fill(1);var T=i.alloc(A);return T=o(w,T).update(B).update(i.from([0])).update(m).update(P).digest(),B=o(w,T).update(B).digest(),{k:T=o(w,T).update(B).update(i.from([1])).update(m).update(P).digest(),v:B=o(w,T).update(B).digest()}}function h(m,x){var v=new l(m),w=(m.length<<3)-x.bitLength();return w>0&&v.ishrn(w),v}function y(m,x,v){var w,_;do{for(w=i.alloc(0);8*w.length<m.bitLength();)x.v=o(v,x.k).update(x.v).digest(),w=i.concat([w,x.v]);_=h(w,m),x.k=o(v,x.k).update(x.v).update(i.from([0])).digest(),x.v=o(v,x.k).update(x.v).digest()}while(_.cmp(m)!==-1);return _}function g(m,x,v,w){return m.toRed(l.mont(v)).redPow(x).fromRed().mod(w)}n.exports=function(m,x,v,w,_){var A=d(x);if(A.curve){if(w!=="ecdsa"&&w!=="ecdsa/rsa")throw new Error("wrong private key type");return(function(I,U){var H=f[U.curve.join(".")];if(!H)throw new Error("unknown curve "+U.curve.join("."));var z=new u(H).keyFromPrivate(U.privateKey).sign(I);return i.from(z.toDER())})(m,A)}if(A.type==="dsa"){if(w!=="dsa")throw new Error("wrong private key type");return(function(I,U,H){for(var z,O=U.params.priv_key,L=U.params.p,E=U.params.q,k=U.params.g,N=new l(0),S=h(I,E).mod(E),C=!1,D=p(O,E,I,H);C===!1;)z=y(E,D,H),N=g(k,z,L,E),(C=z.invm(E).imul(S.add(O.mul(N))).mod(E)).cmpn(0)===0&&(C=!1,N=new l(0));return(function(q,M){q=q.toArray(),M=M.toArray(),128&q[0]&&(q=[0].concat(q)),128&M[0]&&(M=[0].concat(M));var G=[48,q.length+M.length+4,2,q.length];return G=G.concat(q,[2,M.length],M),i.from(G)})(N,C)})(m,A,v)}if(w!=="rsa"&&w!=="ecdsa/rsa")throw new Error("wrong private key type");m=i.concat([_,m]);for(var P=A.modulus.byteLength(),B=[0,1];m.length+B.length+1<P;)B.push(255);B.push(0);for(var T=-1;++T<m.length;)B.push(m[T]);return c(B,A)},n.exports.getKey=p,n.exports.makeKey=y},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("bn.js"),c=t("elliptic").ec,u=t("parse-asn1"),l=t("./curves.json");function d(f,p){if(f.cmpn(0)<=0)throw new Error("invalid sig");if(f.cmp(p)>=p)throw new Error("invalid sig")}n.exports=function(f,p,h,y,g){var m=u(h);if(m.type==="ec"){if(y!=="ecdsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");return(function(B,T,I){var U=l[I.data.algorithm.curve.join(".")];if(!U)throw new Error("unknown curve "+I.data.algorithm.curve.join("."));var H=new c(U),z=I.data.subjectPrivateKey.data;return H.verify(T,B,z)})(f,p,m)}if(m.type==="dsa"){if(y!=="dsa")throw new Error("wrong public key type");return(function(B,T,I){var U=I.data.p,H=I.data.q,z=I.data.g,O=I.data.pub_key,L=u.signature.decode(B,"der"),E=L.s,k=L.r;d(E,H),d(k,H);var N=o.mont(U),S=E.invm(H);return z.toRed(N).redPow(new o(T).mul(S).mod(H)).fromRed().mul(O.toRed(N).redPow(k.mul(S).mod(H)).fromRed()).mod(U).mod(H).cmp(k)===0})(f,p,m)}if(y!=="rsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");p=i.concat([g,p]);for(var x=m.modulus.byteLength(),v=[1],w=0;p.length+v.length+2<x;)v.push(255),w++;v.push(0);for(var _=-1;++_<p.length;)v.push(p[_]);v=i.from(v);var A=o.mont(m.modulus);f=(f=new o(f).toRed(A)).redPow(new o(m.publicExponent)),f=i.from(f.fromRed().toArray());var P=w<8?1:0;for(x=Math.min(f.length,v.length),f.length!==v.length&&(P=1),_=-1;++_<x;)P|=f[_]^v[_];return P===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(t,n,a){},{}],217:[function(t,n,a){var i=t("buffer"),o=i.Buffer;function c(l,d){for(var f in l)d[f]=l[f]}function u(l,d,f){return o(l,d,f)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=i:(c(i,a),a.Buffer=u),c(o,u),u.from=function(l,d,f){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,d,f)},u.alloc=function(l,d,f){if(typeof l!="number")throw new TypeError("Argument must be a number");var p=o(l);return d!==void 0?typeof f=="string"?p.fill(d,f):p.fill(d):p.fill(0),p},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(l)}},{buffer:220}],218:[function(t,n,a){var i=t("safe-buffer").Buffer,o=i.isEncoding||function(m){switch((m=""+m)&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c(m){var x;switch(this.encoding=(function(v){var w=(function(_){if(!_)return"utf8";for(var A;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(A)return;_=(""+_).toLowerCase(),A=!0}})(v);if(typeof w!="string"&&(i.isEncoding===o||!o(v)))throw new Error("Unknown encoding: "+v);return w||v})(m),this.encoding){case"utf16le":this.text=d,this.end=f,x=4;break;case"utf8":this.fillLast=l,x=4;break;case"base64":this.text=p,this.end=h,x=3;break;default:return this.write=y,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(x)}function u(m){return m<=127?0:m>>5==6?2:m>>4==14?3:m>>3==30?4:m>>6==2?-1:-2}function l(m){var x=this.lastTotal-this.lastNeed,v=(function(w,_,A){if((192&_[0])!=128)return w.lastNeed=0,"";if(w.lastNeed>1&&_.length>1){if((192&_[1])!=128)return w.lastNeed=1,"";if(w.lastNeed>2&&_.length>2&&(192&_[2])!=128)return w.lastNeed=2,""}})(this,m);return v!==void 0?v:this.lastNeed<=m.length?(m.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(m.copy(this.lastChar,x,0,m.length),void(this.lastNeed-=m.length))}function d(m,x){if((m.length-x)%2==0){var v=m.toString("utf16le",x);if(v){var w=v.charCodeAt(v.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],v.slice(0,-1)}return v}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",x,m.length-1)}function f(m){var x=m&&m.length?this.write(m):"";if(this.lastNeed){var v=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,v)}return x}function p(m,x){var v=(m.length-x)%3;return v===0?m.toString("base64",x):(this.lastNeed=3-v,this.lastTotal=3,v===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",x,m.length-v))}function h(m){var x=m&&m.length?this.write(m):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function y(m){return m.toString(this.encoding)}function g(m){return m&&m.length?this.write(m):""}a.StringDecoder=c,c.prototype.write=function(m){if(m.length===0)return"";var x,v;if(this.lastNeed){if((x=this.fillLast(m))===void 0)return"";v=this.lastNeed,this.lastNeed=0}else v=0;return v<m.length?x?x+this.text(m,v):this.text(m,v):x||""},c.prototype.end=function(m){var x=m&&m.length?this.write(m):"";return this.lastNeed?x+"":x},c.prototype.text=function(m,x){var v=(function(_,A,P){var B=A.length-1;if(B<P)return 0;var T=u(A[B]);return T>=0?(T>0&&(_.lastNeed=T-1),T):--B<P||T===-2?0:(T=u(A[B]))>=0?(T>0&&(_.lastNeed=T-2),T):--B<P||T===-2?0:(T=u(A[B]))>=0?(T>0&&(T===2?T=0:_.lastNeed=T-3),T):0})(this,m,x);if(!this.lastNeed)return m.toString("utf8",x);this.lastTotal=v;var w=m.length-(v-this.lastNeed);return m.copy(this.lastChar,0,w),m.toString("utf8",x,w)},c.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length}},{"safe-buffer":217}],219:[function(t,n,a){(function(i){(function(){n.exports=function(o,c){for(var u=Math.min(o.length,c.length),l=new i(u),d=0;d<u;++d)l[d]=o[d]^c[d];return l}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:220}],220:[function(t,n,a){(function(i){(function(){var o=t("base64-js"),c=t("ieee754");a.Buffer=l,a.SlowBuffer=function(W){return+W!=W&&(W=0),l.alloc(+W)},a.INSPECT_MAX_BYTES=50;function u(W){if(W>2147483647)throw new RangeError('The value "'+W+'" is invalid for option "size"');var F=new Uint8Array(W);return F.__proto__=l.prototype,F}function l(W,F,Q){if(typeof W=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(W)}return d(W,F,Q)}function d(W,F,Q){if(typeof W=="string")return(function(ce,de){if(typeof de=="string"&&de!==""||(de="utf8"),!l.isEncoding(de))throw new TypeError("Unknown encoding: "+de);var le=0|g(ce,de),_e=u(le),ue=_e.write(ce,de);return ue!==le&&(_e=_e.slice(0,ue)),_e})(W,F);if(ArrayBuffer.isView(W))return h(W);if(W==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W);if(V(W,ArrayBuffer)||W&&V(W.buffer,ArrayBuffer))return(function(ce,de,le){if(de<0||ce.byteLength<de)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<de+(le||0))throw new RangeError('"length" is outside of buffer bounds');var _e;return _e=de===void 0&&le===void 0?new Uint8Array(ce):le===void 0?new Uint8Array(ce,de):new Uint8Array(ce,de,le),_e.__proto__=l.prototype,_e})(W,F,Q);if(typeof W=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ne=W.valueOf&&W.valueOf();if(ne!=null&&ne!==W)return l.from(ne,F,Q);var ie=(function(ce){if(l.isBuffer(ce)){var de=0|y(ce.length),le=u(de);return le.length===0||ce.copy(le,0,0,de),le}if(ce.length!==void 0)return typeof ce.length!="number"||J(ce.length)?u(0):h(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return h(ce.data)})(W);if(ie)return ie;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof W[Symbol.toPrimitive]=="function")return l.from(W[Symbol.toPrimitive]("string"),F,Q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W)}function f(W){if(typeof W!="number")throw new TypeError('"size" argument must be of type number');if(W<0)throw new RangeError('The value "'+W+'" is invalid for option "size"')}function p(W){return f(W),u(W<0?0:0|y(W))}function h(W){for(var F=W.length<0?0:0|y(W.length),Q=u(F),ne=0;ne<F;ne+=1)Q[ne]=255&W[ne];return Q}function y(W){if(W>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|W}function g(W,F){if(l.isBuffer(W))return W.length;if(ArrayBuffer.isView(W)||V(W,ArrayBuffer))return W.byteLength;if(typeof W!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof W);var Q=W.length,ne=arguments.length>2&&arguments[2]===!0;if(!ne&&Q===0)return 0;for(var ie=!1;;)switch(F){case"ascii":case"latin1":case"binary":return Q;case"utf8":case"utf-8":return G(W).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Q;case"hex":return Q>>>1;case"base64":return X(W).length;default:if(ie)return ne?-1:G(W).length;F=(""+F).toLowerCase(),ie=!0}}function m(W,F,Q){var ne=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((Q===void 0||Q>this.length)&&(Q=this.length),Q<=0)||(Q>>>=0)<=(F>>>=0))return"";for(W||(W="utf8");;)switch(W){case"hex":return L(this,F,Q);case"utf8":case"utf-8":return H(this,F,Q);case"ascii":return z(this,F,Q);case"latin1":case"binary":return O(this,F,Q);case"base64":return U(this,F,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,F,Q);default:if(ne)throw new TypeError("Unknown encoding: "+W);W=(W+"").toLowerCase(),ne=!0}}function x(W,F,Q){var ne=W[F];W[F]=W[Q],W[Q]=ne}function v(W,F,Q,ne,ie){if(W.length===0)return-1;if(typeof Q=="string"?(ne=Q,Q=0):Q>2147483647?Q=2147483647:Q<-2147483648&&(Q=-2147483648),J(Q=+Q)&&(Q=ie?0:W.length-1),Q<0&&(Q=W.length+Q),Q>=W.length){if(ie)return-1;Q=W.length-1}else if(Q<0){if(!ie)return-1;Q=0}if(typeof F=="string"&&(F=l.from(F,ne)),l.isBuffer(F))return F.length===0?-1:w(W,F,Q,ne,ie);if(typeof F=="number")return F&=255,typeof Uint8Array.prototype.indexOf=="function"?ie?Uint8Array.prototype.indexOf.call(W,F,Q):Uint8Array.prototype.lastIndexOf.call(W,F,Q):w(W,[F],Q,ne,ie);throw new TypeError("val must be string, number or Buffer")}function w(W,F,Q,ne,ie){var ce,de=1,le=W.length,_e=F.length;if(ne!==void 0&&((ne=String(ne).toLowerCase())==="ucs2"||ne==="ucs-2"||ne==="utf16le"||ne==="utf-16le")){if(W.length<2||F.length<2)return-1;de=2,le/=2,_e/=2,Q/=2}function ue(fe,xe){return de===1?fe[xe]:fe.readUInt16BE(xe*de)}if(ie){var pe=-1;for(ce=Q;ce<le;ce++)if(ue(W,ce)===ue(F,pe===-1?0:ce-pe)){if(pe===-1&&(pe=ce),ce-pe+1===_e)return pe*de}else pe!==-1&&(ce-=ce-pe),pe=-1}else for(Q+_e>le&&(Q=le-_e),ce=Q;ce>=0;ce--){for(var me=!0,Ce=0;Ce<_e;Ce++)if(ue(W,ce+Ce)!==ue(F,Ce)){me=!1;break}if(me)return ce}return-1}function _(W,F,Q,ne){Q=Number(Q)||0;var ie=W.length-Q;ne?(ne=Number(ne))>ie&&(ne=ie):ne=ie;var ce=F.length;ne>ce/2&&(ne=ce/2);for(var de=0;de<ne;++de){var le=parseInt(F.substr(2*de,2),16);if(J(le))return de;W[Q+de]=le}return de}function A(W,F,Q,ne){return re(G(F,W.length-Q),W,Q,ne)}function P(W,F,Q,ne){return re((function(ie){for(var ce=[],de=0;de<ie.length;++de)ce.push(255&ie.charCodeAt(de));return ce})(F),W,Q,ne)}function B(W,F,Q,ne){return P(W,F,Q,ne)}function T(W,F,Q,ne){return re(X(F),W,Q,ne)}function I(W,F,Q,ne){return re((function(ie,ce){for(var de,le,_e,ue=[],pe=0;pe<ie.length&&!((ce-=2)<0);++pe)de=ie.charCodeAt(pe),le=de>>8,_e=de%256,ue.push(_e),ue.push(le);return ue})(F,W.length-Q),W,Q,ne)}function U(W,F,Q){return F===0&&Q===W.length?o.fromByteArray(W):o.fromByteArray(W.slice(F,Q))}function H(W,F,Q){Q=Math.min(W.length,Q);for(var ne=[],ie=F;ie<Q;){var ce,de,le,_e,ue=W[ie],pe=null,me=ue>239?4:ue>223?3:ue>191?2:1;if(ie+me<=Q)switch(me){case 1:ue<128&&(pe=ue);break;case 2:(192&(ce=W[ie+1]))==128&&(_e=(31&ue)<<6|63&ce)>127&&(pe=_e);break;case 3:ce=W[ie+1],de=W[ie+2],(192&ce)==128&&(192&de)==128&&(_e=(15&ue)<<12|(63&ce)<<6|63&de)>2047&&(_e<55296||_e>57343)&&(pe=_e);break;case 4:ce=W[ie+1],de=W[ie+2],le=W[ie+3],(192&ce)==128&&(192&de)==128&&(192&le)==128&&(_e=(15&ue)<<18|(63&ce)<<12|(63&de)<<6|63&le)>65535&&_e<1114112&&(pe=_e)}pe===null?(pe=65533,me=1):pe>65535&&(pe-=65536,ne.push(pe>>>10&1023|55296),pe=56320|1023&pe),ne.push(pe),ie+=me}return(function(Ce){var fe=Ce.length;if(fe<=4096)return String.fromCharCode.apply(String,Ce);for(var xe="",je=0;je<fe;)xe+=String.fromCharCode.apply(String,Ce.slice(je,je+=4096));return xe})(ne)}a.kMaxLength=2147483647,l.TYPED_ARRAY_SUPPORT=(function(){try{var W=new Uint8Array(1);return W.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},W.foo()===42}catch{return!1}})(),l.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(W,F,Q){return d(W,F,Q)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(W,F,Q){return(function(ne,ie,ce){return f(ne),ne<=0?u(ne):ie!==void 0?typeof ce=="string"?u(ne).fill(ie,ce):u(ne).fill(ie):u(ne)})(W,F,Q)},l.allocUnsafe=function(W){return p(W)},l.allocUnsafeSlow=function(W){return p(W)},l.isBuffer=function(W){return W!=null&&W._isBuffer===!0&&W!==l.prototype},l.compare=function(W,F){if(V(W,Uint8Array)&&(W=l.from(W,W.offset,W.byteLength)),V(F,Uint8Array)&&(F=l.from(F,F.offset,F.byteLength)),!l.isBuffer(W)||!l.isBuffer(F))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(W===F)return 0;for(var Q=W.length,ne=F.length,ie=0,ce=Math.min(Q,ne);ie<ce;++ie)if(W[ie]!==F[ie]){Q=W[ie],ne=F[ie];break}return Q<ne?-1:ne<Q?1:0},l.isEncoding=function(W){switch(String(W).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(W,F){if(!Array.isArray(W))throw new TypeError('"list" argument must be an Array of Buffers');if(W.length===0)return l.alloc(0);var Q;if(F===void 0)for(F=0,Q=0;Q<W.length;++Q)F+=W[Q].length;var ne=l.allocUnsafe(F),ie=0;for(Q=0;Q<W.length;++Q){var ce=W[Q];if(V(ce,Uint8Array)&&(ce=l.from(ce)),!l.isBuffer(ce))throw new TypeError('"list" argument must be an Array of Buffers');ce.copy(ne,ie),ie+=ce.length}return ne},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var W=this.length;if(W%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var F=0;F<W;F+=2)x(this,F,F+1);return this},l.prototype.swap32=function(){var W=this.length;if(W%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var F=0;F<W;F+=4)x(this,F,F+3),x(this,F+1,F+2);return this},l.prototype.swap64=function(){var W=this.length;if(W%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var F=0;F<W;F+=8)x(this,F,F+7),x(this,F+1,F+6),x(this,F+2,F+5),x(this,F+3,F+4);return this},l.prototype.toString=function(){var W=this.length;return W===0?"":arguments.length===0?H(this,0,W):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(W){if(!l.isBuffer(W))throw new TypeError("Argument must be a Buffer");return this===W||l.compare(this,W)===0},l.prototype.inspect=function(){var W="",F=a.INSPECT_MAX_BYTES;return W=this.toString("hex",0,F).replace(/(.{2})/g,"$1 ").trim(),this.length>F&&(W+=" ... "),"<Buffer "+W+">"},l.prototype.compare=function(W,F,Q,ne,ie){if(V(W,Uint8Array)&&(W=l.from(W,W.offset,W.byteLength)),!l.isBuffer(W))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof W);if(F===void 0&&(F=0),Q===void 0&&(Q=W?W.length:0),ne===void 0&&(ne=0),ie===void 0&&(ie=this.length),F<0||Q>W.length||ne<0||ie>this.length)throw new RangeError("out of range index");if(ne>=ie&&F>=Q)return 0;if(ne>=ie)return-1;if(F>=Q)return 1;if(this===W)return 0;for(var ce=(ie>>>=0)-(ne>>>=0),de=(Q>>>=0)-(F>>>=0),le=Math.min(ce,de),_e=this.slice(ne,ie),ue=W.slice(F,Q),pe=0;pe<le;++pe)if(_e[pe]!==ue[pe]){ce=_e[pe],de=ue[pe];break}return ce<de?-1:de<ce?1:0},l.prototype.includes=function(W,F,Q){return this.indexOf(W,F,Q)!==-1},l.prototype.indexOf=function(W,F,Q){return v(this,W,F,Q,!0)},l.prototype.lastIndexOf=function(W,F,Q){return v(this,W,F,Q,!1)},l.prototype.write=function(W,F,Q,ne){if(F===void 0)ne="utf8",Q=this.length,F=0;else if(Q===void 0&&typeof F=="string")ne=F,Q=this.length,F=0;else{if(!isFinite(F))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");F>>>=0,isFinite(Q)?(Q>>>=0,ne===void 0&&(ne="utf8")):(ne=Q,Q=void 0)}var ie=this.length-F;if((Q===void 0||Q>ie)&&(Q=ie),W.length>0&&(Q<0||F<0)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");ne||(ne="utf8");for(var ce=!1;;)switch(ne){case"hex":return _(this,W,F,Q);case"utf8":case"utf-8":return A(this,W,F,Q);case"ascii":return P(this,W,F,Q);case"latin1":case"binary":return B(this,W,F,Q);case"base64":return T(this,W,F,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,W,F,Q);default:if(ce)throw new TypeError("Unknown encoding: "+ne);ne=(""+ne).toLowerCase(),ce=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(W,F,Q){var ne="";Q=Math.min(W.length,Q);for(var ie=F;ie<Q;++ie)ne+=String.fromCharCode(127&W[ie]);return ne}function O(W,F,Q){var ne="";Q=Math.min(W.length,Q);for(var ie=F;ie<Q;++ie)ne+=String.fromCharCode(W[ie]);return ne}function L(W,F,Q){var ne=W.length;(!F||F<0)&&(F=0),(!Q||Q<0||Q>ne)&&(Q=ne);for(var ie="",ce=F;ce<Q;++ce)ie+=M(W[ce]);return ie}function E(W,F,Q){for(var ne=W.slice(F,Q),ie="",ce=0;ce<ne.length;ce+=2)ie+=String.fromCharCode(ne[ce]+256*ne[ce+1]);return ie}function k(W,F,Q){if(W%1!=0||W<0)throw new RangeError("offset is not uint");if(W+F>Q)throw new RangeError("Trying to access beyond buffer length")}function N(W,F,Q,ne,ie,ce){if(!l.isBuffer(W))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>ie||F<ce)throw new RangeError('"value" argument is out of bounds');if(Q+ne>W.length)throw new RangeError("Index out of range")}function S(W,F,Q,ne,ie,ce){if(Q+ne>W.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("Index out of range")}function C(W,F,Q,ne,ie){return F=+F,Q>>>=0,ie||S(W,0,Q,4),c.write(W,F,Q,ne,23,4),Q+4}function D(W,F,Q,ne,ie){return F=+F,Q>>>=0,ie||S(W,0,Q,8),c.write(W,F,Q,ne,52,8),Q+8}l.prototype.slice=function(W,F){var Q=this.length;(W=~~W)<0?(W+=Q)<0&&(W=0):W>Q&&(W=Q),(F=F===void 0?Q:~~F)<0?(F+=Q)<0&&(F=0):F>Q&&(F=Q),F<W&&(F=W);var ne=this.subarray(W,F);return ne.__proto__=l.prototype,ne},l.prototype.readUIntLE=function(W,F,Q){W>>>=0,F>>>=0,Q||k(W,F,this.length);for(var ne=this[W],ie=1,ce=0;++ce<F&&(ie*=256);)ne+=this[W+ce]*ie;return ne},l.prototype.readUIntBE=function(W,F,Q){W>>>=0,F>>>=0,Q||k(W,F,this.length);for(var ne=this[W+--F],ie=1;F>0&&(ie*=256);)ne+=this[W+--F]*ie;return ne},l.prototype.readUInt8=function(W,F){return W>>>=0,F||k(W,1,this.length),this[W]},l.prototype.readUInt16LE=function(W,F){return W>>>=0,F||k(W,2,this.length),this[W]|this[W+1]<<8},l.prototype.readUInt16BE=function(W,F){return W>>>=0,F||k(W,2,this.length),this[W]<<8|this[W+1]},l.prototype.readUInt32LE=function(W,F){return W>>>=0,F||k(W,4,this.length),(this[W]|this[W+1]<<8|this[W+2]<<16)+16777216*this[W+3]},l.prototype.readUInt32BE=function(W,F){return W>>>=0,F||k(W,4,this.length),16777216*this[W]+(this[W+1]<<16|this[W+2]<<8|this[W+3])},l.prototype.readIntLE=function(W,F,Q){W>>>=0,F>>>=0,Q||k(W,F,this.length);for(var ne=this[W],ie=1,ce=0;++ce<F&&(ie*=256);)ne+=this[W+ce]*ie;return ne>=(ie*=128)&&(ne-=Math.pow(2,8*F)),ne},l.prototype.readIntBE=function(W,F,Q){W>>>=0,F>>>=0,Q||k(W,F,this.length);for(var ne=F,ie=1,ce=this[W+--ne];ne>0&&(ie*=256);)ce+=this[W+--ne]*ie;return ce>=(ie*=128)&&(ce-=Math.pow(2,8*F)),ce},l.prototype.readInt8=function(W,F){return W>>>=0,F||k(W,1,this.length),128&this[W]?-1*(255-this[W]+1):this[W]},l.prototype.readInt16LE=function(W,F){W>>>=0,F||k(W,2,this.length);var Q=this[W]|this[W+1]<<8;return 32768&Q?4294901760|Q:Q},l.prototype.readInt16BE=function(W,F){W>>>=0,F||k(W,2,this.length);var Q=this[W+1]|this[W]<<8;return 32768&Q?4294901760|Q:Q},l.prototype.readInt32LE=function(W,F){return W>>>=0,F||k(W,4,this.length),this[W]|this[W+1]<<8|this[W+2]<<16|this[W+3]<<24},l.prototype.readInt32BE=function(W,F){return W>>>=0,F||k(W,4,this.length),this[W]<<24|this[W+1]<<16|this[W+2]<<8|this[W+3]},l.prototype.readFloatLE=function(W,F){return W>>>=0,F||k(W,4,this.length),c.read(this,W,!0,23,4)},l.prototype.readFloatBE=function(W,F){return W>>>=0,F||k(W,4,this.length),c.read(this,W,!1,23,4)},l.prototype.readDoubleLE=function(W,F){return W>>>=0,F||k(W,8,this.length),c.read(this,W,!0,52,8)},l.prototype.readDoubleBE=function(W,F){return W>>>=0,F||k(W,8,this.length),c.read(this,W,!1,52,8)},l.prototype.writeUIntLE=function(W,F,Q,ne){W=+W,F>>>=0,Q>>>=0,ne||N(this,W,F,Q,Math.pow(2,8*Q)-1,0);var ie=1,ce=0;for(this[F]=255&W;++ce<Q&&(ie*=256);)this[F+ce]=W/ie&255;return F+Q},l.prototype.writeUIntBE=function(W,F,Q,ne){W=+W,F>>>=0,Q>>>=0,ne||N(this,W,F,Q,Math.pow(2,8*Q)-1,0);var ie=Q-1,ce=1;for(this[F+ie]=255&W;--ie>=0&&(ce*=256);)this[F+ie]=W/ce&255;return F+Q},l.prototype.writeUInt8=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,1,255,0),this[F]=255&W,F+1},l.prototype.writeUInt16LE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,2,65535,0),this[F]=255&W,this[F+1]=W>>>8,F+2},l.prototype.writeUInt16BE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,2,65535,0),this[F]=W>>>8,this[F+1]=255&W,F+2},l.prototype.writeUInt32LE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,4,4294967295,0),this[F+3]=W>>>24,this[F+2]=W>>>16,this[F+1]=W>>>8,this[F]=255&W,F+4},l.prototype.writeUInt32BE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,4,4294967295,0),this[F]=W>>>24,this[F+1]=W>>>16,this[F+2]=W>>>8,this[F+3]=255&W,F+4},l.prototype.writeIntLE=function(W,F,Q,ne){if(W=+W,F>>>=0,!ne){var ie=Math.pow(2,8*Q-1);N(this,W,F,Q,ie-1,-ie)}var ce=0,de=1,le=0;for(this[F]=255&W;++ce<Q&&(de*=256);)W<0&&le===0&&this[F+ce-1]!==0&&(le=1),this[F+ce]=(W/de>>0)-le&255;return F+Q},l.prototype.writeIntBE=function(W,F,Q,ne){if(W=+W,F>>>=0,!ne){var ie=Math.pow(2,8*Q-1);N(this,W,F,Q,ie-1,-ie)}var ce=Q-1,de=1,le=0;for(this[F+ce]=255&W;--ce>=0&&(de*=256);)W<0&&le===0&&this[F+ce+1]!==0&&(le=1),this[F+ce]=(W/de>>0)-le&255;return F+Q},l.prototype.writeInt8=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,1,127,-128),W<0&&(W=255+W+1),this[F]=255&W,F+1},l.prototype.writeInt16LE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,2,32767,-32768),this[F]=255&W,this[F+1]=W>>>8,F+2},l.prototype.writeInt16BE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,2,32767,-32768),this[F]=W>>>8,this[F+1]=255&W,F+2},l.prototype.writeInt32LE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,4,2147483647,-2147483648),this[F]=255&W,this[F+1]=W>>>8,this[F+2]=W>>>16,this[F+3]=W>>>24,F+4},l.prototype.writeInt32BE=function(W,F,Q){return W=+W,F>>>=0,Q||N(this,W,F,4,2147483647,-2147483648),W<0&&(W=4294967295+W+1),this[F]=W>>>24,this[F+1]=W>>>16,this[F+2]=W>>>8,this[F+3]=255&W,F+4},l.prototype.writeFloatLE=function(W,F,Q){return C(this,W,F,!0,Q)},l.prototype.writeFloatBE=function(W,F,Q){return C(this,W,F,!1,Q)},l.prototype.writeDoubleLE=function(W,F,Q){return D(this,W,F,!0,Q)},l.prototype.writeDoubleBE=function(W,F,Q){return D(this,W,F,!1,Q)},l.prototype.copy=function(W,F,Q,ne){if(!l.isBuffer(W))throw new TypeError("argument should be a Buffer");if(Q||(Q=0),ne||ne===0||(ne=this.length),F>=W.length&&(F=W.length),F||(F=0),ne>0&&ne<Q&&(ne=Q),ne===Q||W.length===0||this.length===0)return 0;if(F<0)throw new RangeError("targetStart out of bounds");if(Q<0||Q>=this.length)throw new RangeError("Index out of range");if(ne<0)throw new RangeError("sourceEnd out of bounds");ne>this.length&&(ne=this.length),W.length-F<ne-Q&&(ne=W.length-F+Q);var ie=ne-Q;if(this===W&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(F,Q,ne);else if(this===W&&Q<F&&F<ne)for(var ce=ie-1;ce>=0;--ce)W[ce+F]=this[ce+Q];else Uint8Array.prototype.set.call(W,this.subarray(Q,ne),F);return ie},l.prototype.fill=function(W,F,Q,ne){if(typeof W=="string"){if(typeof F=="string"?(ne=F,F=0,Q=this.length):typeof Q=="string"&&(ne=Q,Q=this.length),ne!==void 0&&typeof ne!="string")throw new TypeError("encoding must be a string");if(typeof ne=="string"&&!l.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);if(W.length===1){var ie=W.charCodeAt(0);(ne==="utf8"&&ie<128||ne==="latin1")&&(W=ie)}}else typeof W=="number"&&(W&=255);if(F<0||this.length<F||this.length<Q)throw new RangeError("Out of range index");if(Q<=F)return this;var ce;if(F>>>=0,Q=Q===void 0?this.length:Q>>>0,W||(W=0),typeof W=="number")for(ce=F;ce<Q;++ce)this[ce]=W;else{var de=l.isBuffer(W)?W:l.from(W,ne),le=de.length;if(le===0)throw new TypeError('The value "'+W+'" is invalid for argument "value"');for(ce=0;ce<Q-F;++ce)this[ce+F]=de[ce%le]}return this};var q=/[^+/0-9A-Za-z-_]/g;function M(W){return W<16?"0"+W.toString(16):W.toString(16)}function G(W,F){var Q;F=F||1/0;for(var ne=W.length,ie=null,ce=[],de=0;de<ne;++de){if((Q=W.charCodeAt(de))>55295&&Q<57344){if(!ie){if(Q>56319){(F-=3)>-1&&ce.push(239,191,189);continue}if(de+1===ne){(F-=3)>-1&&ce.push(239,191,189);continue}ie=Q;continue}if(Q<56320){(F-=3)>-1&&ce.push(239,191,189),ie=Q;continue}Q=65536+(ie-55296<<10|Q-56320)}else ie&&(F-=3)>-1&&ce.push(239,191,189);if(ie=null,Q<128){if((F-=1)<0)break;ce.push(Q)}else if(Q<2048){if((F-=2)<0)break;ce.push(Q>>6|192,63&Q|128)}else if(Q<65536){if((F-=3)<0)break;ce.push(Q>>12|224,Q>>6&63|128,63&Q|128)}else{if(!(Q<1114112))throw new Error("Invalid code point");if((F-=4)<0)break;ce.push(Q>>18|240,Q>>12&63|128,Q>>6&63|128,63&Q|128)}}return ce}function X(W){return o.toByteArray((function(F){if((F=(F=F.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;F.length%4!=0;)F+="=";return F})(W))}function re(W,F,Q,ne){for(var ie=0;ie<ne&&!(ie+Q>=F.length||ie>=W.length);++ie)F[ie+Q]=W[ie];return ie}function V(W,F){return W instanceof F||W!=null&&W.constructor!=null&&W.constructor.name!=null&&W.constructor.name===F.name}function J(W){return W!=W}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("stream").Transform,c=t("string_decoder").StringDecoder;function u(l){o.call(this),this.hashMode=typeof l=="string",this.hashMode?this[l]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}t("inherits")(u,o),u.prototype.update=function(l,d,f){typeof l=="string"&&(l=i.from(l,d));var p=this._update(l);return this.hashMode?this:(f&&(p=this._toString(p,f)),p)},u.prototype.setAutoPadding=function(){},u.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},u.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},u.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},u.prototype._transform=function(l,d,f){var p;try{this.hashMode?this._update(l):this.push(this._update(l))}catch(h){p=h}finally{f(p)}},u.prototype._flush=function(l){var d;try{this.push(this.__final())}catch(f){d=f}l(d)},u.prototype._finalOrDigest=function(l){var d=this.__final()||i.alloc(0);return l&&(d=this._toString(d,l,!0)),d},u.prototype._toString=function(l,d,f){if(this._decoder||(this._decoder=new c(d),this._encoding=d),this._encoding!==d)throw new Error("can't switch encodings");var p=this._decoder.write(l);return f&&(p+=this._decoder.end()),p},n.exports=u},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(t,n,a){var i=t("../internals/is-callable"),o=t("../internals/try-to-string"),c=TypeError;n.exports=function(u){if(i(u))return u;throw new c(o(u)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(t,n,a){var i=t("../internals/is-constructor"),o=t("../internals/try-to-string"),c=TypeError;n.exports=function(u){if(i(u))return u;throw new c(o(u)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(t,n,a){var i=t("../internals/is-callable"),o=String,c=TypeError;n.exports=function(u){if(typeof u=="object"||i(u))return u;throw new c("Can't set "+o(u)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(t,n,a){var i=t("../internals/well-known-symbol"),o=t("../internals/object-create"),c=t("../internals/object-define-property").f,u=i("unscopables"),l=Array.prototype;l[u]===void 0&&c(l,u,{configurable:!0,value:o(null)}),n.exports=function(d){l[u][d]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(t,n,a){var i=t("../internals/object-is-prototype-of"),o=TypeError;n.exports=function(c,u){if(i(u,c))return c;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(t,n,a){var i=t("../internals/is-object"),o=String,c=TypeError;n.exports=function(u){if(i(u))return u;throw new c(o(u)+" is not an object")}},{"../internals/is-object":289}],228:[function(t,n,a){var i=t("../internals/to-indexed-object"),o=t("../internals/to-absolute-index"),c=t("../internals/length-of-array-like"),u=function(l){return function(d,f,p){var h,y=i(d),g=c(y),m=o(p,g);if(l&&f!=f){for(;g>m;)if((h=y[m++])!=h)return!0}else for(;g>m;m++)if((l||m in y)&&y[m]===f)return l||m||0;return!l&&-1}};n.exports={includes:u(!0),indexOf:u(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(t,n,a){var i=t("../internals/function-bind-context"),o=t("../internals/function-uncurry-this"),c=t("../internals/indexed-object"),u=t("../internals/to-object"),l=t("../internals/length-of-array-like"),d=t("../internals/array-species-create"),f=o([].push),p=function(h){var y=h===1,g=h===2,m=h===3,x=h===4,v=h===6,w=h===7,_=h===5||v;return function(A,P,B,T){for(var I,U,H=u(A),z=c(H),O=i(P,B),L=l(z),E=0,k=T||d,N=y?k(A,L):g||w?k(A,0):void 0;L>E;E++)if((_||E in z)&&(U=O(I=z[E],E,H),h))if(y)N[E]=U;else if(U)switch(h){case 3:return!0;case 5:return I;case 6:return E;case 2:f(N,I)}else switch(h){case 4:return!1;case 7:f(N,I)}return v?-1:m||x?x:N}};n.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6),filterReject:p(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(t,n,a){var i=t("../internals/to-absolute-index"),o=t("../internals/length-of-array-like"),c=t("../internals/create-property"),u=Array,l=Math.max;n.exports=function(d,f,p){for(var h=o(d),y=i(f,h),g=i(p===void 0?h:p,h),m=u(l(g-y,0)),x=0;y<g;y++,x++)c(m,x,d[y]);return m.length=x,m}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(t,n,a){var i=t("../internals/function-uncurry-this");n.exports=i([].slice)},{"../internals/function-uncurry-this":268}],232:[function(t,n,a){var i=t("../internals/is-array"),o=t("../internals/is-constructor"),c=t("../internals/is-object"),u=t("../internals/well-known-symbol")("species"),l=Array;n.exports=function(d){var f;return i(d)&&(f=d.constructor,(o(f)&&(f===l||i(f.prototype))||c(f)&&(f=f[u])===null)&&(f=void 0)),f===void 0?l:f}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(t,n,a){var i=t("../internals/array-species-constructor");n.exports=function(o,c){return new(i(o))(c===0?0:c)}},{"../internals/array-species-constructor":232}],234:[function(t,n,a){var i=t("../internals/well-known-symbol")("iterator"),o=!1;try{var c=0,u={next:function(){return{done:!!c++}},return:function(){o=!0}};u[i]=function(){return this},Array.from(u,(function(){throw 2}))}catch{}n.exports=function(l,d){try{if(!d&&!o)return!1}catch{return!1}var f=!1;try{var p={};p[i]=function(){return{next:function(){return{done:f=!0}}}},l(p)}catch{}return f}},{"../internals/well-known-symbol":357}],235:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=i({}.toString),c=i("".slice);n.exports=function(u){return c(o(u),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(t,n,a){var i=t("../internals/to-string-tag-support"),o=t("../internals/is-callable"),c=t("../internals/classof-raw"),u=t("../internals/well-known-symbol")("toStringTag"),l=Object,d=c((function(){return arguments})())==="Arguments";n.exports=i?c:function(f){var p,h,y;return f===void 0?"Undefined":f===null?"Null":typeof(h=(function(g,m){try{return g[m]}catch{}})(p=l(f),u))=="string"?h:d?c(p):(y=c(p))==="Object"&&o(p.callee)?"Arguments":y}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(t,n,a){var i=t("../internals/has-own-property"),o=t("../internals/own-keys"),c=t("../internals/object-get-own-property-descriptor"),u=t("../internals/object-define-property");n.exports=function(l,d,f){for(var p=o(d),h=u.f,y=c.f,g=0;g<p.length;g++){var m=p[g];i(l,m)||f&&i(f,m)||h(l,m,y(d,m))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(t,n,a){var i=t("../internals/well-known-symbol")("match");n.exports=function(o){var c=/./;try{"/./"[o](c)}catch{try{return c[i]=!1,"/./"[o](c)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(t,n,a){var i=t("../internals/fails");n.exports=!i((function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}))},{"../internals/fails":260}],240:[function(t,n,a){n.exports=function(i,o){return{value:i,done:o}}},{}],241:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/object-define-property"),c=t("../internals/create-property-descriptor");n.exports=i?function(u,l,d){return o.f(u,l,c(1,d))}:function(u,l,d){return u[l]=d,u}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(t,n,a){n.exports=function(i,o){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:o}}},{}],243:[function(t,n,a){var i=t("../internals/to-property-key"),o=t("../internals/object-define-property"),c=t("../internals/create-property-descriptor");n.exports=function(u,l,d){var f=i(l);f in u?o.f(u,f,c(0,d)):u[f]=d}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(t,n,a){var i=t("../internals/make-built-in"),o=t("../internals/object-define-property");n.exports=function(c,u,l){return l.get&&i(l.get,u,{getter:!0}),l.set&&i(l.set,u,{setter:!0}),o.f(c,u,l)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(t,n,a){var i=t("../internals/is-callable"),o=t("../internals/object-define-property"),c=t("../internals/make-built-in"),u=t("../internals/define-global-property");n.exports=function(l,d,f,p){p||(p={});var h=p.enumerable,y=p.name!==void 0?p.name:d;if(i(f)&&c(f,y,p),p.global)h?l[d]=f:u(d,f);else{try{p.unsafe?l[d]&&(h=!0):delete l[d]}catch{}h?l[d]=f:o.f(l,d,{value:f,enumerable:!1,configurable:!p.nonConfigurable,writable:!p.nonWritable})}return l}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(t,n,a){var i=t("../internals/global"),o=Object.defineProperty;n.exports=function(c,u){try{o(i,c,{value:u,configurable:!0,writable:!0})}catch{i[c]=u}return u}},{"../internals/global":274}],247:[function(t,n,a){var i=t("../internals/fails");n.exports=!i((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}))},{"../internals/fails":260}],248:[function(t,n,a){var i=typeof document=="object"&&document.all,o=i===void 0&&i!==void 0;n.exports={all:i,IS_HTMLDDA:o}},{}],249:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/is-object"),c=i.document,u=o(c)&&o(c.createElement);n.exports=function(l){return u?c.createElement(l):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(t,n,a){var i=t("../internals/engine-is-deno"),o=t("../internals/engine-is-node");n.exports=!i&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(t,n,a){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(t,n,a){var i=t("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(i)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(t,n,a){var i=t("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},{"../internals/engine-user-agent":256}],254:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/classof-raw");n.exports=o(i.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(t,n,a){var i=t("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(i)},{"../internals/engine-user-agent":256}],256:[function(t,n,a){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(t,n,a){var i,o,c=t("../internals/global"),u=t("../internals/engine-user-agent"),l=c.process,d=c.Deno,f=l&&l.versions||d&&d.version,p=f&&f.v8;p&&(o=(i=p.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&u&&(!(i=u.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=u.match(/Chrome\/(\d+)/))&&(o=+i[1]),n.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(t,n,a){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/object-get-own-property-descriptor").f,c=t("../internals/create-non-enumerable-property"),u=t("../internals/define-built-in"),l=t("../internals/define-global-property"),d=t("../internals/copy-constructor-properties"),f=t("../internals/is-forced");n.exports=function(p,h){var y,g,m,x,v,w=p.target,_=p.global,A=p.stat;if(y=_?i:A?i[w]||l(w,{}):(i[w]||{}).prototype)for(g in h){if(x=h[g],m=p.dontCallGetSet?(v=o(y,g))&&v.value:y[g],!f(_?g:w+(A?".":"#")+g,p.forced)&&m!==void 0){if(typeof x==typeof m)continue;d(x,m)}(p.sham||m&&m.sham)&&c(x,"sham",!0),u(y,g,x,p)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(t,n,a){n.exports=function(i){try{return!!i()}catch{return!0}}},{}],261:[function(t,n,a){var i=t("../internals/function-bind-native"),o=Function.prototype,c=o.apply,u=o.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(i?u.bind(c):function(){return u.apply(c,arguments)})},{"../internals/function-bind-native":263}],262:[function(t,n,a){var i=t("../internals/function-uncurry-this-clause"),o=t("../internals/a-callable"),c=t("../internals/function-bind-native"),u=i(i.bind);n.exports=function(l,d){return o(l),d===void 0?l:c?u(l,d):function(){return l.apply(d,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(t,n,a){var i=t("../internals/fails");n.exports=!i((function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")}))},{"../internals/fails":260}],264:[function(t,n,a){var i=t("../internals/function-bind-native"),o=Function.prototype.call;n.exports=i?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/has-own-property"),c=Function.prototype,u=i&&Object.getOwnPropertyDescriptor,l=o(c,"name"),d=l&&(function(){}).name==="something",f=l&&(!i||i&&u(c,"name").configurable);n.exports={EXISTS:l,PROPER:d,CONFIGURABLE:f}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/a-callable");n.exports=function(c,u,l){try{return i(o(Object.getOwnPropertyDescriptor(c,u)[l]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(t,n,a){var i=t("../internals/classof-raw"),o=t("../internals/function-uncurry-this");n.exports=function(c){if(i(c)==="Function")return o(c)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(t,n,a){var i=t("../internals/function-bind-native"),o=Function.prototype,c=o.call,u=i&&o.bind.bind(c,c);n.exports=i?u:function(l){return function(){return c.apply(l,arguments)}}},{"../internals/function-bind-native":263}],269:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/is-callable"),c=function(u){return o(u)?u:void 0};n.exports=function(u,l){return arguments.length<2?c(i[u]):i[u]&&i[u][l]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(t,n,a){var i=t("../internals/classof"),o=t("../internals/get-method"),c=t("../internals/is-null-or-undefined"),u=t("../internals/iterators"),l=t("../internals/well-known-symbol")("iterator");n.exports=function(d){if(!c(d))return o(d,l)||o(d,"@@iterator")||u[i(d)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(t,n,a){var i=t("../internals/function-call"),o=t("../internals/a-callable"),c=t("../internals/an-object"),u=t("../internals/try-to-string"),l=t("../internals/get-iterator-method"),d=TypeError;n.exports=function(f,p){var h=arguments.length<2?l(f):p;if(o(h))return c(i(h,f));throw new d(u(f)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/is-array"),c=t("../internals/is-callable"),u=t("../internals/classof-raw"),l=t("../internals/to-string"),d=i([].push);n.exports=function(f){if(c(f))return f;if(o(f)){for(var p=f.length,h=[],y=0;y<p;y++){var g=f[y];typeof g=="string"?d(h,g):typeof g!="number"&&u(g)!=="Number"&&u(g)!=="String"||d(h,l(g))}var m=h.length,x=!0;return function(v,w){if(x)return x=!1,w;if(o(this))return w;for(var _=0;_<m;_++)if(h[_]===v)return w}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(t,n,a){var i=t("../internals/a-callable"),o=t("../internals/is-null-or-undefined");n.exports=function(c,u){var l=c[u];return o(l)?void 0:i(l)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(t,n,a){(function(i){(function(){var o=function(c){return c&&c.Math===Math&&c};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof i=="object"&&i)||(function(){return this})()||this||Function("return this")()}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/to-object"),c=i({}.hasOwnProperty);n.exports=Object.hasOwn||function(u,l){return c(o(u),l)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(t,n,a){n.exports={}},{}],277:[function(t,n,a){n.exports=function(i,o){try{arguments.length===1?console.error(i):console.error(i,o)}catch{}}},{}],278:[function(t,n,a){var i=t("../internals/get-built-in");n.exports=i("document","documentElement")},{"../internals/get-built-in":269}],279:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/fails"),c=t("../internals/document-create-element");n.exports=!i&&!o((function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7}))},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/fails"),c=t("../internals/classof-raw"),u=Object,l=i("".split);n.exports=o((function(){return!u("z").propertyIsEnumerable(0)}))?function(d){return c(d)==="String"?l(d,""):u(d)}:u},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/is-callable"),c=t("../internals/shared-store"),u=i(Function.toString);o(c.inspectSource)||(c.inspectSource=function(l){return u(l)}),n.exports=c.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(t,n,a){var i,o,c,u=t("../internals/weak-map-basic-detection"),l=t("../internals/global"),d=t("../internals/is-object"),f=t("../internals/create-non-enumerable-property"),p=t("../internals/has-own-property"),h=t("../internals/shared-store"),y=t("../internals/shared-key"),g=t("../internals/hidden-keys"),m=l.TypeError,x=l.WeakMap;if(u||h.state){var v=h.state||(h.state=new x);v.get=v.get,v.has=v.has,v.set=v.set,i=function(_,A){if(v.has(_))throw new m("Object already initialized");return A.facade=_,v.set(_,A),A},o=function(_){return v.get(_)||{}},c=function(_){return v.has(_)}}else{var w=y("state");g[w]=!0,i=function(_,A){if(p(_,w))throw new m("Object already initialized");return A.facade=_,f(_,w,A),A},o=function(_){return p(_,w)?_[w]:{}},c=function(_){return p(_,w)}}n.exports={set:i,get:o,has:c,enforce:function(_){return c(_)?o(_):i(_,{})},getterFor:function(_){return function(A){var P;if(!d(A)||(P=o(A)).type!==_)throw new m("Incompatible receiver, "+_+" required");return P}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(t,n,a){var i=t("../internals/well-known-symbol"),o=t("../internals/iterators"),c=i("iterator"),u=Array.prototype;n.exports=function(l){return l!==void 0&&(o.Array===l||u[c]===l)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(t,n,a){var i=t("../internals/classof-raw");n.exports=Array.isArray||function(o){return i(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(t,n,a){var i=t("../internals/document-all"),o=i.all;n.exports=i.IS_HTMLDDA?function(c){return typeof c=="function"||c===o}:function(c){return typeof c=="function"}},{"../internals/document-all":248}],286:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/fails"),c=t("../internals/is-callable"),u=t("../internals/classof"),l=t("../internals/get-built-in"),d=t("../internals/inspect-source"),f=function(){},p=[],h=l("Reflect","construct"),y=/^\s*(?:class|function)\b/,g=i(y.exec),m=!y.test(f),x=function(w){if(!c(w))return!1;try{return h(f,p,w),!0}catch{return!1}},v=function(w){if(!c(w))return!1;switch(u(w)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return m||!!g(y,d(w))}catch{return!0}};v.sham=!0,n.exports=!h||o((function(){var w;return x(x.call)||!x(Object)||!x((function(){w=!0}))||w}))?v:x},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(t,n,a){var i=t("../internals/fails"),o=t("../internals/is-callable"),c=/#|\.prototype\./,u=function(h,y){var g=d[l(h)];return g===p||g!==f&&(o(y)?i(y):!!y)},l=u.normalize=function(h){return String(h).replace(c,".").toLowerCase()},d=u.data={},f=u.NATIVE="N",p=u.POLYFILL="P";n.exports=u},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(t,n,a){n.exports=function(i){return i==null}},{}],289:[function(t,n,a){var i=t("../internals/is-callable"),o=t("../internals/document-all"),c=o.all;n.exports=o.IS_HTMLDDA?function(u){return typeof u=="object"?u!==null:i(u)||u===c}:function(u){return typeof u=="object"?u!==null:i(u)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(t,n,a){n.exports=!1},{}],291:[function(t,n,a){var i=t("../internals/is-object"),o=t("../internals/classof-raw"),c=t("../internals/well-known-symbol")("match");n.exports=function(u){var l;return i(u)&&((l=u[c])!==void 0?!!l:o(u)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(t,n,a){var i=t("../internals/get-built-in"),o=t("../internals/is-callable"),c=t("../internals/object-is-prototype-of"),u=t("../internals/use-symbol-as-uid"),l=Object;n.exports=u?function(d){return typeof d=="symbol"}:function(d){var f=i("Symbol");return o(f)&&c(f.prototype,l(d))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(t,n,a){var i=t("../internals/function-bind-context"),o=t("../internals/function-call"),c=t("../internals/an-object"),u=t("../internals/try-to-string"),l=t("../internals/is-array-iterator-method"),d=t("../internals/length-of-array-like"),f=t("../internals/object-is-prototype-of"),p=t("../internals/get-iterator"),h=t("../internals/get-iterator-method"),y=t("../internals/iterator-close"),g=TypeError,m=function(v,w){this.stopped=v,this.result=w},x=m.prototype;n.exports=function(v,w,_){var A,P,B,T,I,U,H,z=_&&_.that,O=!(!_||!_.AS_ENTRIES),L=!(!_||!_.IS_RECORD),E=!(!_||!_.IS_ITERATOR),k=!(!_||!_.INTERRUPTED),N=i(w,z),S=function(D){return A&&y(A,"normal",D),new m(!0,D)},C=function(D){return O?(c(D),k?N(D[0],D[1],S):N(D[0],D[1])):k?N(D,S):N(D)};if(L)A=v.iterator;else if(E)A=v;else{if(!(P=h(v)))throw new g(u(v)+" is not iterable");if(l(P)){for(B=0,T=d(v);T>B;B++)if((I=C(v[B]))&&f(x,I))return I;return new m(!1)}A=p(v,P)}for(U=L?v.next:A.next;!(H=o(U,A)).done;){try{I=C(H.value)}catch(D){y(A,"throw",D)}if(typeof I=="object"&&I&&f(x,I))return I}return new m(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(t,n,a){var i=t("../internals/function-call"),o=t("../internals/an-object"),c=t("../internals/get-method");n.exports=function(u,l,d){var f,p;o(u);try{if(!(f=c(u,"return"))){if(l==="throw")throw d;return d}f=i(f,u)}catch(h){p=!0,f=h}if(l==="throw")throw d;if(p)throw f;return o(f),d}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(t,n,a){var i=t("../internals/iterators-core").IteratorPrototype,o=t("../internals/object-create"),c=t("../internals/create-property-descriptor"),u=t("../internals/set-to-string-tag"),l=t("../internals/iterators"),d=function(){return this};n.exports=function(f,p,h,y){var g=p+" Iterator";return f.prototype=o(i,{next:c(+!y,h)}),u(f,g,!1,!0),l[g]=d,f}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-call"),c=t("../internals/is-pure"),u=t("../internals/function-name"),l=t("../internals/is-callable"),d=t("../internals/iterator-create-constructor"),f=t("../internals/object-get-prototype-of"),p=t("../internals/object-set-prototype-of"),h=t("../internals/set-to-string-tag"),y=t("../internals/create-non-enumerable-property"),g=t("../internals/define-built-in"),m=t("../internals/well-known-symbol"),x=t("../internals/iterators"),v=t("../internals/iterators-core"),w=u.PROPER,_=u.CONFIGURABLE,A=v.IteratorPrototype,P=v.BUGGY_SAFARI_ITERATORS,B=m("iterator"),T=function(){return this};n.exports=function(I,U,H,z,O,L,E){d(H,U,z);var k,N,S,C=function(V){if(V===O&&X)return X;if(!P&&V&&V in M)return M[V];switch(V){case"keys":case"values":case"entries":return function(){return new H(this,V)}}return function(){return new H(this)}},D=U+" Iterator",q=!1,M=I.prototype,G=M[B]||M["@@iterator"]||O&&M[O],X=!P&&G||C(O),re=U==="Array"&&M.entries||G;if(re&&(k=f(re.call(new I)))!==Object.prototype&&k.next&&(c||f(k)===A||(p?p(k,A):l(k[B])||g(k,B,T)),h(k,D,!0,!0),c&&(x[D]=T)),w&&O==="values"&&G&&G.name!=="values"&&(!c&&_?y(M,"name","values"):(q=!0,X=function(){return o(G,this)})),O)if(N={values:C("values"),keys:L?X:C("keys"),entries:C("entries")},E)for(S in N)(P||q||!(S in M))&&g(M,S,N[S]);else i({target:U,proto:!0,forced:P||q},N);return c&&!E||M[B]===X||g(M,B,X,{name:O}),x[U]=X,N}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(t,n,a){var i,o,c,u=t("../internals/fails"),l=t("../internals/is-callable"),d=t("../internals/is-object"),f=t("../internals/object-create"),p=t("../internals/object-get-prototype-of"),h=t("../internals/define-built-in"),y=t("../internals/well-known-symbol"),g=t("../internals/is-pure"),m=y("iterator"),x=!1;[].keys&&("next"in(c=[].keys())?(o=p(p(c)))!==Object.prototype&&(i=o):x=!0),!d(i)||u((function(){var v={};return i[m].call(v)!==v}))?i={}:g&&(i=f(i)),l(i[m])||h(i,m,(function(){return this})),n.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:x}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(t,n,a){arguments[4][276][0].apply(a,arguments)},{dup:276}],299:[function(t,n,a){var i=t("../internals/to-length");n.exports=function(o){return i(o.length)}},{"../internals/to-length":343}],300:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/fails"),c=t("../internals/is-callable"),u=t("../internals/has-own-property"),l=t("../internals/descriptors"),d=t("../internals/function-name").CONFIGURABLE,f=t("../internals/inspect-source"),p=t("../internals/internal-state"),h=p.enforce,y=p.get,g=String,m=Object.defineProperty,x=i("".slice),v=i("".replace),w=i([].join),_=l&&!o((function(){return m((function(){}),"length",{value:8}).length!==8})),A=String(String).split("String"),P=n.exports=function(B,T,I){x(g(T),0,7)==="Symbol("&&(T="["+v(g(T),/^Symbol\(([^)]*)\)/,"$1")+"]"),I&&I.getter&&(T="get "+T),I&&I.setter&&(T="set "+T),(!u(B,"name")||d&&B.name!==T)&&(l?m(B,"name",{value:T,configurable:!0}):B.name=T),_&&I&&u(I,"arity")&&B.length!==I.arity&&m(B,"length",{value:I.arity});try{I&&u(I,"constructor")&&I.constructor?l&&m(B,"prototype",{writable:!1}):B.prototype&&(B.prototype=void 0)}catch{}var U=h(B);return u(U,"source")||(U.source=w(A,typeof T=="string"?T:"")),B};Function.prototype.toString=P((function(){return c(this)&&y(this).source||f(this)}),"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(t,n,a){var i=Math.ceil,o=Math.floor;n.exports=Math.trunc||function(c){var u=+c;return(u>0?o:i)(u)}},{}],302:[function(t,n,a){var i,o,c,u,l,d=t("../internals/global"),f=t("../internals/function-bind-context"),p=t("../internals/object-get-own-property-descriptor").f,h=t("../internals/task").set,y=t("../internals/queue"),g=t("../internals/engine-is-ios"),m=t("../internals/engine-is-ios-pebble"),x=t("../internals/engine-is-webos-webkit"),v=t("../internals/engine-is-node"),w=d.MutationObserver||d.WebKitMutationObserver,_=d.document,A=d.process,P=d.Promise,B=p(d,"queueMicrotask"),T=B&&B.value;if(!T){var I=new y,U=function(){var H,z;for(v&&(H=A.domain)&&H.exit();z=I.get();)try{z()}catch(O){throw I.head&&i(),O}H&&H.enter()};g||v||x||!w||!_?!m&&P&&P.resolve?((u=P.resolve(void 0)).constructor=P,l=f(u.then,u),i=function(){l(U)}):v?i=function(){A.nextTick(U)}:(h=f(h,d),i=function(){h(U)}):(o=!0,c=_.createTextNode(""),new w(U).observe(c,{characterData:!0}),i=function(){c.data=o=!o}),T=function(H){I.head||i(),I.add(H)}}n.exports=T},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(t,n,a){var i=t("../internals/a-callable"),o=TypeError,c=function(u){var l,d;this.promise=new u((function(f,p){if(l!==void 0||d!==void 0)throw new o("Bad Promise constructor");l=f,d=p})),this.resolve=i(l),this.reject=i(d)};n.exports.f=function(u){return new c(u)}},{"../internals/a-callable":222}],304:[function(t,n,a){var i=t("../internals/is-regexp"),o=TypeError;n.exports=function(c){if(i(c))throw new o("The method doesn't accept regular expressions");return c}},{"../internals/is-regexp":291}],305:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/function-uncurry-this"),c=t("../internals/function-call"),u=t("../internals/fails"),l=t("../internals/object-keys"),d=t("../internals/object-get-own-property-symbols"),f=t("../internals/object-property-is-enumerable"),p=t("../internals/to-object"),h=t("../internals/indexed-object"),y=Object.assign,g=Object.defineProperty,m=o([].concat);n.exports=!y||u((function(){if(i&&y({b:1},y(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},v={},w=Symbol("assign detection");return x[w]=7,"abcdefghijklmnopqrst".split("").forEach((function(_){v[_]=_})),y({},x)[w]!==7||l(y({},v)).join("")!=="abcdefghijklmnopqrst"}))?function(x,v){for(var w=p(x),_=arguments.length,A=1,P=d.f,B=f.f;_>A;)for(var T,I=h(arguments[A++]),U=P?m(l(I),P(I)):l(I),H=U.length,z=0;H>z;)T=U[z++],i&&!c(B,I,T)||(w[T]=I[T]);return w}:y},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(t,n,a){var i,o=t("../internals/an-object"),c=t("../internals/object-define-properties"),u=t("../internals/enum-bug-keys"),l=t("../internals/hidden-keys"),d=t("../internals/html"),f=t("../internals/document-create-element"),p=t("../internals/shared-key"),h=p("IE_PROTO"),y=function(){},g=function(v){return"<script>"+v+"<\/script>"},m=function(v){v.write(g("")),v.close();var w=v.parentWindow.Object;return v=null,w},x=function(){try{i=new ActiveXObject("htmlfile")}catch{}var v,w;x=typeof document<"u"?document.domain&&i?m(i):((w=f("iframe")).style.display="none",d.appendChild(w),w.src="javascript:",(v=w.contentWindow.document).open(),v.write(g("document.F=Object")),v.close(),v.F):m(i);for(var _=u.length;_--;)delete x.prototype[u[_]];return x()};l[h]=!0,n.exports=Object.create||function(v,w){var _;return v!==null?(y.prototype=o(v),_=new y,y.prototype=null,_[h]=v):_=x(),w===void 0?_:c.f(_,w)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/v8-prototype-define-bug"),c=t("../internals/object-define-property"),u=t("../internals/an-object"),l=t("../internals/to-indexed-object"),d=t("../internals/object-keys");a.f=i&&!o?Object.defineProperties:function(f,p){u(f);for(var h,y=l(p),g=d(p),m=g.length,x=0;m>x;)c.f(f,h=g[x++],y[h]);return f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/ie8-dom-define"),c=t("../internals/v8-prototype-define-bug"),u=t("../internals/an-object"),l=t("../internals/to-property-key"),d=TypeError,f=Object.defineProperty,p=Object.getOwnPropertyDescriptor;a.f=i?c?function(h,y,g){if(u(h),y=l(y),u(g),typeof h=="function"&&y==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var m=p(h,y);m&&m.writable&&(h[y]=g.value,g={configurable:"configurable"in g?g.configurable:m.configurable,enumerable:"enumerable"in g?g.enumerable:m.enumerable,writable:!1})}return f(h,y,g)}:f:function(h,y,g){if(u(h),y=l(y),u(g),o)try{return f(h,y,g)}catch{}if("get"in g||"set"in g)throw new d("Accessors not supported");return"value"in g&&(h[y]=g.value),h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/function-call"),c=t("../internals/object-property-is-enumerable"),u=t("../internals/create-property-descriptor"),l=t("../internals/to-indexed-object"),d=t("../internals/to-property-key"),f=t("../internals/has-own-property"),p=t("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;a.f=i?h:function(y,g){if(y=l(y),g=d(g),p)try{return h(y,g)}catch{}if(f(y,g))return u(!o(c.f,y,g),y[g])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(t,n,a){var i=t("../internals/classof-raw"),o=t("../internals/to-indexed-object"),c=t("../internals/object-get-own-property-names").f,u=t("../internals/array-slice-simple"),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(d){return l&&i(d)==="Window"?(function(f){try{return c(f)}catch{return u(l)}})(d):c(o(d))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(t,n,a){var i=t("../internals/object-keys-internal"),o=t("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(c){return i(c,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(t,n,a){a.f=Object.getOwnPropertySymbols},{}],313:[function(t,n,a){var i=t("../internals/has-own-property"),o=t("../internals/is-callable"),c=t("../internals/to-object"),u=t("../internals/shared-key"),l=t("../internals/correct-prototype-getter"),d=u("IE_PROTO"),f=Object,p=f.prototype;n.exports=l?f.getPrototypeOf:function(h){var y=c(h);if(i(y,d))return y[d];var g=y.constructor;return o(g)&&y instanceof g?g.prototype:y instanceof f?p:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(t,n,a){var i=t("../internals/function-uncurry-this");n.exports=i({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=t("../internals/has-own-property"),c=t("../internals/to-indexed-object"),u=t("../internals/array-includes").indexOf,l=t("../internals/hidden-keys"),d=i([].push);n.exports=function(f,p){var h,y=c(f),g=0,m=[];for(h in y)!o(l,h)&&o(y,h)&&d(m,h);for(;p.length>g;)o(y,h=p[g++])&&(~u(m,h)||d(m,h));return m}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(t,n,a){var i=t("../internals/object-keys-internal"),o=t("../internals/enum-bug-keys");n.exports=Object.keys||function(c){return i(c,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(t,n,a){var i={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,c=o&&!i.call({1:2},1);a.f=c?function(u){var l=o(this,u);return!!l&&l.enumerable}:i},{}],318:[function(t,n,a){var i=t("../internals/function-uncurry-this-accessor"),o=t("../internals/an-object"),c=t("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var u,l=!1,d={};try{(u=i(Object.prototype,"__proto__","set"))(d,[]),l=d instanceof Array}catch{}return function(f,p){return o(f),c(p),l?u(f,p):f.__proto__=p,f}})():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/fails"),c=t("../internals/function-uncurry-this"),u=t("../internals/object-get-prototype-of"),l=t("../internals/object-keys"),d=t("../internals/to-indexed-object"),f=c(t("../internals/object-property-is-enumerable").f),p=c([].push),h=i&&o((function(){var g=Object.create(null);return g[2]=2,!f(g,2)})),y=function(g){return function(m){for(var x,v=d(m),w=l(v),_=h&&u(v)===null,A=w.length,P=0,B=[];A>P;)x=w[P++],i&&!(_?x in v:f(v,x))||p(B,g?[x,v[x]]:v[x]);return B}};n.exports={entries:y(!0),values:y(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(t,n,a){var i=t("../internals/function-call"),o=t("../internals/is-callable"),c=t("../internals/is-object"),u=TypeError;n.exports=function(l,d){var f,p;if(d==="string"&&o(f=l.toString)&&!c(p=i(f,l))||o(f=l.valueOf)&&!c(p=i(f,l))||d!=="string"&&o(f=l.toString)&&!c(p=i(f,l)))return p;throw new u("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(t,n,a){var i=t("../internals/get-built-in"),o=t("../internals/function-uncurry-this"),c=t("../internals/object-get-own-property-names"),u=t("../internals/object-get-own-property-symbols"),l=t("../internals/an-object"),d=o([].concat);n.exports=i("Reflect","ownKeys")||function(f){var p=c.f(l(f)),h=u.f;return h?d(p,h(f)):p}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(t,n,a){var i=t("../internals/global");n.exports=i},{"../internals/global":274}],323:[function(t,n,a){n.exports=function(i){try{return{error:!1,value:i()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/promise-native-constructor"),c=t("../internals/is-callable"),u=t("../internals/is-forced"),l=t("../internals/inspect-source"),d=t("../internals/well-known-symbol"),f=t("../internals/engine-is-browser"),p=t("../internals/engine-is-deno"),h=t("../internals/is-pure"),y=t("../internals/engine-v8-version"),g=o&&o.prototype,m=d("species"),x=!1,v=c(i.PromiseRejectionEvent),w=u("Promise",(function(){var _=l(o),A=_!==String(o);if(!A&&y===66||h&&(!g.catch||!g.finally))return!0;if(!y||y<51||!/native code/.test(_)){var P=new o((function(T){T(1)})),B=function(T){T((function(){}),(function(){}))};if((P.constructor={})[m]=B,!(x=P.then((function(){}))instanceof B))return!0}return!A&&(f||p)&&!v}));n.exports={CONSTRUCTOR:w,REJECTION_EVENT:v,SUBCLASSING:x}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(t,n,a){var i=t("../internals/global");n.exports=i.Promise},{"../internals/global":274}],326:[function(t,n,a){var i=t("../internals/an-object"),o=t("../internals/is-object"),c=t("../internals/new-promise-capability");n.exports=function(u,l){if(i(u),o(l)&&l.constructor===u)return l;var d=c.f(u);return(0,d.resolve)(l),d.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(t,n,a){var i=t("../internals/promise-native-constructor"),o=t("../internals/check-correctness-of-iteration"),c=t("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=c||!o((function(u){i.all(u).then(void 0,(function(){}))}))},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(t,n,a){var i=function(){this.head=null,this.tail=null};i.prototype={add:function(o){var c={item:o,next:null},u=this.tail;u?u.next=c:this.head=c,this.tail=c},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},n.exports=i},{}],329:[function(t,n,a){var i=t("../internals/is-null-or-undefined"),o=TypeError;n.exports=function(c){if(i(c))throw new o("Can't call method on "+c);return c}},{"../internals/is-null-or-undefined":288}],330:[function(t,n,a){var i=t("../internals/get-built-in"),o=t("../internals/define-built-in-accessor"),c=t("../internals/well-known-symbol"),u=t("../internals/descriptors"),l=c("species");n.exports=function(d){var f=i(d);u&&f&&!f[l]&&o(f,l,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(t,n,a){var i=t("../internals/object-define-property").f,o=t("../internals/has-own-property"),c=t("../internals/well-known-symbol")("toStringTag");n.exports=function(u,l,d){u&&!d&&(u=u.prototype),u&&!o(u,c)&&i(u,c,{configurable:!0,value:l})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(t,n,a){var i=t("../internals/shared"),o=t("../internals/uid"),c=i("keys");n.exports=function(u){return c[u]||(c[u]=o(u))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/define-global-property"),c=i["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=c},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(t,n,a){var i=t("../internals/is-pure"),o=t("../internals/shared-store");(n.exports=function(c,u){return o[c]||(o[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.33.0",mode:i?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(t,n,a){var i=t("../internals/an-object"),o=t("../internals/a-constructor"),c=t("../internals/is-null-or-undefined"),u=t("../internals/well-known-symbol")("species");n.exports=function(l,d){var f,p=i(l).constructor;return p===void 0||c(f=i(p)[u])?d:o(f)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(t,n,a){var i=t("../internals/engine-v8-version"),o=t("../internals/fails"),c=t("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!o((function(){var u=Symbol("symbol detection");return!c(u)||!(Object(u)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(t,n,a){var i=t("../internals/function-call"),o=t("../internals/get-built-in"),c=t("../internals/well-known-symbol"),u=t("../internals/define-built-in");n.exports=function(){var l=o("Symbol"),d=l&&l.prototype,f=d&&d.valueOf,p=c("toPrimitive");d&&!d[p]&&u(d,p,(function(h){return i(f,this)}),{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(t,n,a){var i=t("../internals/symbol-constructor-detection");n.exports=i&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(t,n,a){var i,o,c,u,l=t("../internals/global"),d=t("../internals/function-apply"),f=t("../internals/function-bind-context"),p=t("../internals/is-callable"),h=t("../internals/has-own-property"),y=t("../internals/fails"),g=t("../internals/html"),m=t("../internals/array-slice"),x=t("../internals/document-create-element"),v=t("../internals/validate-arguments-length"),w=t("../internals/engine-is-ios"),_=t("../internals/engine-is-node"),A=l.setImmediate,P=l.clearImmediate,B=l.process,T=l.Dispatch,I=l.Function,U=l.MessageChannel,H=l.String,z=0,O={};y((function(){i=l.location}));var L=function(S){if(h(O,S)){var C=O[S];delete O[S],C()}},E=function(S){return function(){L(S)}},k=function(S){L(S.data)},N=function(S){l.postMessage(H(S),i.protocol+"//"+i.host)};A&&P||(A=function(S){v(arguments.length,1);var C=p(S)?S:I(S),D=m(arguments,1);return O[++z]=function(){d(C,void 0,D)},o(z),z},P=function(S){delete O[S]},_?o=function(S){B.nextTick(E(S))}:T&&T.now?o=function(S){T.now(E(S))}:U&&!w?(u=(c=new U).port2,c.port1.onmessage=k,o=f(u.postMessage,u)):l.addEventListener&&p(l.postMessage)&&!l.importScripts&&i&&i.protocol!=="file:"&&!y(N)?(o=N,l.addEventListener("message",k,!1)):o="onreadystatechange"in x("script")?function(S){g.appendChild(x("script")).onreadystatechange=function(){g.removeChild(this),L(S)}}:function(S){setTimeout(E(S),0)}),n.exports={set:A,clear:P}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(t,n,a){var i=t("../internals/to-integer-or-infinity"),o=Math.max,c=Math.min;n.exports=function(u,l){var d=i(u);return d<0?o(d+l,0):c(d,l)}},{"../internals/to-integer-or-infinity":342}],341:[function(t,n,a){var i=t("../internals/indexed-object"),o=t("../internals/require-object-coercible");n.exports=function(c){return i(o(c))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(t,n,a){var i=t("../internals/math-trunc");n.exports=function(o){var c=+o;return c!=c||c===0?0:i(c)}},{"../internals/math-trunc":301}],343:[function(t,n,a){var i=t("../internals/to-integer-or-infinity"),o=Math.min;n.exports=function(c){return c>0?o(i(c),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(t,n,a){var i=t("../internals/require-object-coercible"),o=Object;n.exports=function(c){return o(i(c))}},{"../internals/require-object-coercible":329}],345:[function(t,n,a){var i=t("../internals/function-call"),o=t("../internals/is-object"),c=t("../internals/is-symbol"),u=t("../internals/get-method"),l=t("../internals/ordinary-to-primitive"),d=t("../internals/well-known-symbol"),f=TypeError,p=d("toPrimitive");n.exports=function(h,y){if(!o(h)||c(h))return h;var g,m=u(h,p);if(m){if(y===void 0&&(y="default"),g=i(m,h,y),!o(g)||c(g))return g;throw new f("Can't convert object to primitive value")}return y===void 0&&(y="number"),l(h,y)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(t,n,a){var i=t("../internals/to-primitive"),o=t("../internals/is-symbol");n.exports=function(c){var u=i(c,"string");return o(u)?u:u+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(t,n,a){var i={};i[t("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(i)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(t,n,a){var i=t("../internals/classof"),o=String;n.exports=function(c){if(i(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(c)}},{"../internals/classof":236}],349:[function(t,n,a){var i=String;n.exports=function(o){try{return i(o)}catch{return"Object"}}},{}],350:[function(t,n,a){var i=t("../internals/function-uncurry-this"),o=0,c=Math.random(),u=i(1 .toString);n.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+u(++o+c,36)}},{"../internals/function-uncurry-this":268}],351:[function(t,n,a){var i=t("../internals/symbol-constructor-detection");n.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(t,n,a){var i=t("../internals/descriptors"),o=t("../internals/fails");n.exports=i&&o((function(){return Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype!==42}))},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(t,n,a){var i=TypeError;n.exports=function(o,c){if(o<c)throw new i("Not enough arguments");return o}},{}],354:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/is-callable"),c=i.WeakMap;n.exports=o(c)&&/native code/.test(String(c))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(t,n,a){var i=t("../internals/path"),o=t("../internals/has-own-property"),c=t("../internals/well-known-symbol-wrapped"),u=t("../internals/object-define-property").f;n.exports=function(l){var d=i.Symbol||(i.Symbol={});o(d,l)||u(d,l,{value:c.f(l)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(t,n,a){var i=t("../internals/well-known-symbol");a.f=i},{"../internals/well-known-symbol":357}],357:[function(t,n,a){var i=t("../internals/global"),o=t("../internals/shared"),c=t("../internals/has-own-property"),u=t("../internals/uid"),l=t("../internals/symbol-constructor-detection"),d=t("../internals/use-symbol-as-uid"),f=i.Symbol,p=o("wks"),h=d?f.for||f:f&&f.withoutSetter||u;n.exports=function(y){return c(p,y)||(p[y]=l&&c(f,y)?f[y]:h("Symbol."+y)),p[y]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/array-iteration").findIndex,c=t("../internals/add-to-unscopables"),u=!0;"findIndex"in[]&&Array(1).findIndex((function(){u=!1})),i({target:"Array",proto:!0,forced:u},{findIndex:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),c("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/array-iteration").find,c=t("../internals/add-to-unscopables"),u=!0;"find"in[]&&Array(1).find((function(){u=!1})),i({target:"Array",proto:!0,forced:u},{find:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),c("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/array-includes").includes,c=t("../internals/fails"),u=t("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:c((function(){return!Array(1).includes()}))},{includes:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),u("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(t,n,a){var i=t("../internals/to-indexed-object"),o=t("../internals/add-to-unscopables"),c=t("../internals/iterators"),u=t("../internals/internal-state"),l=t("../internals/object-define-property").f,d=t("../internals/iterator-define"),f=t("../internals/create-iter-result-object"),p=t("../internals/is-pure"),h=t("../internals/descriptors"),y=u.set,g=u.getterFor("Array Iterator");n.exports=d(Array,"Array",(function(x,v){y(this,{type:"Array Iterator",target:i(x),index:0,kind:v})}),(function(){var x=g(this),v=x.target,w=x.kind,_=x.index++;if(!v||_>=v.length)return x.target=void 0,f(void 0,!0);switch(w){case"keys":return f(_,!1);case"values":return f(v[_],!1)}return f([_,v[_]],!1)}),"values");var m=c.Arguments=c.Array;if(o("keys"),o("values"),o("entries"),!p&&h&&m.name!=="values")try{l(m,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/get-built-in"),c=t("../internals/function-apply"),u=t("../internals/function-call"),l=t("../internals/function-uncurry-this"),d=t("../internals/fails"),f=t("../internals/is-callable"),p=t("../internals/is-symbol"),h=t("../internals/array-slice"),y=t("../internals/get-json-replacer-function"),g=t("../internals/symbol-constructor-detection"),m=String,x=o("JSON","stringify"),v=l(/./.exec),w=l("".charAt),_=l("".charCodeAt),A=l("".replace),P=l(1 .toString),B=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,I=/^[\uDC00-\uDFFF]$/,U=!g||d((function(){var L=o("Symbol")("stringify detection");return x([L])!=="[null]"||x({a:L})!=="{}"||x(Object(L))!=="{}"})),H=d((function(){return x("\uDF06\uD834")!=='"\\udf06\\ud834"'||x("\uDEAD")!=='"\\udead"'})),z=function(L,E){var k=h(arguments),N=y(E);if(f(N)||L!==void 0&&!p(L))return k[1]=function(S,C){if(f(N)&&(C=u(N,this,m(S),C)),!p(C))return C},c(x,null,k)},O=function(L,E,k){var N=w(k,E-1),S=w(k,E+1);return v(T,L)&&!v(I,S)||v(I,L)&&!v(T,N)?"\\u"+P(_(L,0),16):L};x&&i({target:"JSON",stat:!0,arity:3,forced:U||H},{stringify:function(L,E,k){var N=h(arguments),S=c(U?z:x,null,N);return H&&typeof S=="string"?A(S,B,O):S}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(t,n,a){t("../internals/export")({target:"Number",stat:!0},{isNaN:function(i){return i!=i}})},{"../internals/export":259}],364:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/object-assign");i({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/symbol-constructor-detection"),c=t("../internals/fails"),u=t("../internals/object-get-own-property-symbols"),l=t("../internals/to-object");i({target:"Object",stat:!0,forced:!o||c((function(){u.f(1)}))},{getOwnPropertySymbols:function(d){var f=u.f;return f?f(l(d)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/to-object"),c=t("../internals/object-keys");i({target:"Object",stat:!0,forced:t("../internals/fails")((function(){c(1)}))},{keys:function(u){return c(o(u))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/object-to-array").values;i({target:"Object",stat:!0},{values:function(c){return o(c)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-call"),c=t("../internals/a-callable"),u=t("../internals/new-promise-capability"),l=t("../internals/perform"),d=t("../internals/iterate");i({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{all:function(f){var p=this,h=u.f(p),y=h.resolve,g=h.reject,m=l((function(){var x=c(p.resolve),v=[],w=0,_=1;d(f,(function(A){var P=w++,B=!1;_++,o(x,p,A).then((function(T){B||(B=!0,v[P]=T,--_||y(v))}),g)})),--_||y(v)}));return m.error&&g(m.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/is-pure"),c=t("../internals/promise-constructor-detection").CONSTRUCTOR,u=t("../internals/promise-native-constructor"),l=t("../internals/get-built-in"),d=t("../internals/is-callable"),f=t("../internals/define-built-in"),p=u&&u.prototype;if(i({target:"Promise",proto:!0,forced:c,real:!0},{catch:function(y){return this.then(void 0,y)}}),!o&&d(u)){var h=l("Promise").prototype.catch;p.catch!==h&&f(p,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(t,n,a){var i,o,c,u=t("../internals/export"),l=t("../internals/is-pure"),d=t("../internals/engine-is-node"),f=t("../internals/global"),p=t("../internals/function-call"),h=t("../internals/define-built-in"),y=t("../internals/object-set-prototype-of"),g=t("../internals/set-to-string-tag"),m=t("../internals/set-species"),x=t("../internals/a-callable"),v=t("../internals/is-callable"),w=t("../internals/is-object"),_=t("../internals/an-instance"),A=t("../internals/species-constructor"),P=t("../internals/task").set,B=t("../internals/microtask"),T=t("../internals/host-report-errors"),I=t("../internals/perform"),U=t("../internals/queue"),H=t("../internals/internal-state"),z=t("../internals/promise-native-constructor"),O=t("../internals/promise-constructor-detection"),L=t("../internals/new-promise-capability"),E=O.CONSTRUCTOR,k=O.REJECTION_EVENT,N=O.SUBCLASSING,S=H.getterFor("Promise"),C=H.set,D=z&&z.prototype,q=z,M=D,G=f.TypeError,X=f.document,re=f.process,V=L.f,J=V,W=!!(X&&X.createEvent&&f.dispatchEvent),F=function(me){var Ce;return!(!w(me)||!v(Ce=me.then))&&Ce},Q=function(me,Ce){var fe,xe,je,Oe=Ce.value,Ie=Ce.state===1,Le=Ie?me.ok:me.fail,He=me.resolve,Qe=me.reject,Je=me.domain;try{Le?(Ie||(Ce.rejection===2&&le(Ce),Ce.rejection=1),Le===!0?fe=Oe:(Je&&Je.enter(),fe=Le(Oe),Je&&(Je.exit(),je=!0)),fe===me.promise?Qe(new G("Promise-chain cycle")):(xe=F(fe))?p(xe,fe,He,Qe):He(fe)):Qe(Oe)}catch(ct){Je&&!je&&Je.exit(),Qe(ct)}},ne=function(me,Ce){me.notified||(me.notified=!0,B((function(){for(var fe,xe=me.reactions;fe=xe.get();)Q(fe,me);me.notified=!1,Ce&&!me.rejection&&ce(me)})))},ie=function(me,Ce,fe){var xe,je;W?((xe=X.createEvent("Event")).promise=Ce,xe.reason=fe,xe.initEvent(me,!1,!0),f.dispatchEvent(xe)):xe={promise:Ce,reason:fe},!k&&(je=f["on"+me])?je(xe):me==="unhandledrejection"&&T("Unhandled promise rejection",fe)},ce=function(me){p(P,f,(function(){var Ce,fe=me.facade,xe=me.value;if(de(me)&&(Ce=I((function(){d?re.emit("unhandledRejection",xe,fe):ie("unhandledrejection",fe,xe)})),me.rejection=d||de(me)?2:1,Ce.error))throw Ce.value}))},de=function(me){return me.rejection!==1&&!me.parent},le=function(me){p(P,f,(function(){var Ce=me.facade;d?re.emit("rejectionHandled",Ce):ie("rejectionhandled",Ce,me.value)}))},_e=function(me,Ce,fe){return function(xe){me(Ce,xe,fe)}},ue=function(me,Ce,fe){me.done||(me.done=!0,fe&&(me=fe),me.value=Ce,me.state=2,ne(me,!0))},pe=function(me,Ce,fe){if(!me.done){me.done=!0,fe&&(me=fe);try{if(me.facade===Ce)throw new G("Promise can't be resolved itself");var xe=F(Ce);xe?B((function(){var je={done:!1};try{p(xe,Ce,_e(pe,je,me),_e(ue,je,me))}catch(Oe){ue(je,Oe,me)}})):(me.value=Ce,me.state=1,ne(me,!1))}catch(je){ue({done:!1},je,me)}}};if(E&&(M=(q=function(me){_(this,M),x(me),p(i,this);var Ce=S(this);try{me(_e(pe,Ce),_e(ue,Ce))}catch(fe){ue(Ce,fe)}}).prototype,(i=function(me){C(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new U,rejection:!1,state:0,value:void 0})}).prototype=h(M,"then",(function(me,Ce){var fe=S(this),xe=V(A(this,q));return fe.parent=!0,xe.ok=!v(me)||me,xe.fail=v(Ce)&&Ce,xe.domain=d?re.domain:void 0,fe.state===0?fe.reactions.add(xe):B((function(){Q(xe,fe)})),xe.promise})),o=function(){var me=new i,Ce=S(me);this.promise=me,this.resolve=_e(pe,Ce),this.reject=_e(ue,Ce)},L.f=V=function(me){return me===q||me===void 0?new o(me):J(me)},!l&&v(z)&&D!==Object.prototype)){c=D.then,N||h(D,"then",(function(me,Ce){var fe=this;return new q((function(xe,je){p(c,fe,xe,je)})).then(me,Ce)}),{unsafe:!0});try{delete D.constructor}catch{}y&&y(D,M)}u({global:!0,constructor:!0,wrap:!0,forced:E},{Promise:q}),g(q,"Promise",!1,!0),m("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/is-pure"),c=t("../internals/promise-native-constructor"),u=t("../internals/fails"),l=t("../internals/get-built-in"),d=t("../internals/is-callable"),f=t("../internals/species-constructor"),p=t("../internals/promise-resolve"),h=t("../internals/define-built-in"),y=c&&c.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!c&&u((function(){y.finally.call({then:function(){}},(function(){}))}))},{finally:function(m){var x=f(this,l("Promise")),v=d(m);return this.then(v?function(w){return p(x,m()).then((function(){return w}))}:m,v?function(w){return p(x,m()).then((function(){throw w}))}:m)}}),!o&&d(c)){var g=l("Promise").prototype.finally;y.finally!==g&&h(y,"finally",g,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(t,n,a){t("../modules/es.promise.constructor"),t("../modules/es.promise.all"),t("../modules/es.promise.catch"),t("../modules/es.promise.race"),t("../modules/es.promise.reject"),t("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-call"),c=t("../internals/a-callable"),u=t("../internals/new-promise-capability"),l=t("../internals/perform"),d=t("../internals/iterate");i({target:"Promise",stat:!0,forced:t("../internals/promise-statics-incorrect-iteration")},{race:function(f){var p=this,h=u.f(p),y=h.reject,g=l((function(){var m=c(p.resolve);d(f,(function(x){o(m,p,x).then(h.resolve,y)}))}));return g.error&&y(g.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-call"),c=t("../internals/new-promise-capability");i({target:"Promise",stat:!0,forced:t("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(u){var l=c.f(this);return o(l.reject,void 0,u),l.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/get-built-in"),c=t("../internals/is-pure"),u=t("../internals/promise-native-constructor"),l=t("../internals/promise-constructor-detection").CONSTRUCTOR,d=t("../internals/promise-resolve"),f=o("Promise"),p=c&&!l;i({target:"Promise",stat:!0,forced:c||l},{resolve:function(h){return d(p&&this===f?u:this,h)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-uncurry-this"),c=t("../internals/to-absolute-index"),u=RangeError,l=String.fromCharCode,d=String.fromCodePoint,f=o([].join);i({target:"String",stat:!0,arity:1,forced:!!d&&d.length!==1},{fromCodePoint:function(p){for(var h,y=[],g=arguments.length,m=0;g>m;){if(h=+arguments[m++],c(h,1114111)!==h)throw new u(h+" is not a valid code point");y[m]=h<65536?l(h):l(55296+((h-=65536)>>10),h%1024+56320)}return f(y,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/function-uncurry-this"),c=t("../internals/not-a-regexp"),u=t("../internals/require-object-coercible"),l=t("../internals/to-string"),d=t("../internals/correct-is-regexp-logic"),f=o("".indexOf);i({target:"String",proto:!0,forced:!d("includes")},{includes:function(p){return!!~f(l(u(this)),l(c(p)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(t,n,a){t("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/global"),c=t("../internals/function-call"),u=t("../internals/function-uncurry-this"),l=t("../internals/is-pure"),d=t("../internals/descriptors"),f=t("../internals/symbol-constructor-detection"),p=t("../internals/fails"),h=t("../internals/has-own-property"),y=t("../internals/object-is-prototype-of"),g=t("../internals/an-object"),m=t("../internals/to-indexed-object"),x=t("../internals/to-property-key"),v=t("../internals/to-string"),w=t("../internals/create-property-descriptor"),_=t("../internals/object-create"),A=t("../internals/object-keys"),P=t("../internals/object-get-own-property-names"),B=t("../internals/object-get-own-property-names-external"),T=t("../internals/object-get-own-property-symbols"),I=t("../internals/object-get-own-property-descriptor"),U=t("../internals/object-define-property"),H=t("../internals/object-define-properties"),z=t("../internals/object-property-is-enumerable"),O=t("../internals/define-built-in"),L=t("../internals/define-built-in-accessor"),E=t("../internals/shared"),k=t("../internals/shared-key"),N=t("../internals/hidden-keys"),S=t("../internals/uid"),C=t("../internals/well-known-symbol"),D=t("../internals/well-known-symbol-wrapped"),q=t("../internals/well-known-symbol-define"),M=t("../internals/symbol-define-to-primitive"),G=t("../internals/set-to-string-tag"),X=t("../internals/internal-state"),re=t("../internals/array-iteration").forEach,V=k("hidden"),J=X.set,W=X.getterFor("Symbol"),F=Object.prototype,Q=o.Symbol,ne=Q&&Q.prototype,ie=o.RangeError,ce=o.TypeError,de=o.QObject,le=I.f,_e=U.f,ue=B.f,pe=z.f,me=u([].push),Ce=E("symbols"),fe=E("op-symbols"),xe=E("wks"),je=!de||!de.prototype||!de.prototype.findChild,Oe=function(pt,nt,ht){var St=le(F,nt);St&&delete F[nt],_e(pt,nt,ht),St&&pt!==F&&_e(F,nt,St)},Ie=d&&p((function(){return _(_e({},"a",{get:function(){return _e(this,"a",{value:7}).a}})).a!==7}))?Oe:_e,Le=function(pt,nt){var ht=Ce[pt]=_(ne);return J(ht,{type:"Symbol",tag:pt,description:nt}),d||(ht.description=nt),ht},He=function(pt,nt,ht){pt===F&&He(fe,nt,ht),g(pt);var St=x(nt);return g(ht),h(Ce,St)?(ht.enumerable?(h(pt,V)&&pt[V][St]&&(pt[V][St]=!1),ht=_(ht,{enumerable:w(0,!1)})):(h(pt,V)||_e(pt,V,w(1,{})),pt[V][St]=!0),Ie(pt,St,ht)):_e(pt,St,ht)},Qe=function(pt,nt){g(pt);var ht=m(nt),St=A(ht).concat(At(ht));return re(St,(function(ot){d&&!c(Je,ht,ot)||He(pt,ot,ht[ot])})),pt},Je=function(pt){var nt=x(pt),ht=c(pe,this,nt);return!(this===F&&h(Ce,nt)&&!h(fe,nt))&&(!(ht||!h(this,nt)||!h(Ce,nt)||h(this,V)&&this[V][nt])||ht)},ct=function(pt,nt){var ht=m(pt),St=x(nt);if(ht!==F||!h(Ce,St)||h(fe,St)){var ot=le(ht,St);return!ot||!h(Ce,St)||h(ht,V)&&ht[V][St]||(ot.enumerable=!0),ot}},it=function(pt){var nt=ue(m(pt)),ht=[];return re(nt,(function(St){h(Ce,St)||h(N,St)||me(ht,St)})),ht},At=function(pt){var nt=pt===F,ht=ue(nt?fe:m(pt)),St=[];return re(ht,(function(ot){!h(Ce,ot)||nt&&!h(F,ot)||me(St,Ce[ot])})),St};f||(O(ne=(Q=function(){if(y(ne,this))throw new ce("Symbol is not a constructor");var pt=arguments.length&&arguments[0]!==void 0?v(arguments[0]):void 0,nt=S(pt),ht=function(St){this===F&&c(ht,fe,St),h(this,V)&&h(this[V],nt)&&(this[V][nt]=!1);var ot=w(1,St);try{Ie(this,nt,ot)}catch(Bt){if(!(Bt instanceof ie))throw Bt;Oe(this,nt,ot)}};return d&&je&&Ie(F,nt,{configurable:!0,set:ht}),Le(nt,pt)}).prototype,"toString",(function(){return W(this).tag})),O(Q,"withoutSetter",(function(pt){return Le(S(pt),pt)})),z.f=Je,U.f=He,H.f=Qe,I.f=ct,P.f=B.f=it,T.f=At,D.f=function(pt){return Le(C(pt),pt)},d&&(L(ne,"description",{configurable:!0,get:function(){return W(this).description}}),l||O(F,"propertyIsEnumerable",Je,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:Q}),re(A(xe),(function(pt){q(pt)})),i({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){je=!0},useSimple:function(){je=!1}}),i({target:"Object",stat:!0,forced:!f,sham:!d},{create:function(pt,nt){return nt===void 0?_(pt):Qe(_(pt),nt)},defineProperty:He,defineProperties:Qe,getOwnPropertyDescriptor:ct}),i({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:it}),M(),G(Q,"Symbol"),N[V]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/get-built-in"),c=t("../internals/has-own-property"),u=t("../internals/to-string"),l=t("../internals/shared"),d=t("../internals/symbol-registry-detection"),f=l("string-to-symbol-registry"),p=l("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!d},{for:function(h){var y=u(h);if(c(f,y))return f[y];var g=o("Symbol")(y);return f[y]=g,p[g]=y,g}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(t,n,a){t("../modules/es.symbol.constructor"),t("../modules/es.symbol.for"),t("../modules/es.symbol.key-for"),t("../modules/es.json.stringify"),t("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(t,n,a){var i=t("../internals/export"),o=t("../internals/has-own-property"),c=t("../internals/is-symbol"),u=t("../internals/try-to-string"),l=t("../internals/shared"),d=t("../internals/symbol-registry-detection"),f=l("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!d},{keyFor:function(p){if(!c(p))throw new TypeError(u(p)+" is not a symbol");if(o(f,p))return f[p]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(t,n,a){function i(o){return Object.prototype.toString.call(o)}a.isArray=function(o){return Array.isArray?Array.isArray(o):i(o)==="[object Array]"},a.isBoolean=function(o){return typeof o=="boolean"},a.isNull=function(o){return o===null},a.isNullOrUndefined=function(o){return o==null},a.isNumber=function(o){return typeof o=="number"},a.isString=function(o){return typeof o=="string"},a.isSymbol=function(o){return typeof o=="symbol"},a.isUndefined=function(o){return o===void 0},a.isRegExp=function(o){return i(o)==="[object RegExp]"},a.isObject=function(o){return typeof o=="object"&&o!==null},a.isDate=function(o){return i(o)==="[object Date]"},a.isError=function(o){return i(o)==="[object Error]"||o instanceof Error},a.isFunction=function(o){return typeof o=="function"},a.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},a.isBuffer=t("buffer").Buffer.isBuffer},{buffer:220}],384:[function(t,n,a){(function(i){(function(){var o=t("elliptic"),c=t("bn.js");n.exports=function(f){return new l(f)};var u={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function l(f){this.curveType=u[f],this.curveType||(this.curveType={name:f}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function d(f,p,h){Array.isArray(f)||(f=f.toArray());var y=new i(f);if(h&&y.length<h){var g=new i(h-y.length);g.fill(0),y=i.concat([g,y])}return p?y.toString(p):y}u.p224=u.secp224r1,u.p256=u.secp256r1=u.prime256v1,u.p192=u.secp192r1=u.prime192v1,u.p384=u.secp384r1,u.p521=u.secp521r1,l.prototype.generateKeys=function(f,p){return this.keys=this.curve.genKeyPair(),this.getPublicKey(f,p)},l.prototype.computeSecret=function(f,p,h){return p=p||"utf8",i.isBuffer(f)||(f=new i(f,p)),d(this.curve.keyFromPublic(f).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},l.prototype.getPublicKey=function(f,p){var h=this.keys.getPublic(p==="compressed",!0);return p==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),d(h,f)},l.prototype.getPrivateKey=function(f){return d(this.keys.getPrivate(),f)},l.prototype.setPublicKey=function(f,p){return p=p||"utf8",i.isBuffer(f)||(f=new i(f,p)),this.keys._importPublic(f),this},l.prototype.setPrivateKey=function(f,p){p=p||"utf8",i.isBuffer(f)||(f=new i(f,p));var h=new c(f);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this)}).call(this,t("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(t,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],386:[function(t,n,a){var i=t("inherits"),o=t("md5.js"),c=t("ripemd160"),u=t("sha.js"),l=t("cipher-base");function d(f){l.call(this,"digest"),this._hash=f}i(d,l),d.prototype._update=function(f){this._hash.update(f)},d.prototype._final=function(){return this._hash.digest()},n.exports=function(f){return(f=f.toLowerCase())==="md5"?new o:f==="rmd160"||f==="ripemd160"?new c:new d(u(f))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(t,n,a){var i=t("md5.js");n.exports=function(o){return new i().update(o).digest()}},{"md5.js":450}],388:[function(t,n,a){var i=t("inherits"),o=t("./legacy"),c=t("cipher-base"),u=t("safe-buffer").Buffer,l=t("create-hash/md5"),d=t("ripemd160"),f=t("sha.js"),p=u.alloc(128);function h(y,g){c.call(this,"digest"),typeof g=="string"&&(g=u.from(g));var m=y==="sha512"||y==="sha384"?128:64;this._alg=y,this._key=g,g.length>m?g=(y==="rmd160"?new d:f(y)).update(g).digest():g.length<m&&(g=u.concat([g,p],m));for(var x=this._ipad=u.allocUnsafe(m),v=this._opad=u.allocUnsafe(m),w=0;w<m;w++)x[w]=54^g[w],v[w]=92^g[w];this._hash=y==="rmd160"?new d:f(y),this._hash.update(x)}i(h,c),h.prototype._update=function(y){this._hash.update(y)},h.prototype._final=function(){var y=this._hash.digest();return(this._alg==="rmd160"?new d:f(this._alg)).update(this._opad).update(y).digest()},n.exports=function(y,g){return(y=y.toLowerCase())==="rmd160"||y==="ripemd160"?new h("rmd160",g):y==="md5"?new o(l,g):new h(y,g)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(t,n,a){var i=t("inherits"),o=t("safe-buffer").Buffer,c=t("cipher-base"),u=o.alloc(128);function l(d,f){c.call(this,"digest"),typeof f=="string"&&(f=o.from(f)),this._alg=d,this._key=f,f.length>64?f=d(f):f.length<64&&(f=o.concat([f,u],64));for(var p=this._ipad=o.allocUnsafe(64),h=this._opad=o.allocUnsafe(64),y=0;y<64;y++)p[y]=54^f[y],h[y]=92^f[y];this._hash=[p]}i(l,c),l.prototype._update=function(d){this._hash.push(d)},l.prototype._final=function(){var d=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,d]))},n.exports=l},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(t,n,a){a.randomBytes=a.rng=a.pseudoRandomBytes=a.prng=t("randombytes"),a.createHash=a.Hash=t("create-hash"),a.createHmac=a.Hmac=t("create-hmac");var i=t("browserify-sign/algos"),o=Object.keys(i),c=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);a.getHashes=function(){return c};var u=t("pbkdf2");a.pbkdf2=u.pbkdf2,a.pbkdf2Sync=u.pbkdf2Sync;var l=t("browserify-cipher");a.Cipher=l.Cipher,a.createCipher=l.createCipher,a.Cipheriv=l.Cipheriv,a.createCipheriv=l.createCipheriv,a.Decipher=l.Decipher,a.createDecipher=l.createDecipher,a.Decipheriv=l.Decipheriv,a.createDecipheriv=l.createDecipheriv,a.getCiphers=l.getCiphers,a.listCiphers=l.listCiphers;var d=t("diffie-hellman");a.DiffieHellmanGroup=d.DiffieHellmanGroup,a.createDiffieHellmanGroup=d.createDiffieHellmanGroup,a.getDiffieHellman=d.getDiffieHellman,a.createDiffieHellman=d.createDiffieHellman,a.DiffieHellman=d.DiffieHellman;var f=t("browserify-sign");a.createSign=f.createSign,a.Sign=f.Sign,a.createVerify=f.createVerify,a.Verify=f.Verify,a.createECDH=t("create-ecdh");var p=t("public-encrypt");a.publicEncrypt=p.publicEncrypt,a.privateEncrypt=p.privateEncrypt,a.publicDecrypt=p.publicDecrypt,a.privateDecrypt=p.privateDecrypt;var h=t("randomfill");a.randomFill=h.randomFill,a.randomFillSync=h.randomFillSync,a.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},a.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(t,n,a){(function(i,o){typeof a=="object"&&n!==void 0?n.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs=o()})(void 0,(function(){var i=6e4,o=36e5,c="millisecond",u="second",l="minute",d="hour",f="day",p="week",h="month",y="quarter",g="year",m="date",x="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,w=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(k){var N=["th","st","nd","rd"],S=k%100;return"["+k+(N[(S-20)%10]||N[S]||N[0])+"]"}},A=function(k,N,S){var C=String(k);return!C||C.length>=N?k:""+Array(N+1-C.length).join(S)+k},P={s:A,z:function(k){var N=-k.utcOffset(),S=Math.abs(N),C=Math.floor(S/60),D=S%60;return(N<=0?"+":"-")+A(C,2,"0")+":"+A(D,2,"0")},m:function k(N,S){if(N.date()<S.date())return-k(S,N);var C=12*(S.year()-N.year())+(S.month()-N.month()),D=N.clone().add(C,h),q=S-D<0,M=N.clone().add(C+(q?-1:1),h);return+(-(C+(S-D)/(q?D-M:M-D))||0)},a:function(k){return k<0?Math.ceil(k)||0:Math.floor(k)},p:function(k){return{M:h,y:g,w:p,d:f,D:m,h:d,m:l,s:u,ms:c,Q:y}[k]||String(k||"").toLowerCase().replace(/s$/,"")},u:function(k){return k===void 0}},B="en",T={};T[B]=_;var I="$isDayjsObject",U=function(k){return k instanceof L||!(!k||!k[I])},H=function k(N,S,C){var D;if(!N)return B;if(typeof N=="string"){var q=N.toLowerCase();T[q]&&(D=q),S&&(T[q]=S,D=q);var M=N.split("-");if(!D&&M.length>1)return k(M[0])}else{var G=N.name;T[G]=N,D=G}return!C&&D&&(B=D),D||!C&&B},z=function(k,N){if(U(k))return k.clone();var S=typeof N=="object"?N:{};return S.date=k,S.args=arguments,new L(S)},O=P;O.l=H,O.i=U,O.w=function(k,N){return z(k,{locale:N.$L,utc:N.$u,x:N.$x,$offset:N.$offset})};var L=(function(){function k(S){this.$L=H(S.locale,null,!0),this.parse(S),this.$x=this.$x||S.x||{},this[I]=!0}var N=k.prototype;return N.parse=function(S){this.$d=(function(C){var D=C.date,q=C.utc;if(D===null)return new Date(NaN);if(O.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var M=D.match(v);if(M){var G=M[2]-1||0,X=(M[7]||"0").substring(0,3);return q?new Date(Date.UTC(M[1],G,M[3]||1,M[4]||0,M[5]||0,M[6]||0,X)):new Date(M[1],G,M[3]||1,M[4]||0,M[5]||0,M[6]||0,X)}}return new Date(D)})(S),this.init()},N.init=function(){var S=this.$d;this.$y=S.getFullYear(),this.$M=S.getMonth(),this.$D=S.getDate(),this.$W=S.getDay(),this.$H=S.getHours(),this.$m=S.getMinutes(),this.$s=S.getSeconds(),this.$ms=S.getMilliseconds()},N.$utils=function(){return O},N.isValid=function(){return this.$d.toString()!==x},N.isSame=function(S,C){var D=z(S);return this.startOf(C)<=D&&D<=this.endOf(C)},N.isAfter=function(S,C){return z(S)<this.startOf(C)},N.isBefore=function(S,C){return this.endOf(C)<z(S)},N.$g=function(S,C,D){return O.u(S)?this[C]:this.set(D,S)},N.unix=function(){return Math.floor(this.valueOf()/1e3)},N.valueOf=function(){return this.$d.getTime()},N.startOf=function(S,C){var D=this,q=!!O.u(C)||C,M=O.p(S),G=function(ne,ie){var ce=O.w(D.$u?Date.UTC(D.$y,ie,ne):new Date(D.$y,ie,ne),D);return q?ce:ce.endOf(f)},X=function(ne,ie){return O.w(D.toDate()[ne].apply(D.toDate("s"),(q?[0,0,0,0]:[23,59,59,999]).slice(ie)),D)},re=this.$W,V=this.$M,J=this.$D,W="set"+(this.$u?"UTC":"");switch(M){case g:return q?G(1,0):G(31,11);case h:return q?G(1,V):G(0,V+1);case p:var F=this.$locale().weekStart||0,Q=(re<F?re+7:re)-F;return G(q?J-Q:J+(6-Q),V);case f:case m:return X(W+"Hours",0);case d:return X(W+"Minutes",1);case l:return X(W+"Seconds",2);case u:return X(W+"Milliseconds",3);default:return this.clone()}},N.endOf=function(S){return this.startOf(S,!1)},N.$set=function(S,C){var D,q=O.p(S),M="set"+(this.$u?"UTC":""),G=(D={},D[f]=M+"Date",D[m]=M+"Date",D[h]=M+"Month",D[g]=M+"FullYear",D[d]=M+"Hours",D[l]=M+"Minutes",D[u]=M+"Seconds",D[c]=M+"Milliseconds",D)[q],X=q===f?this.$D+(C-this.$W):C;if(q===h||q===g){var re=this.clone().set(m,1);re.$d[G](X),re.init(),this.$d=re.set(m,Math.min(this.$D,re.daysInMonth())).$d}else G&&this.$d[G](X);return this.init(),this},N.set=function(S,C){return this.clone().$set(S,C)},N.get=function(S){return this[O.p(S)]()},N.add=function(S,C){var D,q=this;S=Number(S);var M=O.p(C),G=function(V){var J=z(q);return O.w(J.date(J.date()+Math.round(V*S)),q)};if(M===h)return this.set(h,this.$M+S);if(M===g)return this.set(g,this.$y+S);if(M===f)return G(1);if(M===p)return G(7);var X=(D={},D[l]=i,D[d]=o,D[u]=1e3,D)[M]||1,re=this.$d.getTime()+S*X;return O.w(re,this)},N.subtract=function(S,C){return this.add(-1*S,C)},N.format=function(S){var C=this,D=this.$locale();if(!this.isValid())return D.invalidDate||x;var q=S||"YYYY-MM-DDTHH:mm:ssZ",M=O.z(this),G=this.$H,X=this.$m,re=this.$M,V=D.weekdays,J=D.months,W=D.meridiem,F=function(ie,ce,de,le){return ie&&(ie[ce]||ie(C,q))||de[ce].slice(0,le)},Q=function(ie){return O.s(G%12||12,ie,"0")},ne=W||function(ie,ce,de){var le=ie<12?"AM":"PM";return de?le.toLowerCase():le};return q.replace(w,(function(ie,ce){return ce||(function(de){switch(de){case"YY":return String(C.$y).slice(-2);case"YYYY":return O.s(C.$y,4,"0");case"M":return re+1;case"MM":return O.s(re+1,2,"0");case"MMM":return F(D.monthsShort,re,J,3);case"MMMM":return F(J,re);case"D":return C.$D;case"DD":return O.s(C.$D,2,"0");case"d":return String(C.$W);case"dd":return F(D.weekdaysMin,C.$W,V,2);case"ddd":return F(D.weekdaysShort,C.$W,V,3);case"dddd":return V[C.$W];case"H":return String(G);case"HH":return O.s(G,2,"0");case"h":return Q(1);case"hh":return Q(2);case"a":return ne(G,X,!0);case"A":return ne(G,X,!1);case"m":return String(X);case"mm":return O.s(X,2,"0");case"s":return String(C.$s);case"ss":return O.s(C.$s,2,"0");case"SSS":return O.s(C.$ms,3,"0");case"Z":return M}return null})(ie)||M.replace(":","")}))},N.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},N.diff=function(S,C,D){var q,M=this,G=O.p(C),X=z(S),re=(X.utcOffset()-this.utcOffset())*i,V=this-X,J=function(){return O.m(M,X)};switch(G){case g:q=J()/12;break;case h:q=J();break;case y:q=J()/3;break;case p:q=(V-re)/6048e5;break;case f:q=(V-re)/864e5;break;case d:q=V/o;break;case l:q=V/i;break;case u:q=V/1e3;break;default:q=V}return D?q:O.a(q)},N.daysInMonth=function(){return this.endOf(h).$D},N.$locale=function(){return T[this.$L]},N.locale=function(S,C){if(!S)return this.$L;var D=this.clone(),q=H(S,C,!0);return q&&(D.$L=q),D},N.clone=function(){return O.w(this.$d,this)},N.toDate=function(){return new Date(this.valueOf())},N.toJSON=function(){return this.isValid()?this.toISOString():null},N.toISOString=function(){return this.$d.toISOString()},N.toString=function(){return this.$d.toUTCString()},k})(),E=L.prototype;return z.prototype=E,[["$ms",c],["$s",u],["$m",l],["$H",d],["$W",f],["$M",h],["$y",g],["$D",m]].forEach((function(k){E[k[1]]=function(N){return this.$g(N,k[0],k[1])}})),z.extend=function(k,N){return k.$i||(k(N,L,z),k.$i=!0),z},z.locale=H,z.isDayjs=U,z.unix=function(k){return z(1e3*k)},z.en=T[B],z.Ls=T,z.p={},z}))},{}],392:[function(t,n,a){(function(i,o){typeof a=="object"&&n!==void 0?n.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_customParseFormat=o()})(void 0,(function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,c=/\d\d/,u=/\d\d?/,l=/\d*[^-_:/,()\s\d]+/,d={},f=function(v){return(v=+v)+(v>68?1900:2e3)},p=function(v){return function(w){this[v]=+w}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(v){(this.zone||(this.zone={})).offset=(function(w){if(!w||w==="Z")return 0;var _=w.match(/([+-]|\d\d)/g),A=60*_[1]+(+_[2]||0);return A===0?0:_[0]==="+"?-A:A})(v)}],y=function(v){var w=d[v];return w&&(w.indexOf?w:w.s.concat(w.f))},g=function(v,w){var _,A=d.meridiem;if(A){for(var P=1;P<=24;P+=1)if(v.indexOf(A(P,0,w))>-1){_=P>12;break}}else _=v===(w?"pm":"PM");return _},m={A:[l,function(v){this.afternoon=g(v,!1)}],a:[l,function(v){this.afternoon=g(v,!0)}],S:[/\d/,function(v){this.milliseconds=100*+v}],SS:[c,function(v){this.milliseconds=10*+v}],SSS:[/\d{3}/,function(v){this.milliseconds=+v}],s:[u,p("seconds")],ss:[u,p("seconds")],m:[u,p("minutes")],mm:[u,p("minutes")],H:[u,p("hours")],h:[u,p("hours")],HH:[u,p("hours")],hh:[u,p("hours")],D:[u,p("day")],DD:[c,p("day")],Do:[l,function(v){var w=d.ordinal,_=v.match(/\d+/);if(this.day=_[0],w)for(var A=1;A<=31;A+=1)w(A).replace(/\[|\]/g,"")===v&&(this.day=A)}],M:[u,p("month")],MM:[c,p("month")],MMM:[l,function(v){var w=y("months"),_=(y("monthsShort")||w.map((function(A){return A.slice(0,3)}))).indexOf(v)+1;if(_<1)throw new Error;this.month=_%12||_}],MMMM:[l,function(v){var w=y("months").indexOf(v)+1;if(w<1)throw new Error;this.month=w%12||w}],Y:[/[+-]?\d+/,p("year")],YY:[c,function(v){this.year=f(v)}],YYYY:[/\d{4}/,p("year")],Z:h,ZZ:h};function x(v){var w,_;w=v,_=d&&d.formats;for(var A=(v=w.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(z,O,L){var E=L&&L.toUpperCase();return O||_[L]||i[L]||_[E].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(k,N,S){return N||S.slice(1)}))}))).match(o),P=A.length,B=0;B<P;B+=1){var T=A[B],I=m[T],U=I&&I[0],H=I&&I[1];A[B]=H?{regex:U,parser:H}:T.replace(/^\[|\]$/g,"")}return function(z){for(var O={},L=0,E=0;L<P;L+=1){var k=A[L];if(typeof k=="string")E+=k.length;else{var N=k.regex,S=k.parser,C=z.slice(E),D=N.exec(C)[0];S.call(O,D),z=z.replace(D,"")}}return(function(q){var M=q.afternoon;if(M!==void 0){var G=q.hours;M?G<12&&(q.hours+=12):G===12&&(q.hours=0),delete q.afternoon}})(O),O}}return function(v,w,_){_.p.customParseFormat=!0,v&&v.parseTwoDigitYear&&(f=v.parseTwoDigitYear);var A=w.prototype,P=A.parse;A.parse=function(B){var T=B.date,I=B.utc,U=B.args;this.$u=I;var H=U[1];if(typeof H=="string"){var z=U[2]===!0,O=U[3]===!0,L=z||O,E=U[2];O&&(E=U[2]),d=this.$locale(),!z&&E&&(d=_.Ls[E]),this.$d=(function(C,D,q){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*C);var M=x(D)(C),G=M.year,X=M.month,re=M.day,V=M.hours,J=M.minutes,W=M.seconds,F=M.milliseconds,Q=M.zone,ne=new Date,ie=re||(G||X?1:ne.getDate()),ce=G||ne.getFullYear(),de=0;G&&!X||(de=X>0?X-1:ne.getMonth());var le=V||0,_e=J||0,ue=W||0,pe=F||0;return Q?new Date(Date.UTC(ce,de,ie,le,_e,ue,pe+60*Q.offset*1e3)):q?new Date(Date.UTC(ce,de,ie,le,_e,ue,pe)):new Date(ce,de,ie,le,_e,ue,pe)}catch{return new Date("")}})(T,H,I),this.init(),E&&E!==!0&&(this.$L=this.locale(E).$L),L&&T!=this.format(H)&&(this.$d=new Date("")),d={}}else if(H instanceof Array)for(var k=H.length,N=1;N<=k;N+=1){U[1]=H[N-1];var S=_.apply(this,U);if(S.isValid()){this.$d=S.$d,this.$L=S.$L,this.init();break}N===k&&(this.$d=new Date(""))}else P.call(this,B)}}}))},{}],393:[function(t,n,a){(function(i,o){typeof a=="object"&&n!==void 0?n.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_utc=o()})(void 0,(function(){var i="minute",o=/[+-]\d\d(?::?\d\d)?/g,c=/([+-]|\d\d)/g;return function(u,l,d){var f=l.prototype;d.utc=function(v){var w={date:v,utc:!0,args:arguments};return new l(w)},f.utc=function(v){var w=d(this.toDate(),{locale:this.$L,utc:!0});return v?w.add(this.utcOffset(),i):w},f.local=function(){return d(this.toDate(),{locale:this.$L,utc:!1})};var p=f.parse;f.parse=function(v){v.utc&&(this.$u=!0),this.$utils().u(v.$offset)||(this.$offset=v.$offset),p.call(this,v)};var h=f.init;f.init=function(){if(this.$u){var v=this.$d;this.$y=v.getUTCFullYear(),this.$M=v.getUTCMonth(),this.$D=v.getUTCDate(),this.$W=v.getUTCDay(),this.$H=v.getUTCHours(),this.$m=v.getUTCMinutes(),this.$s=v.getUTCSeconds(),this.$ms=v.getUTCMilliseconds()}else h.call(this)};var y=f.utcOffset;f.utcOffset=function(v,w){var _=this.$utils().u;if(_(v))return this.$u?0:_(this.$offset)?y.call(this):this.$offset;if(typeof v=="string"&&(v=(function(T){T===void 0&&(T="");var I=T.match(o);if(!I)return null;var U=(""+I[0]).match(c)||["-",0,0],H=U[0],z=60*+U[1]+ +U[2];return z===0?0:H==="+"?z:-z})(v))===null)return this;var A=Math.abs(v)<=16?60*v:v,P=this;if(w)return P.$offset=A,P.$u=v===0,P;if(v!==0){var B=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(P=this.local().add(A+B,i)).$offset=A,P.$x.$localOffset=B}else P=this.utc();return P};var g=f.format;f.format=function(v){var w=v||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,w)},f.valueOf=function(){var v=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*v},f.isUTC=function(){return!!this.$u},f.toISOString=function(){return this.toDate().toISOString()},f.toString=function(){return this.toDate().toUTCString()};var m=f.toDate;f.toDate=function(v){return v==="s"&&this.$offset?d(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():m.call(this)};var x=f.diff;f.diff=function(v,w,_){if(v&&this.$u===v.$u)return x.call(this,v,w,_);var A=this.local(),P=d(v).local();return x.call(A,P,w,_)}}}))},{}],394:[function(t,n,a){a.utils=t("./des/utils"),a.Cipher=t("./des/cipher"),a.DES=t("./des/des"),a.CBC=t("./des/cbc"),a.EDE=t("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(t,n,a){var i=t("minimalistic-assert"),o=t("inherits"),c={};function u(l){i.equal(l.length,8,"Invalid IV length"),this.iv=new Array(8);for(var d=0;d<this.iv.length;d++)this.iv[d]=l[d]}a.instantiate=function(l){function d(y){l.call(this,y),this._cbcInit()}o(d,l);for(var f=Object.keys(c),p=0;p<f.length;p++){var h=f[p];d.prototype[h]=c[h]}return d.create=function(y){return new d(y)},d},c._cbcInit=function(){var l=new u(this.options.iv);this._cbcState=l},c._update=function(l,d,f,p){var h=this._cbcState,y=this.constructor.super_.prototype,g=h.iv;if(this.type==="encrypt"){for(var m=0;m<this.blockSize;m++)g[m]^=l[d+m];for(y._update.call(this,g,0,f,p),m=0;m<this.blockSize;m++)g[m]=f[p+m]}else{for(y._update.call(this,l,d,f,p),m=0;m<this.blockSize;m++)f[p+m]^=g[m];for(m=0;m<this.blockSize;m++)g[m]=l[d+m]}}},{inherits:440,"minimalistic-assert":453}],396:[function(t,n,a){var i=t("minimalistic-assert");function o(c){this.options=c,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=c.padding!==!1}n.exports=o,o.prototype._init=function(){},o.prototype.update=function(c){return c.length===0?[]:this.type==="decrypt"?this._updateDecrypt(c):this._updateEncrypt(c)},o.prototype._buffer=function(c,u){for(var l=Math.min(this.buffer.length-this.bufferOff,c.length-u),d=0;d<l;d++)this.buffer[this.bufferOff+d]=c[u+d];return this.bufferOff+=l,l},o.prototype._flushBuffer=function(c,u){return this._update(this.buffer,0,c,u),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(c){var u=0,l=0,d=(this.bufferOff+c.length)/this.blockSize|0,f=new Array(d*this.blockSize);this.bufferOff!==0&&(u+=this._buffer(c,u),this.bufferOff===this.buffer.length&&(l+=this._flushBuffer(f,l)));for(var p=c.length-(c.length-u)%this.blockSize;u<p;u+=this.blockSize)this._update(c,u,f,l),l+=this.blockSize;for(;u<c.length;u++,this.bufferOff++)this.buffer[this.bufferOff]=c[u];return f},o.prototype._updateDecrypt=function(c){for(var u=0,l=0,d=Math.ceil((this.bufferOff+c.length)/this.blockSize)-1,f=new Array(d*this.blockSize);d>0;d--)u+=this._buffer(c,u),l+=this._flushBuffer(f,l);return u+=this._buffer(c,u),f},o.prototype.final=function(c){var u,l;return c&&(u=this.update(c)),l=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),u?u.concat(l):l},o.prototype._pad=function(c,u){if(u===0)return!1;for(;u<c.length;)c[u++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var c=new Array(this.blockSize);return this._update(this.buffer,0,c,0),c},o.prototype._unpad=function(c){return c},o.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var c=new Array(this.blockSize);return this._flushBuffer(c,0),this._unpad(c)}},{"minimalistic-assert":453}],397:[function(t,n,a){var i=t("minimalistic-assert"),o=t("inherits"),c=t("./utils"),u=t("./cipher");function l(){this.tmp=new Array(2),this.keys=null}function d(p){u.call(this,p);var h=new l;this._desState=h,this.deriveKeys(h,p.key)}o(d,u),n.exports=d,d.create=function(p){return new d(p)};var f=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];d.prototype.deriveKeys=function(p,h){p.keys=new Array(32),i.equal(h.length,this.blockSize,"Invalid key length");var y=c.readUInt32BE(h,0),g=c.readUInt32BE(h,4);c.pc1(y,g,p.tmp,0),y=p.tmp[0],g=p.tmp[1];for(var m=0;m<p.keys.length;m+=2){var x=f[m>>>1];y=c.r28shl(y,x),g=c.r28shl(g,x),c.pc2(y,g,p.keys,m)}},d.prototype._update=function(p,h,y,g){var m=this._desState,x=c.readUInt32BE(p,h),v=c.readUInt32BE(p,h+4);c.ip(x,v,m.tmp,0),x=m.tmp[0],v=m.tmp[1],this.type==="encrypt"?this._encrypt(m,x,v,m.tmp,0):this._decrypt(m,x,v,m.tmp,0),x=m.tmp[0],v=m.tmp[1],c.writeUInt32BE(y,x,g),c.writeUInt32BE(y,v,g+4)},d.prototype._pad=function(p,h){if(this.padding===!1)return!1;for(var y=p.length-h,g=h;g<p.length;g++)p[g]=y;return!0},d.prototype._unpad=function(p){if(this.padding===!1)return p;for(var h=p[p.length-1],y=p.length-h;y<p.length;y++)i.equal(p[y],h);return p.slice(0,p.length-h)},d.prototype._encrypt=function(p,h,y,g,m){for(var x=h,v=y,w=0;w<p.keys.length;w+=2){var _=p.keys[w],A=p.keys[w+1];c.expand(v,p.tmp,0),_^=p.tmp[0],A^=p.tmp[1];var P=c.substitute(_,A),B=v;v=(x^c.permute(P))>>>0,x=B}c.rip(v,x,g,m)},d.prototype._decrypt=function(p,h,y,g,m){for(var x=y,v=h,w=p.keys.length-2;w>=0;w-=2){var _=p.keys[w],A=p.keys[w+1];c.expand(x,p.tmp,0),_^=p.tmp[0],A^=p.tmp[1];var P=c.substitute(_,A),B=x;x=(v^c.permute(P))>>>0,v=B}c.rip(x,v,g,m)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(t,n,a){var i=t("minimalistic-assert"),o=t("inherits"),c=t("./cipher"),u=t("./des");function l(f,p){i.equal(p.length,24,"Invalid key length");var h=p.slice(0,8),y=p.slice(8,16),g=p.slice(16,24);this.ciphers=f==="encrypt"?[u.create({type:"encrypt",key:h}),u.create({type:"decrypt",key:y}),u.create({type:"encrypt",key:g})]:[u.create({type:"decrypt",key:g}),u.create({type:"encrypt",key:y}),u.create({type:"decrypt",key:h})]}function d(f){c.call(this,f);var p=new l(this.type,this.options.key);this._edeState=p}o(d,c),n.exports=d,d.create=function(f){return new d(f)},d.prototype._update=function(f,p,h,y){var g=this._edeState;g.ciphers[0]._update(f,p,h,y),g.ciphers[1]._update(h,y,h,y),g.ciphers[2]._update(h,y,h,y)},d.prototype._pad=u.prototype._pad,d.prototype._unpad=u.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(t,n,a){a.readUInt32BE=function(u,l){return(u[0+l]<<24|u[1+l]<<16|u[2+l]<<8|u[3+l])>>>0},a.writeUInt32BE=function(u,l,d){u[0+d]=l>>>24,u[1+d]=l>>>16&255,u[2+d]=l>>>8&255,u[3+d]=255&l},a.ip=function(u,l,d,f){for(var p=0,h=0,y=6;y>=0;y-=2){for(var g=0;g<=24;g+=8)p<<=1,p|=l>>>g+y&1;for(g=0;g<=24;g+=8)p<<=1,p|=u>>>g+y&1}for(y=6;y>=0;y-=2){for(g=1;g<=25;g+=8)h<<=1,h|=l>>>g+y&1;for(g=1;g<=25;g+=8)h<<=1,h|=u>>>g+y&1}d[f+0]=p>>>0,d[f+1]=h>>>0},a.rip=function(u,l,d,f){for(var p=0,h=0,y=0;y<4;y++)for(var g=24;g>=0;g-=8)p<<=1,p|=l>>>g+y&1,p<<=1,p|=u>>>g+y&1;for(y=4;y<8;y++)for(g=24;g>=0;g-=8)h<<=1,h|=l>>>g+y&1,h<<=1,h|=u>>>g+y&1;d[f+0]=p>>>0,d[f+1]=h>>>0},a.pc1=function(u,l,d,f){for(var p=0,h=0,y=7;y>=5;y--){for(var g=0;g<=24;g+=8)p<<=1,p|=l>>g+y&1;for(g=0;g<=24;g+=8)p<<=1,p|=u>>g+y&1}for(g=0;g<=24;g+=8)p<<=1,p|=l>>g+y&1;for(y=1;y<=3;y++){for(g=0;g<=24;g+=8)h<<=1,h|=l>>g+y&1;for(g=0;g<=24;g+=8)h<<=1,h|=u>>g+y&1}for(g=0;g<=24;g+=8)h<<=1,h|=u>>g+y&1;d[f+0]=p>>>0,d[f+1]=h>>>0},a.r28shl=function(u,l){return u<<l&268435455|u>>>28-l};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];a.pc2=function(u,l,d,f){for(var p=0,h=0,y=i.length>>>1,g=0;g<y;g++)p<<=1,p|=u>>>i[g]&1;for(g=y;g<i.length;g++)h<<=1,h|=l>>>i[g]&1;d[f+0]=p>>>0,d[f+1]=h>>>0},a.expand=function(u,l,d){var f=0,p=0;f=(1&u)<<5|u>>>27;for(var h=23;h>=15;h-=4)f<<=6,f|=u>>>h&63;for(h=11;h>=3;h-=4)p|=u>>>h&63,p<<=6;p|=(31&u)<<1|u>>>31,l[d+0]=f>>>0,l[d+1]=p>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];a.substitute=function(u,l){for(var d=0,f=0;f<4;f++)d<<=4,d|=o[64*f+(u>>>18-6*f&63)];for(f=0;f<4;f++)d<<=4,d|=o[256+64*f+(l>>>18-6*f&63)];return d>>>0};var c=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];a.permute=function(u){for(var l=0,d=0;d<c.length;d++)l<<=1,l|=u>>>c[d]&1;return l>>>0},a.padSplit=function(u,l,d){for(var f=u.toString(2);f.length<l;)f="0"+f;for(var p=[],h=0;h<l;h+=d)p.push(f.slice(h,h+d));return p.join(" ")}},{}],400:[function(t,n,a){(function(i){(function(){var o=t("./lib/generatePrime"),c=t("./lib/primes.json"),u=t("./lib/dh"),l={binary:!0,hex:!0,base64:!0};a.DiffieHellmanGroup=a.createDiffieHellmanGroup=a.getDiffieHellman=function(d){var f=new i(c[d].prime,"hex"),p=new i(c[d].gen,"hex");return new u(f,p)},a.createDiffieHellman=a.DiffieHellman=function d(f,p,h,y){return i.isBuffer(p)||l[p]===void 0?d(f,"binary",p,h):(p=p||"binary",y=y||"binary",h=h||new i([2]),i.isBuffer(h)||(h=new i(h,y)),typeof f=="number"?new u(o(f,h),h,!0):(i.isBuffer(f)||(f=new i(f,p)),new u(f,h,!0)))}}).call(this)}).call(this,t("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(t,n,a){(function(i){(function(){var o=t("bn.js"),c=new(t("miller-rabin")),u=new o(24),l=new o(11),d=new o(10),f=new o(3),p=new o(7),h=t("./generatePrime"),y=t("randombytes");function g(_,A){return A=A||"utf8",i.isBuffer(_)||(_=new i(_,A)),this._pub=new o(_),this}function m(_,A){return A=A||"utf8",i.isBuffer(_)||(_=new i(_,A)),this._priv=new o(_),this}n.exports=v;var x={};function v(_,A,P){this.setGenerator(A),this.__prime=new o(_),this._prime=o.mont(this.__prime),this._primeLen=_.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,P?(this.setPublicKey=g,this.setPrivateKey=m):this._primeCode=8}function w(_,A){var P=new i(_.toArray());return A?P.toString(A):P}Object.defineProperty(v.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=(function(_,A){var P=A.toString("hex"),B=[P,_.toString(16)].join("_");if(B in x)return x[B];var T,I=0;if(_.isEven()||!h.simpleSieve||!h.fermatTest(_)||!c.test(_))return I+=1,I+=P==="02"||P==="05"?8:4,x[B]=I,I;switch(c.test(_.shrn(1))||(I+=2),P){case"02":_.mod(u).cmp(l)&&(I+=8);break;case"05":(T=_.mod(d)).cmp(f)&&T.cmp(p)&&(I+=8);break;default:I+=4}return x[B]=I,I})(this.__prime,this.__gen)),this._primeCode}}),v.prototype.generateKeys=function(){return this._priv||(this._priv=new o(y(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},v.prototype.computeSecret=function(_){var A=(_=(_=new o(_)).toRed(this._prime)).redPow(this._priv).fromRed(),P=new i(A.toArray()),B=this.getPrime();if(P.length<B.length){var T=new i(B.length-P.length);T.fill(0),P=i.concat([T,P])}return P},v.prototype.getPublicKey=function(_){return w(this._pub,_)},v.prototype.getPrivateKey=function(_){return w(this._priv,_)},v.prototype.getPrime=function(_){return w(this.__prime,_)},v.prototype.getGenerator=function(_){return w(this._gen,_)},v.prototype.setGenerator=function(_,A){return A=A||"utf8",i.isBuffer(_)||(_=new i(_,A)),this.__gen=_,this._gen=new o(_),this}}).call(this)}).call(this,t("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(t,n,a){var i=t("randombytes");n.exports=_,_.simpleSieve=v,_.fermatTest=w;var o=t("bn.js"),c=new o(24),u=new(t("miller-rabin")),l=new o(1),d=new o(2),f=new o(5),p=(new o(16),new o(8),new o(10)),h=new o(3),y=(new o(7),new o(11)),g=new o(4),m=(new o(12),null);function x(){if(m!==null)return m;var A=[];A[0]=2;for(var P=1,B=3;B<1048576;B+=2){for(var T=Math.ceil(Math.sqrt(B)),I=0;I<P&&A[I]<=T&&B%A[I]!=0;I++);P!==I&&A[I]<=T||(A[P++]=B)}return m=A,A}function v(A){for(var P=x(),B=0;B<P.length;B++)if(A.modn(P[B])===0)return A.cmpn(P[B])===0;return!0}function w(A){var P=o.mont(A);return d.toRed(P).redPow(A.subn(1)).fromRed().cmpn(1)===0}function _(A,P){if(A<16)return new o(P===2||P===5?[140,123]:[140,39]);var B,T;for(P=new o(P);;){for(B=new o(i(Math.ceil(A/8)));B.bitLength()>A;)B.ishrn(1);if(B.isEven()&&B.iadd(l),B.testn(1)||B.iadd(d),P.cmp(d)){if(!P.cmp(f))for(;B.mod(p).cmp(h);)B.iadd(g)}else for(;B.mod(c).cmp(y);)B.iadd(g);if(v(T=B.shrn(1))&&v(B)&&w(T)&&w(B)&&u.test(T)&&u.test(B))return B}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(t,n,a){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(t,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],405:[function(t,n,a){var i=a;i.version=t("../package.json").version,i.utils=t("./elliptic/utils"),i.rand=t("brorand"),i.curve=t("./elliptic/curve"),i.curves=t("./elliptic/curves"),i.ec=t("./elliptic/ec"),i.eddsa=t("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(t,n,a){var i=t("bn.js"),o=t("../utils"),c=o.getNAF,u=o.getJSF,l=o.assert;function d(p,h){this.type=p,this.p=new i(h.p,16),this.red=h.prime?i.red(h.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=h.n&&new i(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var y=this.n&&this.p.div(this.n);!y||y.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function f(p,h){this.curve=p,this.type=h,this.precomputed=null}n.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(p,h){l(p.precomputed);var y=p._getDoubles(),g=c(h,1,this._bitLength),m=(1<<y.step+1)-(y.step%2==0?2:1);m/=3;var x,v,w=[];for(x=0;x<g.length;x+=y.step){v=0;for(var _=x+y.step-1;_>=x;_--)v=(v<<1)+g[_];w.push(v)}for(var A=this.jpoint(null,null,null),P=this.jpoint(null,null,null),B=m;B>0;B--){for(x=0;x<w.length;x++)(v=w[x])===B?P=P.mixedAdd(y.points[x]):v===-B&&(P=P.mixedAdd(y.points[x].neg()));A=A.add(P)}return A.toP()},d.prototype._wnafMul=function(p,h){var y=4,g=p._getNAFPoints(y);y=g.wnd;for(var m=g.points,x=c(h,y,this._bitLength),v=this.jpoint(null,null,null),w=x.length-1;w>=0;w--){for(var _=0;w>=0&&x[w]===0;w--)_++;if(w>=0&&_++,v=v.dblp(_),w<0)break;var A=x[w];l(A!==0),v=p.type==="affine"?A>0?v.mixedAdd(m[A-1>>1]):v.mixedAdd(m[-A-1>>1].neg()):A>0?v.add(m[A-1>>1]):v.add(m[-A-1>>1].neg())}return p.type==="affine"?v.toP():v},d.prototype._wnafMulAdd=function(p,h,y,g,m){var x,v,w,_=this._wnafT1,A=this._wnafT2,P=this._wnafT3,B=0;for(x=0;x<g;x++){var T=(w=h[x])._getNAFPoints(p);_[x]=T.wnd,A[x]=T.points}for(x=g-1;x>=1;x-=2){var I=x-1,U=x;if(_[I]===1&&_[U]===1){var H=[h[I],null,null,h[U]];h[I].y.cmp(h[U].y)===0?(H[1]=h[I].add(h[U]),H[2]=h[I].toJ().mixedAdd(h[U].neg())):h[I].y.cmp(h[U].y.redNeg())===0?(H[1]=h[I].toJ().mixedAdd(h[U]),H[2]=h[I].add(h[U].neg())):(H[1]=h[I].toJ().mixedAdd(h[U]),H[2]=h[I].toJ().mixedAdd(h[U].neg()));var z=[-3,-1,-5,-7,0,7,5,1,3],O=u(y[I],y[U]);for(B=Math.max(O[0].length,B),P[I]=new Array(B),P[U]=new Array(B),v=0;v<B;v++){var L=0|O[0][v],E=0|O[1][v];P[I][v]=z[3*(L+1)+(E+1)],P[U][v]=0,A[I]=H}}else P[I]=c(y[I],_[I],this._bitLength),P[U]=c(y[U],_[U],this._bitLength),B=Math.max(P[I].length,B),B=Math.max(P[U].length,B)}var k=this.jpoint(null,null,null),N=this._wnafT4;for(x=B;x>=0;x--){for(var S=0;x>=0;){var C=!0;for(v=0;v<g;v++)N[v]=0|P[v][x],N[v]!==0&&(C=!1);if(!C)break;S++,x--}if(x>=0&&S++,k=k.dblp(S),x<0)break;for(v=0;v<g;v++){var D=N[v];D!==0&&(D>0?w=A[v][D-1>>1]:D<0&&(w=A[v][-D-1>>1].neg()),k=w.type==="affine"?k.mixedAdd(w):k.add(w))}}for(x=0;x<g;x++)A[x]=null;return m?k:k.toP()},d.BasePoint=f,f.prototype.eq=function(){throw new Error("Not implemented")},f.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(p,h){p=o.toArray(p,h);var y=this.p.byteLength();if((p[0]===4||p[0]===6||p[0]===7)&&p.length-1==2*y)return p[0]===6?l(p[p.length-1]%2==0):p[0]===7&&l(p[p.length-1]%2==1),this.point(p.slice(1,1+y),p.slice(1+y,1+2*y));if((p[0]===2||p[0]===3)&&p.length-1===y)return this.pointFromX(p.slice(1,1+y),p[0]===3);throw new Error("Unknown point format")},f.prototype.encodeCompressed=function(p){return this.encode(p,!0)},f.prototype._encode=function(p){var h=this.curve.p.byteLength(),y=this.getX().toArray("be",h);return p?[this.getY().isEven()?2:3].concat(y):[4].concat(y,this.getY().toArray("be",h))},f.prototype.encode=function(p,h){return o.encode(this._encode(h),p)},f.prototype.precompute=function(p){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,p),h.beta=this._getBeta(),this.precomputed=h,this},f.prototype._hasDoubles=function(p){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((p.bitLength()+1)/h.step)},f.prototype._getDoubles=function(p,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var y=[this],g=this,m=0;m<h;m+=p){for(var x=0;x<p;x++)g=g.dbl();y.push(g)}return{step:p,points:y}},f.prototype._getNAFPoints=function(p){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],y=(1<<p)-1,g=y===1?null:this.dbl(),m=1;m<y;m++)h[m]=h[m-1].add(g);return{wnd:p,points:h}},f.prototype._getBeta=function(){return null},f.prototype.dblp=function(p){for(var h=this,y=0;y<p;y++)h=h.dbl();return h}},{"../utils":419,"bn.js":420}],407:[function(t,n,a){var i=t("../utils"),o=t("bn.js"),c=t("inherits"),u=t("./base"),l=i.assert;function d(p){this.twisted=(0|p.a)!=1,this.mOneA=this.twisted&&(0|p.a)==-1,this.extended=this.mOneA,u.call(this,"edwards",p),this.a=new o(p.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(p.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(p.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),l(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|p.c)==1}function f(p,h,y,g,m){u.BasePoint.call(this,p,"projective"),h===null&&y===null&&g===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(h,16),this.y=new o(y,16),this.z=g?new o(g,16):this.curve.one,this.t=m&&new o(m,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}c(d,u),n.exports=d,d.prototype._mulA=function(p){return this.mOneA?p.redNeg():this.a.redMul(p)},d.prototype._mulC=function(p){return this.oneC?p:this.c.redMul(p)},d.prototype.jpoint=function(p,h,y,g){return this.point(p,h,y,g)},d.prototype.pointFromX=function(p,h){(p=new o(p,16)).red||(p=p.toRed(this.red));var y=p.redSqr(),g=this.c2.redSub(this.a.redMul(y)),m=this.one.redSub(this.c2.redMul(this.d).redMul(y)),x=g.redMul(m.redInvm()),v=x.redSqrt();if(v.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var w=v.fromRed().isOdd();return(h&&!w||!h&&w)&&(v=v.redNeg()),this.point(p,v)},d.prototype.pointFromY=function(p,h){(p=new o(p,16)).red||(p=p.toRed(this.red));var y=p.redSqr(),g=y.redSub(this.c2),m=y.redMul(this.d).redMul(this.c2).redSub(this.a),x=g.redMul(m.redInvm());if(x.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,p)}var v=x.redSqrt();if(v.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");return v.fromRed().isOdd()!==h&&(v=v.redNeg()),this.point(v,p)},d.prototype.validate=function(p){if(p.isInfinity())return!0;p.normalize();var h=p.x.redSqr(),y=p.y.redSqr(),g=h.redMul(this.a).redAdd(y),m=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(y)));return g.cmp(m)===0},c(f,u.BasePoint),d.prototype.pointFromJSON=function(p){return f.fromJSON(this,p)},d.prototype.point=function(p,h,y,g){return new f(this,p,h,y,g)},f.fromJSON=function(p,h){return new f(p,h[0],h[1],h[2])},f.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},f.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},f.prototype._extDbl=function(){var p=this.x.redSqr(),h=this.y.redSqr(),y=this.z.redSqr();y=y.redIAdd(y);var g=this.curve._mulA(p),m=this.x.redAdd(this.y).redSqr().redISub(p).redISub(h),x=g.redAdd(h),v=x.redSub(y),w=g.redSub(h),_=m.redMul(v),A=x.redMul(w),P=m.redMul(w),B=v.redMul(x);return this.curve.point(_,A,B,P)},f.prototype._projDbl=function(){var p,h,y,g,m,x,v=this.x.redAdd(this.y).redSqr(),w=this.x.redSqr(),_=this.y.redSqr();if(this.curve.twisted){var A=(g=this.curve._mulA(w)).redAdd(_);this.zOne?(p=v.redSub(w).redSub(_).redMul(A.redSub(this.curve.two)),h=A.redMul(g.redSub(_)),y=A.redSqr().redSub(A).redSub(A)):(m=this.z.redSqr(),x=A.redSub(m).redISub(m),p=v.redSub(w).redISub(_).redMul(x),h=A.redMul(g.redSub(_)),y=A.redMul(x))}else g=w.redAdd(_),m=this.curve._mulC(this.z).redSqr(),x=g.redSub(m).redSub(m),p=this.curve._mulC(v.redISub(g)).redMul(x),h=this.curve._mulC(g).redMul(w.redISub(_)),y=g.redMul(x);return this.curve.point(p,h,y)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},f.prototype._extAdd=function(p){var h=this.y.redSub(this.x).redMul(p.y.redSub(p.x)),y=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x)),g=this.t.redMul(this.curve.dd).redMul(p.t),m=this.z.redMul(p.z.redAdd(p.z)),x=y.redSub(h),v=m.redSub(g),w=m.redAdd(g),_=y.redAdd(h),A=x.redMul(v),P=w.redMul(_),B=x.redMul(_),T=v.redMul(w);return this.curve.point(A,P,T,B)},f.prototype._projAdd=function(p){var h,y,g=this.z.redMul(p.z),m=g.redSqr(),x=this.x.redMul(p.x),v=this.y.redMul(p.y),w=this.curve.d.redMul(x).redMul(v),_=m.redSub(w),A=m.redAdd(w),P=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(x).redISub(v),B=g.redMul(_).redMul(P);return this.curve.twisted?(h=g.redMul(A).redMul(v.redSub(this.curve._mulA(x))),y=_.redMul(A)):(h=g.redMul(A).redMul(v.redSub(x)),y=this.curve._mulC(_).redMul(A)),this.curve.point(B,h,y)},f.prototype.add=function(p){return this.isInfinity()?p:p.isInfinity()?this:this.curve.extended?this._extAdd(p):this._projAdd(p)},f.prototype.mul=function(p){return this._hasDoubles(p)?this.curve._fixedNafMul(this,p):this.curve._wnafMul(this,p)},f.prototype.mulAdd=function(p,h,y){return this.curve._wnafMulAdd(1,[this,h],[p,y],2,!1)},f.prototype.jmulAdd=function(p,h,y){return this.curve._wnafMulAdd(1,[this,h],[p,y],2,!0)},f.prototype.normalize=function(){if(this.zOne)return this;var p=this.z.redInvm();return this.x=this.x.redMul(p),this.y=this.y.redMul(p),this.t&&(this.t=this.t.redMul(p)),this.z=this.curve.one,this.zOne=!0,this},f.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},f.prototype.getX=function(){return this.normalize(),this.x.fromRed()},f.prototype.getY=function(){return this.normalize(),this.y.fromRed()},f.prototype.eq=function(p){return this===p||this.getX().cmp(p.getX())===0&&this.getY().cmp(p.getY())===0},f.prototype.eqXToP=function(p){var h=p.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var y=p.clone(),g=this.curve.redN.redMul(this.z);;){if(y.iadd(this.curve.n),y.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(g),this.x.cmp(h)===0)return!0}},f.prototype.toP=f.prototype.normalize,f.prototype.mixedAdd=f.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(t,n,a){var i=a;i.base=t("./base"),i.short=t("./short"),i.mont=t("./mont"),i.edwards=t("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(t,n,a){var i=t("bn.js"),o=t("inherits"),c=t("./base"),u=t("../utils");function l(f){c.call(this,"mont",f),this.a=new i(f.a,16).toRed(this.red),this.b=new i(f.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function d(f,p,h){c.BasePoint.call(this,f,"projective"),p===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(p,16),this.z=new i(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(l,c),n.exports=l,l.prototype.validate=function(f){var p=f.normalize().x,h=p.redSqr(),y=h.redMul(p).redAdd(h.redMul(this.a)).redAdd(p);return y.redSqrt().redSqr().cmp(y)===0},o(d,c.BasePoint),l.prototype.decodePoint=function(f,p){return this.point(u.toArray(f,p),1)},l.prototype.point=function(f,p){return new d(this,f,p)},l.prototype.pointFromJSON=function(f){return d.fromJSON(this,f)},d.prototype.precompute=function(){},d.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},d.fromJSON=function(f,p){return new d(f,p[0],p[1]||f.one)},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0},d.prototype.dbl=function(){var f=this.x.redAdd(this.z).redSqr(),p=this.x.redSub(this.z).redSqr(),h=f.redSub(p),y=f.redMul(p),g=h.redMul(p.redAdd(this.curve.a24.redMul(h)));return this.curve.point(y,g)},d.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.diffAdd=function(f,p){var h=this.x.redAdd(this.z),y=this.x.redSub(this.z),g=f.x.redAdd(f.z),m=f.x.redSub(f.z).redMul(h),x=g.redMul(y),v=p.z.redMul(m.redAdd(x).redSqr()),w=p.x.redMul(m.redISub(x).redSqr());return this.curve.point(v,w)},d.prototype.mul=function(f){for(var p=f.clone(),h=this,y=this.curve.point(null,null),g=[];p.cmpn(0)!==0;p.iushrn(1))g.push(p.andln(1));for(var m=g.length-1;m>=0;m--)g[m]===0?(h=h.diffAdd(y,this),y=y.dbl()):(y=h.diffAdd(y,this),h=h.dbl());return y},d.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.eq=function(f){return this.getX().cmp(f.getX())===0},d.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(t,n,a){var i=t("../utils"),o=t("bn.js"),c=t("inherits"),u=t("./base"),l=i.assert;function d(h){u.call(this,"short",h),this.a=new o(h.a,16).toRed(this.red),this.b=new o(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function f(h,y,g,m){u.BasePoint.call(this,h,"affine"),y===null&&g===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(y,16),this.y=new o(g,16),m&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function p(h,y,g,m){u.BasePoint.call(this,h,"jacobian"),y===null&&g===null&&m===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(y,16),this.y=new o(g,16),this.z=new o(m,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}c(d,u),n.exports=d,d.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var y,g;if(h.beta)y=new o(h.beta,16).toRed(this.red);else{var m=this._getEndoRoots(this.p);y=(y=m[0].cmp(m[1])<0?m[0]:m[1]).toRed(this.red)}if(h.lambda)g=new o(h.lambda,16);else{var x=this._getEndoRoots(this.n);this.g.mul(x[0]).x.cmp(this.g.x.redMul(y))===0?g=x[0]:(g=x[1],l(this.g.mul(g).x.cmp(this.g.x.redMul(y))===0))}return{beta:y,lambda:g,basis:h.basis?h.basis.map((function(v){return{a:new o(v.a,16),b:new o(v.b,16)}})):this._getEndoBasis(g)}}},d.prototype._getEndoRoots=function(h){var y=h===this.p?this.red:o.mont(h),g=new o(2).toRed(y).redInvm(),m=g.redNeg(),x=new o(3).toRed(y).redNeg().redSqrt().redMul(g);return[m.redAdd(x).fromRed(),m.redSub(x).fromRed()]},d.prototype._getEndoBasis=function(h){for(var y,g,m,x,v,w,_,A,P,B=this.n.ushrn(Math.floor(this.n.bitLength()/2)),T=h,I=this.n.clone(),U=new o(1),H=new o(0),z=new o(0),O=new o(1),L=0;T.cmpn(0)!==0;){var E=I.div(T);A=I.sub(E.mul(T)),P=z.sub(E.mul(U));var k=O.sub(E.mul(H));if(!m&&A.cmp(B)<0)y=_.neg(),g=U,m=A.neg(),x=P;else if(m&&++L==2)break;_=A,I=T,T=A,z=U,U=P,O=H,H=k}v=A.neg(),w=P;var N=m.sqr().add(x.sqr());return v.sqr().add(w.sqr()).cmp(N)>=0&&(v=y,w=g),m.negative&&(m=m.neg(),x=x.neg()),v.negative&&(v=v.neg(),w=w.neg()),[{a:m,b:x},{a:v,b:w}]},d.prototype._endoSplit=function(h){var y=this.endo.basis,g=y[0],m=y[1],x=m.b.mul(h).divRound(this.n),v=g.b.neg().mul(h).divRound(this.n),w=x.mul(g.a),_=v.mul(m.a),A=x.mul(g.b),P=v.mul(m.b);return{k1:h.sub(w).sub(_),k2:A.add(P).neg()}},d.prototype.pointFromX=function(h,y){(h=new o(h,16)).red||(h=h.toRed(this.red));var g=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),m=g.redSqrt();if(m.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var x=m.fromRed().isOdd();return(y&&!x||!y&&x)&&(m=m.redNeg()),this.point(h,m)},d.prototype.validate=function(h){if(h.inf)return!0;var y=h.x,g=h.y,m=this.a.redMul(y),x=y.redSqr().redMul(y).redIAdd(m).redIAdd(this.b);return g.redSqr().redISub(x).cmpn(0)===0},d.prototype._endoWnafMulAdd=function(h,y,g){for(var m=this._endoWnafT1,x=this._endoWnafT2,v=0;v<h.length;v++){var w=this._endoSplit(y[v]),_=h[v],A=_._getBeta();w.k1.negative&&(w.k1.ineg(),_=_.neg(!0)),w.k2.negative&&(w.k2.ineg(),A=A.neg(!0)),m[2*v]=_,m[2*v+1]=A,x[2*v]=w.k1,x[2*v+1]=w.k2}for(var P=this._wnafMulAdd(1,m,x,2*v,g),B=0;B<2*v;B++)m[B]=null,x[B]=null;return P},c(f,u.BasePoint),d.prototype.point=function(h,y,g){return new f(this,h,y,g)},d.prototype.pointFromJSON=function(h,y){return f.fromJSON(this,h,y)},f.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var y=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var g=this.curve,m=function(x){return g.point(x.x.redMul(g.endo.beta),x.y)};h.beta=y,y.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(m)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(m)}}}return y}},f.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},f.fromJSON=function(h,y,g){typeof y=="string"&&(y=JSON.parse(y));var m=h.point(y[0],y[1],g);if(!y[2])return m;function x(w){return h.point(w[0],w[1],g)}var v=y[2];return m.precomputed={beta:null,doubles:v.doubles&&{step:v.doubles.step,points:[m].concat(v.doubles.points.map(x))},naf:v.naf&&{wnd:v.naf.wnd,points:[m].concat(v.naf.points.map(x))}},m},f.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},f.prototype.isInfinity=function(){return this.inf},f.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var y=this.y.redSub(h.y);y.cmpn(0)!==0&&(y=y.redMul(this.x.redSub(h.x).redInvm()));var g=y.redSqr().redISub(this.x).redISub(h.x),m=y.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,m)},f.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var y=this.curve.a,g=this.x.redSqr(),m=h.redInvm(),x=g.redAdd(g).redIAdd(g).redIAdd(y).redMul(m),v=x.redSqr().redISub(this.x.redAdd(this.x)),w=x.redMul(this.x.redSub(v)).redISub(this.y);return this.curve.point(v,w)},f.prototype.getX=function(){return this.x.fromRed()},f.prototype.getY=function(){return this.y.fromRed()},f.prototype.mul=function(h){return h=new o(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},f.prototype.mulAdd=function(h,y,g){var m=[this,y],x=[h,g];return this.curve.endo?this.curve._endoWnafMulAdd(m,x):this.curve._wnafMulAdd(1,m,x,2)},f.prototype.jmulAdd=function(h,y,g){var m=[this,y],x=[h,g];return this.curve.endo?this.curve._endoWnafMulAdd(m,x,!0):this.curve._wnafMulAdd(1,m,x,2,!0)},f.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},f.prototype.neg=function(h){if(this.inf)return this;var y=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var g=this.precomputed,m=function(x){return x.neg()};y.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(m)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(m)}}}return y},f.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},c(p,u.BasePoint),d.prototype.jpoint=function(h,y,g){return new p(this,h,y,g)},p.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),y=h.redSqr(),g=this.x.redMul(y),m=this.y.redMul(y).redMul(h);return this.curve.point(g,m)},p.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},p.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var y=h.z.redSqr(),g=this.z.redSqr(),m=this.x.redMul(y),x=h.x.redMul(g),v=this.y.redMul(y.redMul(h.z)),w=h.y.redMul(g.redMul(this.z)),_=m.redSub(x),A=v.redSub(w);if(_.cmpn(0)===0)return A.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var P=_.redSqr(),B=P.redMul(_),T=m.redMul(P),I=A.redSqr().redIAdd(B).redISub(T).redISub(T),U=A.redMul(T.redISub(I)).redISub(v.redMul(B)),H=this.z.redMul(h.z).redMul(_);return this.curve.jpoint(I,U,H)},p.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var y=this.z.redSqr(),g=this.x,m=h.x.redMul(y),x=this.y,v=h.y.redMul(y).redMul(this.z),w=g.redSub(m),_=x.redSub(v);if(w.cmpn(0)===0)return _.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var A=w.redSqr(),P=A.redMul(w),B=g.redMul(A),T=_.redSqr().redIAdd(P).redISub(B).redISub(B),I=_.redMul(B.redISub(T)).redISub(x.redMul(P)),U=this.z.redMul(w);return this.curve.jpoint(T,I,U)},p.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();var y;if(this.curve.zeroA||this.curve.threeA){var g=this;for(y=0;y<h;y++)g=g.dbl();return g}var m=this.curve.a,x=this.curve.tinv,v=this.x,w=this.y,_=this.z,A=_.redSqr().redSqr(),P=w.redAdd(w);for(y=0;y<h;y++){var B=v.redSqr(),T=P.redSqr(),I=T.redSqr(),U=B.redAdd(B).redIAdd(B).redIAdd(m.redMul(A)),H=v.redMul(T),z=U.redSqr().redISub(H.redAdd(H)),O=H.redISub(z),L=U.redMul(O);L=L.redIAdd(L).redISub(I);var E=P.redMul(_);y+1<h&&(A=A.redMul(I)),v=z,_=E,P=L}return this.curve.jpoint(v,P.redMul(x),_)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},p.prototype._zeroDbl=function(){var h,y,g;if(this.zOne){var m=this.x.redSqr(),x=this.y.redSqr(),v=x.redSqr(),w=this.x.redAdd(x).redSqr().redISub(m).redISub(v);w=w.redIAdd(w);var _=m.redAdd(m).redIAdd(m),A=_.redSqr().redISub(w).redISub(w),P=v.redIAdd(v);P=(P=P.redIAdd(P)).redIAdd(P),h=A,y=_.redMul(w.redISub(A)).redISub(P),g=this.y.redAdd(this.y)}else{var B=this.x.redSqr(),T=this.y.redSqr(),I=T.redSqr(),U=this.x.redAdd(T).redSqr().redISub(B).redISub(I);U=U.redIAdd(U);var H=B.redAdd(B).redIAdd(B),z=H.redSqr(),O=I.redIAdd(I);O=(O=O.redIAdd(O)).redIAdd(O),h=z.redISub(U).redISub(U),y=H.redMul(U.redISub(h)).redISub(O),g=(g=this.y.redMul(this.z)).redIAdd(g)}return this.curve.jpoint(h,y,g)},p.prototype._threeDbl=function(){var h,y,g;if(this.zOne){var m=this.x.redSqr(),x=this.y.redSqr(),v=x.redSqr(),w=this.x.redAdd(x).redSqr().redISub(m).redISub(v);w=w.redIAdd(w);var _=m.redAdd(m).redIAdd(m).redIAdd(this.curve.a),A=_.redSqr().redISub(w).redISub(w);h=A;var P=v.redIAdd(v);P=(P=P.redIAdd(P)).redIAdd(P),y=_.redMul(w.redISub(A)).redISub(P),g=this.y.redAdd(this.y)}else{var B=this.z.redSqr(),T=this.y.redSqr(),I=this.x.redMul(T),U=this.x.redSub(B).redMul(this.x.redAdd(B));U=U.redAdd(U).redIAdd(U);var H=I.redIAdd(I),z=(H=H.redIAdd(H)).redAdd(H);h=U.redSqr().redISub(z),g=this.y.redAdd(this.z).redSqr().redISub(T).redISub(B);var O=T.redSqr();O=(O=(O=O.redIAdd(O)).redIAdd(O)).redIAdd(O),y=U.redMul(H.redISub(h)).redISub(O)}return this.curve.jpoint(h,y,g)},p.prototype._dbl=function(){var h=this.curve.a,y=this.x,g=this.y,m=this.z,x=m.redSqr().redSqr(),v=y.redSqr(),w=g.redSqr(),_=v.redAdd(v).redIAdd(v).redIAdd(h.redMul(x)),A=y.redAdd(y),P=(A=A.redIAdd(A)).redMul(w),B=_.redSqr().redISub(P.redAdd(P)),T=P.redISub(B),I=w.redSqr();I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I);var U=_.redMul(T).redISub(I),H=g.redAdd(g).redMul(m);return this.curve.jpoint(B,U,H)},p.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),y=this.y.redSqr(),g=this.z.redSqr(),m=y.redSqr(),x=h.redAdd(h).redIAdd(h),v=x.redSqr(),w=this.x.redAdd(y).redSqr().redISub(h).redISub(m),_=(w=(w=(w=w.redIAdd(w)).redAdd(w).redIAdd(w)).redISub(v)).redSqr(),A=m.redIAdd(m);A=(A=(A=A.redIAdd(A)).redIAdd(A)).redIAdd(A);var P=x.redIAdd(w).redSqr().redISub(v).redISub(_).redISub(A),B=y.redMul(P);B=(B=B.redIAdd(B)).redIAdd(B);var T=this.x.redMul(_).redISub(B);T=(T=T.redIAdd(T)).redIAdd(T);var I=this.y.redMul(P.redMul(A.redISub(P)).redISub(w.redMul(_)));I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I);var U=this.z.redAdd(w).redSqr().redISub(g).redISub(_);return this.curve.jpoint(T,I,U)},p.prototype.mul=function(h,y){return h=new o(h,y),this.curve._wnafMul(this,h)},p.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var y=this.z.redSqr(),g=h.z.redSqr();if(this.x.redMul(g).redISub(h.x.redMul(y)).cmpn(0)!==0)return!1;var m=y.redMul(this.z),x=g.redMul(h.z);return this.y.redMul(x).redISub(h.y.redMul(m)).cmpn(0)===0},p.prototype.eqXToP=function(h){var y=this.z.redSqr(),g=h.toRed(this.curve.red).redMul(y);if(this.x.cmp(g)===0)return!0;for(var m=h.clone(),x=this.curve.redN.redMul(y);;){if(m.iadd(this.curve.n),m.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(x),this.x.cmp(g)===0)return!0}},p.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},p.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(t,n,a){var i,o=a,c=t("hash.js"),u=t("./curve"),l=t("./utils").assert;function d(p){p.type==="short"?this.curve=new u.short(p):p.type==="edwards"?this.curve=new u.edwards(p):this.curve=new u.mont(p),this.g=this.curve.g,this.n=this.curve.n,this.hash=p.hash,l(this.g.validate(),"Invalid curve"),l(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function f(p,h){Object.defineProperty(o,p,{configurable:!0,enumerable:!0,get:function(){var y=new d(h);return Object.defineProperty(o,p,{configurable:!0,enumerable:!0,value:y}),y}})}o.PresetCurve=d,f("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:c.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),f("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:c.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),f("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:c.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),f("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:c.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),f("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:c.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),f("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["9"]}),f("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=t("./precomputed/secp256k1")}catch{i=void 0}f("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:c.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(t,n,a){var i=t("bn.js"),o=t("hmac-drbg"),c=t("../utils"),u=t("../curves"),l=t("brorand"),d=c.assert,f=t("./key"),p=t("./signature");function h(y){if(!(this instanceof h))return new h(y);typeof y=="string"&&(d(Object.prototype.hasOwnProperty.call(u,y),"Unknown curve "+y),y=u[y]),y instanceof u.PresetCurve&&(y={curve:y}),this.curve=y.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=y.curve.g,this.g.precompute(y.curve.n.bitLength()+1),this.hash=y.hash||y.curve.hash}n.exports=h,h.prototype.keyPair=function(y){return new f(this,y)},h.prototype.keyFromPrivate=function(y,g){return f.fromPrivate(this,y,g)},h.prototype.keyFromPublic=function(y,g){return f.fromPublic(this,y,g)},h.prototype.genKeyPair=function(y){y||(y={});for(var g=new o({hash:this.hash,pers:y.pers,persEnc:y.persEnc||"utf8",entropy:y.entropy||l(this.hash.hmacStrength),entropyEnc:y.entropy&&y.entropyEnc||"utf8",nonce:this.n.toArray()}),m=this.n.byteLength(),x=this.n.sub(new i(2));;){var v=new i(g.generate(m));if(!(v.cmp(x)>0))return v.iaddn(1),this.keyFromPrivate(v)}},h.prototype._truncateToN=function(y,g){var m=8*y.byteLength()-this.n.bitLength();return m>0&&(y=y.ushrn(m)),!g&&y.cmp(this.n)>=0?y.sub(this.n):y},h.prototype.sign=function(y,g,m,x){typeof m=="object"&&(x=m,m=null),x||(x={}),g=this.keyFromPrivate(g,m),y=this._truncateToN(new i(y,16));for(var v=this.n.byteLength(),w=g.getPrivate().toArray("be",v),_=y.toArray("be",v),A=new o({hash:this.hash,entropy:w,nonce:_,pers:x.pers,persEnc:x.persEnc||"utf8"}),P=this.n.sub(new i(1)),B=0;;B++){var T=x.k?x.k(B):new i(A.generate(this.n.byteLength()));if(!((T=this._truncateToN(T,!0)).cmpn(1)<=0||T.cmp(P)>=0)){var I=this.g.mul(T);if(!I.isInfinity()){var U=I.getX(),H=U.umod(this.n);if(H.cmpn(0)!==0){var z=T.invm(this.n).mul(H.mul(g.getPrivate()).iadd(y));if((z=z.umod(this.n)).cmpn(0)!==0){var O=(I.getY().isOdd()?1:0)|(U.cmp(H)!==0?2:0);return x.canonical&&z.cmp(this.nh)>0&&(z=this.n.sub(z),O^=1),new p({r:H,s:z,recoveryParam:O})}}}}}},h.prototype.verify=function(y,g,m,x){y=this._truncateToN(new i(y,16)),m=this.keyFromPublic(m,x);var v=(g=new p(g,"hex")).r,w=g.s;if(v.cmpn(1)<0||v.cmp(this.n)>=0||w.cmpn(1)<0||w.cmp(this.n)>=0)return!1;var _,A=w.invm(this.n),P=A.mul(y).umod(this.n),B=A.mul(v).umod(this.n);return this.curve._maxwellTrick?!(_=this.g.jmulAdd(P,m.getPublic(),B)).isInfinity()&&_.eqXToP(v):!(_=this.g.mulAdd(P,m.getPublic(),B)).isInfinity()&&_.getX().umod(this.n).cmp(v)===0},h.prototype.recoverPubKey=function(y,g,m,x){d((3&m)===m,"The recovery param is more than two bits"),g=new p(g,x);var v=this.n,w=new i(y),_=g.r,A=g.s,P=1&m,B=m>>1;if(_.cmp(this.curve.p.umod(this.curve.n))>=0&&B)throw new Error("Unable to find sencond key candinate");_=B?this.curve.pointFromX(_.add(this.curve.n),P):this.curve.pointFromX(_,P);var T=g.r.invm(v),I=v.sub(w).mul(T).umod(v),U=A.mul(T).umod(v);return this.g.mulAdd(I,_,U)},h.prototype.getKeyRecoveryParam=function(y,g,m,x){if((g=new p(g,x)).recoveryParam!==null)return g.recoveryParam;for(var v=0;v<4;v++){var w;try{w=this.recoverPubKey(y,g,v)}catch{continue}if(w.eq(m))return v}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(t,n,a){var i=t("bn.js"),o=t("../utils").assert;function c(u,l){this.ec=u,this.priv=null,this.pub=null,l.priv&&this._importPrivate(l.priv,l.privEnc),l.pub&&this._importPublic(l.pub,l.pubEnc)}n.exports=c,c.fromPublic=function(u,l,d){return l instanceof c?l:new c(u,{pub:l,pubEnc:d})},c.fromPrivate=function(u,l,d){return l instanceof c?l:new c(u,{priv:l,privEnc:d})},c.prototype.validate=function(){var u=this.getPublic();return u.isInfinity()?{result:!1,reason:"Invalid public key"}:u.validate()?u.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},c.prototype.getPublic=function(u,l){return typeof u=="string"&&(l=u,u=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),l?this.pub.encode(l,u):this.pub},c.prototype.getPrivate=function(u){return u==="hex"?this.priv.toString(16,2):this.priv},c.prototype._importPrivate=function(u,l){this.priv=new i(u,l||16),this.priv=this.priv.umod(this.ec.curve.n)},c.prototype._importPublic=function(u,l){if(u.x||u.y)return this.ec.curve.type==="mont"?o(u.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(u.x&&u.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(u.x,u.y));this.pub=this.ec.curve.decodePoint(u,l)},c.prototype.derive=function(u){return u.validate()||o(u.validate(),"public point not validated"),u.mul(this.priv).getX()},c.prototype.sign=function(u,l,d){return this.ec.sign(u,this,l,d)},c.prototype.verify=function(u,l){return this.ec.verify(u,l,this)},c.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(t,n,a){var i=t("bn.js"),o=t("../utils"),c=o.assert;function u(h,y){if(h instanceof u)return h;this._importDER(h,y)||(c(h.r&&h.s,"Signature without r or s"),this.r=new i(h.r,16),this.s=new i(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function l(){this.place=0}function d(h,y){var g=h[y.place++];if(!(128&g))return g;var m=15&g;if(m===0||m>4)return!1;for(var x=0,v=0,w=y.place;v<m;v++,w++)x<<=8,x|=h[w],x>>>=0;return!(x<=127)&&(y.place=w,x)}function f(h){for(var y=0,g=h.length-1;!h[y]&&!(128&h[y+1])&&y<g;)y++;return y===0?h:h.slice(y)}function p(h,y){if(y<128)h.push(y);else{var g=1+(Math.log(y)/Math.LN2>>>3);for(h.push(128|g);--g;)h.push(y>>>(g<<3)&255);h.push(y)}}n.exports=u,u.prototype._importDER=function(h,y){h=o.toArray(h,y);var g=new l;if(h[g.place++]!==48)return!1;var m=d(h,g);if(m===!1||m+g.place!==h.length||h[g.place++]!==2)return!1;var x=d(h,g);if(x===!1)return!1;var v=h.slice(g.place,x+g.place);if(g.place+=x,h[g.place++]!==2)return!1;var w=d(h,g);if(w===!1||h.length!==w+g.place)return!1;var _=h.slice(g.place,w+g.place);if(v[0]===0){if(!(128&v[1]))return!1;v=v.slice(1)}if(_[0]===0){if(!(128&_[1]))return!1;_=_.slice(1)}return this.r=new i(v),this.s=new i(_),this.recoveryParam=null,!0},u.prototype.toDER=function(h){var y=this.r.toArray(),g=this.s.toArray();for(128&y[0]&&(y=[0].concat(y)),128&g[0]&&(g=[0].concat(g)),y=f(y),g=f(g);!(g[0]||128&g[1]);)g=g.slice(1);var m=[2];p(m,y.length),(m=m.concat(y)).push(2),p(m,g.length);var x=m.concat(g),v=[48];return p(v,x.length),v=v.concat(x),o.encode(v,h)}},{"../utils":419,"bn.js":420}],415:[function(t,n,a){var i=t("hash.js"),o=t("../curves"),c=t("../utils"),u=c.assert,l=c.parseBytes,d=t("./key"),f=t("./signature");function p(h){if(u(h==="ed25519","only tested with ed25519 so far"),!(this instanceof p))return new p(h);h=o[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=i.sha512}n.exports=p,p.prototype.sign=function(h,y){h=l(h);var g=this.keyFromSecret(y),m=this.hashInt(g.messagePrefix(),h),x=this.g.mul(m),v=this.encodePoint(x),w=this.hashInt(v,g.pubBytes(),h).mul(g.priv()),_=m.add(w).umod(this.curve.n);return this.makeSignature({R:x,S:_,Rencoded:v})},p.prototype.verify=function(h,y,g){h=l(h),y=this.makeSignature(y);var m=this.keyFromPublic(g),x=this.hashInt(y.Rencoded(),m.pubBytes(),h),v=this.g.mul(y.S());return y.R().add(m.pub().mul(x)).eq(v)},p.prototype.hashInt=function(){for(var h=this.hash(),y=0;y<arguments.length;y++)h.update(arguments[y]);return c.intFromLE(h.digest()).umod(this.curve.n)},p.prototype.keyFromPublic=function(h){return d.fromPublic(this,h)},p.prototype.keyFromSecret=function(h){return d.fromSecret(this,h)},p.prototype.makeSignature=function(h){return h instanceof f?h:new f(this,h)},p.prototype.encodePoint=function(h){var y=h.getY().toArray("le",this.encodingLength);return y[this.encodingLength-1]|=h.getX().isOdd()?128:0,y},p.prototype.decodePoint=function(h){var y=(h=c.parseBytes(h)).length-1,g=h.slice(0,y).concat(-129&h[y]),m=(128&h[y])!=0,x=c.intFromLE(g);return this.curve.pointFromY(x,m)},p.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},p.prototype.decodeInt=function(h){return c.intFromLE(h)},p.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(t,n,a){var i=t("../utils"),o=i.assert,c=i.parseBytes,u=i.cachedProperty;function l(d,f){this.eddsa=d,this._secret=c(f.secret),d.isPoint(f.pub)?this._pub=f.pub:this._pubBytes=c(f.pub)}l.fromPublic=function(d,f){return f instanceof l?f:new l(d,{pub:f})},l.fromSecret=function(d,f){return f instanceof l?f:new l(d,{secret:f})},l.prototype.secret=function(){return this._secret},u(l,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),u(l,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),u(l,"privBytes",(function(){var d=this.eddsa,f=this.hash(),p=d.encodingLength-1,h=f.slice(0,d.encodingLength);return h[0]&=248,h[p]&=127,h[p]|=64,h})),u(l,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),u(l,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),u(l,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),l.prototype.sign=function(d){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(d,this)},l.prototype.verify=function(d,f){return this.eddsa.verify(d,f,this)},l.prototype.getSecret=function(d){return o(this._secret,"KeyPair is public only"),i.encode(this.secret(),d)},l.prototype.getPublic=function(d){return i.encode(this.pubBytes(),d)},n.exports=l},{"../utils":419}],417:[function(t,n,a){var i=t("bn.js"),o=t("../utils"),c=o.assert,u=o.cachedProperty,l=o.parseBytes;function d(f,p){this.eddsa=f,typeof p!="object"&&(p=l(p)),Array.isArray(p)&&(p={R:p.slice(0,f.encodingLength),S:p.slice(f.encodingLength)}),c(p.R&&p.S,"Signature without R or S"),f.isPoint(p.R)&&(this._R=p.R),p.S instanceof i&&(this._S=p.S),this._Rencoded=Array.isArray(p.R)?p.R:p.Rencoded,this._Sencoded=Array.isArray(p.S)?p.S:p.Sencoded}u(d,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),u(d,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),u(d,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),u(d,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),d.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},d.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},n.exports=d},{"../utils":419,"bn.js":420}],418:[function(t,n,a){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(t,n,a){var i=a,o=t("bn.js"),c=t("minimalistic-assert"),u=t("minimalistic-crypto-utils");i.assert=c,i.toArray=u.toArray,i.zero2=u.zero2,i.toHex=u.toHex,i.encode=u.encode,i.getNAF=function(l,d,f){var p=new Array(Math.max(l.bitLength(),f)+1);p.fill(0);for(var h=1<<d+1,y=l.clone(),g=0;g<p.length;g++){var m,x=y.andln(h-1);y.isOdd()?(m=x>(h>>1)-1?(h>>1)-x:x,y.isubn(m)):m=0,p[g]=m,y.iushrn(1)}return p},i.getJSF=function(l,d){var f=[[],[]];l=l.clone(),d=d.clone();for(var p,h=0,y=0;l.cmpn(-h)>0||d.cmpn(-y)>0;){var g,m,x=l.andln(3)+h&3,v=d.andln(3)+y&3;x===3&&(x=-1),v===3&&(v=-1),g=(1&x)==0?0:(p=l.andln(7)+h&7)!==3&&p!==5||v!==2?x:-x,f[0].push(g),m=(1&v)==0?0:(p=d.andln(7)+y&7)!==3&&p!==5||x!==2?v:-v,f[1].push(m),2*h===g+1&&(h=1-h),2*y===m+1&&(y=1-y),l.iushrn(1),d.iushrn(1)}return f},i.cachedProperty=function(l,d,f){var p="_"+d;l.prototype[d]=function(){return this[p]!==void 0?this[p]:this[p]=f.call(this)}},i.parseBytes=function(l){return typeof l=="string"?i.toArray(l,"hex"):l},i.intFromLE=function(l){return new o(l,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(t,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],421:[function(t,n,a){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(t,n,a){var i=Object.create||function(T){var I=function(){};return I.prototype=T,new I},o=Object.keys||function(T){var I=[];for(var U in T)Object.prototype.hasOwnProperty.call(T,U)&&I.push(U);return U},c=Function.prototype.bind||function(T){var I=this;return function(){return I.apply(T,arguments)}};function u(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=u,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._maxListeners=void 0;var l,d=10;try{var f={};Object.defineProperty&&Object.defineProperty(f,"x",{value:0}),l=f.x===0}catch{l=!1}function p(T){return T._maxListeners===void 0?u.defaultMaxListeners:T._maxListeners}function h(T,I,U){if(I)T.call(U);else for(var H=T.length,z=B(T,H),O=0;O<H;++O)z[O].call(U)}function y(T,I,U,H){if(I)T.call(U,H);else for(var z=T.length,O=B(T,z),L=0;L<z;++L)O[L].call(U,H)}function g(T,I,U,H,z){if(I)T.call(U,H,z);else for(var O=T.length,L=B(T,O),E=0;E<O;++E)L[E].call(U,H,z)}function m(T,I,U,H,z,O){if(I)T.call(U,H,z,O);else for(var L=T.length,E=B(T,L),k=0;k<L;++k)E[k].call(U,H,z,O)}function x(T,I,U,H){if(I)T.apply(U,H);else for(var z=T.length,O=B(T,z),L=0;L<z;++L)O[L].apply(U,H)}function v(T,I,U,H){var z,O,L;if(typeof U!="function")throw new TypeError('"listener" argument must be a function');if((O=T._events)?(O.newListener&&(T.emit("newListener",I,U.listener?U.listener:U),O=T._events),L=O[I]):(O=T._events=i(null),T._eventsCount=0),L){if(typeof L=="function"?L=O[I]=H?[U,L]:[L,U]:H?L.unshift(U):L.push(U),!L.warned&&(z=p(T))&&z>0&&L.length>z){L.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+L.length+' "'+String(I)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');E.name="MaxListenersExceededWarning",E.emitter=T,E.type=I,E.count=L.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",E.name,E.message)}}else L=O[I]=U,++T._eventsCount;return T}function w(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var T=new Array(arguments.length),I=0;I<T.length;++I)T[I]=arguments[I];this.listener.apply(this.target,T)}}function _(T,I,U){var H={fired:!1,wrapFn:void 0,target:T,type:I,listener:U},z=c.call(w,H);return z.listener=U,H.wrapFn=z,z}function A(T,I,U){var H=T._events;if(!H)return[];var z=H[I];return z?typeof z=="function"?U?[z.listener||z]:[z]:U?(function(O){for(var L=new Array(O.length),E=0;E<L.length;++E)L[E]=O[E].listener||O[E];return L})(z):B(z,z.length):[]}function P(T){var I=this._events;if(I){var U=I[T];if(typeof U=="function")return 1;if(U)return U.length}return 0}function B(T,I){for(var U=new Array(I),H=0;H<I;++H)U[H]=T[H];return U}l?Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(T){if(typeof T!="number"||T<0||T!=T)throw new TypeError('"defaultMaxListeners" must be a positive number');d=T}}):u.defaultMaxListeners=d,u.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||isNaN(T))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=T,this},u.prototype.getMaxListeners=function(){return p(this)},u.prototype.emit=function(T){var I,U,H,z,O,L,E=T==="error";if(L=this._events)E=E&&L.error==null;else if(!E)return!1;if(E){if(arguments.length>1&&(I=arguments[1]),I instanceof Error)throw I;var k=new Error('Unhandled "error" event. ('+I+")");throw k.context=I,k}if(!(U=L[T]))return!1;var N=typeof U=="function";switch(H=arguments.length){case 1:h(U,N,this);break;case 2:y(U,N,this,arguments[1]);break;case 3:g(U,N,this,arguments[1],arguments[2]);break;case 4:m(U,N,this,arguments[1],arguments[2],arguments[3]);break;default:for(z=new Array(H-1),O=1;O<H;O++)z[O-1]=arguments[O];x(U,N,this,z)}return!0},u.prototype.addListener=function(T,I){return v(this,T,I,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(T,I){return v(this,T,I,!0)},u.prototype.once=function(T,I){if(typeof I!="function")throw new TypeError('"listener" argument must be a function');return this.on(T,_(this,T,I)),this},u.prototype.prependOnceListener=function(T,I){if(typeof I!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(T,_(this,T,I)),this},u.prototype.removeListener=function(T,I){var U,H,z,O,L;if(typeof I!="function")throw new TypeError('"listener" argument must be a function');if(!(H=this._events))return this;if(!(U=H[T]))return this;if(U===I||U.listener===I)--this._eventsCount==0?this._events=i(null):(delete H[T],H.removeListener&&this.emit("removeListener",T,U.listener||I));else if(typeof U!="function"){for(z=-1,O=U.length-1;O>=0;O--)if(U[O]===I||U[O].listener===I){L=U[O].listener,z=O;break}if(z<0)return this;z===0?U.shift():(function(E,k){for(var N=k,S=N+1,C=E.length;S<C;N+=1,S+=1)E[N]=E[S];E.pop()})(U,z),U.length===1&&(H[T]=U[0]),H.removeListener&&this.emit("removeListener",T,L||I)}return this},u.prototype.removeAllListeners=function(T){var I,U,H;if(!(U=this._events))return this;if(!U.removeListener)return arguments.length===0?(this._events=i(null),this._eventsCount=0):U[T]&&(--this._eventsCount==0?this._events=i(null):delete U[T]),this;if(arguments.length===0){var z,O=o(U);for(H=0;H<O.length;++H)(z=O[H])!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if(typeof(I=U[T])=="function")this.removeListener(T,I);else if(I)for(H=I.length-1;H>=0;H--)this.removeListener(T,I[H]);return this},u.prototype.listeners=function(T){return A(this,T,!0)},u.prototype.rawListeners=function(T){return A(this,T,!1)},u.listenerCount=function(T,I){return typeof T.listenerCount=="function"?T.listenerCount(I):P.call(T,I)},u.prototype.listenerCount=P,u.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("md5.js");n.exports=function(c,u,l,d){if(i.isBuffer(c)||(c=i.from(c,"binary")),u&&(i.isBuffer(u)||(u=i.from(u,"binary")),u.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var f=l/8,p=i.alloc(f),h=i.alloc(d||0),y=i.alloc(0);f>0||d>0;){var g=new o;g.update(y),g.update(c),u&&g.update(u),y=g.digest();var m=0;if(f>0){var x=p.length-f;m=Math.min(f,y.length),y.copy(p,x,0,m),f-=m}if(m<y.length&&d>0){var v=h.length-d,w=Math.min(d,y.length-m);y.copy(h,v,m,m+w),d-=w}}return y.fill(0),{key:p,iv:h}}},{"md5.js":450,"safe-buffer":494}],424:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=a.ParserOptions=a.parseFile=a.parseStream=a.parseString=a.parse=a.FormatterOptions=a.CsvFormatterStream=a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=void 0;var i=t("@fast-csv/format");Object.defineProperty(a,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(a,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(a,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(a,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(a,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(a,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var o=t("@fast-csv/parse");Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(a,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(a,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(a,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("readable-stream").Transform;function c(u){o.call(this),this._block=i.allocUnsafe(u),this._blockSize=u,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}t("inherits")(c,o),c.prototype._transform=function(u,l,d){var f=null;try{this.update(u,l)}catch(p){f=p}d(f)},c.prototype._flush=function(u){var l=null;try{this.push(this.digest())}catch(d){l=d}u(l)},c.prototype.update=function(u,l){if((function(g,m){if(!i.isBuffer(g)&&typeof g!="string")throw new TypeError(m+" must be a string or a buffer")})(u,"Data"),this._finalized)throw new Error("Digest already called");i.isBuffer(u)||(u=i.from(u,l));for(var d=this._block,f=0;this._blockOffset+u.length-f>=this._blockSize;){for(var p=this._blockOffset;p<this._blockSize;)d[p++]=u[f++];this._update(),this._blockOffset=0}for(;f<u.length;)d[this._blockOffset++]=u[f++];for(var h=0,y=8*u.length;y>0;++h)this._length[h]+=y,(y=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*y);return this},c.prototype._update=function(){throw new Error("_update is not implemented")},c.prototype.digest=function(u){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var l=this._digest();u!==void 0&&(l=l.toString(u)),this._block.fill(0),this._blockOffset=0;for(var d=0;d<4;++d)this._length[d]=0;return l},c.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=c},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(t,n,a){var i=a;i.utils=t("./hash/utils"),i.common=t("./hash/common"),i.sha=t("./hash/sha"),i.ripemd=t("./hash/ripemd"),i.hmac=t("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(t,n,a){var i=t("./utils"),o=t("minimalistic-assert");function c(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}a.BlockHash=c,c.prototype.update=function(u,l){if(u=i.toArray(u,l),this.pending?this.pending=this.pending.concat(u):this.pending=u,this.pendingTotal+=u.length,this.pending.length>=this._delta8){var d=(u=this.pending).length%this._delta8;this.pending=u.slice(u.length-d,u.length),this.pending.length===0&&(this.pending=null),u=i.join32(u,0,u.length-d,this.endian);for(var f=0;f<u.length;f+=this._delta32)this._update(u,f,f+this._delta32)}return this},c.prototype.digest=function(u){return this.update(this._pad()),o(this.pending===null),this._digest(u)},c.prototype._pad=function(){var u=this.pendingTotal,l=this._delta8,d=l-(u+this.padLength)%l,f=new Array(d+this.padLength);f[0]=128;for(var p=1;p<d;p++)f[p]=0;if(u<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)f[p++]=0;f[p++]=0,f[p++]=0,f[p++]=0,f[p++]=0,f[p++]=u>>>24&255,f[p++]=u>>>16&255,f[p++]=u>>>8&255,f[p++]=255&u}else for(f[p++]=255&u,f[p++]=u>>>8&255,f[p++]=u>>>16&255,f[p++]=u>>>24&255,f[p++]=0,f[p++]=0,f[p++]=0,f[p++]=0,h=8;h<this.padLength;h++)f[p++]=0;return f}},{"./utils":437,"minimalistic-assert":453}],428:[function(t,n,a){var i=t("./utils"),o=t("minimalistic-assert");function c(u,l,d){if(!(this instanceof c))return new c(u,l,d);this.Hash=u,this.blockSize=u.blockSize/8,this.outSize=u.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(l,d))}n.exports=c,c.prototype._init=function(u){u.length>this.blockSize&&(u=new this.Hash().update(u).digest()),o(u.length<=this.blockSize);for(var l=u.length;l<this.blockSize;l++)u.push(0);for(l=0;l<u.length;l++)u[l]^=54;for(this.inner=new this.Hash().update(u),l=0;l<u.length;l++)u[l]^=106;this.outer=new this.Hash().update(u)},c.prototype.update=function(u,l){return this.inner.update(u,l),this},c.prototype.digest=function(u){return this.outer.update(this.inner.digest()),this.outer.digest(u)}},{"./utils":437,"minimalistic-assert":453}],429:[function(t,n,a){var i=t("./utils"),o=t("./common"),c=i.rotl32,u=i.sum32,l=i.sum32_3,d=i.sum32_4,f=o.BlockHash;function p(){if(!(this instanceof p))return new p;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(_,A,P,B){return _<=15?A^P^B:_<=31?A&P|~A&B:_<=47?(A|~P)^B:_<=63?A&B|P&~B:A^(P|~B)}function y(_){return _<=15?0:_<=31?1518500249:_<=47?1859775393:_<=63?2400959708:2840853838}function g(_){return _<=15?1352829926:_<=31?1548603684:_<=47?1836072691:_<=63?2053994217:0}i.inherits(p,f),a.ripemd160=p,p.blockSize=512,p.outSize=160,p.hmacStrength=192,p.padLength=64,p.prototype._update=function(_,A){for(var P=this.h[0],B=this.h[1],T=this.h[2],I=this.h[3],U=this.h[4],H=P,z=B,O=T,L=I,E=U,k=0;k<80;k++){var N=u(c(d(P,h(k,B,T,I),_[m[k]+A],y(k)),v[k]),U);P=U,U=I,I=c(T,10),T=B,B=N,N=u(c(d(H,h(79-k,z,O,L),_[x[k]+A],g(k)),w[k]),E),H=E,E=L,L=c(O,10),O=z,z=N}N=l(this.h[1],T,L),this.h[1]=l(this.h[2],I,E),this.h[2]=l(this.h[3],U,H),this.h[3]=l(this.h[4],P,z),this.h[4]=l(this.h[0],B,O),this.h[0]=N},p.prototype._digest=function(_){return _==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],v=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],w=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(t,n,a){a.sha1=t("./sha/1"),a.sha224=t("./sha/224"),a.sha256=t("./sha/256"),a.sha384=t("./sha/384"),a.sha512=t("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(t,n,a){var i=t("../utils"),o=t("../common"),c=t("./common"),u=i.rotl32,l=i.sum32,d=i.sum32_5,f=c.ft_1,p=o.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function y(){if(!(this instanceof y))return new y;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(y,p),n.exports=y,y.blockSize=512,y.outSize=160,y.hmacStrength=80,y.padLength=64,y.prototype._update=function(g,m){for(var x=this.W,v=0;v<16;v++)x[v]=g[m+v];for(;v<x.length;v++)x[v]=u(x[v-3]^x[v-8]^x[v-14]^x[v-16],1);var w=this.h[0],_=this.h[1],A=this.h[2],P=this.h[3],B=this.h[4];for(v=0;v<x.length;v++){var T=~~(v/20),I=d(u(w,5),f(T,_,A,P),B,x[v],h[T]);B=P,P=A,A=u(_,30),_=w,w=I}this.h[0]=l(this.h[0],w),this.h[1]=l(this.h[1],_),this.h[2]=l(this.h[2],A),this.h[3]=l(this.h[3],P),this.h[4]=l(this.h[4],B)},y.prototype._digest=function(g){return g==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(t,n,a){var i=t("../utils"),o=t("./256");function c(){if(!(this instanceof c))return new c;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(c,o),n.exports=c,c.blockSize=512,c.outSize=224,c.hmacStrength=192,c.padLength=64,c.prototype._digest=function(u){return u==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(t,n,a){var i=t("../utils"),o=t("../common"),c=t("./common"),u=t("minimalistic-assert"),l=i.sum32,d=i.sum32_4,f=i.sum32_5,p=c.ch32,h=c.maj32,y=c.s0_256,g=c.s1_256,m=c.g0_256,x=c.g1_256,v=o.BlockHash,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _(){if(!(this instanceof _))return new _;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=w,this.W=new Array(64)}i.inherits(_,v),n.exports=_,_.blockSize=512,_.outSize=256,_.hmacStrength=192,_.padLength=64,_.prototype._update=function(A,P){for(var B=this.W,T=0;T<16;T++)B[T]=A[P+T];for(;T<B.length;T++)B[T]=d(x(B[T-2]),B[T-7],m(B[T-15]),B[T-16]);var I=this.h[0],U=this.h[1],H=this.h[2],z=this.h[3],O=this.h[4],L=this.h[5],E=this.h[6],k=this.h[7];for(u(this.k.length===B.length),T=0;T<B.length;T++){var N=f(k,g(O),p(O,L,E),this.k[T],B[T]),S=l(y(I),h(I,U,H));k=E,E=L,L=O,O=l(z,N),z=H,H=U,U=I,I=l(N,S)}this.h[0]=l(this.h[0],I),this.h[1]=l(this.h[1],U),this.h[2]=l(this.h[2],H),this.h[3]=l(this.h[3],z),this.h[4]=l(this.h[4],O),this.h[5]=l(this.h[5],L),this.h[6]=l(this.h[6],E),this.h[7]=l(this.h[7],k)},_.prototype._digest=function(A){return A==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(t,n,a){var i=t("../utils"),o=t("./512");function c(){if(!(this instanceof c))return new c;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(c,o),n.exports=c,c.blockSize=1024,c.outSize=384,c.hmacStrength=192,c.padLength=128,c.prototype._digest=function(u){return u==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(t,n,a){var i=t("../utils"),o=t("../common"),c=t("minimalistic-assert"),u=i.rotr64_hi,l=i.rotr64_lo,d=i.shr64_hi,f=i.shr64_lo,p=i.sum64,h=i.sum64_hi,y=i.sum64_lo,g=i.sum64_4_hi,m=i.sum64_4_lo,x=i.sum64_5_hi,v=i.sum64_5_lo,w=o.BlockHash,_=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function A(){if(!(this instanceof A))return new A;w.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=_,this.W=new Array(160)}function P(S,C,D,q,M){var G=S&D^~S&M;return G<0&&(G+=4294967296),G}function B(S,C,D,q,M,G){var X=C&q^~C&G;return X<0&&(X+=4294967296),X}function T(S,C,D,q,M){var G=S&D^S&M^D&M;return G<0&&(G+=4294967296),G}function I(S,C,D,q,M,G){var X=C&q^C&G^q&G;return X<0&&(X+=4294967296),X}function U(S,C){var D=u(S,C,28)^u(C,S,2)^u(C,S,7);return D<0&&(D+=4294967296),D}function H(S,C){var D=l(S,C,28)^l(C,S,2)^l(C,S,7);return D<0&&(D+=4294967296),D}function z(S,C){var D=u(S,C,14)^u(S,C,18)^u(C,S,9);return D<0&&(D+=4294967296),D}function O(S,C){var D=l(S,C,14)^l(S,C,18)^l(C,S,9);return D<0&&(D+=4294967296),D}function L(S,C){var D=u(S,C,1)^u(S,C,8)^d(S,C,7);return D<0&&(D+=4294967296),D}function E(S,C){var D=l(S,C,1)^l(S,C,8)^f(S,C,7);return D<0&&(D+=4294967296),D}function k(S,C){var D=u(S,C,19)^u(C,S,29)^d(S,C,6);return D<0&&(D+=4294967296),D}function N(S,C){var D=l(S,C,19)^l(C,S,29)^f(S,C,6);return D<0&&(D+=4294967296),D}i.inherits(A,w),n.exports=A,A.blockSize=1024,A.outSize=512,A.hmacStrength=192,A.padLength=128,A.prototype._prepareBlock=function(S,C){for(var D=this.W,q=0;q<32;q++)D[q]=S[C+q];for(;q<D.length;q+=2){var M=k(D[q-4],D[q-3]),G=N(D[q-4],D[q-3]),X=D[q-14],re=D[q-13],V=L(D[q-30],D[q-29]),J=E(D[q-30],D[q-29]),W=D[q-32],F=D[q-31];D[q]=g(M,G,X,re,V,J,W,F),D[q+1]=m(M,G,X,re,V,J,W,F)}},A.prototype._update=function(S,C){this._prepareBlock(S,C);var D=this.W,q=this.h[0],M=this.h[1],G=this.h[2],X=this.h[3],re=this.h[4],V=this.h[5],J=this.h[6],W=this.h[7],F=this.h[8],Q=this.h[9],ne=this.h[10],ie=this.h[11],ce=this.h[12],de=this.h[13],le=this.h[14],_e=this.h[15];c(this.k.length===D.length);for(var ue=0;ue<D.length;ue+=2){var pe=le,me=_e,Ce=z(F,Q),fe=O(F,Q),xe=P(F,Q,ne,ie,ce),je=B(F,Q,ne,ie,ce,de),Oe=this.k[ue],Ie=this.k[ue+1],Le=D[ue],He=D[ue+1],Qe=x(pe,me,Ce,fe,xe,je,Oe,Ie,Le,He),Je=v(pe,me,Ce,fe,xe,je,Oe,Ie,Le,He);pe=U(q,M),me=H(q,M),Ce=T(q,M,G,X,re),fe=I(q,M,G,X,re,V);var ct=h(pe,me,Ce,fe),it=y(pe,me,Ce,fe);le=ce,_e=de,ce=ne,de=ie,ne=F,ie=Q,F=h(J,W,Qe,Je),Q=y(W,W,Qe,Je),J=re,W=V,re=G,V=X,G=q,X=M,q=h(Qe,Je,ct,it),M=y(Qe,Je,ct,it)}p(this.h,0,q,M),p(this.h,2,G,X),p(this.h,4,re,V),p(this.h,6,J,W),p(this.h,8,F,Q),p(this.h,10,ne,ie),p(this.h,12,ce,de),p(this.h,14,le,_e)},A.prototype._digest=function(S){return S==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(t,n,a){var i=t("../utils").rotr32;function o(l,d,f){return l&d^~l&f}function c(l,d,f){return l&d^l&f^d&f}function u(l,d,f){return l^d^f}a.ft_1=function(l,d,f,p){return l===0?o(d,f,p):l===1||l===3?u(d,f,p):l===2?c(d,f,p):void 0},a.ch32=o,a.maj32=c,a.p32=u,a.s0_256=function(l){return i(l,2)^i(l,13)^i(l,22)},a.s1_256=function(l){return i(l,6)^i(l,11)^i(l,25)},a.g0_256=function(l){return i(l,7)^i(l,18)^l>>>3},a.g1_256=function(l){return i(l,17)^i(l,19)^l>>>10}},{"../utils":437}],437:[function(t,n,a){var i=t("minimalistic-assert"),o=t("inherits");function c(f,p){return(64512&f.charCodeAt(p))==55296&&!(p<0||p+1>=f.length)&&(64512&f.charCodeAt(p+1))==56320}function u(f){return(f>>>24|f>>>8&65280|f<<8&16711680|(255&f)<<24)>>>0}function l(f){return f.length===1?"0"+f:f}function d(f){return f.length===7?"0"+f:f.length===6?"00"+f:f.length===5?"000"+f:f.length===4?"0000"+f:f.length===3?"00000"+f:f.length===2?"000000"+f:f.length===1?"0000000"+f:f}a.inherits=o,a.toArray=function(f,p){if(Array.isArray(f))return f.slice();if(!f)return[];var h=[];if(typeof f=="string")if(p){if(p==="hex")for((f=f.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(f="0"+f),g=0;g<f.length;g+=2)h.push(parseInt(f[g]+f[g+1],16))}else for(var y=0,g=0;g<f.length;g++){var m=f.charCodeAt(g);m<128?h[y++]=m:m<2048?(h[y++]=m>>6|192,h[y++]=63&m|128):c(f,g)?(m=65536+((1023&m)<<10)+(1023&f.charCodeAt(++g)),h[y++]=m>>18|240,h[y++]=m>>12&63|128,h[y++]=m>>6&63|128,h[y++]=63&m|128):(h[y++]=m>>12|224,h[y++]=m>>6&63|128,h[y++]=63&m|128)}else for(g=0;g<f.length;g++)h[g]=0|f[g];return h},a.toHex=function(f){for(var p="",h=0;h<f.length;h++)p+=l(f[h].toString(16));return p},a.htonl=u,a.toHex32=function(f,p){for(var h="",y=0;y<f.length;y++){var g=f[y];p==="little"&&(g=u(g)),h+=d(g.toString(16))}return h},a.zero2=l,a.zero8=d,a.join32=function(f,p,h,y){var g=h-p;i(g%4==0);for(var m=new Array(g/4),x=0,v=p;x<m.length;x++,v+=4){var w;w=y==="big"?f[v]<<24|f[v+1]<<16|f[v+2]<<8|f[v+3]:f[v+3]<<24|f[v+2]<<16|f[v+1]<<8|f[v],m[x]=w>>>0}return m},a.split32=function(f,p){for(var h=new Array(4*f.length),y=0,g=0;y<f.length;y++,g+=4){var m=f[y];p==="big"?(h[g]=m>>>24,h[g+1]=m>>>16&255,h[g+2]=m>>>8&255,h[g+3]=255&m):(h[g+3]=m>>>24,h[g+2]=m>>>16&255,h[g+1]=m>>>8&255,h[g]=255&m)}return h},a.rotr32=function(f,p){return f>>>p|f<<32-p},a.rotl32=function(f,p){return f<<p|f>>>32-p},a.sum32=function(f,p){return f+p>>>0},a.sum32_3=function(f,p,h){return f+p+h>>>0},a.sum32_4=function(f,p,h,y){return f+p+h+y>>>0},a.sum32_5=function(f,p,h,y,g){return f+p+h+y+g>>>0},a.sum64=function(f,p,h,y){var g=f[p],m=y+f[p+1]>>>0,x=(m<y?1:0)+h+g;f[p]=x>>>0,f[p+1]=m},a.sum64_hi=function(f,p,h,y){return(p+y>>>0<p?1:0)+f+h>>>0},a.sum64_lo=function(f,p,h,y){return p+y>>>0},a.sum64_4_hi=function(f,p,h,y,g,m,x,v){var w=0,_=p;return w+=(_=_+y>>>0)<p?1:0,w+=(_=_+m>>>0)<m?1:0,f+h+g+x+(w+=(_=_+v>>>0)<v?1:0)>>>0},a.sum64_4_lo=function(f,p,h,y,g,m,x,v){return p+y+m+v>>>0},a.sum64_5_hi=function(f,p,h,y,g,m,x,v,w,_){var A=0,P=p;return A+=(P=P+y>>>0)<p?1:0,A+=(P=P+m>>>0)<m?1:0,A+=(P=P+v>>>0)<v?1:0,f+h+g+x+w+(A+=(P=P+_>>>0)<_?1:0)>>>0},a.sum64_5_lo=function(f,p,h,y,g,m,x,v,w,_){return p+y+m+v+_>>>0},a.rotr64_hi=function(f,p,h){return(p<<32-h|f>>>h)>>>0},a.rotr64_lo=function(f,p,h){return(f<<32-h|p>>>h)>>>0},a.shr64_hi=function(f,p,h){return f>>>h},a.shr64_lo=function(f,p,h){return(f<<32-h|p>>>h)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(t,n,a){var i=t("hash.js"),o=t("minimalistic-crypto-utils"),c=t("minimalistic-assert");function u(l){if(!(this instanceof u))return new u(l);this.hash=l.hash,this.predResist=!!l.predResist,this.outLen=this.hash.outSize,this.minEntropy=l.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var d=o.toArray(l.entropy,l.entropyEnc||"hex"),f=o.toArray(l.nonce,l.nonceEnc||"hex"),p=o.toArray(l.pers,l.persEnc||"hex");c(d.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(d,f,p)}n.exports=u,u.prototype._init=function(l,d,f){var p=l.concat(d).concat(f);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(p),this._reseed=1,this.reseedInterval=281474976710656},u.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},u.prototype._update=function(l){var d=this._hmac().update(this.V).update([0]);l&&(d=d.update(l)),this.K=d.digest(),this.V=this._hmac().update(this.V).digest(),l&&(this.K=this._hmac().update(this.V).update([1]).update(l).digest(),this.V=this._hmac().update(this.V).digest())},u.prototype.reseed=function(l,d,f,p){typeof d!="string"&&(p=f,f=d,d=null),l=o.toArray(l,d),f=o.toArray(f,p),c(l.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(l.concat(f||[])),this._reseed=1},u.prototype.generate=function(l,d,f,p){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof d!="string"&&(p=f,f=d,d=null),f&&(f=o.toArray(f,p||"hex"),this._update(f));for(var h=[];h.length<l;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var y=h.slice(0,l);return this._update(f),this._reseed++,o.encode(y,d)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(t,n,a){a.read=function(i,o,c,u,l){var d,f,p=8*l-u-1,h=(1<<p)-1,y=h>>1,g=-7,m=c?l-1:0,x=c?-1:1,v=i[o+m];for(m+=x,d=v&(1<<-g)-1,v>>=-g,g+=p;g>0;d=256*d+i[o+m],m+=x,g-=8);for(f=d&(1<<-g)-1,d>>=-g,g+=u;g>0;f=256*f+i[o+m],m+=x,g-=8);if(d===0)d=1-y;else{if(d===h)return f?NaN:1/0*(v?-1:1);f+=Math.pow(2,u),d-=y}return(v?-1:1)*f*Math.pow(2,d-u)},a.write=function(i,o,c,u,l,d){var f,p,h,y=8*d-l-1,g=(1<<y)-1,m=g>>1,x=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=u?0:d-1,w=u?1:-1,_=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(p=isNaN(o)?1:0,f=g):(f=Math.floor(Math.log(o)/Math.LN2),o*(h=Math.pow(2,-f))<1&&(f--,h*=2),(o+=f+m>=1?x/h:x*Math.pow(2,1-m))*h>=2&&(f++,h/=2),f+m>=g?(p=0,f=g):f+m>=1?(p=(o*h-1)*Math.pow(2,l),f+=m):(p=o*Math.pow(2,m-1)*Math.pow(2,l),f=0));l>=8;i[c+v]=255&p,v+=w,p/=256,l-=8);for(f=f<<l|p,y+=l;y>0;i[c+v]=255&f,v+=w,f/=256,y-=8);i[c+v-w]|=128*_}},{}],440:[function(t,n,a){typeof Object.create=="function"?n.exports=function(i,o){o&&(i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(i,o){if(o){i.super_=o;var c=function(){};c.prototype=o.prototype,i.prototype=new c,i.prototype.constructor=i}}},{}],441:[function(t,n,a){(function(i,o,c,u,l,d,f,p){(function(){(function(h){typeof a=="object"&&n!==void 0?n.exports=h():(typeof window<"u"?window:o!==void 0?o:typeof self<"u"?self:this).JSZip=h()})((function(){return(function h(y,g,m){function x(_,A){if(!g[_]){if(!y[_]){var P=typeof t=="function"&&t;if(!A&&P)return P(_,!0);if(v)return v(_,!0);var B=new Error("Cannot find module '"+_+"'");throw B.code="MODULE_NOT_FOUND",B}var T=g[_]={exports:{}};y[_][0].call(T.exports,(function(I){return x(y[_][1][I]||I)}),T,T.exports,h,y,g,m)}return g[_].exports}for(var v=typeof t=="function"&&t,w=0;w<m.length;w++)x(m[w]);return x})({1:[function(h,y,g){var m=h("./utils"),x=h("./support"),v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g.encode=function(w){for(var _,A,P,B,T,I,U,H=[],z=0,O=w.length,L=O,E=m.getTypeOf(w)!=="string";z<w.length;)L=O-z,P=E?(_=w[z++],A=z<O?w[z++]:0,z<O?w[z++]:0):(_=w.charCodeAt(z++),A=z<O?w.charCodeAt(z++):0,z<O?w.charCodeAt(z++):0),B=_>>2,T=(3&_)<<4|A>>4,I=1<L?(15&A)<<2|P>>6:64,U=2<L?63&P:64,H.push(v.charAt(B)+v.charAt(T)+v.charAt(I)+v.charAt(U));return H.join("")},g.decode=function(w){var _,A,P,B,T,I,U=0,H=0,z="data:";if(w.substr(0,z.length)===z)throw new Error("Invalid base64 input, it looks like a data url.");var O,L=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===v.charAt(64)&&L--,w.charAt(w.length-2)===v.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(O=x.uint8array?new Uint8Array(0|L):new Array(0|L);U<w.length;)_=v.indexOf(w.charAt(U++))<<2|(B=v.indexOf(w.charAt(U++)))>>4,A=(15&B)<<4|(T=v.indexOf(w.charAt(U++)))>>2,P=(3&T)<<6|(I=v.indexOf(w.charAt(U++))),O[H++]=_,T!==64&&(O[H++]=A),I!==64&&(O[H++]=P);return O}},{"./support":30,"./utils":32}],2:[function(h,y,g){var m=h("./external"),x=h("./stream/DataWorker"),v=h("./stream/Crc32Probe"),w=h("./stream/DataLengthProbe");function _(A,P,B,T,I){this.compressedSize=A,this.uncompressedSize=P,this.crc32=B,this.compression=T,this.compressedContent=I}_.prototype={getContentWorker:function(){var A=new x(m.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),P=this;return A.on("end",(function(){if(this.streamInfo.data_length!==P.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),A},getCompressedWorker:function(){return new x(m.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},_.createWorkerFrom=function(A,P,B){return A.pipe(new v).pipe(new w("uncompressedSize")).pipe(P.compressWorker(B)).pipe(new w("compressedSize")).withStreamInfo("compression",P)},y.exports=_},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,y,g){var m=h("./stream/GenericWorker");g.STORE={magic:"\0\0",compressWorker:function(){return new m("STORE compression")},uncompressWorker:function(){return new m("STORE decompression")}},g.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,y,g){var m=h("./utils"),x=(function(){for(var v,w=[],_=0;_<256;_++){v=_;for(var A=0;A<8;A++)v=1&v?3988292384^v>>>1:v>>>1;w[_]=v}return w})();y.exports=function(v,w){return v!==void 0&&v.length?m.getTypeOf(v)!=="string"?(function(_,A,P,B){var T=x,I=0+P;_^=-1;for(var U=0;U<I;U++)_=_>>>8^T[255&(_^A[U])];return-1^_})(0|w,v,v.length):(function(_,A,P,B){var T=x,I=0+P;_^=-1;for(var U=0;U<I;U++)_=_>>>8^T[255&(_^A.charCodeAt(U))];return-1^_})(0|w,v,v.length):0}},{"./utils":32}],5:[function(h,y,g){g.base64=!1,g.binary=!1,g.dir=!1,g.createFolders=!0,g.date=null,g.compression=null,g.compressionOptions=null,g.comment=null,g.unixPermissions=null,g.dosPermissions=null},{}],6:[function(h,y,g){var m;m=typeof Promise<"u"?Promise:h("lie"),y.exports={Promise:m}},{lie:37}],7:[function(h,y,g){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=h("pako"),v=h("./utils"),w=h("./stream/GenericWorker"),_=m?"uint8array":"array";function A(P,B){w.call(this,"FlateWorker/"+P),this._pako=null,this._pakoAction=P,this._pakoOptions=B,this.meta={}}g.magic="\b\0",v.inherits(A,w),A.prototype.processChunk=function(P){this.meta=P.meta,this._pako===null&&this._createPako(),this._pako.push(v.transformTo(_,P.data),!1)},A.prototype.flush=function(){w.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},A.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},A.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var P=this;this._pako.onData=function(B){P.push({data:B,meta:P.meta})}},g.compressWorker=function(P){return new A("Deflate",P)},g.uncompressWorker=function(){return new A("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,y,g){function m(T,I){var U,H="";for(U=0;U<I;U++)H+=String.fromCharCode(255&T),T>>>=8;return H}function x(T,I,U,H,z,O){var L,E,k=T.file,N=T.compression,S=O!==_.utf8encode,C=v.transformTo("string",O(k.name)),D=v.transformTo("string",_.utf8encode(k.name)),q=k.comment,M=v.transformTo("string",O(q)),G=v.transformTo("string",_.utf8encode(q)),X=D.length!==k.name.length,re=G.length!==q.length,V="",J="",W="",F=k.dir,Q=k.date,ne={crc32:0,compressedSize:0,uncompressedSize:0};I&&!U||(ne.crc32=T.crc32,ne.compressedSize=T.compressedSize,ne.uncompressedSize=T.uncompressedSize);var ie=0;I&&(ie|=8),S||!X&&!re||(ie|=2048);var ce=0,de=0;F&&(ce|=16),z==="UNIX"?(de=798,ce|=(function(_e,ue){var pe=_e;return _e||(pe=ue?16893:33204),(65535&pe)<<16})(k.unixPermissions,F)):(de=20,ce|=(function(_e){return 63&(_e||0)})(k.dosPermissions)),L=Q.getUTCHours(),L<<=6,L|=Q.getUTCMinutes(),L<<=5,L|=Q.getUTCSeconds()/2,E=Q.getUTCFullYear()-1980,E<<=4,E|=Q.getUTCMonth()+1,E<<=5,E|=Q.getUTCDate(),X&&(J=m(1,1)+m(A(C),4)+D,V+="up"+m(J.length,2)+J),re&&(W=m(1,1)+m(A(M),4)+G,V+="uc"+m(W.length,2)+W);var le="";return le+=`
\0`,le+=m(ie,2),le+=N.magic,le+=m(L,2),le+=m(E,2),le+=m(ne.crc32,4),le+=m(ne.compressedSize,4),le+=m(ne.uncompressedSize,4),le+=m(C.length,2),le+=m(V.length,2),{fileRecord:P.LOCAL_FILE_HEADER+le+C+V,dirRecord:P.CENTRAL_FILE_HEADER+m(de,2)+le+m(M.length,2)+"\0\0\0\0"+m(ce,4)+m(H,4)+C+V+M}}var v=h("../utils"),w=h("../stream/GenericWorker"),_=h("../utf8"),A=h("../crc32"),P=h("../signature");function B(T,I,U,H){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=U,this.encodeFileName=H,this.streamFiles=T,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}v.inherits(B,w),B.prototype.push=function(T){var I=T.meta.percent||0,U=this.entriesCount,H=this._sources.length;this.accumulate?this.contentBuffer.push(T):(this.bytesWritten+=T.data.length,w.prototype.push.call(this,{data:T.data,meta:{currentFile:this.currentFile,percent:U?(I+100*(U-H-1))/U:100}}))},B.prototype.openedSource=function(T){this.currentSourceOffset=this.bytesWritten,this.currentFile=T.file.name;var I=this.streamFiles&&!T.file.dir;if(I){var U=x(T,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:U.fileRecord,meta:{percent:0}})}else this.accumulate=!0},B.prototype.closedSource=function(T){this.accumulate=!1;var I=this.streamFiles&&!T.file.dir,U=x(T,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(U.dirRecord),I)this.push({data:(function(H){return P.DATA_DESCRIPTOR+m(H.crc32,4)+m(H.compressedSize,4)+m(H.uncompressedSize,4)})(T),meta:{percent:100}});else for(this.push({data:U.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},B.prototype.flush=function(){for(var T=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var U=this.bytesWritten-T,H=(function(z,O,L,E,k){var N=v.transformTo("string",k(E));return P.CENTRAL_DIRECTORY_END+"\0\0\0\0"+m(z,2)+m(z,2)+m(O,4)+m(L,4)+m(N.length,2)+N})(this.dirRecords.length,U,T,this.zipComment,this.encodeFileName);this.push({data:H,meta:{percent:100}})},B.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},B.prototype.registerPrevious=function(T){this._sources.push(T);var I=this;return T.on("data",(function(U){I.processChunk(U)})),T.on("end",(function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()})),T.on("error",(function(U){I.error(U)})),this},B.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},B.prototype.error=function(T){var I=this._sources;if(!w.prototype.error.call(this,T))return!1;for(var U=0;U<I.length;U++)try{I[U].error(T)}catch{}return!0},B.prototype.lock=function(){w.prototype.lock.call(this);for(var T=this._sources,I=0;I<T.length;I++)T[I].lock()},y.exports=B},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,y,g){var m=h("../compressions"),x=h("./ZipFileWorker");g.generateWorker=function(v,w,_){var A=new x(w.streamFiles,_,w.platform,w.encodeFileName),P=0;try{v.forEach((function(B,T){P++;var I=(function(O,L){var E=O||L,k=m[E];if(!k)throw new Error(E+" is not a valid compression method !");return k})(T.options.compression,w.compression),U=T.options.compressionOptions||w.compressionOptions||{},H=T.dir,z=T.date;T._compressWorker(I,U).withStreamInfo("file",{name:B,dir:H,date:z,comment:T.comment||"",unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions}).pipe(A)})),A.entriesCount=P}catch(B){A.error(B)}return A}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,y,g){function m(){if(!(this instanceof m))return new m;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new m;for(var v in this)typeof this[v]!="function"&&(x[v]=this[v]);return x}}(m.prototype=h("./object")).loadAsync=h("./load"),m.support=h("./support"),m.defaults=h("./defaults"),m.version="3.10.1",m.loadAsync=function(x,v){return new m().loadAsync(x,v)},m.external=h("./external"),y.exports=m},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,y,g){var m=h("./utils"),x=h("./external"),v=h("./utf8"),w=h("./zipEntries"),_=h("./stream/Crc32Probe"),A=h("./nodejsUtils");function P(B){return new x.Promise((function(T,I){var U=B.decompressed.getContentWorker().pipe(new _);U.on("error",(function(H){I(H)})).on("end",(function(){U.streamInfo.crc32!==B.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):T()})).resume()}))}y.exports=function(B,T){var I=this;return T=m.extend(T||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:v.utf8decode}),A.isNode&&A.isStream(B)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):m.prepareContent("the loaded zip file",B,!0,T.optimizedBinaryString,T.base64).then((function(U){var H=new w(T);return H.load(U),H})).then((function(U){var H=[x.Promise.resolve(U)],z=U.files;if(T.checkCRC32)for(var O=0;O<z.length;O++)H.push(P(z[O]));return x.Promise.all(H)})).then((function(U){for(var H=U.shift(),z=H.files,O=0;O<z.length;O++){var L=z[O],E=L.fileNameStr,k=m.resolve(L.fileNameStr);I.file(k,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:T.createFolders}),L.dir||(I.file(k).unsafeOriginalName=E)}return H.zipComment.length&&(I.comment=H.zipComment),I}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,y,g){var m=h("../utils"),x=h("../stream/GenericWorker");function v(w,_){x.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(_)}m.inherits(v,x),v.prototype._bindStream=function(w){var _=this;(this._stream=w).pause(),w.on("data",(function(A){_.push({data:A,meta:{percent:0}})})).on("error",(function(A){_.isPaused?this.generatedError=A:_.error(A)})).on("end",(function(){_.isPaused?_._upstreamEnded=!0:_.end()}))},v.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},v.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},y.exports=v},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,y,g){var m=h("readable-stream").Readable;function x(v,w,_){m.call(this,w),this._helper=v;var A=this;v.on("data",(function(P,B){A.push(P)||A._helper.pause(),_&&_(B)})).on("error",(function(P){A.emit("error",P)})).on("end",(function(){A.push(null)}))}h("../utils").inherits(x,m),x.prototype._read=function(){this._helper.resume()},y.exports=x},{"../utils":32,"readable-stream":16}],14:[function(h,y,g){y.exports={isNode:c!==void 0,newBufferFrom:function(m,x){if(c.from&&c.from!==Uint8Array.from)return c.from(m,x);if(typeof m=="number")throw new Error('The "data" argument must not be a number');return new c(m,x)},allocBuffer:function(m){if(c.alloc)return c.alloc(m);var x=new c(m);return x.fill(0),x},isBuffer:function(m){return c.isBuffer(m)},isStream:function(m){return m&&typeof m.on=="function"&&typeof m.pause=="function"&&typeof m.resume=="function"}}},{}],15:[function(h,y,g){function m(k,N,S){var C,D=v.getTypeOf(N),q=v.extend(S||{},A);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(k=z(k)),q.createFolders&&(C=H(k))&&O.call(this,C,!0);var M=D==="string"&&q.binary===!1&&q.base64===!1;S&&S.binary!==void 0||(q.binary=!M),(N instanceof P&&N.uncompressedSize===0||q.dir||!N||N.length===0)&&(q.base64=!1,q.binary=!0,N="",q.compression="STORE",D="string");var G;G=N instanceof P||N instanceof w?N:I.isNode&&I.isStream(N)?new U(k,N):v.prepareContent(k,N,q.binary,q.optimizedBinaryString,q.base64);var X=new B(k,G,q);this.files[k]=X}var x=h("./utf8"),v=h("./utils"),w=h("./stream/GenericWorker"),_=h("./stream/StreamHelper"),A=h("./defaults"),P=h("./compressedObject"),B=h("./zipObject"),T=h("./generate"),I=h("./nodejsUtils"),U=h("./nodejs/NodejsStreamInputAdapter"),H=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var N=k.lastIndexOf("/");return 0<N?k.substring(0,N):""},z=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},O=function(k,N){return N=N!==void 0?N:A.createFolders,k=z(k),this.files[k]||m.call(this,k,null,{dir:!0,createFolders:N}),this.files[k]};function L(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var N,S,C;for(N in this.files)C=this.files[N],(S=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&k(S,C)},filter:function(k){var N=[];return this.forEach((function(S,C){k(S,C)&&N.push(C)})),N},file:function(k,N,S){if(arguments.length!==1)return k=this.root+k,m.call(this,k,N,S),this;if(L(k)){var C=k;return this.filter((function(q,M){return!M.dir&&C.test(q)}))}var D=this.files[this.root+k];return D&&!D.dir?D:null},folder:function(k){if(!k)return this;if(L(k))return this.filter((function(D,q){return q.dir&&k.test(D)}));var N=this.root+k,S=O.call(this,N),C=this.clone();return C.root=S.name,C},remove:function(k){k=this.root+k;var N=this.files[k];if(N||(k.slice(-1)!=="/"&&(k+="/"),N=this.files[k]),N&&!N.dir)delete this.files[k];else for(var S=this.filter((function(D,q){return q.name.slice(0,k.length)===k})),C=0;C<S.length;C++)delete this.files[S[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var N,S={};try{if((S=v.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");v.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var C=S.comment||this.comment||"";N=T.generateWorker(this,S,C)}catch(D){(N=new w("error")).error(D)}return new _(N,S.type||"string",S.mimeType)},generateAsync:function(k,N){return this.generateInternalStream(k).accumulate(N)},generateNodeStream:function(k,N){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(N)}};y.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,y,g){y.exports=h("stream")},{stream:void 0}],17:[function(h,y,g){var m=h("./DataReader");function x(v){m.call(this,v);for(var w=0;w<this.data.length;w++)v[w]=255&v[w]}h("../utils").inherits(x,m),x.prototype.byteAt=function(v){return this.data[this.zero+v]},x.prototype.lastIndexOfSignature=function(v){for(var w=v.charCodeAt(0),_=v.charCodeAt(1),A=v.charCodeAt(2),P=v.charCodeAt(3),B=this.length-4;0<=B;--B)if(this.data[B]===w&&this.data[B+1]===_&&this.data[B+2]===A&&this.data[B+3]===P)return B-this.zero;return-1},x.prototype.readAndCheckSignature=function(v){var w=v.charCodeAt(0),_=v.charCodeAt(1),A=v.charCodeAt(2),P=v.charCodeAt(3),B=this.readData(4);return w===B[0]&&_===B[1]&&A===B[2]&&P===B[3]},x.prototype.readData=function(v){if(this.checkOffset(v),v===0)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,w},y.exports=x},{"../utils":32,"./DataReader":18}],18:[function(h,y,g){var m=h("../utils");function x(v){this.data=v,this.length=v.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(v){this.checkIndex(this.index+v)},checkIndex:function(v){if(this.length<this.zero+v||v<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+v+"). Corrupted zip ?")},setIndex:function(v){this.checkIndex(v),this.index=v},skip:function(v){this.setIndex(this.index+v)},byteAt:function(){},readInt:function(v){var w,_=0;for(this.checkOffset(v),w=this.index+v-1;w>=this.index;w--)_=(_<<8)+this.byteAt(w);return this.index+=v,_},readString:function(v){return m.transformTo("string",this.readData(v))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var v=this.readInt(4);return new Date(Date.UTC(1980+(v>>25&127),(v>>21&15)-1,v>>16&31,v>>11&31,v>>5&63,(31&v)<<1))}},y.exports=x},{"../utils":32}],19:[function(h,y,g){var m=h("./Uint8ArrayReader");function x(v){m.call(this,v)}h("../utils").inherits(x,m),x.prototype.readData=function(v){this.checkOffset(v);var w=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,w},y.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,y,g){var m=h("./DataReader");function x(v){m.call(this,v)}h("../utils").inherits(x,m),x.prototype.byteAt=function(v){return this.data.charCodeAt(this.zero+v)},x.prototype.lastIndexOfSignature=function(v){return this.data.lastIndexOf(v)-this.zero},x.prototype.readAndCheckSignature=function(v){return v===this.readData(4)},x.prototype.readData=function(v){this.checkOffset(v);var w=this.data.slice(this.zero+this.index,this.zero+this.index+v);return this.index+=v,w},y.exports=x},{"../utils":32,"./DataReader":18}],21:[function(h,y,g){var m=h("./ArrayReader");function x(v){m.call(this,v)}h("../utils").inherits(x,m),x.prototype.readData=function(v){if(this.checkOffset(v),v===0)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+v);return this.index+=v,w},y.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(h,y,g){var m=h("../utils"),x=h("../support"),v=h("./ArrayReader"),w=h("./StringReader"),_=h("./NodeBufferReader"),A=h("./Uint8ArrayReader");y.exports=function(P){var B=m.getTypeOf(P);return m.checkSupport(B),B!=="string"||x.uint8array?B==="nodebuffer"?new _(P):x.uint8array?new A(m.transformTo("uint8array",P)):new v(m.transformTo("array",P)):new w(P)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,y,g){g.LOCAL_FILE_HEADER="PK",g.CENTRAL_FILE_HEADER="PK",g.CENTRAL_DIRECTORY_END="PK",g.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",g.ZIP64_CENTRAL_DIRECTORY_END="PK",g.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,y,g){var m=h("./GenericWorker"),x=h("../utils");function v(w){m.call(this,"ConvertWorker to "+w),this.destType=w}x.inherits(v,m),v.prototype.processChunk=function(w){this.push({data:x.transformTo(this.destType,w.data),meta:w.meta})},y.exports=v},{"../utils":32,"./GenericWorker":28}],25:[function(h,y,g){var m=h("./GenericWorker"),x=h("../crc32");function v(){m.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(v,m),v.prototype.processChunk=function(w){this.streamInfo.crc32=x(w.data,this.streamInfo.crc32||0),this.push(w)},y.exports=v},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,y,g){var m=h("../utils"),x=h("./GenericWorker");function v(w){x.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}m.inherits(v,x),v.prototype.processChunk=function(w){if(w){var _=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=_+w.data.length}x.prototype.processChunk.call(this,w)},y.exports=v},{"../utils":32,"./GenericWorker":28}],27:[function(h,y,g){var m=h("../utils"),x=h("./GenericWorker");function v(w){x.call(this,"DataWorker");var _=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then((function(A){_.dataIsReady=!0,_.data=A,_.max=A&&A.length||0,_.type=m.getTypeOf(A),_.isPaused||_._tickAndRepeat()}),(function(A){_.error(A)}))}m.inherits(v,x),v.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},v.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,m.delay(this._tickAndRepeat,[],this)),!0)},v.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(m.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},v.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,_=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,_);break;case"uint8array":w=this.data.subarray(this.index,_);break;case"array":case"nodebuffer":w=this.data.slice(this.index,_)}return this.index=_,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},y.exports=v},{"../utils":32,"./GenericWorker":28}],28:[function(h,y,g){function m(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}m.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,v){return this._listeners[x].push(v),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,v){if(this._listeners[x])for(var w=0;w<this._listeners[x].length;w++)this._listeners[x][w].call(this,v)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var v=this;return x.on("data",(function(w){v.processChunk(w)})),x.on("end",(function(){v.end()})),x.on("error",(function(w){v.error(w)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,v){return this.extraStreamInfo[x]=v,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},y.exports=m},{}],29:[function(h,y,g){var m=h("../utils"),x=h("./ConvertWorker"),v=h("./GenericWorker"),w=h("../base64"),_=h("../support"),A=h("../external"),P=null;if(_.nodestream)try{P=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function B(T,I,U){var H=I;switch(I){case"blob":case"arraybuffer":H="uint8array";break;case"base64":H="string"}try{this._internalType=H,this._outputType=I,this._mimeType=U,m.checkSupport(H),this._worker=T.pipe(new x(H)),T.lock()}catch(z){this._worker=new v("error"),this._worker.error(z)}}B.prototype={accumulate:function(T){return(function(I,U){return new A.Promise((function(H,z){var O=[],L=I._internalType,E=I._outputType,k=I._mimeType;I.on("data",(function(N,S){O.push(N),U&&U(S)})).on("error",(function(N){O=[],z(N)})).on("end",(function(){try{var N=(function(S,C,D){switch(S){case"blob":return m.newBlob(m.transformTo("arraybuffer",C),D);case"base64":return w.encode(C);default:return m.transformTo(S,C)}})(E,(function(S,C){var D,q=0,M=null,G=0;for(D=0;D<C.length;D++)G+=C[D].length;switch(S){case"string":return C.join("");case"array":return Array.prototype.concat.apply([],C);case"uint8array":for(M=new Uint8Array(G),D=0;D<C.length;D++)M.set(C[D],q),q+=C[D].length;return M;case"nodebuffer":return c.concat(C);default:throw new Error("concat : unsupported type '"+S+"'")}})(L,O),k);H(N)}catch(S){z(S)}O=[]})).resume()}))})(this,T)},on:function(T,I){var U=this;return T==="data"?this._worker.on(T,(function(H){I.call(U,H.data,H.meta)})):this._worker.on(T,(function(){m.delay(I,arguments,U)})),this},resume:function(){return m.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(T){if(m.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new P(this,{objectMode:this._outputType!=="nodebuffer"},T)}},y.exports=B},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,y,g){if(g.base64=!0,g.array=!0,g.string=!0,g.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",g.nodebuffer=c!==void 0,g.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")g.blob=!1;else{var m=new ArrayBuffer(0);try{g.blob=new Blob([m],{type:"application/zip"}).size===0}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(m),g.blob=x.getBlob("application/zip").size===0}catch{g.blob=!1}}}try{g.nodestream=!!h("readable-stream").Readable}catch{g.nodestream=!1}},{"readable-stream":16}],31:[function(h,y,g){for(var m=h("./utils"),x=h("./support"),v=h("./nodejsUtils"),w=h("./stream/GenericWorker"),_=new Array(256),A=0;A<256;A++)_[A]=252<=A?6:248<=A?5:240<=A?4:224<=A?3:192<=A?2:1;function P(){w.call(this,"utf-8 decode"),this.leftOver=null}function B(){w.call(this,"utf-8 encode")}_[254]=_[254]=1,g.utf8encode=function(T){return x.nodebuffer?v.newBufferFrom(T,"utf-8"):(function(I){var U,H,z,O,L,E=I.length,k=0;for(O=0;O<E;O++)(64512&(H=I.charCodeAt(O)))==55296&&O+1<E&&(64512&(z=I.charCodeAt(O+1)))==56320&&(H=65536+(H-55296<<10)+(z-56320),O++),k+=H<128?1:H<2048?2:H<65536?3:4;for(U=x.uint8array?new Uint8Array(k):new Array(k),O=L=0;L<k;O++)(64512&(H=I.charCodeAt(O)))==55296&&O+1<E&&(64512&(z=I.charCodeAt(O+1)))==56320&&(H=65536+(H-55296<<10)+(z-56320),O++),H<128?U[L++]=H:(H<2048?U[L++]=192|H>>>6:(H<65536?U[L++]=224|H>>>12:(U[L++]=240|H>>>18,U[L++]=128|H>>>12&63),U[L++]=128|H>>>6&63),U[L++]=128|63&H);return U})(T)},g.utf8decode=function(T){return x.nodebuffer?m.transformTo("nodebuffer",T).toString("utf-8"):(function(I){var U,H,z,O,L=I.length,E=new Array(2*L);for(U=H=0;U<L;)if((z=I[U++])<128)E[H++]=z;else if(4<(O=_[z]))E[H++]=65533,U+=O-1;else{for(z&=O===2?31:O===3?15:7;1<O&&U<L;)z=z<<6|63&I[U++],O--;1<O?E[H++]=65533:z<65536?E[H++]=z:(z-=65536,E[H++]=55296|z>>10&1023,E[H++]=56320|1023&z)}return E.length!==H&&(E.subarray?E=E.subarray(0,H):E.length=H),m.applyFromCharCode(E)})(T=m.transformTo(x.uint8array?"uint8array":"array",T))},m.inherits(P,w),P.prototype.processChunk=function(T){var I=m.transformTo(x.uint8array?"uint8array":"array",T.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var U=I;(I=new Uint8Array(U.length+this.leftOver.length)).set(this.leftOver,0),I.set(U,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var H=(function(O,L){var E;for((L=L||O.length)>O.length&&(L=O.length),E=L-1;0<=E&&(192&O[E])==128;)E--;return E<0||E===0?L:E+_[O[E]]>L?E:L})(I),z=I;H!==I.length&&(x.uint8array?(z=I.subarray(0,H),this.leftOver=I.subarray(H,I.length)):(z=I.slice(0,H),this.leftOver=I.slice(H,I.length))),this.push({data:g.utf8decode(z),meta:T.meta})},P.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:g.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},g.Utf8DecodeWorker=P,m.inherits(B,w),B.prototype.processChunk=function(T){this.push({data:g.utf8encode(T.data),meta:T.meta})},g.Utf8EncodeWorker=B},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,y,g){var m=h("./support"),x=h("./base64"),v=h("./nodejsUtils"),w=h("./external");function _(U){return U}function A(U,H){for(var z=0;z<U.length;++z)H[z]=255&U.charCodeAt(z);return H}h("setimmediate"),g.newBlob=function(U,H){g.checkSupport("blob");try{return new Blob([U],{type:H})}catch{try{var z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return z.append(U),z.getBlob(H)}catch{throw new Error("Bug : can't construct the Blob.")}}};var P={stringifyByChunk:function(U,H,z){var O=[],L=0,E=U.length;if(E<=z)return String.fromCharCode.apply(null,U);for(;L<E;)H==="array"||H==="nodebuffer"?O.push(String.fromCharCode.apply(null,U.slice(L,Math.min(L+z,E)))):O.push(String.fromCharCode.apply(null,U.subarray(L,Math.min(L+z,E)))),L+=z;return O.join("")},stringifyByChar:function(U){for(var H="",z=0;z<U.length;z++)H+=String.fromCharCode(U[z]);return H},applyCanBeUsed:{uint8array:(function(){try{return m.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return m.nodebuffer&&String.fromCharCode.apply(null,v.allocBuffer(1)).length===1}catch{return!1}})()}};function B(U){var H=65536,z=g.getTypeOf(U),O=!0;if(z==="uint8array"?O=P.applyCanBeUsed.uint8array:z==="nodebuffer"&&(O=P.applyCanBeUsed.nodebuffer),O)for(;1<H;)try{return P.stringifyByChunk(U,z,H)}catch{H=Math.floor(H/2)}return P.stringifyByChar(U)}function T(U,H){for(var z=0;z<U.length;z++)H[z]=U[z];return H}g.applyFromCharCode=B;var I={};I.string={string:_,array:function(U){return A(U,new Array(U.length))},arraybuffer:function(U){return I.string.uint8array(U).buffer},uint8array:function(U){return A(U,new Uint8Array(U.length))},nodebuffer:function(U){return A(U,v.allocBuffer(U.length))}},I.array={string:B,array:_,arraybuffer:function(U){return new Uint8Array(U).buffer},uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return v.newBufferFrom(U)}},I.arraybuffer={string:function(U){return B(new Uint8Array(U))},array:function(U){return T(new Uint8Array(U),new Array(U.byteLength))},arraybuffer:_,uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return v.newBufferFrom(new Uint8Array(U))}},I.uint8array={string:B,array:function(U){return T(U,new Array(U.length))},arraybuffer:function(U){return U.buffer},uint8array:_,nodebuffer:function(U){return v.newBufferFrom(U)}},I.nodebuffer={string:B,array:function(U){return T(U,new Array(U.length))},arraybuffer:function(U){return I.nodebuffer.uint8array(U).buffer},uint8array:function(U){return T(U,new Uint8Array(U.length))},nodebuffer:_},g.transformTo=function(U,H){if(H=H||"",!U)return H;g.checkSupport(U);var z=g.getTypeOf(H);return I[z][U](H)},g.resolve=function(U){for(var H=U.split("/"),z=[],O=0;O<H.length;O++){var L=H[O];L==="."||L===""&&O!==0&&O!==H.length-1||(L===".."?z.pop():z.push(L))}return z.join("/")},g.getTypeOf=function(U){return typeof U=="string"?"string":Object.prototype.toString.call(U)==="[object Array]"?"array":m.nodebuffer&&v.isBuffer(U)?"nodebuffer":m.uint8array&&U instanceof Uint8Array?"uint8array":m.arraybuffer&&U instanceof ArrayBuffer?"arraybuffer":void 0},g.checkSupport=function(U){if(!m[U.toLowerCase()])throw new Error(U+" is not supported by this platform")},g.MAX_VALUE_16BITS=65535,g.MAX_VALUE_32BITS=-1,g.pretty=function(U){var H,z,O="";for(z=0;z<(U||"").length;z++)O+="\\x"+((H=U.charCodeAt(z))<16?"0":"")+H.toString(16).toUpperCase();return O},g.delay=function(U,H,z){p((function(){U.apply(z||null,H||[])}))},g.inherits=function(U,H){function z(){}z.prototype=H.prototype,U.prototype=new z},g.extend=function(){var U,H,z={};for(U=0;U<arguments.length;U++)for(H in arguments[U])Object.prototype.hasOwnProperty.call(arguments[U],H)&&z[H]===void 0&&(z[H]=arguments[U][H]);return z},g.prepareContent=function(U,H,z,O,L){return w.Promise.resolve(H).then((function(E){return m.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new w.Promise((function(k,N){var S=new FileReader;S.onload=function(C){k(C.target.result)},S.onerror=function(C){N(C.target.error)},S.readAsArrayBuffer(E)})):E})).then((function(E){var k=g.getTypeOf(E);return k?(k==="arraybuffer"?E=g.transformTo("uint8array",E):k==="string"&&(L?E=x.decode(E):z&&O!==!0&&(E=(function(N){return A(N,m.uint8array?new Uint8Array(N.length):new Array(N.length))})(E))),E):w.Promise.reject(new Error("Can't read the data of '"+U+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,y,g){var m=h("./reader/readerFor"),x=h("./utils"),v=h("./signature"),w=h("./zipEntry"),_=h("./support");function A(P){this.files=[],this.loadOptions=P}A.prototype={checkSignature:function(P){if(!this.reader.readAndCheckSignature(P)){this.reader.index-=4;var B=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(B)+", expected "+x.pretty(P)+")")}},isSignature:function(P,B){var T=this.reader.index;this.reader.setIndex(P);var I=this.reader.readString(4)===B;return this.reader.setIndex(T),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var P=this.reader.readData(this.zipCommentLength),B=_.uint8array?"uint8array":"array",T=x.transformTo(B,P);this.zipComment=this.loadOptions.decodeFileName(T)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var P,B,T,I=this.zip64EndOfCentralSize-44;0<I;)P=this.reader.readInt(2),B=this.reader.readInt(4),T=this.reader.readData(B),this.zip64ExtensibleData[P]={id:P,length:B,value:T}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var P,B;for(P=0;P<this.files.length;P++)B=this.files[P],this.reader.setIndex(B.localHeaderOffset),this.checkSignature(v.LOCAL_FILE_HEADER),B.readLocalPart(this.reader),B.handleUTF8(),B.processAttributes()},readCentralDir:function(){var P;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(v.CENTRAL_FILE_HEADER);)(P=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(P);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var P=this.reader.lastIndexOfSignature(v.CENTRAL_DIRECTORY_END);if(P<0)throw this.isSignature(0,v.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(P);var B=P;if(this.checkSignature(v.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(P=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(P),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,v.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(v.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var T=this.centralDirOffset+this.centralDirSize;this.zip64&&(T+=20,T+=12+this.zip64EndOfCentralSize);var I=B-T;if(0<I)this.isSignature(B,v.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(P){this.reader=m(P)},load:function(P){this.prepareReader(P),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},y.exports=A},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,y,g){var m=h("./reader/readerFor"),x=h("./utils"),v=h("./compressedObject"),w=h("./crc32"),_=h("./utf8"),A=h("./compressions"),P=h("./support");function B(T,I){this.options=T,this.loadOptions=I}B.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(T){var I,U;if(T.skip(22),this.fileNameLength=T.readInt(2),U=T.readInt(2),this.fileName=T.readData(this.fileNameLength),T.skip(U),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=(function(H){for(var z in A)if(Object.prototype.hasOwnProperty.call(A,z)&&A[z].magic===H)return A[z];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new v(this.compressedSize,this.uncompressedSize,this.crc32,I,T.readData(this.compressedSize))},readCentralPart:function(T){this.versionMadeBy=T.readInt(2),T.skip(2),this.bitFlag=T.readInt(2),this.compressionMethod=T.readString(2),this.date=T.readDate(),this.crc32=T.readInt(4),this.compressedSize=T.readInt(4),this.uncompressedSize=T.readInt(4);var I=T.readInt(2);if(this.extraFieldsLength=T.readInt(2),this.fileCommentLength=T.readInt(2),this.diskNumberStart=T.readInt(2),this.internalFileAttributes=T.readInt(2),this.externalFileAttributes=T.readInt(4),this.localHeaderOffset=T.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");T.skip(I),this.readExtraFields(T),this.parseZIP64ExtraField(T),this.fileComment=T.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var T=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),T==0&&(this.dosPermissions=63&this.externalFileAttributes),T==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var T=m(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=T.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=T.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=T.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=T.readInt(4))}},readExtraFields:function(T){var I,U,H,z=T.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});T.index+4<z;)I=T.readInt(2),U=T.readInt(2),H=T.readData(U),this.extraFields[I]={id:I,length:U,value:H};T.setIndex(z)},handleUTF8:function(){var T=P.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=_.utf8decode(this.fileName),this.fileCommentStr=_.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var U=x.transformTo(T,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(U)}var H=this.findExtraFieldUnicodeComment();if(H!==null)this.fileCommentStr=H;else{var z=x.transformTo(T,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(z)}}},findExtraFieldUnicodePath:function(){var T=this.extraFields[28789];if(T){var I=m(T.value);return I.readInt(1)!==1||w(this.fileName)!==I.readInt(4)?null:_.utf8decode(I.readData(T.length-5))}return null},findExtraFieldUnicodeComment:function(){var T=this.extraFields[25461];if(T){var I=m(T.value);return I.readInt(1)!==1||w(this.fileComment)!==I.readInt(4)?null:_.utf8decode(I.readData(T.length-5))}return null}},y.exports=B},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,y,g){function m(I,U,H){this.name=I,this.dir=H.dir,this.date=H.date,this.comment=H.comment,this.unixPermissions=H.unixPermissions,this.dosPermissions=H.dosPermissions,this._data=U,this._dataBinary=H.binary,this.options={compression:H.compression,compressionOptions:H.compressionOptions}}var x=h("./stream/StreamHelper"),v=h("./stream/DataWorker"),w=h("./utf8"),_=h("./compressedObject"),A=h("./stream/GenericWorker");m.prototype={internalStream:function(I){var U=null,H="string";try{if(!I)throw new Error("No output type specified.");var z=(H=I.toLowerCase())==="string"||H==="text";H!=="binarystring"&&H!=="text"||(H="string"),U=this._decompressWorker();var O=!this._dataBinary;O&&!z&&(U=U.pipe(new w.Utf8EncodeWorker)),!O&&z&&(U=U.pipe(new w.Utf8DecodeWorker))}catch(L){(U=new A("error")).error(L)}return new x(U,H,"")},async:function(I,U){return this.internalStream(I).accumulate(U)},nodeStream:function(I,U){return this.internalStream(I||"nodebuffer").toNodejsStream(U)},_compressWorker:function(I,U){if(this._data instanceof _&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var H=this._decompressWorker();return this._dataBinary||(H=H.pipe(new w.Utf8EncodeWorker)),_.createWorkerFrom(H,I,U)},_decompressWorker:function(){return this._data instanceof _?this._data.getContentWorker():this._data instanceof A?this._data:new v(this._data)}};for(var P=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],B=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},T=0;T<P.length;T++)m.prototype[P[T]]=B;y.exports=m},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,y,g){(function(m){var x,v,w=m.MutationObserver||m.WebKitMutationObserver;if(w){var _=0,A=new w(I),P=m.document.createTextNode("");A.observe(P,{characterData:!0}),x=function(){P.data=_=++_%2}}else if(m.setImmediate||m.MessageChannel===void 0)x="document"in m&&"onreadystatechange"in m.document.createElement("script")?function(){var U=m.document.createElement("script");U.onreadystatechange=function(){I(),U.onreadystatechange=null,U.parentNode.removeChild(U),U=null},m.document.documentElement.appendChild(U)}:function(){setTimeout(I,0)};else{var B=new m.MessageChannel;B.port1.onmessage=I,x=function(){B.port2.postMessage(0)}}var T=[];function I(){var U,H;v=!0;for(var z=T.length;z;){for(H=T,T=[],U=-1;++U<z;)H[U]();z=T.length}v=!1}y.exports=function(U){T.push(U)!==1||v||x()}}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,y,g){var m=h("immediate");function x(){}var v={},w=["REJECTED"],_=["FULFILLED"],A=["PENDING"];function P(z){if(typeof z!="function")throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,z!==x&&U(this,z)}function B(z,O,L){this.promise=z,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function T(z,O,L){m((function(){var E;try{E=O(L)}catch(k){return v.reject(z,k)}E===z?v.reject(z,new TypeError("Cannot resolve promise with itself")):v.resolve(z,E)}))}function I(z){var O=z&&z.then;if(z&&(typeof z=="object"||typeof z=="function")&&typeof O=="function")return function(){O.apply(z,arguments)}}function U(z,O){var L=!1;function E(S){L||(L=!0,v.reject(z,S))}function k(S){L||(L=!0,v.resolve(z,S))}var N=H((function(){O(k,E)}));N.status==="error"&&E(N.value)}function H(z,O){var L={};try{L.value=z(O),L.status="success"}catch(E){L.status="error",L.value=E}return L}(y.exports=P).prototype.finally=function(z){if(typeof z!="function")return this;var O=this.constructor;return this.then((function(L){return O.resolve(z()).then((function(){return L}))}),(function(L){return O.resolve(z()).then((function(){throw L}))}))},P.prototype.catch=function(z){return this.then(null,z)},P.prototype.then=function(z,O){if(typeof z!="function"&&this.state===_||typeof O!="function"&&this.state===w)return this;var L=new this.constructor(x);return this.state!==A?T(L,this.state===_?z:O,this.outcome):this.queue.push(new B(L,z,O)),L},B.prototype.callFulfilled=function(z){v.resolve(this.promise,z)},B.prototype.otherCallFulfilled=function(z){T(this.promise,this.onFulfilled,z)},B.prototype.callRejected=function(z){v.reject(this.promise,z)},B.prototype.otherCallRejected=function(z){T(this.promise,this.onRejected,z)},v.resolve=function(z,O){var L=H(I,O);if(L.status==="error")return v.reject(z,L.value);var E=L.value;if(E)U(z,E);else{z.state=_,z.outcome=O;for(var k=-1,N=z.queue.length;++k<N;)z.queue[k].callFulfilled(O)}return z},v.reject=function(z,O){z.state=w,z.outcome=O;for(var L=-1,E=z.queue.length;++L<E;)z.queue[L].callRejected(O);return z},P.resolve=function(z){return z instanceof this?z:v.resolve(new this(x),z)},P.reject=function(z){var O=new this(x);return v.reject(O,z)},P.all=function(z){var O=this;if(Object.prototype.toString.call(z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=z.length,E=!1;if(!L)return this.resolve([]);for(var k=new Array(L),N=0,S=-1,C=new this(x);++S<L;)D(z[S],S);return C;function D(q,M){O.resolve(q).then((function(G){k[M]=G,++N!==L||E||(E=!0,v.resolve(C,k))}),(function(G){E||(E=!0,v.reject(C,G))}))}},P.race=function(z){if(Object.prototype.toString.call(z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=z.length,L=!1;if(!O)return this.resolve([]);for(var E,k=-1,N=new this(x);++k<O;)E=z[k],this.resolve(E).then((function(S){L||(L=!0,v.resolve(N,S))}),(function(S){L||(L=!0,v.reject(N,S))}));return N}},{immediate:36}],38:[function(h,y,g){var m={};(0,h("./lib/utils/common").assign)(m,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),y.exports=m},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,y,g){var m=h("./zlib/deflate"),x=h("./utils/common"),v=h("./utils/strings"),w=h("./zlib/messages"),_=h("./zlib/zstream"),A=Object.prototype.toString;function P(T){if(!(this instanceof P))return new P(T);this.options=x.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},T||{});var I=this.options;I.raw&&0<I.windowBits?I.windowBits=-I.windowBits:I.gzip&&0<I.windowBits&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var U=m.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(U!==0)throw new Error(w[U]);if(I.header&&m.deflateSetHeader(this.strm,I.header),I.dictionary){var H;if(H=typeof I.dictionary=="string"?v.string2buf(I.dictionary):A.call(I.dictionary)==="[object ArrayBuffer]"?new Uint8Array(I.dictionary):I.dictionary,(U=m.deflateSetDictionary(this.strm,H))!==0)throw new Error(w[U]);this._dict_set=!0}}function B(T,I){var U=new P(I);if(U.push(T,!0),U.err)throw U.msg||w[U.err];return U.result}P.prototype.push=function(T,I){var U,H,z=this.strm,O=this.options.chunkSize;if(this.ended)return!1;H=I===~~I?I:I===!0?4:0,typeof T=="string"?z.input=v.string2buf(T):A.call(T)==="[object ArrayBuffer]"?z.input=new Uint8Array(T):z.input=T,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new x.Buf8(O),z.next_out=0,z.avail_out=O),(U=m.deflate(z,H))!==1&&U!==0)return this.onEnd(U),!(this.ended=!0);z.avail_out!==0&&(z.avail_in!==0||H!==4&&H!==2)||(this.options.to==="string"?this.onData(v.buf2binstring(x.shrinkBuf(z.output,z.next_out))):this.onData(x.shrinkBuf(z.output,z.next_out)))}while((0<z.avail_in||z.avail_out===0)&&U!==1);return H===4?(U=m.deflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===0):H!==2||(this.onEnd(0),!(z.avail_out=0))},P.prototype.onData=function(T){this.chunks.push(T)},P.prototype.onEnd=function(T){T===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},g.Deflate=P,g.deflate=B,g.deflateRaw=function(T,I){return(I=I||{}).raw=!0,B(T,I)},g.gzip=function(T,I){return(I=I||{}).gzip=!0,B(T,I)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,y,g){var m=h("./zlib/inflate"),x=h("./utils/common"),v=h("./utils/strings"),w=h("./zlib/constants"),_=h("./zlib/messages"),A=h("./zlib/zstream"),P=h("./zlib/gzheader"),B=Object.prototype.toString;function T(U){if(!(this instanceof T))return new T(U);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},U||{});var H=this.options;H.raw&&0<=H.windowBits&&H.windowBits<16&&(H.windowBits=-H.windowBits,H.windowBits===0&&(H.windowBits=-15)),!(0<=H.windowBits&&H.windowBits<16)||U&&U.windowBits||(H.windowBits+=32),15<H.windowBits&&H.windowBits<48&&(15&H.windowBits)==0&&(H.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A,this.strm.avail_out=0;var z=m.inflateInit2(this.strm,H.windowBits);if(z!==w.Z_OK)throw new Error(_[z]);this.header=new P,m.inflateGetHeader(this.strm,this.header)}function I(U,H){var z=new T(H);if(z.push(U,!0),z.err)throw z.msg||_[z.err];return z.result}T.prototype.push=function(U,H){var z,O,L,E,k,N,S=this.strm,C=this.options.chunkSize,D=this.options.dictionary,q=!1;if(this.ended)return!1;O=H===~~H?H:H===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof U=="string"?S.input=v.binstring2buf(U):B.call(U)==="[object ArrayBuffer]"?S.input=new Uint8Array(U):S.input=U,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new x.Buf8(C),S.next_out=0,S.avail_out=C),(z=m.inflate(S,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&D&&(N=typeof D=="string"?v.string2buf(D):B.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,z=m.inflateSetDictionary(this.strm,N)),z===w.Z_BUF_ERROR&&q===!0&&(z=w.Z_OK,q=!1),z!==w.Z_STREAM_END&&z!==w.Z_OK)return this.onEnd(z),!(this.ended=!0);S.next_out&&(S.avail_out!==0&&z!==w.Z_STREAM_END&&(S.avail_in!==0||O!==w.Z_FINISH&&O!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=v.utf8border(S.output,S.next_out),E=S.next_out-L,k=v.buf2string(S.output,L),S.next_out=E,S.avail_out=C-E,E&&x.arraySet(S.output,S.output,L,E,0),this.onData(k)):this.onData(x.shrinkBuf(S.output,S.next_out)))),S.avail_in===0&&S.avail_out===0&&(q=!0)}while((0<S.avail_in||S.avail_out===0)&&z!==w.Z_STREAM_END);return z===w.Z_STREAM_END&&(O=w.Z_FINISH),O===w.Z_FINISH?(z=m.inflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===w.Z_OK):O!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(S.avail_out=0))},T.prototype.onData=function(U){this.chunks.push(U)},T.prototype.onEnd=function(U){U===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg},g.Inflate=T,g.inflate=I,g.inflateRaw=function(U,H){return(H=H||{}).raw=!0,I(U,H)},g.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,y,g){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";g.assign=function(w){for(var _=Array.prototype.slice.call(arguments,1);_.length;){var A=_.shift();if(A){if(typeof A!="object")throw new TypeError(A+"must be non-object");for(var P in A)A.hasOwnProperty(P)&&(w[P]=A[P])}}return w},g.shrinkBuf=function(w,_){return w.length===_?w:w.subarray?w.subarray(0,_):(w.length=_,w)};var x={arraySet:function(w,_,A,P,B){if(_.subarray&&w.subarray)w.set(_.subarray(A,A+P),B);else for(var T=0;T<P;T++)w[B+T]=_[A+T]},flattenChunks:function(w){var _,A,P,B,T,I;for(_=P=0,A=w.length;_<A;_++)P+=w[_].length;for(I=new Uint8Array(P),_=B=0,A=w.length;_<A;_++)T=w[_],I.set(T,B),B+=T.length;return I}},v={arraySet:function(w,_,A,P,B){for(var T=0;T<P;T++)w[B+T]=_[A+T]},flattenChunks:function(w){return[].concat.apply([],w)}};g.setTyped=function(w){w?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,x)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,v))},g.setTyped(m)},{}],42:[function(h,y,g){var m=h("./common"),x=!0,v=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{v=!1}for(var w=new m.Buf8(256),_=0;_<256;_++)w[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;function A(P,B){if(B<65537&&(P.subarray&&v||!P.subarray&&x))return String.fromCharCode.apply(null,m.shrinkBuf(P,B));for(var T="",I=0;I<B;I++)T+=String.fromCharCode(P[I]);return T}w[254]=w[254]=1,g.string2buf=function(P){var B,T,I,U,H,z=P.length,O=0;for(U=0;U<z;U++)(64512&(T=P.charCodeAt(U)))==55296&&U+1<z&&(64512&(I=P.charCodeAt(U+1)))==56320&&(T=65536+(T-55296<<10)+(I-56320),U++),O+=T<128?1:T<2048?2:T<65536?3:4;for(B=new m.Buf8(O),U=H=0;H<O;U++)(64512&(T=P.charCodeAt(U)))==55296&&U+1<z&&(64512&(I=P.charCodeAt(U+1)))==56320&&(T=65536+(T-55296<<10)+(I-56320),U++),T<128?B[H++]=T:(T<2048?B[H++]=192|T>>>6:(T<65536?B[H++]=224|T>>>12:(B[H++]=240|T>>>18,B[H++]=128|T>>>12&63),B[H++]=128|T>>>6&63),B[H++]=128|63&T);return B},g.buf2binstring=function(P){return A(P,P.length)},g.binstring2buf=function(P){for(var B=new m.Buf8(P.length),T=0,I=B.length;T<I;T++)B[T]=P.charCodeAt(T);return B},g.buf2string=function(P,B){var T,I,U,H,z=B||P.length,O=new Array(2*z);for(T=I=0;T<z;)if((U=P[T++])<128)O[I++]=U;else if(4<(H=w[U]))O[I++]=65533,T+=H-1;else{for(U&=H===2?31:H===3?15:7;1<H&&T<z;)U=U<<6|63&P[T++],H--;1<H?O[I++]=65533:U<65536?O[I++]=U:(U-=65536,O[I++]=55296|U>>10&1023,O[I++]=56320|1023&U)}return A(O,I)},g.utf8border=function(P,B){var T;for((B=B||P.length)>P.length&&(B=P.length),T=B-1;0<=T&&(192&P[T])==128;)T--;return T<0||T===0?B:T+w[P[T]]>B?T:B}},{"./common":41}],43:[function(h,y,g){y.exports=function(m,x,v,w){for(var _=65535&m|0,A=m>>>16&65535|0,P=0;v!==0;){for(v-=P=2e3<v?2e3:v;A=A+(_=_+x[w++]|0)|0,--P;);_%=65521,A%=65521}return _|A<<16|0}},{}],44:[function(h,y,g){y.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,y,g){var m=(function(){for(var x,v=[],w=0;w<256;w++){x=w;for(var _=0;_<8;_++)x=1&x?3988292384^x>>>1:x>>>1;v[w]=x}return v})();y.exports=function(x,v,w,_){var A=m,P=_+w;x^=-1;for(var B=_;B<P;B++)x=x>>>8^A[255&(x^v[B])];return-1^x}},{}],46:[function(h,y,g){var m,x=h("../utils/common"),v=h("./trees"),w=h("./adler32"),_=h("./crc32"),A=h("./messages"),P=-2,B=258,T=262,I=113;function U(V,J){return V.msg=A[J],J}function H(V){return(V<<1)-(4<V?9:0)}function z(V){for(var J=V.length;0<=--J;)V[J]=0}function O(V){var J=V.state,W=J.pending;W>V.avail_out&&(W=V.avail_out),W!==0&&(x.arraySet(V.output,J.pending_buf,J.pending_out,W,V.next_out),V.next_out+=W,J.pending_out+=W,V.total_out+=W,V.avail_out-=W,J.pending-=W,J.pending===0&&(J.pending_out=0))}function L(V,J){v._tr_flush_block(V,0<=V.block_start?V.block_start:-1,V.strstart-V.block_start,J),V.block_start=V.strstart,O(V.strm)}function E(V,J){V.pending_buf[V.pending++]=J}function k(V,J){V.pending_buf[V.pending++]=J>>>8&255,V.pending_buf[V.pending++]=255&J}function N(V,J){var W,F,Q=V.max_chain_length,ne=V.strstart,ie=V.prev_length,ce=V.nice_match,de=V.strstart>V.w_size-T?V.strstart-(V.w_size-T):0,le=V.window,_e=V.w_mask,ue=V.prev,pe=V.strstart+B,me=le[ne+ie-1],Ce=le[ne+ie];V.prev_length>=V.good_match&&(Q>>=2),ce>V.lookahead&&(ce=V.lookahead);do if(le[(W=J)+ie]===Ce&&le[W+ie-1]===me&&le[W]===le[ne]&&le[++W]===le[ne+1]){ne+=2,W++;do;while(le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&le[++ne]===le[++W]&&ne<pe);if(F=B-(pe-ne),ne=pe-B,ie<F){if(V.match_start=J,ce<=(ie=F))break;me=le[ne+ie-1],Ce=le[ne+ie]}}while((J=ue[J&_e])>de&&--Q!=0);return ie<=V.lookahead?ie:V.lookahead}function S(V){var J,W,F,Q,ne,ie,ce,de,le,_e,ue=V.w_size;do{if(Q=V.window_size-V.lookahead-V.strstart,V.strstart>=ue+(ue-T)){for(x.arraySet(V.window,V.window,ue,ue,0),V.match_start-=ue,V.strstart-=ue,V.block_start-=ue,J=W=V.hash_size;F=V.head[--J],V.head[J]=ue<=F?F-ue:0,--W;);for(J=W=ue;F=V.prev[--J],V.prev[J]=ue<=F?F-ue:0,--W;);Q+=ue}if(V.strm.avail_in===0)break;if(ie=V.strm,ce=V.window,de=V.strstart+V.lookahead,_e=void 0,(le=Q)<(_e=ie.avail_in)&&(_e=le),W=_e===0?0:(ie.avail_in-=_e,x.arraySet(ce,ie.input,ie.next_in,_e,de),ie.state.wrap===1?ie.adler=w(ie.adler,ce,_e,de):ie.state.wrap===2&&(ie.adler=_(ie.adler,ce,_e,de)),ie.next_in+=_e,ie.total_in+=_e,_e),V.lookahead+=W,V.lookahead+V.insert>=3)for(ne=V.strstart-V.insert,V.ins_h=V.window[ne],V.ins_h=(V.ins_h<<V.hash_shift^V.window[ne+1])&V.hash_mask;V.insert&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[ne+3-1])&V.hash_mask,V.prev[ne&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=ne,ne++,V.insert--,!(V.lookahead+V.insert<3)););}while(V.lookahead<T&&V.strm.avail_in!==0)}function C(V,J){for(var W,F;;){if(V.lookahead<T){if(S(V),V.lookahead<T&&J===0)return 1;if(V.lookahead===0)break}if(W=0,V.lookahead>=3&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,W=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),W!==0&&V.strstart-W<=V.w_size-T&&(V.match_length=N(V,W)),V.match_length>=3)if(F=v._tr_tally(V,V.strstart-V.match_start,V.match_length-3),V.lookahead-=V.match_length,V.match_length<=V.max_lazy_match&&V.lookahead>=3){for(V.match_length--;V.strstart++,V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,W=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart,--V.match_length!=0;);V.strstart++}else V.strstart+=V.match_length,V.match_length=0,V.ins_h=V.window[V.strstart],V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+1])&V.hash_mask;else F=v._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++;if(F&&(L(V,!1),V.strm.avail_out===0))return 1}return V.insert=V.strstart<2?V.strstart:2,J===4?(L(V,!0),V.strm.avail_out===0?3:4):V.last_lit&&(L(V,!1),V.strm.avail_out===0)?1:2}function D(V,J){for(var W,F,Q;;){if(V.lookahead<T){if(S(V),V.lookahead<T&&J===0)return 1;if(V.lookahead===0)break}if(W=0,V.lookahead>=3&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,W=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),V.prev_length=V.match_length,V.prev_match=V.match_start,V.match_length=2,W!==0&&V.prev_length<V.max_lazy_match&&V.strstart-W<=V.w_size-T&&(V.match_length=N(V,W),V.match_length<=5&&(V.strategy===1||V.match_length===3&&4096<V.strstart-V.match_start)&&(V.match_length=2)),V.prev_length>=3&&V.match_length<=V.prev_length){for(Q=V.strstart+V.lookahead-3,F=v._tr_tally(V,V.strstart-1-V.prev_match,V.prev_length-3),V.lookahead-=V.prev_length-1,V.prev_length-=2;++V.strstart<=Q&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+3-1])&V.hash_mask,W=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),--V.prev_length!=0;);if(V.match_available=0,V.match_length=2,V.strstart++,F&&(L(V,!1),V.strm.avail_out===0))return 1}else if(V.match_available){if((F=v._tr_tally(V,0,V.window[V.strstart-1]))&&L(V,!1),V.strstart++,V.lookahead--,V.strm.avail_out===0)return 1}else V.match_available=1,V.strstart++,V.lookahead--}return V.match_available&&(F=v._tr_tally(V,0,V.window[V.strstart-1]),V.match_available=0),V.insert=V.strstart<2?V.strstart:2,J===4?(L(V,!0),V.strm.avail_out===0?3:4):V.last_lit&&(L(V,!1),V.strm.avail_out===0)?1:2}function q(V,J,W,F,Q){this.good_length=V,this.max_lazy=J,this.nice_length=W,this.max_chain=F,this.func=Q}function M(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(1146),this.dyn_dtree=new x.Buf16(122),this.bl_tree=new x.Buf16(78),z(this.dyn_ltree),z(this.dyn_dtree),z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(16),this.heap=new x.Buf16(573),z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(573),z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(V){var J;return V&&V.state?(V.total_in=V.total_out=0,V.data_type=2,(J=V.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?42:I,V.adler=J.wrap===2?0:1,J.last_flush=0,v._tr_init(J),0):U(V,P)}function X(V){var J=G(V);return J===0&&(function(W){W.window_size=2*W.w_size,z(W.head),W.max_lazy_match=m[W.level].max_lazy,W.good_match=m[W.level].good_length,W.nice_match=m[W.level].nice_length,W.max_chain_length=m[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=2,W.match_available=0,W.ins_h=0})(V.state),J}function re(V,J,W,F,Q,ne){if(!V)return P;var ie=1;if(J===-1&&(J=6),F<0?(ie=0,F=-F):15<F&&(ie=2,F-=16),Q<1||9<Q||W!==8||F<8||15<F||J<0||9<J||ne<0||4<ne)return U(V,P);F===8&&(F=9);var ce=new M;return(V.state=ce).strm=V,ce.wrap=ie,ce.gzhead=null,ce.w_bits=F,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=Q+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+3-1)/3),ce.window=new x.Buf8(2*ce.w_size),ce.head=new x.Buf16(ce.hash_size),ce.prev=new x.Buf16(ce.w_size),ce.lit_bufsize=1<<Q+6,ce.pending_buf_size=4*ce.lit_bufsize,ce.pending_buf=new x.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=J,ce.strategy=ne,ce.method=W,X(V)}m=[new q(0,0,0,0,(function(V,J){var W=65535;for(W>V.pending_buf_size-5&&(W=V.pending_buf_size-5);;){if(V.lookahead<=1){if(S(V),V.lookahead===0&&J===0)return 1;if(V.lookahead===0)break}V.strstart+=V.lookahead,V.lookahead=0;var F=V.block_start+W;if((V.strstart===0||V.strstart>=F)&&(V.lookahead=V.strstart-F,V.strstart=F,L(V,!1),V.strm.avail_out===0)||V.strstart-V.block_start>=V.w_size-T&&(L(V,!1),V.strm.avail_out===0))return 1}return V.insert=0,J===4?(L(V,!0),V.strm.avail_out===0?3:4):(V.strstart>V.block_start&&(L(V,!1),V.strm.avail_out),1)})),new q(4,4,8,4,C),new q(4,5,16,8,C),new q(4,6,32,32,C),new q(4,4,16,16,D),new q(8,16,32,32,D),new q(8,16,128,128,D),new q(8,32,128,256,D),new q(32,128,258,1024,D),new q(32,258,258,4096,D)],g.deflateInit=function(V,J){return re(V,J,8,15,8,0)},g.deflateInit2=re,g.deflateReset=X,g.deflateResetKeep=G,g.deflateSetHeader=function(V,J){return V&&V.state?V.state.wrap!==2?P:(V.state.gzhead=J,0):P},g.deflate=function(V,J){var W,F,Q,ne;if(!V||!V.state||5<J||J<0)return V?U(V,P):P;if(F=V.state,!V.output||!V.input&&V.avail_in!==0||F.status===666&&J!==4)return U(V,V.avail_out===0?-5:P);if(F.strm=V,W=F.last_flush,F.last_flush=J,F.status===42)if(F.wrap===2)V.adler=0,E(F,31),E(F,139),E(F,8),F.gzhead?(E(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),E(F,255&F.gzhead.time),E(F,F.gzhead.time>>8&255),E(F,F.gzhead.time>>16&255),E(F,F.gzhead.time>>24&255),E(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),E(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(E(F,255&F.gzhead.extra.length),E(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(V.adler=_(V.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(E(F,0),E(F,0),E(F,0),E(F,0),E(F,0),E(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),E(F,3),F.status=I);else{var ie=8+(F.w_bits-8<<4)<<8;ie|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(ie|=32),ie+=31-ie%31,F.status=I,k(F,ie),F.strstart!==0&&(k(F,V.adler>>>16),k(F,65535&V.adler)),V.adler=1}if(F.status===69)if(F.gzhead.extra){for(Q=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),O(V),Q=F.pending,F.pending!==F.pending_buf_size));)E(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){Q=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),O(V),Q=F.pending,F.pending===F.pending_buf_size)){ne=1;break}ne=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,E(F,ne)}while(ne!==0);F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),ne===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){Q=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),O(V),Q=F.pending,F.pending===F.pending_buf_size)){ne=1;break}ne=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,E(F,ne)}while(ne!==0);F.gzhead.hcrc&&F.pending>Q&&(V.adler=_(V.adler,F.pending_buf,F.pending-Q,Q)),ne===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&O(V),F.pending+2<=F.pending_buf_size&&(E(F,255&V.adler),E(F,V.adler>>8&255),V.adler=0,F.status=I)):F.status=I),F.pending!==0){if(O(V),V.avail_out===0)return F.last_flush=-1,0}else if(V.avail_in===0&&H(J)<=H(W)&&J!==4)return U(V,-5);if(F.status===666&&V.avail_in!==0)return U(V,-5);if(V.avail_in!==0||F.lookahead!==0||J!==0&&F.status!==666){var ce=F.strategy===2?(function(de,le){for(var _e;;){if(de.lookahead===0&&(S(de),de.lookahead===0)){if(le===0)return 1;break}if(de.match_length=0,_e=v._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++,_e&&(L(de,!1),de.strm.avail_out===0))return 1}return de.insert=0,le===4?(L(de,!0),de.strm.avail_out===0?3:4):de.last_lit&&(L(de,!1),de.strm.avail_out===0)?1:2})(F,J):F.strategy===3?(function(de,le){for(var _e,ue,pe,me,Ce=de.window;;){if(de.lookahead<=B){if(S(de),de.lookahead<=B&&le===0)return 1;if(de.lookahead===0)break}if(de.match_length=0,de.lookahead>=3&&0<de.strstart&&(ue=Ce[pe=de.strstart-1])===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]){me=de.strstart+B;do;while(ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&ue===Ce[++pe]&&pe<me);de.match_length=B-(me-pe),de.match_length>de.lookahead&&(de.match_length=de.lookahead)}if(de.match_length>=3?(_e=v._tr_tally(de,1,de.match_length-3),de.lookahead-=de.match_length,de.strstart+=de.match_length,de.match_length=0):(_e=v._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++),_e&&(L(de,!1),de.strm.avail_out===0))return 1}return de.insert=0,le===4?(L(de,!0),de.strm.avail_out===0?3:4):de.last_lit&&(L(de,!1),de.strm.avail_out===0)?1:2})(F,J):m[F.level].func(F,J);if(ce!==3&&ce!==4||(F.status=666),ce===1||ce===3)return V.avail_out===0&&(F.last_flush=-1),0;if(ce===2&&(J===1?v._tr_align(F):J!==5&&(v._tr_stored_block(F,0,0,!1),J===3&&(z(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),O(V),V.avail_out===0))return F.last_flush=-1,0}return J!==4?0:F.wrap<=0?1:(F.wrap===2?(E(F,255&V.adler),E(F,V.adler>>8&255),E(F,V.adler>>16&255),E(F,V.adler>>24&255),E(F,255&V.total_in),E(F,V.total_in>>8&255),E(F,V.total_in>>16&255),E(F,V.total_in>>24&255)):(k(F,V.adler>>>16),k(F,65535&V.adler)),O(V),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?0:1)},g.deflateEnd=function(V){var J;return V&&V.state?(J=V.state.status)!==42&&J!==69&&J!==73&&J!==91&&J!==103&&J!==I&&J!==666?U(V,P):(V.state=null,J===I?U(V,-3):0):P},g.deflateSetDictionary=function(V,J){var W,F,Q,ne,ie,ce,de,le,_e=J.length;if(!V||!V.state||(ne=(W=V.state).wrap)===2||ne===1&&W.status!==42||W.lookahead)return P;for(ne===1&&(V.adler=w(V.adler,J,_e,0)),W.wrap=0,_e>=W.w_size&&(ne===0&&(z(W.head),W.strstart=0,W.block_start=0,W.insert=0),le=new x.Buf8(W.w_size),x.arraySet(le,J,_e-W.w_size,W.w_size,0),J=le,_e=W.w_size),ie=V.avail_in,ce=V.next_in,de=V.input,V.avail_in=_e,V.next_in=0,V.input=J,S(W);W.lookahead>=3;){for(F=W.strstart,Q=W.lookahead-2;W.ins_h=(W.ins_h<<W.hash_shift^W.window[F+3-1])&W.hash_mask,W.prev[F&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=F,F++,--Q;);W.strstart=F,W.lookahead=2,S(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=2,W.match_available=0,V.next_in=ce,V.input=de,V.avail_in=ie,W.wrap=ne,0},g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,y,g){y.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,y,g){y.exports=function(m,x){var v,w,_,A,P,B,T,I,U,H,z,O,L,E,k,N,S,C,D,q,M,G,X,re,V;v=m.state,w=m.next_in,re=m.input,_=w+(m.avail_in-5),A=m.next_out,V=m.output,P=A-(x-m.avail_out),B=A+(m.avail_out-257),T=v.dmax,I=v.wsize,U=v.whave,H=v.wnext,z=v.window,O=v.hold,L=v.bits,E=v.lencode,k=v.distcode,N=(1<<v.lenbits)-1,S=(1<<v.distbits)-1;e:do{L<15&&(O+=re[w++]<<L,L+=8,O+=re[w++]<<L,L+=8),C=E[O&N];t:for(;;){if(O>>>=D=C>>>24,L-=D,(D=C>>>16&255)==0)V[A++]=65535&C;else{if(!(16&D)){if((64&D)==0){C=E[(65535&C)+(O&(1<<D)-1)];continue t}if(32&D){v.mode=12;break e}m.msg="invalid literal/length code",v.mode=30;break e}q=65535&C,(D&=15)&&(L<D&&(O+=re[w++]<<L,L+=8),q+=O&(1<<D)-1,O>>>=D,L-=D),L<15&&(O+=re[w++]<<L,L+=8,O+=re[w++]<<L,L+=8),C=k[O&S];r:for(;;){if(O>>>=D=C>>>24,L-=D,!(16&(D=C>>>16&255))){if((64&D)==0){C=k[(65535&C)+(O&(1<<D)-1)];continue r}m.msg="invalid distance code",v.mode=30;break e}if(M=65535&C,L<(D&=15)&&(O+=re[w++]<<L,(L+=8)<D&&(O+=re[w++]<<L,L+=8)),T<(M+=O&(1<<D)-1)){m.msg="invalid distance too far back",v.mode=30;break e}if(O>>>=D,L-=D,(D=A-P)<M){if(U<(D=M-D)&&v.sane){m.msg="invalid distance too far back",v.mode=30;break e}if(X=z,(G=0)===H){if(G+=I-D,D<q){for(q-=D;V[A++]=z[G++],--D;);G=A-M,X=V}}else if(H<D){if(G+=I+H-D,(D-=H)<q){for(q-=D;V[A++]=z[G++],--D;);if(G=0,H<q){for(q-=D=H;V[A++]=z[G++],--D;);G=A-M,X=V}}}else if(G+=H-D,D<q){for(q-=D;V[A++]=z[G++],--D;);G=A-M,X=V}for(;2<q;)V[A++]=X[G++],V[A++]=X[G++],V[A++]=X[G++],q-=3;q&&(V[A++]=X[G++],1<q&&(V[A++]=X[G++]))}else{for(G=A-M;V[A++]=V[G++],V[A++]=V[G++],V[A++]=V[G++],2<(q-=3););q&&(V[A++]=V[G++],1<q&&(V[A++]=V[G++]))}break}}break}}while(w<_&&A<B);w-=q=L>>3,O&=(1<<(L-=q<<3))-1,m.next_in=w,m.next_out=A,m.avail_in=w<_?_-w+5:5-(w-_),m.avail_out=A<B?B-A+257:257-(A-B),v.hold=O,v.bits=L}},{}],49:[function(h,y,g){var m=h("../utils/common"),x=h("./adler32"),v=h("./crc32"),w=h("./inffast"),_=h("./inftrees"),A=-2;function P(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function B(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new m.Buf16(320),this.work=new m.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(N){var S;return N&&N.state?(S=N.state,N.total_in=N.total_out=S.total=0,N.msg="",S.wrap&&(N.adler=1&S.wrap),S.mode=1,S.last=0,S.havedict=0,S.dmax=32768,S.head=null,S.hold=0,S.bits=0,S.lencode=S.lendyn=new m.Buf32(852),S.distcode=S.distdyn=new m.Buf32(592),S.sane=1,S.back=-1,0):A}function I(N){var S;return N&&N.state?((S=N.state).wsize=0,S.whave=0,S.wnext=0,T(N)):A}function U(N,S){var C,D;return N&&N.state?(D=N.state,S<0?(C=0,S=-S):(C=1+(S>>4),S<48&&(S&=15)),S&&(S<8||15<S)?A:(D.window!==null&&D.wbits!==S&&(D.window=null),D.wrap=C,D.wbits=S,I(N))):A}function H(N,S){var C,D;return N?(D=new B,(N.state=D).window=null,(C=U(N,S))!==0&&(N.state=null),C):A}var z,O,L=!0;function E(N){if(L){var S;for(z=new m.Buf32(512),O=new m.Buf32(32),S=0;S<144;)N.lens[S++]=8;for(;S<256;)N.lens[S++]=9;for(;S<280;)N.lens[S++]=7;for(;S<288;)N.lens[S++]=8;for(_(1,N.lens,0,288,z,0,N.work,{bits:9}),S=0;S<32;)N.lens[S++]=5;_(2,N.lens,0,32,O,0,N.work,{bits:5}),L=!1}N.lencode=z,N.lenbits=9,N.distcode=O,N.distbits=5}function k(N,S,C,D){var q,M=N.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new m.Buf8(M.wsize)),D>=M.wsize?(m.arraySet(M.window,S,C-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(D<(q=M.wsize-M.wnext)&&(q=D),m.arraySet(M.window,S,C-D,q,M.wnext),(D-=q)?(m.arraySet(M.window,S,C-D,D,0),M.wnext=D,M.whave=M.wsize):(M.wnext+=q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=q))),0}g.inflateReset=I,g.inflateReset2=U,g.inflateResetKeep=T,g.inflateInit=function(N){return H(N,15)},g.inflateInit2=H,g.inflate=function(N,S){var C,D,q,M,G,X,re,V,J,W,F,Q,ne,ie,ce,de,le,_e,ue,pe,me,Ce,fe,xe,je=0,Oe=new m.Buf8(4),Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return A;(C=N.state).mode===12&&(C.mode=13),G=N.next_out,q=N.output,re=N.avail_out,M=N.next_in,D=N.input,X=N.avail_in,V=C.hold,J=C.bits,W=X,F=re,Ce=0;e:for(;;)switch(C.mode){case 1:if(C.wrap===0){C.mode=13;break}for(;J<16;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(2&C.wrap&&V===35615){Oe[C.check=0]=255&V,Oe[1]=V>>>8&255,C.check=v(C.check,Oe,2,0),J=V=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&V)<<8)+(V>>8))%31){N.msg="incorrect header check",C.mode=30;break}if((15&V)!=8){N.msg="unknown compression method",C.mode=30;break}if(J-=4,me=8+(15&(V>>>=4)),C.wbits===0)C.wbits=me;else if(me>C.wbits){N.msg="invalid window size",C.mode=30;break}C.dmax=1<<me,N.adler=C.check=1,C.mode=512&V?10:12,J=V=0;break;case 2:for(;J<16;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(C.flags=V,(255&C.flags)!=8){N.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){N.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=V>>8&1),512&C.flags&&(Oe[0]=255&V,Oe[1]=V>>>8&255,C.check=v(C.check,Oe,2,0)),J=V=0,C.mode=3;case 3:for(;J<32;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.head&&(C.head.time=V),512&C.flags&&(Oe[0]=255&V,Oe[1]=V>>>8&255,Oe[2]=V>>>16&255,Oe[3]=V>>>24&255,C.check=v(C.check,Oe,4,0)),J=V=0,C.mode=4;case 4:for(;J<16;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.head&&(C.head.xflags=255&V,C.head.os=V>>8),512&C.flags&&(Oe[0]=255&V,Oe[1]=V>>>8&255,C.check=v(C.check,Oe,2,0)),J=V=0,C.mode=5;case 5:if(1024&C.flags){for(;J<16;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.length=V,C.head&&(C.head.extra_len=V),512&C.flags&&(Oe[0]=255&V,Oe[1]=V>>>8&255,C.check=v(C.check,Oe,2,0)),J=V=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(X<(Q=C.length)&&(Q=X),Q&&(C.head&&(me=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),m.arraySet(C.head.extra,D,M,Q,me)),512&C.flags&&(C.check=v(C.check,D,Q,M)),X-=Q,M+=Q,C.length-=Q),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(X===0)break e;for(Q=0;me=D[M+Q++],C.head&&me&&C.length<65536&&(C.head.name+=String.fromCharCode(me)),me&&Q<X;);if(512&C.flags&&(C.check=v(C.check,D,Q,M)),X-=Q,M+=Q,me)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(X===0)break e;for(Q=0;me=D[M+Q++],C.head&&me&&C.length<65536&&(C.head.comment+=String.fromCharCode(me)),me&&Q<X;);if(512&C.flags&&(C.check=v(C.check,D,Q,M)),X-=Q,M+=Q,me)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;J<16;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(V!==(65535&C.check)){N.msg="header crc mismatch",C.mode=30;break}J=V=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),N.adler=C.check=0,C.mode=12;break;case 10:for(;J<32;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}N.adler=C.check=P(V),J=V=0,C.mode=11;case 11:if(C.havedict===0)return N.next_out=G,N.avail_out=re,N.next_in=M,N.avail_in=X,C.hold=V,C.bits=J,2;N.adler=C.check=1,C.mode=12;case 12:if(S===5||S===6)break e;case 13:if(C.last){V>>>=7&J,J-=7&J,C.mode=27;break}for(;J<3;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}switch(C.last=1&V,J-=1,3&(V>>>=1)){case 0:C.mode=14;break;case 1:if(E(C),C.mode=20,S!==6)break;V>>>=2,J-=2;break e;case 2:C.mode=17;break;case 3:N.msg="invalid block type",C.mode=30}V>>>=2,J-=2;break;case 14:for(V>>>=7&J,J-=7&J;J<32;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if((65535&V)!=(V>>>16^65535)){N.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&V,J=V=0,C.mode=15,S===6)break e;case 15:C.mode=16;case 16:if(Q=C.length){if(X<Q&&(Q=X),re<Q&&(Q=re),Q===0)break e;m.arraySet(q,D,M,Q,G),X-=Q,M+=Q,re-=Q,G+=Q,C.length-=Q;break}C.mode=12;break;case 17:for(;J<14;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(C.nlen=257+(31&V),V>>>=5,J-=5,C.ndist=1+(31&V),V>>>=5,J-=5,C.ncode=4+(15&V),V>>>=4,J-=4,286<C.nlen||30<C.ndist){N.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;J<3;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.lens[Ie[C.have++]]=7&V,V>>>=3,J-=3}for(;C.have<19;)C.lens[Ie[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,fe={bits:C.lenbits},Ce=_(0,C.lens,0,19,C.lencode,0,C.work,fe),C.lenbits=fe.bits,Ce){N.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;de=(je=C.lencode[V&(1<<C.lenbits)-1])>>>16&255,le=65535&je,!((ce=je>>>24)<=J);){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(le<16)V>>>=ce,J-=ce,C.lens[C.have++]=le;else{if(le===16){for(xe=ce+2;J<xe;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(V>>>=ce,J-=ce,C.have===0){N.msg="invalid bit length repeat",C.mode=30;break}me=C.lens[C.have-1],Q=3+(3&V),V>>>=2,J-=2}else if(le===17){for(xe=ce+3;J<xe;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}J-=ce,me=0,Q=3+(7&(V>>>=ce)),V>>>=3,J-=3}else{for(xe=ce+7;J<xe;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}J-=ce,me=0,Q=11+(127&(V>>>=ce)),V>>>=7,J-=7}if(C.have+Q>C.nlen+C.ndist){N.msg="invalid bit length repeat",C.mode=30;break}for(;Q--;)C.lens[C.have++]=me}}if(C.mode===30)break;if(C.lens[256]===0){N.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,fe={bits:C.lenbits},Ce=_(1,C.lens,0,C.nlen,C.lencode,0,C.work,fe),C.lenbits=fe.bits,Ce){N.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,fe={bits:C.distbits},Ce=_(2,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,fe),C.distbits=fe.bits,Ce){N.msg="invalid distances set",C.mode=30;break}if(C.mode=20,S===6)break e;case 20:C.mode=21;case 21:if(6<=X&&258<=re){N.next_out=G,N.avail_out=re,N.next_in=M,N.avail_in=X,C.hold=V,C.bits=J,w(N,F),G=N.next_out,q=N.output,re=N.avail_out,M=N.next_in,D=N.input,X=N.avail_in,V=C.hold,J=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;de=(je=C.lencode[V&(1<<C.lenbits)-1])>>>16&255,le=65535&je,!((ce=je>>>24)<=J);){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(de&&(240&de)==0){for(_e=ce,ue=de,pe=le;de=(je=C.lencode[pe+((V&(1<<_e+ue)-1)>>_e)])>>>16&255,le=65535&je,!(_e+(ce=je>>>24)<=J);){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}V>>>=_e,J-=_e,C.back+=_e}if(V>>>=ce,J-=ce,C.back+=ce,C.length=le,de===0){C.mode=26;break}if(32&de){C.back=-1,C.mode=12;break}if(64&de){N.msg="invalid literal/length code",C.mode=30;break}C.extra=15&de,C.mode=22;case 22:if(C.extra){for(xe=C.extra;J<xe;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.length+=V&(1<<C.extra)-1,V>>>=C.extra,J-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;de=(je=C.distcode[V&(1<<C.distbits)-1])>>>16&255,le=65535&je,!((ce=je>>>24)<=J);){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if((240&de)==0){for(_e=ce,ue=de,pe=le;de=(je=C.distcode[pe+((V&(1<<_e+ue)-1)>>_e)])>>>16&255,le=65535&je,!(_e+(ce=je>>>24)<=J);){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}V>>>=_e,J-=_e,C.back+=_e}if(V>>>=ce,J-=ce,C.back+=ce,64&de){N.msg="invalid distance code",C.mode=30;break}C.offset=le,C.extra=15&de,C.mode=24;case 24:if(C.extra){for(xe=C.extra;J<xe;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}C.offset+=V&(1<<C.extra)-1,V>>>=C.extra,J-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){N.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(re===0)break e;if(Q=F-re,C.offset>Q){if((Q=C.offset-Q)>C.whave&&C.sane){N.msg="invalid distance too far back",C.mode=30;break}ne=Q>C.wnext?(Q-=C.wnext,C.wsize-Q):C.wnext-Q,Q>C.length&&(Q=C.length),ie=C.window}else ie=q,ne=G-C.offset,Q=C.length;for(re<Q&&(Q=re),re-=Q,C.length-=Q;q[G++]=ie[ne++],--Q;);C.length===0&&(C.mode=21);break;case 26:if(re===0)break e;q[G++]=C.length,re--,C.mode=21;break;case 27:if(C.wrap){for(;J<32;){if(X===0)break e;X--,V|=D[M++]<<J,J+=8}if(F-=re,N.total_out+=F,C.total+=F,F&&(N.adler=C.check=C.flags?v(C.check,q,F,G-F):x(C.check,q,F,G-F)),F=re,(C.flags?V:P(V))!==C.check){N.msg="incorrect data check",C.mode=30;break}J=V=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;J<32;){if(X===0)break e;X--,V+=D[M++]<<J,J+=8}if(V!==(4294967295&C.total)){N.msg="incorrect length check",C.mode=30;break}J=V=0}C.mode=29;case 29:Ce=1;break e;case 30:Ce=-3;break e;case 31:return-4;default:return A}return N.next_out=G,N.avail_out=re,N.next_in=M,N.avail_in=X,C.hold=V,C.bits=J,(C.wsize||F!==N.avail_out&&C.mode<30&&(C.mode<27||S!==4))&&k(N,N.output,N.next_out,F-N.avail_out)?(C.mode=31,-4):(W-=N.avail_in,F-=N.avail_out,N.total_in+=W,N.total_out+=F,C.total+=F,C.wrap&&F&&(N.adler=C.check=C.flags?v(C.check,q,F,N.next_out-F):x(C.check,q,F,N.next_out-F)),N.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(W==0&&F===0||S===4)&&Ce===0&&(Ce=-5),Ce)},g.inflateEnd=function(N){if(!N||!N.state)return A;var S=N.state;return S.window&&(S.window=null),N.state=null,0},g.inflateGetHeader=function(N,S){var C;return N&&N.state?(2&(C=N.state).wrap)==0?A:((C.head=S).done=!1,0):A},g.inflateSetDictionary=function(N,S){var C,D=S.length;return N&&N.state?(C=N.state).wrap!==0&&C.mode!==11?A:C.mode===11&&x(1,S,D,0)!==C.check?-3:k(N,S,D,D)?(C.mode=31,-4):(C.havedict=1,0):A},g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,y,g){var m=h("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],v=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];y.exports=function(A,P,B,T,I,U,H,z){var O,L,E,k,N,S,C,D,q,M=z.bits,G=0,X=0,re=0,V=0,J=0,W=0,F=0,Q=0,ne=0,ie=0,ce=null,de=0,le=new m.Buf16(16),_e=new m.Buf16(16),ue=null,pe=0;for(G=0;G<=15;G++)le[G]=0;for(X=0;X<T;X++)le[P[B+X]]++;for(J=M,V=15;1<=V&&le[V]===0;V--);if(V<J&&(J=V),V===0)return I[U++]=20971520,I[U++]=20971520,z.bits=1,0;for(re=1;re<V&&le[re]===0;re++);for(J<re&&(J=re),G=Q=1;G<=15;G++)if(Q<<=1,(Q-=le[G])<0)return-1;if(0<Q&&(A===0||V!==1))return-1;for(_e[1]=0,G=1;G<15;G++)_e[G+1]=_e[G]+le[G];for(X=0;X<T;X++)P[B+X]!==0&&(H[_e[P[B+X]]++]=X);if(S=A===0?(ce=ue=H,19):A===1?(ce=x,de-=257,ue=v,pe-=257,256):(ce=w,ue=_,-1),G=re,N=U,F=X=ie=0,E=-1,k=(ne=1<<(W=J))-1,A===1&&852<ne||A===2&&592<ne)return 1;for(;;){for(C=G-F,q=H[X]<S?(D=0,H[X]):H[X]>S?(D=ue[pe+H[X]],ce[de+H[X]]):(D=96,0),O=1<<G-F,re=L=1<<W;I[N+(ie>>F)+(L-=O)]=C<<24|D<<16|q|0,L!==0;);for(O=1<<G-1;ie&O;)O>>=1;if(O!==0?(ie&=O-1,ie+=O):ie=0,X++,--le[G]==0){if(G===V)break;G=P[B+H[X]]}if(J<G&&(ie&k)!==E){for(F===0&&(F=J),N+=re,Q=1<<(W=G-F);W+F<V&&!((Q-=le[W+F])<=0);)W++,Q<<=1;if(ne+=1<<W,A===1&&852<ne||A===2&&592<ne)return 1;I[E=ie&k]=J<<24|W<<16|N-U|0}}return ie!==0&&(I[N+ie]=G-F<<24|64<<16|0),z.bits=J,0}},{"../utils/common":41}],51:[function(h,y,g){y.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,y,g){var m=h("../utils/common");function x(ue){for(var pe=ue.length;0<=--pe;)ue[pe]=0}var v=256,w=286,_=30,A=15,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=new Array(576);x(U);var H=new Array(60);x(H);var z=new Array(512);x(z);var O=new Array(256);x(O);var L=new Array(29);x(L);var E,k,N,S=new Array(_);function C(ue,pe,me,Ce,fe){this.static_tree=ue,this.extra_bits=pe,this.extra_base=me,this.elems=Ce,this.max_length=fe,this.has_stree=ue&&ue.length}function D(ue,pe){this.dyn_tree=ue,this.max_code=0,this.stat_desc=pe}function q(ue){return ue<256?z[ue]:z[256+(ue>>>7)]}function M(ue,pe){ue.pending_buf[ue.pending++]=255&pe,ue.pending_buf[ue.pending++]=pe>>>8&255}function G(ue,pe,me){ue.bi_valid>16-me?(ue.bi_buf|=pe<<ue.bi_valid&65535,M(ue,ue.bi_buf),ue.bi_buf=pe>>16-ue.bi_valid,ue.bi_valid+=me-16):(ue.bi_buf|=pe<<ue.bi_valid&65535,ue.bi_valid+=me)}function X(ue,pe,me){G(ue,me[2*pe],me[2*pe+1])}function re(ue,pe){for(var me=0;me|=1&ue,ue>>>=1,me<<=1,0<--pe;);return me>>>1}function V(ue,pe,me){var Ce,fe,xe=new Array(16),je=0;for(Ce=1;Ce<=A;Ce++)xe[Ce]=je=je+me[Ce-1]<<1;for(fe=0;fe<=pe;fe++){var Oe=ue[2*fe+1];Oe!==0&&(ue[2*fe]=re(xe[Oe]++,Oe))}}function J(ue){var pe;for(pe=0;pe<w;pe++)ue.dyn_ltree[2*pe]=0;for(pe=0;pe<_;pe++)ue.dyn_dtree[2*pe]=0;for(pe=0;pe<19;pe++)ue.bl_tree[2*pe]=0;ue.dyn_ltree[512]=1,ue.opt_len=ue.static_len=0,ue.last_lit=ue.matches=0}function W(ue){8<ue.bi_valid?M(ue,ue.bi_buf):0<ue.bi_valid&&(ue.pending_buf[ue.pending++]=ue.bi_buf),ue.bi_buf=0,ue.bi_valid=0}function F(ue,pe,me,Ce){var fe=2*pe,xe=2*me;return ue[fe]<ue[xe]||ue[fe]===ue[xe]&&Ce[pe]<=Ce[me]}function Q(ue,pe,me){for(var Ce=ue.heap[me],fe=me<<1;fe<=ue.heap_len&&(fe<ue.heap_len&&F(pe,ue.heap[fe+1],ue.heap[fe],ue.depth)&&fe++,!F(pe,Ce,ue.heap[fe],ue.depth));)ue.heap[me]=ue.heap[fe],me=fe,fe<<=1;ue.heap[me]=Ce}function ne(ue,pe,me){var Ce,fe,xe,je,Oe=0;if(ue.last_lit!==0)for(;Ce=ue.pending_buf[ue.d_buf+2*Oe]<<8|ue.pending_buf[ue.d_buf+2*Oe+1],fe=ue.pending_buf[ue.l_buf+Oe],Oe++,Ce===0?X(ue,fe,pe):(X(ue,(xe=O[fe])+v+1,pe),(je=P[xe])!==0&&G(ue,fe-=L[xe],je),X(ue,xe=q(--Ce),me),(je=B[xe])!==0&&G(ue,Ce-=S[xe],je)),Oe<ue.last_lit;);X(ue,256,pe)}function ie(ue,pe){var me,Ce,fe,xe=pe.dyn_tree,je=pe.stat_desc.static_tree,Oe=pe.stat_desc.has_stree,Ie=pe.stat_desc.elems,Le=-1;for(ue.heap_len=0,ue.heap_max=573,me=0;me<Ie;me++)xe[2*me]!==0?(ue.heap[++ue.heap_len]=Le=me,ue.depth[me]=0):xe[2*me+1]=0;for(;ue.heap_len<2;)xe[2*(fe=ue.heap[++ue.heap_len]=Le<2?++Le:0)]=1,ue.depth[fe]=0,ue.opt_len--,Oe&&(ue.static_len-=je[2*fe+1]);for(pe.max_code=Le,me=ue.heap_len>>1;1<=me;me--)Q(ue,xe,me);for(fe=Ie;me=ue.heap[1],ue.heap[1]=ue.heap[ue.heap_len--],Q(ue,xe,1),Ce=ue.heap[1],ue.heap[--ue.heap_max]=me,ue.heap[--ue.heap_max]=Ce,xe[2*fe]=xe[2*me]+xe[2*Ce],ue.depth[fe]=(ue.depth[me]>=ue.depth[Ce]?ue.depth[me]:ue.depth[Ce])+1,xe[2*me+1]=xe[2*Ce+1]=fe,ue.heap[1]=fe++,Q(ue,xe,1),2<=ue.heap_len;);ue.heap[--ue.heap_max]=ue.heap[1],(function(He,Qe){var Je,ct,it,At,pt,nt,ht=Qe.dyn_tree,St=Qe.max_code,ot=Qe.stat_desc.static_tree,Bt=Qe.stat_desc.has_stree,Tt=Qe.stat_desc.extra_bits,xt=Qe.stat_desc.extra_base,Kt=Qe.stat_desc.max_length,Pt=0;for(At=0;At<=A;At++)He.bl_count[At]=0;for(ht[2*He.heap[He.heap_max]+1]=0,Je=He.heap_max+1;Je<573;Je++)Kt<(At=ht[2*ht[2*(ct=He.heap[Je])+1]+1]+1)&&(At=Kt,Pt++),ht[2*ct+1]=At,St<ct||(He.bl_count[At]++,pt=0,xt<=ct&&(pt=Tt[ct-xt]),nt=ht[2*ct],He.opt_len+=nt*(At+pt),Bt&&(He.static_len+=nt*(ot[2*ct+1]+pt)));if(Pt!==0){do{for(At=Kt-1;He.bl_count[At]===0;)At--;He.bl_count[At]--,He.bl_count[At+1]+=2,He.bl_count[Kt]--,Pt-=2}while(0<Pt);for(At=Kt;At!==0;At--)for(ct=He.bl_count[At];ct!==0;)St<(it=He.heap[--Je])||(ht[2*it+1]!==At&&(He.opt_len+=(At-ht[2*it+1])*ht[2*it],ht[2*it+1]=At),ct--)}})(ue,pe),V(xe,Le,ue.bl_count)}function ce(ue,pe,me){var Ce,fe,xe=-1,je=pe[1],Oe=0,Ie=7,Le=4;for(je===0&&(Ie=138,Le=3),pe[2*(me+1)+1]=65535,Ce=0;Ce<=me;Ce++)fe=je,je=pe[2*(Ce+1)+1],++Oe<Ie&&fe===je||(Oe<Le?ue.bl_tree[2*fe]+=Oe:fe!==0?(fe!==xe&&ue.bl_tree[2*fe]++,ue.bl_tree[32]++):Oe<=10?ue.bl_tree[34]++:ue.bl_tree[36]++,xe=fe,Le=(Oe=0)===je?(Ie=138,3):fe===je?(Ie=6,3):(Ie=7,4))}function de(ue,pe,me){var Ce,fe,xe=-1,je=pe[1],Oe=0,Ie=7,Le=4;for(je===0&&(Ie=138,Le=3),Ce=0;Ce<=me;Ce++)if(fe=je,je=pe[2*(Ce+1)+1],!(++Oe<Ie&&fe===je)){if(Oe<Le)for(;X(ue,fe,ue.bl_tree),--Oe!=0;);else fe!==0?(fe!==xe&&(X(ue,fe,ue.bl_tree),Oe--),X(ue,16,ue.bl_tree),G(ue,Oe-3,2)):Oe<=10?(X(ue,17,ue.bl_tree),G(ue,Oe-3,3)):(X(ue,18,ue.bl_tree),G(ue,Oe-11,7));xe=fe,Le=(Oe=0)===je?(Ie=138,3):fe===je?(Ie=6,3):(Ie=7,4)}}x(S);var le=!1;function _e(ue,pe,me,Ce){G(ue,0+(Ce?1:0),3),(function(fe,xe,je,Oe){W(fe),M(fe,je),M(fe,~je),m.arraySet(fe.pending_buf,fe.window,xe,je,fe.pending),fe.pending+=je})(ue,pe,me)}g._tr_init=function(ue){le||((function(){var pe,me,Ce,fe,xe,je=new Array(16);for(fe=Ce=0;fe<28;fe++)for(L[fe]=Ce,pe=0;pe<1<<P[fe];pe++)O[Ce++]=fe;for(O[Ce-1]=fe,fe=xe=0;fe<16;fe++)for(S[fe]=xe,pe=0;pe<1<<B[fe];pe++)z[xe++]=fe;for(xe>>=7;fe<_;fe++)for(S[fe]=xe<<7,pe=0;pe<1<<B[fe]-7;pe++)z[256+xe++]=fe;for(me=0;me<=A;me++)je[me]=0;for(pe=0;pe<=143;)U[2*pe+1]=8,pe++,je[8]++;for(;pe<=255;)U[2*pe+1]=9,pe++,je[9]++;for(;pe<=279;)U[2*pe+1]=7,pe++,je[7]++;for(;pe<=287;)U[2*pe+1]=8,pe++,je[8]++;for(V(U,287,je),pe=0;pe<_;pe++)H[2*pe+1]=5,H[2*pe]=re(pe,5);E=new C(U,P,257,w,A),k=new C(H,B,0,_,A),N=new C(new Array(0),T,0,19,7)})(),le=!0),ue.l_desc=new D(ue.dyn_ltree,E),ue.d_desc=new D(ue.dyn_dtree,k),ue.bl_desc=new D(ue.bl_tree,N),ue.bi_buf=0,ue.bi_valid=0,J(ue)},g._tr_stored_block=_e,g._tr_flush_block=function(ue,pe,me,Ce){var fe,xe,je=0;0<ue.level?(ue.strm.data_type===2&&(ue.strm.data_type=(function(Oe){var Ie,Le=4093624447;for(Ie=0;Ie<=31;Ie++,Le>>>=1)if(1&Le&&Oe.dyn_ltree[2*Ie]!==0)return 0;if(Oe.dyn_ltree[18]!==0||Oe.dyn_ltree[20]!==0||Oe.dyn_ltree[26]!==0)return 1;for(Ie=32;Ie<v;Ie++)if(Oe.dyn_ltree[2*Ie]!==0)return 1;return 0})(ue)),ie(ue,ue.l_desc),ie(ue,ue.d_desc),je=(function(Oe){var Ie;for(ce(Oe,Oe.dyn_ltree,Oe.l_desc.max_code),ce(Oe,Oe.dyn_dtree,Oe.d_desc.max_code),ie(Oe,Oe.bl_desc),Ie=18;3<=Ie&&Oe.bl_tree[2*I[Ie]+1]===0;Ie--);return Oe.opt_len+=3*(Ie+1)+5+5+4,Ie})(ue),fe=ue.opt_len+3+7>>>3,(xe=ue.static_len+3+7>>>3)<=fe&&(fe=xe)):fe=xe=me+5,me+4<=fe&&pe!==-1?_e(ue,pe,me,Ce):ue.strategy===4||xe===fe?(G(ue,2+(Ce?1:0),3),ne(ue,U,H)):(G(ue,4+(Ce?1:0),3),(function(Oe,Ie,Le,He){var Qe;for(G(Oe,Ie-257,5),G(Oe,Le-1,5),G(Oe,He-4,4),Qe=0;Qe<He;Qe++)G(Oe,Oe.bl_tree[2*I[Qe]+1],3);de(Oe,Oe.dyn_ltree,Ie-1),de(Oe,Oe.dyn_dtree,Le-1)})(ue,ue.l_desc.max_code+1,ue.d_desc.max_code+1,je+1),ne(ue,ue.dyn_ltree,ue.dyn_dtree)),J(ue),Ce&&W(ue)},g._tr_tally=function(ue,pe,me){return ue.pending_buf[ue.d_buf+2*ue.last_lit]=pe>>>8&255,ue.pending_buf[ue.d_buf+2*ue.last_lit+1]=255&pe,ue.pending_buf[ue.l_buf+ue.last_lit]=255&me,ue.last_lit++,pe===0?ue.dyn_ltree[2*me]++:(ue.matches++,pe--,ue.dyn_ltree[2*(O[me]+v+1)]++,ue.dyn_dtree[2*q(pe)]++),ue.last_lit===ue.lit_bufsize-1},g._tr_align=function(ue){G(ue,2,3),X(ue,256,U),(function(pe){pe.bi_valid===16?(M(pe,pe.bi_buf),pe.bi_buf=0,pe.bi_valid=0):8<=pe.bi_valid&&(pe.pending_buf[pe.pending++]=255&pe.bi_buf,pe.bi_buf>>=8,pe.bi_valid-=8)})(ue)}},{"../utils/common":41}],53:[function(h,y,g){y.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,y,g){(function(m){(function(x,v){if(!x.setImmediate){var w,_,A,P,B=1,T={},I=!1,U=x.document,H=Object.getPrototypeOf&&Object.getPrototypeOf(x);H=H&&H.setTimeout?H:x,w={}.toString.call(x.process)==="[object process]"?function(E){i.nextTick((function(){O(E)}))}:(function(){if(x.postMessage&&!x.importScripts){var E=!0,k=x.onmessage;return x.onmessage=function(){E=!1},x.postMessage("","*"),x.onmessage=k,E}})()?(P="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",L,!1):x.attachEvent("onmessage",L),function(E){x.postMessage(P+E,"*")}):x.MessageChannel?((A=new MessageChannel).port1.onmessage=function(E){O(E.data)},function(E){A.port2.postMessage(E)}):U&&"onreadystatechange"in U.createElement("script")?(_=U.documentElement,function(E){var k=U.createElement("script");k.onreadystatechange=function(){O(E),k.onreadystatechange=null,_.removeChild(k),k=null},_.appendChild(k)}):function(E){setTimeout(O,0,E)},H.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var k=new Array(arguments.length-1),N=0;N<k.length;N++)k[N]=arguments[N+1];var S={callback:E,args:k};return T[B]=S,w(B),B++},H.clearImmediate=z}function z(E){delete T[E]}function O(E){if(I)setTimeout(O,0,E);else{var k=T[E];if(k){I=!0;try{(function(N){var S=N.callback,C=N.args;switch(C.length){case 0:S();break;case 1:S(C[0]);break;case 2:S(C[0],C[1]);break;case 3:S(C[0],C[1],C[2]);break;default:S.apply(void 0,C)}})(k)}finally{z(E),I=!1}}}}function L(E){E.source===x&&typeof E.data=="string"&&E.data.indexOf(P)===0&&O(+E.data.slice(P.length))}})(typeof self>"u"?m===void 0?this:m:self)}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)}))}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],t("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(t,n,a){(function(i){(function(){var o=/[\\^$.*+?()[\]{}|]/g,c=RegExp(o.source),u=typeof i=="object"&&i&&i.Object===Object&&i,l=typeof self=="object"&&self&&self.Object===Object&&self,d=u||l||Function("return this")(),f=Object.prototype.toString,p=d.Symbol,h=p?p.prototype:void 0,y=h?h.toString:void 0;function g(m){if(typeof m=="string")return m;if((function(v){return typeof v=="symbol"||(function(w){return!!w&&typeof w=="object"})(v)&&f.call(v)=="[object Symbol]"})(m))return y?y.call(m):"";var x=m+"";return x=="0"&&1/m==-1/0?"-0":x}n.exports=function(m){var x;return(m=(x=m)==null?"":g(x))&&c.test(m)?m.replace(o,"\\$&"):m}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(t,n,a){(function(i){(function(){var o="[object Arguments]",c="[object Map]",u="[object Object]",l="[object Set]",d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,f=/^\w*$/,p=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,y=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,m=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[o]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x[c]=x["[object Number]"]=x[u]=x["[object RegExp]"]=x[l]=x["[object String]"]=x["[object WeakMap]"]=!1;var v=typeof i=="object"&&i&&i.Object===Object&&i,w=typeof self=="object"&&self&&self.Object===Object&&self,_=v||w||Function("return this")(),A=typeof a=="object"&&a&&!a.nodeType&&a,P=A&&typeof n=="object"&&n&&!n.nodeType&&n,B=P&&P.exports===A&&v.process,T=(function(){try{return B&&B.binding("util")}catch{}})(),I=T&&T.isTypedArray;function U(Ee,ze,dt,mt){for(var Rt=-1,jt=Ee?Ee.length:0;++Rt<jt;){var Ct=Ee[Rt];ze(mt,Ct,dt(Ct),Ee)}return mt}function H(Ee,ze){for(var dt=-1,mt=Ee?Ee.length:0;++dt<mt;)if(ze(Ee[dt],dt,Ee))return!0;return!1}function z(Ee){var ze=!1;if(Ee!=null&&typeof Ee.toString!="function")try{ze=!!(Ee+"")}catch{}return ze}function O(Ee){var ze=-1,dt=Array(Ee.size);return Ee.forEach((function(mt,Rt){dt[++ze]=[Rt,mt]})),dt}function L(Ee){var ze=-1,dt=Array(Ee.size);return Ee.forEach((function(mt){dt[++ze]=mt})),dt}var E,k,N,S=Array.prototype,C=Function.prototype,D=Object.prototype,q=_["__core-js_shared__"],M=(E=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",G=C.toString,X=D.hasOwnProperty,re=D.toString,V=RegExp("^"+G.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),J=_.Symbol,W=_.Uint8Array,F=D.propertyIsEnumerable,Q=S.splice,ne=(k=Object.keys,N=Object,function(Ee){return k(N(Ee))}),ie=Ft(_,"DataView"),ce=Ft(_,"Map"),de=Ft(_,"Promise"),le=Ft(_,"Set"),_e=Ft(_,"WeakMap"),ue=Ft(Object,"create"),pe=Be(ie),me=Be(ce),Ce=Be(de),fe=Be(le),xe=Be(_e),je=J?J.prototype:void 0,Oe=je?je.valueOf:void 0,Ie=je?je.toString:void 0;function Le(Ee){var ze=-1,dt=Ee?Ee.length:0;for(this.clear();++ze<dt;){var mt=Ee[ze];this.set(mt[0],mt[1])}}function He(Ee){var ze=-1,dt=Ee?Ee.length:0;for(this.clear();++ze<dt;){var mt=Ee[ze];this.set(mt[0],mt[1])}}function Qe(Ee){var ze=-1,dt=Ee?Ee.length:0;for(this.clear();++ze<dt;){var mt=Ee[ze];this.set(mt[0],mt[1])}}function Je(Ee){var ze=-1,dt=Ee?Ee.length:0;for(this.__data__=new Qe;++ze<dt;)this.add(Ee[ze])}function ct(Ee){this.__data__=new He(Ee)}function it(Ee,ze){var dt=Ut(Ee)||sr(Ee)?(function(Ct,Dr){for(var wr=-1,yr=Array(Ct);++wr<Ct;)yr[wr]=Dr(wr);return yr})(Ee.length,String):[],mt=dt.length,Rt=!!mt;for(var jt in Ee)!X.call(Ee,jt)||Rt&&(jt=="length"||zr(jt,mt))||dt.push(jt);return dt}function At(Ee,ze){for(var dt=Ee.length;dt--;)if(kt(Ee[dt][0],ze))return dt;return-1}function pt(Ee,ze,dt,mt){return ht(Ee,(function(Rt,jt,Ct){ze(mt,Rt,dt(Rt),Ct)})),mt}Le.prototype.clear=function(){this.__data__=ue?ue(null):{}},Le.prototype.delete=function(Ee){return this.has(Ee)&&delete this.__data__[Ee]},Le.prototype.get=function(Ee){var ze=this.__data__;if(ue){var dt=ze[Ee];return dt==="__lodash_hash_undefined__"?void 0:dt}return X.call(ze,Ee)?ze[Ee]:void 0},Le.prototype.has=function(Ee){var ze=this.__data__;return ue?ze[Ee]!==void 0:X.call(ze,Ee)},Le.prototype.set=function(Ee,ze){return this.__data__[Ee]=ue&&ze===void 0?"__lodash_hash_undefined__":ze,this},He.prototype.clear=function(){this.__data__=[]},He.prototype.delete=function(Ee){var ze=this.__data__,dt=At(ze,Ee);return!(dt<0)&&(dt==ze.length-1?ze.pop():Q.call(ze,dt,1),!0)},He.prototype.get=function(Ee){var ze=this.__data__,dt=At(ze,Ee);return dt<0?void 0:ze[dt][1]},He.prototype.has=function(Ee){return At(this.__data__,Ee)>-1},He.prototype.set=function(Ee,ze){var dt=this.__data__,mt=At(dt,Ee);return mt<0?dt.push([Ee,ze]):dt[mt][1]=ze,this},Qe.prototype.clear=function(){this.__data__={hash:new Le,map:new(ce||He),string:new Le}},Qe.prototype.delete=function(Ee){return qr(this,Ee).delete(Ee)},Qe.prototype.get=function(Ee){return qr(this,Ee).get(Ee)},Qe.prototype.has=function(Ee){return qr(this,Ee).has(Ee)},Qe.prototype.set=function(Ee,ze){return qr(this,Ee).set(Ee,ze),this},Je.prototype.add=Je.prototype.push=function(Ee){return this.__data__.set(Ee,"__lodash_hash_undefined__"),this},Je.prototype.has=function(Ee){return this.__data__.has(Ee)},ct.prototype.clear=function(){this.__data__=new He},ct.prototype.delete=function(Ee){return this.__data__.delete(Ee)},ct.prototype.get=function(Ee){return this.__data__.get(Ee)},ct.prototype.has=function(Ee){return this.__data__.has(Ee)},ct.prototype.set=function(Ee,ze){var dt=this.__data__;if(dt instanceof He){var mt=dt.__data__;if(!ce||mt.length<199)return mt.push([Ee,ze]),this;dt=this.__data__=new Qe(mt)}return dt.set(Ee,ze),this};var nt,ht=(nt=function(Ee,ze){return Ee&&St(Ee,ze,Pn)},function(Ee,ze){if(Ee==null)return Ee;if(!It(Ee))return nt(Ee,ze);for(var dt=Ee.length,mt=-1,Rt=Object(Ee);++mt<dt&&ze(Rt[mt],mt,Rt)!==!1;);return Ee}),St=(function(Ee){return function(ze,dt,mt){for(var Rt=-1,jt=Object(ze),Ct=mt(ze),Dr=Ct.length;Dr--;){var wr=Ct[++Rt];if(dt(jt[wr],wr,jt)===!1)break}return ze}})();function ot(Ee,ze){for(var dt=0,mt=(ze=vt(ze,Ee)?[ze]:wt(ze)).length;Ee!=null&&dt<mt;)Ee=Ee[Me(ze[dt++])];return dt&&dt==mt?Ee:void 0}function Bt(Ee,ze){return Ee!=null&&ze in Object(Ee)}function Tt(Ee,ze,dt,mt,Rt){return Ee===ze||(Ee==null||ze==null||!Nr(Ee)&&!an(ze)?Ee!=Ee&&ze!=ze:(function(jt,Ct,Dr,wr,yr,dr){var br=Ut(jt),Yr=Ut(Ct),ln="[object Array]",Rr="[object Array]";br||(ln=(ln=Er(jt))==o?u:ln),Yr||(Rr=(Rr=Er(Ct))==o?u:Rr);var Fn=ln==u&&!z(jt),_n=Rr==u&&!z(Ct),cs=ln==Rr;if(cs&&!Fn)return dr||(dr=new ct),br||Tn(jt)?ar(jt,Ct,Dr,wr,yr,dr):(function(en,Gr,Ha,fa,Co,Pr,Ca){switch(Ha){case"[object DataView]":if(en.byteLength!=Gr.byteLength||en.byteOffset!=Gr.byteOffset)return!1;en=en.buffer,Gr=Gr.buffer;case"[object ArrayBuffer]":return!(en.byteLength!=Gr.byteLength||!fa(new W(en),new W(Gr)));case"[object Boolean]":case"[object Date]":case"[object Number]":return kt(+en,+Gr);case"[object Error]":return en.name==Gr.name&&en.message==Gr.message;case"[object RegExp]":case"[object String]":return en==Gr+"";case c:var Aa=O;case l:var Ao=2&Pr;if(Aa||(Aa=L),en.size!=Gr.size&&!Ao)return!1;var Pl=Ca.get(en);if(Pl)return Pl==Gr;Pr|=1,Ca.set(en,Gr);var Eo=ar(Aa(en),Aa(Gr),fa,Co,Pr,Ca);return Ca.delete(en),Eo;case"[object Symbol]":if(Oe)return Oe.call(en)==Oe.call(Gr)}return!1})(jt,Ct,ln,Dr,wr,yr,dr);if(!(2&yr)){var ui=Fn&&X.call(jt,"__wrapped__"),Ys=_n&&X.call(Ct,"__wrapped__");if(ui||Ys){var Bn=ui?jt.value():jt,ha=Ys?Ct.value():Ct;return dr||(dr=new ct),Dr(Bn,ha,wr,yr,dr)}}return cs?(dr||(dr=new ct),(function(en,Gr,Ha,fa,Co,Pr){var Ca=2&Co,Aa=Pn(en),Ao=Aa.length,Pl=Pn(Gr).length;if(Ao!=Pl&&!Ca)return!1;for(var Eo=Ao;Eo--;){var di=Aa[Eo];if(!(Ca?di in Gr:X.call(Gr,di)))return!1}var Ol=Pr.get(en);if(Ol&&Pr.get(Gr))return Ol==Gr;var Qs=!0;Pr.set(en,Gr),Pr.set(Gr,en);for(var Ni=Ca;++Eo<Ao;){di=Aa[Eo];var Zs=en[di],Ea=Gr[di];if(fa)var tl=Ca?fa(Ea,Zs,di,Gr,en,Pr):fa(Zs,Ea,di,en,Gr,Pr);if(!(tl===void 0?Zs===Ea||Ha(Zs,Ea,fa,Co,Pr):tl)){Qs=!1;break}Ni||(Ni=di=="constructor")}if(Qs&&!Ni){var xr=en.constructor,hi=Gr.constructor;xr==hi||!("constructor"in en)||!("constructor"in Gr)||typeof xr=="function"&&xr instanceof xr&&typeof hi=="function"&&hi instanceof hi||(Qs=!1)}return Pr.delete(en),Pr.delete(Gr),Qs})(jt,Ct,Dr,wr,yr,dr)):!1})(Ee,ze,Tt,dt,mt,Rt))}function xt(Ee){return!(!Nr(Ee)||(function(ze){return!!M&&M in ze})(Ee))&&(or(Ee)||z(Ee)?V:g).test(Be(Ee))}function Kt(Ee){return typeof Ee=="function"?Ee:Ee==null?js:typeof Ee=="object"?Ut(Ee)?(function(mt,Rt){return vt(mt)&&Tr(Rt)?Wr(Me(mt),Rt):function(jt){var Ct=(function(Dr,wr,yr){var dr=Dr==null?void 0:ot(Dr,wr);return dr===void 0?yr:dr})(jt,mt);return Ct===void 0&&Ct===Rt?(function(Dr,wr){return Dr!=null&&(function(yr,dr,br){dr=vt(dr,yr)?[dr]:wt(dr);for(var Yr,ln=-1,Rr=dr.length;++ln<Rr;){var Fn=Me(dr[ln]);if(!(Yr=yr!=null&&br(yr,Fn)))break;yr=yr[Fn]}return Yr||!!(Rr=yr?yr.length:0)&&Zt(Rr)&&zr(Fn,Rr)&&(Ut(yr)||sr(yr))})(Dr,wr,Bt)})(jt,mt):Tt(Rt,Ct,void 0,3)}})(Ee[0],Ee[1]):(function(mt){var Rt=(function(jt){for(var Ct=Pn(jt),Dr=Ct.length;Dr--;){var wr=Ct[Dr],yr=jt[wr];Ct[Dr]=[wr,yr,Tr(yr)]}return Ct})(mt);return Rt.length==1&&Rt[0][2]?Wr(Rt[0][0],Rt[0][1]):function(jt){return jt===mt||(function(Ct,Dr,wr,yr){var dr=wr.length,br=dr;if(Ct==null)return!br;for(Ct=Object(Ct);dr--;){var Yr=wr[dr];if(Yr[2]?Yr[1]!==Ct[Yr[0]]:!(Yr[0]in Ct))return!1}for(;++dr<br;){var ln=(Yr=wr[dr])[0],Rr=Ct[ln],Fn=Yr[1];if(Yr[2]){if(Rr===void 0&&!(ln in Ct))return!1}else{var _n=new ct,cs;if(!(cs===void 0?Tt(Fn,Rr,yr,3,_n):cs))return!1}}return!0})(jt,mt,Rt)}})(Ee):vt(ze=Ee)?(dt=Me(ze),function(mt){return mt?.[dt]}):(function(mt){return function(Rt){return ot(Rt,mt)}})(ze);var ze,dt}function Pt(Ee){if(dt=(ze=Ee)&&ze.constructor,mt=typeof dt=="function"&&dt.prototype||D,ze!==mt)return ne(Ee);var ze,dt,mt,Rt=[];for(var jt in Object(Ee))X.call(Ee,jt)&&jt!="constructor"&&Rt.push(jt);return Rt}function wt(Ee){return Ut(Ee)?Ee:Qt(Ee)}function ar(Ee,ze,dt,mt,Rt,jt){var Ct=2&Rt,Dr=Ee.length,wr=ze.length;if(Dr!=wr&&!(Ct&&wr>Dr))return!1;var yr=jt.get(Ee);if(yr&&jt.get(ze))return yr==ze;var dr=-1,br=!0,Yr=1&Rt?new Je:void 0;for(jt.set(Ee,ze),jt.set(ze,Ee);++dr<Dr;){var ln=Ee[dr],Rr=ze[dr];if(mt)var Fn=Ct?mt(Rr,ln,dr,ze,Ee,jt):mt(ln,Rr,dr,Ee,ze,jt);if(Fn!==void 0){if(Fn)continue;br=!1;break}if(Yr){if(!H(ze,(function(_n,cs){if(!Yr.has(cs)&&(ln===_n||dt(ln,_n,mt,Rt,jt)))return Yr.add(cs)}))){br=!1;break}}else if(ln!==Rr&&!dt(ln,Rr,mt,Rt,jt)){br=!1;break}}return jt.delete(Ee),jt.delete(ze),br}function qr(Ee,ze){var dt,mt,Rt=Ee.__data__;return((mt=typeof(dt=ze))=="string"||mt=="number"||mt=="symbol"||mt=="boolean"?dt!=="__proto__":dt===null)?Rt[typeof ze=="string"?"string":"hash"]:Rt.map}function Ft(Ee,ze){var dt=(function(mt,Rt){return mt?.[Rt]})(Ee,ze);return xt(dt)?dt:void 0}var Er=function(Ee){return re.call(Ee)};function zr(Ee,ze){return!!(ze=ze??9007199254740991)&&(typeof Ee=="number"||m.test(Ee))&&Ee>-1&&Ee%1==0&&Ee<ze}function vt(Ee,ze){if(Ut(Ee))return!1;var dt=typeof Ee;return!(dt!="number"&&dt!="symbol"&&dt!="boolean"&&Ee!=null&&!Jr(Ee))||f.test(Ee)||!d.test(Ee)||ze!=null&&Ee in Object(ze)}function Tr(Ee){return Ee==Ee&&!Nr(Ee)}function Wr(Ee,ze){return function(dt){return dt!=null&&dt[Ee]===ze&&(ze!==void 0||Ee in Object(dt))}}(ie&&Er(new ie(new ArrayBuffer(1)))!="[object DataView]"||ce&&Er(new ce)!=c||de&&Er(de.resolve())!="[object Promise]"||le&&Er(new le)!=l||_e&&Er(new _e)!="[object WeakMap]")&&(Er=function(Ee){var ze=re.call(Ee),dt=ze==u?Ee.constructor:void 0,mt=dt?Be(dt):void 0;if(mt)switch(mt){case pe:return"[object DataView]";case me:return c;case Ce:return"[object Promise]";case fe:return l;case xe:return"[object WeakMap]"}return ze});var Qt=Gt((function(Ee){var ze;Ee=(ze=Ee)==null?"":(function(mt){if(typeof mt=="string")return mt;if(Jr(mt))return Ie?Ie.call(mt):"";var Rt=mt+"";return Rt=="0"&&1/mt==-1/0?"-0":Rt})(ze);var dt=[];return p.test(Ee)&&dt.push(""),Ee.replace(h,(function(mt,Rt,jt,Ct){dt.push(jt?Ct.replace(y,"$1"):Rt||mt)})),dt}));function Me(Ee){if(typeof Ee=="string"||Jr(Ee))return Ee;var ze=Ee+"";return ze=="0"&&1/Ee==-1/0?"-0":ze}function Be(Ee){if(Ee!=null){try{return G.call(Ee)}catch{}try{return Ee+""}catch{}}return""}var Ze,yt=(Ze=function(Ee,ze,dt){X.call(Ee,dt)?Ee[dt].push(ze):Ee[dt]=[ze]},function(Ee,ze){var dt=Ut(Ee)?U:pt,mt={};return dt(Ee,Ze,Kt(ze),mt)});function Gt(Ee,ze){if(typeof Ee!="function"||ze&&typeof ze!="function")throw new TypeError("Expected a function");var dt=function(){var mt=arguments,Rt=ze?ze.apply(this,mt):mt[0],jt=dt.cache;if(jt.has(Rt))return jt.get(Rt);var Ct=Ee.apply(this,mt);return dt.cache=jt.set(Rt,Ct),Ct};return dt.cache=new(Gt.Cache||Qe),dt}function kt(Ee,ze){return Ee===ze||Ee!=Ee&&ze!=ze}function sr(Ee){return(function(ze){return an(ze)&&It(ze)})(Ee)&&X.call(Ee,"callee")&&(!F.call(Ee,"callee")||re.call(Ee)==o)}Gt.Cache=Qe;var Ut=Array.isArray;function It(Ee){return Ee!=null&&Zt(Ee.length)&&!or(Ee)}function or(Ee){var ze=Nr(Ee)?re.call(Ee):"";return ze=="[object Function]"||ze=="[object GeneratorFunction]"}function Zt(Ee){return typeof Ee=="number"&&Ee>-1&&Ee%1==0&&Ee<=9007199254740991}function Nr(Ee){var ze=typeof Ee;return!!Ee&&(ze=="object"||ze=="function")}function an(Ee){return!!Ee&&typeof Ee=="object"}function Jr(Ee){return typeof Ee=="symbol"||an(Ee)&&re.call(Ee)=="[object Symbol]"}var Tn=I?(function(Ee){return function(ze){return Ee(ze)}})(I):function(Ee){return an(Ee)&&Zt(Ee.length)&&!!x[re.call(Ee)]};function Pn(Ee){return It(Ee)?it(Ee):Pt(Ee)}function js(Ee){return Ee}n.exports=yt}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(t,n,a){var i=Object.prototype.toString;n.exports=function(o){return o===!0||o===!1||(function(c){return!!c&&typeof c=="object"})(o)&&i.call(o)=="[object Boolean]"}},{}],445:[function(t,n,a){(function(i){(function(){var o="[object Arguments]",c="[object Map]",u="[object Object]",l="[object Set]",d=/^\[object .+?Constructor\]$/,f=/^(?:0|[1-9]\d*)$/,p={};p["[object Float32Array]"]=p["[object Float64Array]"]=p["[object Int8Array]"]=p["[object Int16Array]"]=p["[object Int32Array]"]=p["[object Uint8Array]"]=p["[object Uint8ClampedArray]"]=p["[object Uint16Array]"]=p["[object Uint32Array]"]=!0,p[o]=p["[object Array]"]=p["[object ArrayBuffer]"]=p["[object Boolean]"]=p["[object DataView]"]=p["[object Date]"]=p["[object Error]"]=p["[object Function]"]=p[c]=p["[object Number]"]=p[u]=p["[object RegExp]"]=p[l]=p["[object String]"]=p["[object WeakMap]"]=!1;var h=typeof i=="object"&&i&&i.Object===Object&&i,y=typeof self=="object"&&self&&self.Object===Object&&self,g=h||y||Function("return this")(),m=typeof a=="object"&&a&&!a.nodeType&&a,x=m&&typeof n=="object"&&n&&!n.nodeType&&n,v=x&&x.exports===m,w=v&&h.process,_=(function(){try{return w&&w.binding&&w.binding("util")}catch{}})(),A=_&&_.isTypedArray;function P(Me,Be){for(var Ze=-1,yt=Me==null?0:Me.length;++Ze<yt;)if(Be(Me[Ze],Ze,Me))return!0;return!1}function B(Me){var Be=-1,Ze=Array(Me.size);return Me.forEach((function(yt,Gt){Ze[++Be]=[Gt,yt]})),Ze}function T(Me){var Be=-1,Ze=Array(Me.size);return Me.forEach((function(yt){Ze[++Be]=yt})),Ze}var I,U,H,z=Array.prototype,O=Function.prototype,L=Object.prototype,E=g["__core-js_shared__"],k=O.toString,N=L.hasOwnProperty,S=(I=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"",C=L.toString,D=RegExp("^"+k.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),q=v?g.Buffer:void 0,M=g.Symbol,G=g.Uint8Array,X=L.propertyIsEnumerable,re=z.splice,V=M?M.toStringTag:void 0,J=Object.getOwnPropertySymbols,W=q?q.isBuffer:void 0,F=(U=Object.keys,H=Object,function(Me){return U(H(Me))}),Q=Bt(g,"DataView"),ne=Bt(g,"Map"),ie=Bt(g,"Promise"),ce=Bt(g,"Set"),de=Bt(g,"WeakMap"),le=Bt(Object,"create"),_e=Pt(Q),ue=Pt(ne),pe=Pt(ie),me=Pt(ce),Ce=Pt(de),fe=M?M.prototype:void 0,xe=fe?fe.valueOf:void 0;function je(Me){var Be=-1,Ze=Me==null?0:Me.length;for(this.clear();++Be<Ze;){var yt=Me[Be];this.set(yt[0],yt[1])}}function Oe(Me){var Be=-1,Ze=Me==null?0:Me.length;for(this.clear();++Be<Ze;){var yt=Me[Be];this.set(yt[0],yt[1])}}function Ie(Me){var Be=-1,Ze=Me==null?0:Me.length;for(this.clear();++Be<Ze;){var yt=Me[Be];this.set(yt[0],yt[1])}}function Le(Me){var Be=-1,Ze=Me==null?0:Me.length;for(this.__data__=new Ie;++Be<Ze;)this.add(Me[Be])}function He(Me){var Be=this.__data__=new Oe(Me);this.size=Be.size}function Qe(Me,Be){var Ze=qr(Me),yt=!Ze&&ar(Me),Gt=!Ze&&!yt&&Ft(Me),kt=!Ze&&!yt&&!Gt&&Wr(Me),sr=Ze||yt||Gt||kt,Ut=sr?(function(Zt,Nr){for(var an=-1,Jr=Array(Zt);++an<Zt;)Jr[an]=Nr(an);return Jr})(Me.length,String):[],It=Ut.length;for(var or in Me)!N.call(Me,or)||sr&&(or=="length"||Gt&&(or=="offset"||or=="parent")||kt&&(or=="buffer"||or=="byteLength"||or=="byteOffset")||Kt(or,It))||Ut.push(or);return Ut}function Je(Me,Be){for(var Ze=Me.length;Ze--;)if(wt(Me[Ze][0],Be))return Ze;return-1}function ct(Me){return Me==null?Me===void 0?"[object Undefined]":"[object Null]":V&&V in Object(Me)?(function(Be){var Ze=N.call(Be,V),yt=Be[V];try{Be[V]=void 0;var Gt=!0}catch{}var kt=C.call(Be);return Gt&&(Ze?Be[V]=yt:delete Be[V]),kt})(Me):(function(Be){return C.call(Be)})(Me)}function it(Me){return Tr(Me)&&ct(Me)==o}function At(Me,Be,Ze,yt,Gt){return Me===Be||(Me==null||Be==null||!Tr(Me)&&!Tr(Be)?Me!=Me&&Be!=Be:(function(kt,sr,Ut,It,or,Zt){var Nr=qr(kt),an=qr(sr),Jr=Nr?"[object Array]":xt(kt),Tn=an?"[object Array]":xt(sr),Pn=(Jr=Jr==o?u:Jr)==u,js=(Tn=Tn==o?u:Tn)==u,Ee=Jr==Tn;if(Ee&&Ft(kt)){if(!Ft(sr))return!1;Nr=!0,Pn=!1}if(Ee&&!Pn)return Zt||(Zt=new He),Nr||Wr(kt)?ht(kt,sr,Ut,It,or,Zt):(function(jt,Ct,Dr,wr,yr,dr,br){switch(Dr){case"[object DataView]":if(jt.byteLength!=Ct.byteLength||jt.byteOffset!=Ct.byteOffset)return!1;jt=jt.buffer,Ct=Ct.buffer;case"[object ArrayBuffer]":return!(jt.byteLength!=Ct.byteLength||!dr(new G(jt),new G(Ct)));case"[object Boolean]":case"[object Date]":case"[object Number]":return wt(+jt,+Ct);case"[object Error]":return jt.name==Ct.name&&jt.message==Ct.message;case"[object RegExp]":case"[object String]":return jt==Ct+"";case c:var Yr=B;case l:var ln=1&wr;if(Yr||(Yr=T),jt.size!=Ct.size&&!ln)return!1;var Rr=br.get(jt);if(Rr)return Rr==Ct;wr|=2,br.set(jt,Ct);var Fn=ht(Yr(jt),Yr(Ct),wr,yr,dr,br);return br.delete(jt),Fn;case"[object Symbol]":if(xe)return xe.call(jt)==xe.call(Ct)}return!1})(kt,sr,Jr,Ut,It,or,Zt);if(!(1&Ut)){var ze=Pn&&N.call(kt,"__wrapped__"),dt=js&&N.call(sr,"__wrapped__");if(ze||dt){var mt=ze?kt.value():kt,Rt=dt?sr.value():sr;return Zt||(Zt=new He),or(mt,Rt,Ut,It,Zt)}}return Ee?(Zt||(Zt=new He),(function(jt,Ct,Dr,wr,yr,dr){var br=1&Dr,Yr=St(jt),ln=Yr.length,Rr=St(Ct).length;if(ln!=Rr&&!br)return!1;for(var Fn=ln;Fn--;){var _n=Yr[Fn];if(!(br?_n in Ct:N.call(Ct,_n)))return!1}var cs=dr.get(jt);if(cs&&dr.get(Ct))return cs==Ct;var ui=!0;dr.set(jt,Ct),dr.set(Ct,jt);for(var Ys=br;++Fn<ln;){_n=Yr[Fn];var Bn=jt[_n],ha=Ct[_n];if(wr)var en=br?wr(ha,Bn,_n,Ct,jt,dr):wr(Bn,ha,_n,jt,Ct,dr);if(!(en===void 0?Bn===ha||yr(Bn,ha,Dr,wr,dr):en)){ui=!1;break}Ys||(Ys=_n=="constructor")}if(ui&&!Ys){var Gr=jt.constructor,Ha=Ct.constructor;Gr==Ha||!("constructor"in jt)||!("constructor"in Ct)||typeof Gr=="function"&&Gr instanceof Gr&&typeof Ha=="function"&&Ha instanceof Ha||(ui=!1)}return dr.delete(jt),dr.delete(Ct),ui})(kt,sr,Ut,It,or,Zt)):!1})(Me,Be,Ze,yt,At,Gt))}function pt(Me){return!(!vt(Me)||(function(Be){return!!S&&S in Be})(Me))&&(Er(Me)?D:d).test(Pt(Me))}function nt(Me){if(Ze=(Be=Me)&&Be.constructor,yt=typeof Ze=="function"&&Ze.prototype||L,Be!==yt)return F(Me);var Be,Ze,yt,Gt=[];for(var kt in Object(Me))N.call(Me,kt)&&kt!="constructor"&&Gt.push(kt);return Gt}function ht(Me,Be,Ze,yt,Gt,kt){var sr=1&Ze,Ut=Me.length,It=Be.length;if(Ut!=It&&!(sr&&It>Ut))return!1;var or=kt.get(Me);if(or&&kt.get(Be))return or==Be;var Zt=-1,Nr=!0,an=2&Ze?new Le:void 0;for(kt.set(Me,Be),kt.set(Be,Me);++Zt<Ut;){var Jr=Me[Zt],Tn=Be[Zt];if(yt)var Pn=sr?yt(Tn,Jr,Zt,Be,Me,kt):yt(Jr,Tn,Zt,Me,Be,kt);if(Pn!==void 0){if(Pn)continue;Nr=!1;break}if(an){if(!P(Be,(function(js,Ee){if(ze=Ee,!an.has(ze)&&(Jr===js||Gt(Jr,js,Ze,yt,kt)))return an.push(Ee);var ze}))){Nr=!1;break}}else if(Jr!==Tn&&!Gt(Jr,Tn,Ze,yt,kt)){Nr=!1;break}}return kt.delete(Me),kt.delete(Be),Nr}function St(Me){return(function(Be,Ze,yt){var Gt=Ze(Be);return qr(Be)?Gt:(function(kt,sr){for(var Ut=-1,It=sr.length,or=kt.length;++Ut<It;)kt[or+Ut]=sr[Ut];return kt})(Gt,yt(Be))})(Me,Qt,Tt)}function ot(Me,Be){var Ze,yt,Gt=Me.__data__;return((yt=typeof(Ze=Be))=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?Ze!=="__proto__":Ze===null)?Gt[typeof Be=="string"?"string":"hash"]:Gt.map}function Bt(Me,Be){var Ze=(function(yt,Gt){return yt?.[Gt]})(Me,Be);return pt(Ze)?Ze:void 0}je.prototype.clear=function(){this.__data__=le?le(null):{},this.size=0},je.prototype.delete=function(Me){var Be=this.has(Me)&&delete this.__data__[Me];return this.size-=Be?1:0,Be},je.prototype.get=function(Me){var Be=this.__data__;if(le){var Ze=Be[Me];return Ze==="__lodash_hash_undefined__"?void 0:Ze}return N.call(Be,Me)?Be[Me]:void 0},je.prototype.has=function(Me){var Be=this.__data__;return le?Be[Me]!==void 0:N.call(Be,Me)},je.prototype.set=function(Me,Be){var Ze=this.__data__;return this.size+=this.has(Me)?0:1,Ze[Me]=le&&Be===void 0?"__lodash_hash_undefined__":Be,this},Oe.prototype.clear=function(){this.__data__=[],this.size=0},Oe.prototype.delete=function(Me){var Be=this.__data__,Ze=Je(Be,Me);return!(Ze<0)&&(Ze==Be.length-1?Be.pop():re.call(Be,Ze,1),--this.size,!0)},Oe.prototype.get=function(Me){var Be=this.__data__,Ze=Je(Be,Me);return Ze<0?void 0:Be[Ze][1]},Oe.prototype.has=function(Me){return Je(this.__data__,Me)>-1},Oe.prototype.set=function(Me,Be){var Ze=this.__data__,yt=Je(Ze,Me);return yt<0?(++this.size,Ze.push([Me,Be])):Ze[yt][1]=Be,this},Ie.prototype.clear=function(){this.size=0,this.__data__={hash:new je,map:new(ne||Oe),string:new je}},Ie.prototype.delete=function(Me){var Be=ot(this,Me).delete(Me);return this.size-=Be?1:0,Be},Ie.prototype.get=function(Me){return ot(this,Me).get(Me)},Ie.prototype.has=function(Me){return ot(this,Me).has(Me)},Ie.prototype.set=function(Me,Be){var Ze=ot(this,Me),yt=Ze.size;return Ze.set(Me,Be),this.size+=Ze.size==yt?0:1,this},Le.prototype.add=Le.prototype.push=function(Me){return this.__data__.set(Me,"__lodash_hash_undefined__"),this},Le.prototype.has=function(Me){return this.__data__.has(Me)},He.prototype.clear=function(){this.__data__=new Oe,this.size=0},He.prototype.delete=function(Me){var Be=this.__data__,Ze=Be.delete(Me);return this.size=Be.size,Ze},He.prototype.get=function(Me){return this.__data__.get(Me)},He.prototype.has=function(Me){return this.__data__.has(Me)},He.prototype.set=function(Me,Be){var Ze=this.__data__;if(Ze instanceof Oe){var yt=Ze.__data__;if(!ne||yt.length<199)return yt.push([Me,Be]),this.size=++Ze.size,this;Ze=this.__data__=new Ie(yt)}return Ze.set(Me,Be),this.size=Ze.size,this};var Tt=J?function(Me){return Me==null?[]:(Me=Object(Me),(function(Be,Ze){for(var yt=-1,Gt=Be==null?0:Be.length,kt=0,sr=[];++yt<Gt;){var Ut=Be[yt];Ze(Ut,yt,Be)&&(sr[kt++]=Ut)}return sr})(J(Me),(function(Be){return X.call(Me,Be)})))}:function(){return[]},xt=ct;function Kt(Me,Be){return!!(Be=Be??9007199254740991)&&(typeof Me=="number"||f.test(Me))&&Me>-1&&Me%1==0&&Me<Be}function Pt(Me){if(Me!=null){try{return k.call(Me)}catch{}try{return Me+""}catch{}}return""}function wt(Me,Be){return Me===Be||Me!=Me&&Be!=Be}(Q&&xt(new Q(new ArrayBuffer(1)))!="[object DataView]"||ne&&xt(new ne)!=c||ie&&xt(ie.resolve())!="[object Promise]"||ce&&xt(new ce)!=l||de&&xt(new de)!="[object WeakMap]")&&(xt=function(Me){var Be=ct(Me),Ze=Be==u?Me.constructor:void 0,yt=Ze?Pt(Ze):"";if(yt)switch(yt){case _e:return"[object DataView]";case ue:return c;case pe:return"[object Promise]";case me:return l;case Ce:return"[object WeakMap]"}return Be});var ar=it((function(){return arguments})())?it:function(Me){return Tr(Me)&&N.call(Me,"callee")&&!X.call(Me,"callee")},qr=Array.isArray,Ft=W||function(){return!1};function Er(Me){if(!vt(Me))return!1;var Be=ct(Me);return Be=="[object Function]"||Be=="[object GeneratorFunction]"||Be=="[object AsyncFunction]"||Be=="[object Proxy]"}function zr(Me){return typeof Me=="number"&&Me>-1&&Me%1==0&&Me<=9007199254740991}function vt(Me){var Be=typeof Me;return Me!=null&&(Be=="object"||Be=="function")}function Tr(Me){return Me!=null&&typeof Me=="object"}var Wr=A?(function(Me){return function(Be){return Me(Be)}})(A):function(Me){return Tr(Me)&&zr(Me.length)&&!!p[ct(Me)]};function Qt(Me){return(Be=Me)!=null&&zr(Be.length)&&!Er(Be)?Qe(Me):nt(Me);var Be}n.exports=function(Me,Be){return At(Me,Be)}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(t,n,a){(function(i){(function(){var o=typeof i=="object"&&i&&i.Object===Object&&i,c=typeof self=="object"&&self&&self.Object===Object&&self,u=o||c||Function("return this")(),l=Object.prototype,d=l.hasOwnProperty,f=l.toString,p=u.Symbol,h=p?p.toStringTag:void 0;function y(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":h&&h in Object(g)?(function(m){var x=d.call(m,h),v=m[h];try{m[h]=void 0;var w=!0}catch{}var _=f.call(m);return w&&(x?m[h]=v:delete m[h]),_})(g):(function(m){return f.call(m)})(g)}n.exports=function(g){if(!(function(x){var v=typeof x;return x!=null&&(v=="object"||v=="function")})(g))return!1;var m=y(g);return m=="[object Function]"||m=="[object GeneratorFunction]"||m=="[object AsyncFunction]"||m=="[object Proxy]"}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(t,n,a){n.exports=function(i){return i==null}},{}],448:[function(t,n,a){n.exports=function(i){return i===void 0}},{}],449:[function(t,n,a){(function(i){(function(){var o=/^\[object .+?Constructor\]$/,c=typeof i=="object"&&i&&i.Object===Object&&i,u=typeof self=="object"&&self&&self.Object===Object&&self,l=c||u||Function("return this")();function d(M,G){return!!(M&&M.length)&&(function(X,re,V){if(re!=re)return(function(F,Q,ne,ie){for(var ce=F.length,de=ne+-1;++de<ce;)if(Q(F[de],de,F))return de;return-1})(X,f,V);for(var J=V-1,W=X.length;++J<W;)if(X[J]===re)return J;return-1})(M,G,0)>-1}function f(M){return M!=M}function p(M,G){return M.has(G)}function h(M){var G=-1,X=Array(M.size);return M.forEach((function(re){X[++G]=re})),X}var y,g=Array.prototype,m=Function.prototype,x=Object.prototype,v=l["__core-js_shared__"],w=(y=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||""))?"Symbol(src)_1."+y:"",_=m.toString,A=x.hasOwnProperty,P=x.toString,B=RegExp("^"+_.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),T=g.splice,I=D(l,"Map"),U=D(l,"Set"),H=D(Object,"create");function z(M){var G=-1,X=M?M.length:0;for(this.clear();++G<X;){var re=M[G];this.set(re[0],re[1])}}function O(M){var G=-1,X=M?M.length:0;for(this.clear();++G<X;){var re=M[G];this.set(re[0],re[1])}}function L(M){var G=-1,X=M?M.length:0;for(this.clear();++G<X;){var re=M[G];this.set(re[0],re[1])}}function E(M){var G=-1,X=M?M.length:0;for(this.__data__=new L;++G<X;)this.add(M[G])}function k(M,G){for(var X,re,V=M.length;V--;)if((X=M[V][0])===(re=G)||X!=X&&re!=re)return V;return-1}function N(M){return!(!q(M)||(G=M,w&&w in G))&&((function(X){var re=q(X)?P.call(X):"";return re=="[object Function]"||re=="[object GeneratorFunction]"})(M)||(function(X){var re=!1;if(X!=null&&typeof X.toString!="function")try{re=!!(X+"")}catch{}return re})(M)?B:o).test((function(X){if(X!=null){try{return _.call(X)}catch{}try{return X+""}catch{}}return""})(M));var G}z.prototype.clear=function(){this.__data__=H?H(null):{}},z.prototype.delete=function(M){return this.has(M)&&delete this.__data__[M]},z.prototype.get=function(M){var G=this.__data__;if(H){var X=G[M];return X==="__lodash_hash_undefined__"?void 0:X}return A.call(G,M)?G[M]:void 0},z.prototype.has=function(M){var G=this.__data__;return H?G[M]!==void 0:A.call(G,M)},z.prototype.set=function(M,G){return this.__data__[M]=H&&G===void 0?"__lodash_hash_undefined__":G,this},O.prototype.clear=function(){this.__data__=[]},O.prototype.delete=function(M){var G=this.__data__,X=k(G,M);return!(X<0)&&(X==G.length-1?G.pop():T.call(G,X,1),!0)},O.prototype.get=function(M){var G=this.__data__,X=k(G,M);return X<0?void 0:G[X][1]},O.prototype.has=function(M){return k(this.__data__,M)>-1},O.prototype.set=function(M,G){var X=this.__data__,re=k(X,M);return re<0?X.push([M,G]):X[re][1]=G,this},L.prototype.clear=function(){this.__data__={hash:new z,map:new(I||O),string:new z}},L.prototype.delete=function(M){return C(this,M).delete(M)},L.prototype.get=function(M){return C(this,M).get(M)},L.prototype.has=function(M){return C(this,M).has(M)},L.prototype.set=function(M,G){return C(this,M).set(M,G),this},E.prototype.add=E.prototype.push=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this},E.prototype.has=function(M){return this.__data__.has(M)};var S=U&&1/h(new U([,-0]))[1]==1/0?function(M){return new U(M)}:function(){};function C(M,G){var X,re,V=M.__data__;return((re=typeof(X=G))=="string"||re=="number"||re=="symbol"||re=="boolean"?X!=="__proto__":X===null)?V[typeof G=="string"?"string":"hash"]:V.map}function D(M,G){var X=(function(re,V){return re?.[V]})(M,G);return N(X)?X:void 0}function q(M){var G=typeof M;return!!M&&(G=="object"||G=="function")}n.exports=function(M){return M&&M.length?(function(G,X,re){var V=-1,J=d,W=G.length,F=!0,Q=[],ne=Q;if(W>=200){var ie=S(G);if(ie)return h(ie);F=!1,J=p,ne=new E}else ne=Q;e:for(;++V<W;){var ce=G[V],de=ce;if(ce=ce!==0?ce:0,F&&de==de){for(var le=ne.length;le--;)if(ne[le]===de)continue e;Q.push(ce)}else J(ne,de,re)||(ne!==Q&&ne.push(de),Q.push(ce))}return Q})(M):[]}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(t,n,a){var i=t("inherits"),o=t("hash-base"),c=t("safe-buffer").Buffer,u=new Array(16);function l(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function d(g,m){return g<<m|g>>>32-m}function f(g,m,x,v,w,_,A){return d(g+(m&x|~m&v)+w+_|0,A)+m|0}function p(g,m,x,v,w,_,A){return d(g+(m&v|x&~v)+w+_|0,A)+m|0}function h(g,m,x,v,w,_,A){return d(g+(m^x^v)+w+_|0,A)+m|0}function y(g,m,x,v,w,_,A){return d(g+(x^(m|~v))+w+_|0,A)+m|0}i(l,o),l.prototype._update=function(){for(var g=u,m=0;m<16;++m)g[m]=this._block.readInt32LE(4*m);var x=this._a,v=this._b,w=this._c,_=this._d;x=f(x,v,w,_,g[0],3614090360,7),_=f(_,x,v,w,g[1],3905402710,12),w=f(w,_,x,v,g[2],606105819,17),v=f(v,w,_,x,g[3],3250441966,22),x=f(x,v,w,_,g[4],4118548399,7),_=f(_,x,v,w,g[5],1200080426,12),w=f(w,_,x,v,g[6],2821735955,17),v=f(v,w,_,x,g[7],4249261313,22),x=f(x,v,w,_,g[8],1770035416,7),_=f(_,x,v,w,g[9],2336552879,12),w=f(w,_,x,v,g[10],4294925233,17),v=f(v,w,_,x,g[11],2304563134,22),x=f(x,v,w,_,g[12],1804603682,7),_=f(_,x,v,w,g[13],4254626195,12),w=f(w,_,x,v,g[14],2792965006,17),x=p(x,v=f(v,w,_,x,g[15],1236535329,22),w,_,g[1],4129170786,5),_=p(_,x,v,w,g[6],3225465664,9),w=p(w,_,x,v,g[11],643717713,14),v=p(v,w,_,x,g[0],3921069994,20),x=p(x,v,w,_,g[5],3593408605,5),_=p(_,x,v,w,g[10],38016083,9),w=p(w,_,x,v,g[15],3634488961,14),v=p(v,w,_,x,g[4],3889429448,20),x=p(x,v,w,_,g[9],568446438,5),_=p(_,x,v,w,g[14],3275163606,9),w=p(w,_,x,v,g[3],4107603335,14),v=p(v,w,_,x,g[8],1163531501,20),x=p(x,v,w,_,g[13],2850285829,5),_=p(_,x,v,w,g[2],4243563512,9),w=p(w,_,x,v,g[7],1735328473,14),x=h(x,v=p(v,w,_,x,g[12],2368359562,20),w,_,g[5],4294588738,4),_=h(_,x,v,w,g[8],2272392833,11),w=h(w,_,x,v,g[11],1839030562,16),v=h(v,w,_,x,g[14],4259657740,23),x=h(x,v,w,_,g[1],2763975236,4),_=h(_,x,v,w,g[4],1272893353,11),w=h(w,_,x,v,g[7],4139469664,16),v=h(v,w,_,x,g[10],3200236656,23),x=h(x,v,w,_,g[13],681279174,4),_=h(_,x,v,w,g[0],3936430074,11),w=h(w,_,x,v,g[3],3572445317,16),v=h(v,w,_,x,g[6],76029189,23),x=h(x,v,w,_,g[9],3654602809,4),_=h(_,x,v,w,g[12],3873151461,11),w=h(w,_,x,v,g[15],530742520,16),x=y(x,v=h(v,w,_,x,g[2],3299628645,23),w,_,g[0],4096336452,6),_=y(_,x,v,w,g[7],1126891415,10),w=y(w,_,x,v,g[14],2878612391,15),v=y(v,w,_,x,g[5],4237533241,21),x=y(x,v,w,_,g[12],1700485571,6),_=y(_,x,v,w,g[3],2399980690,10),w=y(w,_,x,v,g[10],4293915773,15),v=y(v,w,_,x,g[1],2240044497,21),x=y(x,v,w,_,g[8],1873313359,6),_=y(_,x,v,w,g[15],4264355552,10),w=y(w,_,x,v,g[6],2734768916,15),v=y(v,w,_,x,g[13],1309151649,21),x=y(x,v,w,_,g[4],4149444226,6),_=y(_,x,v,w,g[11],3174756917,10),w=y(w,_,x,v,g[2],718787259,15),v=y(v,w,_,x,g[9],3951481745,21),this._a=this._a+x|0,this._b=this._b+v|0,this._c=this._c+w|0,this._d=this._d+_|0},l.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var g=c.allocUnsafe(16);return g.writeInt32LE(this._a,0),g.writeInt32LE(this._b,4),g.writeInt32LE(this._c,8),g.writeInt32LE(this._d,12),g},n.exports=l},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(t,n,a){var i=t("bn.js"),o=t("brorand");function c(u){this.rand=u||new o.Rand}n.exports=c,c.create=function(u){return new c(u)},c.prototype._randbelow=function(u){var l=u.bitLength(),d=Math.ceil(l/8);do var f=new i(this.rand.generate(d));while(f.cmp(u)>=0);return f},c.prototype._randrange=function(u,l){var d=l.sub(u);return u.add(this._randbelow(d))},c.prototype.test=function(u,l,d){var f=u.bitLength(),p=i.mont(u),h=new i(1).toRed(p);l||(l=Math.max(1,f/48|0));for(var y=u.subn(1),g=0;!y.testn(g);g++);for(var m=u.shrn(g),x=y.toRed(p);l>0;l--){var v=this._randrange(new i(2),y);d&&d(v);var w=v.toRed(p).redPow(m);if(w.cmp(h)!==0&&w.cmp(x)!==0){for(var _=1;_<g;_++){if((w=w.redSqr()).cmp(h)===0)return!1;if(w.cmp(x)===0)break}if(_===g)return!1}}return!0},c.prototype.getDivisor=function(u,l){var d=u.bitLength(),f=i.mont(u),p=new i(1).toRed(f);l||(l=Math.max(1,d/48|0));for(var h=u.subn(1),y=0;!h.testn(y);y++);for(var g=u.shrn(y),m=h.toRed(f);l>0;l--){var x=this._randrange(new i(2),h),v=u.gcd(x);if(v.cmpn(1)!==0)return v;var w=x.toRed(f).redPow(g);if(w.cmp(p)!==0&&w.cmp(m)!==0){for(var _=1;_<y;_++){if((w=w.redSqr()).cmp(p)===0)return w.fromRed().subn(1).gcd(u);if(w.cmp(m)===0)break}if(_===y)return(w=w.redSqr()).fromRed().subn(1).gcd(u)}}return!1}},{"bn.js":452,brorand:187}],452:[function(t,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],453:[function(t,n,a){function i(o,c){if(!o)throw new Error(c||"Assertion failed")}n.exports=i,i.equal=function(o,c,u){if(o!=c)throw new Error(u||"Assertion failed: "+o+" != "+c)}},{}],454:[function(t,n,a){var i=a;function o(u){return u.length===1?"0"+u:u}function c(u){for(var l="",d=0;d<u.length;d++)l+=o(u[d].toString(16));return l}i.toArray=function(u,l){if(Array.isArray(u))return u.slice();if(!u)return[];var d=[];if(typeof u!="string"){for(var f=0;f<u.length;f++)d[f]=0|u[f];return d}if(l==="hex")for((u=u.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(u="0"+u),f=0;f<u.length;f+=2)d.push(parseInt(u[f]+u[f+1],16));else for(f=0;f<u.length;f++){var p=u.charCodeAt(f),h=p>>8,y=255&p;h?d.push(h,y):d.push(y)}return d},i.zero2=o,i.toHex=c,i.encode=function(u,l){return l==="hex"?c(u):u}},{}],455:[function(t,n,a){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(t,n,a){var i=t("asn1.js");a.certificate=t("./certificate");var o=i.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));a.RSAPrivateKey=o;var c=i.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));a.RSAPublicKey=c;var u=i.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())}));a.PublicKey=u;var l=i.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),d=i.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(l),this.key("subjectPrivateKey").octstr())}));a.PrivateKey=d;var f=i.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));a.EncryptedPrivateKey=f;var p=i.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));a.DSAPrivateKey=p,a.DSAparam=i.define("DSAparam",(function(){this.int()}));var h=i.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(y),this.key("publicKey").optional().explicit(1).bitstr())}));a.ECPrivateKey=h;var y=i.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));a.signature=i.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":457,"asn1.js":170}],457:[function(t,n,a){var i=t("asn1.js"),o=i.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),c=i.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),u=i.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),l=i.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())})),d=i.define("RelativeDistinguishedName",(function(){this.setof(c)})),f=i.define("RDNSequence",(function(){this.seqof(d)})),p=i.define("Name",(function(){this.choice({rdnSequence:this.use(f)})})),h=i.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))})),y=i.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),g=i.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(u),this.key("issuer").use(p),this.key("validity").use(h),this.key("subject").use(p),this.key("subjectPublicKeyInfo").use(l),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(y).optional())})),m=i.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(g),this.key("signatureAlgorithm").use(u),this.key("signatureValue").bitstr())}));n.exports=m},{"asn1.js":170}],458:[function(t,n,a){var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,c=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,u=t("evp_bytestokey"),l=t("browserify-aes"),d=t("safe-buffer").Buffer;n.exports=function(f,p){var h,y=f.toString(),g=y.match(i);if(g){var m="aes"+g[1],x=d.from(g[2],"hex"),v=d.from(g[3].replace(/[\r\n]/g,""),"base64"),w=u(p,x.slice(0,8),parseInt(g[1],10)).key,_=[],A=l.createDecipheriv(m,w,x);_.push(A.update(v)),_.push(A.final()),h=d.concat(_)}else{var P=y.match(c);h=d.from(P[2].replace(/[\r\n]/g,""),"base64")}return{tag:y.match(o)[1],data:h}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(t,n,a){var i=t("./asn1"),o=t("./aesid.json"),c=t("./fixProc"),u=t("browserify-aes"),l=t("pbkdf2"),d=t("safe-buffer").Buffer;function f(p){var h;typeof p!="object"||d.isBuffer(p)||(h=p.passphrase,p=p.key),typeof p=="string"&&(p=d.from(p));var y,g,m=c(p,h),x=m.tag,v=m.data;switch(x){case"CERTIFICATE":g=i.certificate.decode(v,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(g||(g=i.PublicKey.decode(v,"der")),y=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=i.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+y)}case"ENCRYPTED PRIVATE KEY":v=(function(w,_){var A=w.algorithm.decrypt.kde.kdeparams.salt,P=parseInt(w.algorithm.decrypt.kde.kdeparams.iters.toString(),10),B=o[w.algorithm.decrypt.cipher.algo.join(".")],T=w.algorithm.decrypt.cipher.iv,I=w.subjectPrivateKey,U=parseInt(B.split("-")[1],10)/8,H=l.pbkdf2Sync(_,A,P,U,"sha1"),z=u.createDecipheriv(B,H,T),O=[];return O.push(z.update(I)),O.push(z.final()),d.concat(O)})(v=i.EncryptedPrivateKey.decode(v,"der"),h);case"PRIVATE KEY":switch(y=(g=i.PrivateKey.decode(v,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:i.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=i.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+y)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(v,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(v,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(v,"der")};case"EC PRIVATE KEY":return{curve:(v=i.ECPrivateKey.decode(v,"der")).parameters.value,privateKey:v.privateKey};default:throw new Error("unknown key type "+x)}}n.exports=f,f.signature=i.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(t,n,a){a.pbkdf2=t("./lib/async"),a.pbkdf2Sync=t("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(t,n,a){(function(i){(function(){var o,c,u=t("safe-buffer").Buffer,l=t("./precondition"),d=t("./default-encoding"),f=t("./sync"),p=t("./to-buffer"),h=i.crypto&&i.crypto.subtle,y={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},g=[];function m(){return c||(c=i.process&&i.process.nextTick?i.process.nextTick:i.queueMicrotask?i.queueMicrotask:i.setImmediate?i.setImmediate:i.setTimeout)}function x(v,w,_,A,P){return h.importKey("raw",v,{name:"PBKDF2"},!1,["deriveBits"]).then((function(B){return h.deriveBits({name:"PBKDF2",salt:w,iterations:_,hash:{name:P}},B,A<<3)})).then((function(B){return u.from(B)}))}n.exports=function(v,w,_,A,P,B){typeof P=="function"&&(B=P,P=void 0);var T=y[(P=P||"sha1").toLowerCase()];if(T&&typeof i.Promise=="function"){if(l(_,A),v=p(v,d,"Password"),w=p(w,d,"Salt"),typeof B!="function")throw new Error("No callback provided to pbkdf2");(function(I,U){I.then((function(H){m()((function(){U(null,H)}))}),(function(H){m()((function(){U(H)}))}))})((function(I){if(i.process&&!i.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(g[I]!==void 0)return g[I];var U=x(o=o||u.alloc(8),o,10,128,I).then((function(){return!0})).catch((function(){return!1}));return g[I]=U,U})(T).then((function(I){return I?x(v,w,_,A,T):f(v,w,_,A,P)})),B)}else m()((function(){var I;try{I=f(v,w,_,A,P)}catch(U){return B(U)}B(null,I)}))}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(t,n,a){(function(i,o){(function(){var c;o.process&&o.process.browser?c="utf-8":o.process&&o.process.version?c=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":c="utf-8",n.exports=c}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(t,n,a){var i=Math.pow(2,30)-1;n.exports=function(o,c){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof c!="number")throw new TypeError("Key length not a number");if(c<0||c>i||c!=c)throw new TypeError("Bad key length")}},{}],464:[function(t,n,a){var i=t("create-hash/md5"),o=t("ripemd160"),c=t("sha.js"),u=t("safe-buffer").Buffer,l=t("./precondition"),d=t("./default-encoding"),f=t("./to-buffer"),p=u.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function y(g,m,x){var v=(function(T){function I(U){return c(T).update(U).digest()}return T==="rmd160"||T==="ripemd160"?function(U){return new o().update(U).digest()}:T==="md5"?i:I})(g),w=g==="sha512"||g==="sha384"?128:64;m.length>w?m=v(m):m.length<w&&(m=u.concat([m,p],w));for(var _=u.allocUnsafe(w+h[g]),A=u.allocUnsafe(w+h[g]),P=0;P<w;P++)_[P]=54^m[P],A[P]=92^m[P];var B=u.allocUnsafe(w+x+4);_.copy(B,0,0,w),this.ipad1=B,this.ipad2=_,this.opad=A,this.alg=g,this.blocksize=w,this.hash=v,this.size=h[g]}y.prototype.run=function(g,m){return g.copy(m,this.blocksize),this.hash(m).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(g,m,x,v,w){l(x,v);var _=new y(w=w||"sha1",g=f(g,d,"Password"),(m=f(m,d,"Salt")).length),A=u.allocUnsafe(v),P=u.allocUnsafe(m.length+4);m.copy(P,0,0,m.length);for(var B=0,T=h[w],I=Math.ceil(v/T),U=1;U<=I;U++){P.writeUInt32BE(U,m.length);for(var H=_.run(P,_.ipad1),z=H,O=1;O<x;O++){z=_.run(z,_.ipad2);for(var L=0;L<T;L++)H[L]^=z[L]}H.copy(A,B),B+=T}return A}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(t,n,a){var i=t("safe-buffer").Buffer;n.exports=function(o,c,u){if(i.isBuffer(o))return o;if(typeof o=="string")return i.from(o,c);if(ArrayBuffer.isView(o))return i.from(o.buffer);throw new TypeError(u+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(t,n,a){(function(i){(function(){i===void 0||!i.version||i.version.indexOf("v0.")===0||i.version.indexOf("v1.")===0&&i.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(o,c,u,l){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var d,f,p=arguments.length;switch(p){case 0:case 1:return i.nextTick(o);case 2:return i.nextTick((function(){o.call(null,c)}));case 3:return i.nextTick((function(){o.call(null,c,u)}));case 4:return i.nextTick((function(){o.call(null,c,u,l)}));default:for(d=new Array(p-1),f=0;f<d.length;)d[f++]=arguments[f];return i.nextTick((function(){o.apply(null,d)}))}}}:n.exports=i}).call(this)}).call(this,t("_process"))},{_process:467}],467:[function(t,n,a){var i,o,c=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function d(w){if(i===setTimeout)return setTimeout(w,0);if((i===u||!i)&&setTimeout)return i=setTimeout,setTimeout(w,0);try{return i(w,0)}catch{try{return i.call(null,w,0)}catch{return i.call(this,w,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:u}catch{i=u}try{o=typeof clearTimeout=="function"?clearTimeout:l}catch{o=l}})();var f,p=[],h=!1,y=-1;function g(){h&&f&&(h=!1,f.length?p=f.concat(p):y=-1,p.length&&m())}function m(){if(!h){var w=d(g);h=!0;for(var _=p.length;_;){for(f=p,p=[];++y<_;)f&&f[y].run();y=-1,_=p.length}f=null,h=!1,(function(A){if(o===clearTimeout)return clearTimeout(A);if((o===l||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(A);try{o(A)}catch{try{return o.call(null,A)}catch{return o.call(this,A)}}})(w)}}function x(w,_){this.fun=w,this.array=_}function v(){}c.nextTick=function(w){var _=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)_[A-1]=arguments[A];p.push(new x(w,_)),p.length!==1||h||d(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=v,c.addListener=v,c.once=v,c.off=v,c.removeListener=v,c.removeAllListeners=v,c.emit=v,c.prependListener=v,c.prependOnceListener=v,c.listeners=function(w){return[]},c.binding=function(w){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(w){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],468:[function(t,n,a){a.publicEncrypt=t("./publicEncrypt"),a.privateDecrypt=t("./privateDecrypt"),a.privateEncrypt=function(i,o){return a.publicEncrypt(i,o,!0)},a.publicDecrypt=function(i,o){return a.privateDecrypt(i,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(t,n,a){var i=t("create-hash"),o=t("safe-buffer").Buffer;function c(u){var l=o.allocUnsafe(4);return l.writeUInt32BE(u,0),l}n.exports=function(u,l){for(var d,f=o.alloc(0),p=0;f.length<l;)d=c(p++),f=o.concat([f,i("sha1").update(u).update(d).digest()]);return f.slice(0,l)}},{"create-hash":386,"safe-buffer":494}],470:[function(t,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],471:[function(t,n,a){var i=t("parse-asn1"),o=t("./mgf"),c=t("./xor"),u=t("bn.js"),l=t("browserify-rsa"),d=t("create-hash"),f=t("./withPublic"),p=t("safe-buffer").Buffer;n.exports=function(h,y,g){var m;m=h.padding?h.padding:g?1:4;var x,v=i(h),w=v.modulus.byteLength();if(y.length>w||new u(y).cmp(v.modulus)>=0)throw new Error("decryption error");x=g?f(new u(y),v):l(y,v);var _=p.alloc(w-x.length);if(x=p.concat([_,x],w),m===4)return(function(A,P){var B=A.modulus.byteLength(),T=d("sha1").update(p.alloc(0)).digest(),I=T.length;if(P[0]!==0)throw new Error("decryption error");var U=P.slice(1,I+1),H=P.slice(I+1),z=c(U,o(H,I)),O=c(H,o(z,B-I-1));if((function(E,k){E=p.from(E),k=p.from(k);var N=0,S=E.length;E.length!==k.length&&(N++,S=Math.min(E.length,k.length));for(var C=-1;++C<S;)N+=E[C]^k[C];return N})(T,O.slice(0,I)))throw new Error("decryption error");for(var L=I;O[L]===0;)L++;if(O[L++]!==1)throw new Error("decryption error");return O.slice(L)})(v,x);if(m===1)return(function(A,P,B){for(var T=P.slice(0,2),I=2,U=0;P[I++]!==0;)if(I>=P.length){U++;break}var H=P.slice(2,I-1);if((T.toString("hex")!=="0002"&&!B||T.toString("hex")!=="0001"&&B)&&U++,H.length<8&&U++,U)throw new Error("decryption error");return P.slice(I)})(0,x,g);if(m===3)return x;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(t,n,a){var i=t("parse-asn1"),o=t("randombytes"),c=t("create-hash"),u=t("./mgf"),l=t("./xor"),d=t("bn.js"),f=t("./withPublic"),p=t("browserify-rsa"),h=t("safe-buffer").Buffer;n.exports=function(y,g,m){var x;x=y.padding?y.padding:m?1:4;var v,w=i(y);if(x===4)v=(function(_,A){var P=_.modulus.byteLength(),B=A.length,T=c("sha1").update(h.alloc(0)).digest(),I=T.length,U=2*I;if(B>P-U-2)throw new Error("message too long");var H=h.alloc(P-B-U-2),z=P-I-1,O=o(I),L=l(h.concat([T,H,h.alloc(1,1),A],z),u(O,z)),E=l(O,u(L,I));return new d(h.concat([h.alloc(1),E,L],P))})(w,g);else if(x===1)v=(function(_,A,P){var B,T=A.length,I=_.modulus.byteLength();if(T>I-11)throw new Error("message too long");return B=P?h.alloc(I-T-3,255):(function(U){for(var H,z=h.allocUnsafe(U),O=0,L=o(2*U),E=0;O<U;)E===L.length&&(L=o(2*U),E=0),(H=L[E++])&&(z[O++]=H);return z})(I-T-3),new d(h.concat([h.from([0,P?1:2]),B,h.alloc(1),A],I))})(w,g,m);else{if(x!==3)throw new Error("unknown padding");if((v=new d(g)).cmp(w.modulus)>=0)throw new Error("data too long for modulus")}return m?p(v,w):f(v,w)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(t,n,a){var i=t("bn.js"),o=t("safe-buffer").Buffer;n.exports=function(c,u){return o.from(c.toRed(i.mont(u.modulus)).redPow(new i(u.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(t,n,a){n.exports=function(i,o){for(var c=i.length,u=-1;++u<c;)i[u]^=o[u];return i}},{}],475:[function(t,n,a){(function(i,o){(function(){var c=t("safe-buffer").Buffer,u=o.crypto||o.msCrypto;u&&u.getRandomValues?n.exports=function(l,d){if(l>4294967295)throw new RangeError("requested too many random bytes");var f=c.allocUnsafe(l);if(l>0)if(l>65536)for(var p=0;p<l;p+=65536)u.getRandomValues(f.slice(p,p+65536));else u.getRandomValues(f);return typeof d=="function"?i.nextTick((function(){d(null,f)})):f}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(t,n,a){(function(i,o){(function(){function c(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var u=t("safe-buffer"),l=t("randombytes"),d=u.Buffer,f=u.kMaxLength,p=o.crypto||o.msCrypto,h=Math.pow(2,32)-1;function y(x,v){if(typeof x!="number"||x!=x)throw new TypeError("offset must be a number");if(x>h||x<0)throw new TypeError("offset must be a uint32");if(x>f||x>v)throw new RangeError("offset out of range")}function g(x,v,w){if(typeof x!="number"||x!=x)throw new TypeError("size must be a number");if(x>h||x<0)throw new TypeError("size must be a uint32");if(x+v>w||x>f)throw new RangeError("buffer too small")}function m(x,v,w,_){if(i.browser){var A=x.buffer,P=new Uint8Array(A,v,w);return p.getRandomValues(P),_?void i.nextTick((function(){_(null,x)})):x}if(!_)return l(w).copy(x,v),x;l(w,(function(B,T){if(B)return _(B);T.copy(x,v),_(null,x)}))}p&&p.getRandomValues||!i.browser?(a.randomFill=function(x,v,w,_){if(!(d.isBuffer(x)||x instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof v=="function")_=v,v=0,w=x.length;else if(typeof w=="function")_=w,w=x.length-v;else if(typeof _!="function")throw new TypeError('"cb" argument must be a function');return y(v,x.length),g(w,v,x.length),m(x,v,w,_)},a.randomFillSync=function(x,v,w){if(v===void 0&&(v=0),!(d.isBuffer(x)||x instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return y(v,x.length),w===void 0&&(w=x.length-v),g(w,v,x.length),m(x,v,w)}):(a.randomFill=c,a.randomFillSync=c)}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(t,n,a){var i={};function o(u,l,d){d||(d=Error);var f=(function(p){var h,y;function g(m,x,v){return p.call(this,(function(w,_,A){return typeof l=="string"?l:l(w,_,A)})(m,x,v))||this}return y=p,(h=g).prototype=Object.create(y.prototype),h.prototype.constructor=h,h.__proto__=y,g})(d);f.prototype.name=d.name,f.prototype.code=u,i[u]=f}function c(u,l){if(Array.isArray(u)){var d=u.length;return u=u.map((function(f){return String(f)})),d>2?"one of ".concat(l," ").concat(u.slice(0,d-1).join(", "),", or ")+u[d-1]:d===2?"one of ".concat(l," ").concat(u[0]," or ").concat(u[1]):"of ".concat(l," ").concat(u[0])}return"of ".concat(l," ").concat(String(u))}o("ERR_INVALID_OPT_VALUE",(function(u,l){return'The value "'+l+'" is invalid for option "'+u+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(u,l,d){var f,p,h;if(typeof l=="string"&&(p="not ",l.substr(0,p.length)===p)?(f="must not be",l=l.replace(/^not /,"")):f="must be",(function(g,m,x){return(x===void 0||x>g.length)&&(x=g.length),g.substring(x-m.length,x)===m})(u," argument"))h="The ".concat(u," ").concat(f," ").concat(c(l,"type"));else{var y=(function(g,m,x){return typeof x!="number"&&(x=0),!(x+m.length>g.length)&&g.indexOf(m,x)!==-1})(u,".")?"property":"argument";h='The "'.concat(u,'" ').concat(y," ").concat(f," ").concat(c(l,"type"))}return h+=". Received type ".concat(typeof d)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(u){return"The "+u+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(u){return"Cannot call "+u+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(u){return"Unknown encoding: "+u}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=i},{}],478:[function(t,n,a){(function(i){(function(){var o=Object.keys||function(g){var m=[];for(var x in g)m.push(x);return m};n.exports=p;var c=t("./_stream_readable"),u=t("./_stream_writable");t("inherits")(p,c);for(var l=o(u.prototype),d=0;d<l.length;d++){var f=l[d];p.prototype[f]||(p.prototype[f]=u.prototype[f])}function p(g){if(!(this instanceof p))return new p(g);c.call(this,g),u.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||i.nextTick(y,this)}function y(g){g.end()}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(p.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(p.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(t,n,a){n.exports=o;var i=t("./_stream_transform");function o(c){if(!(this instanceof o))return new o(c);i.call(this,c)}t("inherits")(o,i),o.prototype._transform=function(c,u,l){l(null,c)}},{"./_stream_transform":481,inherits:440}],480:[function(t,n,a){(function(i,o){(function(){var c;n.exports=z,z.ReadableState=H,t("events").EventEmitter;var u=function(W,F){return W.listeners(F).length},l=t("./internal/streams/stream"),d=t("buffer").Buffer,f=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p,h=t("util");p=h&&h.debuglog?h.debuglog("stream"):function(){};var y,g,m,x=t("./internal/streams/buffer_list"),v=t("./internal/streams/destroy"),w=t("./internal/streams/state").getHighWaterMark,_=t("../errors").codes,A=_.ERR_INVALID_ARG_TYPE,P=_.ERR_STREAM_PUSH_AFTER_EOF,B=_.ERR_METHOD_NOT_IMPLEMENTED,T=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(z,l);var I=v.errorOrDestroy,U=["error","close","destroy","pause","resume"];function H(W,F,Q){c=c||t("./_stream_duplex"),W=W||{},typeof Q!="boolean"&&(Q=F instanceof c),this.objectMode=!!W.objectMode,Q&&(this.objectMode=this.objectMode||!!W.readableObjectMode),this.highWaterMark=w(this,W,"readableHighWaterMark",Q),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=W.emitClose!==!1,this.autoDestroy=!!W.autoDestroy,this.destroyed=!1,this.defaultEncoding=W.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,W.encoding&&(y||(y=t("string_decoder/").StringDecoder),this.decoder=new y(W.encoding),this.encoding=W.encoding)}function z(W){if(c=c||t("./_stream_duplex"),!(this instanceof z))return new z(W);var F=this instanceof c;this._readableState=new H(W,this,F),this.readable=!0,W&&(typeof W.read=="function"&&(this._read=W.read),typeof W.destroy=="function"&&(this._destroy=W.destroy)),l.call(this)}function O(W,F,Q,ne,ie){p("readableAddChunk",F);var ce,de=W._readableState;if(F===null)de.reading=!1,(function(le,_e){if(p("onEofChunk"),!_e.ended){if(_e.decoder){var ue=_e.decoder.end();ue&&ue.length&&(_e.buffer.push(ue),_e.length+=_e.objectMode?1:ue.length)}_e.ended=!0,_e.sync?k(le):(_e.needReadable=!1,_e.emittedReadable||(_e.emittedReadable=!0,N(le)))}})(W,de);else if(ie||(ce=(function(le,_e){var ue;pe=_e,d.isBuffer(pe)||pe instanceof f||typeof _e=="string"||_e===void 0||le.objectMode||(ue=new A("chunk",["string","Buffer","Uint8Array"],_e));var pe;return ue})(de,F)),ce)I(W,ce);else if(de.objectMode||F&&F.length>0)if(typeof F=="string"||de.objectMode||Object.getPrototypeOf(F)===d.prototype||(F=(function(le){return d.from(le)})(F)),ne)de.endEmitted?I(W,new T):L(W,de,F,!0);else if(de.ended)I(W,new P);else{if(de.destroyed)return!1;de.reading=!1,de.decoder&&!Q?(F=de.decoder.write(F),de.objectMode||F.length!==0?L(W,de,F,!1):S(W,de)):L(W,de,F,!1)}else ne||(de.reading=!1,S(W,de));return!de.ended&&(de.length<de.highWaterMark||de.length===0)}function L(W,F,Q,ne){F.flowing&&F.length===0&&!F.sync?(F.awaitDrain=0,W.emit("data",Q)):(F.length+=F.objectMode?1:Q.length,ne?F.buffer.unshift(Q):F.buffer.push(Q),F.needReadable&&k(W)),S(W,F)}Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(W){this._readableState&&(this._readableState.destroyed=W)}}),z.prototype.destroy=v.destroy,z.prototype._undestroy=v.undestroy,z.prototype._destroy=function(W,F){F(W)},z.prototype.push=function(W,F){var Q,ne=this._readableState;return ne.objectMode?Q=!0:typeof W=="string"&&((F=F||ne.defaultEncoding)!==ne.encoding&&(W=d.from(W,F),F=""),Q=!0),O(this,W,F,!1,Q)},z.prototype.unshift=function(W){return O(this,W,null,!0,!1)},z.prototype.isPaused=function(){return this._readableState.flowing===!1},z.prototype.setEncoding=function(W){y||(y=t("string_decoder/").StringDecoder);var F=new y(W);this._readableState.decoder=F,this._readableState.encoding=this._readableState.decoder.encoding;for(var Q=this._readableState.buffer.head,ne="";Q!==null;)ne+=F.write(Q.data),Q=Q.next;return this._readableState.buffer.clear(),ne!==""&&this._readableState.buffer.push(ne),this._readableState.length=ne.length,this};function E(W,F){return W<=0||F.length===0&&F.ended?0:F.objectMode?1:W!=W?F.flowing&&F.length?F.buffer.head.data.length:F.length:(W>F.highWaterMark&&(F.highWaterMark=(function(Q){return Q>=1073741824?Q=1073741824:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q})(W)),W<=F.length?W:F.ended?F.length:(F.needReadable=!0,0))}function k(W){var F=W._readableState;p("emitReadable",F.needReadable,F.emittedReadable),F.needReadable=!1,F.emittedReadable||(p("emitReadable",F.flowing),F.emittedReadable=!0,i.nextTick(N,W))}function N(W){var F=W._readableState;p("emitReadable_",F.destroyed,F.length,F.ended),F.destroyed||!F.length&&!F.ended||(W.emit("readable"),F.emittedReadable=!1),F.needReadable=!F.flowing&&!F.ended&&F.length<=F.highWaterMark,G(W)}function S(W,F){F.readingMore||(F.readingMore=!0,i.nextTick(C,W,F))}function C(W,F){for(;!F.reading&&!F.ended&&(F.length<F.highWaterMark||F.flowing&&F.length===0);){var Q=F.length;if(p("maybeReadMore read 0"),W.read(0),Q===F.length)break}F.readingMore=!1}function D(W){var F=W._readableState;F.readableListening=W.listenerCount("readable")>0,F.resumeScheduled&&!F.paused?F.flowing=!0:W.listenerCount("data")>0&&W.resume()}function q(W){p("readable nexttick read 0"),W.read(0)}function M(W,F){p("resume",F.reading),F.reading||W.read(0),F.resumeScheduled=!1,W.emit("resume"),G(W),F.flowing&&!F.reading&&W.read(0)}function G(W){var F=W._readableState;for(p("flow",F.flowing);F.flowing&&W.read()!==null;);}function X(W,F){return F.length===0?null:(F.objectMode?Q=F.buffer.shift():!W||W>=F.length?(Q=F.decoder?F.buffer.join(""):F.buffer.length===1?F.buffer.first():F.buffer.concat(F.length),F.buffer.clear()):Q=F.buffer.consume(W,F.decoder),Q);var Q}function re(W){var F=W._readableState;p("endReadable",F.endEmitted),F.endEmitted||(F.ended=!0,i.nextTick(V,F,W))}function V(W,F){if(p("endReadableNT",W.endEmitted,W.length),!W.endEmitted&&W.length===0&&(W.endEmitted=!0,F.readable=!1,F.emit("end"),W.autoDestroy)){var Q=F._writableState;(!Q||Q.autoDestroy&&Q.finished)&&F.destroy()}}function J(W,F){for(var Q=0,ne=W.length;Q<ne;Q++)if(W[Q]===F)return Q;return-1}z.prototype.read=function(W){p("read",W),W=parseInt(W,10);var F=this._readableState,Q=W;if(W!==0&&(F.emittedReadable=!1),W===0&&F.needReadable&&((F.highWaterMark!==0?F.length>=F.highWaterMark:F.length>0)||F.ended))return p("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?re(this):k(this),null;if((W=E(W,F))===0&&F.ended)return F.length===0&&re(this),null;var ne,ie=F.needReadable;return p("need readable",ie),(F.length===0||F.length-W<F.highWaterMark)&&p("length less than watermark",ie=!0),F.ended||F.reading?p("reading or ended",ie=!1):ie&&(p("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(W=E(Q,F))),(ne=W>0?X(W,F):null)===null?(F.needReadable=F.length<=F.highWaterMark,W=0):(F.length-=W,F.awaitDrain=0),F.length===0&&(F.ended||(F.needReadable=!0),Q!==W&&F.ended&&re(this)),ne!==null&&this.emit("data",ne),ne},z.prototype._read=function(W){I(this,new B("_read()"))},z.prototype.pipe=function(W,F){var Q=this,ne=this._readableState;switch(ne.pipesCount){case 0:ne.pipes=W;break;case 1:ne.pipes=[ne.pipes,W];break;default:ne.pipes.push(W)}ne.pipesCount+=1,p("pipe count=%d opts=%j",ne.pipesCount,F);var ie=(!F||F.end!==!1)&&W!==i.stdout&&W!==i.stderr?de:fe;function ce(xe,je){p("onunpipe"),xe===Q&&je&&je.hasUnpiped===!1&&(je.hasUnpiped=!0,p("cleanup"),W.removeListener("close",me),W.removeListener("finish",Ce),W.removeListener("drain",le),W.removeListener("error",pe),W.removeListener("unpipe",ce),Q.removeListener("end",de),Q.removeListener("end",fe),Q.removeListener("data",ue),_e=!0,!ne.awaitDrain||W._writableState&&!W._writableState.needDrain||le())}function de(){p("onend"),W.end()}ne.endEmitted?i.nextTick(ie):Q.once("end",ie),W.on("unpipe",ce);var le=(function(xe){return function(){var je=xe._readableState;p("pipeOnDrain",je.awaitDrain),je.awaitDrain&&je.awaitDrain--,je.awaitDrain===0&&u(xe,"data")&&(je.flowing=!0,G(xe))}})(Q);W.on("drain",le);var _e=!1;function ue(xe){p("ondata");var je=W.write(xe);p("dest.write",je),je===!1&&((ne.pipesCount===1&&ne.pipes===W||ne.pipesCount>1&&J(ne.pipes,W)!==-1)&&!_e&&(p("false write response, pause",ne.awaitDrain),ne.awaitDrain++),Q.pause())}function pe(xe){p("onerror",xe),fe(),W.removeListener("error",pe),u(W,"error")===0&&I(W,xe)}function me(){W.removeListener("finish",Ce),fe()}function Ce(){p("onfinish"),W.removeListener("close",me),fe()}function fe(){p("unpipe"),Q.unpipe(W)}return Q.on("data",ue),(function(xe,je,Oe){if(typeof xe.prependListener=="function")return xe.prependListener(je,Oe);xe._events&&xe._events[je]?Array.isArray(xe._events[je])?xe._events[je].unshift(Oe):xe._events[je]=[Oe,xe._events[je]]:xe.on(je,Oe)})(W,"error",pe),W.once("close",me),W.once("finish",Ce),W.emit("pipe",Q),ne.flowing||(p("pipe resume"),Q.resume()),W},z.prototype.unpipe=function(W){var F=this._readableState,Q={hasUnpiped:!1};if(F.pipesCount===0)return this;if(F.pipesCount===1)return W&&W!==F.pipes||(W||(W=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,W&&W.emit("unpipe",this,Q)),this;if(!W){var ne=F.pipes,ie=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var ce=0;ce<ie;ce++)ne[ce].emit("unpipe",this,{hasUnpiped:!1});return this}var de=J(F.pipes,W);return de===-1||(F.pipes.splice(de,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),W.emit("unpipe",this,Q)),this},z.prototype.on=function(W,F){var Q=l.prototype.on.call(this,W,F),ne=this._readableState;return W==="data"?(ne.readableListening=this.listenerCount("readable")>0,ne.flowing!==!1&&this.resume()):W==="readable"&&(ne.endEmitted||ne.readableListening||(ne.readableListening=ne.needReadable=!0,ne.flowing=!1,ne.emittedReadable=!1,p("on readable",ne.length,ne.reading),ne.length?k(this):ne.reading||i.nextTick(q,this))),Q},z.prototype.addListener=z.prototype.on,z.prototype.removeListener=function(W,F){var Q=l.prototype.removeListener.call(this,W,F);return W==="readable"&&i.nextTick(D,this),Q},z.prototype.removeAllListeners=function(W){var F=l.prototype.removeAllListeners.apply(this,arguments);return W!=="readable"&&W!==void 0||i.nextTick(D,this),F},z.prototype.resume=function(){var W=this._readableState;return W.flowing||(p("resume"),W.flowing=!W.readableListening,(function(F,Q){Q.resumeScheduled||(Q.resumeScheduled=!0,i.nextTick(M,F,Q))})(this,W)),W.paused=!1,this},z.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},z.prototype.wrap=function(W){var F=this,Q=this._readableState,ne=!1;for(var ie in W.on("end",(function(){if(p("wrapped end"),Q.decoder&&!Q.ended){var de=Q.decoder.end();de&&de.length&&F.push(de)}F.push(null)})),W.on("data",(function(de){p("wrapped data"),Q.decoder&&(de=Q.decoder.write(de)),Q.objectMode&&de==null||(Q.objectMode||de&&de.length)&&(F.push(de)||(ne=!0,W.pause()))})),W)this[ie]===void 0&&typeof W[ie]=="function"&&(this[ie]=(function(de){return function(){return W[de].apply(W,arguments)}})(ie));for(var ce=0;ce<U.length;ce++)W.on(U[ce],this.emit.bind(this,U[ce]));return this._read=function(de){p("wrapped _read",de),ne&&(ne=!1,W.resume())},this},typeof Symbol=="function"&&(z.prototype[Symbol.asyncIterator]=function(){return g===void 0&&(g=t("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(z.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(z.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(z.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(W){this._readableState&&(this._readableState.flowing=W)}}),z._fromList=X,Object.defineProperty(z.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(z.from=function(W,F){return m===void 0&&(m=t("./internal/streams/from")),m(z,W,F)})}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(t,n,a){n.exports=p;var i=t("../errors").codes,o=i.ERR_METHOD_NOT_IMPLEMENTED,c=i.ERR_MULTIPLE_CALLBACK,u=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=i.ERR_TRANSFORM_WITH_LENGTH_0,d=t("./_stream_duplex");function f(g,m){var x=this._transformState;x.transforming=!1;var v=x.writecb;if(v===null)return this.emit("error",new c);x.writechunk=null,x.writecb=null,m!=null&&this.push(m),v(g);var w=this._readableState;w.reading=!1,(w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}function p(g){if(!(this instanceof p))return new p(g);d.call(this,g),this._transformState={afterTransform:f.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",h)}function h(){var g=this;typeof this._flush!="function"||this._readableState.destroyed?y(this,null,null):this._flush((function(m,x){y(g,m,x)}))}function y(g,m,x){if(m)return g.emit("error",m);if(x!=null&&g.push(x),g._writableState.length)throw new l;if(g._transformState.transforming)throw new u;return g.push(null)}t("inherits")(p,d),p.prototype.push=function(g,m){return this._transformState.needTransform=!1,d.prototype.push.call(this,g,m)},p.prototype._transform=function(g,m,x){x(new o("_transform()"))},p.prototype._write=function(g,m,x){var v=this._transformState;if(v.writecb=x,v.writechunk=g,v.writeencoding=m,!v.transforming){var w=this._readableState;(v.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},p.prototype._read=function(g){var m=this._transformState;m.writechunk===null||m.transforming?m.needTransform=!0:(m.transforming=!0,this._transform(m.writechunk,m.writeencoding,m.afterTransform))},p.prototype._destroy=function(g,m){d.prototype._destroy.call(this,g,(function(x){m(x)}))}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(t,n,a){(function(i,o){(function(){function c(C){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(q,M,G){var X=q.entry;for(q.entry=null;X;){var re=X.callback;M.pendingcb--,re(G),X=X.next}M.corkedRequestsFree.next=q})(D,C)}}var u;n.exports=z,z.WritableState=H;var l={deprecate:t("util-deprecate")},d=t("./internal/streams/stream"),f=t("buffer").Buffer,p=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,y=t("./internal/streams/destroy"),g=t("./internal/streams/state").getHighWaterMark,m=t("../errors").codes,x=m.ERR_INVALID_ARG_TYPE,v=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_MULTIPLE_CALLBACK,_=m.ERR_STREAM_CANNOT_PIPE,A=m.ERR_STREAM_DESTROYED,P=m.ERR_STREAM_NULL_VALUES,B=m.ERR_STREAM_WRITE_AFTER_END,T=m.ERR_UNKNOWN_ENCODING,I=y.errorOrDestroy;function U(){}function H(C,D,q){u=u||t("./_stream_duplex"),C=C||{},typeof q!="boolean"&&(q=D instanceof u),this.objectMode=!!C.objectMode,q&&(this.objectMode=this.objectMode||!!C.writableObjectMode),this.highWaterMark=g(this,C,"writableHighWaterMark",q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var M=C.decodeStrings===!1;this.decodeStrings=!M,this.defaultEncoding=C.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(G){(function(X,re){var V=X._writableState,J=V.sync,W=V.writecb;if(typeof W!="function")throw new w;if((function(Q){Q.writing=!1,Q.writecb=null,Q.length-=Q.writelen,Q.writelen=0})(V),re)(function(Q,ne,ie,ce,de){--ne.pendingcb,ie?(i.nextTick(de,ce),i.nextTick(S,Q,ne),Q._writableState.errorEmitted=!0,I(Q,ce)):(de(ce),Q._writableState.errorEmitted=!0,I(Q,ce),S(Q,ne))})(X,V,J,re,W);else{var F=k(V)||X.destroyed;F||V.corked||V.bufferProcessing||!V.bufferedRequest||E(X,V),J?i.nextTick(L,X,V,F,W):L(X,V,F,W)}})(D,G)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=C.emitClose!==!1,this.autoDestroy=!!C.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function z(C){var D=this instanceof(u=u||t("./_stream_duplex"));if(!D&&!h.call(z,this))return new z(C);this._writableState=new H(C,this,D),this.writable=!0,C&&(typeof C.write=="function"&&(this._write=C.write),typeof C.writev=="function"&&(this._writev=C.writev),typeof C.destroy=="function"&&(this._destroy=C.destroy),typeof C.final=="function"&&(this._final=C.final)),d.call(this)}function O(C,D,q,M,G,X,re){D.writelen=M,D.writecb=re,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new A("write")):q?C._writev(G,D.onwrite):C._write(G,X,D.onwrite),D.sync=!1}function L(C,D,q,M){q||(function(G,X){X.length===0&&X.needDrain&&(X.needDrain=!1,G.emit("drain"))})(C,D),D.pendingcb--,M(),S(C,D)}function E(C,D){D.bufferProcessing=!0;var q=D.bufferedRequest;if(C._writev&&q&&q.next){var M=D.bufferedRequestCount,G=new Array(M),X=D.corkedRequestsFree;X.entry=q;for(var re=0,V=!0;q;)G[re]=q,q.isBuf||(V=!1),q=q.next,re+=1;G.allBuffers=V,O(C,D,!0,D.length,G,"",X.finish),D.pendingcb++,D.lastBufferedRequest=null,X.next?(D.corkedRequestsFree=X.next,X.next=null):D.corkedRequestsFree=new c(D),D.bufferedRequestCount=0}else{for(;q;){var J=q.chunk,W=q.encoding,F=q.callback;if(O(C,D,!1,D.objectMode?1:J.length,J,W,F),q=q.next,D.bufferedRequestCount--,D.writing)break}q===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=q,D.bufferProcessing=!1}function k(C){return C.ending&&C.length===0&&C.bufferedRequest===null&&!C.finished&&!C.writing}function N(C,D){C._final((function(q){D.pendingcb--,q&&I(C,q),D.prefinished=!0,C.emit("prefinish"),S(C,D)}))}function S(C,D){var q=k(D);if(q&&((function(G,X){X.prefinished||X.finalCalled||(typeof G._final!="function"||X.destroyed?(X.prefinished=!0,G.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,i.nextTick(N,G,X)))})(C,D),D.pendingcb===0&&(D.finished=!0,C.emit("finish"),D.autoDestroy))){var M=C._readableState;(!M||M.autoDestroy&&M.endEmitted)&&C.destroy()}return q}t("inherits")(z,d),H.prototype.getBuffer=function(){for(var C=this.bufferedRequest,D=[];C;)D.push(C),C=C.next;return D},(function(){try{Object.defineProperty(H.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(C){return!!h.call(this,C)||this===z&&C&&C._writableState instanceof H}})):h=function(C){return C instanceof this},z.prototype.pipe=function(){I(this,new _)},z.prototype.write=function(C,D,q){var M,G=this._writableState,X=!1,re=!G.objectMode&&(M=C,f.isBuffer(M)||M instanceof p);return re&&!f.isBuffer(C)&&(C=(function(V){return f.from(V)})(C)),typeof D=="function"&&(q=D,D=null),re?D="buffer":D||(D=G.defaultEncoding),typeof q!="function"&&(q=U),G.ending?(function(V,J){var W=new B;I(V,W),i.nextTick(J,W)})(this,q):(re||(function(V,J,W,F){var Q;return W===null?Q=new P:typeof W=="string"||J.objectMode||(Q=new x("chunk",["string","Buffer"],W)),!Q||(I(V,Q),i.nextTick(F,Q),!1)})(this,G,C,q))&&(G.pendingcb++,X=(function(V,J,W,F,Q,ne){if(!W){var ie=(function(_e,ue,pe){return _e.objectMode||_e.decodeStrings===!1||typeof ue!="string"||(ue=f.from(ue,pe)),ue})(J,F,Q);F!==ie&&(W=!0,Q="buffer",F=ie)}var ce=J.objectMode?1:F.length;J.length+=ce;var de=J.length<J.highWaterMark;if(de||(J.needDrain=!0),J.writing||J.corked){var le=J.lastBufferedRequest;J.lastBufferedRequest={chunk:F,encoding:Q,isBuf:W,callback:ne,next:null},le?le.next=J.lastBufferedRequest:J.bufferedRequest=J.lastBufferedRequest,J.bufferedRequestCount+=1}else O(V,J,!1,ce,F,Q,ne);return de})(this,G,re,C,D,q)),X},z.prototype.cork=function(){this._writableState.corked++},z.prototype.uncork=function(){var C=this._writableState;C.corked&&(C.corked--,C.writing||C.corked||C.bufferProcessing||!C.bufferedRequest||E(this,C))},z.prototype.setDefaultEncoding=function(C){if(typeof C=="string"&&(C=C.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((C+"").toLowerCase())>-1))throw new T(C);return this._writableState.defaultEncoding=C,this},Object.defineProperty(z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),z.prototype._write=function(C,D,q){q(new v("_write()"))},z.prototype._writev=null,z.prototype.end=function(C,D,q){var M=this._writableState;return typeof C=="function"?(q=C,C=null,D=null):typeof D=="function"&&(q=D,D=null),C!=null&&this.write(C,D),M.corked&&(M.corked=1,this.uncork()),M.ending||(function(G,X,re){X.ending=!0,S(G,X),re&&(X.finished?i.nextTick(re):G.once("finish",re)),X.ended=!0,G.writable=!1})(this,M,q),this},Object.defineProperty(z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(C){this._writableState&&(this._writableState.destroyed=C)}}),z.prototype.destroy=y.destroy,z.prototype._undestroy=y.undestroy,z.prototype._destroy=function(C,D){D(C)}}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(t,n,a){(function(i){(function(){var o;function c(A,P,B){return(P=(function(T){var I=(function(U,H){if(typeof U!="object"||U===null)return U;var z=U[Symbol.toPrimitive];if(z!==void 0){var O=z.call(U,H);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(H==="string"?String:Number)(U)})(T,"string");return typeof I=="symbol"?I:String(I)})(P))in A?Object.defineProperty(A,P,{value:B,enumerable:!0,configurable:!0,writable:!0}):A[P]=B,A}var u=t("./end-of-stream"),l=Symbol("lastResolve"),d=Symbol("lastReject"),f=Symbol("error"),p=Symbol("ended"),h=Symbol("lastPromise"),y=Symbol("handlePromise"),g=Symbol("stream");function m(A,P){return{value:A,done:P}}function x(A){var P=A[l];if(P!==null){var B=A[g].read();B!==null&&(A[h]=null,A[l]=null,A[d]=null,P(m(B,!1)))}}function v(A){i.nextTick(x,A)}var w=Object.getPrototypeOf((function(){})),_=Object.setPrototypeOf((c(o={get stream(){return this[g]},next:function(){var A=this,P=this[f];if(P!==null)return Promise.reject(P);if(this[p])return Promise.resolve(m(void 0,!0));if(this[g].destroyed)return new Promise((function(U,H){i.nextTick((function(){A[f]?H(A[f]):U(m(void 0,!0))}))}));var B,T=this[h];if(T)B=new Promise((function(U,H){return function(z,O){U.then((function(){H[p]?z(m(void 0,!0)):H[y](z,O)}),O)}})(T,this));else{var I=this[g].read();if(I!==null)return Promise.resolve(m(I,!1));B=new Promise(this[y])}return this[h]=B,B}},Symbol.asyncIterator,(function(){return this})),c(o,"return",(function(){var A=this;return new Promise((function(P,B){A[g].destroy(null,(function(T){T?B(T):P(m(void 0,!0))}))}))})),o),w);n.exports=function(A){var P,B=Object.create(_,(c(P={},g,{value:A,writable:!0}),c(P,l,{value:null,writable:!0}),c(P,d,{value:null,writable:!0}),c(P,f,{value:null,writable:!0}),c(P,p,{value:A._readableState.endEmitted,writable:!0}),c(P,y,{value:function(T,I){var U=B[g].read();U?(B[h]=null,B[l]=null,B[d]=null,T(m(U,!1))):(B[l]=T,B[d]=I)},writable:!0}),P));return B[h]=null,u(A,(function(T){if(T&&T.code!=="ERR_STREAM_PREMATURE_CLOSE"){var I=B[d];return I!==null&&(B[h]=null,B[l]=null,B[d]=null,I(T)),void(B[f]=T)}var U=B[l];U!==null&&(B[h]=null,B[l]=null,B[d]=null,U(m(void 0,!0))),B[p]=!0})),A.on("readable",v.bind(null,B)),B}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":486,_process:467}],484:[function(t,n,a){function i(h,y){var g=Object.keys(h);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(h);y&&(m=m.filter((function(x){return Object.getOwnPropertyDescriptor(h,x).enumerable}))),g.push.apply(g,m)}return g}function o(h){for(var y=1;y<arguments.length;y++){var g=arguments[y]!=null?arguments[y]:{};y%2?i(Object(g),!0).forEach((function(m){c(h,m,g[m])})):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(g)):i(Object(g)).forEach((function(m){Object.defineProperty(h,m,Object.getOwnPropertyDescriptor(g,m))}))}return h}function c(h,y,g){return(y=l(y))in h?Object.defineProperty(h,y,{value:g,enumerable:!0,configurable:!0,writable:!0}):h[y]=g,h}function u(h,y){for(var g=0;g<y.length;g++){var m=y[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(h,l(m.key),m)}}function l(h){var y=(function(g,m){if(typeof g!="object"||g===null)return g;var x=g[Symbol.toPrimitive];if(x!==void 0){var v=x.call(g,m);if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(g)})(h,"string");return typeof y=="symbol"?y:String(y)}var d=t("buffer").Buffer,f=t("util").inspect,p=f&&f.custom||"inspect";n.exports=(function(){function h(){(function(m,x){if(!(m instanceof x))throw new TypeError("Cannot call a class as a function")})(this,h),this.head=null,this.tail=null,this.length=0}var y,g;return y=h,(g=[{key:"push",value:function(m){var x={data:m,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(m){var x={data:m,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(m){if(this.length===0)return"";for(var x=this.head,v=""+x.data;x=x.next;)v+=m+x.data;return v}},{key:"concat",value:function(m){if(this.length===0)return d.alloc(0);for(var x,v,w,_=d.allocUnsafe(m>>>0),A=this.head,P=0;A;)x=A.data,v=_,w=P,d.prototype.copy.call(x,v,w),P+=A.data.length,A=A.next;return _}},{key:"consume",value:function(m,x){var v;return m<this.head.data.length?(v=this.head.data.slice(0,m),this.head.data=this.head.data.slice(m)):v=m===this.head.data.length?this.shift():x?this._getString(m):this._getBuffer(m),v}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(m){var x=this.head,v=1,w=x.data;for(m-=w.length;x=x.next;){var _=x.data,A=m>_.length?_.length:m;if(A===_.length?w+=_:w+=_.slice(0,m),(m-=A)==0){A===_.length?(++v,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=_.slice(A));break}++v}return this.length-=v,w}},{key:"_getBuffer",value:function(m){var x=d.allocUnsafe(m),v=this.head,w=1;for(v.data.copy(x),m-=v.data.length;v=v.next;){var _=v.data,A=m>_.length?_.length:m;if(_.copy(x,x.length-m,0,A),(m-=A)==0){A===_.length?(++w,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=_.slice(A));break}++w}return this.length-=w,x}},{key:p,value:function(m,x){return f(this,o(o({},x),{},{depth:0,customInspect:!1}))}}])&&u(y.prototype,g),Object.defineProperty(y,"prototype",{writable:!1}),h})()},{buffer:220,util:188}],485:[function(t,n,a){(function(i){(function(){function o(l,d){u(l,d),c(l)}function c(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function u(l,d){l.emit("error",d)}n.exports={destroy:function(l,d){var f=this,p=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return p||h?(d?d(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(u,this,l)):i.nextTick(u,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,(function(y){!d&&y?f._writableState?f._writableState.errorEmitted?i.nextTick(c,f):(f._writableState.errorEmitted=!0,i.nextTick(o,f,y)):i.nextTick(o,f,y):d?(i.nextTick(c,f),d(y)):i.nextTick(c,f)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(l,d){var f=l._readableState,p=l._writableState;f&&f.autoDestroy||p&&p.autoDestroy?l.destroy(d):l.emit("error",d)}}}).call(this)}).call(this,t("_process"))},{_process:467}],486:[function(t,n,a){var i=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}n.exports=function c(u,l,d){if(typeof l=="function")return c(u,null,l);l||(l={}),d=(function(A){var P=!1;return function(){if(!P){P=!0;for(var B=arguments.length,T=new Array(B),I=0;I<B;I++)T[I]=arguments[I];A.apply(this,T)}}})(d||o);var f=l.readable||l.readable!==!1&&u.readable,p=l.writable||l.writable!==!1&&u.writable,h=function(){u.writable||g()},y=u._writableState&&u._writableState.finished,g=function(){p=!1,y=!0,f||d.call(u)},m=u._readableState&&u._readableState.endEmitted,x=function(){f=!1,m=!0,p||d.call(u)},v=function(A){d.call(u,A)},w=function(){var A;return f&&!m?(u._readableState&&u._readableState.ended||(A=new i),d.call(u,A)):p&&!y?(u._writableState&&u._writableState.ended||(A=new i),d.call(u,A)):void 0},_=function(){u.req.on("finish",g)};return(function(A){return A.setHeader&&typeof A.abort=="function"})(u)?(u.on("complete",g),u.on("abort",w),u.req?_():u.on("request",_)):p&&!u._writableState&&(u.on("end",h),u.on("close",h)),u.on("end",x),u.on("finish",g),l.error!==!1&&u.on("error",v),u.on("close",w),function(){u.removeListener("complete",g),u.removeListener("abort",w),u.removeListener("request",_),u.req&&u.req.removeListener("finish",g),u.removeListener("end",h),u.removeListener("close",h),u.removeListener("finish",g),u.removeListener("end",x),u.removeListener("error",v),u.removeListener("close",w)}}},{"../../../errors":477}],487:[function(t,n,a){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(t,n,a){var i,o=t("../../../errors").codes,c=o.ERR_MISSING_ARGS,u=o.ERR_STREAM_DESTROYED;function l(y){if(y)throw y}function d(y,g,m,x){x=(function(_){var A=!1;return function(){A||(A=!0,_.apply(void 0,arguments))}})(x);var v=!1;y.on("close",(function(){v=!0})),i===void 0&&(i=t("./end-of-stream")),i(y,{readable:g,writable:m},(function(_){if(_)return x(_);v=!0,x()}));var w=!1;return function(_){if(!v&&!w)return w=!0,(function(A){return A.setHeader&&typeof A.abort=="function"})(y)?y.abort():typeof y.destroy=="function"?y.destroy():void x(_||new u("pipe"))}}function f(y){y()}function p(y,g){return y.pipe(g)}function h(y){return y.length?typeof y[y.length-1]!="function"?l:y.pop():l}n.exports=function(){for(var y=arguments.length,g=new Array(y),m=0;m<y;m++)g[m]=arguments[m];var x,v=h(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new c("streams");var w=g.map((function(_,A){var P=A<g.length-1;return d(_,P,A>0,(function(B){x||(x=B),B&&w.forEach(f),P||(w.forEach(f),v(x))}))}));return g.reduce(p)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(t,n,a){var i=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(o,c,u,l){var d=(function(f,p,h){return f.highWaterMark!=null?f.highWaterMark:p?f[h]:null})(c,l,u);if(d!=null){if(!isFinite(d)||Math.floor(d)!==d||d<0)throw new i(l?u:"highWaterMark",d);return Math.floor(d)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(t,n,a){n.exports=t("events").EventEmitter},{events:422}],491:[function(t,n,a){(a=n.exports=t("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=t("./lib/_stream_writable.js"),a.Duplex=t("./lib/_stream_duplex.js"),a.Transform=t("./lib/_stream_transform.js"),a.PassThrough=t("./lib/_stream_passthrough.js"),a.finished=t("./lib/internal/streams/end-of-stream.js"),a.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(t,n,a){var i=(function(o){var c=Object.prototype,u=c.hasOwnProperty,l=Object.defineProperty||function(S,C,D){S[C]=D.value},d=typeof Symbol=="function"?Symbol:{},f=d.iterator||"@@iterator",p=d.asyncIterator||"@@asyncIterator",h=d.toStringTag||"@@toStringTag";function y(S,C,D){return Object.defineProperty(S,C,{value:D,enumerable:!0,configurable:!0,writable:!0}),S[C]}try{y({},"")}catch{y=function(C,D,q){return C[D]=q}}function g(S,C,D,q){var M=C&&C.prototype instanceof v?C:v,G=Object.create(M.prototype),X=new E(q||[]);return l(G,"_invoke",{value:H(S,D,X)}),G}function m(S,C,D){try{return{type:"normal",arg:S.call(C,D)}}catch(q){return{type:"throw",arg:q}}}o.wrap=g;var x={};function v(){}function w(){}function _(){}var A={};y(A,f,(function(){return this}));var P=Object.getPrototypeOf,B=P&&P(P(k([])));B&&B!==c&&u.call(B,f)&&(A=B);var T=_.prototype=v.prototype=Object.create(A);function I(S){["next","throw","return"].forEach((function(C){y(S,C,(function(D){return this._invoke(C,D)}))}))}function U(S,C){var D;l(this,"_invoke",{value:function(q,M){function G(){return new C((function(X,re){(function V(J,W,F,Q){var ne=m(S[J],S,W);if(ne.type!=="throw"){var ie=ne.arg,ce=ie.value;return ce&&typeof ce=="object"&&u.call(ce,"__await")?C.resolve(ce.__await).then((function(de){V("next",de,F,Q)}),(function(de){V("throw",de,F,Q)})):C.resolve(ce).then((function(de){ie.value=de,F(ie)}),(function(de){return V("throw",de,F,Q)}))}Q(ne.arg)})(q,M,X,re)}))}return D=D?D.then(G,G):G()}})}function H(S,C,D){var q="suspendedStart";return function(M,G){if(q==="executing")throw new Error("Generator is already running");if(q==="completed"){if(M==="throw")throw G;return N()}for(D.method=M,D.arg=G;;){var X=D.delegate;if(X){var re=z(X,D);if(re){if(re===x)continue;return re}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(q==="suspendedStart")throw q="completed",D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);q="executing";var V=m(S,C,D);if(V.type==="normal"){if(q=D.done?"completed":"suspendedYield",V.arg===x)continue;return{value:V.arg,done:D.done}}V.type==="throw"&&(q="completed",D.method="throw",D.arg=V.arg)}}}function z(S,C){var D=C.method,q=S.iterator[D];if(q===void 0)return C.delegate=null,D==="throw"&&S.iterator.return&&(C.method="return",C.arg=void 0,z(S,C),C.method==="throw")||D!=="return"&&(C.method="throw",C.arg=new TypeError("The iterator does not provide a '"+D+"' method")),x;var M=m(q,S.iterator,C.arg);if(M.type==="throw")return C.method="throw",C.arg=M.arg,C.delegate=null,x;var G=M.arg;return G?G.done?(C[S.resultName]=G.value,C.next=S.nextLoc,C.method!=="return"&&(C.method="next",C.arg=void 0),C.delegate=null,x):G:(C.method="throw",C.arg=new TypeError("iterator result is not an object"),C.delegate=null,x)}function O(S){var C={tryLoc:S[0]};1 in S&&(C.catchLoc=S[1]),2 in S&&(C.finallyLoc=S[2],C.afterLoc=S[3]),this.tryEntries.push(C)}function L(S){var C=S.completion||{};C.type="normal",delete C.arg,S.completion=C}function E(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(O,this),this.reset(!0)}function k(S){if(S){var C=S[f];if(C)return C.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var D=-1,q=function M(){for(;++D<S.length;)if(u.call(S,D))return M.value=S[D],M.done=!1,M;return M.value=void 0,M.done=!0,M};return q.next=q}}return{next:N}}function N(){return{value:void 0,done:!0}}return w.prototype=_,l(T,"constructor",{value:_,configurable:!0}),l(_,"constructor",{value:w,configurable:!0}),w.displayName=y(_,h,"GeneratorFunction"),o.isGeneratorFunction=function(S){var C=typeof S=="function"&&S.constructor;return!!C&&(C===w||(C.displayName||C.name)==="GeneratorFunction")},o.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,_):(S.__proto__=_,y(S,h,"GeneratorFunction")),S.prototype=Object.create(T),S},o.awrap=function(S){return{__await:S}},I(U.prototype),y(U.prototype,p,(function(){return this})),o.AsyncIterator=U,o.async=function(S,C,D,q,M){M===void 0&&(M=Promise);var G=new U(g(S,C,D,q),M);return o.isGeneratorFunction(C)?G:G.next().then((function(X){return X.done?X.value:G.next()}))},I(T),y(T,h,"Generator"),y(T,f,(function(){return this})),y(T,"toString",(function(){return"[object Generator]"})),o.keys=function(S){var C=Object(S),D=[];for(var q in C)D.push(q);return D.reverse(),function M(){for(;D.length;){var G=D.pop();if(G in C)return M.value=G,M.done=!1,M}return M.done=!0,M}},o.values=k,E.prototype={constructor:E,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!S)for(var C in this)C.charAt(0)==="t"&&u.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=void 0)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var C=this;function D(V,J){return G.type="throw",G.arg=S,C.next=V,J&&(C.method="next",C.arg=void 0),!!J}for(var q=this.tryEntries.length-1;q>=0;--q){var M=this.tryEntries[q],G=M.completion;if(M.tryLoc==="root")return D("end");if(M.tryLoc<=this.prev){var X=u.call(M,"catchLoc"),re=u.call(M,"finallyLoc");if(X&&re){if(this.prev<M.catchLoc)return D(M.catchLoc,!0);if(this.prev<M.finallyLoc)return D(M.finallyLoc)}else if(X){if(this.prev<M.catchLoc)return D(M.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return D(M.finallyLoc)}}}},abrupt:function(S,C){for(var D=this.tryEntries.length-1;D>=0;--D){var q=this.tryEntries[D];if(q.tryLoc<=this.prev&&u.call(q,"finallyLoc")&&this.prev<q.finallyLoc){var M=q;break}}M&&(S==="break"||S==="continue")&&M.tryLoc<=C&&C<=M.finallyLoc&&(M=null);var G=M?M.completion:{};return G.type=S,G.arg=C,M?(this.method="next",this.next=M.finallyLoc,x):this.complete(G)},complete:function(S,C){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&C&&(this.next=C),x},finish:function(S){for(var C=this.tryEntries.length-1;C>=0;--C){var D=this.tryEntries[C];if(D.finallyLoc===S)return this.complete(D.completion,D.afterLoc),L(D),x}},catch:function(S){for(var C=this.tryEntries.length-1;C>=0;--C){var D=this.tryEntries[C];if(D.tryLoc===S){var q=D.completion;if(q.type==="throw"){var M=q.arg;L(D)}return M}}throw new Error("illegal catch attempt")},delegateYield:function(S,C,D){return this.delegate={iterator:k(S),resultName:C,nextLoc:D},this.method==="next"&&(this.arg=void 0),x}},o})(typeof n=="object"?n.exports:{});try{regeneratorRuntime=i}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{}],493:[function(t,n,a){var i=t("buffer").Buffer,o=t("inherits"),c=t("hash-base"),u=new Array(16),l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],p=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],y=[1352829926,1548603684,1836072691,2053994217,0];function g(){c.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function m(P,B){return P<<B|P>>>32-B}function x(P,B,T,I,U,H,z,O){return m(P+(B^T^I)+H+z|0,O)+U|0}function v(P,B,T,I,U,H,z,O){return m(P+(B&T|~B&I)+H+z|0,O)+U|0}function w(P,B,T,I,U,H,z,O){return m(P+((B|~T)^I)+H+z|0,O)+U|0}function _(P,B,T,I,U,H,z,O){return m(P+(B&I|T&~I)+H+z|0,O)+U|0}function A(P,B,T,I,U,H,z,O){return m(P+(B^(T|~I))+H+z|0,O)+U|0}o(g,c),g.prototype._update=function(){for(var P=u,B=0;B<16;++B)P[B]=this._block.readInt32LE(4*B);for(var T=0|this._a,I=0|this._b,U=0|this._c,H=0|this._d,z=0|this._e,O=0|this._a,L=0|this._b,E=0|this._c,k=0|this._d,N=0|this._e,S=0;S<80;S+=1){var C,D;S<16?(C=x(T,I,U,H,z,P[l[S]],h[0],f[S]),D=A(O,L,E,k,N,P[d[S]],y[0],p[S])):S<32?(C=v(T,I,U,H,z,P[l[S]],h[1],f[S]),D=_(O,L,E,k,N,P[d[S]],y[1],p[S])):S<48?(C=w(T,I,U,H,z,P[l[S]],h[2],f[S]),D=w(O,L,E,k,N,P[d[S]],y[2],p[S])):S<64?(C=_(T,I,U,H,z,P[l[S]],h[3],f[S]),D=v(O,L,E,k,N,P[d[S]],y[3],p[S])):(C=A(T,I,U,H,z,P[l[S]],h[4],f[S]),D=x(O,L,E,k,N,P[d[S]],y[4],p[S])),T=z,z=H,H=m(U,10),U=I,I=C,O=N,N=k,k=m(E,10),E=L,L=D}var q=this._b+U+k|0;this._b=this._c+H+N|0,this._c=this._d+z+O|0,this._d=this._e+T+L|0,this._e=this._a+I+E|0,this._a=q},g.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var P=i.alloc?i.alloc(20):new i(20);return P.writeInt32LE(this._a,0),P.writeInt32LE(this._b,4),P.writeInt32LE(this._c,8),P.writeInt32LE(this._d,12),P.writeInt32LE(this._e,16),P},n.exports=g},{buffer:220,"hash-base":425,inherits:440}],494:[function(t,n,a){var i=t("buffer"),o=i.Buffer;function c(l,d){for(var f in l)d[f]=l[f]}function u(l,d,f){return o(l,d,f)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=i:(c(i,a),a.Buffer=u),u.prototype=Object.create(o.prototype),c(o,u),u.from=function(l,d,f){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,d,f)},u.alloc=function(l,d,f){if(typeof l!="number")throw new TypeError("Argument must be a number");var p=o(l);return d!==void 0?typeof f=="string"?p.fill(d,f):p.fill(d):p.fill(0),p},u.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},u.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(l)}},{buffer:220}],495:[function(t,n,a){(function(i){(function(){var o,c=t("buffer"),u=c.Buffer,l={};for(o in c)c.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(l[o]=c[o]);var d=l.Buffer={};for(o in u)u.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(d[o]=u[o]);if(l.Buffer.prototype=u.prototype,d.from&&d.from!==Uint8Array.from||(d.from=function(f,p,h){if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof f);if(f&&f.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);return u(f,p,h)}),d.alloc||(d.alloc=function(f,p,h){if(typeof f!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof f);if(f<0||f>=2*(1<<30))throw new RangeError('The value "'+f+'" is invalid for option "size"');var y=u(f);return p&&p.length!==0?typeof h=="string"?y.fill(p,h):y.fill(p):y.fill(0),y}),!l.kStringMaxLength)try{l.kStringMaxLength=i.binding("buffer").kStringMaxLength}catch{}l.constants||(l.constants={MAX_LENGTH:l.kMaxLength},l.kStringMaxLength&&(l.constants.MAX_STRING_LENGTH=l.kStringMaxLength)),n.exports=l}).call(this)}).call(this,t("_process"))},{_process:467,buffer:220}],496:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0});const i=t("xmlchars/xml/1.0/ed5"),o=t("xmlchars/xml/1.1/ed2"),c=t("xmlchars/xmlns/1.0/ed3");var u=i.isS,l=i.isChar,d=i.isNameStartChar,f=i.isNameChar,p=i.S_LIST,h=i.NAME_RE,y=o.isChar,g=c.isNCNameStartChar,m=c.isNCNameChar,x=c.NC_NAME_RE;const v="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",_={__proto__:null,xml:v,xmlns:w},A={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},P=k=>k===34||k===39,B=[34,39],T=[...B,91,62],I=[...B,60,93],U=[61,63,...p],H=[...p,62,38,60];function z(k,N,S){switch(N){case"xml":S!==v&&k.fail(`xml prefix must be bound to ${v}.`);break;case"xmlns":S!==w&&k.fail(`xmlns prefix must be bound to ${w}.`)}switch(S){case w:k.fail(N===""?`the default namespace may not be set to ${S}.`:`may not assign a prefix (even "xmlns") to the URI ${w}.`);break;case v:switch(N){case"xml":break;case"":k.fail(`the default namespace may not be set to ${S}.`);break;default:k.fail("may not assign the xml namespace to another prefix.")}}}const O=k=>x.test(k),L=k=>h.test(k);a.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const E={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};a.SaxesParser=class{constructor(k){this.opt=k??{},this.fragmentOpt=!!this.opt.fragment;const N=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,N){this.nameStartCheck=g,this.nameCheck=m,this.isName=O,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},_);const S=this.opt.additionalNamespaces;S!=null&&((function(C,D){for(const q of Object.keys(D))z(C,q,D[q])})(this,S),Object.assign(this.ns,S))}else this.nameStartCheck=d,this.nameCheck=f,this.isName=L,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var k;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:N}=this;this.state=N?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=N,this.xmlDeclPossible=!N,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:S}=this.opt;if(S===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");S="1.0"}this.setXMLVersion(S),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(A),(k=this.readyHandler)===null||k===void 0||k.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(k,N){this[E[k]]=N}off(k){this[E[k]]=void 0}makeError(k){var N;let S=(N=this.fileName)!==null&&N!==void 0?N:"";return this.trackPosition&&(S.length>0&&(S+=":"),S+=`${this.line}:${this.column}`),S.length>0&&(S+=": "),new Error(S+k)}fail(k){const N=this.makeError(k),S=this.errorHandler;if(S===void 0)throw N;return S(N),this}write(k){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let N=!1;k===null?(N=!0,k=""):typeof k=="object"&&(k=k.toString()),this.carriedFromPrevious!==void 0&&(k=`${this.carriedFromPrevious}${k}`,this.carriedFromPrevious=void 0);let S=k.length;const C=k.charCodeAt(S-1);!N&&(C===13||C>=55296&&C<=56319)&&(this.carriedFromPrevious=k[S-1],S--,k=k.slice(0,S));const{stateTable:D}=this;for(this.chunk=k,this.i=0;this.i<S;)D[this.state].call(this);return this.chunkPosition+=S,N?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:k,i:N}=this;if(this.prevI=N,this.i=N+1,N>=k.length)return-1;const S=k.charCodeAt(N);if(this.column++,S<55296){if(S>=32||S===9)return S;switch(S){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return k.charCodeAt(N+1)===10&&(this.i=N+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),S}}if(S>56319)return S>=57344&&S<=65533||this.fail("disallowed character."),S;const C=65536+1024*(S-55296)+(k.charCodeAt(N+1)-56320);return this.i=N+2,C>1114111&&this.fail("disallowed character."),C}getCode11(){const{chunk:k,i:N}=this;if(this.prevI=N,this.i=N+1,N>=k.length)return-1;const S=k.charCodeAt(N);if(this.column++,S<55296){if(S>31&&S<127||S>159&&S!==8232||S===9)return S;switch(S){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const D=k.charCodeAt(N+1);D!==10&&D!==133||(this.i=N+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),S}}if(S>56319)return S>=57344&&S<=65533||this.fail("disallowed character."),S;const C=65536+1024*(S-55296)+(k.charCodeAt(N+1)-56320);return this.i=N+2,C>1114111&&this.fail("disallowed character."),C}getCodeNorm(){const k=this.getCode();return k===-2?10:k}unget(){this.i=this.prevI,this.column--}captureTo(k){let{i:N}=this;const{chunk:S}=this;for(;;){const C=this.getCode(),D=C===-2,q=D?10:C;if(q===-1||k.includes(q))return this.text+=S.slice(N,this.prevI),q;D&&(this.text+=S.slice(N,this.prevI)+`
`,N=this.i)}}captureToChar(k){let{i:N}=this;const{chunk:S}=this;for(;;){let C=this.getCode();switch(C){case-2:this.text+=S.slice(N,this.prevI)+`
`,N=this.i,C=10;break;case-1:return this.text+=S.slice(N),!1}if(C===k)return this.text+=S.slice(N,this.prevI),!0}}captureNameChars(){const{chunk:k,i:N}=this;for(;;){const S=this.getCode();if(S===-1)return this.name+=k.slice(N),-1;if(!f(S))return this.name+=k.slice(N,this.prevI),S===-2?10:S}}skipSpaces(){for(;;){const k=this.getCodeNorm();if(k===-1||!u(k))return k}}setXMLVersion(k){this.currentXMLVersion=k,k==="1.0"?(this.isChar=l,this.getCode=this.getCode10):(this.isChar=y,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const k=this.i,N=this.skipSpaces();switch(this.prevI!==k&&(this.xmlDeclPossible=!1),N){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var k;const N=this.captureTo(T);switch(N){case 62:(k=this.doctypeHandler)===null||k===void 0||k.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(N),N===91?this.state=4:P(N)&&(this.state=3,this.q=N)}}sDoctypeQuote(){const k=this.q;this.captureToChar(k)&&(this.text+=String.fromCodePoint(k),this.q=null,this.state=2)}sDTD(){const k=this.captureTo(I);k!==-1&&(this.text+=String.fromCodePoint(k),k===93?this.state=2:k===60?this.state=6:P(k)&&(this.state=5,this.q=k))}sDTDQuoted(){const k=this.q;this.captureToChar(k)&&(this.text+=String.fromCodePoint(k),this.state=4,this.q=null)}sDTDOpenWaka(){const k=this.getCodeNorm();switch(this.text+=String.fromCodePoint(k),k){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const k=String.fromCodePoint(this.getCodeNorm()),N=this.openWakaBang+=k;this.text+=k,N!=="-"&&(this.state=N==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const k=this.getCodeNorm();this.text+=String.fromCodePoint(k),this.state=k===45?10:8}sDTDCommentEnded(){const k=this.getCodeNorm();this.text+=String.fromCodePoint(k),k===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const k=this.getCodeNorm();this.text+=String.fromCodePoint(k),k===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:k}=this;const{chunk:N}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=N.slice(k,this.prevI)+`
`,k=this.i;break;case 59:{const{entityReturnState:S}=this,C=this.entity+N.slice(k,this.prevI);let D;this.state=S,C===""?(this.fail("empty entity name."),D="&;"):(D=this.parseEntity(C),this.entity=""),S===13&&this.textHandler===void 0||(this.text+=D);break e}case-1:this.entity+=N.slice(k);break e}}sOpenWaka(){const k=this.getCode();if(d(k))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(k){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var k;const N=this.getCodeNorm();N===45?(this.state=19,(k=this.commentHandler)===null||k===void 0||k.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(N),this.state=17)}sCommentEnded(){const k=this.getCodeNorm();k!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(k),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const k=this.getCodeNorm();k===93?this.state=22:(this.text+="]"+String.fromCodePoint(k),this.state=20)}sCDataEnding2(){var k;const N=this.getCodeNorm();switch(N){case 62:(k=this.cdataHandler)===null||k===void 0||k.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(N),this.state=20}}sPIFirstChar(){const k=this.getCodeNorm();this.nameStartCheck(k)?(this.piTarget+=String.fromCodePoint(k),this.state=24):k===63||u(k)?(this.fail("processing instruction without a target."),this.state=k===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(k),this.state=24)}sPIRest(){const{chunk:k,i:N}=this;for(;;){const S=this.getCodeNorm();if(S===-1)return void(this.piTarget+=k.slice(N));if(!this.nameCheck(S)){this.piTarget+=k.slice(N,this.prevI);const C=S===63;C||u(S)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=C?33:27):this.state=C?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(S));break}}}sPIBody(){if(this.text.length===0){const k=this.getCodeNorm();k===63?this.state=26:u(k)||(this.text=String.fromCodePoint(k))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var k;const N=this.getCodeNorm();if(N===62){const{piTarget:S}=this;S.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(k=this.piHandler)===null||k===void 0||k.call(this,{target:S,body:this.text}),this.piTarget=this.text="",this.state=13}else N===63?this.text+="?":(this.text+="?"+String.fromCodePoint(N),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const k=this.skipSpaces();k!==63?k!==-1&&(this.state=28,this.name=String.fromCodePoint(k)):this.state=33}sXMLDeclName(){const k=this.captureTo(U);if(k===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(u(k)||k===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=k===61?30:29}}sXMLDeclEq(){const k=this.getCodeNorm();if(k===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(k)||(k!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const k=this.getCodeNorm();if(k===63)return this.state=33,void this.fail("XML declaration is incomplete.");u(k)||(P(k)?this.q=k:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const k=this.captureTo([this.q,63]);if(k===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(k===-1)return;const N=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const S=N;this.xmlDecl.version=S,/^1\.[0-9]+$/.test(S)?this.opt.forceXMLVersion||this.setXMLVersion(S):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(N)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=N;break;case"standalone":N!=="yes"&&N!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=N}this.name="",this.state=32}sXMLDeclSeparator(){const k=this.getCodeNorm();k!==63?(u(k)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var k;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(k=this.xmldeclHandler)===null||k===void 0||k.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var k;const N=this.captureNameChars();if(N===-1)return;const S=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=S.ns=Object.create(null)),(k=this.openTagStartHandler)===null||k===void 0||k.call(this,S),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),N){case 62:this.openTag();break;case 47:this.state=35;break;default:u(N)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const k=this.skipSpaces();k!==-1&&(d(k)?(this.unget(),this.state=37):k===62?this.openTag():k===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const k=this.captureNameChars();k===61?this.state=39:u(k)?this.state=38:k===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):k!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const k=this.skipSpaces();switch(k){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",k===62?this.openTag():d(k)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const k=this.getCodeNorm();P(k)?(this.q=k,this.state=40):u(k)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:k,chunk:N}=this;let{i:S}=this;for(;;)switch(this.getCode()){case k:return this.pushAttrib(this.name,this.text+N.slice(S,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=N.slice(S,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=N.slice(S,this.prevI)+" ",S=this.i;break;case 60:return this.text+=N.slice(S,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=N.slice(S))}}sAttribValueClosed(){const k=this.getCodeNorm();u(k)?this.state=36:k===62?this.openTag():k===47?this.state=35:d(k)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const k=this.captureTo(H);switch(k){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",k===62?this.openTag():this.state=36}}sCloseTag(){const k=this.captureNameChars();k===62?this.closeTag():u(k)?this.state=44:k!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:k,forbiddenState:N}=this;const{chunk:S,textHandler:C}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,C!==void 0){const{text:D}=this,q=S.slice(k,this.prevI);D.length!==0?(C(D+q),this.text=""):q.length!==0&&C(q)}N=0;break e;case 38:this.state=14,this.entityReturnState=13,C!==void 0&&(this.text+=S.slice(k,this.prevI)),N=0;break e;case 93:switch(N){case 0:N=1;break;case 1:N=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:N===2&&this.fail('the string "]]>" is disallowed in char data.'),N=0;break;case-2:C!==void 0&&(this.text+=S.slice(k,this.prevI)+`
`),k=this.i,N=0;break;case-1:C!==void 0&&(this.text+=S.slice(k));break e;default:N=0}this.forbiddenState=N}handleTextOutsideRoot(){let{i:k}=this;const{chunk:N,textHandler:S}=this;let C=!1;e:for(;;){const D=this.getCode();switch(D){case 60:if(this.state=15,S!==void 0){const{text:q}=this,M=N.slice(k,this.prevI);q.length!==0?(S(q+M),this.text=""):M.length!==0&&S(M)}break e;case 38:this.state=14,this.entityReturnState=13,S!==void 0&&(this.text+=N.slice(k,this.prevI)),C=!0;break e;case-2:S!==void 0&&(this.text+=N.slice(k,this.prevI)+`
`),k=this.i;break;case-1:S!==void 0&&(this.text+=N.slice(k));break e;default:u(D)||(C=!0)}}C&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(k,N){var S;const{prefix:C,local:D}=this.qname(k),q={name:k,prefix:C,local:D,value:N};if(this.attribList.push(q),(S=this.attributeHandler)===null||S===void 0||S.call(this,q),C==="xmlns"){const M=N.trim();this.currentXMLVersion==="1.0"&&M===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[D]=M,z(this,D,M)}else if(k==="xmlns"){const M=N.trim();this.topNS[""]=M,z(this,"",M)}}pushAttribPlain(k,N){var S;const C={name:k,value:N};this.attribList.push(C),(S=this.attributeHandler)===null||S===void 0||S.call(this,C)}end(){var k,N;this.sawRoot||this.fail("document must contain a root element.");const{tags:S}=this;for(;S.length>0;){const D=S.pop();this.fail("unclosed tag: "+D.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:C}=this;return C.length!==0&&((k=this.textHandler)===null||k===void 0||k.call(this,C),this.text=""),this._closed=!0,(N=this.endHandler)===null||N===void 0||N.call(this),this._init(),this}resolve(k){var N,S;let C=this.topNS[k];if(C!==void 0)return C;const{tags:D}=this;for(let q=D.length-1;q>=0;q--)if(C=D[q].ns[k],C!==void 0)return C;return C=this.ns[k],C!==void 0?C:(S=(N=this.opt).resolvePrefix)===null||S===void 0?void 0:S.call(N,k)}qname(k){const N=k.indexOf(":");if(N===-1)return{prefix:"",local:k};const S=k.slice(N+1),C=k.slice(0,N);return(C===""||S===""||S.includes(":"))&&this.fail(`malformed name: ${k}.`),{prefix:C,local:S}}processAttribsNS(){var k;const{attribList:N}=this,S=this.tag;{const{prefix:q,local:M}=this.qname(S.name);S.prefix=q,S.local=M;const G=S.uri=(k=this.resolve(q))!==null&&k!==void 0?k:"";q!==""&&(q==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),G===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(q)}.`),S.uri=q))}if(N.length===0)return;const{attributes:C}=S,D=new Set;for(const q of N){const{name:M,prefix:G,local:X}=q;let re,V;G===""?(re=M==="xmlns"?w:"",V=M):(re=this.resolve(G),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(G)}.`),re=G),V=`{${re}}${X}`),D.has(V)&&this.fail(`duplicate attribute: ${V}.`),D.add(V),q.uri=re,C[M]=q}this.attribList=[]}processAttribsPlain(){const{attribList:k}=this,N=this.tag.attributes;for(const{name:S,value:C}of k)N[S]!==void 0&&this.fail(`duplicate attribute: ${S}.`),N[S]=C;this.attribList=[]}openTag(){var k;this.processAttribs();const{tags:N}=this,S=this.tag;S.isSelfClosing=!1,(k=this.openTagHandler)===null||k===void 0||k.call(this,S),N.push(S),this.state=13,this.name=""}openSelfClosingTag(){var k,N,S;this.processAttribs();const{tags:C}=this,D=this.tag;D.isSelfClosing=!0,(k=this.openTagHandler)===null||k===void 0||k.call(this,D),(N=this.closeTagHandler)===null||N===void 0||N.call(this,D),(this.tag=(S=C[C.length-1])!==null&&S!==void 0?S:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:k,name:N}=this;if(this.state=13,this.name="",N==="")return this.fail("weird empty close tag."),void(this.text+="</>");const S=this.closeTagHandler;let C=k.length;for(;C-- >0;){const D=this.tag=k.pop();if(this.topNS=D.ns,S?.(D),D.name===N)break;this.fail("unexpected close tag.")}C===0?this.closedRoot=!0:C<0&&(this.fail(`unmatched closing tag: ${N}.`),this.text+=`</${N}>`)}parseEntity(k){if(k[0]!=="#"){const S=this.ENTITIES[k];return S!==void 0?S:(this.fail(this.isName(k)?"undefined entity.":"disallowed character in entity name."),`&${k};`)}let N=NaN;return k[1]==="x"&&/^#x[0-9a-f]+$/i.test(k)?N=parseInt(k.slice(2),16):/^#[0-9]+$/.test(k)&&(N=parseInt(k.slice(1),10)),this.isChar(N)?String.fromCodePoint(N):(this.fail("malformed character entity."),`&${k};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(t,n,a){var i=t("safe-buffer").Buffer;function o(c,u){this._block=i.alloc(c),this._finalSize=u,this._blockSize=c,this._len=0}o.prototype.update=function(c,u){typeof c=="string"&&(u=u||"utf8",c=i.from(c,u));for(var l=this._block,d=this._blockSize,f=c.length,p=this._len,h=0;h<f;){for(var y=p%d,g=Math.min(f-h,d-y),m=0;m<g;m++)l[y+m]=c[h+m];h+=g,(p+=g)%d==0&&this._update(l)}return this._len+=f,this},o.prototype.digest=function(c){var u=this._len%this._blockSize;this._block[u]=128,this._block.fill(0,u+1),u>=this._finalSize&&(this._update(this._block),this._block.fill(0));var l=8*this._len;if(l<=4294967295)this._block.writeUInt32BE(l,this._blockSize-4);else{var d=(4294967295&l)>>>0,f=(l-d)/4294967296;this._block.writeUInt32BE(f,this._blockSize-8),this._block.writeUInt32BE(d,this._blockSize-4)}this._update(this._block);var p=this._hash();return c?p.toString(c):p},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=o},{"safe-buffer":494}],498:[function(t,n,a){var i=n.exports=function(o){o=o.toLowerCase();var c=i[o];if(!c)throw new Error(o+" is not supported (we accept pull requests)");return new c};i.sha=t("./sha"),i.sha1=t("./sha1"),i.sha224=t("./sha224"),i.sha256=t("./sha256"),i.sha384=t("./sha384"),i.sha512=t("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(t,n,a){var i=t("inherits"),o=t("./hash"),c=t("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function d(){this.init(),this._w=l,o.call(this,64,56)}function f(h){return h<<30|h>>>2}function p(h,y,g,m){return h===0?y&g|~y&m:h===2?y&g|y&m|g&m:y^g^m}i(d,o),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(h){for(var y,g=this._w,m=0|this._a,x=0|this._b,v=0|this._c,w=0|this._d,_=0|this._e,A=0;A<16;++A)g[A]=h.readInt32BE(4*A);for(;A<80;++A)g[A]=g[A-3]^g[A-8]^g[A-14]^g[A-16];for(var P=0;P<80;++P){var B=~~(P/20),T=0|((y=m)<<5|y>>>27)+p(B,x,v,w)+_+g[P]+u[B];_=w,w=v,v=f(x),x=m,m=T}this._a=m+this._a|0,this._b=x+this._b|0,this._c=v+this._c|0,this._d=w+this._d|0,this._e=_+this._e|0},d.prototype._hash=function(){var h=c.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(t,n,a){var i=t("inherits"),o=t("./hash"),c=t("safe-buffer").Buffer,u=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function d(){this.init(),this._w=l,o.call(this,64,56)}function f(y){return y<<5|y>>>27}function p(y){return y<<30|y>>>2}function h(y,g,m,x){return y===0?g&m|~g&x:y===2?g&m|g&x|m&x:g^m^x}i(d,o),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(y){for(var g,m=this._w,x=0|this._a,v=0|this._b,w=0|this._c,_=0|this._d,A=0|this._e,P=0;P<16;++P)m[P]=y.readInt32BE(4*P);for(;P<80;++P)m[P]=(g=m[P-3]^m[P-8]^m[P-14]^m[P-16])<<1|g>>>31;for(var B=0;B<80;++B){var T=~~(B/20),I=f(x)+h(T,v,w,_)+A+m[B]+u[T]|0;A=_,_=w,w=p(v),v=x,x=I}this._a=x+this._a|0,this._b=v+this._b|0,this._c=w+this._c|0,this._d=_+this._d|0,this._e=A+this._e|0},d.prototype._hash=function(){var y=c.allocUnsafe(20);return y.writeInt32BE(0|this._a,0),y.writeInt32BE(0|this._b,4),y.writeInt32BE(0|this._c,8),y.writeInt32BE(0|this._d,12),y.writeInt32BE(0|this._e,16),y},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(t,n,a){var i=t("inherits"),o=t("./sha256"),c=t("./hash"),u=t("safe-buffer").Buffer,l=new Array(64);function d(){this.init(),this._w=l,c.call(this,64,56)}i(d,o),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var f=u.allocUnsafe(28);return f.writeInt32BE(this._a,0),f.writeInt32BE(this._b,4),f.writeInt32BE(this._c,8),f.writeInt32BE(this._d,12),f.writeInt32BE(this._e,16),f.writeInt32BE(this._f,20),f.writeInt32BE(this._g,24),f},n.exports=d},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(t,n,a){var i=t("inherits"),o=t("./hash"),c=t("safe-buffer").Buffer,u=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=new Array(64);function d(){this.init(),this._w=l,o.call(this,64,56)}function f(m,x,v){return v^m&(x^v)}function p(m,x,v){return m&x|v&(m|x)}function h(m){return(m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10)}function y(m){return(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7)}function g(m){return(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3}i(d,o),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(m){for(var x,v=this._w,w=0|this._a,_=0|this._b,A=0|this._c,P=0|this._d,B=0|this._e,T=0|this._f,I=0|this._g,U=0|this._h,H=0;H<16;++H)v[H]=m.readInt32BE(4*H);for(;H<64;++H)v[H]=0|(((x=v[H-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+v[H-7]+g(v[H-15])+v[H-16];for(var z=0;z<64;++z){var O=U+y(B)+f(B,T,I)+u[z]+v[z]|0,L=h(w)+p(w,_,A)|0;U=I,I=T,T=B,B=P+O|0,P=A,A=_,_=w,w=O+L|0}this._a=w+this._a|0,this._b=_+this._b|0,this._c=A+this._c|0,this._d=P+this._d|0,this._e=B+this._e|0,this._f=T+this._f|0,this._g=I+this._g|0,this._h=U+this._h|0},d.prototype._hash=function(){var m=c.allocUnsafe(32);return m.writeInt32BE(this._a,0),m.writeInt32BE(this._b,4),m.writeInt32BE(this._c,8),m.writeInt32BE(this._d,12),m.writeInt32BE(this._e,16),m.writeInt32BE(this._f,20),m.writeInt32BE(this._g,24),m.writeInt32BE(this._h,28),m},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(t,n,a){var i=t("inherits"),o=t("./sha512"),c=t("./hash"),u=t("safe-buffer").Buffer,l=new Array(160);function d(){this.init(),this._w=l,c.call(this,128,112)}i(d,o),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){var f=u.allocUnsafe(48);function p(h,y,g){f.writeInt32BE(h,g),f.writeInt32BE(y,g+4)}return p(this._ah,this._al,0),p(this._bh,this._bl,8),p(this._ch,this._cl,16),p(this._dh,this._dl,24),p(this._eh,this._el,32),p(this._fh,this._fl,40),f},n.exports=d},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(t,n,a){var i=t("inherits"),o=t("./hash"),c=t("safe-buffer").Buffer,u=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=new Array(160);function d(){this.init(),this._w=l,o.call(this,128,112)}function f(_,A,P){return P^_&(A^P)}function p(_,A,P){return _&A|P&(_|A)}function h(_,A){return(_>>>28|A<<4)^(A>>>2|_<<30)^(A>>>7|_<<25)}function y(_,A){return(_>>>14|A<<18)^(_>>>18|A<<14)^(A>>>9|_<<23)}function g(_,A){return(_>>>1|A<<31)^(_>>>8|A<<24)^_>>>7}function m(_,A){return(_>>>1|A<<31)^(_>>>8|A<<24)^(_>>>7|A<<25)}function x(_,A){return(_>>>19|A<<13)^(A>>>29|_<<3)^_>>>6}function v(_,A){return(_>>>19|A<<13)^(A>>>29|_<<3)^(_>>>6|A<<26)}function w(_,A){return _>>>0<A>>>0?1:0}i(d,o),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(_){for(var A=this._w,P=0|this._ah,B=0|this._bh,T=0|this._ch,I=0|this._dh,U=0|this._eh,H=0|this._fh,z=0|this._gh,O=0|this._hh,L=0|this._al,E=0|this._bl,k=0|this._cl,N=0|this._dl,S=0|this._el,C=0|this._fl,D=0|this._gl,q=0|this._hl,M=0;M<32;M+=2)A[M]=_.readInt32BE(4*M),A[M+1]=_.readInt32BE(4*M+4);for(;M<160;M+=2){var G=A[M-30],X=A[M-30+1],re=g(G,X),V=m(X,G),J=x(G=A[M-4],X=A[M-4+1]),W=v(X,G),F=A[M-14],Q=A[M-14+1],ne=A[M-32],ie=A[M-32+1],ce=V+Q|0,de=re+F+w(ce,V)|0;de=(de=de+J+w(ce=ce+W|0,W)|0)+ne+w(ce=ce+ie|0,ie)|0,A[M]=de,A[M+1]=ce}for(var le=0;le<160;le+=2){de=A[le],ce=A[le+1];var _e=p(P,B,T),ue=p(L,E,k),pe=h(P,L),me=h(L,P),Ce=y(U,S),fe=y(S,U),xe=u[le],je=u[le+1],Oe=f(U,H,z),Ie=f(S,C,D),Le=q+fe|0,He=O+Ce+w(Le,q)|0;He=(He=(He=He+Oe+w(Le=Le+Ie|0,Ie)|0)+xe+w(Le=Le+je|0,je)|0)+de+w(Le=Le+ce|0,ce)|0;var Qe=me+ue|0,Je=pe+_e+w(Qe,me)|0;O=z,q=D,z=H,D=C,H=U,C=S,U=I+He+w(S=N+Le|0,N)|0,I=T,N=k,T=B,k=E,B=P,E=L,P=He+Je+w(L=Le+Qe|0,Le)|0}this._al=this._al+L|0,this._bl=this._bl+E|0,this._cl=this._cl+k|0,this._dl=this._dl+N|0,this._el=this._el+S|0,this._fl=this._fl+C|0,this._gl=this._gl+D|0,this._hl=this._hl+q|0,this._ah=this._ah+P+w(this._al,L)|0,this._bh=this._bh+B+w(this._bl,E)|0,this._ch=this._ch+T+w(this._cl,k)|0,this._dh=this._dh+I+w(this._dl,N)|0,this._eh=this._eh+U+w(this._el,S)|0,this._fh=this._fh+H+w(this._fl,C)|0,this._gh=this._gh+z+w(this._gl,D)|0,this._hh=this._hh+O+w(this._hl,q)|0},d.prototype._hash=function(){var _=c.allocUnsafe(64);function A(P,B,T){_.writeInt32BE(P,T),_.writeInt32BE(B,T+4)}return A(this._ah,this._al,0),A(this._bh,this._bl,8),A(this._ch,this._cl,16),A(this._dh,this._dl,24),A(this._eh,this._el,32),A(this._fh,this._fl,40),A(this._gh,this._gl,48),A(this._hh,this._hl,56),_},n.exports=d},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(t,n,a){n.exports=o;var i=t("events").EventEmitter;function o(){i.call(this)}t("inherits")(o,i),o.Readable=t("readable-stream/readable.js"),o.Writable=t("readable-stream/writable.js"),o.Duplex=t("readable-stream/duplex.js"),o.Transform=t("readable-stream/transform.js"),o.PassThrough=t("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(c,u){var l=this;function d(x){c.writable&&c.write(x)===!1&&l.pause&&l.pause()}function f(){l.readable&&l.resume&&l.resume()}l.on("data",d),c.on("drain",f),c._isStdio||u&&u.end===!1||(l.on("end",h),l.on("close",y));var p=!1;function h(){p||(p=!0,c.end())}function y(){p||(p=!0,typeof c.destroy=="function"&&c.destroy())}function g(x){if(m(),i.listenerCount(this,"error")===0)throw x}function m(){l.removeListener("data",d),c.removeListener("drain",f),l.removeListener("end",h),l.removeListener("close",y),l.removeListener("error",g),c.removeListener("error",g),l.removeListener("end",m),l.removeListener("close",m),c.removeListener("close",m)}return l.on("error",g),c.on("error",g),l.on("end",m),l.on("close",m),c.on("close",m),c.emit("pipe",l),c}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(t,n,a){var i={}.toString;n.exports=Array.isArray||function(o){return i.call(o)=="[object Array]"}},{}],507:[function(t,n,a){n.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(t,n,a){var i=t("process-nextick-args"),o=Object.keys||function(m){var x=[];for(var v in m)x.push(v);return x};n.exports=h;var c=Object.create(t("core-util-is"));c.inherits=t("inherits");var u=t("./_stream_readable"),l=t("./_stream_writable");c.inherits(h,u);for(var d=o(l.prototype),f=0;f<d.length;f++){var p=d[f];h.prototype[p]||(h.prototype[p]=l.prototype[p])}function h(m){if(!(this instanceof h))return new h(m);u.call(this,m),l.call(this,m),m&&m.readable===!1&&(this.readable=!1),m&&m.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,m&&m.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",y)}function y(){this.allowHalfOpen||this._writableState.ended||i.nextTick(g,this)}function g(m){m.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(m){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=m,this._writableState.destroyed=m)}}),h.prototype._destroy=function(m,x){this.push(null),this.end(),i.nextTick(x,m)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(t,n,a){n.exports=c;var i=t("./_stream_transform"),o=Object.create(t("core-util-is"));function c(u){if(!(this instanceof c))return new c(u);i.call(this,u)}o.inherits=t("inherits"),o.inherits(c,i),c.prototype._transform=function(u,l,d){d(null,u)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(t,n,a){(function(i,o){(function(){var c=t("process-nextick-args");n.exports=P;var u,l=t("isarray");P.ReadableState=A,t("events").EventEmitter;var d=function(q,M){return q.listeners(M).length},f=t("./internal/streams/stream"),p=t("safe-buffer").Buffer,h=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},y=Object.create(t("core-util-is"));y.inherits=t("inherits");var g=t("util"),m=void 0;m=g&&g.debuglog?g.debuglog("stream"):function(){};var x,v=t("./internal/streams/BufferList"),w=t("./internal/streams/destroy");y.inherits(P,f);var _=["error","close","destroy","pause","resume"];function A(q,M){q=q||{};var G=M instanceof(u=u||t("./_stream_duplex"));this.objectMode=!!q.objectMode,G&&(this.objectMode=this.objectMode||!!q.readableObjectMode);var X=q.highWaterMark,re=q.readableHighWaterMark,V=this.objectMode?16:16384;this.highWaterMark=X||X===0?X:G&&(re||re===0)?re:V,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,q.encoding&&(x||(x=t("string_decoder/").StringDecoder),this.decoder=new x(q.encoding),this.encoding=q.encoding)}function P(q){if(u=u||t("./_stream_duplex"),!(this instanceof P))return new P(q);this._readableState=new A(q,this),this.readable=!0,q&&(typeof q.read=="function"&&(this._read=q.read),typeof q.destroy=="function"&&(this._destroy=q.destroy)),f.call(this)}function B(q,M,G,X,re){var V,J=q._readableState;return M===null?(J.reading=!1,(function(W,F){if(!F.ended){if(F.decoder){var Q=F.decoder.end();Q&&Q.length&&(F.buffer.push(Q),F.length+=F.objectMode?1:Q.length)}F.ended=!0,U(W)}})(q,J)):(re||(V=(function(W,F){var Q;ne=F,p.isBuffer(ne)||ne instanceof h||typeof F=="string"||F===void 0||W.objectMode||(Q=new TypeError("Invalid non-string/buffer chunk"));var ne;return Q})(J,M)),V?q.emit("error",V):J.objectMode||M&&M.length>0?(typeof M=="string"||J.objectMode||Object.getPrototypeOf(M)===p.prototype||(M=(function(W){return p.from(W)})(M)),X?J.endEmitted?q.emit("error",new Error("stream.unshift() after end event")):T(q,J,M,!0):J.ended?q.emit("error",new Error("stream.push() after EOF")):(J.reading=!1,J.decoder&&!G?(M=J.decoder.write(M),J.objectMode||M.length!==0?T(q,J,M,!1):z(q,J)):T(q,J,M,!1))):X||(J.reading=!1)),(function(W){return!W.ended&&(W.needReadable||W.length<W.highWaterMark||W.length===0)})(J)}function T(q,M,G,X){M.flowing&&M.length===0&&!M.sync?(q.emit("data",G),q.read(0)):(M.length+=M.objectMode?1:G.length,X?M.buffer.unshift(G):M.buffer.push(G),M.needReadable&&U(q)),z(q,M)}Object.defineProperty(P.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(q){this._readableState&&(this._readableState.destroyed=q)}}),P.prototype.destroy=w.destroy,P.prototype._undestroy=w.undestroy,P.prototype._destroy=function(q,M){this.push(null),M(q)},P.prototype.push=function(q,M){var G,X=this._readableState;return X.objectMode?G=!0:typeof q=="string"&&((M=M||X.defaultEncoding)!==X.encoding&&(q=p.from(q,M),M=""),G=!0),B(this,q,M,!1,G)},P.prototype.unshift=function(q){return B(this,q,null,!0,!1)},P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(q){return x||(x=t("string_decoder/").StringDecoder),this._readableState.decoder=new x(q),this._readableState.encoding=q,this};function I(q,M){return q<=0||M.length===0&&M.ended?0:M.objectMode?1:q!=q?M.flowing&&M.length?M.buffer.head.data.length:M.length:(q>M.highWaterMark&&(M.highWaterMark=(function(G){return G>=8388608?G=8388608:(G--,G|=G>>>1,G|=G>>>2,G|=G>>>4,G|=G>>>8,G|=G>>>16,G++),G})(q)),q<=M.length?q:M.ended?M.length:(M.needReadable=!0,0))}function U(q){var M=q._readableState;M.needReadable=!1,M.emittedReadable||(m("emitReadable",M.flowing),M.emittedReadable=!0,M.sync?c.nextTick(H,q):H(q))}function H(q){m("emit readable"),q.emit("readable"),k(q)}function z(q,M){M.readingMore||(M.readingMore=!0,c.nextTick(O,q,M))}function O(q,M){for(var G=M.length;!M.reading&&!M.flowing&&!M.ended&&M.length<M.highWaterMark&&(m("maybeReadMore read 0"),q.read(0),G!==M.length);)G=M.length;M.readingMore=!1}function L(q){m("readable nexttick read 0"),q.read(0)}function E(q,M){M.reading||(m("resume read 0"),q.read(0)),M.resumeScheduled=!1,M.awaitDrain=0,q.emit("resume"),k(q),M.flowing&&!M.reading&&q.read(0)}function k(q){var M=q._readableState;for(m("flow",M.flowing);M.flowing&&q.read()!==null;);}function N(q,M){return M.length===0?null:(M.objectMode?G=M.buffer.shift():!q||q>=M.length?(G=M.decoder?M.buffer.join(""):M.buffer.length===1?M.buffer.head.data:M.buffer.concat(M.length),M.buffer.clear()):G=(function(X,re,V){var J;return X<re.head.data.length?(J=re.head.data.slice(0,X),re.head.data=re.head.data.slice(X)):J=X===re.head.data.length?re.shift():V?(function(W,F){var Q=F.head,ne=1,ie=Q.data;for(W-=ie.length;Q=Q.next;){var ce=Q.data,de=W>ce.length?ce.length:W;if(de===ce.length?ie+=ce:ie+=ce.slice(0,W),(W-=de)===0){de===ce.length?(++ne,Q.next?F.head=Q.next:F.head=F.tail=null):(F.head=Q,Q.data=ce.slice(de));break}++ne}return F.length-=ne,ie})(X,re):(function(W,F){var Q=p.allocUnsafe(W),ne=F.head,ie=1;for(ne.data.copy(Q),W-=ne.data.length;ne=ne.next;){var ce=ne.data,de=W>ce.length?ce.length:W;if(ce.copy(Q,Q.length-W,0,de),(W-=de)===0){de===ce.length?(++ie,ne.next?F.head=ne.next:F.head=F.tail=null):(F.head=ne,ne.data=ce.slice(de));break}++ie}return F.length-=ie,Q})(X,re),J})(q,M.buffer,M.decoder),G);var G}function S(q){var M=q._readableState;if(M.length>0)throw new Error('"endReadable()" called on non-empty stream');M.endEmitted||(M.ended=!0,c.nextTick(C,M,q))}function C(q,M){q.endEmitted||q.length!==0||(q.endEmitted=!0,M.readable=!1,M.emit("end"))}function D(q,M){for(var G=0,X=q.length;G<X;G++)if(q[G]===M)return G;return-1}P.prototype.read=function(q){m("read",q),q=parseInt(q,10);var M=this._readableState,G=q;if(q!==0&&(M.emittedReadable=!1),q===0&&M.needReadable&&(M.length>=M.highWaterMark||M.ended))return m("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?S(this):U(this),null;if((q=I(q,M))===0&&M.ended)return M.length===0&&S(this),null;var X,re=M.needReadable;return m("need readable",re),(M.length===0||M.length-q<M.highWaterMark)&&m("length less than watermark",re=!0),M.ended||M.reading?m("reading or ended",re=!1):re&&(m("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(q=I(G,M))),(X=q>0?N(q,M):null)===null?(M.needReadable=!0,q=0):M.length-=q,M.length===0&&(M.ended||(M.needReadable=!0),G!==q&&M.ended&&S(this)),X!==null&&this.emit("data",X),X},P.prototype._read=function(q){this.emit("error",new Error("_read() is not implemented"))},P.prototype.pipe=function(q,M){var G=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=q;break;case 1:X.pipes=[X.pipes,q];break;default:X.pipes.push(q)}X.pipesCount+=1,m("pipe count=%d opts=%j",X.pipesCount,M);var re=(!M||M.end!==!1)&&q!==i.stdout&&q!==i.stderr?J:le;function V(_e,ue){m("onunpipe"),_e===G&&ue&&ue.hasUnpiped===!1&&(ue.hasUnpiped=!0,m("cleanup"),q.removeListener("close",ce),q.removeListener("finish",de),q.removeListener("drain",W),q.removeListener("error",ie),q.removeListener("unpipe",V),G.removeListener("end",J),G.removeListener("end",le),G.removeListener("data",ne),F=!0,!X.awaitDrain||q._writableState&&!q._writableState.needDrain||W())}function J(){m("onend"),q.end()}X.endEmitted?c.nextTick(re):G.once("end",re),q.on("unpipe",V);var W=(function(_e){return function(){var ue=_e._readableState;m("pipeOnDrain",ue.awaitDrain),ue.awaitDrain&&ue.awaitDrain--,ue.awaitDrain===0&&d(_e,"data")&&(ue.flowing=!0,k(_e))}})(G);q.on("drain",W);var F=!1,Q=!1;function ne(_e){m("ondata"),Q=!1,q.write(_e)!==!1||Q||((X.pipesCount===1&&X.pipes===q||X.pipesCount>1&&D(X.pipes,q)!==-1)&&!F&&(m("false write response, pause",X.awaitDrain),X.awaitDrain++,Q=!0),G.pause())}function ie(_e){m("onerror",_e),le(),q.removeListener("error",ie),d(q,"error")===0&&q.emit("error",_e)}function ce(){q.removeListener("finish",de),le()}function de(){m("onfinish"),q.removeListener("close",ce),le()}function le(){m("unpipe"),G.unpipe(q)}return G.on("data",ne),(function(_e,ue,pe){if(typeof _e.prependListener=="function")return _e.prependListener(ue,pe);_e._events&&_e._events[ue]?l(_e._events[ue])?_e._events[ue].unshift(pe):_e._events[ue]=[pe,_e._events[ue]]:_e.on(ue,pe)})(q,"error",ie),q.once("close",ce),q.once("finish",de),q.emit("pipe",G),X.flowing||(m("pipe resume"),G.resume()),q},P.prototype.unpipe=function(q){var M=this._readableState,G={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return q&&q!==M.pipes||(q||(q=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,q&&q.emit("unpipe",this,G)),this;if(!q){var X=M.pipes,re=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var V=0;V<re;V++)X[V].emit("unpipe",this,{hasUnpiped:!1});return this}var J=D(M.pipes,q);return J===-1||(M.pipes.splice(J,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),q.emit("unpipe",this,G)),this},P.prototype.on=function(q,M){var G=f.prototype.on.call(this,q,M);if(q==="data")this._readableState.flowing!==!1&&this.resume();else if(q==="readable"){var X=this._readableState;X.endEmitted||X.readableListening||(X.readableListening=X.needReadable=!0,X.emittedReadable=!1,X.reading?X.length&&U(this):c.nextTick(L,this))}return G},P.prototype.addListener=P.prototype.on,P.prototype.resume=function(){var q=this._readableState;return q.flowing||(m("resume"),q.flowing=!0,(function(M,G){G.resumeScheduled||(G.resumeScheduled=!0,c.nextTick(E,M,G))})(this,q)),this},P.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},P.prototype.wrap=function(q){var M=this,G=this._readableState,X=!1;for(var re in q.on("end",(function(){if(m("wrapped end"),G.decoder&&!G.ended){var J=G.decoder.end();J&&J.length&&M.push(J)}M.push(null)})),q.on("data",(function(J){m("wrapped data"),G.decoder&&(J=G.decoder.write(J)),G.objectMode&&J==null||(G.objectMode||J&&J.length)&&(M.push(J)||(X=!0,q.pause()))})),q)this[re]===void 0&&typeof q[re]=="function"&&(this[re]=(function(J){return function(){return q[J].apply(q,arguments)}})(re));for(var V=0;V<_.length;V++)q.on(_[V],this.emit.bind(this,_[V]));return this._read=function(J){m("wrapped _read",J),X&&(X=!1,q.resume())},this},Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),P._fromList=N}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(t,n,a){n.exports=u;var i=t("./_stream_duplex"),o=Object.create(t("core-util-is"));function c(f,p){var h=this._transformState;h.transforming=!1;var y=h.writecb;if(!y)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,p!=null&&this.push(p),y(f);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function u(f){if(!(this instanceof u))return new u(f);i.call(this,f),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",l)}function l(){var f=this;typeof this._flush=="function"?this._flush((function(p,h){d(f,p,h)})):d(this,null,null)}function d(f,p,h){if(p)return f.emit("error",p);if(h!=null&&f.push(h),f._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(f._transformState.transforming)throw new Error("Calling transform done when still transforming");return f.push(null)}o.inherits=t("inherits"),o.inherits(u,i),u.prototype.push=function(f,p){return this._transformState.needTransform=!1,i.prototype.push.call(this,f,p)},u.prototype._transform=function(f,p,h){throw new Error("_transform() is not implemented")},u.prototype._write=function(f,p,h){var y=this._transformState;if(y.writecb=h,y.writechunk=f,y.writeencoding=p,!y.transforming){var g=this._readableState;(y.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},u.prototype._read=function(f){var p=this._transformState;p.writechunk!==null&&p.writecb&&!p.transforming?(p.transforming=!0,this._transform(p.writechunk,p.writeencoding,p.afterTransform)):p.needTransform=!0},u.prototype._destroy=function(f,p){var h=this;i.prototype._destroy.call(this,f,(function(y){p(y),h.emit("close")}))}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(t,n,a){(function(i,o,c){(function(){var u=t("process-nextick-args");function l(z){var O=this;this.next=null,this.entry=null,this.finish=function(){(function(L,E,k){var N=L.entry;for(L.entry=null;N;){var S=N.callback;E.pendingcb--,S(k),N=N.next}E.corkedRequestsFree.next=L})(O,z)}}n.exports=A;var d,f=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?c:u.nextTick;A.WritableState=_;var p=Object.create(t("core-util-is"));p.inherits=t("inherits");var h={deprecate:t("util-deprecate")},y=t("./internal/streams/stream"),g=t("safe-buffer").Buffer,m=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},x,v=t("./internal/streams/destroy");function w(){}function _(z,O){d=d||t("./_stream_duplex"),z=z||{};var L=O instanceof d;this.objectMode=!!z.objectMode,L&&(this.objectMode=this.objectMode||!!z.writableObjectMode);var E=z.highWaterMark,k=z.writableHighWaterMark,N=this.objectMode?16:16384;this.highWaterMark=E||E===0?E:L&&(k||k===0)?k:N,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var S=z.decodeStrings===!1;this.decodeStrings=!S,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(C){(function(D,q){var M=D._writableState,G=M.sync,X=M.writecb;if((function(V){V.writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0})(M),q)(function(V,J,W,F,Q){--J.pendingcb,W?(u.nextTick(Q,F),u.nextTick(H,V,J),V._writableState.errorEmitted=!0,V.emit("error",F)):(Q(F),V._writableState.errorEmitted=!0,V.emit("error",F),H(V,J))})(D,M,G,q,X);else{var re=I(M);re||M.corked||M.bufferProcessing||!M.bufferedRequest||T(D,M),G?f(B,D,M,re,X):B(D,M,re,X)}})(O,C)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function A(z){if(d=d||t("./_stream_duplex"),!(x.call(A,this)||this instanceof d))return new A(z);this._writableState=new _(z,this),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),y.call(this)}function P(z,O,L,E,k,N,S){O.writelen=E,O.writecb=S,O.writing=!0,O.sync=!0,L?z._writev(k,O.onwrite):z._write(k,N,O.onwrite),O.sync=!1}function B(z,O,L,E){L||(function(k,N){N.length===0&&N.needDrain&&(N.needDrain=!1,k.emit("drain"))})(z,O),O.pendingcb--,E(),H(z,O)}function T(z,O){O.bufferProcessing=!0;var L=O.bufferedRequest;if(z._writev&&L&&L.next){var E=O.bufferedRequestCount,k=new Array(E),N=O.corkedRequestsFree;N.entry=L;for(var S=0,C=!0;L;)k[S]=L,L.isBuf||(C=!1),L=L.next,S+=1;k.allBuffers=C,P(z,O,!0,O.length,k,"",N.finish),O.pendingcb++,O.lastBufferedRequest=null,N.next?(O.corkedRequestsFree=N.next,N.next=null):O.corkedRequestsFree=new l(O),O.bufferedRequestCount=0}else{for(;L;){var D=L.chunk,q=L.encoding,M=L.callback;if(P(z,O,!1,O.objectMode?1:D.length,D,q,M),L=L.next,O.bufferedRequestCount--,O.writing)break}L===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=L,O.bufferProcessing=!1}function I(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function U(z,O){z._final((function(L){O.pendingcb--,L&&z.emit("error",L),O.prefinished=!0,z.emit("prefinish"),H(z,O)}))}function H(z,O){var L=I(O);return L&&((function(E,k){k.prefinished||k.finalCalled||(typeof E._final=="function"?(k.pendingcb++,k.finalCalled=!0,u.nextTick(U,E,k)):(k.prefinished=!0,E.emit("prefinish")))})(z,O),O.pendingcb===0&&(O.finished=!0,z.emit("finish"))),L}p.inherits(A,y),_.prototype.getBuffer=function(){for(var z=this.bufferedRequest,O=[];z;)O.push(z),z=z.next;return O},(function(){try{Object.defineProperty(_.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(x=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(z){return!!x.call(this,z)||this===A&&z&&z._writableState instanceof _}})):x=function(z){return z instanceof this},A.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},A.prototype.write=function(z,O,L){var E,k=this._writableState,N=!1,S=!k.objectMode&&(E=z,g.isBuffer(E)||E instanceof m);return S&&!g.isBuffer(z)&&(z=(function(C){return g.from(C)})(z)),typeof O=="function"&&(L=O,O=null),S?O="buffer":O||(O=k.defaultEncoding),typeof L!="function"&&(L=w),k.ended?(function(C,D){var q=new Error("write after end");C.emit("error",q),u.nextTick(D,q)})(this,L):(S||(function(C,D,q,M){var G=!0,X=!1;return q===null?X=new TypeError("May not write null values to stream"):typeof q=="string"||q===void 0||D.objectMode||(X=new TypeError("Invalid non-string/buffer chunk")),X&&(C.emit("error",X),u.nextTick(M,X),G=!1),G})(this,k,z,L))&&(k.pendingcb++,N=(function(C,D,q,M,G,X){if(!q){var re=(function(F,Q,ne){return F.objectMode||F.decodeStrings===!1||typeof Q!="string"||(Q=g.from(Q,ne)),Q})(D,M,G);M!==re&&(q=!0,G="buffer",M=re)}var V=D.objectMode?1:M.length;D.length+=V;var J=D.length<D.highWaterMark;if(J||(D.needDrain=!0),D.writing||D.corked){var W=D.lastBufferedRequest;D.lastBufferedRequest={chunk:M,encoding:G,isBuf:q,callback:X,next:null},W?W.next=D.lastBufferedRequest:D.bufferedRequest=D.lastBufferedRequest,D.bufferedRequestCount+=1}else P(C,D,!1,V,M,G,X);return J})(this,k,S,z,O,L)),N},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,z.writing||z.corked||z.bufferProcessing||!z.bufferedRequest||T(this,z))},A.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(z,O,L){L(new Error("_write() is not implemented"))},A.prototype._writev=null,A.prototype.end=function(z,O,L){var E=this._writableState;typeof z=="function"?(L=z,z=null,O=null):typeof O=="function"&&(L=O,O=null),z!=null&&this.write(z,O),E.corked&&(E.corked=1,this.uncork()),E.ending||(function(k,N,S){N.ending=!0,H(k,N),S&&(N.finished?u.nextTick(S):k.once("finish",S)),N.ended=!0,k.writable=!1})(this,E,L)},Object.defineProperty(A.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),A.prototype.destroy=v.destroy,A.prototype._undestroy=v.undestroy,A.prototype._destroy=function(z,O){this.end(),O(z)}}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{},t("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(t,n,a){var i=t("safe-buffer").Buffer,o=t("util");n.exports=(function(){function c(){(function(u,l){if(!(u instanceof l))throw new TypeError("Cannot call a class as a function")})(this,c),this.head=null,this.tail=null,this.length=0}return c.prototype.push=function(u){var l={data:u,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length},c.prototype.unshift=function(u){var l={data:u,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length},c.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},c.prototype.clear=function(){this.head=this.tail=null,this.length=0},c.prototype.join=function(u){if(this.length===0)return"";for(var l=this.head,d=""+l.data;l=l.next;)d+=u+l.data;return d},c.prototype.concat=function(u){if(this.length===0)return i.alloc(0);for(var l,d,f,p=i.allocUnsafe(u>>>0),h=this.head,y=0;h;)l=h.data,d=p,f=y,l.copy(d,f),y+=h.data.length,h=h.next;return p},c})(),o&&o.inspect&&o.inspect.custom&&(n.exports.prototype[o.inspect.custom]=function(){var c=o.inspect({length:this.length});return this.constructor.name+" "+c})},{"safe-buffer":520,util:188}],514:[function(t,n,a){var i=t("process-nextick-args");function o(c,u){c.emit("error",u)}n.exports={destroy:function(c,u){var l=this,d=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return d||f?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(o,this,c)):i.nextTick(o,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,(function(p){!u&&p?l._writableState?l._writableState.errorEmitted||(l._writableState.errorEmitted=!0,i.nextTick(o,l,p)):i.nextTick(o,l,p):u&&u(p)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(t,n,a){arguments[4][490][0].apply(a,arguments)},{dup:490,events:422}],516:[function(t,n,a){n.exports=t("./readable").PassThrough},{"./readable":517}],517:[function(t,n,a){(a=n.exports=t("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=t("./lib/_stream_writable.js"),a.Duplex=t("./lib/_stream_duplex.js"),a.Transform=t("./lib/_stream_transform.js"),a.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(t,n,a){n.exports=t("./readable").Transform},{"./readable":517}],519:[function(t,n,a){n.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(t,n,a){arguments[4][217][0].apply(a,arguments)},{buffer:220,dup:217}],521:[function(t,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":520}],522:[function(t,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":494}],523:[function(t,n,a){(function(i,o){(function(){var c=t("process/browser.js").nextTick,u=Function.prototype.apply,l=Array.prototype.slice,d={},f=0;function p(h,y){this._id=h,this._clearFn=y}a.setTimeout=function(){return new p(u.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new p(u.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(h){h.close()},p.prototype.unref=p.prototype.ref=function(){},p.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(h,y){clearTimeout(h._idleTimeoutId),h._idleTimeout=y},a.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},a._unrefActive=a.active=function(h){clearTimeout(h._idleTimeoutId);var y=h._idleTimeout;y>=0&&(h._idleTimeoutId=setTimeout((function(){h._onTimeout&&h._onTimeout()}),y))},a.setImmediate=typeof i=="function"?i:function(h){var y=f++,g=!(arguments.length<2)&&l.call(arguments,1);return d[y]=!0,c((function(){d[y]&&(g?h.apply(null,g):h.call(null),a.clearImmediate(y))})),y},a.clearImmediate=typeof o=="function"?o:function(h){delete d[h]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(t,n,a){(function(i){(function(){function o(c){try{if(!i.localStorage)return!1}catch{return!1}var u=i.localStorage[c];return u!=null&&String(u).toLowerCase()==="true"}n.exports=function(c,u){if(o("noDeprecation"))return c;var l=!1;return function(){if(!l){if(o("throwDeprecation"))throw new Error(u);o("traceDeprecation")?console.trace(u):console.warn(u),l=!0}return c.apply(this,arguments)}}}).call(this)}).call(this,typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(t,n,a){typeof Object.create=="function"?n.exports=function(i,o){i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(i,o){i.super_=o;var c=function(){};c.prototype=o.prototype,i.prototype=new c,i.prototype.constructor=i}},{}],526:[function(t,n,a){n.exports=function(i){return i&&typeof i=="object"&&typeof i.copy=="function"&&typeof i.fill=="function"&&typeof i.readUInt8=="function"}},{}],527:[function(t,n,a){(function(i,o){(function(){var c=/%[sdj%]/g;a.format=function(k){if(!_(k)){for(var N=[],S=0;S<arguments.length;S++)N.push(d(arguments[S]));return N.join(" ")}S=1;for(var C=arguments,D=C.length,q=String(k).replace(c,(function(G){if(G==="%%")return"%";if(S>=D)return G;switch(G){case"%s":return String(C[S++]);case"%d":return Number(C[S++]);case"%j":try{return JSON.stringify(C[S++])}catch{return"[Circular]"}default:return G}})),M=C[S];S<D;M=C[++S])v(M)||!B(M)?q+=" "+M:q+=" "+d(M);return q},a.deprecate=function(k,N){if(A(o.process))return function(){return a.deprecate(k,N).apply(this,arguments)};if(i.noDeprecation===!0)return k;var S=!1;return function(){if(!S){if(i.throwDeprecation)throw new Error(N);i.traceDeprecation?console.trace(N):console.error(N),S=!0}return k.apply(this,arguments)}};var u,l={};function d(k,N){var S={seen:[],stylize:p};return arguments.length>=3&&(S.depth=arguments[2]),arguments.length>=4&&(S.colors=arguments[3]),x(N)?S.showHidden=N:N&&a._extend(S,N),A(S.showHidden)&&(S.showHidden=!1),A(S.depth)&&(S.depth=2),A(S.colors)&&(S.colors=!1),A(S.customInspect)&&(S.customInspect=!0),S.colors&&(S.stylize=f),h(S,k,S.depth)}function f(k,N){var S=d.styles[N];return S?"\x1B["+d.colors[S][0]+"m"+k+"\x1B["+d.colors[S][1]+"m":k}function p(k,N){return k}function h(k,N,S){if(k.customInspect&&N&&U(N.inspect)&&N.inspect!==a.inspect&&(!N.constructor||N.constructor.prototype!==N)){var C=N.inspect(S,k);return _(C)||(C=h(k,C,S)),C}var D=(function(W,F){if(A(F))return W.stylize("undefined","undefined");if(_(F)){var Q="'"+JSON.stringify(F).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return W.stylize(Q,"string")}if(w(F))return W.stylize(""+F,"number");if(x(F))return W.stylize(""+F,"boolean");if(v(F))return W.stylize("null","null")})(k,N);if(D)return D;var q=Object.keys(N),M=(function(W){var F={};return W.forEach((function(Q,ne){F[Q]=!0})),F})(q);if(k.showHidden&&(q=Object.getOwnPropertyNames(N)),I(N)&&(q.indexOf("message")>=0||q.indexOf("description")>=0))return y(N);if(q.length===0){if(U(N)){var G=N.name?": "+N.name:"";return k.stylize("[Function"+G+"]","special")}if(P(N))return k.stylize(RegExp.prototype.toString.call(N),"regexp");if(T(N))return k.stylize(Date.prototype.toString.call(N),"date");if(I(N))return y(N)}var X,re="",V=!1,J=["{","}"];return m(N)&&(V=!0,J=["[","]"]),U(N)&&(re=" [Function"+(N.name?": "+N.name:"")+"]"),P(N)&&(re=" "+RegExp.prototype.toString.call(N)),T(N)&&(re=" "+Date.prototype.toUTCString.call(N)),I(N)&&(re=" "+y(N)),q.length!==0||V&&N.length!=0?S<0?P(N)?k.stylize(RegExp.prototype.toString.call(N),"regexp"):k.stylize("[Object]","special"):(k.seen.push(N),X=V?(function(W,F,Q,ne,ie){for(var ce=[],de=0,le=F.length;de<le;++de)E(F,String(de))?ce.push(g(W,F,Q,ne,String(de),!0)):ce.push("");return ie.forEach((function(_e){_e.match(/^\d+$/)||ce.push(g(W,F,Q,ne,_e,!0))})),ce})(k,N,S,M,q):q.map((function(W){return g(k,N,S,M,W,V)})),k.seen.pop(),(function(W,F,Q){return W.reduce((function(ne,ie){return ie.indexOf(`
`)>=0,ne+ie.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Q[0]+(F===""?"":F+`
 `)+" "+W.join(`,
  `)+" "+Q[1]:Q[0]+F+" "+W.join(", ")+" "+Q[1]})(X,re,J)):J[0]+re+J[1]}function y(k){return"["+Error.prototype.toString.call(k)+"]"}function g(k,N,S,C,D,q){var M,G,X;if((X=Object.getOwnPropertyDescriptor(N,D)||{value:N[D]}).get?G=X.set?k.stylize("[Getter/Setter]","special"):k.stylize("[Getter]","special"):X.set&&(G=k.stylize("[Setter]","special")),E(C,D)||(M="["+D+"]"),G||(k.seen.indexOf(X.value)<0?(G=v(S)?h(k,X.value,null):h(k,X.value,S-1)).indexOf(`
`)>-1&&(G=q?G.split(`
`).map((function(re){return"  "+re})).join(`
`).substr(2):`
`+G.split(`
`).map((function(re){return"   "+re})).join(`
`)):G=k.stylize("[Circular]","special")),A(M)){if(q&&D.match(/^\d+$/))return G;(M=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(M=M.substr(1,M.length-2),M=k.stylize(M,"name")):(M=M.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),M=k.stylize(M,"string"))}return M+": "+G}function m(k){return Array.isArray(k)}function x(k){return typeof k=="boolean"}function v(k){return k===null}function w(k){return typeof k=="number"}function _(k){return typeof k=="string"}function A(k){return k===void 0}function P(k){return B(k)&&H(k)==="[object RegExp]"}function B(k){return typeof k=="object"&&k!==null}function T(k){return B(k)&&H(k)==="[object Date]"}function I(k){return B(k)&&(H(k)==="[object Error]"||k instanceof Error)}function U(k){return typeof k=="function"}function H(k){return Object.prototype.toString.call(k)}function z(k){return k<10?"0"+k.toString(10):k.toString(10)}a.debuglog=function(k){if(A(u)&&(u=i.env.NODE_DEBUG||""),k=k.toUpperCase(),!l[k])if(new RegExp("\\b"+k+"\\b","i").test(u)){var N=i.pid;l[k]=function(){var S=a.format.apply(a,arguments);console.error("%s %d: %s",k,N,S)}}else l[k]=function(){};return l[k]},a.inspect=d,d.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},d.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=m,a.isBoolean=x,a.isNull=v,a.isNullOrUndefined=function(k){return k==null},a.isNumber=w,a.isString=_,a.isSymbol=function(k){return typeof k=="symbol"},a.isUndefined=A,a.isRegExp=P,a.isObject=B,a.isDate=T,a.isError=I,a.isFunction=U,a.isPrimitive=function(k){return k===null||typeof k=="boolean"||typeof k=="number"||typeof k=="string"||typeof k=="symbol"||k===void 0},a.isBuffer=t("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(){var k=new Date,N=[z(k.getHours()),z(k.getMinutes()),z(k.getSeconds())].join(":");return[k.getDate(),O[k.getMonth()],N].join(" ")}function E(k,N){return Object.prototype.hasOwnProperty.call(k,N)}a.log=function(){console.log("%s - %s",L(),a.format.apply(a,arguments))},a.inherits=t("inherits"),a._extend=function(k,N){if(!N||!B(N))return k;for(var S=Object.keys(N),C=S.length;C--;)k[S[C]]=N[S[C]];return k}}).call(this)}).call(this,t("_process"),typeof on<"u"?on:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(a,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(a,"v4",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(a,"v5",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(a,"NIL",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(a,"version",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(a,"validate",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(a,"stringify",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return h.default}});var i=y(t("./v1.js")),o=y(t("./v3.js")),c=y(t("./v4.js")),u=y(t("./v5.js")),l=y(t("./nil.js")),d=y(t("./version.js")),f=y(t("./validate.js")),p=y(t("./stringify.js")),h=y(t("./parse.js"));function y(g){return g&&g.__esModule?g:{default:g}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(t,n,a){function i(h){return 14+(h+64>>>9<<4)+1}function o(h,y){const g=(65535&h)+(65535&y);return(h>>16)+(y>>16)+(g>>16)<<16|65535&g}function c(h,y,g,m,x,v){return o((w=o(o(y,h),o(m,v)))<<(_=x)|w>>>32-_,g);var w,_}function u(h,y,g,m,x,v,w){return c(y&g|~y&m,h,y,x,v,w)}function l(h,y,g,m,x,v,w){return c(y&m|g&~m,h,y,x,v,w)}function d(h,y,g,m,x,v,w){return c(y^g^m,h,y,x,v,w)}function f(h,y,g,m,x,v,w){return c(g^(y|~m),h,y,x,v,w)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var p=function(h){if(typeof h=="string"){const y=unescape(encodeURIComponent(h));h=new Uint8Array(y.length);for(let g=0;g<y.length;++g)h[g]=y.charCodeAt(g)}return(function(y){const g=[],m=32*y.length;for(let x=0;x<m;x+=8){const v=y[x>>5]>>>x%32&255,w=parseInt("0123456789abcdef".charAt(v>>>4&15)+"0123456789abcdef".charAt(15&v),16);g.push(w)}return g})((function(y,g){y[g>>5]|=128<<g%32,y[i(g)-1]=g;let m=1732584193,x=-271733879,v=-1732584194,w=271733878;for(let _=0;_<y.length;_+=16){const A=m,P=x,B=v,T=w;m=u(m,x,v,w,y[_],7,-680876936),w=u(w,m,x,v,y[_+1],12,-389564586),v=u(v,w,m,x,y[_+2],17,606105819),x=u(x,v,w,m,y[_+3],22,-1044525330),m=u(m,x,v,w,y[_+4],7,-176418897),w=u(w,m,x,v,y[_+5],12,1200080426),v=u(v,w,m,x,y[_+6],17,-1473231341),x=u(x,v,w,m,y[_+7],22,-45705983),m=u(m,x,v,w,y[_+8],7,1770035416),w=u(w,m,x,v,y[_+9],12,-1958414417),v=u(v,w,m,x,y[_+10],17,-42063),x=u(x,v,w,m,y[_+11],22,-1990404162),m=u(m,x,v,w,y[_+12],7,1804603682),w=u(w,m,x,v,y[_+13],12,-40341101),v=u(v,w,m,x,y[_+14],17,-1502002290),x=u(x,v,w,m,y[_+15],22,1236535329),m=l(m,x,v,w,y[_+1],5,-165796510),w=l(w,m,x,v,y[_+6],9,-1069501632),v=l(v,w,m,x,y[_+11],14,643717713),x=l(x,v,w,m,y[_],20,-373897302),m=l(m,x,v,w,y[_+5],5,-701558691),w=l(w,m,x,v,y[_+10],9,38016083),v=l(v,w,m,x,y[_+15],14,-660478335),x=l(x,v,w,m,y[_+4],20,-405537848),m=l(m,x,v,w,y[_+9],5,568446438),w=l(w,m,x,v,y[_+14],9,-1019803690),v=l(v,w,m,x,y[_+3],14,-187363961),x=l(x,v,w,m,y[_+8],20,1163531501),m=l(m,x,v,w,y[_+13],5,-1444681467),w=l(w,m,x,v,y[_+2],9,-51403784),v=l(v,w,m,x,y[_+7],14,1735328473),x=l(x,v,w,m,y[_+12],20,-1926607734),m=d(m,x,v,w,y[_+5],4,-378558),w=d(w,m,x,v,y[_+8],11,-2022574463),v=d(v,w,m,x,y[_+11],16,1839030562),x=d(x,v,w,m,y[_+14],23,-35309556),m=d(m,x,v,w,y[_+1],4,-1530992060),w=d(w,m,x,v,y[_+4],11,1272893353),v=d(v,w,m,x,y[_+7],16,-155497632),x=d(x,v,w,m,y[_+10],23,-1094730640),m=d(m,x,v,w,y[_+13],4,681279174),w=d(w,m,x,v,y[_],11,-358537222),v=d(v,w,m,x,y[_+3],16,-722521979),x=d(x,v,w,m,y[_+6],23,76029189),m=d(m,x,v,w,y[_+9],4,-640364487),w=d(w,m,x,v,y[_+12],11,-421815835),v=d(v,w,m,x,y[_+15],16,530742520),x=d(x,v,w,m,y[_+2],23,-995338651),m=f(m,x,v,w,y[_],6,-198630844),w=f(w,m,x,v,y[_+7],10,1126891415),v=f(v,w,m,x,y[_+14],15,-1416354905),x=f(x,v,w,m,y[_+5],21,-57434055),m=f(m,x,v,w,y[_+12],6,1700485571),w=f(w,m,x,v,y[_+3],10,-1894986606),v=f(v,w,m,x,y[_+10],15,-1051523),x=f(x,v,w,m,y[_+1],21,-2054922799),m=f(m,x,v,w,y[_+8],6,1873313359),w=f(w,m,x,v,y[_+15],10,-30611744),v=f(v,w,m,x,y[_+6],15,-1560198380),x=f(x,v,w,m,y[_+13],21,1309151649),m=f(m,x,v,w,y[_+4],6,-145523070),w=f(w,m,x,v,y[_+11],10,-1120210379),v=f(v,w,m,x,y[_+2],15,718787259),x=f(x,v,w,m,y[_+9],21,-343485551),m=o(m,A),x=o(x,P),v=o(v,B),w=o(w,T)}return[m,x,v,w]})((function(y){if(y.length===0)return[];const g=8*y.length,m=new Uint32Array(i(g));for(let x=0;x<g;x+=8)m[x>>5]|=(255&y[x/8])<<x%32;return m})(h),8*h.length))};a.default=p},{}],530:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=t("./validate.js"))&&i.__esModule?i:{default:i},c=function(u){if(!(0,o.default)(u))throw TypeError("Invalid UUID");let l;const d=new Uint8Array(16);return d[0]=(l=parseInt(u.slice(0,8),16))>>>24,d[1]=l>>>16&255,d[2]=l>>>8&255,d[3]=255&l,d[4]=(l=parseInt(u.slice(9,13),16))>>>8,d[5]=255&l,d[6]=(l=parseInt(u.slice(14,18),16))>>>8,d[7]=255&l,d[8]=(l=parseInt(u.slice(19,23),16))>>>8,d[9]=255&l,d[10]=(l=parseInt(u.slice(24,36),16))/1099511627776&255,d[11]=l/4294967296&255,d[12]=l>>>24&255,d[13]=l>>>16&255,d[14]=l>>>8&255,d[15]=255&l,d};a.default=c},{"./validate.js":541}],532:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(t,n,a){let i;Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){if(!i&&(i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)};const o=new Uint8Array(16)},{}],534:[function(t,n,a){function i(u,l,d,f){switch(u){case 0:return l&d^~l&f;case 1:return l^d^f;case 2:return l&d^l&f^d&f;case 3:return l^d^f}}function o(u,l){return u<<l|u>>>32-l}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=function(u){const l=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof u=="string"){const y=unescape(encodeURIComponent(u));u=[];for(let g=0;g<y.length;++g)u.push(y.charCodeAt(g))}else Array.isArray(u)||(u=Array.prototype.slice.call(u));u.push(128);const f=u.length/4+2,p=Math.ceil(f/16),h=new Array(p);for(let y=0;y<p;++y){const g=new Uint32Array(16);for(let m=0;m<16;++m)g[m]=u[64*y+4*m]<<24|u[64*y+4*m+1]<<16|u[64*y+4*m+2]<<8|u[64*y+4*m+3];h[y]=g}h[p-1][14]=8*(u.length-1)/Math.pow(2,32),h[p-1][14]=Math.floor(h[p-1][14]),h[p-1][15]=8*(u.length-1)&4294967295;for(let y=0;y<p;++y){const g=new Uint32Array(80);for(let A=0;A<16;++A)g[A]=h[y][A];for(let A=16;A<80;++A)g[A]=o(g[A-3]^g[A-8]^g[A-14]^g[A-16],1);let m=d[0],x=d[1],v=d[2],w=d[3],_=d[4];for(let A=0;A<80;++A){const P=Math.floor(A/20),B=o(m,5)+i(P,x,v,w)+_+l[P]+g[A]>>>0;_=w,w=v,v=o(x,30)>>>0,x=m,m=B}d[0]=d[0]+m>>>0,d[1]=d[1]+x>>>0,d[2]=d[2]+v>>>0,d[3]=d[3]+w>>>0,d[4]=d[4]+_>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,255&d[0],d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,255&d[1],d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,255&d[2],d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,255&d[3],d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,255&d[4]]};a.default=c},{}],535:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=t("./validate.js"))&&i.__esModule?i:{default:i};const c=[];for(let l=0;l<256;++l)c.push((l+256).toString(16).substr(1));var u=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const f=(c[l[d+0]]+c[l[d+1]]+c[l[d+2]]+c[l[d+3]]+"-"+c[l[d+4]]+c[l[d+5]]+"-"+c[l[d+6]]+c[l[d+7]]+"-"+c[l[d+8]]+c[l[d+9]]+"-"+c[l[d+10]]+c[l[d+11]]+c[l[d+12]]+c[l[d+13]]+c[l[d+14]]+c[l[d+15]]).toLowerCase();if(!(0,o.default)(f))throw TypeError("Stringified UUID is invalid");return f};a.default=u},{"./validate.js":541}],536:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(t("./rng.js")),o=c(t("./stringify.js"));function c(h){return h&&h.__esModule?h:{default:h}}let u,l,d=0,f=0;var p=function(h,y,g){let m=y&&g||0;const x=y||new Array(16);let v=(h=h||{}).node||u,w=h.clockseq!==void 0?h.clockseq:l;if(v==null||w==null){const I=h.random||(h.rng||i.default)();v==null&&(v=u=[1|I[0],I[1],I[2],I[3],I[4],I[5]]),w==null&&(w=l=16383&(I[6]<<8|I[7]))}let _=h.msecs!==void 0?h.msecs:Date.now(),A=h.nsecs!==void 0?h.nsecs:f+1;const P=_-d+(A-f)/1e4;if(P<0&&h.clockseq===void 0&&(w=w+1&16383),(P<0||_>d)&&h.nsecs===void 0&&(A=0),A>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=_,f=A,l=w,_+=122192928e5;const B=(1e4*(268435455&_)+A)%4294967296;x[m++]=B>>>24&255,x[m++]=B>>>16&255,x[m++]=B>>>8&255,x[m++]=255&B;const T=_/4294967296*1e4&268435455;x[m++]=T>>>8&255,x[m++]=255&T,x[m++]=T>>>24&15|16,x[m++]=T>>>16&255,x[m++]=w>>>8|128,x[m++]=255&w;for(let I=0;I<6;++I)x[m+I]=v[I];return y||(0,o.default)(x)};a.default=p},{"./rng.js":533,"./stringify.js":535}],537:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(t("./v35.js")),o=c(t("./md5.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=(0,i.default)("v3",48,o.default);a.default=u},{"./md5.js":529,"./v35.js":538}],538:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(d,f,p){function h(y,g,m,x){if(typeof y=="string"&&(y=(function(w){w=unescape(encodeURIComponent(w));const _=[];for(let A=0;A<w.length;++A)_.push(w.charCodeAt(A));return _})(y)),typeof g=="string"&&(g=(0,o.default)(g)),g.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let v=new Uint8Array(16+y.length);if(v.set(g),v.set(y,g.length),v=p(v),v[6]=15&v[6]|f,v[8]=63&v[8]|128,m){x=x||0;for(let w=0;w<16;++w)m[x+w]=v[w];return m}return(0,i.default)(v)}try{h.name=d}catch{}return h.DNS=u,h.URL=l,h},a.URL=a.DNS=void 0;var i=c(t("./stringify.js")),o=c(t("./parse.js"));function c(d){return d&&d.__esModule?d:{default:d}}const u="6ba7b810-9dad-11d1-80b4-00c04fd430c8";a.DNS=u;const l="6ba7b811-9dad-11d1-80b4-00c04fd430c8";a.URL=l},{"./parse.js":531,"./stringify.js":535}],539:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(t("./rng.js")),o=c(t("./stringify.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=function(l,d,f){const p=(l=l||{}).random||(l.rng||i.default)();if(p[6]=15&p[6]|64,p[8]=63&p[8]|128,d){f=f||0;for(let h=0;h<16;++h)d[f+h]=p[h];return d}return(0,o.default)(p)};a.default=u},{"./rng.js":533,"./stringify.js":535}],540:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(t("./v35.js")),o=c(t("./sha1.js"));function c(l){return l&&l.__esModule?l:{default:l}}var u=(0,i.default)("v5",80,o.default);a.default=u},{"./sha1.js":534,"./v35.js":538}],541:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=t("./regex.js"))&&i.__esModule?i:{default:i},c=function(u){return typeof u=="string"&&o.default.test(u)};a.default=c},{"./regex.js":532}],542:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=t("./validate.js"))&&i.__esModule?i:{default:i},c=function(u){if(!(0,o.default)(u))throw TypeError("Invalid UUID");return parseInt(u.substr(14,1),16)};a.default=c},{"./validate.js":541}],543:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR=`	
\r ---`,a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(t,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR="---",a.RESTRICTED_CHAR="-\b\v\f---",a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.RESTRICTED_CHAR_RE=new RegExp("^["+a.RESTRICTED_CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},a.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(t,n,a){function i(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(a,"__esModule",{value:!0}),a.NC_NAME_START_CHAR="A-Z_a-z------------",a.NC_NAME_CHAR="-"+a.NC_NAME_START_CHAR+".0-9--",a.NC_NAME_START_CHAR_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]$","u"),a.NC_NAME_CHAR_RE=new RegExp("^["+a.NC_NAME_CHAR+"]$","u"),a.NC_NAME_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]["+a.NC_NAME_CHAR+"]*$","u"),a.isNCNameStartChar=i,a.isNCNameChar=function(o){return i(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)}))})(X_)),X_.exports}var oxe=ixe();const pF=ru(oxe),lxe="modulepreload",cxe=function(e){return"/"+e},DT={},Y_=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){let u=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");a=u(t.map(l=>{if(l=cxe(l),l in DT)return;DT[l]=!0;const d=l.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":lxe,d||(p.as="script"),p.crossOrigin="",p.href=l,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((h,y)=>{p.addEventListener("load",h),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return r().catch(i)})};function Dn(e){"@babel/helpers - typeof";return Dn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Dn(e)}var pc=Uint8Array,Xo=Uint16Array,f6=Int32Array,p6=new pc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),m6=new pc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),FT=new pc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mF=function(e,r){for(var t=new Xo(31),n=0;n<31;++n)t[n]=r+=1<<e[n-1];for(var a=new f6(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)a[i]=i-t[n]<<5|n;return{b:t,r:a}},gF=mF(p6,2),uxe=gF.b,c4=gF.r;uxe[28]=258,c4[258]=28;var dxe=mF(m6,0),BT=dxe.r,u4=new Xo(32768);for(var os=0;os<32768;++os){var th=(os&43690)>>1|(os&21845)<<1;th=(th&52428)>>2|(th&13107)<<2,th=(th&61680)>>4|(th&3855)<<4,u4[os]=((th&65280)>>8|(th&255)<<8)>>1}var ng=(function(e,r,t){for(var n=e.length,a=0,i=new Xo(r);a<n;++a)e[a]&&++i[e[a]-1];var o=new Xo(r);for(a=1;a<r;++a)o[a]=o[a-1]+i[a-1]<<1;var c;if(t){c=new Xo(1<<r);var u=15-r;for(a=0;a<n;++a)if(e[a])for(var l=a<<4|e[a],d=r-e[a],f=o[e[a]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)c[u4[f]>>u]=l}else for(c=new Xo(n),a=0;a<n;++a)e[a]&&(c[a]=u4[o[e[a]-1]++]>>15-e[a]);return c}),Vf=new pc(288);for(var os=0;os<144;++os)Vf[os]=8;for(var os=144;os<256;++os)Vf[os]=9;for(var os=256;os<280;++os)Vf[os]=7;for(var os=280;os<288;++os)Vf[os]=8;var jb=new pc(32);for(var os=0;os<32;++os)jb[os]=5;var hxe=ng(Vf,9,0),fxe=ng(jb,5,0),yF=function(e){return(e+7)/8|0},pxe=function(e,r,t){return(t==null||t>e.length)&&(t=e.length),new pc(e.subarray(r,t))},Du=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8},q0=function(e,r,t){t<<=r&7;var n=r/8|0;e[n]|=t,e[n+1]|=t>>8,e[n+2]|=t>>16},Q_=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n]&&t.push({s:n,f:e[n]});var a=t.length,i=t.slice();if(!a)return{t:vF,l:0};if(a==1){var o=new pc(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(A,P){return A.f-P.f}),t.push({s:-1,f:25001});var c=t[0],u=t[1],l=0,d=1,f=2;for(t[0]={s:-1,f:c.f+u.f,l:c,r:u};d!=a-1;)c=t[t[l].f<t[f].f?l++:f++],u=t[l!=d&&t[l].f<t[f].f?l++:f++],t[d++]={s:-1,f:c.f+u.f,l:c,r:u};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var h=new Xo(p+1),y=d4(t[d-1],h,0);if(y>r){var n=0,g=0,m=y-r,x=1<<m;for(i.sort(function(P,B){return h[B.s]-h[P.s]||P.f-B.f});n<a;++n){var v=i[n].s;if(h[v]>r)g+=x-(1<<y-h[v]),h[v]=r;else break}for(g>>=m;g>0;){var w=i[n].s;h[w]<r?g-=1<<r-h[w]++-1:++n}for(;n>=0&&g;--n){var _=i[n].s;h[_]==r&&(--h[_],++g)}y=r}return{t:new pc(h),l:y}},d4=function(e,r,t){return e.s==-1?Math.max(d4(e.l,r,t+1),d4(e.r,r,t+1)):r[e.s]=t},$T=function(e){for(var r=e.length;r&&!e[--r];);for(var t=new Xo(++r),n=0,a=e[0],i=1,o=function(u){t[n++]=u},c=1;c<=r;++c)if(e[c]==a&&c!=r)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=e[c]}return{c:t.subarray(0,n),n:r}},z0=function(e,r){for(var t=0,n=0;n<r.length;++n)t+=e[n]*r[n];return t},xF=function(e,r,t){var n=t.length,a=yF(r+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=t[i];return(a+4+n)*8},qT=function(e,r,t,n,a,i,o,c,u,l,d){Du(r,d++,t),++a[256];for(var f=Q_(a,15),p=f.t,h=f.l,y=Q_(i,15),g=y.t,m=y.l,x=$T(p),v=x.c,w=x.n,_=$T(g),A=_.c,P=_.n,B=new Xo(19),T=0;T<v.length;++T)++B[v[T]&31];for(var T=0;T<A.length;++T)++B[A[T]&31];for(var I=Q_(B,7),U=I.t,H=I.l,z=19;z>4&&!U[FT[z-1]];--z);var O=l+5<<3,L=z0(a,Vf)+z0(i,jb)+o,E=z0(a,p)+z0(i,g)+o+14+3*z+z0(B,U)+2*B[16]+3*B[17]+7*B[18];if(u>=0&&O<=L&&O<=E)return xF(r,d,e.subarray(u,u+l));var k,N,S,C;if(Du(r,d,1+(E<L)),d+=2,E<L){k=ng(p,h,0),N=p,S=ng(g,m,0),C=g;var D=ng(U,H,0);Du(r,d,w-257),Du(r,d+5,P-1),Du(r,d+10,z-4),d+=14;for(var T=0;T<z;++T)Du(r,d+3*T,U[FT[T]]);d+=3*z;for(var q=[v,A],M=0;M<2;++M)for(var G=q[M],T=0;T<G.length;++T){var X=G[T]&31;Du(r,d,D[X]),d+=U[X],X>15&&(Du(r,d,G[T]>>5&127),d+=G[T]>>12)}}else k=hxe,N=Vf,S=fxe,C=jb;for(var T=0;T<c;++T){var re=n[T];if(re>255){var X=re>>18&31;q0(r,d,k[X+257]),d+=N[X+257],X>7&&(Du(r,d,re>>23&31),d+=p6[X]);var V=re&31;q0(r,d,S[V]),d+=C[V],V>3&&(q0(r,d,re>>5&8191),d+=m6[V])}else q0(r,d,k[re]),d+=N[re]}return q0(r,d,k[256]),d+N[256]},mxe=new f6([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vF=new pc(0),gxe=function(e,r,t,n,a,i){var o=i.z||e.length,c=new pc(n+o+5*(1+Math.ceil(o/7e3))+a),u=c.subarray(n,c.length-a),l=i.l,d=(i.r||0)&7;if(r){d&&(u[0]=i.r>>3);for(var f=mxe[r-1],p=f>>13,h=f&8191,y=(1<<t)-1,g=i.p||new Xo(32768),m=i.h||new Xo(y+1),x=Math.ceil(t/3),v=2*x,w=function(de){return(e[de]^e[de+1]<<x^e[de+2]<<v)&y},_=new f6(25e3),A=new Xo(288),P=new Xo(32),B=0,T=0,I=i.i||0,U=0,H=i.w||0,z=0;I+2<o;++I){var O=w(I),L=I&32767,E=m[O];if(g[L]=E,m[O]=L,H<=I){var k=o-I;if((B>7e3||U>24576)&&(k>423||!l)){d=qT(e,u,0,_,A,P,T,U,z,I-z,d),U=B=T=0,z=I;for(var N=0;N<286;++N)A[N]=0;for(var N=0;N<30;++N)P[N]=0}var S=2,C=0,D=h,q=L-E&32767;if(k>2&&O==w(I-q))for(var M=Math.min(p,k)-1,G=Math.min(32767,I),X=Math.min(258,k);q<=G&&--D&&L!=E;){if(e[I+S]==e[I+S-q]){for(var re=0;re<X&&e[I+re]==e[I+re-q];++re);if(re>S){if(S=re,C=q,re>M)break;for(var V=Math.min(q,re-2),J=0,N=0;N<V;++N){var W=I-q+N&32767,F=g[W],Q=W-F&32767;Q>J&&(J=Q,E=W)}}}L=E,E=g[L],q+=L-E&32767}if(C){_[U++]=268435456|c4[S]<<18|BT[C];var ne=c4[S]&31,ie=BT[C]&31;T+=p6[ne]+m6[ie],++A[257+ne],++P[ie],H=I+S,++B}else _[U++]=e[I],++A[e[I]]}}for(I=Math.max(I,H);I<o;++I)_[U++]=e[I],++A[e[I]];d=qT(e,u,l,_,A,P,T,U,z,I-z,d),l||(i.r=d&7|u[d/8|0]<<3,d-=7,i.h=m,i.p=g,i.i=I,i.w=H)}else{for(var I=i.w||0;I<o+l;I+=65535){var ce=I+65535;ce>=o&&(u[d/8|0]=l,ce=o),d=xF(u,d+1,e.subarray(I,ce))}i.i=o}return pxe(c,0,n+yF(d)+a)},bF=function(){var e=1,r=0;return{p:function(t){for(var n=e,a=r,i=t.length|0,o=0;o!=i;){for(var c=Math.min(o+2655,i);o<c;++o)a+=n+=t[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,r=a},d:function(){return e%=65521,r%=65521,(e&255)<<24|(e&65280)<<8|(r&255)<<8|r>>8}}},yxe=function(e,r,t,n,a){if(!a&&(a={l:1},r.dictionary)){var i=r.dictionary.subarray(-32768),o=new pc(i.length+e.length);o.set(i),o.set(e,i.length),e=o,a.w=i.length}return gxe(e,r.level==null?6:r.level,r.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+r.mem,t,n,a)},wF=function(e,r,t){for(;t;++r)e[r]=t,t>>>=8},xxe=function(e,r){var t=r.level,n=t==0?0:t<6?1:t==9?3:2;if(e[0]=120,e[1]=n<<6|(r.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,r.dictionary){var a=bF();a.p(r.dictionary),wF(e,2,a.d())}};function h4(e,r){r||(r={});var t=bF();t.p(e);var n=yxe(e,r,r.dictionary?6:2,4);return xxe(n,r),wF(n,n.length-4,t.d()),n}var vxe=typeof TextDecoder<"u"&&new TextDecoder,bxe=0;try{vxe.decode(vF,{stream:!0}),bxe=1}catch{}function wxe(e){if(Array.isArray(e))return e}function _xe(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,a,i,o,c=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,r!==0)for(;!(u=(n=i.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(d){l=!0,a=d}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function zT(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function jxe(e,r){if(e){if(typeof e=="string")return zT(e,r);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zT(e,r):void 0}}function Nxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UT(e,r){return wxe(e)||_xe(e,r)||jxe(e,r)||Nxe()}function HT(e,r="utf8"){return new TextDecoder(r).decode(e)}const kxe=new TextEncoder;function Sxe(e){return kxe.encode(e)}const Cxe=1024*8,Axe=(()=>{const e=new Uint8Array(4),r=new Uint32Array(e.buffer);return!((r[0]=1)&e[0])})(),Z_={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class g6{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=Cxe,t={}){let n=!1;typeof r=="number"?r=new ArrayBuffer(r):(n=!0,this.lastWrittenByte=r.byteLength);const a=t.offset?t.offset>>>0:0,i=r.byteLength-a;let o=a;(ArrayBuffer.isView(r)||r instanceof g6)&&(r.byteLength!==r.buffer.byteLength&&(o=r.byteOffset+a),r=r.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=r,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const n=(this.offset+r)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,t){const n=Z_[t].BYTES_PER_ELEMENT*r,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===Axe&&t!=="uint8"&&t!=="int8"){const c=new Uint8Array(this.buffer.slice(a,a+n));c.reverse();const u=new Z_[t](c.buffer);return this.offset+=n,u.reverse(),u}const o=new Z_[t](i);return this.offset+=n,o}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let t="";for(let n=0;n<r;n++)t+=this.readChar();return t}readUtf8(r=1){return HT(this.readBytes(r))}decodeText(r=1,t="utf8"){return HT(this.readBytes(r),t)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let t=0;t<r.length;t++)this._data.setUint8(this.offset++,r[t]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let t=0;t<r.length;t++)this.writeUint8(r.charCodeAt(t));return this}writeUtf8(r){return this.writeBytes(Sxe(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Km(e){let r=e.length;for(;--r>=0;)e[r]=0}const Exe=3,Txe=258,_F=29,Pxe=256,Oxe=Pxe+1+_F,jF=30,Mxe=512,Ixe=new Array((Oxe+2)*2);Km(Ixe);const Rxe=new Array(jF*2);Km(Rxe);const Lxe=new Array(Mxe);Km(Lxe);const Dxe=new Array(Txe-Exe+1);Km(Dxe);const Fxe=new Array(_F);Km(Fxe);const Bxe=new Array(jF);Km(Bxe);const $xe=(e,r,t,n)=>{let a=e&65535|0,i=e>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do a=a+r[n++]|0,i=i+a|0;while(--o);a%=65521,i%=65521}return a|i<<16|0};var f4=$xe;const qxe=()=>{let e,r=[];for(var t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r},zxe=new Uint32Array(qxe()),Uxe=(e,r,t,n)=>{const a=zxe,i=n+t;e^=-1;for(let o=n;o<i;o++)e=e>>>8^a[(e^r[o])&255];return e^-1};var Fc=Uxe,p4={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},NF={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Hxe=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var Vxe=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)Hxe(t,n)&&(e[n]=t[n])}}return e},Wxe=e=>{let r=0;for(let n=0,a=e.length;n<a;n++)r+=e[n].length;const t=new Uint8Array(r);for(let n=0,a=0,i=e.length;n<i;n++){let o=e[n];t.set(o,a),a+=o.length}return t},kF={assign:Vxe,flattenChunks:Wxe};let SF=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{SF=!1}const Bg=new Uint8Array(256);for(let e=0;e<256;e++)Bg[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Bg[254]=Bg[254]=1;var Kxe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let r,t,n,a,i,o=e.length,c=0;for(a=0;a<o;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),c+=t<128?1:t<2048?2:t<65536?3:4;for(r=new Uint8Array(c),i=0,a=0;i<c;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),a++)),t<128?r[i++]=t:t<2048?(r[i++]=192|t>>>6,r[i++]=128|t&63):t<65536?(r[i++]=224|t>>>12,r[i++]=128|t>>>6&63,r[i++]=128|t&63):(r[i++]=240|t>>>18,r[i++]=128|t>>>12&63,r[i++]=128|t>>>6&63,r[i++]=128|t&63);return r};const Gxe=(e,r)=>{if(r<65534&&e.subarray&&SF)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let t="";for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t};var Xxe=(e,r)=>{const t=r||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,r));let n,a;const i=new Array(t*2);for(a=0,n=0;n<t;){let o=e[n++];if(o<128){i[a++]=o;continue}let c=Bg[o];if(c>4){i[a++]=65533,n+=c-1;continue}for(o&=c===2?31:c===3?15:7;c>1&&n<t;)o=o<<6|e[n++]&63,c--;if(c>1){i[a++]=65533;continue}o<65536?i[a++]=o:(o-=65536,i[a++]=55296|o>>10&1023,i[a++]=56320|o&1023)}return Gxe(i,a)},Yxe=(e,r)=>{r=r||e.length,r>e.length&&(r=e.length);let t=r-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+Bg[e[t]]>r?t:r},m4={string2buf:Kxe,buf2string:Xxe,utf8border:Yxe};function Qxe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zxe=Qxe;const Rx=16209,Jxe=16191;var eve=function(r,t){let n,a,i,o,c,u,l,d,f,p,h,y,g,m,x,v,w,_,A,P,B,T,I,U;const H=r.state;n=r.next_in,I=r.input,a=n+(r.avail_in-5),i=r.next_out,U=r.output,o=i-(t-r.avail_out),c=i+(r.avail_out-257),u=H.dmax,l=H.wsize,d=H.whave,f=H.wnext,p=H.window,h=H.hold,y=H.bits,g=H.lencode,m=H.distcode,x=(1<<H.lenbits)-1,v=(1<<H.distbits)-1;e:do{y<15&&(h+=I[n++]<<y,y+=8,h+=I[n++]<<y,y+=8),w=g[h&x];t:for(;;){if(_=w>>>24,h>>>=_,y-=_,_=w>>>16&255,_===0)U[i++]=w&65535;else if(_&16){A=w&65535,_&=15,_&&(y<_&&(h+=I[n++]<<y,y+=8),A+=h&(1<<_)-1,h>>>=_,y-=_),y<15&&(h+=I[n++]<<y,y+=8,h+=I[n++]<<y,y+=8),w=m[h&v];r:for(;;){if(_=w>>>24,h>>>=_,y-=_,_=w>>>16&255,_&16){if(P=w&65535,_&=15,y<_&&(h+=I[n++]<<y,y+=8,y<_&&(h+=I[n++]<<y,y+=8)),P+=h&(1<<_)-1,P>u){r.msg="invalid distance too far back",H.mode=Rx;break e}if(h>>>=_,y-=_,_=i-o,P>_){if(_=P-_,_>d&&H.sane){r.msg="invalid distance too far back",H.mode=Rx;break e}if(B=0,T=p,f===0){if(B+=l-_,_<A){A-=_;do U[i++]=p[B++];while(--_);B=i-P,T=U}}else if(f<_){if(B+=l+f-_,_-=f,_<A){A-=_;do U[i++]=p[B++];while(--_);if(B=0,f<A){_=f,A-=_;do U[i++]=p[B++];while(--_);B=i-P,T=U}}}else if(B+=f-_,_<A){A-=_;do U[i++]=p[B++];while(--_);B=i-P,T=U}for(;A>2;)U[i++]=T[B++],U[i++]=T[B++],U[i++]=T[B++],A-=3;A&&(U[i++]=T[B++],A>1&&(U[i++]=T[B++]))}else{B=i-P;do U[i++]=U[B++],U[i++]=U[B++],U[i++]=U[B++],A-=3;while(A>2);A&&(U[i++]=U[B++],A>1&&(U[i++]=U[B++]))}}else if((_&64)===0){w=m[(w&65535)+(h&(1<<_)-1)];continue r}else{r.msg="invalid distance code",H.mode=Rx;break e}break}}else if((_&64)===0){w=g[(w&65535)+(h&(1<<_)-1)];continue t}else if(_&32){H.mode=Jxe;break e}else{r.msg="invalid literal/length code",H.mode=Rx;break e}break}}while(n<a&&i<c);A=y>>3,n-=A,y-=A<<3,h&=(1<<y)-1,r.next_in=n,r.next_out=i,r.avail_in=n<a?5+(a-n):5-(n-a),r.avail_out=i<c?257+(c-i):257-(i-c),H.hold=h,H.bits=y};const Up=15,VT=852,WT=592,KT=0,J_=1,GT=2,tve=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),rve=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),nve=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),sve=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ave=(e,r,t,n,a,i,o,c)=>{const u=c.bits;let l=0,d=0,f=0,p=0,h=0,y=0,g=0,m=0,x=0,v=0,w,_,A,P,B,T=null,I;const U=new Uint16Array(Up+1),H=new Uint16Array(Up+1);let z=null,O,L,E;for(l=0;l<=Up;l++)U[l]=0;for(d=0;d<n;d++)U[r[t+d]]++;for(h=u,p=Up;p>=1&&U[p]===0;p--);if(h>p&&(h=p),p===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,c.bits=1,0;for(f=1;f<p&&U[f]===0;f++);for(h<f&&(h=f),m=1,l=1;l<=Up;l++)if(m<<=1,m-=U[l],m<0)return-1;if(m>0&&(e===KT||p!==1))return-1;for(H[1]=0,l=1;l<Up;l++)H[l+1]=H[l]+U[l];for(d=0;d<n;d++)r[t+d]!==0&&(o[H[r[t+d]]++]=d);if(e===KT?(T=z=o,I=20):e===J_?(T=tve,z=rve,I=257):(T=nve,z=sve,I=0),v=0,d=0,l=f,B=i,y=h,g=0,A=-1,x=1<<h,P=x-1,e===J_&&x>VT||e===GT&&x>WT)return 1;for(;;){O=l-g,o[d]+1<I?(L=0,E=o[d]):o[d]>=I?(L=z[o[d]-I],E=T[o[d]-I]):(L=96,E=0),w=1<<l-g,_=1<<y,f=_;do _-=w,a[B+(v>>g)+_]=O<<24|L<<16|E|0;while(_!==0);for(w=1<<l-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--U[l]===0){if(l===p)break;l=r[t+o[d]]}if(l>h&&(v&P)!==A){for(g===0&&(g=h),B+=f,y=l-g,m=1<<y;y+g<p&&(m-=U[y+g],!(m<=0));)y++,m<<=1;if(x+=1<<y,e===J_&&x>VT||e===GT&&x>WT)return 1;A=v&P,a[A]=h<<24|y<<16|B-i|0}}return v!==0&&(a[B+v]=l-g<<24|64<<16|0),c.bits=h,0};var sg=ave;const ive=0,CF=1,AF=2,{Z_FINISH:XT,Z_BLOCK:ove,Z_TREES:Lx,Z_OK:Wf,Z_STREAM_END:lve,Z_NEED_DICT:cve,Z_STREAM_ERROR:Sl,Z_DATA_ERROR:EF,Z_MEM_ERROR:TF,Z_BUF_ERROR:uve,Z_DEFLATED:YT}=NF,z1=16180,QT=16181,ZT=16182,JT=16183,e9=16184,t9=16185,r9=16186,n9=16187,s9=16188,a9=16189,Nb=16190,Fu=16191,e5=16192,i9=16193,t5=16194,o9=16195,l9=16196,c9=16197,u9=16198,Dx=16199,Fx=16200,d9=16201,h9=16202,f9=16203,p9=16204,m9=16205,r5=16206,g9=16207,y9=16208,ms=16209,PF=16210,OF=16211,dve=852,hve=592,fve=15,pve=fve,x9=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function mve(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const rp=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.mode<z1||r.mode>OF?1:0},MF=e=>{if(rp(e))return Sl;const r=e.state;return e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=z1,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(dve),r.distcode=r.distdyn=new Int32Array(hve),r.sane=1,r.back=-1,Wf},IF=e=>{if(rp(e))return Sl;const r=e.state;return r.wsize=0,r.whave=0,r.wnext=0,MF(e)},RF=(e,r)=>{let t;if(rp(e))return Sl;const n=e.state;return r<0?(t=0,r=-r):(t=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Sl:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,IF(e))},LF=(e,r)=>{if(!e)return Sl;const t=new mve;e.state=t,t.strm=e,t.window=null,t.mode=z1;const n=RF(e,r);return n!==Wf&&(e.state=null),n},gve=e=>LF(e,pve);let v9=!0,n5,s5;const yve=e=>{if(v9){n5=new Int32Array(512),s5=new Int32Array(32);let r=0;for(;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(sg(CF,e.lens,0,288,n5,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;sg(AF,e.lens,0,32,s5,0,e.work,{bits:5}),v9=!1}e.lencode=n5,e.lenbits=9,e.distcode=s5,e.distbits=5},DF=(e,r,t,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(r.subarray(t-i.wsize,t),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(r.subarray(t-n,t-n+a),i.wnext),n-=a,n?(i.window.set(r.subarray(t-n,t),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},xve=(e,r)=>{let t,n,a,i,o,c,u,l,d,f,p,h,y,g,m=0,x,v,w,_,A,P,B,T;const I=new Uint8Array(4);let U,H;const z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(rp(e)||!e.output||!e.input&&e.avail_in!==0)return Sl;t=e.state,t.mode===Fu&&(t.mode=e5),o=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,n=e.input,c=e.avail_in,l=t.hold,d=t.bits,f=c,p=u,T=Wf;e:for(;;)switch(t.mode){case z1:if(t.wrap===0){t.mode=e5;break}for(;d<16;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,I[0]=l&255,I[1]=l>>>8&255,t.check=Fc(t.check,I,2,0),l=0,d=0,t.mode=QT;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){e.msg="incorrect header check",t.mode=ms;break}if((l&15)!==YT){e.msg="unknown compression method",t.mode=ms;break}if(l>>>=4,d-=4,B=(l&15)+8,t.wbits===0&&(t.wbits=B),B>15||B>t.wbits){e.msg="invalid window size",t.mode=ms;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=l&512?a9:Fu,l=0,d=0;break;case QT:for(;d<16;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(t.flags=l,(t.flags&255)!==YT){e.msg="unknown compression method",t.mode=ms;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=ms;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(I[0]=l&255,I[1]=l>>>8&255,t.check=Fc(t.check,I,2,0)),l=0,d=0,t.mode=ZT;case ZT:for(;d<32;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(I[0]=l&255,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,t.check=Fc(t.check,I,4,0)),l=0,d=0,t.mode=JT;case JT:for(;d<16;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(I[0]=l&255,I[1]=l>>>8&255,t.check=Fc(t.check,I,2,0)),l=0,d=0,t.mode=e9;case e9:if(t.flags&1024){for(;d<16;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(I[0]=l&255,I[1]=l>>>8&255,t.check=Fc(t.check,I,2,0)),l=0,d=0}else t.head&&(t.head.extra=null);t.mode=t9;case t9:if(t.flags&1024&&(h=t.length,h>c&&(h=c),h&&(t.head&&(B=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(i,i+h),B)),t.flags&512&&t.wrap&4&&(t.check=Fc(t.check,n,h,i)),c-=h,i+=h,t.length-=h),t.length))break e;t.length=0,t.mode=r9;case r9:if(t.flags&2048){if(c===0)break e;h=0;do B=n[i+h++],t.head&&B&&t.length<65536&&(t.head.name+=String.fromCharCode(B));while(B&&h<c);if(t.flags&512&&t.wrap&4&&(t.check=Fc(t.check,n,h,i)),c-=h,i+=h,B)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=n9;case n9:if(t.flags&4096){if(c===0)break e;h=0;do B=n[i+h++],t.head&&B&&t.length<65536&&(t.head.comment+=String.fromCharCode(B));while(B&&h<c);if(t.flags&512&&t.wrap&4&&(t.check=Fc(t.check,n,h,i)),c-=h,i+=h,B)break e}else t.head&&(t.head.comment=null);t.mode=s9;case s9:if(t.flags&512){for(;d<16;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(t.wrap&4&&l!==(t.check&65535)){e.msg="header crc mismatch",t.mode=ms;break}l=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=Fu;break;case a9:for(;d<32;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}e.adler=t.check=x9(l),l=0,d=0,t.mode=Nb;case Nb:if(t.havedict===0)return e.next_out=o,e.avail_out=u,e.next_in=i,e.avail_in=c,t.hold=l,t.bits=d,cve;e.adler=t.check=1,t.mode=Fu;case Fu:if(r===ove||r===Lx)break e;case e5:if(t.last){l>>>=d&7,d-=d&7,t.mode=r5;break}for(;d<3;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}switch(t.last=l&1,l>>>=1,d-=1,l&3){case 0:t.mode=i9;break;case 1:if(yve(t),t.mode=Dx,r===Lx){l>>>=2,d-=2;break e}break;case 2:t.mode=l9;break;case 3:e.msg="invalid block type",t.mode=ms}l>>>=2,d-=2;break;case i9:for(l>>>=d&7,d-=d&7;d<32;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if((l&65535)!==(l>>>16^65535)){e.msg="invalid stored block lengths",t.mode=ms;break}if(t.length=l&65535,l=0,d=0,t.mode=t5,r===Lx)break e;case t5:t.mode=o9;case o9:if(h=t.length,h){if(h>c&&(h=c),h>u&&(h=u),h===0)break e;a.set(n.subarray(i,i+h),o),c-=h,i+=h,u-=h,o+=h,t.length-=h;break}t.mode=Fu;break;case l9:for(;d<14;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(t.nlen=(l&31)+257,l>>>=5,d-=5,t.ndist=(l&31)+1,l>>>=5,d-=5,t.ncode=(l&15)+4,l>>>=4,d-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=ms;break}t.have=0,t.mode=c9;case c9:for(;t.have<t.ncode;){for(;d<3;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.lens[z[t.have++]]=l&7,l>>>=3,d-=3}for(;t.have<19;)t.lens[z[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,U={bits:t.lenbits},T=sg(ive,t.lens,0,19,t.lencode,0,t.work,U),t.lenbits=U.bits,T){e.msg="invalid code lengths set",t.mode=ms;break}t.have=0,t.mode=u9;case u9:for(;t.have<t.nlen+t.ndist;){for(;m=t.lencode[l&(1<<t.lenbits)-1],x=m>>>24,v=m>>>16&255,w=m&65535,!(x<=d);){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(w<16)l>>>=x,d-=x,t.lens[t.have++]=w;else{if(w===16){for(H=x+2;d<H;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(l>>>=x,d-=x,t.have===0){e.msg="invalid bit length repeat",t.mode=ms;break}B=t.lens[t.have-1],h=3+(l&3),l>>>=2,d-=2}else if(w===17){for(H=x+3;d<H;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}l>>>=x,d-=x,B=0,h=3+(l&7),l>>>=3,d-=3}else{for(H=x+7;d<H;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}l>>>=x,d-=x,B=0,h=11+(l&127),l>>>=7,d-=7}if(t.have+h>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=ms;break}for(;h--;)t.lens[t.have++]=B}}if(t.mode===ms)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=ms;break}if(t.lenbits=9,U={bits:t.lenbits},T=sg(CF,t.lens,0,t.nlen,t.lencode,0,t.work,U),t.lenbits=U.bits,T){e.msg="invalid literal/lengths set",t.mode=ms;break}if(t.distbits=6,t.distcode=t.distdyn,U={bits:t.distbits},T=sg(AF,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,U),t.distbits=U.bits,T){e.msg="invalid distances set",t.mode=ms;break}if(t.mode=Dx,r===Lx)break e;case Dx:t.mode=Fx;case Fx:if(c>=6&&u>=258){e.next_out=o,e.avail_out=u,e.next_in=i,e.avail_in=c,t.hold=l,t.bits=d,eve(e,p),o=e.next_out,a=e.output,u=e.avail_out,i=e.next_in,n=e.input,c=e.avail_in,l=t.hold,d=t.bits,t.mode===Fu&&(t.back=-1);break}for(t.back=0;m=t.lencode[l&(1<<t.lenbits)-1],x=m>>>24,v=m>>>16&255,w=m&65535,!(x<=d);){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(v&&(v&240)===0){for(_=x,A=v,P=w;m=t.lencode[P+((l&(1<<_+A)-1)>>_)],x=m>>>24,v=m>>>16&255,w=m&65535,!(_+x<=d);){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}l>>>=_,d-=_,t.back+=_}if(l>>>=x,d-=x,t.back+=x,t.length=w,v===0){t.mode=m9;break}if(v&32){t.back=-1,t.mode=Fu;break}if(v&64){e.msg="invalid literal/length code",t.mode=ms;break}t.extra=v&15,t.mode=d9;case d9:if(t.extra){for(H=t.extra;d<H;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=h9;case h9:for(;m=t.distcode[l&(1<<t.distbits)-1],x=m>>>24,v=m>>>16&255,w=m&65535,!(x<=d);){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if((v&240)===0){for(_=x,A=v,P=w;m=t.distcode[P+((l&(1<<_+A)-1)>>_)],x=m>>>24,v=m>>>16&255,w=m&65535,!(_+x<=d);){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}l>>>=_,d-=_,t.back+=_}if(l>>>=x,d-=x,t.back+=x,v&64){e.msg="invalid distance code",t.mode=ms;break}t.offset=w,t.extra=v&15,t.mode=f9;case f9:if(t.extra){for(H=t.extra;d<H;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=ms;break}t.mode=p9;case p9:if(u===0)break e;if(h=p-u,t.offset>h){if(h=t.offset-h,h>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=ms;break}h>t.wnext?(h-=t.wnext,y=t.wsize-h):y=t.wnext-h,h>t.length&&(h=t.length),g=t.window}else g=a,y=o-t.offset,h=t.length;h>u&&(h=u),u-=h,t.length-=h;do a[o++]=g[y++];while(--h);t.length===0&&(t.mode=Fx);break;case m9:if(u===0)break e;a[o++]=t.length,u--,t.mode=Fx;break;case r5:if(t.wrap){for(;d<32;){if(c===0)break e;c--,l|=n[i++]<<d,d+=8}if(p-=u,e.total_out+=p,t.total+=p,t.wrap&4&&p&&(e.adler=t.check=t.flags?Fc(t.check,a,p,o-p):f4(t.check,a,p,o-p)),p=u,t.wrap&4&&(t.flags?l:x9(l))!==t.check){e.msg="incorrect data check",t.mode=ms;break}l=0,d=0}t.mode=g9;case g9:if(t.wrap&&t.flags){for(;d<32;){if(c===0)break e;c--,l+=n[i++]<<d,d+=8}if(t.wrap&4&&l!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=ms;break}l=0,d=0}t.mode=y9;case y9:T=lve;break e;case ms:T=EF;break e;case PF:return TF;case OF:default:return Sl}return e.next_out=o,e.avail_out=u,e.next_in=i,e.avail_in=c,t.hold=l,t.bits=d,(t.wsize||p!==e.avail_out&&t.mode<ms&&(t.mode<r5||r!==XT))&&DF(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,t.total+=p,t.wrap&4&&p&&(e.adler=t.check=t.flags?Fc(t.check,a,p,e.next_out-p):f4(t.check,a,p,e.next_out-p)),e.data_type=t.bits+(t.last?64:0)+(t.mode===Fu?128:0)+(t.mode===Dx||t.mode===t5?256:0),(f===0&&p===0||r===XT)&&T===Wf&&(T=uve),T},vve=e=>{if(rp(e))return Sl;let r=e.state;return r.window&&(r.window=null),e.state=null,Wf},bve=(e,r)=>{if(rp(e))return Sl;const t=e.state;return(t.wrap&2)===0?Sl:(t.head=r,r.done=!1,Wf)},wve=(e,r)=>{const t=r.length;let n,a,i;return rp(e)||(n=e.state,n.wrap!==0&&n.mode!==Nb)?Sl:n.mode===Nb&&(a=1,a=f4(a,r,t,0),a!==n.check)?EF:(i=DF(e,r,t,t),i?(n.mode=PF,TF):(n.havedict=1,Wf))};var _ve=IF,jve=RF,Nve=MF,kve=gve,Sve=LF,Cve=xve,Ave=vve,Eve=bve,Tve=wve,Pve="pako inflate (from Nodeca project)",Uu={inflateReset:_ve,inflateReset2:jve,inflateResetKeep:Nve,inflateInit:kve,inflateInit2:Sve,inflate:Cve,inflateEnd:Ave,inflateGetHeader:Eve,inflateSetDictionary:Tve,inflateInfo:Pve};function Ove(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Mve=Ove;const FF=Object.prototype.toString,{Z_NO_FLUSH:Ive,Z_FINISH:Rve,Z_OK:$g,Z_STREAM_END:a5,Z_NEED_DICT:i5,Z_STREAM_ERROR:Lve,Z_DATA_ERROR:b9,Z_MEM_ERROR:Dve}=NF;function xy(e){this.options=kF.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zxe,this.strm.avail_out=0;let t=Uu.inflateInit2(this.strm,r.windowBits);if(t!==$g)throw new Error(p4[t]);if(this.header=new Mve,Uu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=m4.string2buf(r.dictionary):FF.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=Uu.inflateSetDictionary(this.strm,r.dictionary),t!==$g)))throw new Error(p4[t])}xy.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,o,c;if(this.ended)return!1;for(r===~~r?o=r:o=r===!0?Rve:Ive,FF.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),i=Uu.inflate(t,o),i===i5&&a&&(i=Uu.inflateSetDictionary(t,a),i===$g?i=Uu.inflate(t,o):i===b9&&(i=i5));t.avail_in>0&&i===a5&&t.state.wrap>0&&e[t.next_in]!==0;)Uu.inflateReset(t),i=Uu.inflate(t,o);switch(i){case Lve:case b9:case i5:case Dve:return this.onEnd(i),this.ended=!0,!1}if(c=t.avail_out,t.next_out&&(t.avail_out===0||i===a5))if(this.options.to==="string"){let u=m4.utf8border(t.output,t.next_out),l=t.next_out-u,d=m4.buf2string(t.output,u);t.next_out=l,t.avail_out=n-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(i===$g&&c===0)){if(i===a5)return i=Uu.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};xy.prototype.onData=function(e){this.chunks.push(e)};xy.prototype.onEnd=function(e){e===$g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=kF.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Fve(e,r){const t=new xy(r);if(t.push(e),t.err)throw t.msg||p4[t.err];return t.result}var Bve=xy,$ve=Fve,qve={Inflate:Bve,inflate:$ve};const{Inflate:zve,inflate:Uve}=qve;var w9=zve,Hve=Uve;const BF=[];for(let e=0;e<256;e++){let r=e;for(let t=0;t<8;t++)r&1?r=3988292384^r>>>1:r=r>>>1;BF[e]=r}const _9=4294967295;function Vve(e,r,t){let n=e;for(let a=0;a<t;a++)n=BF[(n^r[a])&255]^n>>>8;return n}function Wve(e,r){return(Vve(_9,e,r)^_9)>>>0}function j9(e,r,t){const n=e.readUint32(),a=Wve(new Uint8Array(e.buffer,e.byteOffset+e.offset-r-4,r),r);if(a!==n)throw new Error(`CRC mismatch for chunk ${t}. Expected ${n}, found ${a}`)}function $F(e,r,t){for(let n=0;n<t;n++)r[n]=e[n]}function qF(e,r,t,n){let a=0;for(;a<n;a++)r[a]=e[a];for(;a<t;a++)r[a]=e[a]+r[a-n]&255}function zF(e,r,t,n){let a=0;if(t.length===0)for(;a<n;a++)r[a]=e[a];else for(;a<n;a++)r[a]=e[a]+t[a]&255}function UF(e,r,t,n,a){let i=0;if(t.length===0){for(;i<a;i++)r[i]=e[i];for(;i<n;i++)r[i]=e[i]+(r[i-a]>>1)&255}else{for(;i<a;i++)r[i]=e[i]+(t[i]>>1)&255;for(;i<n;i++)r[i]=e[i]+(r[i-a]+t[i]>>1)&255}}function HF(e,r,t,n,a){let i=0;if(t.length===0){for(;i<a;i++)r[i]=e[i];for(;i<n;i++)r[i]=e[i]+r[i-a]&255}else{for(;i<a;i++)r[i]=e[i]+t[i]&255;for(;i<n;i++)r[i]=e[i]+Kve(r[i-a],t[i],t[i-a])&255}}function Kve(e,r,t){const n=e+r-t,a=Math.abs(n-e),i=Math.abs(n-r),o=Math.abs(n-t);return a<=i&&a<=o?e:i<=o?r:t}function Gve(e,r,t,n,a,i){switch(e){case 0:$F(r,t,a);break;case 1:qF(r,t,a,i);break;case 2:zF(r,t,n,a);break;case 3:UF(r,t,n,a,i);break;case 4:HF(r,t,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Xve=new Uint16Array([255]),Yve=new Uint8Array(Xve.buffer),Qve=Yve[0]===255;function Zve(e){const{data:r,width:t,height:n,channels:a,depth:i}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],c=Math.ceil(i/8)*a,u=new Uint8Array(n*t*c);let l=0;for(let d=0;d<7;d++){const f=o[d],p=Math.ceil((t-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(p<=0||h<=0)continue;const y=p*c,g=new Uint8Array(y);for(let m=0;m<h;m++){const x=r[l++],v=r.subarray(l,l+y);l+=y;const w=new Uint8Array(y);Gve(x,v,w,g,y,c),g.set(w);for(let _=0;_<p;_++){const A=f.x+_*f.xStep,P=f.y+m*f.yStep;if(!(A>=t||P>=n))for(let B=0;B<c;B++)u[(P*t+A)*c+B]=w[_*c+B]}}}if(i===16){const d=new Uint16Array(u.buffer);if(Qve)for(let f=0;f<d.length;f++)d[f]=Jve(d[f]);return d}else return u}function Jve(e){return(e&255)<<8|e>>8&255}const ebe=new Uint16Array([255]),tbe=new Uint8Array(ebe.buffer),rbe=tbe[0]===255,nbe=new Uint8Array(0);function N9(e){const{data:r,width:t,height:n,channels:a,depth:i}=e,o=Math.ceil(i/8)*a,c=Math.ceil(i/8*a*t),u=new Uint8Array(n*c);let l=nbe,d=0,f,p;for(let h=0;h<n;h++){switch(f=r.subarray(d+1,d+1+c),p=u.subarray(h*c,(h+1)*c),r[d]){case 0:$F(f,p,c);break;case 1:qF(f,p,c,o);break;case 2:zF(f,p,l,c);break;case 3:UF(f,p,l,c,o);break;case 4:HF(f,p,l,c,o);break;default:throw new Error(`Unsupported filter: ${r[d]}`)}l=p,d+=c+1}if(i===16){const h=new Uint16Array(u.buffer);if(rbe)for(let y=0;y<h.length;y++)h[y]=sbe(h[y]);return h}else return u}function sbe(e){return(e&255)<<8|e>>8&255}const iv=Uint8Array.of(137,80,78,71,13,10,26,10);function k9(e){if(!abe(e.readBytes(iv.length)))throw new Error("wrong PNG signature")}function abe(e){if(e.length<iv.length)return!1;for(let r=0;r<iv.length;r++)if(e[r]!==iv[r])return!1;return!0}const ibe="tEXt",obe=0,VF=new TextDecoder("latin1");function lbe(e){if(ube(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const cbe=/^[\u0000-\u00FF]*$/;function ube(e){if(!cbe.test(e))throw new Error("invalid latin1 text")}function dbe(e,r,t){const n=WF(r);e[n]=hbe(r,t-n.length-1)}function WF(e){for(e.mark();e.readByte()!==obe;);const r=e.offset;e.reset();const t=VF.decode(e.readBytes(r-e.offset-1));return e.skip(1),lbe(t),t}function hbe(e,r){return VF.decode(e.readBytes(r))}const qo={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},o5={UNKNOWN:-1,DEFLATE:0},S9={UNKNOWN:-1,ADAPTIVE:0},l5={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Bx={NONE:0,BACKGROUND:1,PREVIOUS:2},c5={SOURCE:0,OVER:1};class fbe extends g6{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,t={}){super(r);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new w9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=o5.UNKNOWN,this._filterMethod=S9.UNKNOWN,this._interlaceMethod=l5.UNKNOWN,this._colorType=qo.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(k9(this);!this._end;){const r=this.readUint32(),t=this.readChars(4);this.decodeChunk(r,t)}return this.decodeImage(),this._png}decodeApng(){for(k9(this);!this._end;){const r=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(r,t)}return this.decodeApngImage(),this._apng}decodeChunk(r,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case ibe:dbe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?j9(this,r+4,t):this.skip(4)}decodeApngChunk(r,t){const n=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,t),this.offset=n+r;break}if(this.offset-n!==r)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?j9(this,r+4,t):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=pbe(this.readUint8());const t=this.readUint8();this._colorType=t;let n;switch(t){case qo.GREYSCALE:n=1;break;case qo.TRUECOLOUR:n=3;break;case qo.INDEXED_COLOUR:n=1;break;case qo.GREYSCALE_ALPHA:n=2;break;case qo.TRUECOLOUR_ALPHA:n=4;break;case qo.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==o5.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const t=r/3;this._hasPalette=!0;const n=[];this._palette=n;for(let a=0;a<t;a++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const t=r,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let t=r,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case qo.GREYSCALE:case qo.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let t=0;t<r/2;t++)this._transparency[t]=this.readUint16();break}case qo.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let t=0;for(;t<r;t++){const n=this.readByte();this._palette[t].push(n)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case qo.UNKNOWN:case qo.GREYSCALE_ALPHA:case qo.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const t=WF(this),n=this.readUint8();if(n!==o5.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const a=this.readBytes(r-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:Hve(a)}}decodepHYs(){const r=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:r,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const t={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(r);if(n){if(n.data=N9({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(n,a,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(r,t,n){switch(r.disposeOp){case Bx.NONE:break;case Bx.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let i=0;i<this._png.width;i++){const o=(a*r.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)n.data[o+c]=0}break;case Bx.PREVIOUS:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,t){const n=1<<this._png.depth,a=(i,o)=>{const c=((i+t.yOffset)*this._png.width+t.xOffset+o)*this._png.channels,u=(i*t.width+o)*this._png.channels;return{index:c,frameIndex:u}};switch(t.blendOp){case c5.SOURCE:for(let i=0;i<t.height;i++)for(let o=0;o<t.width;o++){const{index:c,frameIndex:u}=a(i,o);for(let l=0;l<this._png.channels;l++)r.data[c+l]=t.data[u+l]}break;case c5.OVER:for(let i=0;i<t.height;i++)for(let o=0;o<t.width;o++){const{index:c,frameIndex:u}=a(i,o);for(let l=0;l<this._png.channels;l++){const d=t.data[u+this._png.channels-1]/n,f=l%(this._png.channels-1)===0?1:t.data[u+l],p=Math.floor(d*f+(1-d)*r.data[c+l]);r.data[c+l]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==S9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===l5.NO_INTERLACE)this._png.data=N9({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===l5.ADAM7)this._png.data=Zve({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,t=this._frames.at(-1);t?t.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Bx.NONE,blendOp:c5.SOURCE,data:r}),this._inflator=new w9,this._writingDataChunks=!1}}function pbe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var C9;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(C9||(C9={}));function mbe(e,r){return new fbe(e,r).decode()}var Ir=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function u5(){Ir.console&&typeof Ir.console.log=="function"&&Ir.console.log.apply(Ir.console,arguments)}var Wn={log:u5,warn:function(e){Ir.console&&(typeof Ir.console.warn=="function"?Ir.console.warn.apply(Ir.console,arguments):u5.call(null,arguments))},error:function(e){Ir.console&&(typeof Ir.console.error=="function"?Ir.console.error.apply(Ir.console,arguments):u5(e))}};function d5(e,r,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){uf(n.response,r,t)},n.onerror=function(){Wn.error("could not download file")},n.send()}function A9(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function $x(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var uf=Ir.saveAs||((typeof window>"u"?"undefined":Dn(window))!=="object"||window!==Ir?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,r,t){var n=Ir.URL||Ir.webkitURL,a=document.createElement("a");r=r||e.name||"download",a.download=r,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?A9(a.href)?d5(e,r,t):$x(a,a.target="_blank"):$x(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){$x(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,t){if(r=r||e.name||"download",typeof e=="string")if(A9(e))d5(e,r,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){$x(n)})}else navigator.msSaveOrOpenBlob((function(a,i){return i===void 0?i={autoBom:!1}:Dn(i)!=="object"&&(Wn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a})(e,t),r)}:function(e,r,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return d5(e,r,t);var a=e.type==="application/octet-stream",i=/constructor/i.test(Ir.HTMLElement)||Ir.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":Dn(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var d=c.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},c.readAsDataURL(e)}else{var u=Ir.URL||Ir.webkitURL,l=u.createObjectURL(e);n?n.location=l:location.href=l,n=null,setTimeout(function(){u.revokeObjectURL(l)},4e4)}});function KF(e){var r;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,i=t[n].process,o=a.exec(e);o&&(r=i(o),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),l=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),l.length==1&&(l="0"+l),"#"+c+u+l}}var ov=Ir.atob.bind(Ir),E9=Ir.btoa.bind(Ir);function h5(e,r){var t=e[0],n=e[1],a=e[2],i=e[3];t=Ii(t,n,a,i,r[0],7,-680876936),i=Ii(i,t,n,a,r[1],12,-389564586),a=Ii(a,i,t,n,r[2],17,606105819),n=Ii(n,a,i,t,r[3],22,-1044525330),t=Ii(t,n,a,i,r[4],7,-176418897),i=Ii(i,t,n,a,r[5],12,1200080426),a=Ii(a,i,t,n,r[6],17,-1473231341),n=Ii(n,a,i,t,r[7],22,-45705983),t=Ii(t,n,a,i,r[8],7,1770035416),i=Ii(i,t,n,a,r[9],12,-1958414417),a=Ii(a,i,t,n,r[10],17,-42063),n=Ii(n,a,i,t,r[11],22,-1990404162),t=Ii(t,n,a,i,r[12],7,1804603682),i=Ii(i,t,n,a,r[13],12,-40341101),a=Ii(a,i,t,n,r[14],17,-1502002290),t=Ri(t,n=Ii(n,a,i,t,r[15],22,1236535329),a,i,r[1],5,-165796510),i=Ri(i,t,n,a,r[6],9,-1069501632),a=Ri(a,i,t,n,r[11],14,643717713),n=Ri(n,a,i,t,r[0],20,-373897302),t=Ri(t,n,a,i,r[5],5,-701558691),i=Ri(i,t,n,a,r[10],9,38016083),a=Ri(a,i,t,n,r[15],14,-660478335),n=Ri(n,a,i,t,r[4],20,-405537848),t=Ri(t,n,a,i,r[9],5,568446438),i=Ri(i,t,n,a,r[14],9,-1019803690),a=Ri(a,i,t,n,r[3],14,-187363961),n=Ri(n,a,i,t,r[8],20,1163531501),t=Ri(t,n,a,i,r[13],5,-1444681467),i=Ri(i,t,n,a,r[2],9,-51403784),a=Ri(a,i,t,n,r[7],14,1735328473),t=Li(t,n=Ri(n,a,i,t,r[12],20,-1926607734),a,i,r[5],4,-378558),i=Li(i,t,n,a,r[8],11,-2022574463),a=Li(a,i,t,n,r[11],16,1839030562),n=Li(n,a,i,t,r[14],23,-35309556),t=Li(t,n,a,i,r[1],4,-1530992060),i=Li(i,t,n,a,r[4],11,1272893353),a=Li(a,i,t,n,r[7],16,-155497632),n=Li(n,a,i,t,r[10],23,-1094730640),t=Li(t,n,a,i,r[13],4,681279174),i=Li(i,t,n,a,r[0],11,-358537222),a=Li(a,i,t,n,r[3],16,-722521979),n=Li(n,a,i,t,r[6],23,76029189),t=Li(t,n,a,i,r[9],4,-640364487),i=Li(i,t,n,a,r[12],11,-421815835),a=Li(a,i,t,n,r[15],16,530742520),t=Di(t,n=Li(n,a,i,t,r[2],23,-995338651),a,i,r[0],6,-198630844),i=Di(i,t,n,a,r[7],10,1126891415),a=Di(a,i,t,n,r[14],15,-1416354905),n=Di(n,a,i,t,r[5],21,-57434055),t=Di(t,n,a,i,r[12],6,1700485571),i=Di(i,t,n,a,r[3],10,-1894986606),a=Di(a,i,t,n,r[10],15,-1051523),n=Di(n,a,i,t,r[1],21,-2054922799),t=Di(t,n,a,i,r[8],6,1873313359),i=Di(i,t,n,a,r[15],10,-30611744),a=Di(a,i,t,n,r[6],15,-1560198380),n=Di(n,a,i,t,r[13],21,1309151649),t=Di(t,n,a,i,r[4],6,-145523070),i=Di(i,t,n,a,r[11],10,-1120210379),a=Di(a,i,t,n,r[2],15,718787259),n=Di(n,a,i,t,r[9],21,-343485551),e[0]=hh(t,e[0]),e[1]=hh(n,e[1]),e[2]=hh(a,e[2]),e[3]=hh(i,e[3])}function U1(e,r,t,n,a,i){return r=hh(hh(r,e),hh(n,i)),hh(r<<a|r>>>32-a,t)}function Ii(e,r,t,n,a,i,o){return U1(r&t|~r&n,e,r,a,i,o)}function Ri(e,r,t,n,a,i,o){return U1(r&n|t&~n,e,r,a,i,o)}function Li(e,r,t,n,a,i,o){return U1(r^t^n,e,r,a,i,o)}function Di(e,r,t,n,a,i,o){return U1(t^(r|~n),e,r,a,i,o)}function GF(e){var r,t=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=e.length;r+=64)h5(n,gbe(e.substring(r-64,r)));e=e.substring(r-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<e.length;r++)a[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(a[r>>2]|=128<<(r%4<<3),r>55)for(h5(n,a),r=0;r<16;r++)a[r]=0;return a[14]=8*t,h5(n,a),n}function gbe(e){var r,t=[];for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}var T9="0123456789abcdef".split("");function ybe(e){for(var r="",t=0;t<4;t++)r+=T9[e>>8*t+4&15]+T9[e>>8*t&15];return r}function xbe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function g4(e){return GF(e).map(xbe).join("")}var vbe=(function(e){for(var r=0;r<e.length;r++)e[r]=ybe(e[r]);return e.join("")})(GF("hello"))!="5d41402abc4b2a76b9719d911017c592";function hh(e,r){if(vbe){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}return e+r&4294967295}function y4(e,r){var t,n,a,i;if(e!==t){for(var o=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),c=[],u=0;u<256;u++)c[u]=u;var l=0;for(u=0;u<256;u++){var d=c[u];l=(l+d+o.charCodeAt(u))%256,c[u]=c[l],c[l]=d}t=e,n=c}else c=n;var f=r.length,p=0,h=0,y="";for(u=0;u<f;u++)h=(h+(d=c[p=(p+1)%256]))%256,c[p]=c[h],c[h]=d,o=c[(c[p]+c[h])%256],y+=String.fromCharCode(r.charCodeAt(u)^o);return y}var P9={print:4,modify:8,copy:16,"annot-forms":32};function Zp(e,r,t,n){this.v=1,this.r=2;var a=192;e.forEach(function(c){if(P9.perm!==void 0)throw new Error("Invalid permission: "+c);a+=P9[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(r+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=g4(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=y4(this.encryptionKey,this.padding)}function Jp(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var r="",t=e.length,n=0;n<t;n++){var a=e.charCodeAt(n);r+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return r}function O9(e){if(Dn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(t)||(r[t]={});var i=Math.random().toString(35);return r[t][i]=[n,!!a],i},this.unsubscribe=function(t){for(var n in r)if(r[n][t])return delete r[n][t],Object.keys(r[n]).length===0&&delete r[n],!0;return!1},this.publish=function(t){if(r.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in r[t]){var o=r[t][i];try{o[0].apply(e,n)}catch(c){Ir.console&&Wn.error("jsPDF PubSub Error",c.message,c)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function kb(e){if(!(this instanceof kb))return new kb(e);var r="opacity,stroke-opacity".split(",");for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>=0&&(this[t]=e[t]);this.id="",this.objectNumber=-1}function XF(e,r){this.gState=e,this.matrix=r,this.id="",this.objectNumber=-1}function pf(e,r,t,n,a){if(!(this instanceof pf))return new pf(e,r,t,n,a);this.type=e==="axial"?2:3,this.coords=r,this.colors=t,XF.call(this,n,a)}function nm(e,r,t,n,a){if(!(this instanceof nm))return new nm(e,r,t,n,a);this.boundingBox=e,this.xStep=r,this.yStep=t,this.stream="",this.cloneIndex=0,XF.call(this,n,a)}function mr(e){var r,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],o=[],c=1,u=16,l="S",d=null;Dn(e=e||{})==="object"&&(t=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(r=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),l=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",t=(""+(t||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=O9;var y="1.3",g=h.__private__.getPdfVersion=function(){return y};h.__private__.setPdfVersion=function(ee){y=ee};var m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return m};var x=h.__private__.getPageFormat=function(ee){return m[ee]};a=a||"a4";var v="compat",w="advanced",_=v;function A(){this.saveGraphicsState(),le(new vt(ct,0,0,-ct,0,oo()*ct).toString()+" cm"),this.setFontSize(this.getFontSize()/ct),l="n",_=w}function P(){this.restoreGraphicsState(),l="S",_=v}var B=h.__private__.combineFontStyleAndFontWeight=function(ee,ye){if(ee=="bold"&&ye=="normal"||ee=="bold"&&ye==400||ee=="normal"&&ye=="italic"||ee=="bold"&&ye=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ye&&(ee=ye==400||ye==="normal"?ee==="italic"?"italic":"normal":ye!=700&&ye!=="bold"||ee!=="normal"?(ye==700?"bold":ye)+""+ee:"bold"),ee};h.advancedAPI=function(ee){var ye=_===v;return ye&&A.call(this),typeof ee!="function"||(ee(this),ye&&P.call(this)),this},h.compatAPI=function(ee){var ye=_===w;return ye&&P.call(this),typeof ee!="function"||(ee(this),ye&&A.call(this)),this},h.isAdvancedAPI=function(){return _===w};var T,I=function(ee){if(_!==w)throw new Error(ee+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},U=h.roundToPrecision=h.__private__.roundToPrecision=function(ee,ye){var Te=r||ye;if(isNaN(ee)||isNaN(Te))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ee.toFixed(Te).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof u=="number"?function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return U(ee,u)}:u==="smart"?function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return U(ee,ee>-1&&ee<1?16:5)}:function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return U(ee,16)};var H=h.f2=h.__private__.f2=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.f2");return U(ee,2)},z=h.__private__.f3=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.f3");return U(ee,3)},O=h.scale=h.__private__.scale=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.scale");return _===v?ee*ct:_===w?ee:void 0},L=function(ee){return O((function(ye){return _===v?oo()-ye:_===w?ye:void 0})(ee))};h.__private__.setPrecision=h.setPrecision=function(ee){typeof parseInt(ee,10)=="number"&&(r=parseInt(ee,10))};var E,k="00000000000000000000000000000000",N=h.__private__.getFileId=function(){return k},S=h.__private__.setFileId=function(ee){return k=ee!==void 0&&/^[a-fA-F0-9]{32}$/.test(ee)?ee.toUpperCase():k.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Bn=new Zp(d.userPermissions,d.userPassword,d.ownerPassword,k)),k};h.setFileId=function(ee){return S(ee),this},h.getFileId=function(){return N()};var C=h.__private__.convertDateToPDFDate=function(ee){var ye=ee.getTimezoneOffset(),Te=ye<0?"+":"-",Re=Math.floor(Math.abs(ye/60)),Ue=Math.abs(ye%60),lt=[Te,X(Re),"'",X(Ue),"'"].join("");return["D:",ee.getFullYear(),X(ee.getMonth()+1),X(ee.getDate()),X(ee.getHours()),X(ee.getMinutes()),X(ee.getSeconds()),lt].join("")},D=h.__private__.convertPDFDateToDate=function(ee){var ye=parseInt(ee.substr(2,4),10),Te=parseInt(ee.substr(6,2),10)-1,Re=parseInt(ee.substr(8,2),10),Ue=parseInt(ee.substr(10,2),10),lt=parseInt(ee.substr(12,2),10),gt=parseInt(ee.substr(14,2),10);return new Date(ye,Te,Re,Ue,lt,gt,0)},q=h.__private__.setCreationDate=function(ee){var ye;if(ee===void 0&&(ee=new Date),ee instanceof Date)ye=C(ee);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ee))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ye=ee}return E=ye},M=h.__private__.getCreationDate=function(ee){var ye=E;return ee==="jsDate"&&(ye=D(E)),ye};h.setCreationDate=function(ee){return q(ee),this},h.getCreationDate=function(ee){return M(ee)};var G,X=h.__private__.padd2=function(ee){return("0"+parseInt(ee)).slice(-2)},re=h.__private__.padd2Hex=function(ee){return("00"+(ee=ee.toString())).substr(ee.length)},V=0,J=[],W=[],F=0,Q=[],ne=[],ie=!1,ce=W;h.__private__.setCustomOutputDestination=function(ee){ie=!0,ce=ee};var de=function(ee){ie||(ce=ee)};h.__private__.resetCustomOutputDestination=function(){ie=!1,ce=W};var le=h.__private__.out=function(ee){return ee=ee.toString(),F+=ee.length+1,ce.push(ee),ce},_e=h.__private__.write=function(ee){return le(arguments.length===1?ee.toString():Array.prototype.join.call(arguments," "))},ue=h.__private__.getArrayBuffer=function(ee){for(var ye=ee.length,Te=new ArrayBuffer(ye),Re=new Uint8Array(Te);ye--;)Re[ye]=ee.charCodeAt(ye);return Te},pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return pe};var me=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(ee){return me=_===w?ee/ct:ee,this};var Ce,fe=h.__private__.getFontSize=h.getFontSize=function(){return _===v?me:me*ct},xe=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(ee){return xe=ee,this},h.__private__.getR2L=h.getR2L=function(){return xe};var je,Oe=h.__private__.setZoomMode=function(ee){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ee))Ce=ee;else if(isNaN(ee)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ee)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ee+'" is not recognized.');Ce=ee}else Ce=parseInt(ee,10)};h.__private__.getZoomMode=function(){return Ce};var Ie,Le=h.__private__.setPageMode=function(ee){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ee)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ee+'" is not recognized.');je=ee};h.__private__.getPageMode=function(){return je};var He=h.__private__.setLayoutMode=function(ee){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ee)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ee+'" is not recognized.');Ie=ee};h.__private__.getLayoutMode=function(){return Ie},h.__private__.setDisplayMode=h.setDisplayMode=function(ee,ye,Te){return Oe(ee),He(ye),Le(Te),this};var Qe={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(ee){if(Object.keys(Qe).indexOf(ee)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Qe[ee]},h.__private__.getDocumentProperties=function(){return Qe},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(ee){for(var ye in Qe)Qe.hasOwnProperty(ye)&&ee[ye]&&(Qe[ye]=ee[ye]);return this},h.__private__.setDocumentProperty=function(ee,ye){if(Object.keys(Qe).indexOf(ee)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Qe[ee]=ye};var Je,ct,it,At,pt,nt={},ht={},St=[],ot={},Bt={},Tt={},xt={},Kt=null,Pt=0,wt=[],ar=new O9(h),qr=e.hotfixes||[],Ft={},Er={},zr=[],vt=function ee(ye,Te,Re,Ue,lt,gt){if(!(this instanceof ee))return new ee(ye,Te,Re,Ue,lt,gt);isNaN(ye)&&(ye=1),isNaN(Te)&&(Te=0),isNaN(Re)&&(Re=0),isNaN(Ue)&&(Ue=1),isNaN(lt)&&(lt=0),isNaN(gt)&&(gt=0),this._matrix=[ye,Te,Re,Ue,lt,gt]};Object.defineProperty(vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ee){this._matrix[0]=ee}}),Object.defineProperty(vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ee){this._matrix[1]=ee}}),Object.defineProperty(vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ee){this._matrix[2]=ee}}),Object.defineProperty(vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ee){this._matrix[3]=ee}}),Object.defineProperty(vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ee){this._matrix[4]=ee}}),Object.defineProperty(vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ee){this._matrix[5]=ee}}),Object.defineProperty(vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(ee){this._matrix[0]=ee}}),Object.defineProperty(vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(ee){this._matrix[1]=ee}}),Object.defineProperty(vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(ee){this._matrix[2]=ee}}),Object.defineProperty(vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(ee){this._matrix[3]=ee}}),Object.defineProperty(vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(ee){this._matrix[4]=ee}}),Object.defineProperty(vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(ee){this._matrix[5]=ee}}),Object.defineProperty(vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vt.prototype.join=function(ee){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(ee)},vt.prototype.multiply=function(ee){var ye=ee.sx*this.sx+ee.shy*this.shx,Te=ee.sx*this.shy+ee.shy*this.sy,Re=ee.shx*this.sx+ee.sy*this.shx,Ue=ee.shx*this.shy+ee.sy*this.sy,lt=ee.tx*this.sx+ee.ty*this.shx+this.tx,gt=ee.tx*this.shy+ee.ty*this.sy+this.ty;return new vt(ye,Te,Re,Ue,lt,gt)},vt.prototype.decompose=function(){var ee=this.sx,ye=this.shy,Te=this.shx,Re=this.sy,Ue=this.tx,lt=this.ty,gt=Math.sqrt(ee*ee+ye*ye),Xt=(ee/=gt)*Te+(ye/=gt)*Re;Te-=ee*Xt,Re-=ye*Xt;var lr=Math.sqrt(Te*Te+Re*Re);return Xt/=lr,ee*(Re/=lr)<ye*(Te/=lr)&&(ee=-ee,ye=-ye,Xt=-Xt,gt=-gt),{scale:new vt(gt,0,0,lr,0,0),translate:new vt(1,0,0,1,Ue,lt),rotate:new vt(ee,ye,-ye,ee,0,0),skew:new vt(1,0,Xt,1,0,0)}},vt.prototype.toString=function(ee){return this.join(" ")},vt.prototype.inversed=function(){var ee=this.sx,ye=this.shy,Te=this.shx,Re=this.sy,Ue=this.tx,lt=this.ty,gt=1/(ee*Re-ye*Te),Xt=Re*gt,lr=-ye*gt,Or=-Te*gt,Lr=ee*gt;return new vt(Xt,lr,Or,Lr,-Xt*Ue-Or*lt,-lr*Ue-Lr*lt)},vt.prototype.applyToPoint=function(ee){var ye=ee.x*this.sx+ee.y*this.shx+this.tx,Te=ee.x*this.shy+ee.y*this.sy+this.ty;return new so(ye,Te)},vt.prototype.applyToRectangle=function(ee){var ye=this.applyToPoint(ee),Te=this.applyToPoint(new so(ee.x+ee.w,ee.y+ee.h));return new cu(ye.x,ye.y,Te.x-ye.x,Te.y-ye.y)},vt.prototype.clone=function(){var ee=this.sx,ye=this.shy,Te=this.shx,Re=this.sy,Ue=this.tx,lt=this.ty;return new vt(ee,ye,Te,Re,Ue,lt)},h.Matrix=vt;var Tr=h.matrixMult=function(ee,ye){return ye.multiply(ee)},Wr=new vt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Wr;var Qt=function(ee,ye){if(!Bt[ee]){var Te=(ye instanceof pf?"Sh":"P")+(Object.keys(ot).length+1).toString(10);ye.id=Te,Bt[ee]=Te,ot[Te]=ye,ar.publish("addPattern",ye)}};h.ShadingPattern=pf,h.TilingPattern=nm,h.addShadingPattern=function(ee,ye){return I("addShadingPattern()"),Qt(ee,ye),this},h.beginTilingPattern=function(ee){I("beginTilingPattern()"),ao(ee.boundingBox[0],ee.boundingBox[1],ee.boundingBox[2]-ee.boundingBox[0],ee.boundingBox[3]-ee.boundingBox[1],ee.matrix)},h.endTilingPattern=function(ee,ye){I("endTilingPattern()"),ye.stream=ne[G].join(`
`),Qt(ee,ye),ar.publish("endTilingPattern",ye),zr.pop().restore()};var Me,Be=h.__private__.newObject=function(){var ee=Ze();return yt(ee,!0),ee},Ze=h.__private__.newObjectDeferred=function(){return V++,J[V]=function(){return F},V},yt=function(ee,ye){return ye=typeof ye=="boolean"&&ye,J[ee]=F,ye&&le(ee+" 0 obj"),ee},Gt=h.__private__.newAdditionalObject=function(){var ee={objId:Ze(),content:""};return Q.push(ee),ee},kt=Ze(),sr=Ze(),Ut=h.__private__.decodeColorString=function(ee){var ye=ee.split(" ");if(ye.length!==2||ye[1]!=="g"&&ye[1]!=="G")ye.length!==5||ye[4]!=="k"&&ye[4]!=="K"||(ye=[(1-ye[0])*(1-ye[3]),(1-ye[1])*(1-ye[3]),(1-ye[2])*(1-ye[3]),"r"]);else{var Te=parseFloat(ye[0]);ye=[Te,Te,Te,"r"]}for(var Re="#",Ue=0;Ue<3;Ue++)Re+=("0"+Math.floor(255*parseFloat(ye[Ue])).toString(16)).slice(-2);return Re},It=h.__private__.encodeColorString=function(ee){var ye;typeof ee=="string"&&(ee={ch1:ee});var Te=ee.ch1,Re=ee.ch2,Ue=ee.ch3,lt=ee.ch4,gt=ee.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Te=="string"&&Te.charAt(0)!=="#"){var Xt=new KF(Te);if(Xt.ok)Te=Xt.toHex();else if(!/^\d*\.?\d*$/.test(Te))throw new Error('Invalid color "'+Te+'" passed to jsPDF.encodeColorString.')}if(typeof Te=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Te)&&(Te="#"+Te[1]+Te[1]+Te[2]+Te[2]+Te[3]+Te[3]),typeof Te=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Te)){var lr=parseInt(Te.substr(1),16);Te=lr>>16&255,Re=lr>>8&255,Ue=255&lr}if(Re===void 0||lt===void 0&&Te===Re&&Re===Ue)ye=typeof Te=="string"?Te+" "+gt[0]:ee.precision===2?H(Te/255)+" "+gt[0]:z(Te/255)+" "+gt[0];else if(lt===void 0||Dn(lt)==="object"){if(lt&&!isNaN(lt.a)&&lt.a===0)return["1.","1.","1.",gt[1]].join(" ");ye=typeof Te=="string"?[Te,Re,Ue,gt[1]].join(" "):ee.precision===2?[H(Te/255),H(Re/255),H(Ue/255),gt[1]].join(" "):[z(Te/255),z(Re/255),z(Ue/255),gt[1]].join(" ")}else ye=typeof Te=="string"?[Te,Re,Ue,lt,gt[2]].join(" "):ee.precision===2?[H(Te),H(Re),H(Ue),H(lt),gt[2]].join(" "):[z(Te),z(Re),z(Ue),z(lt),gt[2]].join(" ");return ye},or=h.__private__.getFilters=function(){return o},Zt=h.__private__.putStream=function(ee){var ye=(ee=ee||{}).data||"",Te=ee.filters||or(),Re=ee.alreadyAppliedFilters||[],Ue=ee.addLength1||!1,lt=ye.length,gt=ee.objectId,Xt=function(Js){return Js};if(d!==null&&gt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Xt=Bn.encryptor(gt,0));var lr={};Te===!0&&(Te=["FlateEncode"]);var Or=ee.additionalKeyValues||[],Lr=(lr=mr.API.processDataByFilters!==void 0?mr.API.processDataByFilters(ye,Te):{data:ye,reverseChain:[]}).reverseChain+(Array.isArray(Re)?Re.join(" "):Re.toString());if(lr.data.length!==0&&(Or.push({key:"Length",value:lr.data.length}),Ue===!0&&Or.push({key:"Length1",value:lt})),Lr.length!=0)if(Lr.split("/").length-1==1)Or.push({key:"Filter",value:Lr});else{Or.push({key:"Filter",value:"["+Lr+"]"});for(var cn=0;cn<Or.length;cn+=1)if(Or[cn].key==="DecodeParms"){for(var ns=[],Ls=0;Ls<lr.reverseChain.split("/").length-1;Ls+=1)ns.push("null");ns.push(Or[cn].value),Or[cn].value="["+ns.join(" ")+"]"}}le("<<");for(var $n=0;$n<Or.length;$n++)le("/"+Or[$n].key+" "+Or[$n].value);le(">>"),lr.data.length!==0&&(le("stream"),le(Xt(lr.data)),le("endstream"))},Nr=h.__private__.putPage=function(ee){var ye=ee.number,Te=ee.data,Re=ee.objId,Ue=ee.contentsObjId;yt(Re,!0),le("<</Type /Page"),le("/Parent "+ee.rootDictionaryObjId+" 0 R"),le("/Resources "+ee.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(T(ee.mediaBox.bottomLeftX))+" "+parseFloat(T(ee.mediaBox.bottomLeftY))+" "+T(ee.mediaBox.topRightX)+" "+T(ee.mediaBox.topRightY)+"]"),ee.cropBox!==null&&le("/CropBox ["+T(ee.cropBox.bottomLeftX)+" "+T(ee.cropBox.bottomLeftY)+" "+T(ee.cropBox.topRightX)+" "+T(ee.cropBox.topRightY)+"]"),ee.bleedBox!==null&&le("/BleedBox ["+T(ee.bleedBox.bottomLeftX)+" "+T(ee.bleedBox.bottomLeftY)+" "+T(ee.bleedBox.topRightX)+" "+T(ee.bleedBox.topRightY)+"]"),ee.trimBox!==null&&le("/TrimBox ["+T(ee.trimBox.bottomLeftX)+" "+T(ee.trimBox.bottomLeftY)+" "+T(ee.trimBox.topRightX)+" "+T(ee.trimBox.topRightY)+"]"),ee.artBox!==null&&le("/ArtBox ["+T(ee.artBox.bottomLeftX)+" "+T(ee.artBox.bottomLeftY)+" "+T(ee.artBox.topRightX)+" "+T(ee.artBox.topRightY)+"]"),typeof ee.userUnit=="number"&&ee.userUnit!==1&&le("/UserUnit "+ee.userUnit),ar.publish("putPage",{objId:Re,pageContext:wt[ye],pageNumber:ye,page:Te}),le("/Contents "+Ue+" 0 R"),le(">>"),le("endobj");var lt=Te.join(`
`);return _===w&&(lt+=`
Q`),yt(Ue,!0),Zt({data:lt,filters:or(),objectId:Ue}),le("endobj"),Re},an=h.__private__.putPages=function(){var ee,ye,Te=[];for(ee=1;ee<=Pt;ee++)wt[ee].objId=Ze(),wt[ee].contentsObjId=Ze();for(ee=1;ee<=Pt;ee++)Te.push(Nr({number:ee,data:ne[ee],objId:wt[ee].objId,contentsObjId:wt[ee].contentsObjId,mediaBox:wt[ee].mediaBox,cropBox:wt[ee].cropBox,bleedBox:wt[ee].bleedBox,trimBox:wt[ee].trimBox,artBox:wt[ee].artBox,userUnit:wt[ee].userUnit,rootDictionaryObjId:kt,resourceDictionaryObjId:sr}));yt(kt,!0),le("<</Type /Pages");var Re="/Kids [";for(ye=0;ye<Pt;ye++)Re+=Te[ye]+" 0 R ";le(Re+"]"),le("/Count "+Pt),le(">>"),le("endobj"),ar.publish("postPutPages")},Jr=function(ee){ar.publish("putFont",{font:ee,out:le,newObject:Be,putStream:Zt}),ee.isAlreadyPutted!==!0&&(ee.objectNumber=Be(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Jp(ee.postScriptName)),le("/Subtype /Type1"),typeof ee.encoding=="string"&&le("/Encoding /"+ee.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},Tn=function(ee){ee.objectNumber=Be();var ye=[];ye.push({key:"Type",value:"/XObject"}),ye.push({key:"Subtype",value:"/Form"}),ye.push({key:"BBox",value:"["+[T(ee.x),T(ee.y),T(ee.x+ee.width),T(ee.y+ee.height)].join(" ")+"]"}),ye.push({key:"Matrix",value:"["+ee.matrix.toString()+"]"});var Te=ee.pages[1].join(`
`);Zt({data:Te,additionalKeyValues:ye,objectId:ee.objectNumber}),le("endobj")},Pn=function(ee,ye){ye||(ye=21);var Te=Be(),Re=(function(gt,Xt){var lr,Or=[],Lr=1/(Xt-1);for(lr=0;lr<1;lr+=Lr)Or.push(lr);if(Or.push(1),gt[0].offset!=0){var cn={offset:0,color:gt[0].color};gt.unshift(cn)}if(gt[gt.length-1].offset!=1){var ns={offset:1,color:gt[gt.length-1].color};gt.push(ns)}for(var Ls="",$n=0,Js=0;Js<Or.length;Js++){for(lr=Or[Js];lr>gt[$n+1].offset;)$n++;var Ns=gt[$n].offset,Ta=(lr-Ns)/(gt[$n+1].offset-Ns),Rl=gt[$n].color,Po=gt[$n+1].color;Ls+=re(Math.round((1-Ta)*Rl[0]+Ta*Po[0]).toString(16))+re(Math.round((1-Ta)*Rl[1]+Ta*Po[1]).toString(16))+re(Math.round((1-Ta)*Rl[2]+Ta*Po[2]).toString(16))}return Ls.trim()})(ee.colors,ye),Ue=[];Ue.push({key:"FunctionType",value:"0"}),Ue.push({key:"Domain",value:"[0.0 1.0]"}),Ue.push({key:"Size",value:"["+ye+"]"}),Ue.push({key:"BitsPerSample",value:"8"}),Ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zt({data:Re,additionalKeyValues:Ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Te}),le("endobj"),ee.objectNumber=Be(),le("<< /ShadingType "+ee.type),le("/ColorSpace /DeviceRGB");var lt="/Coords ["+T(parseFloat(ee.coords[0]))+" "+T(parseFloat(ee.coords[1]))+" ";ee.type===2?lt+=T(parseFloat(ee.coords[2]))+" "+T(parseFloat(ee.coords[3])):lt+=T(parseFloat(ee.coords[2]))+" "+T(parseFloat(ee.coords[3]))+" "+T(parseFloat(ee.coords[4]))+" "+T(parseFloat(ee.coords[5])),le(lt+="]"),ee.matrix&&le("/Matrix ["+ee.matrix.toString()+"]"),le("/Function "+Te+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},js=function(ee,ye){var Te=Ze(),Re=Be();ye.push({resourcesOid:Te,objectOid:Re}),ee.objectNumber=Re;var Ue=[];Ue.push({key:"Type",value:"/Pattern"}),Ue.push({key:"PatternType",value:"1"}),Ue.push({key:"PaintType",value:"1"}),Ue.push({key:"TilingType",value:"1"}),Ue.push({key:"BBox",value:"["+ee.boundingBox.map(T).join(" ")+"]"}),Ue.push({key:"XStep",value:T(ee.xStep)}),Ue.push({key:"YStep",value:T(ee.yStep)}),Ue.push({key:"Resources",value:Te+" 0 R"}),ee.matrix&&Ue.push({key:"Matrix",value:"["+ee.matrix.toString()+"]"}),Zt({data:ee.stream,additionalKeyValues:Ue,objectId:ee.objectNumber}),le("endobj")},Ee=function(ee){for(var ye in ee.objectNumber=Be(),le("<<"),ee)switch(ye){case"opacity":le("/ca "+H(ee[ye]));break;case"stroke-opacity":le("/CA "+H(ee[ye]))}le(">>"),le("endobj")},ze=function(ee){yt(ee.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var ye in le("/Font <<"),nt)nt.hasOwnProperty(ye)&&(f===!1||f===!0&&p.hasOwnProperty(ye))&&le("/"+ye+" "+nt[ye].objectNumber+" 0 R");le(">>")})(),(function(){if(Object.keys(ot).length>0){for(var ye in le("/Shading <<"),ot)ot.hasOwnProperty(ye)&&ot[ye]instanceof pf&&ot[ye].objectNumber>=0&&le("/"+ye+" "+ot[ye].objectNumber+" 0 R");ar.publish("putShadingPatternDict"),le(">>")}})(),(function(ye){if(Object.keys(ot).length>0){for(var Te in le("/Pattern <<"),ot)ot.hasOwnProperty(Te)&&ot[Te]instanceof h.TilingPattern&&ot[Te].objectNumber>=0&&ot[Te].objectNumber<ye&&le("/"+Te+" "+ot[Te].objectNumber+" 0 R");ar.publish("putTilingPatternDict"),le(">>")}})(ee.objectOid),(function(){if(Object.keys(Tt).length>0){var ye;for(ye in le("/ExtGState <<"),Tt)Tt.hasOwnProperty(ye)&&Tt[ye].objectNumber>=0&&le("/"+ye+" "+Tt[ye].objectNumber+" 0 R");ar.publish("putGStateDict"),le(">>")}})(),(function(){for(var ye in le("/XObject <<"),Ft)Ft.hasOwnProperty(ye)&&Ft[ye].objectNumber>=0&&le("/"+ye+" "+Ft[ye].objectNumber+" 0 R");ar.publish("putXobjectDict"),le(">>")})(),le(">>"),le("endobj")},dt=function(ee){ht[ee.fontName]=ht[ee.fontName]||{},ht[ee.fontName][ee.fontStyle]=ee.id},mt=function(ee,ye,Te,Re,Ue){var lt={id:"F"+(Object.keys(nt).length+1).toString(10),postScriptName:ee,fontName:ye,fontStyle:Te,encoding:Re,isStandardFont:Ue||!1,metadata:{}};return ar.publish("addFont",{font:lt,instance:this}),nt[lt.id]=lt,dt(lt),lt.id},Rt=h.__private__.pdfEscape=h.pdfEscape=function(ee,ye){return(function(Te,Re){var Ue,lt,gt,Xt,lr,Or,Lr,cn,ns;if(gt=(Re=Re||{}).sourceEncoding||"Unicode",lr=Re.outputEncoding,(Re.autoencode||lr)&&nt[Je].metadata&&nt[Je].metadata[gt]&&nt[Je].metadata[gt].encoding&&(Xt=nt[Je].metadata[gt].encoding,!lr&&nt[Je].encoding&&(lr=nt[Je].encoding),!lr&&Xt.codePages&&(lr=Xt.codePages[0]),typeof lr=="string"&&(lr=Xt[lr]),lr)){for(Lr=!1,Or=[],Ue=0,lt=Te.length;Ue<lt;Ue++)(cn=lr[Te.charCodeAt(Ue)])?Or.push(String.fromCharCode(cn)):Or.push(Te[Ue]),Or[Ue].charCodeAt(0)>>8&&(Lr=!0);Te=Or.join("")}for(Ue=Te.length;Lr===void 0&&Ue!==0;)Te.charCodeAt(Ue-1)>>8&&(Lr=!0),Ue--;if(!Lr)return Te;for(Or=Re.noBOM?[]:[254,255],Ue=0,lt=Te.length;Ue<lt;Ue++){if((ns=(cn=Te.charCodeAt(Ue))>>8)>>8)throw new Error("Character at position "+Ue+" of string '"+Te+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Or.push(ns),Or.push(cn-(ns<<8))}return String.fromCharCode.apply(void 0,Or)})(ee,ye).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},jt=h.__private__.beginPage=function(ee){ne[++Pt]=[],wt[Pt]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ee[0]),topRightY:Number(ee[1])}},wr(Pt),de(ne[G])},Ct=function(ee,ye){var Te,Re,Ue;switch(t=ye||t,typeof ee=="string"&&(Te=x(ee.toLowerCase()),Array.isArray(Te)&&(Re=Te[0],Ue=Te[1])),Array.isArray(ee)&&(Re=ee[0]*ct,Ue=ee[1]*ct),isNaN(Re)&&(Re=a[0],Ue=a[1]),(Re>14400||Ue>14400)&&(Wn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Re=Math.min(14400,Re),Ue=Math.min(14400,Ue)),a=[Re,Ue],t.substr(0,1)){case"l":Ue>Re&&(a=[Ue,Re]);break;case"p":Re>Ue&&(a=[Ue,Re])}jt(a),xr(Ea),le(ou),Ah!==0&&le(Ah+" J"),Eh!==0&&le(Eh+" j"),ar.publish("addPage",{pageNumber:Pt})},Dr=function(ee){ee>0&&ee<=Pt&&(ne.splice(ee,1),wt.splice(ee,1),Pt--,G>Pt&&(G=Pt),this.setPage(G))},wr=function(ee){ee>0&&ee<=Pt&&(G=ee)},yr=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ne.length-1},dr=function(ee,ye,Te){var Re,Ue=void 0;return Te=Te||{},ee=ee!==void 0?ee:nt[Je].fontName,ye=ye!==void 0?ye:nt[Je].fontStyle,Re=ee.toLowerCase(),ht[Re]!==void 0&&ht[Re][ye]!==void 0?Ue=ht[Re][ye]:ht[ee]!==void 0&&ht[ee][ye]!==void 0?Ue=ht[ee][ye]:Te.disableWarning===!1&&Wn.warn("Unable to look up font label for font '"+ee+"', '"+ye+"'. Refer to getFontList() for available fonts."),Ue||Te.noFallback||(Ue=ht.times[ye])==null&&(Ue=ht.times.normal),Ue},br=h.__private__.putInfo=function(){var ee=Be(),ye=function(Re){return Re};for(var Te in d!==null&&(ye=Bn.encryptor(ee,0)),le("<<"),le("/Producer ("+Rt(ye("jsPDF "+mr.version))+")"),Qe)Qe.hasOwnProperty(Te)&&Qe[Te]&&le("/"+Te.substr(0,1).toUpperCase()+Te.substr(1)+" ("+Rt(ye(Qe[Te]))+")");le("/CreationDate ("+Rt(ye(E))+")"),le(">>"),le("endobj")},Yr=h.__private__.putCatalog=function(ee){var ye=(ee=ee||{}).rootDictionaryObjId||kt;switch(Be(),le("<<"),le("/Type /Catalog"),le("/Pages "+ye+" 0 R"),Ce||(Ce="fullwidth"),Ce){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Te=""+Ce;Te.substr(Te.length-1)==="%"&&(Ce=parseInt(Ce)/100),typeof Ce=="number"&&le("/OpenAction [3 0 R /XYZ null null "+H(Ce)+"]")}switch(Ie||(Ie="continuous"),Ie){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}je&&le("/PageMode /"+je),ar.publish("putCatalog"),le(">>"),le("endobj")},ln=h.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(V+1)),le("/Root "+V+" 0 R"),le("/Info "+(V-1)+" 0 R"),d!==null&&le("/Encrypt "+Bn.oid+" 0 R"),le("/ID [ <"+k+"> <"+k+"> ]"),le(">>")},Rr=h.__private__.putHeader=function(){le("%PDF-"+y),le("%")},Fn=h.__private__.putXRef=function(){var ee="0000000000";le("xref"),le("0 "+(V+1)),le("0000000000 65535 f ");for(var ye=1;ye<=V;ye++)typeof J[ye]=="function"?le((ee+J[ye]()).slice(-10)+" 00000 n "):J[ye]!==void 0?le((ee+J[ye]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},_n=h.__private__.buildDocument=function(){var ee;V=0,F=0,W=[],J=[],Q=[],kt=Ze(),sr=Ze(),de(W),ar.publish("buildDocument"),Rr(),an(),(function(){ar.publish("putAdditionalObjects");for(var Te=0;Te<Q.length;Te++){var Re=Q[Te];yt(Re.objId,!0),le(Re.content),le("endobj")}ar.publish("postPutAdditionalObjects")})(),ee=[],(function(){for(var Te in nt)nt.hasOwnProperty(Te)&&(f===!1||f===!0&&p.hasOwnProperty(Te))&&Jr(nt[Te])})(),(function(){var Te;for(Te in Tt)Tt.hasOwnProperty(Te)&&Ee(Tt[Te])})(),(function(){for(var Te in Ft)Ft.hasOwnProperty(Te)&&Tn(Ft[Te])})(),(function(Te){var Re;for(Re in ot)ot.hasOwnProperty(Re)&&(ot[Re]instanceof pf?Pn(ot[Re]):ot[Re]instanceof nm&&js(ot[Re],Te))})(ee),ar.publish("putResources"),ee.forEach(ze),ze({resourcesOid:sr,objectOid:Number.MAX_SAFE_INTEGER}),ar.publish("postPutResources"),d!==null&&(Bn.oid=Be(),le("<<"),le("/Filter /Standard"),le("/V "+Bn.v),le("/R "+Bn.r),le("/U <"+Bn.toHexString(Bn.U)+">"),le("/O <"+Bn.toHexString(Bn.O)+">"),le("/P "+Bn.P),le(">>"),le("endobj")),br(),Yr();var ye=F;return Fn(),ln(),le("startxref"),le(""+ye),le("%%EOF"),de(ne[G]),W.join(`
`)},cs=h.__private__.getBlob=function(ee){return new Blob([ue(ee)],{type:"application/pdf"})},ui=h.output=h.__private__.output=(Me=function(ee,ye){switch(typeof(ye=ye||{})=="string"?ye={filename:ye}:ye.filename=ye.filename||"generated.pdf",ee){case void 0:return _n();case"save":h.save(ye.filename);break;case"arraybuffer":return ue(_n());case"blob":return cs(_n());case"bloburi":case"bloburl":if(Ir.URL!==void 0&&typeof Ir.URL.createObjectURL=="function")return Ir.URL&&Ir.URL.createObjectURL(cs(_n()))||void 0;Wn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Te="",Re=_n();try{Te=E9(Re)}catch{Te=E9(unescape(encodeURIComponent(Re)))}return"data:application/pdf;filename="+ye.filename+";base64,"+Te;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var Ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",lt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ye.pdfObjectUrl&&(Ue=ye.pdfObjectUrl,lt="");var gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ue+'"'+lt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ye)+");<\/script></body></html>",Xt=Ir.open();return Xt!==null&&Xt.document.write(gt),Xt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ir)==="[object Window]"){var lr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ye.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ye.filename+'" width="500px" height="400px" /></body></html>',Or=Ir.open();if(Or!==null){Or.document.write(lr);var Lr=this;Or.document.documentElement.querySelector("#pdfViewer").onload=function(){Or.document.title=ye.filename,Or.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Lr.output("bloburl"))}}return Or}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ir)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ye)+'"></iframe></body></html>',ns=Ir.open();if(ns!==null&&(ns.document.write(cn),ns.document.title=ye.filename),ns||typeof safari>"u")return ns;break;case"datauri":case"dataurl":return Ir.document.location.href=this.output("datauristring",ye);default:return null}},Me.foo=function(){try{return Me.apply(this,arguments)}catch(Te){var ee=Te.stack||"";~ee.indexOf(" at ")&&(ee=ee.split(" at ")[1]);var ye="Error in function "+ee.split(`
`)[0].split("<")[0]+": "+Te.message;if(!Ir.console)throw new Error(ye);Ir.console.error(ye,Te),Ir.alert&&alert(ye)}},Me.foo.bar=Me,Me.foo),Ys=function(ee){return Array.isArray(qr)===!0&&qr.indexOf(ee)>-1};switch(n){case"pt":ct=1;break;case"mm":ct=72/25.4;break;case"cm":ct=72/2.54;break;case"in":ct=72;break;case"px":ct=Ys("px_scaling")==1?.75:96/72;break;case"pc":case"em":ct=12;break;case"ex":ct=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ct=n}var Bn=null;q(),S();var ha=h.__private__.getPageInfo=h.getPageInfo=function(ee){if(isNaN(ee)||ee%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[ee].objId,pageNumber:ee,pageContext:wt[ee]}},en=h.__private__.getPageInfoByObjId=function(ee){if(isNaN(ee)||ee%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ye in wt)if(wt[ye].objId===ee)break;return ha(ye)},Gr=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:wt[G].objId,pageNumber:G,pageContext:wt[G]}};h.addPage=function(){return Ct.apply(this,arguments),this},h.setPage=function(){return wr.apply(this,arguments),de.call(this,ne[G]),this},h.insertPage=function(ee){return this.addPage(),this.movePage(G,ee),this},h.movePage=function(ee,ye){var Te,Re;if(ee>ye){Te=ne[ee],Re=wt[ee];for(var Ue=ee;Ue>ye;Ue--)ne[Ue]=ne[Ue-1],wt[Ue]=wt[Ue-1];ne[ye]=Te,wt[ye]=Re,this.setPage(ye)}else if(ee<ye){Te=ne[ee],Re=wt[ee];for(var lt=ee;lt<ye;lt++)ne[lt]=ne[lt+1],wt[lt]=wt[lt+1];ne[ye]=Te,wt[ye]=Re,this.setPage(ye)}return this},h.deletePage=function(){return Dr.apply(this,arguments),this},h.__private__.text=h.text=function(ee,ye,Te,Re,Ue){var lt,gt,Xt,lr,Or,Lr,cn,ns,Ls,$n=(Re=Re||{}).scope||this;if(typeof ee=="number"&&typeof ye=="number"&&(typeof Te=="string"||Array.isArray(Te))){var Js=Te;Te=ye,ye=ee,ee=Js}if(arguments[3]instanceof vt==0?(Xt=arguments[4],lr=arguments[5],Dn(cn=arguments[3])==="object"&&cn!==null||(typeof Xt=="string"&&(lr=Xt,Xt=null),typeof cn=="string"&&(lr=cn,cn=null),typeof cn=="number"&&(Xt=cn,cn=null),Re={flags:cn,angle:Xt,align:lr})):(I("The transform parameter of text() with a Matrix value"),Ls=Ue),isNaN(ye)||isNaN(Te)||ee==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ee.length===0)return $n;var Ns,Ta="",Rl=typeof Re.lineHeightFactor=="number"?Re.lineHeightFactor:Zs,Po=$n.internal.scaleFactor;function Ll(fn){return fn=fn.split("	").join(Array(Re.TabLen||9).join(" ")),Rt(fn,cn)}function hu(fn){for(var Nn,ds=fn.concat(),Ds=[],Io=ds.length;Io--;)typeof(Nn=ds.shift())=="string"?Ds.push(Nn):Array.isArray(fn)&&(Nn.length===1||Nn[1]===void 0&&Nn[2]===void 0)?Ds.push(Nn[0]):Ds.push([Nn[0],Nn[1],Nn[2]]);return Ds}function Ad(fn,Nn){var ds;if(typeof fn=="string")ds=Nn(fn)[0];else if(Array.isArray(fn)){for(var Ds,Io,Mh=fn.concat(),Md=[],ql=Mh.length;ql--;)typeof(Ds=Mh.shift())=="string"?Md.push(Nn(Ds)[0]):Array.isArray(Ds)&&typeof Ds[0]=="string"&&(Io=Nn(Ds[0],Ds[1],Ds[2]),Md.push([Io[0],Io[1],Io[2]]));ds=Md}return ds}var wc=!1,fu=!0;if(typeof ee=="string")wc=!0;else if(Array.isArray(ee)){var _c=ee.concat();gt=[];for(var jc,Pa=_c.length;Pa--;)(typeof(jc=_c.shift())!="string"||Array.isArray(jc)&&typeof jc[0]!="string")&&(fu=!1);wc=fu}if(wc===!1)throw new Error('Type of text must be string or Array. "'+ee+'" is not recognized.');typeof ee=="string"&&(ee=ee.match(/[\r?\n]/)?ee.split(/\r\n|\r|\n/g):[ee]);var pu=me/$n.internal.scaleFactor,mu=pu*(Rl-1);switch(Re.baseline){case"bottom":Te-=mu;break;case"top":Te+=pu-mu;break;case"hanging":Te+=pu-2*mu;break;case"middle":Te+=pu/2-mu}if((Lr=Re.maxWidth||0)>0&&(typeof ee=="string"?ee=$n.splitTextToSize(ee,Lr):Object.prototype.toString.call(ee)==="[object Array]"&&(ee=ee.reduce(function(fn,Nn){return fn.concat($n.splitTextToSize(Nn,Lr))},[]))),lt={text:ee,x:ye,y:Te,options:Re,mutex:{pdfEscape:Rt,activeFontKey:Je,fonts:nt,activeFontSize:me}},ar.publish("preProcessText",lt),ee=lt.text,Xt=(Re=lt.options).angle,Ls instanceof vt==0&&Xt&&typeof Xt=="number"){Xt*=Math.PI/180,Re.rotationDirection===0&&(Xt=-Xt),_===w&&(Xt=-Xt);var Ph=Math.cos(Xt),Oh=Math.sin(Xt);Ls=new vt(Ph,Oh,-Oh,Ph,0,0)}else Xt&&Xt instanceof vt&&(Ls=Xt);_!==w||Ls||(Ls=Wr),(Or=Re.charSpace||ki)!==void 0&&(Ta+=T(O(Or))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ns=Re.horizontalScale)!==void 0&&(Ta+=T(100*ns)+` Tz
`),Re.lang;var fi=-1,Oo=Re.renderingMode!==void 0?Re.renderingMode:Re.stroke,nl=$n.internal.getCurrentPageInfo().pageContext;switch(Oo){case 0:case!1:case"fill":fi=0;break;case 1:case!0:case"stroke":fi=1;break;case 2:case"fillThenStroke":fi=2;break;case 3:case"invisible":fi=3;break;case 4:case"fillAndAddForClipping":fi=4;break;case 5:case"strokeAndAddPathForClipping":fi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fi=6;break;case 7:case"addToPathForClipping":fi=7}var ip=nl.usedRenderingMode!==void 0?nl.usedRenderingMode:-1;fi!==-1?Ta+=fi+` Tr
`:ip!==-1&&(Ta+=`0 Tr
`),fi!==-1&&(nl.usedRenderingMode=fi),lr=Re.align||"left";var Vi,Nc=me*Rl,Ed=$n.internal.pageSize.getWidth(),Td=nt[Je];Or=Re.charSpace||ki,Lr=Re.maxWidth||0,cn=Object.assign({autoencode:!0,noBOM:!0},Re.flags);var Dl=[],lo=function(fn){return $n.getStringUnitWidth(fn,{font:Td,charSpace:Or,fontSize:me,doKerning:!1})*me/Po};if(Object.prototype.toString.call(ee)==="[object Array]"){var Wi;gt=hu(ee),lr!=="left"&&(Vi=gt.map(lo));var Ki,kc=0;if(lr==="right"){ye-=Vi[0],ee=[],Pa=gt.length;for(var sl=0;sl<Pa;sl++)sl===0?(Ki=Hi(ye),Wi=Ml(Te)):(Ki=O(kc-Vi[sl]),Wi=-Nc),ee.push([gt[sl],Ki,Wi]),kc=Vi[sl]}else if(lr==="center"){ye-=Vi[0]/2,ee=[],Pa=gt.length;for(var Fl=0;Fl<Pa;Fl++)Fl===0?(Ki=Hi(ye),Wi=Ml(Te)):(Ki=O((kc-Vi[Fl])/2),Wi=-Nc),ee.push([gt[Fl],Ki,Wi]),kc=Vi[Fl]}else if(lr==="left"){ee=[],Pa=gt.length;for(var Bl=0;Bl<Pa;Bl++)ee.push(gt[Bl])}else if(lr==="justify"&&Td.encoding==="Identity-H"){ee=[],Pa=gt.length,Lr=Lr!==0?Lr:Ed;for(var al=0,ks=0;ks<Pa;ks++)if(Wi=ks===0?Ml(Te):-Nc,Ki=ks===0?Hi(ye):al,ks<Pa-1){var gu=O((Lr-Vi[ks])/(gt[ks].split(" ").length-1)),il=gt[ks].split(" ");ee.push([il[0]+" ",Ki,Wi]),al=0;for(var Mo=1;Mo<il.length;Mo++){var yu=(lo(il[Mo-1]+" "+il[Mo])-lo(il[Mo]))*Po+gu;Mo==il.length-1?ee.push([il[Mo],yu,0]):ee.push([il[Mo]+" ",yu,0]),al-=yu}}else ee.push([gt[ks],Ki,Wi]);ee.push(["",al,0])}else{if(lr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ee=[],Pa=gt.length,Lr=Lr!==0?Lr:Ed,ks=0;ks<Pa;ks++){Wi=ks===0?Ml(Te):-Nc,Ki=ks===0?Hi(ye):0;var xu=gt[ks].split(" ").length-1,Pd=xu>0?(Lr-Vi[ks])/xu:0;ks<Pa-1?Dl.push(T(O(Pd))):Dl.push(0),ee.push([gt[ks],Ki,Wi])}}}(typeof Re.R2L=="boolean"?Re.R2L:xe)===!0&&(ee=Ad(ee,function(fn,Nn,ds){return[fn.split("").reverse().join(""),Nn,ds]})),lt={text:ee,x:ye,y:Te,options:Re,mutex:{pdfEscape:Rt,activeFontKey:Je,fonts:nt,activeFontSize:me}},ar.publish("postProcessText",lt),ee=lt.text,Ns=lt.mutex.isHex||!1;var Od=nt[Je].encoding;Od!=="WinAnsiEncoding"&&Od!=="StandardEncoding"||(ee=Ad(ee,function(fn,Nn,ds){return[Ll(fn),Nn,ds]})),gt=hu(ee),ee=[];for(var $l,Sc,Cc,vu=Array.isArray(gt[0])?1:0,Ac="",bu=function(fn,Nn,ds){var Ds="";return ds instanceof vt?(ds=typeof Re.angle=="number"?Tr(ds,new vt(1,0,0,1,fn,Nn)):Tr(new vt(1,0,0,1,fn,Nn),ds),_===w&&(ds=Tr(new vt(1,0,0,-1,0,0),ds)),Ds=ds.join(" ")+` Tm
`):Ds=T(fn)+" "+T(Nn)+` Td
`,Ds},us=0;us<gt.length;us++){switch(Ac="",vu){case 1:Cc=(Ns?"<":"(")+gt[us][0]+(Ns?">":")"),$l=parseFloat(gt[us][1]),Sc=parseFloat(gt[us][2]);break;case 0:Cc=(Ns?"<":"(")+gt[us]+(Ns?">":")"),$l=Hi(ye),Sc=Ml(Te)}Dl!==void 0&&Dl[us]!==void 0&&(Ac=Dl[us]+` Tw
`),us===0?ee.push(Ac+bu($l,Sc,Ls)+Cc):vu===0?ee.push(Ac+Cc):vu===1&&ee.push(Ac+bu($l,Sc,Ls)+Cc)}ee=vu===0?ee.join(` Tj
T* `):ee.join(` Tj
`),ee+=` Tj
`;var Si=`BT
/`;return Si+=Je+" "+me+` Tf
`,Si+=T(me*Rl)+` TL
`,Si+=To+`
`,Si+=Ta,Si+=ee,le(Si+="ET"),p[Je]=!0,$n};var Ha=h.__private__.clip=h.clip=function(ee){return le(ee==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Ha("evenodd")},h.__private__.discardPath=h.discardPath=function(){return le("n"),this};var fa=h.__private__.isValidStyle=function(ee){var ye=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ee)!==-1&&(ye=!0),ye};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(ee){return fa(ee)&&(l=ee),this};var Co=h.__private__.getStyle=h.getStyle=function(ee){var ye=l;switch(ee){case"D":case"S":ye="S";break;case"F":ye="f";break;case"FD":case"DF":ye="B";break;case"f":case"f*":case"B":case"B*":ye=ee}return ye},Pr=h.close=function(){return le("h"),this};h.stroke=function(){return le("S"),this},h.fill=function(ee){return Ca("f",ee),this},h.fillEvenOdd=function(ee){return Ca("f*",ee),this},h.fillStroke=function(ee){return Ca("B",ee),this},h.fillStrokeEvenOdd=function(ee){return Ca("B*",ee),this};var Ca=function(ee,ye){Dn(ye)==="object"?Pl(ye,ee):le(ee)},Aa=function(ee){ee===null||_===w&&ee===void 0||(ee=Co(ee),le(ee))};function Ao(ee,ye,Te,Re,Ue){var lt=new nm(ye||this.boundingBox,Te||this.xStep,Re||this.yStep,this.gState,Ue||this.matrix);lt.stream=this.stream;var gt=ee+"$$"+this.cloneIndex+++"$$";return Qt(gt,lt),lt}var Pl=function(ee,ye){var Te=Bt[ee.key],Re=ot[Te];if(Re instanceof pf)le("q"),le(Eo(ye)),Re.gState&&h.setGState(Re.gState),le(ee.matrix.toString()+" cm"),le("/"+Te+" sh"),le("Q");else if(Re instanceof nm){var Ue=new vt(1,0,0,-1,0,oo());ee.matrix&&(Ue=Ue.multiply(ee.matrix||Wr),Te=Ao.call(Re,ee.key,ee.boundingBox,ee.xStep,ee.yStep,Ue).id),le("q"),le("/Pattern cs"),le("/"+Te+" scn"),Re.gState&&h.setGState(Re.gState),le(ye),le("Q")}},Eo=function(ee){switch(ee){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},di=h.moveTo=function(ee,ye){return le(T(O(ee))+" "+T(L(ye))+" m"),this},Ol=h.lineTo=function(ee,ye){return le(T(O(ee))+" "+T(L(ye))+" l"),this},Qs=h.curveTo=function(ee,ye,Te,Re,Ue,lt){return le([T(O(ee)),T(L(ye)),T(O(Te)),T(L(Re)),T(O(Ue)),T(L(lt)),"c"].join(" ")),this};h.__private__.line=h.line=function(ee,ye,Te,Re,Ue){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||isNaN(Re)||!fa(Ue))throw new Error("Invalid arguments passed to jsPDF.line");return _===v?this.lines([[Te-ee,Re-ye]],ee,ye,[1,1],Ue||"S"):this.lines([[Te-ee,Re-ye]],ee,ye,[1,1]).stroke()},h.__private__.lines=h.lines=function(ee,ye,Te,Re,Ue,lt){var gt,Xt,lr,Or,Lr,cn,ns,Ls,$n,Js,Ns,Ta;if(typeof ee=="number"&&(Ta=Te,Te=ye,ye=ee,ee=Ta),Re=Re||[1,1],lt=lt||!1,isNaN(ye)||isNaN(Te)||!Array.isArray(ee)||!Array.isArray(Re)||!fa(Ue)||typeof lt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(di(ye,Te),gt=Re[0],Xt=Re[1],Or=ee.length,Js=ye,Ns=Te,lr=0;lr<Or;lr++)(Lr=ee[lr]).length===2?(Js=Lr[0]*gt+Js,Ns=Lr[1]*Xt+Ns,Ol(Js,Ns)):(cn=Lr[0]*gt+Js,ns=Lr[1]*Xt+Ns,Ls=Lr[2]*gt+Js,$n=Lr[3]*Xt+Ns,Js=Lr[4]*gt+Js,Ns=Lr[5]*Xt+Ns,Qs(cn,ns,Ls,$n,Js,Ns));return lt&&Pr(),Aa(Ue),this},h.path=function(ee){for(var ye=0;ye<ee.length;ye++){var Te=ee[ye],Re=Te.c;switch(Te.op){case"m":di(Re[0],Re[1]);break;case"l":Ol(Re[0],Re[1]);break;case"c":Qs.apply(this,Re);break;case"h":Pr()}}return this},h.__private__.rect=h.rect=function(ee,ye,Te,Re,Ue){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||isNaN(Re)||!fa(Ue))throw new Error("Invalid arguments passed to jsPDF.rect");return _===v&&(Re=-Re),le([T(O(ee)),T(L(ye)),T(O(Te)),T(O(Re)),"re"].join(" ")),Aa(Ue),this},h.__private__.triangle=h.triangle=function(ee,ye,Te,Re,Ue,lt,gt){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||isNaN(Re)||isNaN(Ue)||isNaN(lt)||!fa(gt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Te-ee,Re-ye],[Ue-Te,lt-Re],[ee-Ue,ye-lt]],ee,ye,[1,1],gt,!0),this},h.__private__.roundedRect=h.roundedRect=function(ee,ye,Te,Re,Ue,lt,gt){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||isNaN(Re)||isNaN(Ue)||isNaN(lt)||!fa(gt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Xt=4/3*(Math.SQRT2-1);return Ue=Math.min(Ue,.5*Te),lt=Math.min(lt,.5*Re),this.lines([[Te-2*Ue,0],[Ue*Xt,0,Ue,lt-lt*Xt,Ue,lt],[0,Re-2*lt],[0,lt*Xt,-Ue*Xt,lt,-Ue,lt],[2*Ue-Te,0],[-Ue*Xt,0,-Ue,-lt*Xt,-Ue,-lt],[0,2*lt-Re],[0,-lt*Xt,Ue*Xt,-lt,Ue,-lt]],ee+Ue,ye,[1,1],gt,!0),this},h.__private__.ellipse=h.ellipse=function(ee,ye,Te,Re,Ue){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||isNaN(Re)||!fa(Ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var lt=4/3*(Math.SQRT2-1)*Te,gt=4/3*(Math.SQRT2-1)*Re;return di(ee+Te,ye),Qs(ee+Te,ye-gt,ee+lt,ye-Re,ee,ye-Re),Qs(ee-lt,ye-Re,ee-Te,ye-gt,ee-Te,ye),Qs(ee-Te,ye+gt,ee-lt,ye+Re,ee,ye+Re),Qs(ee+lt,ye+Re,ee+Te,ye+gt,ee+Te,ye),Aa(Ue),this},h.__private__.circle=h.circle=function(ee,ye,Te,Re){if(isNaN(ee)||isNaN(ye)||isNaN(Te)||!fa(Re))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ee,ye,Te,Te,Re)},h.setFont=function(ee,ye,Te){return Te&&(ye=B(ye,Te)),Je=dr(ee,ye,{disableWarning:!1}),this};var Ni=h.__private__.getFont=h.getFont=function(){return nt[dr.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var ee,ye,Te={};for(ee in ht)if(ht.hasOwnProperty(ee))for(ye in Te[ee]=[],ht[ee])ht[ee].hasOwnProperty(ye)&&Te[ee].push(ye);return Te},h.addFont=function(ee,ye,Te,Re,Ue){var lt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&lt.indexOf(arguments[3])!==-1?Ue=arguments[3]:arguments[3]&&lt.indexOf(arguments[3])==-1&&(Te=B(Te,Re)),mt.call(this,ee,ye,Te,Ue=Ue||"Identity-H")};var Zs,Ea=e.lineWidth||.200025,tl=h.__private__.getLineWidth=h.getLineWidth=function(){return Ea},xr=h.__private__.setLineWidth=h.setLineWidth=function(ee){return Ea=ee,le(T(O(ee))+" w"),this};h.__private__.setLineDash=mr.API.setLineDash=mr.API.setLineDashPattern=function(ee,ye){if(ee=ee||[],ye=ye||0,isNaN(ye)||!Array.isArray(ee))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ee=ee.map(function(Te){return T(O(Te))}).join(" "),ye=T(O(ye)),le("["+ee+"] "+ye+" d"),this};var hi=h.__private__.getLineHeight=h.getLineHeight=function(){return me*Zs};h.__private__.getLineHeight=h.getLineHeight=function(){return me*Zs};var Gm=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(ee){return typeof(ee=ee||1.15)=="number"&&(Zs=ee),this},sp=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Zs};Gm(e.lineHeight);var Hi=h.__private__.getHorizontalCoordinate=function(ee){return O(ee)},Ml=h.__private__.getVerticalCoordinate=function(ee){return _===w?ee:wt[G].mediaBox.topRightY-wt[G].mediaBox.bottomLeftY-O(ee)},ap=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(ee){return T(Hi(ee))},Nd=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(ee){return T(Ml(ee))},ou=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Ut(ou)},h.__private__.setStrokeColor=h.setDrawColor=function(ee,ye,Te,Re){return ou=It({ch1:ee,ch2:ye,ch3:Te,ch4:Re,pdfColorType:"draw",precision:2}),le(ou),this};var Ch=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Ut(Ch)},h.__private__.setFillColor=h.setFillColor=function(ee,ye,Te,Re){return Ch=It({ch1:ee,ch2:ye,ch3:Te,ch4:Re,pdfColorType:"fill",precision:2}),le(Ch),this};var To=e.textColor||"0 g",lu=h.__private__.getTextColor=h.getTextColor=function(){return Ut(To)};h.__private__.setTextColor=h.setTextColor=function(ee,ye,Te,Re){return To=It({ch1:ee,ch2:ye,ch3:Te,ch4:Re,pdfColorType:"text",precision:3}),this};var ki=e.charSpace,kd=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(ki||0)};h.__private__.setCharSpace=h.setCharSpace=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ki=ee,this};var Ah=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(ee){var ye=h.CapJoinStyles[ee];if(ye===void 0)throw new Error("Line cap style of '"+ee+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ah=ye,le(ye+" J"),this};var Eh=0;h.__private__.setLineJoin=h.setLineJoin=function(ee){var ye=h.CapJoinStyles[ee];if(ye===void 0)throw new Error("Line join style of '"+ee+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Eh=ye,le(ye+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(ee){if(ee=ee||0,isNaN(ee))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(T(O(ee))+" M"),this},h.GState=kb,h.setGState=function(ee){(ee=typeof ee=="string"?Tt[xt[ee]]:Sd(null,ee)).equals(Kt)||(le("/"+ee.id+" gs"),Kt=ee)};var Sd=function(ee,ye){if(!ee||!xt[ee]){var Te=!1;for(var Re in Tt)if(Tt.hasOwnProperty(Re)&&Tt[Re].equals(ye)){Te=!0;break}if(Te)ye=Tt[Re];else{var Ue="GS"+(Object.keys(Tt).length+1).toString(10);Tt[Ue]=ye,ye.id=Ue}return ee&&(xt[ee]=ye.id),ar.publish("addGState",ye),ye}};h.addGState=function(ee,ye){return Sd(ee,ye),this},h.saveGraphicsState=function(){return le("q"),St.push({key:Je,size:me,color:To}),this},h.restoreGraphicsState=function(){le("Q");var ee=St.pop();return Je=ee.key,me=ee.size,To=ee.color,Kt=null,this},h.setCurrentTransformationMatrix=function(ee){return le(ee.toString()+" cm"),this},h.comment=function(ee){return le("#"+ee),this};var so=function(ee,ye){var Te=ee||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Te},set:function(lt){isNaN(lt)||(Te=parseFloat(lt))}});var Re=ye||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Re},set:function(lt){isNaN(lt)||(Re=parseFloat(lt))}});var Ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ue},set:function(lt){Ue=lt.toString()}}),this},cu=function(ee,ye,Te,Re){so.call(this,ee,ye),this.type="rect";var Ue=Te||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ue},set:function(gt){isNaN(gt)||(Ue=parseFloat(gt))}});var lt=Re||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return lt},set:function(gt){isNaN(gt)||(lt=parseFloat(gt))}}),this},uu=function(){this.page=Pt,this.currentPage=G,this.pages=ne.slice(0),this.pagesContext=wt.slice(0),this.x=it,this.y=At,this.matrix=pt,this.width=bc(G),this.height=du(G),this.outputDestination=ce,this.id="",this.objectNumber=-1};uu.prototype.restore=function(){Pt=this.page,G=this.currentPage,wt=this.pagesContext,ne=this.pages,it=this.x,At=this.y,pt=this.matrix,Th(G,this.width),io(G,this.height),ce=this.outputDestination};var ao=function(ee,ye,Te,Re,Ue){zr.push(new uu),Pt=G=0,ne=[],it=ee,At=ye,pt=Ue,jt([Te,Re])};for(var Il in h.beginFormObject=function(ee,ye,Te,Re,Ue){return ao(ee,ye,Te,Re,Ue),this},h.endFormObject=function(ee){return(function(ye){if(Er[ye])zr.pop().restore();else{var Te=new uu,Re="Xo"+(Object.keys(Ft).length+1).toString(10);Te.id=Re,Er[ye]=Re,Ft[Re]=Te,ar.publish("addFormObject",Te),zr.pop().restore()}})(ee),this},h.doFormObject=function(ee,ye){var Te=Ft[Er[ee]];return le("q"),le(ye.toString()+" cm"),le("/"+Te.id+" Do"),le("Q"),this},h.getFormObject=function(ee){var ye=Ft[Er[ee]];return{x:ye.x,y:ye.y,width:ye.width,height:ye.height,matrix:ye.matrix}},h.save=function(ee,ye){return ee=ee||"generated.pdf",(ye=ye||{}).returnPromise=ye.returnPromise||!1,ye.returnPromise===!1?(uf(cs(_n()),ee),typeof uf.unload=="function"&&Ir.setTimeout&&setTimeout(uf.unload,911),this):new Promise(function(Te,Re){try{var Ue=uf(cs(_n()),ee);typeof uf.unload=="function"&&Ir.setTimeout&&setTimeout(uf.unload,911),Te(Ue)}catch(lt){Re(lt.message)}})},mr.API)mr.API.hasOwnProperty(Il)&&(Il==="events"&&mr.API.events.length?(function(ee,ye){var Te,Re,Ue;for(Ue=ye.length-1;Ue!==-1;Ue--)Te=ye[Ue][0],Re=ye[Ue][1],ee.subscribe.apply(ee,[Te].concat(typeof Re=="function"?[Re]:Re))})(ar,mr.API.events):h[Il]=mr.API[Il]);function bc(ee){return wt[ee].mediaBox.topRightX-wt[ee].mediaBox.bottomLeftX}function Th(ee,ye){wt[ee].mediaBox.topRightX=ye+wt[ee].mediaBox.bottomLeftX}function du(ee){return wt[ee].mediaBox.topRightY-wt[ee].mediaBox.bottomLeftY}function io(ee,ye){wt[ee].mediaBox.topRightY=ye+wt[ee].mediaBox.bottomLeftY}var rl=h.getPageWidth=function(ee){return bc(ee=ee||G)/ct},Va=h.setPageWidth=function(ee,ye){Th(ee,ye*ct)},oo=h.getPageHeight=function(ee){return du(ee=ee||G)/ct},Cd=h.setPageHeight=function(ee,ye){io(ee,ye*ct)};return h.internal={pdfEscape:Rt,getStyle:Co,getFont:Ni,getFontSize:fe,getCharSpace:kd,getTextColor:lu,getLineHeight:hi,getLineHeightFactor:sp,getLineWidth:tl,write:_e,getHorizontalCoordinate:Hi,getVerticalCoordinate:Ml,getCoordinateString:ap,getVerticalCoordinateString:Nd,collections:{},newObject:Be,newAdditionalObject:Gt,newObjectDeferred:Ze,newObjectDeferredBegin:yt,getFilters:or,putStream:Zt,events:ar,scaleFactor:ct,pageSize:{getWidth:function(){return rl(G)},setWidth:function(ee){Va(G,ee)},getHeight:function(){return oo(G)},setHeight:function(ee){Cd(G,ee)}},encryptionOptions:d,encryption:Bn,getEncryptor:function(ee){return d!==null?Bn.encryptor(ee,0):function(ye){return ye}},output:ui,getNumberOfPages:yr,get pages(){return ne},out:le,f2:H,f3:z,getPageInfo:ha,getPageInfoByObjId:en,getCurrentPageInfo:Gr,getPDFVersion:g,Point:so,Rectangle:cu,Matrix:vt,hasHotfix:Ys},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return rl(G)},set:function(ee){Va(G,ee)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return oo(G)},set:function(ee){Cd(G,ee)},enumerable:!0,configurable:!0}),(function(ee){for(var ye=0,Te=pe.length;ye<Te;ye++){var Re=mt.call(this,ee[ye][0],ee[ye][1],ee[ye][2],pe[ye][3],!0);f===!1&&(p[Re]=!0);var Ue=ee[ye][0].split("-");dt({id:Re,fontName:Ue[0],fontStyle:Ue[1]||""})}ar.publish("addFonts",{fonts:nt,dictionary:ht})}).call(h,pe),Je="F1",Ct(a,t),ar.publish("initialized"),h}Zp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Zp.prototype.toHexString=function(e){return e.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Zp.prototype.hexToBytes=function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(String.fromCharCode(parseInt(e.substr(t,2),16)));return r.join("")},Zp.prototype.processOwnerPassword=function(e,r){return y4(g4(r).substr(0,5),e)},Zp.prototype.encryptor=function(e,r){var t=g4(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&r,r>>8&255)).substr(0,10);return function(n){return y4(t,n)}},kb.prototype.equals=function(e){var r,t="id,objectNumber,equals";if(!e||Dn(e)!==Dn(this))return!1;var n=0;for(r in this)if(!(t.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!e.hasOwnProperty(r)||this[r]!==e[r])return!1;n++}for(r in e)e.hasOwnProperty(r)&&t.indexOf(r)<0&&n--;return n===0},mr.API={events:[]},mr.version="4.0.0";var zs=mr.API,y6=1,np=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Hp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Hr=function(e){return e.toFixed(2)},rh=function(e){return e.toFixed(5)};zs.__acroform__={};var So=function(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e},M9=function(e){return e*y6},Bc=function(e){var r=new QF,t=rr.internal.getHeight(e)||0,n=rr.internal.getWidth(e)||0;return r.BBox=[0,0,Number(Hr(n)),Number(Hr(t))],r},bbe=zs.__acroform__.setBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<r},wbe=zs.__acroform__.clearBit=function(e,r){if(e=e||0,r=r||0,isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<r)},_be=zs.__acroform__.getBit=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<r?1:0},ia=zs.__acroform__.getBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _be(e,r-1)},oa=zs.__acroform__.setBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return bbe(e,r-1)},la=zs.__acroform__.clearBitForPdf=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return wbe(e,r-1)},jbe=zs.__acroform__.calculateCoordinates=function(e,r){var t=r.internal.getHorizontalCoordinate,n=r.internal.getVerticalCoordinate,a=e[0],i=e[1],o=e[2],c=e[3],u={};return u.lowerLeft_X=t(a)||0,u.lowerLeft_Y=n(i+c)||0,u.upperRight_X=t(a+o)||0,u.upperRight_Y=n(i)||0,[Number(Hr(u.lowerLeft_X)),Number(Hr(u.lowerLeft_Y)),Number(Hr(u.upperRight_X)),Number(Hr(u.upperRight_Y))]},Nbe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var r=[],t=e._V||e.DV,n=x4(e,t),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(e.scope.__private__.encodeColorString(e.color)),r.push("/"+a+" "+Hr(n.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(n.text),r.push("ET"),r.push("Q"),r.push("EMC");var i=Bc(e);return i.scope=e.scope,i.stream=r.join(`
`),i}},x4=function(e,r){var t=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");a=e.multiline?a.map(function(H){return H.split(`
`)}):a.map(function(H){return[H]});var i=t,o=rr.internal.getHeight(e)||0;o=o<0?-o:o;var c=rr.internal.getWidth(e)||0;c=c<0?-c:c;var u=function(H,z,O){if(H+1<a.length){var L=z+" "+a[H+1][0];return qx(L,e,O).width<=c-4}return!1};i++;e:for(;i>0;){r="",i--;var l,d,f=qx("3",e,i).height,p=e.multiline?o-i:(o-f)/2,h=p+=2,y=0,g=0,m=0;if(i<=0){r=`(...) Tj
`,r+="% Width of Text: "+qx(r,e,i=12).width+", FieldWidth:"+c+`
`;break}for(var x="",v=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var _=!1;if(a[w].length!==1&&m!==a[w].length-1){if((f+2)*(v+2)+2>o)continue e;x+=a[w][m],_=!0,g=w,w--}else{x=(x+=a[w][m]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var A=parseInt(w),P=u(A,x,i),B=w>=a.length-1;if(P&&!B){x+=" ",m=0;continue}if(P||B){if(B)g=A;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=A}}for(var T="",I=y;I<=g;I++){var U=a[I];if(e.multiline){if(I===g){T+=U[m]+" ",m=(m+1)%U.length;continue}if(I===y){T+=U[U.length-1]+" ";continue}}T+=U[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,d=qx(T,e,i).width,e.textAlign){case"right":l=c-d-2;break;case"center":l=(c-d)/2;break;default:l=2}r+=Hr(l)+" "+Hr(h)+` Td
`,r+="("+np(T)+`) Tj
`,r+=-Hr(l)+` 0 Td
`,h=-(i+2),d=0,y=_?g:g+1,v++,x=""}break}return n.text=r,n.fontSize=i,n},qx=function(e,r,t){var n=r.scope.internal.getFont(r.fontName,r.fontStyle),a=r.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:r.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},kbe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Sbe=function(e,r){var t={type:"reference",object:e};r.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&r.internal.getPageInfo(e.page).pageContext.annotations.push(t)},Cbe=function(e,r){if(r.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(xc.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(kbe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");y6=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new ZF,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&Sbe(i,t)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(t){(function(n,a){var i=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var c=n[o],u=[],l=c.Rect;if(c.Rect&&(c.Rect=jbe(c.Rect,a)),a.internal.newObjectDeferredBegin(c.objId,!0),c.DA=rr.createDefaultAppearanceStream(c),Dn(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=l,c.hasAppearanceStream&&!c.appearanceStreamContent){var d=Nbe(c);u.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(c.appearanceStreamContent){var f="";for(var p in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(p)){var h=c.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var y=h[o];typeof y=="function"&&(y=y.call(a,c)),f+="/"+o+" "+y+" ",a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y)}}else typeof(y=h)=="function"&&(y=y.call(a,c)),f+="/"+o+" "+y,a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y);f+=">>"}u.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:u,objectId:c.objId}),a.internal.out("endobj")}i&&(function(g,m){for(var x in g)if(g.hasOwnProperty(x)){var v=x,w=g[x];m.internal.newObjectDeferredBegin(w.objId,!0),Dn(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}})(a.internal.acroformPlugin.xForms,a)})(t,e)}),e.internal.acroformPlugin.isInitialized=!0}},YF=zs.__acroform__.arrayToPdfArray=function(e,r,t){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),Dn(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(r!==void 0&&t&&(n=t.internal.getEncryptor(r)),a+="("+np(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},f5=function(e,r,t){var n=function(a){return a};return r!==void 0&&t&&(n=t.internal.getEncryptor(r)),(e=e||"").toString(),"("+np(n(e))+")"},Wc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Wc.prototype.toString=function(){return this.objId+" 0 R"},Wc.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Wc.prototype.getKeyValueListForStream=function(){var e=[],r=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in r)if(Object.getOwnPropertyDescriptor(this,r[t]).configurable===!1){var n=r[t],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:YF(a,this.objId,this.scope)}):a instanceof Wc?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var QF=function(){Wc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};So(QF,Wc);var ZF=function(){Wc.call(this);var e,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+np(t(e))+")"}},set:function(t){e=t}})};So(ZF,Wc);var xc=function e(){Wc.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');r=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ia(r,3)},set:function(x){x?this.F=oa(r,3):this.F=la(r,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');t=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Sb)return;i="FieldObject"+e.FieldNum++}var x=function(v){return v};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+np(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var l=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return l===void 0?50/y6:l},set:function(x){l=x}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(x){d=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Sb||this instanceof Tf))return f5(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ri==0?f5(p,this.objId,this.scope):p},set:function(x){x=x.toString(),p=this instanceof ri==0?x.substr(0,1)==="("?Hp(x.substr(1,x.length-2)):Hp(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ri==1?Hp(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof ri==1?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ri==0?f5(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof ri==0?x.substr(0,1)==="("?Hp(x.substr(1,x.length-2)):Hp(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ri==1?Hp(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof ri==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(x){y=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,1)},set:function(x){x?this.Ff=oa(this.Ff,1):this.Ff=la(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,2)},set:function(x){x?this.Ff=oa(this.Ff,2):this.Ff=la(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,3)},set:function(x){x?this.Ff=oa(this.Ff,3):this.Ff=la(this.Ff,3)}});var m=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(m!==null)return m},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');m=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(m){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:m=2;break;case"center":case 1:m=1;break;default:m=0}}})};So(xc,Wc);var dm=function(){xc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return YF(r,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=(function(i,o,c){c||(c=1);for(var u,l=[];u=o.exec(i);)l.push(u[c]);return l})(n,/\((.*?)\)/g)),r=a}}),this.getOptions=function(){return r},this.setOptions=function(t){r=t,this.sort&&r.sort()},this.addOption=function(t){t=(t=t||"").toString(),r.push(t),this.sort&&r.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();r.indexOf(t)!==-1&&(r.splice(r.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,18)},set:function(t){t?this.Ff=oa(this.Ff,18):this.Ff=la(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=oa(this.Ff,19):this.Ff=la(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,20)},set:function(t){t?(this.Ff=oa(this.Ff,20),r.sort()):this.Ff=la(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,22)},set:function(t){t?this.Ff=oa(this.Ff,22):this.Ff=la(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,23)},set:function(t){t?this.Ff=oa(this.Ff,23):this.Ff=la(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,27)},set:function(t){t?this.Ff=oa(this.Ff,27):this.Ff=la(this.Ff,27)}}),this.hasAppearanceStream=!1};So(dm,xc);var hm=function(){dm.call(this),this.fontName="helvetica",this.combo=!1};So(hm,dm);var fm=function(){hm.call(this),this.combo=!0};So(fm,hm);var lv=function(){fm.call(this),this.edit=!0};So(lv,fm);var ri=function(){xc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,15)},set:function(t){t?this.Ff=oa(this.Ff,15):this.Ff=la(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,16)},set:function(t){t?this.Ff=oa(this.Ff,16):this.Ff=la(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,17)},set:function(t){t?this.Ff=oa(this.Ff,17):this.Ff=la(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,26)},set:function(t){t?this.Ff=oa(this.Ff,26):this.Ff=la(this.Ff,26)}});var e,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var n,a=[];for(n in a.push("<<"),r)a.push("/"+n+" ("+np(t(r[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){Dn(t)==="object"&&(r=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(t){typeof t=="string"&&(r.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};So(ri,xc);var cv=function(){ri.call(this),this.pushButton=!0};So(cv,ri);var pm=function(){ri.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r!==void 0?r:[]}})};So(pm,ri);var Sb=function(){var e,r;xc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(a){r=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(c){return c};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+np(a(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Dn(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};So(Sb,xc),pm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var t=this.Kids[r];t.appearanceStreamContent=e.createAppearanceStream(t.optionName),t.caption=e.getCA()}},pm.prototype.createOption=function(e){var r=new Sb;return r.Parent=this,r.optionName=e,this.Kids.push(r),Abe.call(this.scope,r),r};var uv=function(){ri.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rr.CheckBox.createAppearanceStream()};So(uv,ri);var Tf=function(){xc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,13)},set:function(r){r?this.Ff=oa(this.Ff,13):this.Ff=la(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,21)},set:function(r){r?this.Ff=oa(this.Ff,21):this.Ff=la(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,23)},set:function(r){r?this.Ff=oa(this.Ff,23):this.Ff=la(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,24)},set:function(r){r?this.Ff=oa(this.Ff,24):this.Ff=la(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,25)},set:function(r){r?this.Ff=oa(this.Ff,25):this.Ff=la(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,26)},set:function(r){r?this.Ff=oa(this.Ff,26):this.Ff=la(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){Number.isInteger(r)&&(e=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};So(Tf,xc);var dv=function(){Tf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ia(this.Ff,14)},set:function(e){e?this.Ff=oa(this.Ff,14):this.Ff=la(this.Ff,14)}}),this.password=!0};So(dv,Tf);var rr={CheckBox:{createAppearanceStream:function(){return{N:{On:rr.CheckBox.YesNormal},D:{On:rr.CheckBox.YesPushDown,Off:rr.CheckBox.OffPushDown}}},YesPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=x4(e,e.caption);return t.push("0.749023 g"),t.push("0 0 "+Hr(rr.internal.getWidth(e))+" "+Hr(rr.internal.getHeight(e))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Hr(i.fontSize)+" Tf "+a),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),r.stream=t.join(`
`),r},YesNormal:function(e){var r=Bc(e);r.scope=e.scope;var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=rr.internal.getHeight(e),o=rr.internal.getWidth(e),c=x4(e,e.caption);return a.push("1 g"),a.push("0 0 "+Hr(o)+" "+Hr(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Hr(o-1)+" "+Hr(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+Hr(c.fontSize)+" Tf "+n),a.push(c.text),a.push("ET"),a.push("Q"),r.stream=a.join(`
`),r},OffPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Hr(rr.internal.getWidth(e))+" "+Hr(rr.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(e){var r={D:{Off:rr.RadioButton.Circle.OffPushDown},N:{}};return r.N[e]=rr.RadioButton.Circle.YesNormal,r.D[e]=rr.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(e){var r=Bc(e);r.scope=e.scope;var t=[],n=rr.internal.getWidth(e)<=rr.internal.getHeight(e)?rr.internal.getWidth(e)/4:rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=rr.internal.Bezier_C,i=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+rh(rr.internal.getWidth(e)/2)+" "+rh(rr.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=[],n=rr.internal.getWidth(e)<=rr.internal.getHeight(e)?rr.internal.getWidth(e)/4:rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*rr.internal.Bezier_C).toFixed(5)),o=Number((n*rr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+rh(rr.internal.getWidth(e)/2)+" "+rh(rr.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+rh(rr.internal.getWidth(e)/2)+" "+rh(rr.internal.getHeight(e)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r},OffPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=[],n=rr.internal.getWidth(e)<=rr.internal.getHeight(e)?rr.internal.getWidth(e)/4:rr.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*rr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+rh(rr.internal.getWidth(e)/2)+" "+rh(rr.internal.getHeight(e)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),r.stream=t.join(`
`),r}},Cross:{createAppearanceStream:function(e){var r={D:{Off:rr.RadioButton.Cross.OffPushDown},N:{}};return r.N[e]=rr.RadioButton.Cross.YesNormal,r.D[e]=rr.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(e){var r=Bc(e);r.scope=e.scope;var t=[],n=rr.internal.calculateCross(e);return t.push("q"),t.push("1 1 "+Hr(rr.internal.getWidth(e)-2)+" "+Hr(rr.internal.getHeight(e)-2)+" re"),t.push("W"),t.push("n"),t.push(Hr(n.x1.x)+" "+Hr(n.x1.y)+" m"),t.push(Hr(n.x2.x)+" "+Hr(n.x2.y)+" l"),t.push(Hr(n.x4.x)+" "+Hr(n.x4.y)+" m"),t.push(Hr(n.x3.x)+" "+Hr(n.x3.y)+" l"),t.push("s"),t.push("Q"),r.stream=t.join(`
`),r},YesPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=rr.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Hr(rr.internal.getWidth(e))+" "+Hr(rr.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Hr(rr.internal.getWidth(e)-2)+" "+Hr(rr.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Hr(t.x1.x)+" "+Hr(t.x1.y)+" m"),n.push(Hr(t.x2.x)+" "+Hr(t.x2.y)+" l"),n.push(Hr(t.x4.x)+" "+Hr(t.x4.y)+" m"),n.push(Hr(t.x3.x)+" "+Hr(t.x3.y)+" l"),n.push("s"),n.push("Q"),r.stream=n.join(`
`),r},OffPushDown:function(e){var r=Bc(e);r.scope=e.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Hr(rr.internal.getWidth(e))+" "+Hr(rr.internal.getHeight(e))+" re"),t.push("f"),r.stream=t.join(`
`),r}}},createDefaultAppearanceStream:function(e){var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,t=e.scope.__private__.encodeColorString(e.color);return"/"+r+" "+e.fontSize+" Tf "+t}};rr.internal={Bezier_C:.551915024494,calculateCross:function(e){var r=rr.internal.getWidth(e),t=rr.internal.getHeight(e),n=Math.min(r,t);return{x1:{x:(r-n)/2,y:(t-n)/2+n},x2:{x:(r-n)/2+n,y:(t-n)/2},x3:{x:(r-n)/2,y:(t-n)/2},x4:{x:(r-n)/2+n,y:(t-n)/2+n}}}},rr.internal.getWidth=function(e){var r=0;return Dn(e)==="object"&&(r=M9(e.Rect[2])),r},rr.internal.getHeight=function(e){var r=0;return Dn(e)==="object"&&(r=M9(e.Rect[3])),r};var Abe=zs.addField=function(e){if(Cbe(this,e),!(e instanceof xc))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=e).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};zs.AcroFormChoiceField=dm,zs.AcroFormListBox=hm,zs.AcroFormComboBox=fm,zs.AcroFormEditBox=lv,zs.AcroFormButton=ri,zs.AcroFormPushButton=cv,zs.AcroFormRadioButton=pm,zs.AcroFormCheckBox=uv,zs.AcroFormTextField=Tf,zs.AcroFormPasswordField=dv,zs.AcroFormAppearance=rr,zs.AcroForm={ChoiceField:dm,ListBox:hm,ComboBox:fm,EditBox:lv,Button:ri,PushButton:cv,RadioButton:pm,CheckBox:uv,TextField:Tf,PasswordField:dv,Appearance:rr},mr.AcroForm={ChoiceField:dm,ListBox:hm,ComboBox:fm,EditBox:lv,Button:ri,PushButton:cv,RadioButton:pm,CheckBox:uv,TextField:Tf,PasswordField:dv,Appearance:rr};mr.AcroForm;function JF(e){return e.reduce(function(r,t,n){return r[t]=n,r},{})}(function(e){var r="addImage_";e.__addimage__={};var t="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(H,z){var O,L,E,k,N,S=t;if((z=z||t)==="RGBA"||H.data!==void 0&&H.data instanceof Uint8ClampedArray&&"height"in H&&"width"in H)return"RGBA";if(P(H))for(N in n)for(E=n[N],O=0;O<E.length;O+=1){for(k=!0,L=0;L<E[O].length;L+=1)if(E[O][L]!==void 0&&E[O][L]!==H[L]){k=!1;break}if(k===!0){S=N;break}}else for(N in n)for(E=n[N],O=0;O<E.length;O+=1){for(k=!0,L=0;L<E[O].length;L+=1)if(E[O][L]!==void 0&&E[O][L]!==H.charCodeAt(L)){k=!1;break}if(k===!0){S=N;break}}return S===t&&z!==t&&(S=z),S},i=function H(z){for(var O=this.internal.write,L=this.internal.putStream,E=(0,this.internal.getFilters)();E.indexOf("FlateEncode")!==-1;)E.splice(E.indexOf("FlateEncode"),1);z.objectId=this.internal.newObject();var k=[];if(k.push({key:"Type",value:"/XObject"}),k.push({key:"Subtype",value:"/Image"}),k.push({key:"Width",value:z.width}),k.push({key:"Height",value:z.height}),z.colorSpace===x.INDEXED?k.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(z.palette.length/3-1)+" "+("sMask"in z&&z.sMask!==void 0?z.objectId+2:z.objectId+1)+" 0 R]"}):(k.push({key:"ColorSpace",value:"/"+z.colorSpace}),z.colorSpace===x.DEVICE_CMYK&&k.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),k.push({key:"BitsPerComponent",value:z.bitsPerComponent}),"decodeParameters"in z&&z.decodeParameters!==void 0&&k.push({key:"DecodeParms",value:"<<"+z.decodeParameters+">>"}),"transparency"in z&&Array.isArray(z.transparency)&&z.transparency.length>0){for(var N="",S=0,C=z.transparency.length;S<C;S++)N+=z.transparency[S]+" "+z.transparency[S]+" ";k.push({key:"Mask",value:"["+N+"]"})}z.sMask!==void 0&&k.push({key:"SMask",value:z.objectId+1+" 0 R"});var D=z.filter!==void 0?["/"+z.filter]:void 0;if(L({data:z.data,additionalKeyValues:k,alreadyAppliedFilters:D,objectId:z.objectId}),O("endobj"),"sMask"in z&&z.sMask!==void 0){var q,M=(q=z.sMaskBitsPerComponent)!==null&&q!==void 0?q:z.bitsPerComponent,G={width:z.width,height:z.height,colorSpace:"DeviceGray",bitsPerComponent:M,data:z.sMask};"filter"in z&&(G.decodeParameters="/Predictor ".concat(z.predictor," /Colors 1 /BitsPerComponent ").concat(M," /Columns ").concat(z.width),G.filter=z.filter),H.call(this,G)}if(z.colorSpace===x.INDEXED){var X=this.internal.newObject();L({data:T(new Uint8Array(z.palette)),objectId:X}),O("endobj")}},o=function(){var H=this.internal.collections[r+"images"];for(var z in H)i.call(this,H[z])},c=function(){var H,z=this.internal.collections[r+"images"],O=this.internal.write;for(var L in z)O("/I"+(H=z[L]).index,H.objectId,"0","R")},u=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",c))},l=function(){var H=this.internal.collections[r+"images"];return u.call(this),H},d=function(){return Object.keys(this.internal.collections[r+"images"]).length},f=function(H){return typeof e["process"+H.toUpperCase()]=="function"},p=function(H){return Dn(H)==="object"&&H.nodeType===1},h=function(H,z){if(H.nodeName==="IMG"&&H.hasAttribute("src")){var O=""+H.getAttribute("src");if(O.indexOf("data:image/")===0)return ov(unescape(O).split("base64,").pop());var L=e.loadFile(O,!0);if(L!==void 0)return L}if(H.nodeName==="CANVAS"){if(H.width===0||H.height===0)throw new Error("Given canvas must have data. Canvas width: "+H.width+", height: "+H.height);var E;switch(z){case"PNG":E="image/png";break;case"WEBP":E="image/webp";break;default:E="image/jpeg"}return ov(H.toDataURL(E,1).split("base64,").pop())}},y=function(H){var z=this.internal.collections[r+"images"];if(z){for(var O in z)if(H===z[O].alias)return z[O]}},g=function(H,z,O){return H||z||(H=-96,z=-96),H<0&&(H=-1*O.width*72/H/this.internal.scaleFactor),z<0&&(z=-1*O.height*72/z/this.internal.scaleFactor),H===0&&(H=z*O.width/O.height),z===0&&(z=H*O.height/O.width),[H,z]},m=function(H,z,O,L,E,k){var N=g.call(this,O,L,E),S=this.internal.getCoordinateString,C=this.internal.getVerticalCoordinateString,D=l.call(this);if(O=N[0],L=N[1],D[E.index]=E,k){k*=Math.PI/180;var q=Math.cos(k),M=Math.sin(k),G=function(re){return re.toFixed(4)},X=[G(q),G(M),G(-1*M),G(q),0,0,"cm"]}this.internal.write("q"),k?(this.internal.write([1,"0","0",1,S(H),C(z+L),"cm"].join(" ")),this.internal.write(X.join(" ")),this.internal.write([S(O),"0","0",S(L),"0","0","cm"].join(" "))):this.internal.write([S(O),"0","0",S(L),S(H),C(z+L),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+E.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(H){var z,O,L=0;if(typeof H=="string")for(O=H.length,z=0;z<O;z++)L=(L<<5)-L+H.charCodeAt(z),L|=0;else if(P(H))for(O=H.byteLength/2,z=0;z<O;z++)L=(L<<5)-L+H[z],L|=0;return L},_=e.__addimage__.validateStringAsBase64=function(H){(H=H||"").toString().trim();var z=!0;return H.length===0&&(z=!1),H.length%4!=0&&(z=!1),/^[A-Za-z0-9+/]+$/.test(H.substr(0,H.length-2))===!1&&(z=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(H.substr(-2))===!1&&(z=!1),z},A=e.__addimage__.extractImageFromDataUrl=function(H){if(H==null||!(H=H.trim()).startsWith("data:"))return null;var z=H.indexOf(",");return z<0?null:H.substring(0,z).trim().endsWith("base64")?H.substring(z+1):null};e.__addimage__.isArrayBuffer=function(H){return H instanceof ArrayBuffer};var P=e.__addimage__.isArrayBufferView=function(H){return H instanceof Int8Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array},B=e.__addimage__.binaryStringToUint8Array=function(H){for(var z=H.length,O=new Uint8Array(z),L=0;L<z;L++)O[L]=H.charCodeAt(L);return O},T=e.__addimage__.arrayBufferToBinaryString=function(H){for(var z="",O=P(H)?H:new Uint8Array(H),L=0;L<O.length;L+=8192)z+=String.fromCharCode.apply(null,O.subarray(L,L+8192));return z};e.addImage=function(){var H,z,O,L,E,k,N,S,C;if(typeof arguments[1]=="number"?(z=t,O=arguments[1],L=arguments[2],E=arguments[3],k=arguments[4],N=arguments[5],S=arguments[6],C=arguments[7]):(z=arguments[1],O=arguments[2],L=arguments[3],E=arguments[4],k=arguments[5],N=arguments[6],S=arguments[7],C=arguments[8]),Dn(H=arguments[0])==="object"&&!p(H)&&"imageData"in H){var D=H;H=D.imageData,z=D.format||z||t,O=D.x||O||0,L=D.y||L||0,E=D.w||D.width||E,k=D.h||D.height||k,N=D.alias||N,S=D.compression||S,C=D.rotation||D.angle||C}var q=this.internal.getFilters();if(S===void 0&&q.indexOf("FlateEncode")!==-1&&(S="SLOW"),isNaN(O)||isNaN(L))throw new Error("Invalid coordinates passed to jsPDF.addImage");u.call(this);var M=I.call(this,H,z,N,S);return m.call(this,O,L,E,k,M,C),this};var I=function(H,z,O,L){var E,k,N;if(typeof H=="string"&&a(H)===t){H=unescape(H);var S=U(H,!1);(S!==""||(S=e.loadFile(H,!0))!==void 0)&&(H=S)}if(p(H)&&(H=h(H,z)),z=a(H,z),!f(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(((N=O)==null||N.length===0)&&(O=(function(C){return typeof C=="string"||P(C)?w(C):P(C.data)?w(C.data):null})(H)),(E=y.call(this,O))||(H instanceof Uint8Array||z==="RGBA"||(k=H,H=B(H)),E=this["process"+z.toUpperCase()](H,d.call(this),O,(function(C){return C&&typeof C=="string"&&(C=C.toUpperCase()),C in e.image_compression?C:v.NONE})(L),k)),!E)throw new Error("An unknown error occurred whilst processing the image.");return E},U=e.__addimage__.convertBase64ToBinaryString=function(H,z){z=typeof z!="boolean"||z;var O,L="";if(typeof H=="string"){var E;O=(E=A(H))!==null&&E!==void 0?E:H;try{L=ov(O)}catch(k){if(z)throw _(O)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+k.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return L};e.getImageProperties=function(H){var z,O,L="";if(p(H)&&(H=h(H)),typeof H=="string"&&a(H)===t&&((L=U(H,!1))===""&&(L=e.loadFile(H)||""),H=L),O=a(H),!f(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(H instanceof Uint8Array||(H=B(H)),!(z=this["process"+O.toUpperCase()](H)))throw new Error("An unknown error occurred whilst processing the image");return z.fileType=O,z}})(mr.API),(function(e){var r=function(t){if(t!==void 0&&t!="")return!0};mr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(t){for(var n,a,i,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,d=!1,f=0;f<l.length&&!d;f++)switch((n=l[f]).type){case"link":(r(n.options.url)||r(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<l.length;p++){n=l[p];var h=this.internal.pdfEscape,y=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),v=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",i+=" /Popup "+m.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+h(x(v))+") >>",g.content=i;var w=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",m.content=i,this.internal.write(g.objId,"0 R",m.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+c(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var _=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(y(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var A=this.annotations._nameMap[n.options.name];n.options.pageNumber=A.page,n.options.top=A.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var P=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+P+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},e.link=function(t,n,a,i,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(t),y:l(n),w:u(t+a),h:l(n+i)},options:o,type:"link"})},e.textWithLink=function(t,n,a,i){var o,c,u=this.getTextWidth(t),l=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){c=i.maxWidth;var d=this.splitTextToSize(t,c).length;o=Math.ceil(l*d)}else c=u,o=l;return this.text(t,n,a,i),a+=.2*l,i.align==="center"&&(n-=u/2),i.align==="right"&&(n-=u),this.link(n,a-l,c,o,i),u},e.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}})(mr.API),(function(e){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return r[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},c=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&i(g)&&r[g.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&i(g)&&r[g.charCodeAt(0)].length>=1};var l=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&i(g)&&r[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&i(g)&&r[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&i(g)&&r[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var m=0,x=t,v="",w=0;for(m=0;m<g.length;m+=1)x[g.charCodeAt(m)]!==void 0?(w++,typeof(x=x[g.charCodeAt(m)])=="number"&&(v+=String.fromCharCode(x),x=t,w=0),m===g.length-1&&(x=t,v+=g.charAt(m-(w-1)),m-=w-1,w=0)):(x=t,v+=g.charAt(m-w),m-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,m,x){return o(g)?i(g)===!1?-1:!l(g)||!o(m)&&!o(x)||!o(x)&&c(m)||c(g)&&!o(m)||c(g)&&u(m)||c(g)&&c(m)?0:d(g)&&o(m)&&!c(m)&&o(x)&&l(x)?3:c(g)||!o(x)?1:2:-1},h=function(g){var m=0,x=0,v=0,w="",_="",A="",P=(g=g||"").split("\\s+"),B=[];for(m=0;m<P.length;m+=1){for(B.push(""),x=0;x<P[m].length;x+=1)w=P[m][x],_=P[m][x-1],A=P[m][x+1],o(w)?(v=p(w,_,A),B[m]+=v!==-1?String.fromCharCode(r[w.charCodeAt(0)][v]):w):B[m]+=w;B[m]=f(B[m])}return B.join(" ")},y=e.__arabicParser__.processArabic=e.processArabic=function(){var g,m=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(m)){var v=0;for(x=[],v=0;v<m.length;v+=1)Array.isArray(m[v])?x.push([h(m[v][0]),m[v][1],m[v][2]]):x.push([h(m[v])]);g=x}else g=h(m);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",y])})(mr.API),mr.API.autoPrint=function(e){var r;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(e){var r=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(c){t=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(c){i=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(mr.API),(function(e){var r={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var l=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(g){y=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,l){n.call(this);var d=(l=l||{}).fontSize||this.getFontSize(),f=l.font||this.getFont(),p=l.scaleFactor||this.internal.scaleFactor,h=0,y=0,g=0,m=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var x=l.maxWidth;x>0?typeof u=="string"?u=this.splitTextToSize(u,x):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(w,_){return w.concat(m.splitTextToSize(_,x))},[])):u=Array.isArray(u)?u:[u];for(var v=0;v<u.length;v++)h<(g=this.getStringUnitWidth(u[v],{font:f})*d)&&(h=g);return h!==0&&(y=u.length),{w:h/=p,h:Math.max((y*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var l=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||r,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return l.lineNumber!==void 0&&(l.lineNumber===u.lineNumber?(u.x=(l.x||0)+(l.width||0),u.y=l.y||0):l.y+l.height+u.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=f.top,h&&p&&(this.printHeaderRow(u.lineNumber,!0),u.y+=p[0].height)):u.y=l.y+l.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,t===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-d,u.y+d,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+d,{align:"center",baseline:"top",maxWidth:u.width-d-d}):this.text(u.text,u.x+d,u.y+d,{align:"left",baseline:"top",maxWidth:u.width-d-d})),this.internal.__cell__.lastCell=u,this};e.table=function(u,l,d,f,p){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,y,g,m,x=[],v=[],w=[],_={},A={},P=[],B=[],T=(p=p||{}).autoSize||!1,I=p.printHeaders!==!1,U=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,H=p.margins||Object.assign({width:this.getPageWidth()},r),z=typeof p.padding=="number"?p.padding:3,O=p.headerBackgroundColor||"#c8c8c8",L=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=I,this.internal.__cell__.margins=H,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=z,this.internal.__cell__.headerBackgroundColor=O,this.internal.__cell__.headerTextColor=L,this.setFontSize(U),f==null)v=x=Object.keys(d[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Dn(f[0])==="object")for(x=f.map(function(D){return D.name}),v=f.map(function(D){return D.prompt||D.name||""}),w=f.map(function(D){return D.align||"left"}),h=0;h<f.length;h+=1)A[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=x=f,w=x.map(function(){return"left"}));if(T||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(_[m=x[h]]=d.map(function(D){return D[m]}),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(v[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=_[m],this.setFont(void 0,"normal"),g=0;g<y.length;g+=1)P.push(this.getTextDimensions(y[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);A[m]=Math.max.apply(null,P)+z+z,P=[]}if(I){var E={};for(h=0;h<x.length;h+=1)E[x[h]]={},E[x[h]].text=v[h],E[x[h]].align=w[h];var k=c.call(this,E,A);B=x.map(function(D){return new i(u,l,A[D],k,E[D].text,void 0,E[D].align)}),this.setTableHeaderRow(B),this.printHeaderRow(1,!1)}var N=f.reduce(function(D,q){return D[q.name]=q.align,D},{});for(h=0;h<d.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:d[h]},this);var S=c.call(this,d[h],A);for(g=0;g<x.length;g+=1){var C=d[h][x[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:C},this),o.call(this,new i(u,l,A[x[g]],S,C,h+2,N[x[g]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=l,this};var c=function(u,l){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(u).map(function(h){var y=u[h];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,l[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/p+d+d},this).reduce(function(h,y){return Math.max(h,y)},0)};e.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,l){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),l&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=u;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(y)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}})(mr.API);var eB={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},tB=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],v4=JF(tB),rB=[100,200,300,400,500,600,700,800,900],Ebe=JF(rB);function p5(e){var r=e.family.replace(/"|'/g,"").toLowerCase(),t=(function(i){return eB[i=i||"normal"]?i:"normal"})(e.style),n=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(e.weight),a=(function(i){return typeof v4[i=i||"normal"]=="number"?i:"normal"})(e.stretch);return{family:r,style:t,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:r,style:[a,t,n].join(" ")}}}function I9(e,r,t,n){var a;for(a=t;a>=0&&a<r.length;a+=n)if(e[r[a]])return e[r[a]];for(a=t;a>=0&&a<r.length;a-=n)if(e[r[a]])return e[r[a]]}var Tbe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},R9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function L9(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function D9(e){return e.trimLeft()}function Pbe(e,r){for(var t=0;t<e.length;){if(e.charAt(t)===r)return[e.substring(0,t),e.substring(t+1)];t+=1}return null}function Obe(e){var r=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],e.substring(r[0].length)]}var zx,F9,B9,Vp,Ux,$9,q9,z9,m5=["times"];function U9(e,r,t,n,a){var i=4,o=V9;switch(a){case mr.API.image_compression.FAST:i=1,o=H9;break;case mr.API.image_compression.MEDIUM:i=6,o=W9;break;case mr.API.image_compression.SLOW:i=9,o=K9}e=(function(u,l,d,f){for(var p,h=u.length/l,y=new Uint8Array(u.length+h),g=[Mbe,H9,V9,W9,K9],m=0;m<h;m+=1){var x=m*l,v=u.subarray(x,x+l);if(f)y.set(f(v,d,p),x+m);else{for(var w=g.length,_=[],A=0;A<w;A+=1)_[A]=g[A](v,d,p);var P=Rbe(_.concat());y.set(_[P],x+m)}p=v}return y})(e,r,Math.ceil(t*n/8),o);var c=h4(e,{level:i});return mr.API.__addimage__.arrayBufferToBinaryString(c)}function Mbe(e){var r=Array.apply([],e);return r.unshift(0),r}function H9(e,r){var t=e.length,n=[];n[0]=1;for(var a=0;a<t;a+=1){var i=e[a-r]||0;n[a+1]=e[a]-i+256&255}return n}function V9(e,r,t){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var o=t&&t[i]||0;a[i+1]=e[i]-o+256&255}return a}function W9(e,r,t){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var o=e[i-r]||0,c=t&&t[i]||0;a[i+1]=e[i]+256-(o+c>>>1)&255}return a}function K9(e,r,t){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var o=Ibe(e[i-r]||0,t&&t[i]||0,t&&t[i-r]||0);a[i+1]=e[i]-o+256&255}return a}function Ibe(e,r,t){if(e===r&&r===t)return e;var n=Math.abs(r-t),a=Math.abs(e-t),i=Math.abs(e+r-t-t);return n<=a&&n<=i?e:a<=i?r:t}function Rbe(e){var r=e.map(function(t){return t.reduce(function(n,a){return n+Math.abs(a)},0)});return r.indexOf(Math.min.apply(null,r))}function g5(e,r,t){var n=r*t,a=Math.floor(n/8),i=16-(n-8*a+t),o=(1<<t)-1;return nB(e,a)>>i&o}function G9(e,r,t,n){var a=t*n,i=Math.floor(a/8),o=16-(a-8*i+n),c=(1<<n)-1,u=(r&c)<<o;(function(l,d,f){if(d+1<l.byteLength)l.setUint16(d,f,!1);else{var p=f>>8&255;l.setUint8(d,p)}})(e,i,nB(e,i)&~(c<<o)&65535|u)}function nB(e,r){return r+1<e.byteLength?e.getUint16(r,!1):e.getUint8(r)<<8}function Lbe(e){var r=0;if(e[r++]!==71||e[r++]!==73||e[r++]!==70||e[r++]!==56||(e[r++]+1&253)!=56||e[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=e[r++]|e[r++]<<8,n=e[r++]|e[r++]<<8,a=e[r++],i=a>>7,o=1<<1+(7&a);e[r++],e[r++];var c=null,u=null;i&&(c=r,u=o,r+=3*o);var l=!0,d=[],f=0,p=null,h=0,y=null;for(this.width=t,this.height=n;l&&r<e.length;)switch(e[r++]){case 33:switch(e[r++]){case 255:if(e[r]!==11||e[r+1]==78&&e[r+2]==69&&e[r+3]==84&&e[r+4]==83&&e[r+5]==67&&e[r+6]==65&&e[r+7]==80&&e[r+8]==69&&e[r+9]==50&&e[r+10]==46&&e[r+11]==48&&e[r+12]==3&&e[r+13]==1&&e[r+16]==0)r+=14,y=e[r++]|e[r++]<<8,r++;else for(r+=12;;){if(!((H=e[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;case 249:if(e[r++]!==4||e[r+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[r++];f=e[r++]|e[r++]<<8,p=e[r++],1&g||(p=null),h=g>>2&7,r++;break;case 254:for(;;){if(!((H=e[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;default:throw new Error("Unknown graphic control label: 0x"+e[r-1].toString(16))}break;case 44:var m=e[r++]|e[r++]<<8,x=e[r++]|e[r++]<<8,v=e[r++]|e[r++]<<8,w=e[r++]|e[r++]<<8,_=e[r++],A=_>>6&1,P=1<<1+(7&_),B=c,T=u,I=!1;_>>7&&(I=!0,B=r,T=P,r+=3*P);var U=r;for(r++;;){var H;if(!((H=e[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}d.push({x:m,y:x,width:v,height:w,has_local_palette:I,palette_offset:B,palette_size:T,data_offset:U,data_length:r-U,transparent_index:p,interlaced:!!A,delay:f,disposal:h});break;case 59:l=!1;break;default:throw new Error("Unknown gif block: 0x"+e[r-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return y},this.frameInfo=function(z){if(z<0||z>=d.length)throw new Error("Frame index out of range.");return d[z]},this.decodeAndBlitFrameBGRA=function(z,O){var L=this.frameInfo(z),E=L.width*L.height,k=new Uint8Array(E);X9(e,L.data_offset,k,E);var N=L.palette_offset,S=L.transparent_index;S===null&&(S=256);var C=L.width,D=t-C,q=C,M=4*(L.y*t+L.x),G=4*((L.y+L.height)*t+L.x),X=M,re=4*D;L.interlaced===!0&&(re+=4*t*7);for(var V=8,J=0,W=k.length;J<W;++J){var F=k[J];if(q===0&&(q=C,(X+=re)>=G&&(re=4*D+4*t*(V-1),X=M+(C+D)*(V<<1),V>>=1)),F===S)X+=4;else{var Q=e[N+3*F],ne=e[N+3*F+1],ie=e[N+3*F+2];O[X++]=ie,O[X++]=ne,O[X++]=Q,O[X++]=255}--q}},this.decodeAndBlitFrameRGBA=function(z,O){var L=this.frameInfo(z),E=L.width*L.height,k=new Uint8Array(E);X9(e,L.data_offset,k,E);var N=L.palette_offset,S=L.transparent_index;S===null&&(S=256);var C=L.width,D=t-C,q=C,M=4*(L.y*t+L.x),G=4*((L.y+L.height)*t+L.x),X=M,re=4*D;L.interlaced===!0&&(re+=4*t*7);for(var V=8,J=0,W=k.length;J<W;++J){var F=k[J];if(q===0&&(q=C,(X+=re)>=G&&(re=4*D+4*t*(V-1),X=M+(C+D)*(V<<1),V>>=1)),F===S)X+=4;else{var Q=e[N+3*F],ne=e[N+3*F+1],ie=e[N+3*F+2];O[X++]=Q,O[X++]=ne,O[X++]=ie,O[X++]=255}--q}}}function X9(e,r,t,n){for(var a=e[r++],i=1<<a,o=i+1,c=o+1,u=a+1,l=(1<<u)-1,d=0,f=0,p=0,h=e[r++],y=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)f|=e[r++]<<d,d+=8,h===1?h=e[r++]:--h;if(d<u)break;var m=f&l;if(f>>=u,d-=u,m!==i){if(m===o)break;for(var x=m<c?m:g,v=0,w=x;w>i;)w=y[w]>>8,++v;var _=w;if(p+v+(x!==m?1:0)>n)return void Wn.log("Warning, gif stream longer than expected.");t[p++]=_;var A=p+=v;for(x!==m&&(t[p++]=_),w=x;v--;)w=y[w],t[--A]=255&w,w>>=8;g!==null&&c<4096&&(y[c++]=g<<8|_,c>=l+1&&u<12&&(++u,l=l<<1|1)),g=m}else c=o+1,l=(1<<(u=a+1))-1,g=null}return p!==n&&Wn.log("Warning, gif stream shorter than expected."),t}function y5(e){var r,t,n,a,i,o=Math.floor,c=new Array(64),u=new Array(64),l=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),y=new Array(64),g=[],m=0,x=7,v=new Array(64),w=new Array(64),_=new Array(64),A=new Array(256),P=new Array(2048),B=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],z=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],L=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],E=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function k(M,G){for(var X=0,re=0,V=new Array,J=1;J<=16;J++){for(var W=1;W<=M[J];W++)V[G[re]]=[],V[G[re]][0]=X,V[G[re]][1]=J,re++,X++;X*=2}return V}function N(M){for(var G=M[0],X=M[1]-1;X>=0;)G&1<<X&&(m|=1<<x),X--,--x<0&&(m==255?(S(255),S(0)):S(m),x=7,m=0)}function S(M){g.push(M)}function C(M){S(M>>8&255),S(255&M)}function D(M,G,X,re,V){for(var J,W=V[0],F=V[240],Q=(function(me,Ce){var fe,xe,je,Oe,Ie,Le,He,Qe,Je,ct,it=0;for(Je=0;Je<8;++Je){fe=me[it],xe=me[it+1],je=me[it+2],Oe=me[it+3],Ie=me[it+4],Le=me[it+5],He=me[it+6];var At=fe+(Qe=me[it+7]),pt=fe-Qe,nt=xe+He,ht=xe-He,St=je+Le,ot=je-Le,Bt=Oe+Ie,Tt=Oe-Ie,xt=At+Bt,Kt=At-Bt,Pt=nt+St,wt=nt-St;me[it]=xt+Pt,me[it+4]=xt-Pt;var ar=.707106781*(wt+Kt);me[it+2]=Kt+ar,me[it+6]=Kt-ar;var qr=.382683433*((xt=Tt+ot)-(wt=ht+pt)),Ft=.5411961*xt+qr,Er=1.306562965*wt+qr,zr=.707106781*(Pt=ot+ht),vt=pt+zr,Tr=pt-zr;me[it+5]=Tr+Ft,me[it+3]=Tr-Ft,me[it+1]=vt+Er,me[it+7]=vt-Er,it+=8}for(it=0,Je=0;Je<8;++Je){fe=me[it],xe=me[it+8],je=me[it+16],Oe=me[it+24],Ie=me[it+32],Le=me[it+40],He=me[it+48];var Wr=fe+(Qe=me[it+56]),Qt=fe-Qe,Me=xe+He,Be=xe-He,Ze=je+Le,yt=je-Le,Gt=Oe+Ie,kt=Oe-Ie,sr=Wr+Gt,Ut=Wr-Gt,It=Me+Ze,or=Me-Ze;me[it]=sr+It,me[it+32]=sr-It;var Zt=.707106781*(or+Ut);me[it+16]=Ut+Zt,me[it+48]=Ut-Zt;var Nr=.382683433*((sr=kt+yt)-(or=Be+Qt)),an=.5411961*sr+Nr,Jr=1.306562965*or+Nr,Tn=.707106781*(It=yt+Be),Pn=Qt+Tn,js=Qt-Tn;me[it+40]=js+an,me[it+24]=js-an,me[it+8]=Pn+Jr,me[it+56]=Pn-Jr,it++}for(Je=0;Je<64;++Je)ct=me[Je]*Ce[Je],h[Je]=ct>0?ct+.5|0:ct-.5|0;return h})(M,G),ne=0;ne<64;++ne)y[B[ne]]=Q[ne];var ie=y[0]-X;X=y[0],ie==0?N(re[0]):(N(re[p[J=32767+ie]]),N(f[J]));for(var ce=63;ce>0&&y[ce]==0;)ce--;if(ce==0)return N(W),X;for(var de,le=1;le<=ce;){for(var _e=le;y[le]==0&&le<=ce;)++le;var ue=le-_e;if(ue>=16){de=ue>>4;for(var pe=1;pe<=de;++pe)N(F);ue&=15}J=32767+y[le],N(V[(ue<<4)+p[J]]),N(f[J]),le++}return ce!=63&&N(W),X}function q(M){M=Math.min(Math.max(M,1),100),i!=M&&((function(G){for(var X=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],re=0;re<64;re++){var V=o((X[re]*G+50)/100);V=Math.min(Math.max(V,1),255),c[B[re]]=V}for(var J=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],W=0;W<64;W++){var F=o((J[W]*G+50)/100);F=Math.min(Math.max(F,1),255),u[B[W]]=F}for(var Q=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ne=0,ie=0;ie<8;ie++)for(var ce=0;ce<8;ce++)l[ne]=1/(c[B[ne]]*Q[ie]*Q[ce]*8),d[ne]=1/(u[B[ne]]*Q[ie]*Q[ce]*8),ne++})(M<50?Math.floor(5e3/M):Math.floor(200-2*M)),i=M)}this.encode=function(M,G){G&&q(G),g=new Array,m=0,x=7,C(65496),C(65504),C(16),S(74),S(70),S(73),S(70),S(0),S(1),S(1),S(0),C(1),C(1),S(0),S(0),(function(){C(65499),C(132),S(0);for(var xe=0;xe<64;xe++)S(c[xe]);S(1);for(var je=0;je<64;je++)S(u[je])})(),(function(xe,je){C(65472),C(17),S(8),C(je),C(xe),S(3),S(1),S(17),S(0),S(2),S(17),S(1),S(3),S(17),S(1)})(M.width,M.height),(function(){C(65476),C(418),S(0);for(var xe=0;xe<16;xe++)S(T[xe+1]);for(var je=0;je<=11;je++)S(I[je]);S(16);for(var Oe=0;Oe<16;Oe++)S(U[Oe+1]);for(var Ie=0;Ie<=161;Ie++)S(H[Ie]);S(1);for(var Le=0;Le<16;Le++)S(z[Le+1]);for(var He=0;He<=11;He++)S(O[He]);S(17);for(var Qe=0;Qe<16;Qe++)S(L[Qe+1]);for(var Je=0;Je<=161;Je++)S(E[Je])})(),C(65498),C(12),S(3),S(1),S(0),S(2),S(17),S(3),S(17),S(0),S(63),S(0);var X=0,re=0,V=0;m=0,x=7,this.encode.displayName="_encode_";for(var J,W,F,Q,ne,ie,ce,de,le,_e=M.data,ue=M.width,pe=M.height,me=4*ue,Ce=0;Ce<pe;){for(J=0;J<me;){for(ne=me*Ce+J,ce=-1,de=0,le=0;le<64;le++)ie=ne+(de=le>>3)*me+(ce=4*(7&le)),Ce+de>=pe&&(ie-=me*(Ce+1+de-pe)),J+ce>=me&&(ie-=J+ce-me+4),W=_e[ie++],F=_e[ie++],Q=_e[ie++],v[le]=(P[W]+P[F+256|0]+P[Q+512|0]>>16)-128,w[le]=(P[W+768|0]+P[F+1024|0]+P[Q+1280|0]>>16)-128,_[le]=(P[W+1280|0]+P[F+1536|0]+P[Q+1792|0]>>16)-128;X=D(v,l,X,r,n),re=D(w,d,re,t,a),V=D(_,d,V,t,a),J+=32}Ce+=8}if(x>=0){var fe=[];fe[1]=x+1,fe[0]=(1<<x+1)-1,N(fe)}return C(65497),new Uint8Array(g)},e=e||50,(function(){for(var M=String.fromCharCode,G=0;G<256;G++)A[G]=M(G)})(),r=k(T,I),t=k(z,O),n=k(U,H),a=k(L,E),(function(){for(var M=1,G=2,X=1;X<=15;X++){for(var re=M;re<G;re++)p[32767+re]=X,f[32767+re]=[],f[32767+re][1]=X,f[32767+re][0]=re;for(var V=-(G-1);V<=-M;V++)p[32767+V]=X,f[32767+V]=[],f[32767+V][1]=X,f[32767+V][0]=G-1+V;M<<=1,G<<=1}})(),(function(){for(var M=0;M<256;M++)P[M]=19595*M,P[M+256|0]=38470*M,P[M+512|0]=7471*M+32768,P[M+768|0]=-11059*M,P[M+1024|0]=-21709*M,P[M+1280|0]=32768*M+8421375,P[M+1536|0]=-27439*M,P[M+1792|0]=-5329*M})(),q(e)}function Zl(e,r){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Y9(e){function r(I){if(!I)throw Error("assert :P")}function t(I,U,H){for(var z=0;4>z;z++)if(I[U+z]!=H.charCodeAt(z))return!0;return!1}function n(I,U,H,z,O){for(var L=0;L<O;L++)I[U+L]=H[z+L]}function a(I,U,H,z){for(var O=0;O<z;O++)I[U+O]=H}function i(I){return new Int32Array(I)}function o(I,U){for(var H=[],z=0;z<I;z++)H.push(new U);return H}function c(I,U){var H=[];return(function z(O,L,E){for(var k=E[L],N=0;N<k&&(O.push(E.length>L+1?[]:new U),!(E.length<L+1));N++)z(O[N],L+1,E)})(H,0,I),H}var u=function(){var I=this;function U(K,Z){for(var ae=1<<Z-1>>>0;K&ae;)ae>>>=1;return ae?(K&ae-1)+ae:K}function H(K,Z,ae,he,ge){r(!(he%ae));do K[Z+(he-=ae)]=ge;while(0<he)}function z(K,Z,ae,he,ge){if(r(2328>=ge),512>=ge)var be=i(512);else if((be=i(ge))==null)return 0;return(function(we,Ne,ke,Se,De,We){var Ae,$e,Ve=Ne,at=1<<ke,Ge=i(16),tt=i(16);for(r(De!=0),r(Se!=null),r(we!=null),r(0<ke),$e=0;$e<De;++$e){if(15<Se[$e])return 0;++Ge[Se[$e]]}if(Ge[0]==De)return 0;for(tt[1]=0,Ae=1;15>Ae;++Ae){if(Ge[Ae]>1<<Ae)return 0;tt[Ae+1]=tt[Ae]+Ge[Ae]}for($e=0;$e<De;++$e)Ae=Se[$e],0<Se[$e]&&(We[tt[Ae]++]=$e);if(tt[15]==1)return(Se=new O).g=0,Se.value=We[0],H(we,Ve,1,at,Se),at;var st,ut=-1,ft=at-1,cr=0,qt=1,Fr=1,Yt=1<<ke;for($e=0,Ae=1,De=2;Ae<=ke;++Ae,De<<=1){if(qt+=Fr<<=1,0>(Fr-=Ge[Ae]))return 0;for(;0<Ge[Ae];--Ge[Ae])(Se=new O).g=Ae,Se.value=We[$e++],H(we,Ve+cr,De,Yt,Se),cr=U(cr,Ae)}for(Ae=ke+1,De=2;15>=Ae;++Ae,De<<=1){if(qt+=Fr<<=1,0>(Fr-=Ge[Ae]))return 0;for(;0<Ge[Ae];--Ge[Ae]){if(Se=new O,(cr&ft)!=ut){for(Ve+=Yt,st=1<<(ut=Ae)-ke;15>ut&&!(0>=(st-=Ge[ut]));)++ut,st<<=1;at+=Yt=1<<(st=ut-ke),we[Ne+(ut=cr&ft)].g=st+ke,we[Ne+ut].value=Ve-Ne-ut}Se.g=Ae-ke,Se.value=We[$e++],H(we,Ve+(cr>>ke),De,Yt,Se),cr=U(cr,Ae)}}return qt!=2*tt[15]-1?0:at})(K,Z,ae,he,ge,be)}function O(){this.value=this.g=0}function L(){this.value=this.g=0}function E(){this.G=o(5,O),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(lo,L)}function k(K,Z,ae,he){r(K!=null),r(Z!=null),r(2147483648>he),K.Ca=254,K.I=0,K.b=-8,K.Ka=0,K.oa=Z,K.pa=ae,K.Jd=Z,K.Yc=ae+he,K.Zc=4<=he?ae+he-4+1:ae,W(K)}function N(K,Z){for(var ae=0;0<Z--;)ae|=Q(K,128)<<Z;return ae}function S(K,Z){var ae=N(K,Z);return F(K)?-ae:ae}function C(K,Z,ae,he){var ge,be=0;for(r(K!=null),r(Z!=null),r(4294967288>he),K.Sb=he,K.Ra=0,K.u=0,K.h=0,4<he&&(he=4),ge=0;ge<he;++ge)be+=Z[ae+ge]<<8*ge;K.Ra=be,K.bb=he,K.oa=Z,K.pa=ae}function D(K){for(;8<=K.u&&K.bb<K.Sb;)K.Ra>>>=8,K.Ra+=K.oa[K.pa+K.bb]<<kc-8>>>0,++K.bb,K.u-=8;re(K)&&(K.h=1,K.u=0)}function q(K,Z){if(r(0<=Z),!K.h&&Z<=Ki){var ae=X(K)&Wi[Z];return K.u+=Z,D(K),ae}return K.h=1,K.u=0}function M(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function G(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function X(K){return K.Ra>>>(K.u&kc-1)>>>0}function re(K){return r(K.bb<=K.Sb),K.h||K.bb==K.Sb&&K.u>kc}function V(K,Z){K.u=Z,K.h=re(K)}function J(K){K.u>=sl&&(r(K.u>=sl),D(K))}function W(K){r(K!=null&&K.oa!=null),K.pa<K.Zc?(K.I=(K.oa[K.pa++]|K.I<<8)>>>0,K.b+=8):(r(K!=null&&K.oa!=null),K.pa<K.Yc?(K.b+=8,K.I=K.oa[K.pa++]|K.I<<8):K.Ka?K.b=0:(K.I<<=8,K.b+=8,K.Ka=1))}function F(K){return N(K,1)}function Q(K,Z){var ae=K.Ca;0>K.b&&W(K);var he=K.b,ge=ae*Z>>>8,be=(K.I>>>he>ge)+0;for(be?(ae-=ge,K.I-=ge+1<<he>>>0):ae=ge+1,he=ae,ge=0;256<=he;)ge+=8,he>>=8;return he=7^ge+Fl[he],K.b-=he,K.Ca=(ae<<he)-1,be}function ne(K,Z,ae){K[Z+0]=ae>>24&255,K[Z+1]=ae>>16&255,K[Z+2]=ae>>8&255,K[Z+3]=255&ae}function ie(K,Z){return K[Z+0]|K[Z+1]<<8}function ce(K,Z){return ie(K,Z)|K[Z+2]<<16}function de(K,Z){return ie(K,Z)|ie(K,Z+2)<<16}function le(K,Z){var ae=1<<Z;return r(K!=null),r(0<Z),K.X=i(ae),K.X==null?0:(K.Mb=32-Z,K.Xa=Z,1)}function _e(K,Z){r(K!=null),r(Z!=null),r(K.Xa==Z.Xa),n(Z.X,0,K.X,0,1<<Z.Xa)}function ue(){this.X=[],this.Xa=this.Mb=0}function pe(K,Z,ae,he){r(ae!=null),r(he!=null);var ge=ae[0],be=he[0];return ge==0&&(ge=(K*be+Z/2)/Z),be==0&&(be=(Z*ge+K/2)/K),0>=ge||0>=be?0:(ae[0]=ge,he[0]=be,1)}function me(K,Z){return K+(1<<Z)-1>>>Z}function Ce(K,Z){return((4278255360&K)+(4278255360&Z)>>>0&4278255360)+((16711935&K)+(16711935&Z)>>>0&16711935)>>>0}function fe(K,Z){I[Z]=function(ae,he,ge,be,we,Ne,ke){var Se;for(Se=0;Se<we;++Se){var De=I[K](Ne[ke+Se-1],ge,be+Se);Ne[ke+Se]=Ce(ae[he+Se],De)}}}function xe(){this.ud=this.hd=this.jd=0}function je(K,Z){return((4278124286&(K^Z))>>>1)+(K&Z)>>>0}function Oe(K){return 0<=K&&256>K?K:0>K?0:255<K?255:void 0}function Ie(K,Z){return Oe(K+(K-Z+.5>>1))}function Le(K,Z,ae){return Math.abs(Z-ae)-Math.abs(K-ae)}function He(K,Z,ae,he,ge,be,we){for(he=be[we-1],ae=0;ae<ge;++ae)be[we+ae]=he=Ce(K[Z+ae],he)}function Qe(K,Z,ae,he,ge){var be;for(be=0;be<ae;++be){var we=K[Z+be],Ne=we>>8&255,ke=16711935&(ke=(ke=16711935&we)+((Ne<<16)+Ne));he[ge+be]=(4278255360&we)+ke>>>0}}function Je(K,Z){Z.jd=255&K,Z.hd=K>>8&255,Z.ud=K>>16&255}function ct(K,Z,ae,he,ge,be){var we;for(we=0;we<he;++we){var Ne=Z[ae+we],ke=Ne>>>8,Se=Ne,De=255&(De=(De=Ne>>>16)+((K.jd<<24>>24)*(ke<<24>>24)>>>5));Se=255&(Se=(Se+=(K.hd<<24>>24)*(ke<<24>>24)>>>5)+((K.ud<<24>>24)*(De<<24>>24)>>>5)),ge[be+we]=(4278255360&Ne)+(De<<16)+Se}}function it(K,Z,ae,he,ge){I[Z]=function(be,we,Ne,ke,Se,De,We,Ae,$e){for(ke=We;ke<Ae;++ke)for(We=0;We<$e;++We)Se[De++]=ge(Ne[he(be[we++])])},I[K]=function(be,we,Ne,ke,Se,De,We){var Ae=8>>be.b,$e=be.Ea,Ve=be.K[0],at=be.w;if(8>Ae)for(be=(1<<be.b)-1,at=(1<<Ae)-1;we<Ne;++we){var Ge,tt=0;for(Ge=0;Ge<$e;++Ge)Ge&be||(tt=he(ke[Se++])),De[We++]=ge(Ve[tt&at]),tt>>=Ae}else I["VP8LMapColor"+ae](ke,Se,Ve,at,De,We,we,Ne,$e)}}function At(K,Z,ae,he,ge){for(ae=Z+ae;Z<ae;){var be=K[Z++];he[ge++]=be>>16&255,he[ge++]=be>>8&255,he[ge++]=255&be}}function pt(K,Z,ae,he,ge){for(ae=Z+ae;Z<ae;){var be=K[Z++];he[ge++]=be>>16&255,he[ge++]=be>>8&255,he[ge++]=255&be,he[ge++]=be>>24&255}}function nt(K,Z,ae,he,ge){for(ae=Z+ae;Z<ae;){var be=(we=K[Z++])>>16&240|we>>12&15,we=240&we|we>>28&15;he[ge++]=be,he[ge++]=we}}function ht(K,Z,ae,he,ge){for(ae=Z+ae;Z<ae;){var be=(we=K[Z++])>>16&248|we>>13&7,we=we>>5&224|we>>3&31;he[ge++]=be,he[ge++]=we}}function St(K,Z,ae,he,ge){for(ae=Z+ae;Z<ae;){var be=K[Z++];he[ge++]=255&be,he[ge++]=be>>8&255,he[ge++]=be>>16&255}}function ot(K,Z,ae,he,ge,be){if(be==0)for(ae=Z+ae;Z<ae;)ne(he,((be=K[Z++])[0]>>24|be[1]>>8&65280|be[2]<<8&16711680|be[3]<<24)>>>0),ge+=32;else n(he,ge,K,Z,ae)}function Bt(K,Z){I[Z][0]=I[K+"0"],I[Z][1]=I[K+"1"],I[Z][2]=I[K+"2"],I[Z][3]=I[K+"3"],I[Z][4]=I[K+"4"],I[Z][5]=I[K+"5"],I[Z][6]=I[K+"6"],I[Z][7]=I[K+"7"],I[Z][8]=I[K+"8"],I[Z][9]=I[K+"9"],I[Z][10]=I[K+"10"],I[Z][11]=I[K+"11"],I[Z][12]=I[K+"12"],I[Z][13]=I[K+"13"],I[Z][14]=I[K+"0"],I[Z][15]=I[K+"0"]}function Tt(K){return K==Ld||K==ju||K==Fh||K==Bh}function xt(){this.eb=[],this.size=this.A=this.fb=0}function Kt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Pt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new xt,this.f.kb=new Kt,this.sd=null}function wt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ar(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function qr(K){return alert("todo:WebPSamplerProcessPlane"),K.T}function Ft(K,Z){var ae=K.T,he=Z.ba.f.RGBA,ge=he.eb,be=he.fb+K.ka*he.A,we=Ai[Z.ba.S],Ne=K.y,ke=K.O,Se=K.f,De=K.N,We=K.ea,Ae=K.W,$e=Z.cc,Ve=Z.dc,at=Z.Mc,Ge=Z.Nc,tt=K.ka,st=K.ka+K.T,ut=K.U,ft=ut+1>>1;for(tt==0?we(Ne,ke,null,null,Se,De,We,Ae,Se,De,We,Ae,ge,be,null,null,ut):(we(Z.ec,Z.fc,Ne,ke,$e,Ve,at,Ge,Se,De,We,Ae,ge,be-he.A,ge,be,ut),++ae);tt+2<st;tt+=2)$e=Se,Ve=De,at=We,Ge=Ae,De+=K.Rc,Ae+=K.Rc,be+=2*he.A,we(Ne,(ke+=2*K.fa)-K.fa,Ne,ke,$e,Ve,at,Ge,Se,De,We,Ae,ge,be-he.A,ge,be,ut);return ke+=K.fa,K.j+st<K.o?(n(Z.ec,Z.fc,Ne,ke,ut),n(Z.cc,Z.dc,Se,De,ft),n(Z.Mc,Z.Nc,We,Ae,ft),ae--):1&st||we(Ne,ke,null,null,Se,De,We,Ae,Se,De,We,Ae,ge,be+he.A,null,null,ut),ae}function Er(K,Z,ae){var he=K.F,ge=[K.J];if(he!=null){var be=K.U,we=Z.ba.S,Ne=we==Dh||we==Fh;Z=Z.ba.f.RGBA;var ke=[0],Se=K.ka;ke[0]=K.T,K.Kb&&(Se==0?--ke[0]:(--Se,ge[0]-=K.width),K.j+K.ka+K.T==K.o&&(ke[0]=K.o-K.j-Se));var De=Z.eb;Se=Z.fb+Se*Z.A,K=Rh(he,ge[0],K.width,be,ke,De,Se+(Ne?0:3),Z.A),r(ae==ke),K&&Tt(we)&&_u(De,Se,Ne,be,ke,Z.A)}return 0}function zr(K){var Z=K.ma,ae=Z.ba.S,he=11>ae,ge=ae==Ec||ae==Lh||ae==Dh||ae==On||ae==12||Tt(ae);if(Z.memory=null,Z.Ib=null,Z.Jb=null,Z.Nd=null,!Ed(Z.Oa,K,ge?11:12))return 0;if(ge&&Tt(ae)&&hu(),K.da)alert("todo:use_scaling");else{if(he){if(Z.Ib=qr,K.Kb){if(ae=K.U+1>>1,Z.memory=i(K.U+2*ae),Z.memory==null)return 0;Z.ec=Z.memory,Z.fc=0,Z.cc=Z.ec,Z.dc=Z.fc+K.U,Z.Mc=Z.cc,Z.Nc=Z.dc+ae,Z.Ib=Ft,hu()}}else alert("todo:EmitYUV");ge&&(Z.Jb=Er,he&&Po())}if(he&&!Oa){for(K=0;256>K;++K)Ei[K]=89858*(K-128)+Ro>>zl,Ti[K]=-22014*(K-128)+Ro,$d[K]=-45773*(K-128),Cu[K]=113618*(K-128)+Ro>>zl;for(K=jn;K<kn;++K)Z=76283*(K-16)+Ro>>zl,fp[K-jn]=br(Z,255),Ny[K-jn]=br(Z+8>>4,15);Oa=1}return 1}function vt(K){var Z=K.ma,ae=K.U,he=K.T;return r(!(1&K.ka)),0>=ae||0>=he?0:(ae=Z.Ib(K,Z),Z.Jb!=null&&Z.Jb(K,Z,ae),Z.Dc+=ae,1)}function Tr(K){K.ma.memory=null}function Wr(K,Z,ae,he){return q(K,8)!=47?0:(Z[0]=q(K,14)+1,ae[0]=q(K,14)+1,he[0]=q(K,1),q(K,3)!=0?0:!K.h)}function Qt(K,Z){if(4>K)return K+1;var ae=K-2>>1;return(2+(1&K)<<ae)+q(Z,ae)+1}function Me(K,Z){return 120<Z?Z-120:1<=(ae=((ae=W1[Z-1])>>4)*K+(8-(15&ae)))?ae:1;var ae}function Be(K,Z,ae){var he=X(ae),ge=K[Z+=255&he].g-8;return 0<ge&&(V(ae,ae.u+8),he=X(ae),Z+=K[Z].value,Z+=he&(1<<ge)-1),V(ae,ae.u+K[Z].g),K[Z].value}function Ze(K,Z,ae){return ae.g+=K.g,ae.value+=K.value<<Z>>>0,r(8>=ae.g),K.g}function yt(K,Z,ae){var he=K.xc;return r((Z=he==0?0:K.vc[K.md*(ae>>he)+(Z>>he)])<K.Wb),K.Ya[Z]}function Gt(K,Z,ae,he){var ge=K.ab,be=K.c*Z,we=K.C;Z=we+Z;var Ne=ae,ke=he;for(he=K.Ta,ae=K.Ua;0<ge--;){var Se=K.gc[ge],De=we,We=Z,Ae=Ne,$e=ke,Ve=(ke=he,Ne=ae,Se.Ea);switch(r(De<We),r(We<=Se.nc),Se.hc){case 2:ks(Ae,$e,(We-De)*Ve,ke,Ne);break;case 0:var at=De,Ge=We,tt=ke,st=Ne,ut=(Yt=Se).Ea;at==0&&(Bl(Ae,$e,null,null,1,tt,st),He(Ae,$e+1,0,0,ut-1,tt,st+1),$e+=ut,st+=ut,++at);for(var ft=1<<Yt.b,cr=ft-1,qt=me(ut,Yt.b),Fr=Yt.K,Yt=Yt.w+(at>>Yt.b)*qt;at<Ge;){var tn=Fr,hs=Yt,Ur=1;for(al(Ae,$e,tt,st-ut,1,tt,st);Ur<ut;){var zt=(Ur&~cr)+ft;zt>ut&&(zt=ut),(0,xu[tn[hs++]>>8&15])(Ae,$e+ +Ur,tt,st+Ur-ut,zt-Ur,tt,st+Ur),Ur=zt}$e+=ut,st+=ut,++at&cr||(Yt+=qt)}We!=Se.nc&&n(ke,Ne-Ve,ke,Ne+(We-De-1)*Ve,Ve);break;case 1:for(Ve=Ae,Ge=$e,ut=(Ae=Se.Ea)-(st=Ae&~(tt=($e=1<<Se.b)-1)),at=me(Ae,Se.b),ft=Se.K,Se=Se.w+(De>>Se.b)*at;De<We;){for(cr=ft,qt=Se,Fr=new xe,Yt=Ge+st,tn=Ge+Ae;Ge<Yt;)Je(cr[qt++],Fr),Pd(Fr,Ve,Ge,$e,ke,Ne),Ge+=$e,Ne+=$e;Ge<tn&&(Je(cr[qt++],Fr),Pd(Fr,Ve,Ge,ut,ke,Ne),Ge+=ut,Ne+=ut),++De&tt||(Se+=at)}break;case 3:if(Ae==ke&&$e==Ne&&0<Se.b){for(Ge=ke,Ae=Ve=Ne+(We-De)*Ve-(st=(We-De)*me(Se.Ea,Se.b)),$e=ke,tt=Ne,at=[],st=(ut=st)-1;0<=st;--st)at[st]=$e[tt+st];for(st=ut-1;0<=st;--st)Ge[Ae+st]=at[st];gu(Se,De,We,ke,Ve,ke,Ne)}else gu(Se,De,We,Ae,$e,ke,Ne)}Ne=he,ke=ae}ke!=ae&&n(he,ae,Ne,ke,be)}function kt(K,Z){var ae=K.V,he=K.Ba+K.c*K.C,ge=Z-K.C;if(r(Z<=K.l.o),r(16>=ge),0<ge){var be=K.l,we=K.Ta,Ne=K.Ua,ke=be.width;if(Gt(K,ge,ae,he),ge=Ne=[Ne],r((ae=K.C)<(he=Z)),r(be.v<be.va),he>be.o&&(he=be.o),ae<be.j){var Se=be.j-ae;ae=be.j,ge[0]+=Se*ke}if(ae>=he?ae=0:(ge[0]+=4*be.v,be.ka=ae-be.j,be.U=be.va-be.v,be.T=he-ae,ae=1),ae){if(Ne=Ne[0],11>(ae=K.ca).S){var De=ae.f.RGBA,We=(he=ae.S,ge=be.U,be=be.T,Se=De.eb,De.A),Ae=be;for(De=De.fb+K.Ma*De.A;0<Ae--;){var $e=we,Ve=Ne,at=ge,Ge=Se,tt=De;switch(he){case cp:Od($e,Ve,at,Ge,tt);break;case Ec:$l($e,Ve,at,Ge,tt);break;case Ld:$l($e,Ve,at,Ge,tt),_u(Ge,tt,0,at,1,0);break;case vy:vu($e,Ve,at,Ge,tt);break;case Lh:ot($e,Ve,at,Ge,tt,1);break;case ju:ot($e,Ve,at,Ge,tt,1),_u(Ge,tt,0,at,1,0);break;case Dh:ot($e,Ve,at,Ge,tt,0);break;case Fh:ot($e,Ve,at,Ge,tt,0),_u(Ge,tt,1,at,1,0);break;case On:Sc($e,Ve,at,Ge,tt);break;case Bh:Sc($e,Ve,at,Ge,tt),Ym(Ge,tt,at,1,0);break;case up:Cc($e,Ve,at,Ge,tt);break;default:r(0)}Ne+=ke,De+=We}K.Ma+=be}else alert("todo:EmitRescaledRowsYUVA");r(K.Ma<=ae.height)}}K.C=Z,r(K.C<=K.i)}function sr(K){var Z;if(0<K.ua)return 0;for(Z=0;Z<K.Wb;++Z){var ae=K.Ya[Z].G,he=K.Ya[Z].H;if(0<ae[1][he[1]+0].g||0<ae[2][he[2]+0].g||0<ae[3][he[3]+0].g)return 0}return 1}function Ut(K,Z,ae,he,ge,be){if(K.Z!=0){var we=K.qd,Ne=K.rd;for(r(Wa[K.Z]!=null);Z<ae;++Z)Wa[K.Z](we,Ne,he,ge,he,ge,be),we=he,Ne=ge,ge+=be;K.qd=we,K.rd=Ne}}function It(K,Z){var ae=K.l.ma,he=ae.Z==0||ae.Z==1?K.l.j:K.C;if(he=K.C<he?he:K.C,r(Z<=K.l.o),Z>he){var ge=K.l.width,be=ae.ca,we=ae.tb+ge*he,Ne=K.V,ke=K.Ba+K.c*he,Se=K.gc;r(K.ab==1),r(Se[0].hc==3),Mo(Se[0],he,Z,Ne,ke,be,we),Ut(ae,he,Z,be,we,ge)}K.C=K.Ma=Z}function or(K,Z,ae,he,ge,be,we){var Ne=K.$/he,ke=K.$%he,Se=K.m,De=K.s,We=ae+K.$,Ae=We;ge=ae+he*ge;var $e=ae+he*be,Ve=280+De.ua,at=K.Pb?Ne:16777216,Ge=0<De.ua?De.Wa:null,tt=De.wc,st=We<$e?yt(De,ke,Ne):null;r(K.C<be),r($e<=ge);var ut=!1;e:for(;;){for(;ut||We<$e;){var ft=0;if(Ne>=at){var cr=We-ae;r((at=K).Pb),at.wd=at.m,at.xd=cr,0<at.s.ua&&_e(at.s.Wa,at.s.vb),at=Ne+hp}if(ke&tt||(st=yt(De,ke,Ne)),r(st!=null),st.Qb&&(Z[We]=st.qb,ut=!0),!ut)if(J(Se),st.jc){ft=Se,cr=Z;var qt=We,Fr=st.pd[X(ft)&lo-1];r(st.jc),256>Fr.g?(V(ft,ft.u+Fr.g),cr[qt]=Fr.value,ft=0):(V(ft,ft.u+Fr.g-256),r(256<=Fr.value),ft=Fr.value),ft==0&&(ut=!0)}else ft=Be(st.G[0],st.H[0],Se);if(Se.h)break;if(ut||256>ft){if(!ut)if(st.nd)Z[We]=(st.qb|ft<<8)>>>0;else{if(J(Se),ut=Be(st.G[1],st.H[1],Se),J(Se),cr=Be(st.G[2],st.H[2],Se),qt=Be(st.G[3],st.H[3],Se),Se.h)break;Z[We]=(qt<<24|ut<<16|ft<<8|cr)>>>0}if(ut=!1,++We,++ke>=he&&(ke=0,++Ne,we!=null&&Ne<=be&&!(Ne%16)&&we(K,Ne),Ge!=null))for(;Ae<We;)ft=Z[Ae++],Ge.X[(506832829*ft&4294967295)>>>Ge.Mb]=ft}else if(280>ft){if(ft=Qt(ft-256,Se),cr=Be(st.G[4],st.H[4],Se),J(Se),cr=Me(he,cr=Qt(cr,Se)),Se.h)break;if(We-ae<cr||ge-We<ft)break e;for(qt=0;qt<ft;++qt)Z[We+qt]=Z[We+qt-cr];for(We+=ft,ke+=ft;ke>=he;)ke-=he,++Ne,we!=null&&Ne<=be&&!(Ne%16)&&we(K,Ne);if(r(We<=ge),ke&tt&&(st=yt(De,ke,Ne)),Ge!=null)for(;Ae<We;)ft=Z[Ae++],Ge.X[(506832829*ft&4294967295)>>>Ge.Mb]=ft}else{if(!(ft<Ve))break e;for(ut=ft-280,r(Ge!=null);Ae<We;)ft=Z[Ae++],Ge.X[(506832829*ft&4294967295)>>>Ge.Mb]=ft;ft=We,r(!(ut>>>(cr=Ge).Xa)),Z[ft]=cr.X[ut],ut=!0}ut||r(Se.h==re(Se))}if(K.Pb&&Se.h&&We<ge)r(K.m.h),K.a=5,K.m=K.wd,K.$=K.xd,0<K.s.ua&&_e(K.s.vb,K.s.Wa);else{if(Se.h)break e;we?.(K,Ne>be?be:Ne),K.a=0,K.$=We-ae}return 1}return K.a=3,0}function Zt(K){r(K!=null),K.vc=null,K.yc=null,K.Ya=null;var Z=K.Wa;Z!=null&&(Z.X=null),K.vb=null,r(K!=null)}function Nr(){var K=new Or;return K==null?null:(K.a=0,K.xb=Fd,Bt("Predictor","VP8LPredictors"),Bt("Predictor","VP8LPredictors_C"),Bt("PredictorAdd","VP8LPredictorsAdd"),Bt("PredictorAdd","VP8LPredictorsAdd_C"),ks=Qe,Pd=ct,Od=At,$l=pt,Sc=nt,Cc=ht,vu=St,I.VP8LMapColor32b=il,I.VP8LMapColor8b=yu,K)}function an(K,Z,ae,he,ge){var be=1,we=[K],Ne=[Z],ke=he.m,Se=he.s,De=null,We=0;e:for(;;){if(ae)for(;be&&q(ke,1);){var Ae=we,$e=Ne,Ve=he,at=1,Ge=Ve.m,tt=Ve.gc[Ve.ab],st=q(Ge,2);if(Ve.Oc&1<<st)be=0;else{switch(Ve.Oc|=1<<st,tt.hc=st,tt.Ea=Ae[0],tt.nc=$e[0],tt.K=[null],++Ve.ab,r(4>=Ve.ab),st){case 0:case 1:tt.b=q(Ge,3)+2,at=an(me(tt.Ea,tt.b),me(tt.nc,tt.b),0,Ve,tt.K),tt.K=tt.K[0];break;case 3:var ut,ft=q(Ge,8)+1,cr=16<ft?0:4<ft?1:2<ft?2:3;if(Ae[0]=me(tt.Ea,cr),tt.b=cr,ut=at=an(ft,1,0,Ve,tt.K)){var qt,Fr=ft,Yt=tt,tn=1<<(8>>Yt.b),hs=i(tn);if(hs==null)ut=0;else{var Ur=Yt.K[0],zt=Yt.w;for(hs[0]=Yt.K[0][0],qt=1;qt<1*Fr;++qt)hs[qt]=Ce(Ur[zt+qt],hs[qt-1]);for(;qt<4*tn;++qt)hs[qt]=0;Yt.K[0]=null,Yt.K[0]=hs,ut=1}}at=ut;break;case 2:break;default:r(0)}be=at}}if(we=we[0],Ne=Ne[0],be&&q(ke,1)&&!(be=1<=(We=q(ke,4))&&11>=We)){he.a=3;break e}var Ot;if(Ot=be)t:{var Ss,Ar,Qr,qn=he,pa=we,Fs=Ne,ss=We,ea=ae,ma=qn.m,Xn=qn.s,sn=[null],pn=1,Yn=0,mn=wy[ss];r:for(;;){if(ea&&q(ma,1)){var fs=q(ma,3)+2,ps=me(pa,fs),Mn=me(Fs,fs),Ka=ps*Mn;if(!an(ps,Mn,0,qn,sn))break r;for(sn=sn[0],Xn.xc=fs,Ss=0;Ss<Ka;++Ss){var Sn=sn[Ss]>>8&65535;sn[Ss]=Sn,Sn>=pn&&(pn=Sn+1)}}if(ma.h)break r;for(Ar=0;5>Ar;++Ar){var In=Nu[Ar];!Ar&&0<ss&&(In+=1<<ss),Yn<In&&(Yn=In)}var Bs=o(pn*mn,O),Ma=pn,Pi=o(Ma,E);if(Pi==null)var Cs=null;else r(65536>=Ma),Cs=Pi;var As=i(Yn);if(Cs==null||As==null||Bs==null){qn.a=1;break r}var Ga=Bs;for(Ss=Qr=0;Ss<pn;++Ss){var Rn=Cs[Ss],Xa=Rn.G,ho=Rn.H,Lo=0,ga=1,Es=0;for(Ar=0;5>Ar;++Ar){In=Nu[Ar],Xa[Ar]=Ga,ho[Ar]=Qr,!Ar&&0<ss&&(In+=1<<ss);s:{var Oc,Hl=In,qd=qn,cl=As,Sy=Ga,l0=Qr,Vn=0,Do=qd.m,c0=q(Do,1);if(a(cl,0,0,Hl),c0){var u0=q(Do,1)+1,pp=q(Do,1),mp=q(Do,pp==0?1:8);cl[mp]=1,u0==2&&(cl[mp=q(Do,8)]=1);var ul=1}else{var Qn=i(19),$s=q(Do,4)+4;if(19<$s){qd.a=3;var Ts=0;break s}for(Oc=0;Oc<$s;++Oc)Qn[V1[Oc]]=q(Do,3);var zd=void 0,Vl=void 0,Ud=qd,Q1=Qn,ta=Hl,gp=cl,Hh=0,dl=Ud.m,Fo=8,Gi=o(128,O);n:for(;z(Gi,0,7,Q1,19);){if(q(dl,1)){var Vh=2+2*q(dl,3);if((zd=2+q(dl,Vh))>ta)break n}else zd=ta;for(Vl=0;Vl<ta&&zd--;){J(dl);var yp=Gi[0+(127&X(dl))];V(dl,dl.u+yp.g);var Mc=yp.value;if(16>Mc)gp[Vl++]=Mc,Mc!=0&&(Fo=Mc);else{var Cy=Mc==16,d0=Mc-16,Ay=dp[d0],h0=q(dl,$h[d0])+Ay;if(Vl+h0>ta)break n;for(var Ey=Cy?Fo:0;0<h0--;)gp[Vl++]=Ey}}Hh=1;break n}Hh||(Ud.a=3),ul=Hh}(ul=ul&&!Do.h)&&(Vn=z(Sy,l0,8,cl,Hl)),ul&&Vn!=0?Ts=Vn:(qd.a=3,Ts=0)}if(Ts==0)break r;if(ga&&by[Ar]==1&&(ga=Ga[Qr].g==0),Lo+=Ga[Qr].g,Qr+=Ts,3>=Ar){var Hd,xp=As[0];for(Hd=1;Hd<In;++Hd)As[Hd]>xp&&(xp=As[Hd]);Es+=xp}}if(Rn.nd=ga,Rn.Qb=0,ga&&(Rn.qb=(Xa[3][ho[3]+0].value<<24|Xa[1][ho[1]+0].value<<16|Xa[2][ho[2]+0].value)>>>0,Lo==0&&256>Xa[0][ho[0]+0].value&&(Rn.Qb=1,Rn.qb+=Xa[0][ho[0]+0].value<<8)),Rn.jc=!Rn.Qb&&6>Es,Rn.jc){var Wh,Xi=Rn;for(Wh=0;Wh<lo;++Wh){var Wl=Wh,Bo=Xi.pd[Wl],Eu=Xi.G[0][Xi.H[0]+Wl];256<=Eu.value?(Bo.g=Eu.g+256,Bo.value=Eu.value):(Bo.g=0,Bo.value=0,Wl>>=Ze(Eu,8,Bo),Wl>>=Ze(Xi.G[1][Xi.H[1]+Wl],16,Bo),Wl>>=Ze(Xi.G[2][Xi.H[2]+Wl],0,Bo),Ze(Xi.G[3][Xi.H[3]+Wl],24,Bo))}}}Xn.vc=sn,Xn.Wb=pn,Xn.Ya=Cs,Xn.yc=Bs,Ot=1;break t}Ot=0}if(!(be=Ot)){he.a=3;break e}if(0<We){if(Se.ua=1<<We,!le(Se.Wa,We)){he.a=1,be=0;break e}}else Se.ua=0;var vp=he,bp=we,Ty=Ne,wp=vp.s,_p=wp.xc;if(vp.c=bp,vp.i=Ty,wp.md=me(bp,_p),wp.wc=_p==0?-1:(1<<_p)-1,ae){he.xb=ll;break e}if((De=i(we*Ne))==null){he.a=1,be=0;break e}be=(be=or(he,De,0,we,Ne,Ne,null))&&!ke.h;break e}return be?(ge!=null?ge[0]=De:(r(De==null),r(ae)),he.$=0,ae||Zt(Se)):Zt(Se),be}function Jr(K,Z){var ae=K.c*K.i,he=ae+Z+16*Z;return r(K.c<=Z),K.V=i(he),K.V==null?(K.Ta=null,K.Ua=0,K.a=1,0):(K.Ta=K.V,K.Ua=K.Ba+ae+Z,1)}function Tn(K,Z){var ae=K.C,he=Z-ae,ge=K.V,be=K.Ba+K.c*ae;for(r(Z<=K.l.o);0<he;){var we=16<he?16:he,Ne=K.l.ma,ke=K.l.width,Se=ke*we,De=Ne.ca,We=Ne.tb+ke*ae,Ae=K.Ta,$e=K.Ua;Gt(K,we,ge,be),Qm(Ae,$e,De,We,Se),Ut(Ne,ae,ae+we,De,We,ke),he-=we,ge+=we*K.c,ae+=we}r(ae==Z),K.C=K.Ma=Z}function Pn(){this.ub=this.yd=this.td=this.Rb=0}function js(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ee(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ze(){this.Yb=(function(){var K=[];return(function Z(ae,he,ge){for(var be=ge[he],we=0;we<be&&(ae.push(ge.length>he+1?[]:0),!(ge.length<he+1));we++)Z(ae[we],he+1,ge)})(K,0,[3,11]),K})()}function dt(){this.jb=i(3),this.Wc=c([4,8],ze),this.Xc=c([4,17],ze)}function mt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Rt(){this.ld=this.La=this.dd=this.tc=0}function jt(){this.Na=this.la=0}function Ct(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Dr(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function wr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Rt),this.Y=0,this.ya=Array(new Dr),this.aa=0,this.l=new Yr}function yr(){this.y=i(16),this.f=i(8),this.ea=i(8)}function dr(){this.cb=this.a=0,this.sc="",this.m=new M,this.Od=new Pn,this.Kc=new js,this.ed=new mt,this.Qa=new Ee,this.Ic=this.$c=this.Aa=0,this.D=new wr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,M),this.ia=0,this.pb=o(4,Ct),this.Pa=new dt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new yr),this.Hd=0,this.rb=Array(new jt),this.sb=0,this.wa=Array(new Rt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Dr),this.L=this.aa=0,this.gd=c([4,2],Rt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function br(K,Z){return 0>K?0:K>Z?Z:K}function Yr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ln(){var K=new dr;return K!=null&&(K.a=0,K.sc="OK",K.cb=0,K.Xb=0,ku||(ku=cs)),K}function Rr(K,Z,ae){return K.a==0&&(K.a=Z,K.sc=ae,K.cb=0),0}function Fn(K,Z,ae){return 3<=ae&&K[Z+0]==157&&K[Z+1]==1&&K[Z+2]==42}function _n(K,Z){if(K==null)return 0;if(K.a=0,K.sc="OK",Z==null)return Rr(K,2,"null VP8Io passed to VP8GetHeaders()");var ae=Z.data,he=Z.w,ge=Z.ha;if(4>ge)return Rr(K,7,"Truncated header.");var be=ae[he+0]|ae[he+1]<<8|ae[he+2]<<16,we=K.Od;if(we.Rb=!(1&be),we.td=be>>1&7,we.yd=be>>4&1,we.ub=be>>5,3<we.td)return Rr(K,3,"Incorrect keyframe parameters.");if(!we.yd)return Rr(K,4,"Frame not displayable.");he+=3,ge-=3;var Ne=K.Kc;if(we.Rb){if(7>ge)return Rr(K,7,"cannot parse picture header");if(!Fn(ae,he,ge))return Rr(K,3,"Bad code word");Ne.c=16383&(ae[he+4]<<8|ae[he+3]),Ne.Td=ae[he+4]>>6,Ne.i=16383&(ae[he+6]<<8|ae[he+5]),Ne.Ud=ae[he+6]>>6,he+=7,ge-=7,K.za=Ne.c+15>>4,K.Ub=Ne.i+15>>4,Z.width=Ne.c,Z.height=Ne.i,Z.Da=0,Z.j=0,Z.v=0,Z.va=Z.width,Z.o=Z.height,Z.da=0,Z.ib=Z.width,Z.hb=Z.height,Z.U=Z.width,Z.T=Z.height,a((be=K.Pa).jb,0,255,be.jb.length),r((be=K.Qa)!=null),be.Cb=0,be.Bb=0,be.Fb=1,a(be.Zb,0,0,be.Zb.length),a(be.Lb,0,0,be.Lb)}if(we.ub>ge)return Rr(K,7,"bad partition length");k(be=K.m,ae,he,we.ub),he+=we.ub,ge-=we.ub,we.Rb&&(Ne.Ld=F(be),Ne.Kd=F(be)),Ne=K.Qa;var ke,Se=K.Pa;if(r(be!=null),r(Ne!=null),Ne.Cb=F(be),Ne.Cb){if(Ne.Bb=F(be),F(be)){for(Ne.Fb=F(be),ke=0;4>ke;++ke)Ne.Zb[ke]=F(be)?S(be,7):0;for(ke=0;4>ke;++ke)Ne.Lb[ke]=F(be)?S(be,6):0}if(Ne.Bb)for(ke=0;3>ke;++ke)Se.jb[ke]=F(be)?N(be,8):255}else Ne.Bb=0;if(be.Ka)return Rr(K,3,"cannot parse segment header");if((Ne=K.ed).zd=F(be),Ne.Tb=N(be,6),Ne.wb=N(be,3),Ne.Pc=F(be),Ne.Pc&&F(be)){for(Se=0;4>Se;++Se)F(be)&&(Ne.vd[Se]=S(be,6));for(Se=0;4>Se;++Se)F(be)&&(Ne.od[Se]=S(be,6))}if(K.L=Ne.Tb==0?0:Ne.zd?1:2,be.Ka)return Rr(K,3,"cannot parse filter header");var De=ge;if(ge=ke=he,he=ke+De,Ne=De,K.Xb=(1<<N(K.m,2))-1,De<3*(Se=K.Xb))ae=7;else{for(ke+=3*Se,Ne-=3*Se,De=0;De<Se;++De){var We=ae[ge+0]|ae[ge+1]<<8|ae[ge+2]<<16;We>Ne&&(We=Ne),k(K.Jc[+De],ae,ke,We),ke+=We,Ne-=We,ge+=3}k(K.Jc[+Se],ae,ke,Ne),ae=ke<he?0:5}if(ae!=0)return Rr(K,ae,"cannot parse partitions");for(ae=N(ke=K.m,7),ge=F(ke)?S(ke,4):0,he=F(ke)?S(ke,4):0,Ne=F(ke)?S(ke,4):0,Se=F(ke)?S(ke,4):0,ke=F(ke)?S(ke,4):0,De=K.Qa,We=0;4>We;++We){if(De.Cb){var Ae=De.Zb[We];De.Fb||(Ae+=ae)}else{if(0<We){K.pb[We]=K.pb[0];continue}Ae=ae}var $e=K.pb[We];$e.Sc[0]=Dd[br(Ae+ge,127)],$e.Sc[1]=qh[br(Ae+0,127)],$e.Eb[0]=2*Dd[br(Ae+he,127)],$e.Eb[1]=101581*qh[br(Ae+Ne,127)]>>16,8>$e.Eb[1]&&($e.Eb[1]=8),$e.Qc[0]=Dd[br(Ae+Se,117)],$e.Qc[1]=qh[br(Ae+ke,127)],$e.lc=Ae+ke}if(!we.Rb)return Rr(K,4,"Not a key frame.");for(F(be),we=K.Pa,ae=0;4>ae;++ae){for(ge=0;8>ge;++ge)for(he=0;3>he;++he)for(Ne=0;11>Ne;++Ne)Se=Q(be,G1[ae][ge][he][Ne])?N(be,8):jy[ae][ge][he][Ne],we.Wc[ae][ge].Yb[he][Ne]=Se;for(ge=0;17>ge;++ge)we.Xc[ae][ge]=we.Wc[ae][a0[ge]]}return K.kc=F(be),K.kc&&(K.Bd=N(be,8)),K.cb=1}function cs(K,Z,ae,he,ge,be,we){var Ne=Z[ge].Yb[ae];for(ae=0;16>ge;++ge){if(!Q(K,Ne[ae+0]))return ge;for(;!Q(K,Ne[ae+1]);)if(Ne=Z[++ge].Yb[0],ae=0,ge==16)return 16;var ke=Z[ge+1].Yb;if(Q(K,Ne[ae+2])){var Se=K,De=0;if(Q(Se,(Ae=Ne)[(We=ae)+3]))if(Q(Se,Ae[We+6])){for(Ne=0,We=2*(De=Q(Se,Ae[We+8]))+(Ae=Q(Se,Ae[We+9+De])),De=0,Ae=n0[We];Ae[Ne];++Ne)De+=De+Q(Se,Ae[Ne]);De+=3+(8<<We)}else Q(Se,Ae[We+7])?(De=7+2*Q(Se,165),De+=Q(Se,145)):De=5+Q(Se,159);else De=Q(Se,Ae[We+4])?3+Q(Se,Ae[We+5]):2;Ne=ke[2]}else De=1,Ne=ke[1];ke=we+s0[ge],0>(Se=K).b&&W(Se);var We,Ae=Se.b,$e=(We=Se.Ca>>1)-(Se.I>>Ae)>>31;--Se.b,Se.Ca+=$e,Se.Ca|=1,Se.I-=(We+1&$e)<<Ae,be[ke]=((De^$e)-$e)*he[(0<ge)+0]}return 16}function ui(K){var Z=K.rb[K.sb-1];Z.la=0,Z.Na=0,a(K.zc,0,0,K.zc.length),K.ja=0}function Ys(K,Z,ae,he,ge){ge=K[Z+ae+32*he]+(ge>>3),K[Z+ae+32*he]=-256&ge?0>ge?0:255:ge}function Bn(K,Z,ae,he,ge,be){Ys(K,Z,0,ae,he+ge),Ys(K,Z,1,ae,he+be),Ys(K,Z,2,ae,he-be),Ys(K,Z,3,ae,he-ge)}function ha(K){return(20091*K>>16)+K}function en(K,Z,ae,he){var ge,be=0,we=i(16);for(ge=0;4>ge;++ge){var Ne=K[Z+0]+K[Z+8],ke=K[Z+0]-K[Z+8],Se=(35468*K[Z+4]>>16)-ha(K[Z+12]),De=ha(K[Z+4])+(35468*K[Z+12]>>16);we[be+0]=Ne+De,we[be+1]=ke+Se,we[be+2]=ke-Se,we[be+3]=Ne-De,be+=4,Z++}for(ge=be=0;4>ge;++ge)Ne=(K=we[be+0]+4)+we[be+8],ke=K-we[be+8],Se=(35468*we[be+4]>>16)-ha(we[be+12]),Ys(ae,he,0,0,Ne+(De=ha(we[be+4])+(35468*we[be+12]>>16))),Ys(ae,he,1,0,ke+Se),Ys(ae,he,2,0,ke-Se),Ys(ae,he,3,0,Ne-De),be++,he+=32}function Gr(K,Z,ae,he){var ge=K[Z+0]+4,be=35468*K[Z+4]>>16,we=ha(K[Z+4]),Ne=35468*K[Z+1]>>16;Bn(ae,he,0,ge+we,K=ha(K[Z+1]),Ne),Bn(ae,he,1,ge+be,K,Ne),Bn(ae,he,2,ge-be,K,Ne),Bn(ae,he,3,ge-we,K,Ne)}function Ha(K,Z,ae,he,ge){en(K,Z,ae,he),ge&&en(K,Z+16,ae,he+4)}function fa(K,Z,ae,he){bu(K,Z+0,ae,he,1),bu(K,Z+32,ae,he+128,1)}function Co(K,Z,ae,he){var ge;for(K=K[Z+0]+4,ge=0;4>ge;++ge)for(Z=0;4>Z;++Z)Ys(ae,he,Z,ge,K)}function Pr(K,Z,ae,he){K[Z+0]&&fn(K,Z+0,ae,he),K[Z+16]&&fn(K,Z+16,ae,he+4),K[Z+32]&&fn(K,Z+32,ae,he+128),K[Z+48]&&fn(K,Z+48,ae,he+128+4)}function Ca(K,Z,ae,he){var ge,be=i(16);for(ge=0;4>ge;++ge){var we=K[Z+0+ge]+K[Z+12+ge],Ne=K[Z+4+ge]+K[Z+8+ge],ke=K[Z+4+ge]-K[Z+8+ge],Se=K[Z+0+ge]-K[Z+12+ge];be[0+ge]=we+Ne,be[8+ge]=we-Ne,be[4+ge]=Se+ke,be[12+ge]=Se-ke}for(ge=0;4>ge;++ge)we=(K=be[0+4*ge]+3)+be[3+4*ge],Ne=be[1+4*ge]+be[2+4*ge],ke=be[1+4*ge]-be[2+4*ge],Se=K-be[3+4*ge],ae[he+0]=we+Ne>>3,ae[he+16]=Se+ke>>3,ae[he+32]=we-Ne>>3,ae[he+48]=Se-ke>>3,he+=64}function Aa(K,Z,ae){var he,ge=Z-32,be=pi,we=255-K[ge-1];for(he=0;he<ae;++he){var Ne,ke=be,Se=we+K[Z-1];for(Ne=0;Ne<ae;++Ne)K[Z+Ne]=ke[Se+K[ge+Ne]];Z+=32}}function Ao(K,Z){Aa(K,Z,4)}function Pl(K,Z){Aa(K,Z,8)}function Eo(K,Z){Aa(K,Z,16)}function di(K,Z){var ae;for(ae=0;16>ae;++ae)n(K,Z+32*ae,K,Z-32,16)}function Ol(K,Z){var ae;for(ae=16;0<ae;--ae)a(K,Z,K[Z-1],16),Z+=32}function Qs(K,Z,ae){var he;for(he=0;16>he;++he)a(Z,ae+32*he,K,16)}function Ni(K,Z){var ae,he=16;for(ae=0;16>ae;++ae)he+=K[Z-1+32*ae]+K[Z+ae-32];Qs(he>>5,K,Z)}function Zs(K,Z){var ae,he=8;for(ae=0;16>ae;++ae)he+=K[Z-1+32*ae];Qs(he>>4,K,Z)}function Ea(K,Z){var ae,he=8;for(ae=0;16>ae;++ae)he+=K[Z+ae-32];Qs(he>>4,K,Z)}function tl(K,Z){Qs(128,K,Z)}function xr(K,Z,ae){return K+2*Z+ae+2>>2}function hi(K,Z){var ae,he=Z-32;for(he=new Uint8Array([xr(K[he-1],K[he+0],K[he+1]),xr(K[he+0],K[he+1],K[he+2]),xr(K[he+1],K[he+2],K[he+3]),xr(K[he+2],K[he+3],K[he+4])]),ae=0;4>ae;++ae)n(K,Z+32*ae,he,0,he.length)}function Gm(K,Z){var ae=K[Z-1],he=K[Z-1+32],ge=K[Z-1+64],be=K[Z-1+96];ne(K,Z+0,16843009*xr(K[Z-1-32],ae,he)),ne(K,Z+32,16843009*xr(ae,he,ge)),ne(K,Z+64,16843009*xr(he,ge,be)),ne(K,Z+96,16843009*xr(ge,be,be))}function sp(K,Z){var ae,he=4;for(ae=0;4>ae;++ae)he+=K[Z+ae-32]+K[Z-1+32*ae];for(he>>=3,ae=0;4>ae;++ae)a(K,Z+32*ae,he,4)}function Hi(K,Z){var ae=K[Z-1+0],he=K[Z-1+32],ge=K[Z-1+64],be=K[Z-1-32],we=K[Z+0-32],Ne=K[Z+1-32],ke=K[Z+2-32],Se=K[Z+3-32];K[Z+0+96]=xr(he,ge,K[Z-1+96]),K[Z+1+96]=K[Z+0+64]=xr(ae,he,ge),K[Z+2+96]=K[Z+1+64]=K[Z+0+32]=xr(be,ae,he),K[Z+3+96]=K[Z+2+64]=K[Z+1+32]=K[Z+0+0]=xr(we,be,ae),K[Z+3+64]=K[Z+2+32]=K[Z+1+0]=xr(Ne,we,be),K[Z+3+32]=K[Z+2+0]=xr(ke,Ne,we),K[Z+3+0]=xr(Se,ke,Ne)}function Ml(K,Z){var ae=K[Z+1-32],he=K[Z+2-32],ge=K[Z+3-32],be=K[Z+4-32],we=K[Z+5-32],Ne=K[Z+6-32],ke=K[Z+7-32];K[Z+0+0]=xr(K[Z+0-32],ae,he),K[Z+1+0]=K[Z+0+32]=xr(ae,he,ge),K[Z+2+0]=K[Z+1+32]=K[Z+0+64]=xr(he,ge,be),K[Z+3+0]=K[Z+2+32]=K[Z+1+64]=K[Z+0+96]=xr(ge,be,we),K[Z+3+32]=K[Z+2+64]=K[Z+1+96]=xr(be,we,Ne),K[Z+3+64]=K[Z+2+96]=xr(we,Ne,ke),K[Z+3+96]=xr(Ne,ke,ke)}function ap(K,Z){var ae=K[Z-1+0],he=K[Z-1+32],ge=K[Z-1+64],be=K[Z-1-32],we=K[Z+0-32],Ne=K[Z+1-32],ke=K[Z+2-32],Se=K[Z+3-32];K[Z+0+0]=K[Z+1+64]=be+we+1>>1,K[Z+1+0]=K[Z+2+64]=we+Ne+1>>1,K[Z+2+0]=K[Z+3+64]=Ne+ke+1>>1,K[Z+3+0]=ke+Se+1>>1,K[Z+0+96]=xr(ge,he,ae),K[Z+0+64]=xr(he,ae,be),K[Z+0+32]=K[Z+1+96]=xr(ae,be,we),K[Z+1+32]=K[Z+2+96]=xr(be,we,Ne),K[Z+2+32]=K[Z+3+96]=xr(we,Ne,ke),K[Z+3+32]=xr(Ne,ke,Se)}function Nd(K,Z){var ae=K[Z+0-32],he=K[Z+1-32],ge=K[Z+2-32],be=K[Z+3-32],we=K[Z+4-32],Ne=K[Z+5-32],ke=K[Z+6-32],Se=K[Z+7-32];K[Z+0+0]=ae+he+1>>1,K[Z+1+0]=K[Z+0+64]=he+ge+1>>1,K[Z+2+0]=K[Z+1+64]=ge+be+1>>1,K[Z+3+0]=K[Z+2+64]=be+we+1>>1,K[Z+0+32]=xr(ae,he,ge),K[Z+1+32]=K[Z+0+96]=xr(he,ge,be),K[Z+2+32]=K[Z+1+96]=xr(ge,be,we),K[Z+3+32]=K[Z+2+96]=xr(be,we,Ne),K[Z+3+64]=xr(we,Ne,ke),K[Z+3+96]=xr(Ne,ke,Se)}function ou(K,Z){var ae=K[Z-1+0],he=K[Z-1+32],ge=K[Z-1+64],be=K[Z-1+96];K[Z+0+0]=ae+he+1>>1,K[Z+2+0]=K[Z+0+32]=he+ge+1>>1,K[Z+2+32]=K[Z+0+64]=ge+be+1>>1,K[Z+1+0]=xr(ae,he,ge),K[Z+3+0]=K[Z+1+32]=xr(he,ge,be),K[Z+3+32]=K[Z+1+64]=xr(ge,be,be),K[Z+3+64]=K[Z+2+64]=K[Z+0+96]=K[Z+1+96]=K[Z+2+96]=K[Z+3+96]=be}function Ch(K,Z){var ae=K[Z-1+0],he=K[Z-1+32],ge=K[Z-1+64],be=K[Z-1+96],we=K[Z-1-32],Ne=K[Z+0-32],ke=K[Z+1-32],Se=K[Z+2-32];K[Z+0+0]=K[Z+2+32]=ae+we+1>>1,K[Z+0+32]=K[Z+2+64]=he+ae+1>>1,K[Z+0+64]=K[Z+2+96]=ge+he+1>>1,K[Z+0+96]=be+ge+1>>1,K[Z+3+0]=xr(Ne,ke,Se),K[Z+2+0]=xr(we,Ne,ke),K[Z+1+0]=K[Z+3+32]=xr(ae,we,Ne),K[Z+1+32]=K[Z+3+64]=xr(he,ae,we),K[Z+1+64]=K[Z+3+96]=xr(ge,he,ae),K[Z+1+96]=xr(be,ge,he)}function To(K,Z){var ae;for(ae=0;8>ae;++ae)n(K,Z+32*ae,K,Z-32,8)}function lu(K,Z){var ae;for(ae=0;8>ae;++ae)a(K,Z,K[Z-1],8),Z+=32}function ki(K,Z,ae){var he;for(he=0;8>he;++he)a(Z,ae+32*he,K,8)}function kd(K,Z){var ae,he=8;for(ae=0;8>ae;++ae)he+=K[Z+ae-32]+K[Z-1+32*ae];ki(he>>4,K,Z)}function Ah(K,Z){var ae,he=4;for(ae=0;8>ae;++ae)he+=K[Z+ae-32];ki(he>>3,K,Z)}function Eh(K,Z){var ae,he=4;for(ae=0;8>ae;++ae)he+=K[Z-1+32*ae];ki(he>>3,K,Z)}function Sd(K,Z){ki(128,K,Z)}function so(K,Z,ae){var he=K[Z-ae],ge=K[Z+0],be=3*(ge-he)+ol[1020+K[Z-2*ae]-K[Z+ae]],we=Rd[112+(be+4>>3)];K[Z-ae]=pi[255+he+Rd[112+(be+3>>3)]],K[Z+0]=pi[255+ge-we]}function cu(K,Z,ae,he){var ge=K[Z+0],be=K[Z+ae];return co[255+K[Z-2*ae]-K[Z-ae]]>he||co[255+be-ge]>he}function uu(K,Z,ae,he){return 4*co[255+K[Z-ae]-K[Z+0]]+co[255+K[Z-2*ae]-K[Z+ae]]<=he}function ao(K,Z,ae,he,ge){var be=K[Z-3*ae],we=K[Z-2*ae],Ne=K[Z-ae],ke=K[Z+0],Se=K[Z+ae],De=K[Z+2*ae],We=K[Z+3*ae];return 4*co[255+Ne-ke]+co[255+we-Se]>he?0:co[255+K[Z-4*ae]-be]<=ge&&co[255+be-we]<=ge&&co[255+we-Ne]<=ge&&co[255+We-De]<=ge&&co[255+De-Se]<=ge&&co[255+Se-ke]<=ge}function Il(K,Z,ae,he){var ge=2*he+1;for(he=0;16>he;++he)uu(K,Z+he,ae,ge)&&so(K,Z+he,ae)}function bc(K,Z,ae,he){var ge=2*he+1;for(he=0;16>he;++he)uu(K,Z+he*ae,1,ge)&&so(K,Z+he*ae,1)}function Th(K,Z,ae,he){var ge;for(ge=3;0<ge;--ge)Il(K,Z+=4*ae,ae,he)}function du(K,Z,ae,he){var ge;for(ge=3;0<ge;--ge)bc(K,Z+=4,ae,he)}function io(K,Z,ae,he,ge,be,we,Ne){for(be=2*be+1;0<ge--;){if(ao(K,Z,ae,be,we))if(cu(K,Z,ae,Ne))so(K,Z,ae);else{var ke=K,Se=Z,De=ae,We=ke[Se-2*De],Ae=ke[Se-De],$e=ke[Se+0],Ve=ke[Se+De],at=ke[Se+2*De],Ge=27*(st=ol[1020+3*($e-Ae)+ol[1020+We-Ve]])+63>>7,tt=18*st+63>>7,st=9*st+63>>7;ke[Se-3*De]=pi[255+ke[Se-3*De]+st],ke[Se-2*De]=pi[255+We+tt],ke[Se-De]=pi[255+Ae+Ge],ke[Se+0]=pi[255+$e-Ge],ke[Se+De]=pi[255+Ve-tt],ke[Se+2*De]=pi[255+at-st]}Z+=he}}function rl(K,Z,ae,he,ge,be,we,Ne){for(be=2*be+1;0<ge--;){if(ao(K,Z,ae,be,we))if(cu(K,Z,ae,Ne))so(K,Z,ae);else{var ke=K,Se=Z,De=ae,We=ke[Se-De],Ae=ke[Se+0],$e=ke[Se+De],Ve=Rd[112+(4+(at=3*(Ae-We))>>3)],at=Rd[112+(at+3>>3)],Ge=Ve+1>>1;ke[Se-2*De]=pi[255+ke[Se-2*De]+Ge],ke[Se-De]=pi[255+We+at],ke[Se+0]=pi[255+Ae-Ve],ke[Se+De]=pi[255+$e-Ge]}Z+=he}}function Va(K,Z,ae,he,ge,be){io(K,Z,ae,1,16,he,ge,be)}function oo(K,Z,ae,he,ge,be){io(K,Z,1,ae,16,he,ge,be)}function Cd(K,Z,ae,he,ge,be){var we;for(we=3;0<we;--we)rl(K,Z+=4*ae,ae,1,16,he,ge,be)}function ee(K,Z,ae,he,ge,be){var we;for(we=3;0<we;--we)rl(K,Z+=4,1,ae,16,he,ge,be)}function ye(K,Z,ae,he,ge,be,we,Ne){io(K,Z,ge,1,8,be,we,Ne),io(ae,he,ge,1,8,be,we,Ne)}function Te(K,Z,ae,he,ge,be,we,Ne){io(K,Z,1,ge,8,be,we,Ne),io(ae,he,1,ge,8,be,we,Ne)}function Re(K,Z,ae,he,ge,be,we,Ne){rl(K,Z+4*ge,ge,1,8,be,we,Ne),rl(ae,he+4*ge,ge,1,8,be,we,Ne)}function Ue(K,Z,ae,he,ge,be,we,Ne){rl(K,Z+4,1,ge,8,be,we,Ne),rl(ae,he+4,1,ge,8,be,we,Ne)}function lt(){this.ba=new Pt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ar,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function gt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Xt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function lr(){this.ua=0,this.Wa=new ue,this.vb=new ue,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new E,this.yc=new O}function Or(){this.xb=this.a=0,this.l=new Yr,this.ca=new Pt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new G,this.Pb=0,this.wd=new G,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new lr,this.ab=0,this.gc=o(4,Xt),this.Oc=0}function Lr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Yr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function cn(K,Z,ae,he,ge,be,we){for(K=K==null?0:K[Z+0],Z=0;Z<we;++Z)ge[be+Z]=K+ae[he+Z]&255,K=ge[be+Z]}function ns(K,Z,ae,he,ge,be,we){var Ne;if(K==null)cn(null,null,ae,he,ge,be,we);else for(Ne=0;Ne<we;++Ne)ge[be+Ne]=K[Z+Ne]+ae[he+Ne]&255}function Ls(K,Z,ae,he,ge,be,we){if(K==null)cn(null,null,ae,he,ge,be,we);else{var Ne,ke=K[Z+0],Se=ke,De=ke;for(Ne=0;Ne<we;++Ne)Se=De+(ke=K[Z+Ne])-Se,De=ae[he+Ne]+(-256&Se?0>Se?0:255:Se)&255,Se=ke,ge[be+Ne]=De}}function $n(K,Z,ae,he){var ge=Z.width,be=Z.o;if(r(K!=null&&Z!=null),0>ae||0>=he||ae+he>be)return null;if(!K.Cc){if(K.ga==null){var we;if(K.ga=new Lr,(we=K.ga==null)||(we=Z.width*Z.o,r(K.Gb.length==0),K.Gb=i(we),K.Uc=0,K.Gb==null?we=0:(K.mb=K.Gb,K.nb=K.Uc,K.rc=null,we=1),we=!we),!we){we=K.ga;var Ne=K.Fa,ke=K.P,Se=K.qc,De=K.mb,We=K.nb,Ae=ke+1,$e=Se-1,Ve=we.l;if(r(Ne!=null&&De!=null&&Z!=null),Wa[0]=null,Wa[1]=cn,Wa[2]=ns,Wa[3]=Ls,we.ca=De,we.tb=We,we.c=Z.width,we.i=Z.height,r(0<we.c&&0<we.i),1>=Se)Z=0;else if(we.$a=3&Ne[ke+0],we.Z=Ne[ke+0]>>2&3,we.Lc=Ne[ke+0]>>4&3,ke=Ne[ke+0]>>6&3,0>we.$a||1<we.$a||4<=we.Z||1<we.Lc||ke)Z=0;else if(Ve.put=vt,Ve.ac=zr,Ve.bc=Tr,Ve.ma=we,Ve.width=Z.width,Ve.height=Z.height,Ve.Da=Z.Da,Ve.v=Z.v,Ve.va=Z.va,Ve.j=Z.j,Ve.o=Z.o,we.$a)e:{r(we.$a==1),Z=Nr();t:for(;;){if(Z==null){Z=0;break e}if(r(we!=null),we.mc=Z,Z.c=we.c,Z.i=we.i,Z.l=we.l,Z.l.ma=we,Z.l.width=we.c,Z.l.height=we.i,Z.a=0,C(Z.m,Ne,Ae,$e),!an(we.c,we.i,1,Z,null)||(Z.ab==1&&Z.gc[0].hc==3&&sr(Z.s)?(we.ic=1,Ne=Z.c*Z.i,Z.Ta=null,Z.Ua=0,Z.V=i(Ne),Z.Ba=0,Z.V==null?(Z.a=1,Z=0):Z=1):(we.ic=0,Z=Jr(Z,we.c)),!Z))break t;Z=1;break e}we.mc=null,Z=0}else Z=$e>=we.c*we.i;we=!Z}if(we)return null;K.ga.Lc!=1?K.Ga=0:he=be-ae}r(K.ga!=null),r(ae+he<=be);e:{if(Z=(Ne=K.ga).c,be=Ne.l.o,Ne.$a==0){if(Ae=K.rc,$e=K.Vc,Ve=K.Fa,ke=K.P+1+ae*Z,Se=K.mb,De=K.nb+ae*Z,r(ke<=K.P+K.qc),Ne.Z!=0)for(r(Wa[Ne.Z]!=null),we=0;we<he;++we)Wa[Ne.Z](Ae,$e,Ve,ke,Se,De,Z),Ae=Se,$e=De,De+=Z,ke+=Z;else for(we=0;we<he;++we)n(Se,De,Ve,ke,Z),Ae=Se,$e=De,De+=Z,ke+=Z;K.rc=Ae,K.Vc=$e}else{if(r(Ne.mc!=null),Z=ae+he,r((we=Ne.mc)!=null),r(Z<=we.i),we.C>=Z)Z=1;else if(Ne.ic||Po(),Ne.ic){Ne=we.V,Ae=we.Ba,$e=we.c;var at=we.i,Ge=(Ve=1,ke=we.$/$e,Se=we.$%$e,De=we.m,We=we.s,we.$),tt=$e*at,st=$e*Z,ut=We.wc,ft=Ge<st?yt(We,Se,ke):null;r(Ge<=tt),r(Z<=at),r(sr(We));t:for(;;){for(;!De.h&&Ge<st;){if(Se&ut||(ft=yt(We,Se,ke)),r(ft!=null),J(De),256>(at=Be(ft.G[0],ft.H[0],De)))Ne[Ae+Ge]=at,++Ge,++Se>=$e&&(Se=0,++ke<=Z&&!(ke%16)&&It(we,ke));else{if(!(280>at)){Ve=0;break t}at=Qt(at-256,De);var cr,qt=Be(ft.G[4],ft.H[4],De);if(J(De),!(Ge>=(qt=Me($e,qt=Qt(qt,De)))&&tt-Ge>=at)){Ve=0;break t}for(cr=0;cr<at;++cr)Ne[Ae+Ge+cr]=Ne[Ae+Ge+cr-qt];for(Ge+=at,Se+=at;Se>=$e;)Se-=$e,++ke<=Z&&!(ke%16)&&It(we,ke);Ge<st&&Se&ut&&(ft=yt(We,Se,ke))}r(De.h==re(De))}It(we,ke>Z?Z:ke);break t}!Ve||De.h&&Ge<tt?(Ve=0,we.a=De.h?5:3):we.$=Ge,Z=Ve}else Z=or(we,we.V,we.Ba,we.c,we.i,Z,Tn);if(!Z){he=0;break e}}ae+he>=be&&(K.Cc=1),he=1}if(!he)return null;if(K.Cc&&((he=K.ga)!=null&&(he.mc=null),K.ga=null,0<K.Ga))return alert("todo:WebPDequantizeLevels"),null}return K.nb+ae*ge}function Js(K,Z,ae,he,ge,be){for(;0<ge--;){var we,Ne=K,ke=Z+(ae?1:0),Se=K,De=Z+(ae?0:3);for(we=0;we<he;++we){var We=Se[De+4*we];We!=255&&(We*=32897,Ne[ke+4*we+0]=Ne[ke+4*we+0]*We>>23,Ne[ke+4*we+1]=Ne[ke+4*we+1]*We>>23,Ne[ke+4*we+2]=Ne[ke+4*we+2]*We>>23)}Z+=be}}function Ns(K,Z,ae,he,ge){for(;0<he--;){var be;for(be=0;be<ae;++be){var we=K[Z+2*be+0],Ne=15&(Se=K[Z+2*be+1]),ke=4369*Ne,Se=(240&Se|Se>>4)*ke>>16;K[Z+2*be+0]=(240&we|we>>4)*ke>>16&240|(15&we|we<<4)*ke>>16>>4&15,K[Z+2*be+1]=240&Se|Ne}Z+=ge}}function Ta(K,Z,ae,he,ge,be,we,Ne){var ke,Se,De=255;for(Se=0;Se<ge;++Se){for(ke=0;ke<he;++ke){var We=K[Z+ke];be[we+4*ke]=We,De&=We}Z+=ae,we+=Ne}return De!=255}function Rl(K,Z,ae,he,ge){var be;for(be=0;be<ge;++be)ae[he+be]=K[Z+be]>>8}function Po(){_u=Js,Ym=Ns,Rh=Ta,Qm=Rl}function Ll(K,Z,ae){I[K]=function(he,ge,be,we,Ne,ke,Se,De,We,Ae,$e,Ve,at,Ge,tt,st,ut){var ft,cr=ut-1>>1,qt=Ne[ke+0]|Se[De+0]<<16,Fr=We[Ae+0]|$e[Ve+0]<<16;r(he!=null);var Yt=3*qt+Fr+131074>>2;for(Z(he[ge+0],255&Yt,Yt>>16,at,Ge),be!=null&&(Yt=3*Fr+qt+131074>>2,Z(be[we+0],255&Yt,Yt>>16,tt,st)),ft=1;ft<=cr;++ft){var tn=Ne[ke+ft]|Se[De+ft]<<16,hs=We[Ae+ft]|$e[Ve+ft]<<16,Ur=qt+tn+Fr+hs+524296,zt=Ur+2*(tn+Fr)>>3;Yt=zt+qt>>1,qt=(Ur=Ur+2*(qt+hs)>>3)+tn>>1,Z(he[ge+2*ft-1],255&Yt,Yt>>16,at,Ge+(2*ft-1)*ae),Z(he[ge+2*ft-0],255&qt,qt>>16,at,Ge+(2*ft-0)*ae),be!=null&&(Yt=Ur+Fr>>1,qt=zt+hs>>1,Z(be[we+2*ft-1],255&Yt,Yt>>16,tt,st+(2*ft-1)*ae),Z(be[we+2*ft+0],255&qt,qt>>16,tt,st+(2*ft+0)*ae)),qt=tn,Fr=hs}1&ut||(Yt=3*qt+Fr+131074>>2,Z(he[ge+ut-1],255&Yt,Yt>>16,at,Ge+(ut-1)*ae),be!=null&&(Yt=3*Fr+qt+131074>>2,Z(be[we+ut-1],255&Yt,Yt>>16,tt,st+(ut-1)*ae)))}}function hu(){Ai[cp]=X1,Ai[Ec]=Tc,Ai[vy]=Y1,Ai[Lh]=Bd,Ai[Dh]=Su,Ai[On]=zh,Ai[up]=i0,Ai[Ld]=Tc,Ai[ju]=Bd,Ai[Fh]=Su,Ai[Bh]=zh}function Ad(K){return K&-16384?0>K?0:255:K>>Pc}function wc(K,Z){return Ad((19077*K>>8)+(26149*Z>>8)-14234)}function fu(K,Z,ae){return Ad((19077*K>>8)-(6419*Z>>8)-(13320*ae>>8)+8708)}function _c(K,Z){return Ad((19077*K>>8)+(33050*Z>>8)-17685)}function jc(K,Z,ae,he,ge){he[ge+0]=wc(K,ae),he[ge+1]=fu(K,Z,ae),he[ge+2]=_c(K,Z)}function Pa(K,Z,ae,he,ge){he[ge+0]=_c(K,Z),he[ge+1]=fu(K,Z,ae),he[ge+2]=wc(K,ae)}function pu(K,Z,ae,he,ge){var be=fu(K,Z,ae);Z=be<<3&224|_c(K,Z)>>3,he[ge+0]=248&wc(K,ae)|be>>5,he[ge+1]=Z}function mu(K,Z,ae,he,ge){var be=240&_c(K,Z)|15;he[ge+0]=240&wc(K,ae)|fu(K,Z,ae)>>4,he[ge+1]=be}function Ph(K,Z,ae,he,ge){he[ge+0]=255,jc(K,Z,ae,he,ge+1)}function Oh(K,Z,ae,he,ge){Pa(K,Z,ae,he,ge),he[ge+3]=255}function fi(K,Z,ae,he,ge){jc(K,Z,ae,he,ge),he[ge+3]=255}function Oo(K,Z,ae){I[K]=function(he,ge,be,we,Ne,ke,Se,De,We){for(var Ae=De+(-2&We)*ae;De!=Ae;)Z(he[ge+0],be[we+0],Ne[ke+0],Se,De),Z(he[ge+1],be[we+0],Ne[ke+0],Se,De+ae),ge+=2,++we,++ke,De+=2*ae;1&We&&Z(he[ge+0],be[we+0],Ne[ke+0],Se,De)}}function nl(K,Z,ae){return ae==0?K==0?Z==0?6:5:Z==0?4:0:ae}function ip(K,Z,ae,he,ge){switch(K>>>30){case 3:bu(Z,ae,he,ge,0);break;case 2:us(Z,ae,he,ge);break;case 1:fn(Z,ae,he,ge)}}function Vi(K,Z){var ae,he,ge=Z.M,be=Z.Nb,we=K.oc,Ne=K.pc+40,ke=K.oc,Se=K.pc+584,De=K.oc,We=K.pc+600;for(ae=0;16>ae;++ae)we[Ne+32*ae-1]=129;for(ae=0;8>ae;++ae)ke[Se+32*ae-1]=129,De[We+32*ae-1]=129;for(0<ge?we[Ne-1-32]=ke[Se-1-32]=De[We-1-32]=129:(a(we,Ne-32-1,127,21),a(ke,Se-32-1,127,9),a(De,We-32-1,127,9)),he=0;he<K.za;++he){var Ae=Z.ya[Z.aa+he];if(0<he){for(ae=-1;16>ae;++ae)n(we,Ne+32*ae-4,we,Ne+32*ae+12,4);for(ae=-1;8>ae;++ae)n(ke,Se+32*ae-4,ke,Se+32*ae+4,4),n(De,We+32*ae-4,De,We+32*ae+4,4)}var $e=K.Gd,Ve=K.Hd+he,at=Ae.ad,Ge=Ae.Hc;if(0<ge&&(n(we,Ne-32,$e[Ve].y,0,16),n(ke,Se-32,$e[Ve].f,0,8),n(De,We-32,$e[Ve].ea,0,8)),Ae.Za){var tt=we,st=Ne-32+16;for(0<ge&&(he>=K.za-1?a(tt,st,$e[Ve].y[15],4):n(tt,st,$e[Ve+1].y,0,4)),ae=0;4>ae;ae++)tt[st+128+ae]=tt[st+256+ae]=tt[st+384+ae]=tt[st+0+ae];for(ae=0;16>ae;++ae,Ge<<=2)tt=we,st=Ne+o0[ae],uo[Ae.Ob[ae]](tt,st),ip(Ge,at,16*+ae,tt,st)}else if(tt=nl(he,ge,Ae.Ob[0]),mi[tt](we,Ne),Ge!=0)for(ae=0;16>ae;++ae,Ge<<=2)ip(Ge,at,16*+ae,we,Ne+o0[ae]);for(ae=Ae.Gc,tt=nl(he,ge,Ae.Dd),Ci[tt](ke,Se),Ci[tt](De,We),Ge=at,tt=ke,st=Se,255&(Ae=0|ae)&&(170&Ae?Si(Ge,256,tt,st):Nn(Ge,256,tt,st)),Ae=De,Ge=We,255&(ae>>=8)&&(170&ae?Si(at,320,Ae,Ge):Nn(at,320,Ae,Ge)),ge<K.Ub-1&&(n($e[Ve].y,0,we,Ne+480,16),n($e[Ve].f,0,ke,Se+224,8),n($e[Ve].ea,0,De,We+224,8)),ae=8*be*K.B,$e=K.sa,Ve=K.ta+16*he+16*be*K.R,at=K.qa,Ae=K.ra+8*he+ae,Ge=K.Ha,tt=K.Ia+8*he+ae,ae=0;16>ae;++ae)n($e,Ve+ae*K.R,we,Ne+32*ae,16);for(ae=0;8>ae;++ae)n(at,Ae+ae*K.B,ke,Se+32*ae,8),n(Ge,tt+ae*K.B,De,We+32*ae,8)}}function Nc(K,Z,ae,he,ge,be,we,Ne,ke){var Se=[0],De=[0],We=0,Ae=ke!=null?ke.kd:0,$e=ke??new gt;if(K==null||12>ae)return 7;$e.data=K,$e.w=Z,$e.ha=ae,Z=[Z],ae=[ae],$e.gb=[$e.gb];e:{var Ve=Z,at=ae,Ge=$e.gb;if(r(K!=null),r(at!=null),r(Ge!=null),Ge[0]=0,12<=at[0]&&!t(K,Ve[0],"RIFF")){if(t(K,Ve[0]+8,"WEBP")){Ge=3;break e}var tt=de(K,Ve[0]+4);if(12>tt||4294967286<tt){Ge=3;break e}if(Ae&&tt>at[0]-8){Ge=7;break e}Ge[0]=tt,Ve[0]+=12,at[0]-=12}Ge=0}if(Ge!=0)return Ge;for(tt=0<$e.gb[0],ae=ae[0];;){e:{var st=K;at=Z,Ge=ae;var ut=Se,ft=De,cr=Ve=[0];if((Yt=We=[We])[0]=0,8>Ge[0])Ge=7;else{if(!t(st,at[0],"VP8X")){if(de(st,at[0]+4)!=10){Ge=3;break e}if(18>Ge[0]){Ge=7;break e}var qt=de(st,at[0]+8),Fr=1+ce(st,at[0]+12);if(2147483648<=Fr*(st=1+ce(st,at[0]+15))){Ge=3;break e}cr!=null&&(cr[0]=qt),ut!=null&&(ut[0]=Fr),ft!=null&&(ft[0]=st),at[0]+=18,Ge[0]-=18,Yt[0]=1}Ge=0}}if(We=We[0],Ve=Ve[0],Ge!=0)return Ge;if(at=!!(2&Ve),!tt&&We)return 3;if(be!=null&&(be[0]=!!(16&Ve)),we!=null&&(we[0]=at),Ne!=null&&(Ne[0]=0),we=Se[0],Ve=De[0],We&&at&&ke==null){Ge=0;break}if(4>ae){Ge=7;break}if(tt&&We||!tt&&!We&&!t(K,Z[0],"ALPH")){ae=[ae],$e.na=[$e.na],$e.P=[$e.P],$e.Sa=[$e.Sa];e:{qt=K,Ge=Z,tt=ae;var Yt=$e.gb;ut=$e.na,ft=$e.P,cr=$e.Sa,Fr=22,r(qt!=null),r(tt!=null),st=Ge[0];var tn=tt[0];for(r(ut!=null),r(cr!=null),ut[0]=null,ft[0]=null,cr[0]=0;;){if(Ge[0]=st,tt[0]=tn,8>tn){Ge=7;break e}var hs=de(qt,st+4);if(4294967286<hs){Ge=3;break e}var Ur=8+hs+1&-2;if(Fr+=Ur,0<Yt&&Fr>Yt){Ge=3;break e}if(!t(qt,st,"VP8 ")||!t(qt,st,"VP8L")){Ge=0;break e}if(tn[0]<Ur){Ge=7;break e}t(qt,st,"ALPH")||(ut[0]=qt,ft[0]=st+8,cr[0]=hs),st+=Ur,tn-=Ur}}if(ae=ae[0],$e.na=$e.na[0],$e.P=$e.P[0],$e.Sa=$e.Sa[0],Ge!=0)break}ae=[ae],$e.Ja=[$e.Ja],$e.xa=[$e.xa];e:if(Yt=K,Ge=Z,tt=ae,ut=$e.gb[0],ft=$e.Ja,cr=$e.xa,qt=Ge[0],st=!t(Yt,qt,"VP8 "),Fr=!t(Yt,qt,"VP8L"),r(Yt!=null),r(tt!=null),r(ft!=null),r(cr!=null),8>tt[0])Ge=7;else{if(st||Fr){if(Yt=de(Yt,qt+4),12<=ut&&Yt>ut-12){Ge=3;break e}if(Ae&&Yt>tt[0]-8){Ge=7;break e}ft[0]=Yt,Ge[0]+=8,tt[0]-=8,cr[0]=Fr}else cr[0]=5<=tt[0]&&Yt[qt+0]==47&&!(Yt[qt+4]>>5),ft[0]=tt[0];Ge=0}if(ae=ae[0],$e.Ja=$e.Ja[0],$e.xa=$e.xa[0],Z=Z[0],Ge!=0)break;if(4294967286<$e.Ja)return 3;if(Ne==null||at||(Ne[0]=$e.xa?2:1),we=[we],Ve=[Ve],$e.xa){if(5>ae){Ge=7;break}Ne=we,Ae=Ve,at=be,K==null||5>ae?K=0:5<=ae&&K[Z+0]==47&&!(K[Z+4]>>5)?(tt=[0],Yt=[0],ut=[0],C(ft=new G,K,Z,ae),Wr(ft,tt,Yt,ut)?(Ne!=null&&(Ne[0]=tt[0]),Ae!=null&&(Ae[0]=Yt[0]),at!=null&&(at[0]=ut[0]),K=1):K=0):K=0}else{if(10>ae){Ge=7;break}Ne=Ve,K==null||10>ae||!Fn(K,Z+3,ae-3)?K=0:(Ae=K[Z+0]|K[Z+1]<<8|K[Z+2]<<16,at=16383&(K[Z+7]<<8|K[Z+6]),K=16383&(K[Z+9]<<8|K[Z+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=$e.Ja||!at||!K?K=0:(we&&(we[0]=at),Ne&&(Ne[0]=K),K=1))}if(!K||(we=we[0],Ve=Ve[0],We&&(Se[0]!=we||De[0]!=Ve)))return 3;ke!=null&&(ke[0]=$e,ke.offset=Z-ke.w,r(4294967286>Z-ke.w),r(ke.offset==ke.ha-ae));break}return Ge==0||Ge==7&&We&&ke==null?(be!=null&&(be[0]|=$e.na!=null&&0<$e.na.length),he!=null&&(he[0]=we),ge!=null&&(ge[0]=Ve),0):Ge}function Ed(K,Z,ae){var he=Z.width,ge=Z.height,be=0,we=0,Ne=he,ke=ge;if(Z.Da=K!=null&&0<K.Da,Z.Da&&(Ne=K.cd,ke=K.bd,be=K.v,we=K.j,11>ae||(be&=-2,we&=-2),0>be||0>we||0>=Ne||0>=ke||be+Ne>he||we+ke>ge))return 0;if(Z.v=be,Z.j=we,Z.va=be+Ne,Z.o=we+ke,Z.U=Ne,Z.T=ke,Z.da=K!=null&&0<K.da,Z.da){if(!pe(Ne,ke,ae=[K.ib],be=[K.hb]))return 0;Z.ib=ae[0],Z.hb=be[0]}return Z.ob=K!=null&&K.ob,Z.Kb=K==null||!K.Sd,Z.da&&(Z.ob=Z.ib<3*he/4&&Z.hb<3*ge/4,Z.Kb=0),1}function Td(K){if(K==null)return 2;if(11>K.S){var Z=K.f.RGBA;Z.fb+=(K.height-1)*Z.A,Z.A=-Z.A}else Z=K.f.kb,K=K.height,Z.O+=(K-1)*Z.fa,Z.fa=-Z.fa,Z.N+=(K-1>>1)*Z.Ab,Z.Ab=-Z.Ab,Z.W+=(K-1>>1)*Z.Db,Z.Db=-Z.Db,Z.F!=null&&(Z.J+=(K-1)*Z.lb,Z.lb=-Z.lb);return 0}function Dl(K,Z,ae,he){if(he==null||0>=K||0>=Z)return 2;if(ae!=null){if(ae.Da){var ge=ae.cd,be=ae.bd,we=-2&ae.v,Ne=-2&ae.j;if(0>we||0>Ne||0>=ge||0>=be||we+ge>K||Ne+be>Z)return 2;K=ge,Z=be}if(ae.da){if(!pe(K,Z,ge=[ae.ib],be=[ae.hb]))return 2;K=ge[0],Z=be[0]}}he.width=K,he.height=Z;e:{var ke=he.width,Se=he.height;if(K=he.S,0>=ke||0>=Se||!(K>=cp&&13>K))K=2;else{if(0>=he.Rd&&he.sd==null){we=be=ge=Z=0;var De=(Ne=ke*Uh[K])*Se;if(11>K||(be=(Se+1)/2*(Z=(ke+1)/2),K==12&&(we=(ge=ke)*Se)),(Se=i(De+2*be+we))==null){K=1;break e}he.sd=Se,11>K?((ke=he.f.RGBA).eb=Se,ke.fb=0,ke.A=Ne,ke.size=De):((ke=he.f.kb).y=Se,ke.O=0,ke.fa=Ne,ke.Fd=De,ke.f=Se,ke.N=0+De,ke.Ab=Z,ke.Cd=be,ke.ea=Se,ke.W=0+De+be,ke.Db=Z,ke.Ed=be,K==12&&(ke.F=Se,ke.J=0+De+2*be),ke.Tc=we,ke.lb=ge)}if(Z=1,ge=he.S,be=he.width,we=he.height,ge>=cp&&13>ge)if(11>ge)K=he.f.RGBA,Z&=(Ne=Math.abs(K.A))*(we-1)+be<=K.size,Z&=Ne>=be*Uh[ge],Z&=K.eb!=null;else{K=he.f.kb,Ne=(be+1)/2,De=(we+1)/2,ke=Math.abs(K.fa),Se=Math.abs(K.Ab);var We=Math.abs(K.Db),Ae=Math.abs(K.lb),$e=Ae*(we-1)+be;Z&=ke*(we-1)+be<=K.Fd,Z&=Se*(De-1)+Ne<=K.Cd,Z=(Z&=We*(De-1)+Ne<=K.Ed)&ke>=be&Se>=Ne&We>=Ne,Z&=K.y!=null,Z&=K.f!=null,Z&=K.ea!=null,ge==12&&(Z&=Ae>=be,Z&=$e<=K.Tc,Z&=K.F!=null)}else Z=0;K=Z?0:2}}return K!=0||ae!=null&&ae.fd&&(K=Td(he)),K}var lo=64,Wi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ki=24,kc=32,sl=8,Fl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];fe("Predictor0","PredictorAdd0"),I.Predictor0=function(){return 4278190080},I.Predictor1=function(K){return K},I.Predictor2=function(K,Z,ae){return Z[ae+0]},I.Predictor3=function(K,Z,ae){return Z[ae+1]},I.Predictor4=function(K,Z,ae){return Z[ae-1]},I.Predictor5=function(K,Z,ae){return je(je(K,Z[ae+1]),Z[ae+0])},I.Predictor6=function(K,Z,ae){return je(K,Z[ae-1])},I.Predictor7=function(K,Z,ae){return je(K,Z[ae+0])},I.Predictor8=function(K,Z,ae){return je(Z[ae-1],Z[ae+0])},I.Predictor9=function(K,Z,ae){return je(Z[ae+0],Z[ae+1])},I.Predictor10=function(K,Z,ae){return je(je(K,Z[ae-1]),je(Z[ae+0],Z[ae+1]))},I.Predictor11=function(K,Z,ae){var he=Z[ae+0];return 0>=Le(he>>24&255,K>>24&255,(Z=Z[ae-1])>>24&255)+Le(he>>16&255,K>>16&255,Z>>16&255)+Le(he>>8&255,K>>8&255,Z>>8&255)+Le(255&he,255&K,255&Z)?he:K},I.Predictor12=function(K,Z,ae){var he=Z[ae+0];return(Oe((K>>24&255)+(he>>24&255)-((Z=Z[ae-1])>>24&255))<<24|Oe((K>>16&255)+(he>>16&255)-(Z>>16&255))<<16|Oe((K>>8&255)+(he>>8&255)-(Z>>8&255))<<8|Oe((255&K)+(255&he)-(255&Z)))>>>0},I.Predictor13=function(K,Z,ae){var he=Z[ae-1];return(Ie((K=je(K,Z[ae+0]))>>24&255,he>>24&255)<<24|Ie(K>>16&255,he>>16&255)<<16|Ie(K>>8&255,he>>8&255)<<8|Ie(255&K,255&he))>>>0};var Bl=I.PredictorAdd0;I.PredictorAdd1=He,fe("Predictor2","PredictorAdd2"),fe("Predictor3","PredictorAdd3"),fe("Predictor4","PredictorAdd4"),fe("Predictor5","PredictorAdd5"),fe("Predictor6","PredictorAdd6"),fe("Predictor7","PredictorAdd7"),fe("Predictor8","PredictorAdd8"),fe("Predictor9","PredictorAdd9"),fe("Predictor10","PredictorAdd10"),fe("Predictor11","PredictorAdd11"),fe("Predictor12","PredictorAdd12"),fe("Predictor13","PredictorAdd13");var al=I.PredictorAdd2;it("ColorIndexInverseTransform","MapARGB","32b",function(K){return K>>8&255},function(K){return K}),it("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(K){return K},function(K){return K>>8&255});var ks,gu=I.ColorIndexInverseTransform,il=I.MapARGB,Mo=I.VP8LColorIndexInverseTransformAlpha,yu=I.MapAlpha,xu=I.VP8LPredictorsAdd=[];xu.length=16,(I.VP8LPredictors=[]).length=16,(I.VP8LPredictorsAdd_C=[]).length=16,(I.VP8LPredictors_C=[]).length=16;var Pd,Od,$l,Sc,Cc,vu,Ac,bu,us,Si,fn,Nn,ds,Ds,Io,Mh,Md,ql,op,Id,lp,Xm,Ih,wu,_u,Ym,Rh,Qm,Zm=i(511),Jm=i(2041),e0=i(225),t0=i(767),r0=0,ol=Jm,Rd=e0,pi=t0,co=Zm,cp=0,Ec=1,vy=2,Lh=3,Dh=4,On=5,up=6,Ld=7,ju=8,Fh=9,Bh=10,$h=[2,3,7],dp=[3,3,11],Nu=[280,256,256,256,40],by=[0,1,1,1,0],V1=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],W1=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],wy=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hp=8,Dd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],qh=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ku=null,n0=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],s0=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],_y=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],jy=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],K1=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],G1=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],a0=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],mi=[],uo=[],Ci=[],ll=1,Fd=2,Wa=[],Ai=[];Ll("UpsampleRgbLinePair",jc,3),Ll("UpsampleBgrLinePair",Pa,3),Ll("UpsampleRgbaLinePair",fi,4),Ll("UpsampleBgraLinePair",Oh,4),Ll("UpsampleArgbLinePair",Ph,4),Ll("UpsampleRgba4444LinePair",mu,2),Ll("UpsampleRgb565LinePair",pu,2);var X1=I.UpsampleRgbLinePair,Y1=I.UpsampleBgrLinePair,Tc=I.UpsampleRgbaLinePair,Bd=I.UpsampleBgraLinePair,Su=I.UpsampleArgbLinePair,zh=I.UpsampleRgba4444LinePair,i0=I.UpsampleRgb565LinePair,zl=16,Ro=1<<zl-1,jn=-227,kn=482,Pc=6,Oa=0,Ei=i(256),Cu=i(256),$d=i(256),Ti=i(256),fp=i(kn-jn),Ny=i(kn-jn);Oo("YuvToRgbRow",jc,3),Oo("YuvToBgrRow",Pa,3),Oo("YuvToRgbaRow",fi,4),Oo("YuvToBgraRow",Oh,4),Oo("YuvToArgbRow",Ph,4),Oo("YuvToRgba4444Row",mu,2),Oo("YuvToRgb565Row",pu,2);var o0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Au=[0,2,8],ky=[8,7,6,4,4,2,2,2,1,1,1,1],Ul=1;this.WebPDecodeRGBA=function(K,Z,ae,he,ge){var be=Ec,we=new lt,Ne=new Pt;we.ba=Ne,Ne.S=be,Ne.width=[Ne.width],Ne.height=[Ne.height];var ke=Ne.width,Se=Ne.height,De=new wt;if(De==null||K==null)var We=2;else r(De!=null),We=Nc(K,Z,ae,De.width,De.height,De.Pd,De.Qd,De.format,null);if(We!=0?ke=0:(ke!=null&&(ke[0]=De.width[0]),Se!=null&&(Se[0]=De.height[0]),ke=1),ke){Ne.width=Ne.width[0],Ne.height=Ne.height[0],he!=null&&(he[0]=Ne.width),ge!=null&&(ge[0]=Ne.height);e:{if(he=new Yr,(ge=new gt).data=K,ge.w=Z,ge.ha=ae,ge.kd=1,Z=[0],r(ge!=null),((K=Nc(ge.data,ge.w,ge.ha,null,null,null,Z,null,ge))==0||K==7)&&Z[0]&&(K=4),(Z=K)==0){if(r(we!=null),he.data=ge.data,he.w=ge.w+ge.offset,he.ha=ge.ha-ge.offset,he.put=vt,he.ac=zr,he.bc=Tr,he.ma=we,ge.xa){if((K=Nr())==null){we=1;break e}if((function(Ae,$e){var Ve=[0],at=[0],Ge=[0];t:for(;;){if(Ae==null)return 0;if($e==null)return Ae.a=2,0;if(Ae.l=$e,Ae.a=0,C(Ae.m,$e.data,$e.w,$e.ha),!Wr(Ae.m,Ve,at,Ge)){Ae.a=3;break t}if(Ae.xb=Fd,$e.width=Ve[0],$e.height=at[0],!an(Ve[0],at[0],1,Ae,null))break t;return 1}return r(Ae.a!=0),0})(K,he)){if(he=(Z=Dl(he.width,he.height,we.Oa,we.ba))==0){t:{he=K;r:for(;;){if(he==null){he=0;break t}if(r(he.s.yc!=null),r(he.s.Ya!=null),r(0<he.s.Wb),r((ae=he.l)!=null),r((ge=ae.ma)!=null),he.xb!=0){if(he.ca=ge.ba,he.tb=ge.tb,r(he.ca!=null),!Ed(ge.Oa,ae,Lh)){he.a=2;break r}if(!Jr(he,ae.width)||ae.da)break r;if((ae.da||Tt(he.ca.S))&&Po(),11>he.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),he.ca.f.kb.F!=null&&Po()),he.Pb&&0<he.s.ua&&he.s.vb.X==null&&!le(he.s.vb,he.s.Wa.Xa)){he.a=1;break r}he.xb=0}if(!or(he,he.V,he.Ba,he.c,he.i,ae.o,kt))break r;ge.Dc=he.Ma,he=1;break t}r(he.a!=0),he=0}he=!he}he&&(Z=K.a)}else Z=K.a}else{if((K=new ln)==null){we=1;break e}if(K.Fa=ge.na,K.P=ge.P,K.qc=ge.Sa,_n(K,he)){if((Z=Dl(he.width,he.height,we.Oa,we.ba))==0){if(K.Aa=0,ae=we.Oa,r((ge=K)!=null),ae!=null){if(0<(ke=0>(ke=ae.Md)?0:100<ke?255:255*ke/100)){for(Se=De=0;4>Se;++Se)12>(We=ge.pb[Se]).lc&&(We.ia=ke*ky[0>We.lc?0:We.lc]>>3),De|=We.ia;De&&(alert("todo:VP8InitRandom"),ge.ia=1)}ge.Ga=ae.Id,100<ge.Ga?ge.Ga=100:0>ge.Ga&&(ge.Ga=0)}(function(Ae,$e){if(Ae==null)return 0;if($e==null)return Rr(Ae,2,"NULL VP8Io parameter in VP8Decode().");if(!Ae.cb&&!_n(Ae,$e))return 0;if(r(Ae.cb),$e.ac==null||$e.ac($e)){$e.ob&&(Ae.L=0);var Ve=Au[Ae.L];if(Ae.L==2?(Ae.yb=0,Ae.zb=0):(Ae.yb=$e.v-Ve>>4,Ae.zb=$e.j-Ve>>4,0>Ae.yb&&(Ae.yb=0),0>Ae.zb&&(Ae.zb=0)),Ae.Va=$e.o+15+Ve>>4,Ae.Hb=$e.va+15+Ve>>4,Ae.Hb>Ae.za&&(Ae.Hb=Ae.za),Ae.Va>Ae.Ub&&(Ae.Va=Ae.Ub),0<Ae.L){var at=Ae.ed;for(Ve=0;4>Ve;++Ve){var Ge;if(Ae.Qa.Cb){var tt=Ae.Qa.Lb[Ve];Ae.Qa.Fb||(tt+=at.Tb)}else tt=at.Tb;for(Ge=0;1>=Ge;++Ge){var st=Ae.gd[Ve][Ge],ut=tt;if(at.Pc&&(ut+=at.vd[0],Ge&&(ut+=at.od[0])),0<(ut=0>ut?0:63<ut?63:ut)){var ft=ut;0<at.wb&&(ft=4<at.wb?ft>>2:ft>>1)>9-at.wb&&(ft=9-at.wb),1>ft&&(ft=1),st.dd=ft,st.tc=2*ut+ft,st.ld=40<=ut?2:15<=ut?1:0}else st.tc=0;st.La=Ge}}}Ve=0}else Rr(Ae,6,"Frame setup failed"),Ve=Ae.a;if(Ve=Ve==0){if(Ve){Ae.$c=0,0<Ae.Aa||(Ae.Ic=Ul);t:{Ve=Ae.Ic,at=4*(ft=Ae.za);var cr=32*ft,qt=ft+1,Fr=0<Ae.L?ft*(0<Ae.Aa?2:1):0,Yt=(Ae.Aa==2?2:1)*ft;if((st=at+832+(Ge=3*(16*Ve+Au[Ae.L])/2*cr)+(tt=Ae.Fa!=null&&0<Ae.Fa.length?Ae.Kc.c*Ae.Kc.i:0))!=st)Ve=0;else{if(st>Ae.Vb){if(Ae.Vb=0,Ae.Ec=i(st),Ae.Fc=0,Ae.Ec==null){Ve=Rr(Ae,1,"no memory during frame initialization.");break t}Ae.Vb=st}st=Ae.Ec,ut=Ae.Fc,Ae.Ac=st,Ae.Bc=ut,ut+=at,Ae.Gd=o(cr,yr),Ae.Hd=0,Ae.rb=o(qt+1,jt),Ae.sb=1,Ae.wa=Fr?o(Fr,Rt):null,Ae.Y=0,Ae.D.Nb=0,Ae.D.wa=Ae.wa,Ae.D.Y=Ae.Y,0<Ae.Aa&&(Ae.D.Y+=ft),r(!0),Ae.oc=st,Ae.pc=ut,ut+=832,Ae.ya=o(Yt,Dr),Ae.aa=0,Ae.D.ya=Ae.ya,Ae.D.aa=Ae.aa,Ae.Aa==2&&(Ae.D.aa+=ft),Ae.R=16*ft,Ae.B=8*ft,ft=(cr=Au[Ae.L])*Ae.R,cr=cr/2*Ae.B,Ae.sa=st,Ae.ta=ut+ft,Ae.qa=Ae.sa,Ae.ra=Ae.ta+16*Ve*Ae.R+cr,Ae.Ha=Ae.qa,Ae.Ia=Ae.ra+8*Ve*Ae.B+cr,Ae.$c=0,ut+=Ge,Ae.mb=tt?st:null,Ae.nb=tt?ut:null,r(ut+tt<=Ae.Fc+Ae.Vb),ui(Ae),a(Ae.Ac,Ae.Bc,0,at),Ve=1}}if(Ve){if($e.ka=0,$e.y=Ae.sa,$e.O=Ae.ta,$e.f=Ae.qa,$e.N=Ae.ra,$e.ea=Ae.Ha,$e.Vd=Ae.Ia,$e.fa=Ae.R,$e.Rc=Ae.B,$e.F=null,$e.J=0,!r0){for(Ve=-255;255>=Ve;++Ve)Zm[255+Ve]=0>Ve?-Ve:Ve;for(Ve=-1020;1020>=Ve;++Ve)Jm[1020+Ve]=-128>Ve?-128:127<Ve?127:Ve;for(Ve=-112;112>=Ve;++Ve)e0[112+Ve]=-16>Ve?-16:15<Ve?15:Ve;for(Ve=-255;510>=Ve;++Ve)t0[255+Ve]=0>Ve?0:255<Ve?255:Ve;r0=1}Ac=Ca,bu=Ha,Si=fa,fn=Co,Nn=Pr,us=Gr,ds=Va,Ds=oo,Io=ye,Mh=Te,Md=Cd,ql=ee,op=Re,Id=Ue,lp=Il,Xm=bc,Ih=Th,wu=du,uo[0]=sp,uo[1]=Ao,uo[2]=hi,uo[3]=Gm,uo[4]=Hi,uo[5]=ap,uo[6]=Ml,uo[7]=Nd,uo[8]=Ch,uo[9]=ou,mi[0]=Ni,mi[1]=Eo,mi[2]=di,mi[3]=Ol,mi[4]=Zs,mi[5]=Ea,mi[6]=tl,Ci[0]=kd,Ci[1]=Pl,Ci[2]=To,Ci[3]=lu,Ci[4]=Eh,Ci[5]=Ah,Ci[6]=Sd,Ve=1}else Ve=0}Ve&&(Ve=(function(tn,hs){for(tn.M=0;tn.M<tn.Va;++tn.M){var Ur,zt=tn.Jc[tn.M&tn.Xb],Ot=tn.m,Ss=tn;for(Ur=0;Ur<Ss.za;++Ur){var Ar=Ot,Qr=Ss,qn=Qr.Ac,pa=Qr.Bc+4*Ur,Fs=Qr.zc,ss=Qr.ya[Qr.aa+Ur];if(Qr.Qa.Bb?ss.$b=Q(Ar,Qr.Pa.jb[0])?2+Q(Ar,Qr.Pa.jb[2]):Q(Ar,Qr.Pa.jb[1]):ss.$b=0,Qr.kc&&(ss.Ad=Q(Ar,Qr.Bd)),ss.Za=!Q(Ar,145)+0,ss.Za){var ea=ss.Ob,ma=0;for(Qr=0;4>Qr;++Qr){var Xn,sn=Fs[0+Qr];for(Xn=0;4>Xn;++Xn){sn=K1[qn[pa+Xn]][sn];for(var pn=_y[Q(Ar,sn[0])];0<pn;)pn=_y[2*pn+Q(Ar,sn[pn])];sn=-pn,qn[pa+Xn]=sn}n(ea,ma,qn,pa,4),ma+=4,Fs[0+Qr]=sn}}else sn=Q(Ar,156)?Q(Ar,128)?1:3:Q(Ar,163)?2:0,ss.Ob[0]=sn,a(qn,pa,sn,4),a(Fs,0,sn,4);ss.Dd=Q(Ar,142)?Q(Ar,114)?Q(Ar,183)?1:3:2:0}if(Ss.m.Ka)return Rr(tn,7,"Premature end-of-partition0 encountered.");for(;tn.ja<tn.za;++tn.ja){if(Ss=zt,Ar=(Ot=tn).rb[Ot.sb-1],qn=Ot.rb[Ot.sb+Ot.ja],Ur=Ot.ya[Ot.aa+Ot.ja],pa=Ot.kc?Ur.Ad:0)Ar.la=qn.la=0,Ur.Za||(Ar.Na=qn.Na=0),Ur.Hc=0,Ur.Gc=0,Ur.ia=0;else{var Yn,mn;if(Ar=qn,qn=Ss,pa=Ot.Pa.Xc,Fs=Ot.ya[Ot.aa+Ot.ja],ss=Ot.pb[Fs.$b],Qr=Fs.ad,ea=0,ma=Ot.rb[Ot.sb-1],sn=Xn=0,a(Qr,ea,0,384),Fs.Za)var fs=0,ps=pa[3];else{pn=i(16);var Mn=Ar.Na+ma.Na;if(Mn=ku(qn,pa[1],Mn,ss.Eb,0,pn,0),Ar.Na=ma.Na=(0<Mn)+0,1<Mn)Ac(pn,0,Qr,ea);else{var Ka=pn[0]+3>>3;for(pn=0;256>pn;pn+=16)Qr[ea+pn]=Ka}fs=1,ps=pa[0]}var Sn=15&Ar.la,In=15&ma.la;for(pn=0;4>pn;++pn){var Bs=1&In;for(Ka=mn=0;4>Ka;++Ka)Sn=Sn>>1|(Bs=(Mn=ku(qn,ps,Mn=Bs+(1&Sn),ss.Sc,fs,Qr,ea))>fs)<<7,mn=mn<<2|(3<Mn?3:1<Mn?2:Qr[ea+0]!=0),ea+=16;Sn>>=4,In=In>>1|Bs<<7,Xn=(Xn<<8|mn)>>>0}for(ps=Sn,fs=In>>4,Yn=0;4>Yn;Yn+=2){for(mn=0,Sn=Ar.la>>4+Yn,In=ma.la>>4+Yn,pn=0;2>pn;++pn){for(Bs=1&In,Ka=0;2>Ka;++Ka)Mn=Bs+(1&Sn),Sn=Sn>>1|(Bs=0<(Mn=ku(qn,pa[2],Mn,ss.Qc,0,Qr,ea)))<<3,mn=mn<<2|(3<Mn?3:1<Mn?2:Qr[ea+0]!=0),ea+=16;Sn>>=2,In=In>>1|Bs<<5}sn|=mn<<4*Yn,ps|=Sn<<4<<Yn,fs|=(240&In)<<Yn}Ar.la=ps,ma.la=fs,Fs.Hc=Xn,Fs.Gc=sn,Fs.ia=43690&sn?0:ss.ia,pa=!(Xn|sn)}if(0<Ot.L&&(Ot.wa[Ot.Y+Ot.ja]=Ot.gd[Ur.$b][Ur.Za],Ot.wa[Ot.Y+Ot.ja].La|=!pa),Ss.Ka)return Rr(tn,7,"Premature end-of-file encountered.")}if(ui(tn),Ot=hs,Ss=1,Ur=(zt=tn).D,Ar=0<zt.L&&zt.M>=zt.zb&&zt.M<=zt.Va,zt.Aa==0)t:{if(Ur.M=zt.M,Ur.uc=Ar,Vi(zt,Ur),Ss=1,Ur=(mn=zt.D).Nb,Ar=(sn=Au[zt.L])*zt.R,qn=sn/2*zt.B,pn=16*Ur*zt.R,Ka=8*Ur*zt.B,pa=zt.sa,Fs=zt.ta-Ar+pn,ss=zt.qa,Qr=zt.ra-qn+Ka,ea=zt.Ha,ma=zt.Ia-qn+Ka,In=(Sn=mn.M)==0,Xn=Sn>=zt.Va-1,zt.Aa==2&&Vi(zt,mn),mn.uc)for(Bs=(Mn=zt).D.M,r(Mn.D.uc),mn=Mn.yb;mn<Mn.Hb;++mn){fs=mn,ps=Bs;var Ma=(Pi=(Es=Mn).D).Nb;Yn=Es.R;var Pi=Pi.wa[Pi.Y+fs],Cs=Es.sa,As=Es.ta+16*Ma*Yn+16*fs,Ga=Pi.dd,Rn=Pi.tc;if(Rn!=0)if(r(3<=Rn),Es.L==1)0<fs&&Xm(Cs,As,Yn,Rn+4),Pi.La&&wu(Cs,As,Yn,Rn),0<ps&&lp(Cs,As,Yn,Rn+4),Pi.La&&Ih(Cs,As,Yn,Rn);else{var Xa=Es.B,ho=Es.qa,Lo=Es.ra+8*Ma*Xa+8*fs,ga=Es.Ha,Es=Es.Ia+8*Ma*Xa+8*fs;Ma=Pi.ld,0<fs&&(Ds(Cs,As,Yn,Rn+4,Ga,Ma),Mh(ho,Lo,ga,Es,Xa,Rn+4,Ga,Ma)),Pi.La&&(ql(Cs,As,Yn,Rn,Ga,Ma),Id(ho,Lo,ga,Es,Xa,Rn,Ga,Ma)),0<ps&&(ds(Cs,As,Yn,Rn+4,Ga,Ma),Io(ho,Lo,ga,Es,Xa,Rn+4,Ga,Ma)),Pi.La&&(Md(Cs,As,Yn,Rn,Ga,Ma),op(ho,Lo,ga,Es,Xa,Rn,Ga,Ma))}}if(zt.ia&&alert("todo:DitherRow"),Ot.put!=null){if(mn=16*Sn,Sn=16*(Sn+1),In?(Ot.y=zt.sa,Ot.O=zt.ta+pn,Ot.f=zt.qa,Ot.N=zt.ra+Ka,Ot.ea=zt.Ha,Ot.W=zt.Ia+Ka):(mn-=sn,Ot.y=pa,Ot.O=Fs,Ot.f=ss,Ot.N=Qr,Ot.ea=ea,Ot.W=ma),Xn||(Sn-=sn),Sn>Ot.o&&(Sn=Ot.o),Ot.F=null,Ot.J=null,zt.Fa!=null&&0<zt.Fa.length&&mn<Sn&&(Ot.J=$n(zt,Ot,mn,Sn-mn),Ot.F=zt.mb,Ot.F==null&&Ot.F.length==0)){Ss=Rr(zt,3,"Could not decode alpha data.");break t}mn<Ot.j&&(sn=Ot.j-mn,mn=Ot.j,r(!(1&sn)),Ot.O+=zt.R*sn,Ot.N+=zt.B*(sn>>1),Ot.W+=zt.B*(sn>>1),Ot.F!=null&&(Ot.J+=Ot.width*sn)),mn<Sn&&(Ot.O+=Ot.v,Ot.N+=Ot.v>>1,Ot.W+=Ot.v>>1,Ot.F!=null&&(Ot.J+=Ot.v),Ot.ka=mn-Ot.j,Ot.U=Ot.va-Ot.v,Ot.T=Sn-mn,Ss=Ot.put(Ot))}Ur+1!=zt.Ic||Xn||(n(zt.sa,zt.ta-Ar,pa,Fs+16*zt.R,Ar),n(zt.qa,zt.ra-qn,ss,Qr+8*zt.B,qn),n(zt.Ha,zt.Ia-qn,ea,ma+8*zt.B,qn))}if(!Ss)return Rr(tn,6,"Output aborted.")}return 1})(Ae,$e)),$e.bc!=null&&$e.bc($e),Ve&=1}return Ve?(Ae.cb=0,Ve):0})(K,he)||(Z=K.a)}}else Z=K.a}Z==0&&we.Oa!=null&&we.Oa.fd&&(Z=Td(we.ba))}we=Z}be=we!=0?null:11>be?Ne.f.RGBA.eb:Ne.f.kb.y}else be=null;return be};var Uh=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function l(I,U){for(var H="",z=0;z<4;z++)H+=String.fromCharCode(I[U++]);return H}function d(I,U){return I[U+0]|I[U+1]<<8}function f(I,U){return(I[U+0]|I[U+1]<<8|I[U+2]<<16)>>>0}function p(I,U){return(I[U+0]|I[U+1]<<8|I[U+2]<<16|I[U+3]<<24)>>>0}new u;var h=[0],y=[0],g=[],m=new u,x=e,v=(function(I,U){var H={},z=0,O=!1,L=0,E=0;if(H.frames=[],!(function(M,G){for(var X=0;X<4;X++)if(M[G+X]!="RIFF".charCodeAt(X))return!0;return!1})(I,U)){for(p(I,U+=4),U+=8;U<I.length;){var k=l(I,U),N=p(I,U+=4);U+=4;var S=N+(1&N);switch(k){case"VP8 ":case"VP8L":H.frames[z]===void 0&&(H.frames[z]={}),(q=H.frames[z]).src_off=O?E:U-8,q.src_size=L+N+8,z++,O&&(O=!1,L=0,E=0);break;case"VP8X":(q=H.header={}).feature_flags=I[U];var C=U+4;q.canvas_width=1+f(I,C),C+=3,q.canvas_height=1+f(I,C),C+=3;break;case"ALPH":O=!0,L=S+8,E=U-8;break;case"ANIM":(q=H.header).bgcolor=p(I,U),C=U+4,q.loop_count=d(I,C),C+=2;break;case"ANMF":var D,q;(q=H.frames[z]={}).offset_x=2*f(I,U),U+=3,q.offset_y=2*f(I,U),U+=3,q.width=1+f(I,U),U+=3,q.height=1+f(I,U),U+=3,q.duration=f(I,U),U+=3,D=I[U++],q.dispose=1&D,q.blend=D>>1&1}k!="ANMF"&&(U+=S)}return H}})(x,0);v.response=x,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,_=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],y=[w.canvas_width];for(var A=0;A<_.length&&_[A].blend!=0;A++);}var P=_[0],B=m.WebPDecodeRGBA(x,P.src_off,P.src_size,y,h);P.rgba=B,P.imgwidth=y[0],P.imgheight=h[0];for(var T=0;T<y[0]*h[0]*4;T++)g[T]=B[T];return this.width=y,this.height=h,this.data=g,this}(function(e){var r,t,n,a,i,o,c,u,l,d=function(M){return M=M||{},this.isStrokeTransparent=M.isStrokeTransparent||!1,this.strokeOpacity=M.strokeOpacity||1,this.strokeStyle=M.strokeStyle||"#000000",this.fillStyle=M.fillStyle||"#000000",this.isFillTransparent=M.isFillTransparent||!1,this.fillOpacity=M.fillOpacity||1,this.font=M.font||"10px sans-serif",this.textBaseline=M.textBaseline||"alphabetic",this.textAlign=M.textAlign||"left",this.lineWidth=M.lineWidth||1,this.lineJoin=M.lineJoin||"miter",this.lineCap=M.lineCap||"butt",this.path=M.path||[],this.transform=M.transform!==void 0?M.transform.clone():new u,this.globalCompositeOperation=M.globalCompositeOperation||"normal",this.globalAlpha=M.globalAlpha||1,this.clip_path=M.clip_path||[],this.currentPoint=M.currentPoint||new o,this.miterLimit=M.miterLimit||10,this.lastPoint=M.lastPoint||new o,this.lineDashOffset=M.lineDashOffset||0,this.lineDash=M.lineDash||[],this.margin=M.margin||[0,0,0,0],this.prevPageLastElemOffset=M.prevPageLastElemOffset||0,this.ignoreClearRect=typeof M.ignoreClearRect!="boolean"||M.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),r=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,l=new d}]);var f=function(M){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var G=M;Object.defineProperty(this,"pdf",{get:function(){return G}});var X=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return X},set:function(le){X=!!le}});var re=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return re},set:function(le){re=!!le}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(le){isNaN(le)||(V=le)}});var J=0;Object.defineProperty(this,"posY",{get:function(){return J},set:function(le){isNaN(le)||(J=le)}}),Object.defineProperty(this,"margin",{get:function(){return l.margin},set:function(le){var _e;typeof le=="number"?_e=[le,le,le,le]:((_e=new Array(4))[0]=le[0],_e[1]=le.length>=2?le[1]:_e[0],_e[2]=le.length>=3?le[2]:_e[0],_e[3]=le.length>=4?le[3]:_e[1]),l.margin=_e}});var W=!1;Object.defineProperty(this,"autoPaging",{get:function(){return W},set:function(le){W=le}});var F=0;Object.defineProperty(this,"lastBreak",{get:function(){return F},set:function(le){F=le}});var Q=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Q},set:function(le){Q=le}}),Object.defineProperty(this,"ctx",{get:function(){return l},set:function(le){le instanceof d&&(l=le)}}),Object.defineProperty(this,"path",{get:function(){return l.path},set:function(le){l.path=le}});var ne=[];Object.defineProperty(this,"ctxStack",{get:function(){return ne},set:function(le){ne=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var _e;_e=p(le),this.ctx.fillStyle=_e.style,this.ctx.isFillTransparent=_e.a===0,this.ctx.fillOpacity=_e.a,this.pdf.setFillColor(_e.r,_e.g,_e.b,{a:_e.a}),this.pdf.setTextColor(_e.r,_e.g,_e.b,{a:_e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var _e=p(le);this.ctx.strokeStyle=_e.style,this.ctx.isStrokeTransparent=_e.a===0,this.ctx.strokeOpacity=_e.a,_e.a===0?this.pdf.setDrawColor(255,255,255):(_e.a,this.pdf.setDrawColor(_e.r,_e.g,_e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var ie=null,ce=null,de=null;Object.defineProperty(this,"fontFaces",{get:function(){return de},set:function(le){ie=null,ce=null,de=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var _e;if(this.ctx.font=le,(_e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(le))!==null){var ue=_e[1];_e[2];var pe=_e[3],me=_e[4];_e[5];var Ce=_e[6],fe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(me)[2];me=Math.floor(fe==="px"?parseFloat(me)*this.pdf.internal.scaleFactor:fe==="em"?parseFloat(me)*this.pdf.getFontSize():parseFloat(me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(me);var xe=(function(it){var At,pt,nt=[],ht=it.trim();if(ht==="")return m5;if(ht in R9)return[R9[ht]];for(;ht!=="";){switch(pt=null,At=(ht=D9(ht)).charAt(0)){case'"':case"'":pt=Pbe(ht.substring(1),At);break;default:pt=Obe(ht)}if(pt===null||(nt.push(pt[0]),(ht=D9(pt[1]))!==""&&ht.charAt(0)!==","))return m5;ht=ht.replace(/^,/,"")}return nt})(Ce);if(this.fontFaces){var je=(function(it,At){var pt=it.getFontList(),nt=JSON.stringify(pt);if(ie===null||ce!==nt){var ht=(function(St){var ot=[];return Object.keys(St).forEach(function(Bt){St[Bt].forEach(function(Tt){var xt=null;switch(Tt){case"bold":xt={family:Bt,weight:"bold"};break;case"italic":xt={family:Bt,style:"italic"};break;case"bolditalic":xt={family:Bt,weight:"bold",style:"italic"};break;case"":case"normal":xt={family:Bt}}xt!==null&&(xt.ref={name:Bt,style:Tt},ot.push(xt))})}),ot})(pt);ie=(function(St){for(var ot={},Bt=0;Bt<St.length;++Bt){var Tt=p5(St[Bt]),xt=Tt.family,Kt=Tt.stretch,Pt=Tt.style,wt=Tt.weight;ot[xt]=ot[xt]||{},ot[xt][Kt]=ot[xt][Kt]||{},ot[xt][Kt][Pt]=ot[xt][Kt][Pt]||{},ot[xt][Kt][Pt][wt]=Tt}return ot})(ht.concat(At)),ce=nt}return ie})(this.pdf,this.fontFaces),Oe=xe.map(function(it){return{family:it,stretch:"normal",weight:pe,style:ue}}),Ie=(function(it,At,pt){for(var nt=(pt=pt||{}).defaultFontFamily||"times",ht=Object.assign({},Tbe,pt.genericFontFamilies||{}),St=null,ot=null,Bt=0;Bt<At.length;++Bt)if(ht[(St=p5(At[Bt])).family]&&(St.family=ht[St.family]),it.hasOwnProperty(St.family)){ot=it[St.family];break}if(!(ot=ot||it[nt]))throw new Error("Could not find a font-family for the rule '"+L9(St)+"' and default family '"+nt+"'.");if(ot=(function(Tt,xt){if(xt[Tt])return xt[Tt];var Kt=v4[Tt],Pt=Kt<=v4.normal?-1:1,wt=I9(xt,tB,Kt,Pt);if(!wt)throw new Error("Could not find a matching font-stretch value for "+Tt);return wt})(St.stretch,ot),ot=(function(Tt,xt){if(xt[Tt])return xt[Tt];for(var Kt=eB[Tt],Pt=0;Pt<Kt.length;++Pt)if(xt[Kt[Pt]])return xt[Kt[Pt]];throw new Error("Could not find a matching font-style for "+Tt)})(St.style,ot),!(ot=(function(Tt,xt){if(xt[Tt])return xt[Tt];if(Tt===400&&xt[500])return xt[500];if(Tt===500&&xt[400])return xt[400];var Kt=Ebe[Tt],Pt=I9(xt,rB,Kt,Tt<400?-1:1);if(!Pt)throw new Error("Could not find a matching font-weight for value "+Tt);return Pt})(St.weight,ot)))throw new Error("Failed to resolve a font for the rule '"+L9(St)+"'.");return ot})(je,Oe);this.pdf.setFont(Ie.ref.name,Ie.ref.style)}else{var Le="";(pe==="bold"||parseInt(pe,10)>=700||ue==="bold")&&(Le="bold"),ue==="italic"&&(Le+="italic"),Le.length===0&&(Le="normal");for(var He="",Qe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Je=0;Je<xe.length;Je++){if(this.pdf.internal.getFont(xe[Je],Le,{noFallback:!0,disableWarning:!0})!==void 0){He=xe[Je];break}if(Le==="bolditalic"&&this.pdf.internal.getFont(xe[Je],"bold",{noFallback:!0,disableWarning:!0})!==void 0)He=xe[Je],Le="bold";else if(this.pdf.internal.getFont(xe[Je],"normal",{noFallback:!0,disableWarning:!0})!==void 0){He=xe[Je],Le="normal";break}}if(He===""){for(var ct=0;ct<xe.length;ct++)if(Qe[xe[ct]]){He=Qe[xe[ct]];break}}He=He===""?"Times":He,this.pdf.setFont(He,Le)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};f.prototype.setLineDash=function(M){this.lineDash=M},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){_.call(this,"fill",!1)},f.prototype.stroke=function(){_.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(M,G){if(isNaN(M)||isNaN(G))throw Wn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var X=this.ctx.transform.applyToPoint(new o(M,G));this.path.push({type:"mt",x:X.x,y:X.y}),this.ctx.lastPoint=new o(M,G)},f.prototype.closePath=function(){var M=new o(0,0),G=0;for(G=this.path.length-1;G!==-1;G--)if(this.path[G].type==="begin"&&Dn(this.path[G+1])==="object"&&typeof this.path[G+1].x=="number"){M=new o(this.path[G+1].x,this.path[G+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(M.x,M.y)},f.prototype.lineTo=function(M,G){if(isNaN(M)||isNaN(G))throw Wn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var X=this.ctx.transform.applyToPoint(new o(M,G));this.path.push({type:"lt",x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},f.prototype.quadraticCurveTo=function(M,G,X,re){if(isNaN(X)||isNaN(re)||isNaN(M)||isNaN(G))throw Wn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new o(X,re)),J=this.ctx.transform.applyToPoint(new o(M,G));this.path.push({type:"qct",x1:J.x,y1:J.y,x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},f.prototype.bezierCurveTo=function(M,G,X,re,V,J){if(isNaN(V)||isNaN(J)||isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re))throw Wn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var W=this.ctx.transform.applyToPoint(new o(V,J)),F=this.ctx.transform.applyToPoint(new o(M,G)),Q=this.ctx.transform.applyToPoint(new o(X,re));this.path.push({type:"bct",x1:F.x,y1:F.y,x2:Q.x,y2:Q.y,x:W.x,y:W.y}),this.ctx.lastPoint=new o(W.x,W.y)},f.prototype.arc=function(M,G,X,re,V,J){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re)||isNaN(V))throw Wn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(J=!!J,!this.ctx.transform.isIdentity){var W=this.ctx.transform.applyToPoint(new o(M,G));M=W.x,G=W.y;var F=this.ctx.transform.applyToPoint(new o(0,X)),Q=this.ctx.transform.applyToPoint(new o(0,0));X=Math.sqrt(Math.pow(F.x-Q.x,2)+Math.pow(F.y-Q.y,2))}Math.abs(V-re)>=2*Math.PI&&(re=0,V=2*Math.PI),this.path.push({type:"arc",x:M,y:G,radius:X,startAngle:re,endAngle:V,counterclockwise:J})},f.prototype.arcTo=function(M,G,X,re,V){throw new Error("arcTo not implemented.")},f.prototype.rect=function(M,G,X,re){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re))throw Wn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(M,G),this.lineTo(M+X,G),this.lineTo(M+X,G+re),this.lineTo(M,G+re),this.lineTo(M,G),this.lineTo(M+X,G),this.lineTo(M,G)},f.prototype.fillRect=function(M,G,X,re){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re))throw Wn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(M,G,X,re),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},f.prototype.strokeRect=function(M,G,X,re){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re))throw Wn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(M,G,X,re),this.stroke())},f.prototype.clearRect=function(M,G,X,re){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re))throw Wn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(M,G,X,re))},f.prototype.save=function(M){M=typeof M!="boolean"||M;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("q");if(this.pdf.setPage(G),M){this.ctx.fontSize=this.pdf.internal.getFontSize();var re=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=re}},f.prototype.restore=function(M){M=typeof M!="boolean"||M;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,X=0;X<this.pdf.internal.getNumberOfPages();X++)this.pdf.setPage(X+1),this.pdf.internal.out("Q");this.pdf.setPage(G),M&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(M){var G,X,re,V;if(M.isCanvasGradient===!0&&(M=M.getColor()),!M)return{r:0,g:0,b:0,a:0,style:M};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(M))G=0,X=0,re=0,V=0;else{var J=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(M);if(J!==null)G=parseInt(J[1]),X=parseInt(J[2]),re=parseInt(J[3]),V=1;else if((J=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(M))!==null)G=parseInt(J[1]),X=parseInt(J[2]),re=parseInt(J[3]),V=parseFloat(J[4]);else{if(V=1,typeof M=="string"&&M.charAt(0)!=="#"){var W=new KF(M);M=W.ok?W.toHex():"#000000"}M.length===4?(G=M.substring(1,2),G+=G,X=M.substring(2,3),X+=X,re=M.substring(3,4),re+=re):(G=M.substring(1,3),X=M.substring(3,5),re=M.substring(5,7)),G=parseInt(G,16),X=parseInt(X,16),re=parseInt(re,16)}}return{r:G,g:X,b:re,a:V,style:M}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(M,G,X,re){if(isNaN(G)||isNaN(X)||typeof M!="string")throw Wn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(re=isNaN(re)?void 0:re,!h.call(this)){var V=S(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;z.call(this,{text:M,x:G,y:X,scale:J,angle:V,align:this.textAlign,maxWidth:re})}},f.prototype.strokeText=function(M,G,X,re){if(isNaN(G)||isNaN(X)||typeof M!="string")throw Wn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){re=isNaN(re)?void 0:re;var V=S(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;z.call(this,{text:M,x:G,y:X,scale:J,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:re})}},f.prototype.measureText=function(M){if(typeof M!="string")throw Wn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var G=this.pdf,X=this.pdf.internal.scaleFactor,re=G.internal.getFontSize(),V=G.getStringUnitWidth(M)*re/G.internal.scaleFactor;return new function(J){var W=(J=J||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return W}}),this}({width:V*=Math.round(96*X/72*1e4)/1e4})},f.prototype.scale=function(M,G){if(isNaN(M)||isNaN(G))throw Wn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var X=new u(M,0,0,G,0,0);this.ctx.transform=this.ctx.transform.multiply(X)},f.prototype.rotate=function(M){if(isNaN(M))throw Wn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var G=new u(Math.cos(M),Math.sin(M),-Math.sin(M),Math.cos(M),0,0);this.ctx.transform=this.ctx.transform.multiply(G)},f.prototype.translate=function(M,G){if(isNaN(M)||isNaN(G))throw Wn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var X=new u(1,0,0,1,M,G);this.ctx.transform=this.ctx.transform.multiply(X)},f.prototype.transform=function(M,G,X,re,V,J){if(isNaN(M)||isNaN(G)||isNaN(X)||isNaN(re)||isNaN(V)||isNaN(J))throw Wn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var W=new u(M,G,X,re,V,J);this.ctx.transform=this.ctx.transform.multiply(W)},f.prototype.setTransform=function(M,G,X,re,V,J){M=isNaN(M)?1:M,G=isNaN(G)?0:G,X=isNaN(X)?0:X,re=isNaN(re)?1:re,V=isNaN(V)?0:V,J=isNaN(J)?0:J,this.ctx.transform=new u(M,G,X,re,V,J)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(M,G,X,re,V,J,W,F,Q){var ne=this.pdf.getImageProperties(M),ie=1,ce=1,de=1,le=1;re!==void 0&&F!==void 0&&(de=F/re,le=Q/V,ie=ne.width/re*F/re,ce=ne.height/V*Q/V),J===void 0&&(J=G,W=X,G=0,X=0),re!==void 0&&F===void 0&&(F=re,Q=V),re===void 0&&F===void 0&&(F=ne.width,Q=ne.height);var _e=this.ctx.transform.decompose(),ue=S(_e.rotate.shx),pe=new u,me=(pe=(pe=(pe=pe.multiply(_e.translate)).multiply(_e.skew)).multiply(_e.scale)).applyToRectangle(new c(J-G*de,W-X*le,re*ie,V*ce));if(this.autoPaging){for(var Ce,fe=m.call(this,me),xe=[],je=0;je<fe.length;je+=1)xe.indexOf(fe[je])===-1&&xe.push(fe[je]);w(xe);for(var Oe=xe[0],Ie=xe[xe.length-1],Le=Oe;Le<Ie+1;Le++){this.pdf.setPage(Le);var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qe=Le===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],it=Le===1?0:Je+(Le-2)*ct;if(this.ctx.clip_path.length!==0){var At=this.path;Ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Ce,this.posX+this.margin[3],-it+Qe+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=At}var pt=JSON.parse(JSON.stringify(me));pt=v([pt],this.posX+this.margin[3],-it+Qe+this.ctx.prevPageLastElemOffset)[0];var nt=(Le>Oe||Le<Ie)&&g.call(this);nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,ct,null).clip().discardPath()),this.pdf.addImage(M,"JPEG",pt.x,pt.y,pt.w,pt.h,null,null,ue),nt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(M,"JPEG",me.x,me.y,me.w,me.h,null,null,ue)};var m=function(M,G,X){var re=[];G=G||this.pdf.internal.pageSize.width,X=X||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(M.type){default:case"mt":case"lt":re.push(Math.floor((M.y+V)/X)+1);break;case"arc":re.push(Math.floor((M.y+V-M.radius)/X)+1),re.push(Math.floor((M.y+V+M.radius)/X)+1);break;case"qct":var J=C(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x,M.y);re.push(Math.floor((J.y+V)/X)+1),re.push(Math.floor((J.y+J.h+V)/X)+1);break;case"bct":var W=D(this.ctx.lastPoint.x,this.ctx.lastPoint.y,M.x1,M.y1,M.x2,M.y2,M.x,M.y);re.push(Math.floor((W.y+V)/X)+1),re.push(Math.floor((W.y+W.h+V)/X)+1);break;case"rect":re.push(Math.floor((M.y+V)/X)+1),re.push(Math.floor((M.y+M.h+V)/X)+1)}for(var F=0;F<re.length;F+=1)for(;this.pdf.internal.getNumberOfPages()<re[F];)x.call(this);return re},x=function(){var M=this.fillStyle,G=this.strokeStyle,X=this.font,re=this.lineCap,V=this.lineWidth,J=this.lineJoin;this.pdf.addPage(),this.fillStyle=M,this.strokeStyle=G,this.font=X,this.lineCap=re,this.lineWidth=V,this.lineJoin=J},v=function(M,G,X){for(var re=0;re<M.length;re++)switch(M[re].type){case"bct":M[re].x2+=G,M[re].y2+=X;case"qct":M[re].x1+=G,M[re].y1+=X;default:M[re].x+=G,M[re].y+=X}return M},w=function(M){return M.sort(function(G,X){return G-X})},_=function(M,G){var X=this.fillStyle,re=this.strokeStyle,V=this.lineCap,J=this.lineWidth,W=Math.abs(J*this.ctx.transform.scaleX),F=this.lineJoin;if(this.autoPaging){for(var Q,ne,ie=JSON.parse(JSON.stringify(this.path)),ce=JSON.parse(JSON.stringify(this.path)),de=[],le=0;le<ce.length;le++)if(ce[le].x!==void 0)for(var _e=m.call(this,ce[le]),ue=0;ue<_e.length;ue+=1)de.indexOf(_e[ue])===-1&&de.push(_e[ue]);for(var pe=0;pe<de.length;pe++)for(;this.pdf.internal.getNumberOfPages()<de[pe];)x.call(this);w(de);for(var me=de[0],Ce=de[de.length-1],fe=me;fe<Ce+1;fe++){this.pdf.setPage(fe),this.fillStyle=X,this.strokeStyle=re,this.lineCap=V,this.lineWidth=W,this.lineJoin=F;var xe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],je=fe===1?this.posY+this.margin[0]:this.margin[0],Oe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ie=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Le=fe===1?0:Oe+(fe-2)*Ie;if(this.ctx.clip_path.length!==0){var He=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Q,this.posX+this.margin[3],-Le+je+this.ctx.prevPageLastElemOffset),A.call(this,M,!0),this.path=He}if(ne=JSON.parse(JSON.stringify(ie)),this.path=v(ne,this.posX+this.margin[3],-Le+je+this.ctx.prevPageLastElemOffset),G===!1||fe===0){var Qe=(fe>me||fe<Ce)&&g.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xe,Ie,null).clip().discardPath()),A.call(this,M,G),Qe&&this.pdf.restoreGraphicsState()}this.lineWidth=J}this.path=ie}else this.lineWidth=W,A.call(this,M,G),this.lineWidth=J},A=function(M,G){if((M!=="stroke"||G||!y.call(this))&&(M==="stroke"||G||!h.call(this))){for(var X,re,V=[],J=this.path,W=0;W<J.length;W++){var F=J[W];switch(F.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:F,deltas:[],abs:[]});break;case"lt":var Q=V.length;if(J[W-1]&&!isNaN(J[W-1].x)&&(X=[F.x-J[W-1].x,F.y-J[W-1].y],Q>0)){for(;Q>=0;Q--)if(V[Q-1].close!==!0&&V[Q-1].begin!==!0){V[Q-1].deltas.push(X),V[Q-1].abs.push(F);break}}break;case"bct":X=[F.x1-J[W-1].x,F.y1-J[W-1].y,F.x2-J[W-1].x,F.y2-J[W-1].y,F.x-J[W-1].x,F.y-J[W-1].y],V[V.length-1].deltas.push(X);break;case"qct":var ne=J[W-1].x+2/3*(F.x1-J[W-1].x),ie=J[W-1].y+2/3*(F.y1-J[W-1].y),ce=F.x+2/3*(F.x1-F.x),de=F.y+2/3*(F.y1-F.y),le=F.x,_e=F.y;X=[ne-J[W-1].x,ie-J[W-1].y,ce-J[W-1].x,de-J[W-1].y,le-J[W-1].x,_e-J[W-1].y],V[V.length-1].deltas.push(X);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(F)}}re=G?null:M==="stroke"?"stroke":"fill";for(var ue=!1,pe=0;pe<V.length;pe++)if(V[pe].arc)for(var me=V[pe].abs,Ce=0;Ce<me.length;Ce++){var fe=me[Ce];fe.type==="arc"?T.call(this,fe.x,fe.y,fe.radius,fe.startAngle,fe.endAngle,fe.counterclockwise,void 0,G,!ue):O.call(this,fe.x,fe.y),ue=!0}else if(V[pe].close===!0)this.pdf.internal.out("h"),ue=!1;else if(V[pe].begin!==!0){var xe=V[pe].start.x,je=V[pe].start.y;L.call(this,V[pe].deltas,xe,je),ue=!0}re&&I.call(this,re),G&&U.call(this)}},P=function(M){var G=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,X=G*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return M-X;case"top":return M+G-X;case"hanging":return M+G-2*X;case"middle":return M+G/2-X;default:return M}},B=function(M){return M+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var M=function(){};return M.colorStops=[],M.addColorStop=function(G,X){this.colorStops.push([G,X])},M.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},M.isCanvasGradient=!0,M},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(M,G,X,re,V,J,W,F,Q){for(var ne=k.call(this,X,re,V,J),ie=0;ie<ne.length;ie++){var ce=ne[ie];ie===0&&(Q?H.call(this,ce.x1+M,ce.y1+G):O.call(this,ce.x1+M,ce.y1+G)),E.call(this,M,G,ce.x2,ce.y2,ce.x3,ce.y3,ce.x4,ce.y4)}F?U.call(this):I.call(this,W)},I=function(M){switch(M){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},H=function(M,G){this.pdf.internal.out(t(M)+" "+n(G)+" m")},z=function(M){var G;switch(M.align){case"right":case"end":G="right";break;case"center":G="center";break;default:G="left"}var X,re,V,J=this.pdf.getTextDimensions(M.text),W=P.call(this,M.y),F=B.call(this,W)-J.h,Q=this.ctx.transform.applyToPoint(new o(M.x,W));if(this.autoPaging){var ne=this.ctx.transform.decompose(),ie=new u;ie=(ie=(ie=ie.multiply(ne.translate)).multiply(ne.skew)).multiply(ne.scale);for(var ce=this.ctx.transform.applyToRectangle(new c(M.x,W,J.w,J.h)),de=ie.applyToRectangle(new c(M.x,F,J.w,J.h)),le=m.call(this,de),_e=[],ue=0;ue<le.length;ue+=1)_e.indexOf(le[ue])===-1&&_e.push(le[ue]);w(_e);for(var pe=_e[0],me=_e[_e.length-1],Ce=pe;Ce<me+1;Ce++){this.pdf.setPage(Ce);var fe=Ce===1?this.posY+this.margin[0]:this.margin[0],xe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],je=this.pdf.internal.pageSize.height-this.margin[2],Oe=je-this.margin[0],Ie=this.pdf.internal.pageSize.width-this.margin[1],Le=Ie-this.margin[3],He=Ce===1?0:xe+(Ce-2)*Oe;if(this.ctx.clip_path.length!==0){var Qe=this.path;X=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(X,this.posX+this.margin[3],-1*He+fe),A.call(this,"fill",!0),this.path=Qe}var Je=v([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-He+fe+this.ctx.prevPageLastElemOffset)[0];M.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*M.scale),V=this.lineWidth,this.lineWidth=V*M.scale);var ct=this.autoPaging!=="text";if(ct||Je.y+Je.h<=je){if(ct||Je.y>=fe&&Je.x<=Ie){var it=ct?M.text:this.pdf.splitTextToSize(M.text,M.maxWidth||Ie-Je.x)[0],At=v([JSON.parse(JSON.stringify(ce))],this.posX+this.margin[3],-He+fe+this.ctx.prevPageLastElemOffset)[0],pt=ct&&(Ce>pe||Ce<me)&&g.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Le,Oe,null).clip().discardPath()),this.pdf.text(it,At.x,At.y,{angle:M.angle,align:G,renderingMode:M.renderingMode}),pt&&this.pdf.restoreGraphicsState()}}else Je.y<je&&(this.ctx.prevPageLastElemOffset+=je-Je.y);M.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=V)}}else M.scale>=.01&&(re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(re*M.scale),V=this.lineWidth,this.lineWidth=V*M.scale),this.pdf.text(M.text,Q.x+this.posX,Q.y+this.posY,{angle:M.angle,align:G,renderingMode:M.renderingMode,maxWidth:M.maxWidth}),M.scale>=.01&&(this.pdf.setFontSize(re),this.lineWidth=V)},O=function(M,G,X,re){X=X||0,re=re||0,this.pdf.internal.out(t(M+X)+" "+n(G+re)+" l")},L=function(M,G,X){return this.pdf.lines(M,G,X,null,null)},E=function(M,G,X,re,V,J,W,F){this.pdf.internal.out([r(a(X+M)),r(i(re+G)),r(a(V+M)),r(i(J+G)),r(a(W+M)),r(i(F+G)),"c"].join(" "))},k=function(M,G,X,re){for(var V=2*Math.PI,J=Math.PI/2;G>X;)G-=V;var W=Math.abs(X-G);W<V&&re&&(W=V-W);for(var F=[],Q=re?-1:1,ne=G;W>1e-5;){var ie=ne+Q*Math.min(W,J);F.push(N.call(this,M,ne,ie)),W-=Math.abs(ie-ne),ne=ie}return F},N=function(M,G,X){var re=(X-G)/2,V=M*Math.cos(re),J=M*Math.sin(re),W=V,F=-J,Q=W*W+F*F,ne=Q+W*V+F*J,ie=4/3*(Math.sqrt(2*Q*ne)-ne)/(W*J-F*V),ce=W-ie*F,de=F+ie*W,le=ce,_e=-de,ue=re+G,pe=Math.cos(ue),me=Math.sin(ue);return{x1:M*Math.cos(G),y1:M*Math.sin(G),x2:ce*pe-de*me,y2:ce*me+de*pe,x3:le*pe-_e*me,y3:le*me+_e*pe,x4:M*Math.cos(X),y4:M*Math.sin(X)}},S=function(M){return 180*M/Math.PI},C=function(M,G,X,re,V,J){var W=M+.5*(X-M),F=G+.5*(re-G),Q=V+.5*(X-V),ne=J+.5*(re-J),ie=Math.min(M,V,W,Q),ce=Math.max(M,V,W,Q),de=Math.min(G,J,F,ne),le=Math.max(G,J,F,ne);return new c(ie,de,ce-ie,le-de)},D=function(M,G,X,re,V,J,W,F){var Q,ne,ie,ce,de,le,_e,ue,pe,me,Ce,fe,xe,je,Oe=X-M,Ie=re-G,Le=V-X,He=J-re,Qe=W-V,Je=F-J;for(ne=0;ne<41;ne++)pe=(_e=(ie=M+(Q=ne/40)*Oe)+Q*((de=X+Q*Le)-ie))+Q*(de+Q*(V+Q*Qe-de)-_e),me=(ue=(ce=G+Q*Ie)+Q*((le=re+Q*He)-ce))+Q*(le+Q*(J+Q*Je-le)-ue),ne==0?(Ce=pe,fe=me,xe=pe,je=me):(Ce=Math.min(Ce,pe),fe=Math.min(fe,me),xe=Math.max(xe,pe),je=Math.max(je,me));return new c(Math.round(Ce),Math.round(fe),Math.round(xe-Ce),Math.round(je-fe))},q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var M,G,X=(M=this.ctx.lineDash,G=this.ctx.lineDashOffset,JSON.stringify({lineDash:M,lineDashOffset:G}));this.prevLineDash!==X&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=X)}}})(mr.API),(function(e){var r=function(o){var c,u,l,d,f,p,h,y,g,m;for(u=[],l=0,d=(o+=c="\0\0\0\0".slice(o.length%4||4)).length;d>l;l+=4)(f=(o.charCodeAt(l)<<24)+(o.charCodeAt(l+1)<<16)+(o.charCodeAt(l+2)<<8)+o.charCodeAt(l+3))!==0?(p=(f=((f=((f=((f=(f-(m=f%85))/85)-(g=f%85))/85)-(y=f%85))/85)-(h=f%85))/85)%85,u.push(p+33,h+33,y+33,g+33,m+33)):u.push(122);return(function(x,v){for(var w=v;w>0;w--)x.pop()})(u,c.length),String.fromCharCode.apply(String,u)+"~>"},t=function(o){var c,u,l,d,f,p=String,h="length",y=255,g="charCodeAt",m="slice",x="replace";for(o[m](-2),o=o[m](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),l=[],d=0,f=(o+=c="uuuuu"[m](o[h]%5||5))[h];f>d;d+=5)u=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),l.push(y&u>>24,y&u>>16,y&u>>8,y&u);return(function(v,w){for(var _=w;_>0;_--)v.pop()})(l,c[h]),p.fromCharCode.apply(p,l)},n=function(o){return o.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var c=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),c.test(o)===!1)return"";for(var u="",l=0;l<o.length;l+=2)u+=String.fromCharCode("0x"+(o[l]+o[l+1]));return u},i=function(o){for(var c=new Uint8Array(o.length),u=o.length;u--;)c[u]=o.charCodeAt(u);return(c=h4(c)).reduce(function(l,d){return l+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,c){var u=0,l=o||"",d=[];for(typeof(c=c||[])=="string"&&(c=[c]),u=0;u<c.length;u+=1)switch(c[u]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=r(l),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=a(l),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=n(l),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+c[u]+'" is not implemented')}return{data:l,reverseChain:d.reverse().join(" ")}}})(mr.API),(function(e){e.loadFile=function(r,t,n){return(function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=(function(u,l,d){var f=new XMLHttpRequest,p=0,h=function(y){var g=y.length,m=[],x=String.fromCharCode;for(p=0;p<g;p+=1)m.push(x(255&y.charCodeAt(p)));return m.join("")};if(f.open("GET",u,!l),f.overrideMimeType("text/plain; charset=x-user-defined"),l===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),l&&f.status===200)return h(f.responseText)})(a,i,o)}catch{}return c})(r,t,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile})(mr.API),(function(e){function r(){return(Ir.html2canvas?Promise.resolve(Ir.html2canvas):Y_(()=>import("./html2canvas.esm-DXEQVQnt.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load html2canvas: "+c))}).then(function(c){return c.default?c.default:c})}function t(){return(Ir.DOMPurify?Promise.resolve(Ir.DOMPurify):Y_(()=>import("./purify.es-Bzr520pe.js"),[])).catch(function(c){return Promise.reject(new Error("Could not load dompurify: "+c))}).then(function(c){return c.default?c.default:c})}var n=function(c){var u=Dn(c);return u==="undefined"?"undefined":u==="string"||c instanceof String?"string":u==="number"||c instanceof Number?"number":u==="function"||c instanceof Function?"function":c&&c.constructor===Array?"array":c&&c.nodeType===1?"element":u==="object"?"object":"unknown"},a=function(c,u){var l=document.createElement(c);for(var d in u.className&&(l.className=u.className),u.innerHTML&&u.dompurify&&(l.innerHTML=u.dompurify.sanitize(u.innerHTML)),u.style)l.style[d]=u.style[d];return l},i=function c(u,l){for(var d=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),f=u.firstChild;f;f=f.nextSibling)l!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(c(f,l));return u.nodeType===1&&(u.nodeName==="CANVAS"?(d.width=u.width,d.height=u.height,d.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(d.value=u.value),d.addEventListener("load",function(){d.scrollTop=u.scrollTop,d.scrollLeft=u.scrollLeft},!0)),d},o=function c(u){var l=Object.assign(c.convert(Promise.resolve()),JSON.parse(JSON.stringify(c.template))),d=c.convert(Promise.resolve(),l);return(d=d.setProgress(1,c,1,[c])).set(u)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(c,u){return c.__proto__=u||o.prototype,c},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(c,u){return this.then(function(){switch(u=u||(function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(c),u){case"string":return this.then(t).then(function(l){return this.set({src:a("div",{innerHTML:c,dompurify:l})})});case"element":return this.set({src:c});case"canvas":return this.set({canvas:c});case"img":return this.set({img:c});default:return this.error("Unknown source type.")}})},o.prototype.to=function(c){switch(c){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var c={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},u=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);u.tagName==="BODY"&&(c.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:c}),this.prop.container.appendChild(u),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(r).then(function(u){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,u(this.prop.container,l)}).then(function(u){(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var c=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(c).then(r).then(function(u){var l=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var y=d[h],g=y.src.find(function(m){return m.format==="truetype"});g&&l.addFont(g.url,y.ref.name,y.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,l.context2d.save(!0),u(this.prop.container,p)}).then(function(u){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(u),this.prop.canvas=u,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var c=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=c})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(c,u,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(c,u):this.outputPdf(c,u)},o.prototype.outputPdf=function(c,u){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(c,u)})},o.prototype.outputImg=function(c){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(c){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+c+'" is not supported.'}})},o.prototype.save=function(c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(c?{filename:c}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(c){if(n(c)!=="object")return this;var u=Object.keys(c||{}).map(function(l){if(l in o.template.prop)return function(){this.prop[l]=c[l]};switch(l){case"margin":return this.setMargin.bind(this,c.margin);case"jsPDF":return function(){return this.opt.jsPDF=c.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,c.pageSize);default:return function(){this.opt[l]=c[l]}}},this);return this.then(function(){return this.thenList(u)})},o.prototype.get=function(c,u){return this.then(function(){var l=c in o.template.prop?this.prop[c]:this.opt[c];return u?u(l):l})},o.prototype.setMargin=function(c){return this.then(function(){switch(n(c)){case"number":c=[c,c,c,c];case"array":if(c.length===2&&(c=[c[0],c[1],c[0],c[1]]),c.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=c}).then(this.setPageSize)},o.prototype.setPageSize=function(c){function u(l,d){return Math.floor(l*d/72*96)}return this.then(function(){(c=c||mr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(c.inner={width:c.width-this.opt.margin[1]-this.opt.margin[3],height:c.height-this.opt.margin[0]-this.opt.margin[2]},c.inner.px={width:u(c.inner.width,c.k),height:u(c.inner.height,c.k)},c.inner.ratio=c.inner.height/c.inner.width),this.prop.pageSize=c})},o.prototype.setProgress=function(c,u,l,d){return c!=null&&(this.progress.val=c),u!=null&&(this.progress.state=u),l!=null&&(this.progress.n=l),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(c,u,l,d){return this.setProgress(c?this.progress.val+c:null,u||null,l?this.progress.n+l:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(c,u){var l=this;return this.thenCore(c,u,function(d,f){return l.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return l.updateProgress(null,d),p}).then(d,f).then(function(p){return l.updateProgress(1),p})})},o.prototype.thenCore=function(c,u,l){l=l||Promise.prototype.then;var d=this;c&&(c=c.bind(d)),u&&(u=u.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),p=l.call(f,c,u);return o.convert(p,d.__proto__)},o.prototype.thenExternal=function(c,u){return Promise.prototype.then.call(this,c,u)},o.prototype.thenList=function(c){var u=this;return c.forEach(function(l){u=u.thenCore(l)}),u},o.prototype.catch=function(c){c&&(c=c.bind(this));var u=Promise.prototype.catch.call(this,c);return o.convert(u,this)},o.prototype.catchExternal=function(c){return Promise.prototype.catch.call(this,c)},o.prototype.error=function(c){return this.then(function(){throw new Error(c)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,mr.getPageSize=function(c,u,l){if(Dn(c)==="object"){var d=c;c=d.orientation,u=d.unit||u,l=d.format||l}u=u||"mm",l=l||"a4",c=(""+(c||"P")).toLowerCase();var f,p=(""+l).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(u){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+u}var y,g=0,m=0;if(h.hasOwnProperty(p))g=h[p][1]/f,m=h[p][0]/f;else try{g=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(c==="p"||c==="portrait")c="p",m>g&&(y=m,m=g,g=y);else{if(c!=="l"&&c!=="landscape")throw"Invalid orientation: "+c;c="l",g>m&&(y=m,m=g,g=y)}return{width:m,height:g,unit:u,k:f,orientation:c}},e.html=function(c,u){(u=u||{}).callback=u.callback||function(){},u.html2canvas=u.html2canvas||{},u.html2canvas.canvas=u.html2canvas.canvas||this.canvas,u.jsPDF=u.jsPDF||this,u.fontFaces=u.fontFaces?u.fontFaces.map(p5):null;var l=new o(u);return u.worker?l:l.from(c).doCallback()}})(mr.API),mr.API.addJS=function(e){return B9=e,this.internal.events.subscribe("postPutResources",function(){zx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(zx+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),F9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+B9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){zx!==void 0&&F9!==void 0&&this.internal.out("/Names <</JavaScript "+zx+" 0 R>>")}),this},(function(e){var r;e.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],c=n.exec(o);if(c!=null){var u=c[1];t.internal.newObjectDeferredBegin(u,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,d=[];for(i=0;i<l;i++){var f=t.internal.newObject();d.push(f);var p=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<d.length;i++)t.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");t.internal.write(" ] >>","endobj"),r=t.internal.newObject(),t.internal.write("<< /Dests "+h+" 0 R"),t.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+r+" 0 R"))}]),e.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,i){var o={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var l=0;l<n.children.length;l++)this.renderItems(n.children[l])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])})(mr.API),(function(e){var r=[192,193,194,195,196,197,198,199];e.processJPEG=function(t,n,a,i,o,c){var u,l=this.decode.DCT_DECODE,d=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,u=(function(f){for(var p,h=256*f.charCodeAt(4)+f.charCodeAt(5),y=f.length,g={width:0,height:0,numcomponents:1},m=4;m<y;m+=2){if(m+=h,r.indexOf(f.charCodeAt(m+1))!==-1){p=256*f.charCodeAt(m+5)+f.charCodeAt(m+6),g={width:256*f.charCodeAt(m+7)+f.charCodeAt(m+8),height:p,numcomponents:f.charCodeAt(m+9)};break}h=256*f.charCodeAt(m+2)+f.charCodeAt(m+3)}return g})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),u.numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}d={data:t,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:l,index:n,alias:a}}return d}})(mr.API),mr.API.processPNG=function(e,r,t,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=mbe(e,{checkCrc:!0}),o=i.width,c=i.height,u=i.channels,l=i.palette,d=i.depth;a=l&&u===1?(function(T){for(var I=T.width,U=T.height,H=T.data,z=T.palette,O=T.depth,L=!1,E=[],k=[],N=void 0,S=!1,C=0,D=0;D<z.length;D++){var q=UT(z[D],4),M=q[0],G=q[1],X=q[2],re=q[3];E.push(M,G,X),re!=null&&(re===0?(C++,k.length<1&&k.push(D)):re<255&&(S=!0))}if(S||C>1){L=!0,k=void 0;var V=I*U;N=new Uint8Array(V);for(var J=new DataView(H.buffer),W=0;W<V;W++){var F=g5(J,W,O),Q=UT(z[F],4)[3];N[W]=Q}}else C===0&&(k=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:L?8:void 0,colorBytes:H,alphaBytes:N,needSMask:L,palette:E,mask:k}})(i):u===2||u===4?(function(T){for(var I=T.data,U=T.width,H=T.height,z=T.channels,O=T.depth,L=z===2?"DeviceGray":"DeviceRGB",E=z-1,k=U*H,N=E,S=k*N,C=1*k,D=Math.ceil(S*O/8),q=Math.ceil(C*O/8),M=new Uint8Array(D),G=new Uint8Array(q),X=new DataView(I.buffer),re=new DataView(M.buffer),V=new DataView(G.buffer),J=!1,W=0;W<k;W++){for(var F=W*z,Q=0;Q<N;Q++)G9(re,g5(X,F+Q,O),W*N+Q,O);var ne=g5(X,F+N,O);ne<(1<<O)-1&&(J=!0),G9(V,ne,1*W,O)}return{colorSpace:L,colorsPerPixel:E,sMaskBitsPerComponent:J?O:void 0,colorBytes:M,alphaBytes:G,needSMask:J}})(i):(function(T){var I=T.data,U=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:U,colorsPerPixel:U==="DeviceGray"?1:3,colorBytes:I instanceof Uint16Array?(function(H){for(var z=H.length,O=new Uint8Array(2*z),L=new DataView(O.buffer,O.byteOffset,O.byteLength),E=0;E<z;E++)L.setUint16(2*E,H[E],!1);return O})(I):I,needSMask:!1}})(i);var f,p,h,y=a,g=y.colorSpace,m=y.colorsPerPixel,x=y.sMaskBitsPerComponent,v=y.colorBytes,w=y.alphaBytes,_=y.needSMask,A=y.palette,P=y.mask,B=null;return n!==mr.API.image_compression.NONE&&typeof h4=="function"?(B=(function(T){var I;switch(T){case mr.API.image_compression.FAST:I=11;break;case mr.API.image_compression.MEDIUM:I=13;break;case mr.API.image_compression.SLOW:I=14;break;default:I=12}return I})(n),f=this.decode.FLATE_DECODE,p="/Predictor ".concat(B," /Colors ").concat(m," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=U9(v,Math.ceil(o*m*d/8),m,d,n),_&&(h=U9(w,Math.ceil(o*x/8),1,x,n))):(f=void 0,p=void 0,e=v,_&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:t,data:e,index:r,filter:f,decodeParameters:p,transparency:P,palette:A,sMask:h,predictor:B,width:o,height:c,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:g}}},(function(e){e.processGIF89A=function(r,t,n,a){var i=new Lbe(r),o=i.width,c=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var l={data:u,width:o,height:c},d=new y5(100).encode(l,100);return e.processJPEG.call(this,d,t,n,a)},e.processGIF87A=e.processGIF89A})(mr.API),Zl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var r=0;r<e;r++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:a,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Zl.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[e]()}catch(t){Wn.log("bit decode error:"+t)}},Zl.prototype.bit1=function(){var e,r=Math.ceil(this.width/8),t=r%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<r;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,c=0;c<8&&8*a+c<this.width;c++){var u=this.palette[i>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}t!==0&&(this.pos+=4-t)}},Zl.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),r=e%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,c=i>>4,u=15&i,l=this.palette[c];if(this.data[o]=l.blue,this.data[o+1]=l.green,this.data[o+2]=l.red,this.data[o+3]=255,2*a+1>=this.width)break;l=this.palette[u],this.data[o+4]=l.blue,this.data[o+4+1]=l.green,this.data[o+4+2]=l.red,this.data[o+4+3]=255}r!==0&&(this.pos+=4-r)}},Zl.prototype.bit8=function(){for(var e=this.width%4,r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Zl.prototype.bit15=function(){for(var e=this.width%3,r=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&r)/r*255|0,c=(i>>5&r)/r*255|0,u=(i>>10&r)/r*255|0,l=i>>15?255:0,d=n*this.width*4+4*a;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=l}this.pos+=e}},Zl.prototype.bit16=function(){for(var e=this.width%3,r=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&r)/r*255|0,u=(o>>5&t)/t*255|0,l=(o>>11)/r*255|0,d=a*this.width*4+4*i;this.data[d]=l,this.data[d+1]=u,this.data[d+2]=c,this.data[d+3]=255}this.pos+=e}},Zl.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*t;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Zl.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var r=this.bottom_up?e:this.height-1-e,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+4*t;this.data[c]=i,this.data[c+1]=a,this.data[c+2]=n,this.data[c+3]=o}},Zl.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(r,t,n,a){var i=new Zl(r,!1),o=i.width,c=i.height,u={data:i.getData(),width:o,height:c},l=new y5(100).encode(u,100);return e.processJPEG.call(this,l,t,n,a)}})(mr.API),Y9.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(r,t,n,a){var i=new Y9(r),o=i.width,c=i.height,u={data:i.getData(),width:o,height:c},l=new y5(100).encode(u,100);return e.processJPEG.call(this,l,t,n,a)}})(mr.API),mr.API.processRGBA=function(e,r,t){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),c=0,u=0,l=0;l<a;l+=4){var d=n[l],f=n[l+1],p=n[l+2],h=n[l+3];i[c++]=d,i[c++]=f,i[c++]=p,o[u++]=h}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:y,index:r,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Vp=mr.API,Ux=Vp.getCharWidthsArray=function(e,r){var t,n,a=(r=r||{}).font||this.internal.getFont(),i=r.fontSize||this.internal.getFontSize(),o=r.charSpace||this.internal.getCharSpace(),c=r.widths?r.widths:a.metadata.Unicode.widths,u=c.fof?c.fof:1,l=r.kerning?r.kerning:a.metadata.Unicode.kerning,d=l.fof?l.fof:1,f=r.doKerning!==!1,p=0,h=e.length,y=0,g=c[0]||u,m=[];for(t=0;t<h;t++)n=e.charCodeAt(t),typeof a.metadata.widthOfString=="function"?m.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(p=f&&Dn(l[n])==="object"&&!isNaN(parseInt(l[n][y],10))?l[n][y]/d:0,m.push((c[n]||g)/u+p)),y=n;return m},$9=Vp.getStringUnitWidth=function(e,r){var t=(r=r||{}).fontSize||this.internal.getFontSize(),n=r.font||this.internal.getFont(),a=r.charSpace||this.internal.getCharSpace();return Vp.processArabic&&(e=Vp.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,t,a)/t:Ux.apply(this,arguments).reduce(function(i,o){return i+o},0)},q9=function(e,r,t,n){for(var a=[],i=0,o=e.length,c=0;i!==o&&c+r[i]<t;)c+=r[i],i++;a.push(e.slice(0,i));var u=i;for(c=0;i!==o;)c+r[i]>n&&(a.push(e.slice(u,i)),c=0,u=i),c+=r[i],i++;return u!==i&&a.push(e.slice(u,i)),a},z9=function(e,r,t){t||(t={});var n,a,i,o,c,u,l,d=[],f=[d],p=t.textIndent||0,h=0,y=0,g=e.split(" "),m=Ux.apply(this,[" ",t])[0];if(u=t.lineIndent===-1?g[0].length+2:t.lineIndent||0){var x=Array(u).join(" "),v=[];g.map(function(_){(_=_.split(/\s*\n/)).length>1?v=v.concat(_.map(function(A,P){return(P&&A.length?`
`:"")+A})):v.push(_[0])}),g=v,u=$9.apply(this,[x,t])}for(i=0,o=g.length;i<o;i++){var w=0;if(n=g[i],u&&n[0]==`
`&&(n=n.substr(1),w=1),p+h+(y=(a=Ux.apply(this,[n,t])).reduce(function(_,A){return _+A},0))>r||w){if(y>r){for(c=q9.apply(this,[n,a,r-(p+h),r]),d.push(c.shift()),d=[c.pop()];c.length;)f.push([c.shift()]);y=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(_,A){return _+A},0)}else d=[n];f.push(d),p=y+u,h=m}else d.push(n),p+=h+y,h=m}return l=u?function(_,A){return(A?x:"")+_.join(" ")}:function(_){return _.join(" ")},f.map(l)},Vp.splitTextToSize=function(e,r,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),p="Unicode";return f.metadata[p]?{widths:f.metadata[p].widths||{0:1},kerning:f.metadata[p].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*r/a;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=t.lineIndent;var c,u,l=[];for(c=0,u=n.length;c<u;c++)l=l.concat(z9.apply(this,[n[c],o,i]));return l},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var r="0123456789abcdef",t="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[t[i]]=r[i],a[r[i]]=t[i];var o=function(p){return"0x"+parseInt(p,10).toString(16)},c=e.__fontmetrics__.compress=function(p){var h,y,g,m,x=["{"];for(var v in p){if(h=p[v],isNaN(parseInt(v,10))?y="'"+v+"'":(v=parseInt(v,10),y=(y=o(v).slice(2)).slice(0,-1)+a[y.slice(-1)]),typeof h=="number")h<0?(g=o(h).slice(3),m="-"):(g=o(h).slice(2),m=""),g=m+g.slice(0,-1)+a[g.slice(-1)];else{if(Dn(h)!=="object")throw new Error("Don't know what to do with value type "+Dn(h)+".");g=c(h)}x.push(y+g)}return x.push("}"),x.join("")},u=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,y,g,m,x={},v=1,w=x,_=[],A="",P="",B=p.length-1,T=1;T<B;T+=1)(m=p[T])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(m):m=="{"?(_.push([w,g]),w={},g=void 0):m=="}"?((y=_.pop())[0][y[1]]=w,g=void 0,w=y[0]):m=="-"?v=-1:g===void 0?n.hasOwnProperty(m)?(A+=n[m],g=parseInt(A,16)*v,v=1,A=""):A+=m:n.hasOwnProperty(m)?(P+=n[m],w[g]=parseInt(P,16)*v,v=1,g=void 0,P=""):P+=m;return x},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:u("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},f={Unicode:{"Courier-Oblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":u("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":u("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:u("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":u("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:u("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":u("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":u("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":u("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":u("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var h=p.font,y=f.Unicode[h.postScriptName];y&&(h.metadata.Unicode={},h.metadata.Unicode.widths=y.widths,h.metadata.Unicode.kerning=y.kerning);var g=d.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])})(mr.API),(function(e){var r=function(t){for(var n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a};e.API.events.push(["addFont",function(t){var n=void 0,a=t.font,i=t.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?r(c):r(ov(c)),o.metadata=e.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])})(mr),mr.API.addSvgAsImage=function(e,r,t,n,a,i,o,c){if(isNaN(r)||isNaN(t))throw Wn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Wn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=n,u.height=a;var l=u.getContext("2d");l.fillStyle="#fff",l.fillRect(0,0,u.width,u.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Ir.canvg?Promise.resolve(Ir.canvg):Y_(()=>import("./index.es-0RxfkzfI.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(l,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(d)}).then(function(){f.addImage(u.toDataURL("image/jpeg",1),r,t,n,a,o,c)})},mr.API.putTotalPages=function(e){var r,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(e,"g"),t=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(r,t);return this},mr.API.viewerPreferences=function(e,r){var t;e=e||{},r=r||!1;var n,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],l=0,d=0,f=0;function p(y,g){var m,x=!1;for(m=0;m<y.length;m+=1)y[m]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,e==="reset"||r===!0){var h=c.length;for(f=0;f<h;f+=1)t[c[f]].value=t[c[f]].defaultValue,t[c[f]].explicitSet=!1}if(Dn(e)==="object"){for(a in e)if(i=e[a],p(c,a)&&i!==void 0){if(t[a].type==="boolean"&&typeof i=="boolean")t[a].value=i;else if(t[a].type==="name"&&p(t[a].valueSet,i))t[a].value=i;else if(t[a].type==="integer"&&Number.isInteger(i))t[a].value=i;else if(t[a].type==="array"){for(l=0;l<i.length;l+=1)if(n=!0,i[l].length===1&&typeof i[l][0]=="number")u.push(String(i[l]-1));else if(i[l].length>1){for(d=0;d<i[l].length;d+=1)typeof i[l][d]!="number"&&(n=!1);n===!0&&u.push([i[l][0]-1,i[l][1]-1].join(" "))}t[a].value="["+u.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,g=[];for(y in t)t[y].explicitSet===!0&&(t[y].type==="name"?g.push("/"+y+" /"+t[y].value):g.push("/"+y+" "+t[y].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(e){var r=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),l=i.length+o.length+c.length+a.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+l+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+c+u),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",r)),this}})(mr.API),(function(e){var r=e.API,t=r.pdfEscape16=function(i,o){for(var c,u=o.metadata.Unicode.widths,l=["","0","00","000","0000"],d=[""],f=0,p=i.length;f<p;++f){if(c=o.metadata.characterToGlyph(i.charCodeAt(f)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=i.charCodeAt(f),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return d.join("");c=c.toString(16),d.push(l[4-c.length],c)}return d.join("")},n=function(i){var o,c,u,l,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],f=0,p=(c=Object.keys(i).sort(function(h,y){return h-y})).length;f<p;f++)o=c[f],u.length>=100&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(l=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+l+">"));return u.length&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(i){(function(o){var c=o.font,u=o.out,l=o.newObject,d=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var f=c.metadata.Unicode.widths,p=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),h="",y=0;y<p.length;y++)h+=String.fromCharCode(p[y]);var g=l();d({data:h,addLength1:!0,objectId:g}),u("endobj");var m=l();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:m}),u("endobj");var x=l();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Jp(c.fontName)),u("/FontFile2 "+g+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var v=l();u("<<"),u("/Type /Font"),u("/BaseFont /"+Jp(c.fontName)),u("/FontDescriptor "+x+" 0 R"),u("/W "+e.API.PDFObject.convert(f)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=l(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+m+" 0 R"),u("/BaseFont /"+Jp(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+v+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(i)}]),r.events.push(["putFont",function(i){(function(o){var c=o.font,u=o.out,l=o.newObject,d=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var f=c.metadata.rawData,p="",h=0;h<f.length;h++)p+=String.fromCharCode(f[h]);var y=l();d({data:p,addLength1:!0,objectId:y}),u("endobj");var g=l();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:g}),u("endobj");var m=l();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+y+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+Jp(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=l();for(var x=0;x<c.metadata.hmtx.widths.length;x++)c.metadata.hmtx.widths[x]=parseInt(c.metadata.hmtx.widths[x]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Jp(c.fontName)+"/FontDescriptor "+m+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,c=i.text||"",u=i.x,l=i.y,d=i.options||{},f=i.mutex||{},p=f.pdfEscape,h=f.activeFontKey,y=f.fonts,g=h,m="",x=0,v="",w=y[g].encoding;if(y[g].encoding!=="Identity-H")return{text:c,x:u,y:l,options:d,mutex:f};for(v=c,g=h,Array.isArray(c)&&(v=c[0]),x=0;x<v.length;x+=1)y[g].metadata.hasOwnProperty("cmap")&&(o=y[g].metadata.cmap.unicode.codeMap[v[x].charCodeAt(0)]),o||v[x].charCodeAt(0)<256&&y[g].metadata.hasOwnProperty("Unicode")?m+=v[x]:m+="";var _="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?_=p(m,g).split("").map(function(A){return A.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(_=t(m,y[g])),f.isHex=!0,{text:_,x:u,y:l,options:d,mutex:f}};r.events.push(["postProcessText",function(i){var o=i.text||"",c=[],u={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var l=0;for(l=0;l<o.length;l+=1)Array.isArray(o[l])&&o[l].length===3?c.push([a(Object.assign({},u,{text:o[l][0]})).text,o[l][1],o[l][2]]):c.push(a(Object.assign({},u,{text:o[l]})).text);i.text=c}else i.text=a(Object.assign({},u,{text:o})).text}])})(mr),(function(e){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0},e.addFileToVFS=function(t,n){return r.call(this),this.internal.vFS[t]=n,this},e.getFileFromVFS=function(t){return r.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(mr.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,o,c,u,l,d,f=r,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},m=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var _=function(H){var z=H.charCodeAt(),O=z>>8,L=g[O];return L!==void 0?f[256*L+(255&z)]:O===252||O===253?"AL":x.test(O)?"L":O===8?"R":"N"},A=function(H){for(var z,O=0;O<H.length;O++){if((z=_(H.charAt(O)))==="L")return!1;if(z==="R")return!0}return!1},P=function(H,z,O,L){var E,k,N,S,C=z[L];switch(C){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(C="AN");break;case"AL":v=!0,C="R";break;case"WS":case"BN":C="N";break;case"CS":L<1||L+1>=z.length||(E=O[L-1])!=="EN"&&E!=="AN"||(k=z[L+1])!=="EN"&&k!=="AN"?C="N":v&&(k="AN"),C=k===E?k:"N";break;case"ES":C=(E=L>0?O[L-1]:"B")==="EN"&&L+1<z.length&&z[L+1]==="EN"?"EN":"N";break;case"ET":if(L>0&&O[L-1]==="EN"){C="EN";break}if(v){C="N";break}for(N=L+1,S=z.length;N<S&&z[N]==="ET";)N++;C=N<S&&z[N]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(S=z.length,N=L+1;N<S&&z[N]==="NSM";)N++;if(N<S){var D=H[L],q=D>=1425&&D<=2303||D===64286;if(E=z[N],q&&(E==="R"||E==="AL")){C="R";break}}}C=L<1||(E=z[L-1])==="B"?"N":O[L-1];break;case"B":v=!1,a=!0,C=w;break;case"S":i=!0,C="N"}return C},B=function(H,z,O){var L=H.split("");return O&&T(L,O,{hiLevel:w}),L.reverse(),z&&z.reverse(),L.join("")},T=function(H,z,O){var L,E,k,N,S,C=-1,D=H.length,q=0,M=[],G=w?h:p,X=[];for(v=!1,a=!1,i=!1,E=0;E<D;E++)X[E]=_(H[E]);for(k=0;k<D;k++){if(S=q,M[k]=P(H,X,M,k),L=240&(q=G[S][y[M[k]]]),q&=15,z[k]=N=G[q][5],L>0)if(L===16){for(E=C;E<k;E++)z[E]=1;C=-1}else C=-1;if(G[q][6])C===-1&&(C=k);else if(C>-1){for(E=C;E<k;E++)z[E]=N;C=-1}X[k]==="B"&&(z[k]=0),O.hiLevel|=N}i&&(function(re,V,J){for(var W=0;W<J;W++)if(re[W]==="S"){V[W]=w;for(var F=W-1;F>=0&&re[F]==="WS";F--)V[F]=w}})(X,z,D)},I=function(H,z,O,L,E){if(!(E.hiLevel<H)){if(H===1&&w===1&&!a)return z.reverse(),void(O&&O.reverse());for(var k,N,S,C,D=z.length,q=0;q<D;){if(L[q]>=H){for(S=q+1;S<D&&L[S]>=H;)S++;for(C=q,N=S-1;C<N;C++,N--)k=z[C],z[C]=z[N],z[N]=k,O&&(k=O[C],O[C]=O[N],O[N]=k);q=S}q++}}},U=function(H,z,O){var L=H.split(""),E={hiLevel:w};return O||(O=[]),T(L,O,E),(function(k,N,S){if(S.hiLevel!==0&&d)for(var C,D=0;D<k.length;D++)N[D]===1&&(C=m.indexOf(k[D]))>=0&&(k[D]=m[C+1])})(L,O,E),I(2,L,z,O,E),I(1,L,z,O,E),L.join("")};return this.__bidiEngine__.doBidiReorder=function(H,z,O){if((function(E,k){if(k)for(var N=0;N<E.length;N++)k[N]=N;c===void 0&&(c=A(E)),l===void 0&&(l=A(E))})(H,z),o||!u||l)if(o&&u&&c^l)w=c?1:0,H=B(H,z,O);else if(!o&&u&&l)w=c?1:0,H=U(H,z,O),H=B(H,z);else if(!o||c||u||l){if(o&&!u&&c^l)H=B(H,z),c?(w=0,H=U(H,z,O)):(w=1,H=U(H,z,O),H=B(H,z));else if(o&&c&&!u&&l)w=1,H=U(H,z,O),H=B(H,z);else if(!o&&!u&&c^l){var L=d;c?(w=1,H=U(H,z,O),w=0,d=!1,H=U(H,z,O),d=L):(w=0,H=U(H,z,O),H=B(H,z),w=1,d=!1,H=U(H,z,O),d=L,H=B(H,z))}}else w=0,H=U(H,z,O);else w=c?1:0,H=U(H,z,O);return H},this.__bidiEngine__.setOptions=function(H){H&&(o=H.isInputVisual,u=H.isOutputVisual,c=H.isInputRtl,l=H.isOutputRtl,d=H.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var c=0;for(o=[],c=0;c<a.length;c+=1)Object.prototype.toString.call(a[c])==="[object Array]"?o.push([t.doBidiReorder(a[c][0]),a[c][1],a[c][2]]):o.push([t.doBidiReorder(a[c])]);n.text=o}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])})(mr),mr.API.TTFFont=(function(){function e(r){var t;if(this.rawData=r,t=this.contents=new wh(r),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Qbe(this),this.registerTTF()}return e.open=function(r){return new e(r)},e.prototype.parse=function(){return this.directory=new Dbe(this.contents),this.head=new Bbe(this),this.name=new Hbe(this),this.cmap=new sB(this),this.toUnicode={},this.hhea=new $be(this),this.maxp=new Vbe(this),this.hmtx=new Wbe(this),this.post=new zbe(this),this.os2=new qbe(this),this.loca=new Ybe(this),this.glyf=new Kbe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var r,t,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,l;for(l=[],o=0,c=(u=this.bbox).length;o<c;o++)r=u[o],l.push(Math.round(r*this.scaleFactor));return l}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(r){var t;return((t=this.cmap.unicode)!=null?t.codeMap[r]:void 0)||0},e.prototype.widthOfGlyph=function(r){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*t},e.prototype.widthOfString=function(r,t,n){var a,i,o,c;for(o=0,i=0,c=(r=""+r).length;0<=c?i<c:i>c;i=0<=c?++i:--i)a=r.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return o*(t/1e3)},e.prototype.lineHeight=function(r,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*r},e})();var vc,wh=(function(){function e(r){this.data=r??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(r){return this.data[this.pos++]=r},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},e.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},e.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},e.prototype.readString=function(r){var t,n;for(n=[],t=0;0<=r?t<r:t>r;t=0<=r?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(r){var t,n,a;for(a=[],t=0,n=r.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(r.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(r){return this.writeInt16(r)},e.prototype.readLongLong=function(){var r,t,n,a,i,o,c,u;return r=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*r+281474976710656*t+1099511627776*n+4294967296*a+16777216*i+65536*o+256*c+u},e.prototype.writeLongLong=function(r){var t,n;return t=Math.floor(r/4294967296),n=4294967295&r,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(r){return this.writeInt32(r)},e.prototype.read=function(r){var t,n;for(t=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(r){var t,n,a,i;for(i=[],n=0,a=r.length;n<a;n++)t=r[n],i.push(this.writeByte(t));return i},e})(),Dbe=(function(){var e;function r(t){var n,a,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return r.prototype.encode=function(t){var n,a,i,o,c,u,l,d,f,p,h,y,g;for(g in h=Object.keys(t).length,u=Math.log(2),f=16*Math.floor(Math.log(h)/u),o=Math.floor(f/u),d=16*h-f,(a=new wh).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),i=16*h,l=a.pos+i,c=null,y=[],t)for(p=t[g],a.writeString(g),a.writeInt(e(p)),a.writeInt(l),a.writeInt(p.length),y=y.concat(p),g==="head"&&(c=l),l+=p.length;l%4;)y.push(0),l++;return a.write(y),n=2981146554-e(a.data),a.pos=c+8,a.writeUInt32(n),a.data},e=function(t){var n,a,i,o;for(t=aB.call(t);t.length%4;)t.push(0);for(i=new wh(t),a=0,n=0,o=t.length;n<o;n=n+=4)a+=i.readUInt32();return 4294967295&a},r})(),Fbe={}.hasOwnProperty,iu=function(e,r){for(var t in r)Fbe.call(r,t)&&(e[t]=r[t]);function n(){this.constructor=e}return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};vc=(function(){function e(r){var t;this.file=r,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var Bbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var t;return(t=new wh).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(r),t.writeShort(this.glyphDataFormat),t.data},e})(),Q9=(function(){function e(r,t){var n,a,i,o,c,u,l,d,f,p,h,y,g,m,x,v,w;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=t+r.readInt(),f=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=r.readByte();break;case 4:for(h=r.readUInt16(),p=h/2,r.pos+=6,i=(function(){var _,A;for(A=[],u=_=0;0<=p?_<p:_>p;u=0<=p?++_:--_)A.push(r.readUInt16());return A})(),r.pos+=2,g=(function(){var _,A;for(A=[],u=_=0;0<=p?_<p:_>p;u=0<=p?++_:--_)A.push(r.readUInt16());return A})(),l=(function(){var _,A;for(A=[],u=_=0;0<=p?_<p:_>p;u=0<=p?++_:--_)A.push(r.readUInt16());return A})(),d=(function(){var _,A;for(A=[],u=_=0;0<=p?_<p:_>p;u=0<=p?++_:--_)A.push(r.readUInt16());return A})(),a=(this.length-r.pos+this.offset)/2,c=(function(){var _,A;for(A=[],u=_=0;0<=a?_<a:_>a;u=0<=a?++_:--_)A.push(r.readUInt16());return A})(),u=x=0,w=i.length;x<w;u=++x)for(m=i[u],n=v=y=g[u];y<=m?v<=m:v>=m;n=y<=m?++v:--v)d[u]===0?o=n+l[u]:(o=c[d[u]/2+(n-y)-(p-u)]||0)!==0&&(o+=l[u]),this.codeMap[n]=65535&o}r.pos=f}return e.encode=function(r,t){var n,a,i,o,c,u,l,d,f,p,h,y,g,m,x,v,w,_,A,P,B,T,I,U,H,z,O,L,E,k,N,S,C,D,q,M,G,X,re,V,J,W,F,Q,ne,ie;switch(L=new wh,o=Object.keys(r).sort(function(ce,de){return ce-de}),t){case"macroman":for(g=0,m=(function(){var ce=[];for(y=0;y<256;++y)ce.push(0);return ce})(),v={0:0},i={},E=0,C=o.length;E<C;E++)v[F=r[a=o[E]]]==null&&(v[F]=++g),i[a]={old:r[a],new:v[r[a]]},m[a]=v[r[a]];return L.writeUInt16(1),L.writeUInt16(0),L.writeUInt32(12),L.writeUInt16(0),L.writeUInt16(262),L.writeUInt16(0),L.write(m),{charMap:i,subtable:L.data,maxGlyphID:g+1};case"unicode":for(z=[],f=[],w=0,v={},n={},x=l=null,k=0,D=o.length;k<D;k++)v[A=r[a=o[k]]]==null&&(v[A]=++w),n[a]={old:A,new:v[A]},c=v[A]-a,x!=null&&c===l||(x&&f.push(x),z.push(a),l=c),x=a;for(x&&f.push(x),f.push(65535),z.push(65535),U=2*(I=z.length),T=2*Math.pow(Math.log(I)/Math.LN2,2),p=Math.log(T/2)/Math.LN2,B=2*I-T,u=[],P=[],h=[],y=N=0,q=z.length;N<q;y=++N){if(H=z[y],d=f[y],H===65535){u.push(0),P.push(0);break}if(H-(O=n[H].new)>=32768)for(u.push(0),P.push(2*(h.length+I-y)),a=S=H;H<=d?S<=d:S>=d;a=H<=d?++S:--S)h.push(n[a].new);else u.push(O-H),P.push(0)}for(L.writeUInt16(3),L.writeUInt16(1),L.writeUInt32(12),L.writeUInt16(4),L.writeUInt16(16+8*I+2*h.length),L.writeUInt16(0),L.writeUInt16(U),L.writeUInt16(T),L.writeUInt16(p),L.writeUInt16(B),J=0,M=f.length;J<M;J++)a=f[J],L.writeUInt16(a);for(L.writeUInt16(0),W=0,G=z.length;W<G;W++)a=z[W],L.writeUInt16(a);for(Q=0,X=u.length;Q<X;Q++)c=u[Q],L.writeUInt16(c);for(ne=0,re=P.length;ne<re;ne++)_=P[ne],L.writeUInt16(_);for(ie=0,V=h.length;ie<V;ie++)g=h[ie],L.writeUInt16(g);return{charMap:n,subtable:L.data,maxGlyphID:w+1}}},e})(),sB=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="cmap",e.prototype.parse=function(r){var t,n,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)t=new Q9(r,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},e.encode=function(r,t){var n,a;return t==null&&(t="macroman"),n=Q9.encode(r,t),(a=new wh).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e})(),$be=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e})(),qbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var t,n;for(n=[],t=0;t<10;++t)n.push(r.readByte());return n})(),this.charRange=(function(){var t,n;for(n=[],t=0;t<4;++t)n.push(r.readInt());return n})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(r.readInt());return n})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e})(),zbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="post",e.prototype.parse=function(r){var t,n,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=r.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)t=r.readByte(),a.push(this.names.push(r.readString(t)));return a;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 262144:return this.map=(function(){var o,c,u;for(u=[],i=o=0,c=this.file.maxp.numGlyphs;0<=c?o<c:o>c;i=0<=c?++o:--o)u.push(r.readUInt32());return u}).call(this)}},e})(),Ube=function(e,r){this.raw=e,this.length=e.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},Hbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="name",e.prototype.parse=function(r){var t,n,a,i,o,c,u,l,d,f,p;for(r.pos=this.offset,r.readShort(),t=r.readShort(),c=r.readShort(),n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},i=d=0,f=n.length;d<f;i=++d)a=n[i],r.pos=a.offset,l=r.readString(a.length),o=new Ube(l,a),u[p=a.nameID]==null&&(u[p]=[]),u[a.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e})(),Vbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e})(),Wbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="hmtx",e.prototype.parse=function(r){var t,n,a,i,o,c,u;for(r.pos=this.offset,this.metrics=[],t=0,c=this.file.hhea.numberOfMetrics;0<=c?t<c:t>c;t=0<=c?++t:--t)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var l,d;for(d=[],t=l=0;0<=a?l<a:l>a;t=0<=a?++l:--l)d.push(r.readInt16());return d})(),this.widths=(function(){var l,d,f,p;for(p=[],l=0,d=(f=this.metrics).length;l<d;l++)i=f[l],p.push(i.advance);return p}).call(this),n=this.widths[this.widths.length-1],u=[],t=o=0;0<=a?o<a:o>a;t=0<=a?++o:--o)u.push(this.widths.push(n));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e})(),aB=[].slice,Kbe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var t,n,a,i,o,c,u,l,d,f;return r in this.cache?this.cache[r]:(i=this.file.loca,t=this.file.contents,n=i.indexOf(r),(a=i.lengthOf(r))===0?this.cache[r]=null:(t.pos=this.offset+n,o=(c=new wh(t.read(a))).readShort(),l=c.readShort(),f=c.readShort(),u=c.readShort(),d=c.readShort(),this.cache[r]=o===-1?new Xbe(c,l,f,u,d):new Gbe(c,o,l,f,u,d),this.cache[r]))},e.prototype.encode=function(r,t,n){var a,i,o,c,u;for(o=[],i=[],c=0,u=t.length;c<u;c++)a=r[t[c]],i.push(o.length),a&&(o=o.concat(a.encode(n)));return i.push(o.length),{table:o,offsets:i}},e})(),Gbe=(function(){function e(r,t,n,a,i,o){this.raw=r,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),Xbe=(function(){function e(r,t,n,a,i){var o,c;for(this.raw=r,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return e.prototype.encode=function(){var r,t,n;for(t=new wh(aB.call(this.raw.data)),r=0,n=this.glyphIDs.length;r<n;++r)t.pos=this.glyphOffsets[r];return t.data},e})(),Ybe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return iu(e,vc),e.prototype.tag="loca",e.prototype.parse=function(r){var t,n;return r.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*r.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(r.readUInt32());return i}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,t){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,o=0;o<n.length;++o)if(n[o]=a,i<t.length&&t[i]==o){++i,n[o]=a;var c=this.offsets[o],u=this.offsets[o+1]-c;u>0&&(a+=u)}for(var l=new Array(4*n.length),d=0;d<n.length;++d)l[4*d+3]=255&n[d],l[4*d+2]=(65280&n[d])>>8,l[4*d+1]=(16711680&n[d])>>16,l[4*d]=(4278190080&n[d])>>24;return l},e})(),Qbe=(function(){function e(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var r,t,n,a,i;for(t in a=this.font.cmap.tables[0].codeMap,r={},i=this.subset)n=i[t],r[t]=a[n];return r},e.prototype.glyphsFor=function(r){var t,n,a,i,o,c,u;for(a={},o=0,c=r.length;o<c;o++)a[i=r[o]]=this.font.glyf.glyphFor(i);for(i in t=[],a)(n=a[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in u=this.glyphsFor(t))n=u[i],a[i]=n;return a},e.prototype.encode=function(r,t){var n,a,i,o,c,u,l,d,f,p,h,y,g,m,x;for(a in n=sB.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(r),h={0:0},x=n.charMap)h[(u=x[a]).old]=u.new;for(y in p=n.maxGlyphID,o)y in h||(h[y]=p++);return d=(function(v){var w,_;for(w in _={},v)_[v[w]]=w;return _})(h),f=Object.keys(d).sort(function(v,w){return v-w}),g=(function(){var v,w,_;for(_=[],v=0,w=f.length;v<w;v++)c=f[v],_.push(d[c]);return _})(),i=this.font.glyf.encode(o,g,h),l=this.font.loca.encode(i.offsets,g),m={cmap:this.font.cmap.raw(),glyf:i.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},e})();mr.API.PDFObject=(function(){var e;function r(){}return e=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},r.convert=function(t){var n,a,i,o;if(Array.isArray(t))return"["+(function(){var c,u,l;for(l=[],c=0,u=t.length;c<u;c++)n=t[c],l.push(r.convert(n));return l})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+e(t.getUTCFullYear(),4)+e(t.getUTCMonth(),2)+e(t.getUTCDate(),2)+e(t.getUTCHours(),2)+e(t.getUTCMinutes(),2)+e(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in i=["<<"],t)o=t[a],i.push("/"+a+" "+r.convert(o));return i.push(">>"),i.join(`
`)}return""+t},r})();function iB(e,r,t,n,a){n=n||{};var i=1.15,o=a.internal.scaleFactor,c=a.internal.getFontSize()/o,u=a.getLineHeightFactor?a.getLineHeightFactor():i,l=c*u,d=/\r\n|\r|\n/g,f="",p=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(d):e,p=f.length||1),t+=c*(2-i),n.valign==="middle"?t-=p/2*l:n.valign==="bottom"&&(t-=p*l),n.halign==="center"||n.halign==="right"){var h=c;if(n.halign==="center"&&(h*=.5),f&&p>=1){for(var y=0;y<f.length;y++)a.text(f[y],r-a.getStringUnitWidth(f[y])*h,t),t+=l;return a}r-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,r,t,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,r,t),a}var Z9={},mm=(function(){function e(r){this.jsPDFDocument=r,this.userStyles={textColor:r.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:r.internal.getFontSize(),fontStyle:r.internal.getFont().fontStyle,font:r.internal.getFont().fontName,lineWidth:r.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:r.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(r,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=r:Z9=r},e.unifyColor=function(r){return Array.isArray(r)?r:typeof r=="number"?[r,r,r]:typeof r=="string"?[r]:null},e.prototype.applyStyles=function(r,t){var n,a,i;t===void 0&&(t=!1),r.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(r.fontStyle);var o=this.jsPDFDocument.internal.getFont(),c=o.fontStyle,u=o.fontName;if(r.font&&(u=r.font),r.fontStyle){c=r.fontStyle;var l=this.getFontList()[u];l&&l.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(l[0]),c=l[0])}if(this.jsPDFDocument.setFont(u,c),r.fontSize&&this.jsPDFDocument.setFontSize(r.fontSize),!t){var d=e.unifyColor(r.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=e.unifyColor(r.textColor),d&&(a=this.jsPDFDocument).setTextColor.apply(a,d),d=e.unifyColor(r.lineColor),d&&(i=this.jsPDFDocument).setDrawColor.apply(i,d),typeof r.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(r.lineWidth)}},e.prototype.splitTextToSize=function(r,t,n){return this.jsPDFDocument.splitTextToSize(r,t,n)},e.prototype.rect=function(r,t,n,a,i){return this.jsPDFDocument.rect(r,t,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(r){return this.jsPDFDocument.getTextWidth(r)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(r){this.jsPDFDocument.setPage(r)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return Z9||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var r=this.jsPDFDocument.internal.pageSize;return r.width==null&&(r={width:r.getWidth(),height:r.getHeight()}),r},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var r=this.jsPDFDocument;return r.getLineHeightFactor?r.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(r){return r/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var r=this.jsPDFDocument.internal.getCurrentPageInfo();return r?r.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),b4=function(e,r){return b4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},b4(e,r)};function oB(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");b4(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var lB=(function(e){oB(r,e);function r(t){var n=e.call(this)||this;return n._element=t,n}return r})(Array);function Zbe(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Jbe(e){var r={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return r[e]}function Cb(e,r,t){t.applyStyles(r,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return t.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return a}function cB(e,r,t,n){var a=r.settings.tableLineWidth,i=r.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var o=uB(a,!1);o&&e.rect(t.x,t.y,r.getWidth(e.pageSize().width),n.y-t.y,o)}function uB(e,r){var t=e>0,n=r||r===0;return t&&n?"DF":t?"S":n?"F":null}function H1(e,r){var t,n,a,i;if(e=e||r,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=r}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(t=e.left)!==null&&t!==void 0?t:r,top:(n=e.top)!==null&&n!==void 0?n:r,right:(a=e.right)!==null&&a!==void 0?a:r,bottom:(i=e.bottom)!==null&&i!==void 0?i:r}):(typeof e!="number"&&(e=r),{top:e,right:e,bottom:e,left:e})}function dB(e,r){var t=H1(r.settings.margin,0);return e.pageSize().width-(t.left+t.right)}function e1e(e,r,t,n,a){var i={},o=1.3333333333333333,c=x5(r,function(w){return a.getComputedStyle(w).backgroundColor});c!=null&&(i.fillColor=c);var u=x5(r,function(w){return a.getComputedStyle(w).color});u!=null&&(i.textColor=u);var l=r1e(n,t);l&&(i.cellPadding=l);var d="borderTopColor",f=o*t,p=n.borderTopWidth;if(n.borderBottomWidth===p&&n.borderRightWidth===p&&n.borderLeftWidth===p){var h=(parseFloat(p)||0)/f;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},i.lineWidth.top||(i.lineWidth.right?d="borderRightColor":i.lineWidth.bottom?d="borderBottomColor":i.lineWidth.left&&(d="borderLeftColor"));var y=x5(r,function(w){return a.getComputedStyle(w)[d]});y!=null&&(i.lineColor=y);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var m=parseInt(n.fontSize||"");isNaN(m)||(i.fontSize=m/o);var x=t1e(n);x&&(i.fontStyle=x);var v=(n.fontFamily||"").toLowerCase();return e.indexOf(v)!==-1&&(i.font=v),i}function t1e(e){var r="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(r="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(r+="italic"),r}function x5(e,r){var t=hB(e,r);if(!t)return null;var n=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function hB(e,r){var t=r(e);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?e.parentElement==null?null:hB(e.parentElement,r):t}function r1e(e,r){var t=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/r),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/r/2,i=t.map(function(c){return parseInt(c||"0")/n}),o=H1(i,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function fB(e,r,t,n,a){var i,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var c;typeof r=="string"?c=t.document.querySelector(r):c=r;var u=Object.keys(e.getFontList()),l=e.scaleFactor(),d=[],f=[],p=[];if(!c)return console.error("Html table could not be found with input: ",r),{head:d,body:f,foot:p};for(var h=0;h<c.rows.length;h++){var y=c.rows[h],g=(o=(i=y?.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),m=n1e(u,l,t,y,n,a);m&&(g==="thead"?d.push(m):g==="tfoot"?p.push(m):f.push(m))}return{head:d,body:f,foot:p}}function n1e(e,r,t,n,a,i){for(var o=new lB(n),c=0;c<n.cells.length;c++){var u=n.cells[c],l=t.getComputedStyle(u);if(a||l.display!=="none"){var d=void 0;i&&(d=e1e(e,u,r,l,t)),o.push({rowSpan:u.rowSpan,colSpan:u.colSpan,styles:d,_element:u,content:s1e(u)})}}var f=t.getComputedStyle(n);if(o.length>0&&(a||f.display!=="none"))return o}function s1e(e){var r=e.cloneNode(!0);return r.innerHTML=r.innerHTML.replace(/\n/g,"").replace(/ +/g," "),r.innerHTML=r.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),r.innerText||r.textContent||""}function a1e(e,r,t){for(var n=0,a=[e,r,t];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Qu(e,r,t,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),o=1;o<arguments.length;o++){var c=arguments[o];if(c!=null)for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(i[u]=c[u])}return i}function pB(e,r){var t=new mm(e),n=t.getDocumentOptions(),a=t.getGlobalOptions();a1e(a,n,r);var i=Qu({},a,n,r),o;typeof window<"u"&&(o=window);var c=i1e(a,n,r),u=o1e(a,n,r),l=l1e(t,i),d=u1e(t,i,o);return{id:r.tableId,content:d,hooks:u,styles:c,settings:l}}function i1e(e,r,t){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(u){if(u==="columnStyles"){var l=e[u],d=r[u],f=t[u];n.columnStyles=Qu({},l,d,f)}else{var p=[e,r,t],h=p.map(function(y){return y[u]||{}});n[u]=Qu({},h[0],h[1],h[2])}},i=0,o=Object.keys(n);i<o.length;i++){var c=o[i];a(c)}return n}function o1e(e,r,t){for(var n=[e,r,t],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=n;i<o.length;i++){var c=o[i];c.didParseCell&&a.didParseCell.push(c.didParseCell),c.willDrawCell&&a.willDrawCell.push(c.willDrawCell),c.didDrawCell&&a.didDrawCell.push(c.didDrawCell),c.willDrawPage&&a.willDrawPage.push(c.willDrawPage),c.didDrawPage&&a.didDrawPage.push(c.didDrawPage)}return a}function l1e(e,r){var t,n,a,i,o,c,u,l,d,f,p,h,y=H1(r.margin,40/e.scaleFactor()),g=(t=c1e(e,r.startY))!==null&&t!==void 0?t:y.top,m;r.showFoot===!0?m="everyPage":r.showFoot===!1?m="never":m=(n=r.showFoot)!==null&&n!==void 0?n:"everyPage";var x;r.showHead===!0?x="everyPage":r.showHead===!1?x="never":x=(a=r.showHead)!==null&&a!==void 0?a:"everyPage";var v=(i=r.useCss)!==null&&i!==void 0?i:!1,w=r.theme||(v?"plain":"striped"),_=!!r.horizontalPageBreak,A=(o=r.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(c=r.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:v,theme:w,startY:g,margin:y,pageBreak:(u=r.pageBreak)!==null&&u!==void 0?u:"auto",rowPageBreak:(l=r.rowPageBreak)!==null&&l!==void 0?l:"auto",tableWidth:(d=r.tableWidth)!==null&&d!==void 0?d:"auto",showHead:x,showFoot:m,tableLineWidth:(f=r.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(p=r.tableLineColor)!==null&&p!==void 0?p:200,horizontalPageBreak:_,horizontalPageBreakRepeat:A,horizontalPageBreakBehaviour:(h=r.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function c1e(e,r){var t=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(t&&t.startPageNumber){var o=t.startPageNumber+t.pageNumber-1;i=o===a}return typeof r=="number"?r:(r==null||r===!1)&&i&&t?.finalY!=null?t.finalY+20/n:null}function u1e(e,r,t){var n=r.head||[],a=r.body||[],i=r.foot||[];if(r.html){var o=r.includeHiddenHtml;if(t){var c=fB(e,r.html,t,o,r.useCss)||{};n=c.head||n,a=c.body||n,i=c.foot||n}else console.error("Cannot parse html in non browser environment")}var u=r.columns||d1e(n,a,i);return{columns:u,head:n,body:a,foot:i}}function d1e(e,r,t){var n=e[0]||r[0]||t[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,c;Array.isArray(n)?c=n[parseInt(i)]:c=n[i],typeof c=="object"&&!Array.isArray(c)&&(o=c?.colSpan||1);for(var u=0;u<o;u++){var l=void 0;Array.isArray(n)?l=a.length:l=i+(u>0?"_".concat(u):"");var d={dataKey:l};a.push(d)}}),a}var w4=(function(){function e(r,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=r.getDocument()}return e})(),h1e=(function(e){oB(r,e);function r(t,n,a,i,o,c){var u=e.call(this,t,n,c)||this;return u.cell=a,u.row=i,u.column=o,u.section=i.section,u}return r})(w4),f1e=(function(){function e(r,t){this.pageNumber=1,this.id=r.id,this.settings=r.settings,this.styles=r.styles,this.hooks=r.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(r){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(r)},0)},e.prototype.getFootHeight=function(r){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(r)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(r,t,n,a,i,o){for(var c=0,u=t;c<u.length;c++){var l=u[c],d=new h1e(r,this,n,a,i,o),f=l(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(r,t){r.applyStyles(r.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new w4(r,this,t))}},e.prototype.callWillDrawPageHooks=function(r,t){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new w4(r,this,t))}},e.prototype.getWidth=function(r){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return t}else{var n=this.settings.margin;return r-n.left-n.right}},e})(),mB=(function(){function e(r,t,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=r,r instanceof lB&&(this.raw=r._element,this.element=r._element),this.index=t,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(r){var t=this;return r.reduce(function(n,a){var i;return Math.max(n,((i=t.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(r){var t=this;return r.filter(function(n){var a=t.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(r,t){return this.getMaxCellHeight(t)<=r},e.prototype.getMinimumRowHeight=function(r,t){var n=this;return r.reduce(function(a,i){var o=n.cells[i.index];if(!o)return 0;var c=t.getLineHeight(o.styles.fontSize),u=o.padding("vertical"),l=u+c;return l>a?l:a},0)},e})(),gB=(function(){function e(r,t,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=r;var i=r;r!=null&&typeof r=="object"&&!Array.isArray(r)?(this.rowSpan=r.rowSpan||1,this.colSpan=r.colSpan||1,i=(a=r.content)!==null&&a!==void 0?a:r,r._element&&(this.raw=r._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",c=/\r\n|\r|\n/g;this.text=o.split(c)}return e.prototype.getTextPos=function(){var r;if(this.styles.valign==="top")r=this.y+this.padding("top");else if(this.styles.valign==="bottom")r=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");r=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:r}},e.prototype.getContentHeight=function(r,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/r*t,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(r){var t=H1(this.styles.cellPadding,0);return r==="vertical"?t.top+t.bottom:r==="horizontal"?t.left+t.right:t[r]},e})(),p1e=(function(){function e(r,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=r,this.raw=t,this.index=n}return e.prototype.getMaxCustomCellWidth=function(r){for(var t=0,n=0,a=r.allRows();n<a.length;n++){var i=a[n],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(t=Math.max(t,o.styles.cellWidth))}return t},e})();function m1e(e,r){g1e(e,r);var t=[],n=0;r.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(r);o?i.width=o:(i.width=i.wrappedWidth,t.push(i)),n+=i.width});var a=r.getWidth(e.pageSize().width)-n;a&&(a=_4(t,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=_4(t,a,function(i){return i.minWidth})),a=Math.abs(a),!r.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.log("Of the table content, ".concat(a," units width could not fit page"))),x1e(r),v1e(r,e),y1e(r)}function g1e(e,r){var t=e.scaleFactor(),n=r.settings.horizontalPageBreak,a=dB(e,r);r.allRows().forEach(function(i){for(var o=0,c=r.columns;o<c.length;o++){var u=c[o],l=i.cells[u.index];if(l){var d=r.hooks.didParseCell;r.callCellHooks(e,d,l,i,u,null);var f=l.padding("horizontal");l.contentWidth=Cb(l.text,l.styles,e)+f;var p=Cb(l.text.join(" ").split(/[^\S\u00A0]+/),l.styles,e);if(l.minReadableWidth=p+l.padding("horizontal"),typeof l.styles.cellWidth=="number")l.minWidth=l.styles.cellWidth,l.wrappedWidth=l.styles.cellWidth;else if(l.styles.cellWidth==="wrap"||n===!0)l.contentWidth>a?(l.minWidth=a,l.wrappedWidth=a):(l.minWidth=l.contentWidth,l.wrappedWidth=l.contentWidth);else{var h=10/t;l.minWidth=l.styles.minCellWidth||h,l.wrappedWidth=l.contentWidth,l.minWidth>l.wrappedWidth&&(l.wrappedWidth=l.minWidth)}}}}),r.allRows().forEach(function(i){for(var o=0,c=r.columns;o<c.length;o++){var u=c[o],l=i.cells[u.index];if(l&&l.colSpan===1)u.wrappedWidth=Math.max(u.wrappedWidth,l.wrappedWidth),u.minWidth=Math.max(u.minWidth,l.minWidth),u.minReadableWidth=Math.max(u.minReadableWidth,l.minReadableWidth);else{var d=r.styles.columnStyles[u.dataKey]||r.styles.columnStyles[u.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(u.minWidth=f,u.wrappedWidth=f)}l&&(l.colSpan>1&&!u.minWidth&&(u.minWidth=l.minWidth),l.colSpan>1&&!u.wrappedWidth&&(u.wrappedWidth=l.minWidth))}})}function _4(e,r,t){for(var n=r,a=e.reduce(function(h,y){return h+y.wrappedWidth},0),i=0;i<e.length;i++){var o=e[i],c=o.wrappedWidth/a,u=n*c,l=o.width+u,d=t(o),f=l<d?d:l;r-=f-o.width,o.width=f}if(r=Math.round(r*1e10)/1e10,r){var p=e.filter(function(h){return r<0?h.width>t(h):!0});p.length&&(r=_4(p,r,t))}return r}function y1e(e){for(var r={},t=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],o=0,c=e.columns;o<c.length;o++){var u=c[o],l=r[u.index];if(t>1)t--,delete i.cells[u.index];else if(l)l.cell.height+=i.height,t=l.cell.colSpan,delete i.cells[u.index],l.left--,l.left<=1&&delete r[u.index];else{var d=i.cells[u.index];if(!d)continue;if(d.height=i.height,d.rowSpan>1){var f=n.length-a,p=d.rowSpan>f?f:d.rowSpan;r[u.index]={cell:d,left:p,row:i}}}}}function x1e(e){for(var r=e.allRows(),t=0;t<r.length;t++)for(var n=r[t],a=null,i=0,o=0,c=0;c<e.columns.length;c++){var u=e.columns[c];if(o-=1,o>1&&e.columns[c+1])i+=u.width,delete n.cells[u.index];else if(a){var l=a;delete n.cells[u.index],a=null,l.width=u.width+i}else{var l=n.cells[u.index];if(!l)continue;if(o=l.colSpan,i=0,l.colSpan>1){a=l,i+=u.width;continue}l.width=u.width+i}}}function v1e(e,r){for(var t={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],o=0,c=e.columns;o<c.length;o++){var u=c[o],l=i.cells[u.index];if(l){r.applyStyles(l.styles,!0);var d=l.width-l.padding("horizontal");if(l.styles.overflow==="linebreak")l.text=r.splitTextToSize(l.text,d+1/r.scaleFactor(),{fontSize:l.styles.fontSize});else if(l.styles.overflow==="ellipsize")l.text=J9(l.text,d,l.styles,r,"...");else if(l.styles.overflow==="hidden")l.text=J9(l.text,d,l.styles,r,"");else if(typeof l.styles.overflow=="function"){var f=l.styles.overflow(l.text,d);typeof f=="string"?l.text=[f]:l.text=f}l.contentHeight=l.getContentHeight(r.scaleFactor(),r.getLineHeightFactor());var p=l.contentHeight/l.rowSpan;l.rowSpan>1&&t.count*t.height<p*l.rowSpan?t={height:p,count:l.rowSpan}:t&&t.count>0&&t.height>p&&(p=t.height),p>i.height&&(i.height=p)}}t.count--}}function J9(e,r,t,n,a){return e.map(function(i){return b1e(i,r,t,n,a)})}function b1e(e,r,t,n,a){var i=1e4*n.scaleFactor();if(r=Math.ceil(r*i)/i,r>=Cb(e,t,n))return e;for(;r<Cb(e+a,t,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function yB(e,r){var t=new mm(e),n=w1e(r,t.scaleFactor()),a=new f1e(r,n);return m1e(t,a),t.applyStyles(t.userStyles),a}function w1e(e,r){var t=e.content,n=j1e(t.columns);if(t.head.length===0){var a=eP(n,"head");a&&t.head.push(a)}if(t.foot.length===0){var a=eP(n,"foot");a&&t.foot.push(a)}var i=e.settings.theme,o=e.styles;return{columns:n,head:v5("head",t.head,n,o,i,r),body:v5("body",t.body,n,o,i,r),foot:v5("foot",t.foot,n,o,i,r)}}function v5(e,r,t,n,a,i){var o={},c=r.map(function(u,l){for(var d=0,f={},p=0,h=0,y=0,g=t;y<g.length;y++){var m=g[y];if(o[m.index]==null||o[m.index].left===0)if(h===0){var x=void 0;Array.isArray(u)?x=u[m.index-p-d]:x=u[m.dataKey];var v={};typeof x=="object"&&!Array.isArray(x)&&(v=x?.styles||{});var w=N1e(e,m,l,a,n,i,v),_=new gB(x,w,e);f[m.dataKey]=_,f[m.index]=_,h=_.colSpan-1,o[m.index]={left:_.rowSpan-1,times:h}}else h--,p++;else o[m.index].left--,h=o[m.index].times,d++}return new mB(u,l,e,f)});return c}function eP(e,r){var t={};return e.forEach(function(n){if(n.raw!=null){var a=_1e(r,n.raw);a!=null&&(t[n.dataKey]=a)}}),Object.keys(t).length>0?t:null}function _1e(e,r){if(e==="head"){if(typeof r=="object")return r.header||null;if(typeof r=="string"||typeof r=="number")return r}else if(e==="foot"&&typeof r=="object")return r.footer;return null}function j1e(e){return e.map(function(r,t){var n,a;return typeof r=="object"?a=(n=r.dataKey)!==null&&n!==void 0?n:t:a=t,new p1e(a,r,t)})}function N1e(e,r,t,n,a,i,o){var c=Jbe(n),u;e==="head"?u=a.headStyles:e==="body"?u=a.bodyStyles:e==="foot"&&(u=a.footStyles);var l=Qu({},c.table,c[e],a.styles,u),d=a.columnStyles[r.dataKey]||a.columnStyles[r.index]||{},f=e==="body"?d:{},p=e==="body"&&t%2===0?Qu({},c.alternateRow,a.alternateRowStyles):{},h=Zbe(i),y=Qu({},h,l,p,f);return Qu(y,o)}function k1e(e,r,t){var n;t===void 0&&(t={});var a=dB(e,r),i=new Map,o=[],c=[],u=[];Array.isArray(r.settings.horizontalPageBreakRepeat)?u=r.settings.horizontalPageBreakRepeat:(typeof r.settings.horizontalPageBreakRepeat=="string"||typeof r.settings.horizontalPageBreakRepeat=="number")&&(u=[r.settings.horizontalPageBreakRepeat]),u.forEach(function(p){var h=r.columns.find(function(y){return y.dataKey===p||y.index===p});h&&!i.has(h.index)&&(i.set(h.index,!0),o.push(h.index),c.push(r.columns[h.index]),a-=h.wrappedWidth)});for(var l=!0,d=(n=t?.start)!==null&&n!==void 0?n:0;d<r.columns.length;){if(i.has(d)){d++;continue}var f=r.columns[d].wrappedWidth;if(l||a>=f)l=!1,o.push(d),c.push(r.columns[d]),a-=f;else break;d++}return{colIndexes:o,columns:c,lastIndex:d-1}}function S1e(e,r){for(var t=[],n=0;n<r.columns.length;n++){var a=k1e(e,r,{start:n});a.columns.length&&(t.push(a),n=a.lastIndex)}return t}function xB(e,r){var t=r.settings,n=t.startY,a=t.margin,i={x:a.left,y:n},o=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns),c=n+a.bottom+o;if(t.pageBreak==="avoid"){var u=r.body,l=u.reduce(function(p,h){return p+h.height},0);c+=l}var d=new mm(e);(t.pageBreak==="always"||t.startY!=null&&c>d.pageSize().height)&&(bB(d),i.y=a.top),r.callWillDrawPageHooks(d,i);var f=Qu({},i);r.startPageNumber=d.pageNumber(),t.horizontalPageBreak?C1e(d,r,f,i):(d.applyStyles(d.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&r.head.forEach(function(p){return fd(d,r,p,i,r.columns)}),d.applyStyles(d.userStyles),r.body.forEach(function(p,h){var y=h===r.body.length-1;Ab(d,r,p,y,f,i,r.columns)}),d.applyStyles(d.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&r.foot.forEach(function(p){return fd(d,r,p,i,r.columns)})),cB(d,r,f,i),r.callEndPageHooks(d,i),r.finalY=i.y,e.lastAutoTable=r,d.applyStyles(d.userStyles)}function C1e(e,r,t,n){var a=S1e(e,r),i=r.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(l,d){e.applyStyles(e.userStyles),d>0?ag(e,r,t,n,l.columns,!0):tP(e,r,n,l.columns),A1e(e,r,t,n,l.columns),b5(e,r,n,l.columns)});else for(var o=-1,c=a[0],u=function(){var l=o;if(c){e.applyStyles(e.userStyles);var d=c.columns;o>=0?ag(e,r,t,n,d,!0):tP(e,r,n,d),l=rP(e,r,o+1,n,d),b5(e,r,n,d)}var f=l-o;a.slice(1).forEach(function(p){e.applyStyles(e.userStyles),ag(e,r,t,n,p.columns,!0),rP(e,r,o+1,n,p.columns,f),b5(e,r,n,p.columns)}),o=l};o<r.body.length-1;)u()}function tP(e,r,t,n){var a=r.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&r.head.forEach(function(i){return fd(e,r,i,t,n)})}function A1e(e,r,t,n,a){e.applyStyles(e.userStyles),r.body.forEach(function(i,o){var c=o===r.body.length-1;Ab(e,r,i,c,t,n,a)})}function rP(e,r,t,n,a,i){e.applyStyles(e.userStyles),i=i??r.body.length;var o=Math.min(t+i,r.body.length),c=-1;return r.body.slice(t,o).forEach(function(u,l){var d=t+l===r.body.length-1,f=vB(e,r,d,n);u.canEntireRowFit(f,a)&&(fd(e,r,u,n,a),c=t+l)}),c}function b5(e,r,t,n){var a=r.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&r.foot.forEach(function(i){return fd(e,r,i,t,n)})}function E1e(e,r,t){var n=t.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((r-a)/n);return Math.max(0,i)}function T1e(e,r,t,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,o=0,c=t.columns;o<c.length;o++){var u=c[o],l=e.cells[u.index];if(l){Array.isArray(l.text)||(l.text=[l.text]);var d=new gB(l.raw,l.styles,l.section);d=Qu(d,l),d.text=[];var f=E1e(l,r,n);l.text.length>f&&(d.text=l.text.splice(f,l.text.length));var p=n.scaleFactor(),h=n.getLineHeightFactor();l.contentHeight=l.getContentHeight(p,h),l.contentHeight>=r&&(l.contentHeight=r,d.styles.minCellHeight-=r),l.contentHeight>e.height&&(e.height=l.contentHeight),d.contentHeight=d.getContentHeight(p,h),d.contentHeight>i&&(i=d.contentHeight),a[u.index]=d}}var y=new mB(e.raw,-1,e.section,a,!0);y.height=i;for(var g=0,m=t.columns;g<m.length;g++){var u=m[g],d=y.cells[u.index];d&&(d.height=y.height);var l=e.cells[u.index];l&&(l.height=e.height)}return y}function P1e(e,r,t,n){var a=e.pageSize().height,i=n.settings.margin,o=i.top+i.bottom,c=a-o;r.section==="body"&&(c-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var u=r.getMinimumRowHeight(n.columns,e),l=u<t;if(u>c)return console.log("Will not be able to print row ".concat(r.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var d=r.hasRowSpan(n.columns),f=r.getMaxCellHeight(n.columns)>c;return f?(d&&console.log("The content of row ".concat(r.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function Ab(e,r,t,n,a,i,o){var c=vB(e,r,n,i);if(t.canEntireRowFit(c,o))fd(e,r,t,i,o);else if(P1e(e,t,c,r)){var u=T1e(t,c,r,e);fd(e,r,t,i,o),ag(e,r,a,i,o),Ab(e,r,u,n,a,i,o)}else ag(e,r,a,i,o),Ab(e,r,t,n,a,i,o)}function fd(e,r,t,n,a){n.x=r.settings.margin.left;for(var i=0,o=a;i<o.length;i++){var c=o[i],u=t.cells[c.index];if(!u){n.x+=c.width;continue}e.applyStyles(u.styles),u.x=n.x,u.y=n.y;var l=r.callCellHooks(e,r.hooks.willDrawCell,u,t,c,n);if(l===!1){n.x+=c.width;continue}O1e(e,u,n);var d=u.getTextPos();iB(u.text,d.x,d.y,{halign:u.styles.halign,valign:u.styles.valign,maxWidth:Math.ceil(u.width-u.padding("left")-u.padding("right"))},e.getDocument()),r.callCellHooks(e,r.hooks.didDrawCell,u,t,c,n),n.x+=c.width}n.y+=t.height}function O1e(e,r,t){var n=r.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=uB(n.lineWidth,n.fillColor);a&&e.rect(r.x,t.y,r.width,r.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(r.x,t.y,r.width,r.height,"F"),M1e(e,r,t,n.lineWidth))}function M1e(e,r,t,n){var a,i,o,c;n.top&&(a=t.x,i=t.y,o=t.x+r.width,c=t.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),u(n.top,a,i,o,c)),n.bottom&&(a=t.x,i=t.y+r.height,o=t.x+r.width,c=t.y+r.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),u(n.bottom,a,i,o,c)),n.left&&(a=t.x,i=t.y,o=t.x,c=t.y+r.height,n.top&&(i-=.5*n.top),n.bottom&&(c+=.5*n.bottom),u(n.left,a,i,o,c)),n.right&&(a=t.x+r.width,i=t.y,o=t.x+r.width,c=t.y+r.height,n.top&&(i-=.5*n.top),n.bottom&&(c+=.5*n.bottom),u(n.right,a,i,o,c));function u(l,d,f,p,h){e.getDocument().setLineWidth(l),e.getDocument().line(d,f,p,h,"S")}}function vB(e,r,t,n){var a=r.settings.margin.bottom,i=r.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&t)&&(a+=r.getFootHeight(r.columns)),e.pageSize().height-n.y-a}function ag(e,r,t,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),r.settings.showFoot==="everyPage"&&!i&&r.foot.forEach(function(c){return fd(e,r,c,n,a)}),r.callEndPageHooks(e,n);var o=r.settings.margin;cB(e,r,t,n),bB(e),r.pageNumber++,n.x=o.left,n.y=o.top,t.y=o.top,r.callWillDrawPageHooks(e,n),r.settings.showHead==="everyPage"&&(r.head.forEach(function(c){return fd(e,r,c,n,a)}),e.applyStyles(e.userStyles))}function bB(e){var r=e.pageNumber();e.setPage(r+1);var t=e.pageNumber();return t===r?(e.addPage(),!0):!1}function I1e(e){e.API.autoTable=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var n=r[0],a=pB(this,n),i=yB(this,a);return xB(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(r,t,n,a){iB(r,t,n,a,this)},e.API.autoTableSetDefaults=function(r){return mm.setDefaults(r,this),this},e.autoTableSetDefaults=function(r,t){mm.setDefaults(r,t)},e.API.autoTableHtmlToJson=function(r,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new mm(this),i=fB(a,r,window,t,!1),o=i.head,c=i.body,u=((n=o[0])===null||n===void 0?void 0:n.map(function(l){return l.content}))||[];return{columns:u,rows:c,data:c}}}var w5;function R1e(e,r){var t=pB(e,r),n=yB(e,t);xB(e,n)}try{if(typeof window<"u"&&window){var nP=window,sP=nP.jsPDF||((w5=nP.jspdf)===null||w5===void 0?void 0:w5.jsPDF);sP&&I1e(sP)}}catch(e){console.error("Could not apply autoTable plugin",e)}function L1e(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D"):""}function Hx(e){if(e==null)return"N/A";const r=String(e);return L1e(r)}async function j4(e,r={}){const t=new pF.Workbook;t.creator=r.author||"Huy Anh ERP",t.created=new Date,t.company=r.company||"Cng ty TNHH MTV Huy Anh";const n=t.addWorksheet("Bo co theo phng ban");n.columns=[{header:"M PB",key:"code",width:12},{header:"Phng ban",key:"name",width:30},{header:"Tng s",key:"total",width:12},{header:"Hon thnh",key:"finished",width:12},{header:"ang lm",key:"in_progress",width:12},{header:" hy",key:"cancelled",width:12},{header:"Qu hn",key:"overdue",width:12},{header:"T l HT (%)",key:"completion_rate",width:15},{header:"im TB",key:"avg_score",width:12}];const a=n.getRow(1);a.font={bold:!0,color:{argb:"FFFFFFFF"}},a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},a.alignment={vertical:"middle",horizontal:"center"},a.height=25,e.forEach(o=>{n.addRow({code:o.department_code,name:o.department_name,total:o.total_tasks,finished:o.finished_tasks,in_progress:o.in_progress_tasks,cancelled:o.cancelled_tasks,overdue:o.overdue_count,completion_rate:o.completion_rate,avg_score:o.avg_score||"N/A"})}),n.eachRow((o,c)=>{c>1&&o.eachCell(u=>{u.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},u.alignment={vertical:"middle",horizontal:"center"}})});const i=await t.xlsx.writeBuffer();_B(i,r.filename||`bao-cao-phong-ban-${new Date().getTime()}.xlsx`,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}async function wB(e,r={}){const t=new pF.Workbook;t.creator=r.author||"Huy Anh ERP",t.created=new Date,t.company=r.company||"Cng ty TNHH MTV Huy Anh";const n=t.addWorksheet("Bo co theo nhn vin");n.columns=[{header:"M NV",key:"code",width:12},{header:"H tn",key:"name",width:25},{header:"Phng ban",key:"department",width:20},{header:"Chc v",key:"position",width:20},{header:"Tng s",key:"total",width:12},{header:"Hon thnh",key:"finished",width:12},{header:"T l HT (%)",key:"completion_rate",width:15},{header:"ng hn",key:"on_time",width:12},{header:"Qu hn",key:"overdue",width:12},{header:"im TB",key:"avg_score",width:12}];const a=n.getRow(1);a.font={bold:!0,color:{argb:"FFFFFFFF"}},a.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF70AD47"}},a.alignment={vertical:"middle",horizontal:"center"},a.height=25,e.forEach(o=>{n.addRow({code:o.employee_code,name:o.employee_name,department:o.department_name,position:o.position_name,total:o.total_tasks,finished:o.finished_tasks,completion_rate:o.completion_rate,on_time:o.on_time_count,overdue:o.overdue_count,avg_score:o.avg_score||"N/A"})}),n.eachRow((o,c)=>{c>1&&o.eachCell(u=>{u.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},u.alignment={vertical:"middle",horizontal:"center"}})});const i=await t.xlsx.writeBuffer();_B(i,r.filename||`bao-cao-nhan-vien-${new Date().getTime()}.xlsx`,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}function N4(e,r={}){const t=new mr("landscape");t.setFontSize(18),t.text(Hx(r.title||"BAO CAO HOAN THANH THEO PHONG BAN"),14,15),t.setFontSize(10),t.text(`Ngay xuat: ${new Date().toLocaleDateString("vi-VN")}`,14,22),r.company&&t.text(Hx(r.company),14,27);const n=e.map(a=>[Hx(a.department_code),Hx(a.department_name),String(a.total_tasks),String(a.finished_tasks),String(a.in_progress_tasks),String(a.cancelled_tasks),String(a.overdue_count),`${a.completion_rate.toFixed(1)}%`,a.avg_score?a.avg_score.toFixed(1):"N/A"]);R1e(t,{head:[["Ma PB","Phong ban","Tong so","Hoan thanh","Dang lam","Da huy","Qua han","Ty le HT","Diem TB"]],body:n,startY:35,theme:"grid",headStyles:{fillColor:[68,114,196],fontSize:10,fontStyle:"bold",halign:"center"},bodyStyles:{fontSize:9,halign:"center"},columnStyles:{1:{halign:"left",cellWidth:50}}}),t.save(r.filename||`bao-cao-phong-ban-${new Date().getTime()}.pdf`)}function _B(e,r,t){const n=e instanceof Blob?e:new Blob([e],{type:t}),a=window.URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=r,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a)}const aP=["#10b981","#f59e0b","#ef4444","#3b82f6","#8b5cf6"],D1e=[{key:"department",label:"Theo phng ban",icon:$r},{key:"position",label:"Theo chc v",icon:Fb},{key:"employee",label:"Theo nhn vin",icon:_i},{key:"timeline",label:"Theo thi gian",icon:dn}];function F1e(){const[e,r]=R.useState("department"),[t,n]=R.useState({start_date:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end_date:new Date().toISOString().split("T")[0]}),[a,i]=R.useState(!1),[o,c]=R.useState(!1),{data:u,isLoading:l}=gr({queryKey:["completion-by-department",t],queryFn:()=>Yu.getCompletionByDepartment(t),enabled:e==="department"}),{data:d,isLoading:f}=gr({queryKey:["completion-by-position",t],queryFn:()=>Yu.getCompletionByPosition(t),enabled:e==="position"}),{data:p,isLoading:h}=gr({queryKey:["completion-by-employee",t],queryFn:()=>Yu.getCompletionByEmployee(t),enabled:e==="employee"}),{data:y,isLoading:g}=gr({queryKey:["completion-timeline",t],queryFn:()=>Yu.getTimeSeriesData({start_date:t.start_date,end_date:t.end_date}),enabled:e==="timeline"}),m=async()=>{c(!0),i(!1);try{const P={title:"Bo co hon thnh cng vic",company:"Cng ty TNHH MTV Huy Anh"};switch(e){case"department":u&&await j4(u,{...P,filename:`bao-cao-phong-ban-${t.start_date}-${t.end_date}.xlsx`});break;case"employee":p&&await wB(p,{...P,filename:`bao-cao-nhan-vien-${t.start_date}-${t.end_date}.xlsx`});break;case"position":if(d){const B=d.map(T=>({department_id:T.position_id,department_code:T.position_code,department_name:T.position_name,total_tasks:T.total_tasks,finished_tasks:T.finished_tasks,in_progress_tasks:T.in_progress_tasks,cancelled_tasks:T.cancelled_tasks,completion_rate:T.completion_rate,avg_score:T.avg_score,overdue_count:T.overdue_count}));await j4(B,{...P,filename:`bao-cao-chuc-vu-${t.start_date}-${t.end_date}.xlsx`})}break;default:alert("Ch  xem ny cha h tr xut Excel")}}catch(P){console.error("Export Excel error:",P),alert("C li khi xut Excel. Vui lng th li.")}finally{c(!1)}},x=()=>{c(!0),i(!1);try{const P={title:"BO CO HON THNH CNG VIC",company:"Cng ty TNHH MTV Huy Anh"};switch(e){case"department":u&&N4(u,{...P,filename:`bao-cao-phong-ban-${t.start_date}-${t.end_date}.pdf`});break;case"position":if(d){const B=d.map(T=>({department_id:T.position_id,department_code:T.position_code,department_name:T.position_name,total_tasks:T.total_tasks,finished_tasks:T.finished_tasks,in_progress_tasks:T.in_progress_tasks,cancelled_tasks:T.cancelled_tasks,completion_rate:T.completion_rate,avg_score:T.avg_score,overdue_count:T.overdue_count}));N4(B,{...P,title:"BO CO THEO CHC V",filename:`bao-cao-chuc-vu-${t.start_date}-${t.end_date}.pdf`})}break;default:alert("Ch  xem ny cha h tr xut PDF")}}catch(P){console.error("Export PDF error:",P),alert("C li khi xut PDF. Vui lng th li.")}finally{c(!1)}},v=()=>{if(l)return s.jsx(Wx,{});if(!u||u.length===0)return s.jsx(Kx,{});const P=u.map(T=>({name:T.department_code,"Hon thnh":T.finished_tasks,"ang lm":T.in_progress_tasks," hy":T.cancelled_tasks})),B=u.map(T=>({name:T.department_name,value:T.finished_tasks}));return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:u.slice(0,3).map(T=>s.jsx(nf,{title:T.department_name,value:`${T.completion_rate}%`,subtitle:`${T.finished_tasks}/${T.total_tasks} cng vic`,color:"blue"},T.department_id))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Vx,{title:"Thng k theo phng ban",children:s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(yb,{data:P,children:[s.jsx(Sf,{strokeDasharray:"3 3"}),s.jsx(Cf,{dataKey:"name"}),s.jsx(Af,{}),s.jsx(Xu,{}),s.jsx(lm,{}),s.jsx(zc,{dataKey:"Hon thnh",fill:"#10b981"}),s.jsx(zc,{dataKey:"ang lm",fill:"#f59e0b"}),s.jsx(zc,{dataKey:" hy",fill:"#ef4444"})]})})}),s.jsx(Vx,{title:"T l trng thi",children:s.jsx(Wu,{width:"100%",height:300,children:s.jsxs(s6,{children:[s.jsx(B1,{data:B,cx:"50%",cy:"50%",labelLine:!1,label:({name:T,percent:I})=>`${T}: ${((I||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:B.map((T,I)=>s.jsx(Jf,{fill:aP[I%aP.length]},`cell-${I}`))}),s.jsx(Xu,{})]})})})]}),s.jsx(B1e,{data:u})]})},w=()=>{if(f)return s.jsx(Wx,{});if(!d||d.length===0)return s.jsx(Kx,{});const P=d.map(B=>({name:B.position_name,"Hon thnh":B.finished_tasks,"ang lm":B.in_progress_tasks,rate:B.completion_rate}));return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:d.slice(0,4).map(B=>s.jsx(nf,{title:B.position_name,value:`${B.completion_rate}%`,subtitle:`${B.finished_tasks} cng vic`,color:"green"},B.position_id))}),s.jsx(Vx,{title:"Thng k theo chc v",children:s.jsx(Wu,{width:"100%",height:400,children:s.jsxs(yb,{data:P,layout:"horizontal",children:[s.jsx(Sf,{strokeDasharray:"3 3"}),s.jsx(Cf,{type:"number"}),s.jsx(Af,{dataKey:"name",type:"category",width:150}),s.jsx(Xu,{}),s.jsx(lm,{}),s.jsx(zc,{dataKey:"Hon thnh",fill:"#10b981"}),s.jsx(zc,{dataKey:"ang lm",fill:"#f59e0b"})]})})}),s.jsx($1e,{data:d})]})},_=()=>h?s.jsx(Wx,{}):!p||p.length===0?s.jsx(Kx,{}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.slice(0,3).map((P,B)=>s.jsx(nf,{title:P.employee_name,value:`${P.completion_rate}%`,subtitle:`${P.department_name} - ${P.position_name}`,badge:B===0?" Top 1":B===1?" Top 2":" Top 3",color:B===0?"yellow":B===1?"gray":"orange"},P.employee_id))}),s.jsx(q1e,{data:p})]}),A=()=>{if(g)return s.jsx(Wx,{});if(!y||y.length===0)return s.jsx(Kx,{});const P=y.map(B=>({date:B.period_label,"Tng s":B.total_tasks,"Hon thnh":B.finished_tasks,"ang lm":B.in_progress_tasks,"T l":B.completion_rate}));return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(nf,{title:"Tng cng vic",value:y.reduce((B,T)=>B+T.total_tasks,0).toString(),color:"blue"}),s.jsx(nf,{title:" hon thnh",value:y.reduce((B,T)=>B+T.finished_tasks,0).toString(),color:"green"}),s.jsx(nf,{title:"ang lm",value:y.reduce((B,T)=>B+T.in_progress_tasks,0).toString(),color:"yellow"}),s.jsx(nf,{title:"Trung bnh",value:`${(y.reduce((B,T)=>B+T.completion_rate,0)/y.length).toFixed(1)}%`,color:"purple"})]}),s.jsx(Vx,{title:"Biu  theo thi gian",children:s.jsx(Wu,{width:"100%",height:400,children:s.jsxs(HD,{data:P,children:[s.jsx(Sf,{strokeDasharray:"3 3"}),s.jsx(Cf,{dataKey:"date"}),s.jsx(Af,{}),s.jsx(Xu,{}),s.jsx(lm,{}),s.jsx(um,{type:"monotone",dataKey:"Tng s",stroke:"#3b82f6",strokeWidth:2}),s.jsx(um,{type:"monotone",dataKey:"Hon thnh",stroke:"#10b981",strokeWidth:2}),s.jsx(um,{type:"monotone",dataKey:"ang lm",stroke:"#f59e0b",strokeWidth:2})]})})})]})};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:D1e.map(P=>{const B=P.icon,T=e===P.key;return s.jsxs("button",{onClick:()=>r(P.key),className:`
                flex items-center gap-2 px-4 py-2.5 rounded-lg
                font-medium text-sm whitespace-nowrap transition-all
                ${T?"bg-blue-500 text-white shadow-lg":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}
              `,children:[s.jsx(B,{className:"w-4 h-4"}),s.jsx("span",{children:P.label})]},P.key)})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dn,{className:"w-5 h-5 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Khong thi gian:"})]}),s.jsx("input",{type:"date",value:t.start_date,onChange:P=>n(B=>({...B,start_date:P.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),s.jsx("span",{className:"text-gray-500",children:"n"}),s.jsx("input",{type:"date",value:t.end_date,onChange:P=>n(B=>({...B,end_date:P.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),s.jsxs("div",{className:"ml-auto relative",children:[s.jsxs("button",{onClick:()=>i(!a),disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Wg,{className:"w-4 h-4"}),s.jsx("span",{children:"Xut bo co"}),s.jsx(Gs,{className:"w-4 h-4"})]}),a&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[s.jsxs("button",{onClick:m,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(zb,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{children:"Xut Excel (.xlsx)"})]}),s.jsxs("button",{onClick:x,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(vr,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{children:"Xut PDF (.pdf)"})]})]})]})]})}),e==="department"&&v(),e==="position"&&w(),e==="employee"&&_(),e==="timeline"&&A()]})}function nf({title:e,value:r,subtitle:t,badge:n,color:a="blue"}){const i={blue:"from-blue-500 to-blue-600",green:"from-green-500 to-green-600",yellow:"from-yellow-500 to-yellow-600",purple:"from-purple-500 to-purple-600",orange:"from-orange-500 to-orange-600",gray:"from-gray-500 to-gray-600"};return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[n&&s.jsx("div",{className:"text-xs font-medium text-blue-600 mb-2",children:n}),s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e}),s.jsx("div",{className:`text-2xl font-bold bg-gradient-to-r ${i[a]} bg-clip-text text-transparent`,children:r}),t&&s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t})]})}function Vx({title:e,children:r}){return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e}),r]})}function B1e({data:e}){return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tng s"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Hon thnh"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ang lm"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Qu hn"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T l HT"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"im TB"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(r=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx($r,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:r.department_name}),s.jsx("div",{className:"text-xs text-gray-500",children:r.department_code})]})]})}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-900",children:r.total_tasks}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-green-600 font-medium",children:r.finished_tasks}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-yellow-600",children:r.in_progress_tasks}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-red-600",children:r.overdue_count}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${r.completion_rate}%`}})}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[r.completion_rate,"%"]})]})}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-900",children:r.avg_score?r.avg_score.toFixed(1):"N/A"})]},r.department_id))})]})})}function $1e({data:e}){return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Chc v"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tng s"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Hon thnh"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T l HT"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(r=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:r.position_name}),s.jsx("td",{className:"px-4 py-3 text-center text-sm",children:r.total_tasks}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-green-600",children:r.finished_tasks}),s.jsxs("td",{className:"px-4 py-3 text-center text-sm font-medium",children:[r.completion_rate,"%"]})]},r.position_id))})]})})}function q1e({data:e}){return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Hon thnh"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ng hn"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T l HT"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(r=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-4 py-3",children:[s.jsx("div",{className:"font-medium text-gray-900",children:r.employee_name}),s.jsx("div",{className:"text-xs text-gray-500",children:r.employee_code})]}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:r.department_name}),s.jsxs("td",{className:"px-4 py-3 text-center text-sm",children:[r.finished_tasks,"/",r.total_tasks]}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-green-600",children:r.on_time_count}),s.jsxs("td",{className:"px-4 py-3 text-center text-sm font-medium",children:[r.completion_rate,"%"]})]},r.employee_id))})]})})}function Wx(){return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})}function Kx(){return s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[s.jsx(md,{className:"w-16 h-16 mb-4 text-gray-400"}),s.jsx("p",{className:"text-lg font-medium",children:"Cha c d liu nh gi"}),s.jsx("p",{className:"text-sm",children:"Chn khong thi gian khc  xem bo co"})]})}const z1e=()=>{const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(e.getFullYear(),e.getMonth()+1,0);return{start_date:r.toISOString().split("T")[0],end_date:t.toISOString().split("T")[0]}},U1e=e=>{const r=new Date;let t,n=r;switch(e){case"this_month":t=new Date(r.getFullYear(),r.getMonth(),1),n=new Date(r.getFullYear(),r.getMonth()+1,0);break;case"last_month":t=new Date(r.getFullYear(),r.getMonth()-1,1),n=new Date(r.getFullYear(),r.getMonth(),0);break;case"this_quarter":const a=Math.floor(r.getMonth()/3);t=new Date(r.getFullYear(),a*3,1),n=new Date(r.getFullYear(),a*3+3,0);break;case"this_year":t=new Date(r.getFullYear(),0,1),n=new Date(r.getFullYear(),11,31);break;default:t=new Date(r.getFullYear(),r.getMonth(),1),n=new Date(r.getFullYear(),r.getMonth()+1,0)}return{start_date:t.toISOString().split("T")[0],end_date:n.toISOString().split("T")[0]}};function H1e(){const[e,r]=R.useState(!1),[t,n]=R.useState(!0),[a,i]=R.useState(z1e()),[o,c]=R.useState(null),[u,l]=R.useState([]),[d,f]=R.useState([]),[p,h]=R.useState([]),[y,g]=R.useState({});R.useEffect(()=>{m(),x()},[]);const m=async()=>{try{const T=await zi.getAllActive();h(T)}catch(T){console.error("Error loading departments:",T)}},x=async()=>{r(!0),g({});try{const T=await Yu.getPerformanceMetrics({department_id:a.department_id,start_date:a.start_date,end_date:a.end_date});c(T)}catch(T){console.error("Error loading metrics:",T),g(I=>({...I,metrics:"Khng th ti d liu metrics"}))}try{const T=await Yu.getTopPerformers({department_id:a.department_id,start_date:a.start_date,end_date:a.end_date,limit:10});l(T)}catch(T){console.error("Error loading top performers:",T),g(I=>({...I,performers:"Khng th ti top performers"}))}try{const T=await Yu.getOverdueTasks({department_id:a.department_id,start_date:a.start_date,end_date:a.end_date,limit:20});f(T)}catch(T){console.error("Error loading overdue tasks:",T),f([]),g(I=>({...I,overdue:"Chc nng cng vic qu hn cha kh dng"}))}r(!1)},v=()=>{x()},w=T=>{const I=U1e(T);i(U=>({...U,...I}))},_=()=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsxs("button",{onClick:()=>n(!t),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Al,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium text-gray-900",children:"B lc"})]}),t?s.jsx(si,{className:"w-5 h-5 text-gray-500"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-500"})]}),t&&s.jsxs("div",{className:"p-4 pt-0 space-y-4 border-t border-gray-200",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx(dn,{className:"w-4 h-4 inline mr-2"}),"T ngy"]}),s.jsx("input",{type:"date",value:a.start_date,onChange:T=>i(I=>({...I,start_date:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx(dn,{className:"w-4 h-4 inline mr-2"}),"n ngy"]}),s.jsx("input",{type:"date",value:a.end_date,onChange:T=>i(I=>({...I,end_date:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx($r,{className:"w-4 h-4 inline mr-2"}),"Phng ban"]}),s.jsxs("select",{value:a.department_id||"",onChange:T=>i(I=>({...I,department_id:T.target.value||void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tt c"}),p.map(T=>s.jsx("option",{value:T.id,children:T.name},T.id))]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Khong thi gian"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx("button",{onClick:()=>w("this_month"),className:"px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Thng ny"}),s.jsx("button",{onClick:()=>w("last_month"),className:"px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Thng trc"}),s.jsx("button",{onClick:()=>w("this_quarter"),className:"px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Qu ny"}),s.jsx("button",{onClick:()=>w("this_year"),className:"px-3 py-2 text-xs bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Nm nay"})]})]})]}),s.jsx("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:s.jsxs("button",{onClick:v,disabled:e,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e?s.jsx(Vr,{className:"w-4 h-4 animate-spin"}):s.jsx(Vr,{className:"w-4 h-4"}),s.jsx("span",{children:"Lm mi"})]})})]})]}),A=()=>{if(y.metrics)return s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:s.jsx("p",{className:"text-yellow-800 text-sm",children:y.metrics})});if(!o)return s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(I=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),s.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4"})]},I))});const T=[{label:"Tng cng vic",value:o.total_tasks,icon:Vb,color:"bg-blue-500",textColor:"text-blue-600"},{label:"T l hon thnh",value:`${o.completion_rate}%`,icon:Un,color:"bg-green-500",textColor:"text-green-600"},{label:"ng hn",value:`${o.on_time_rate}%`,icon:Xr,color:"bg-purple-500",textColor:"text-purple-600"},{label:"Qu hn",value:o.overdue_count,icon:ua,color:"bg-red-500",textColor:"text-red-600"}];return s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:T.map((I,U)=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${I.color}`,children:s.jsx(I.icon,{className:"w-5 h-5 text-white"})}),s.jsx("span",{className:"text-sm text-gray-600",children:I.label})]}),s.jsx("p",{className:`text-3xl font-bold ${I.textColor}`,children:I.value})]},U))})},P=()=>y.performers?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(ix,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performers"})]}),s.jsx("p",{className:"text-yellow-600 text-sm",children:y.performers})]}):u.length===0?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(ix,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Performers"})]}),s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ix,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Cha c d liu nh gi"})]})]}):s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ix,{className:"w-5 h-5 text-yellow-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top 10 Performers"})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hng"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nhn vin"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Hon thnh"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"T l HT"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"ng hn"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map((T,I)=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"flex items-center justify-center",children:I<3?s.jsx(Mm,{className:`w-6 h-6 ${I===0?"text-yellow-500":I===1?"text-gray-400":"text-orange-400"}`}):s.jsx("span",{className:"text-gray-500 font-medium",children:I+1})})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:T.employee_name}),s.jsx("p",{className:"text-xs text-gray-500",children:T.employee_code})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"text-sm text-gray-600",children:T.department_name})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsx("span",{className:"font-semibold text-green-600",children:T.finished_tasks})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${T.completion_rate}%`}})}),s.jsxs("span",{className:"text-sm text-gray-900",children:[T.completion_rate,"%"]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsxs("span",{className:"text-sm text-purple-600",children:[T.on_time_rate,"%"]})})]},T.employee_id))})]})})]}),B=()=>y.overdue?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Kr,{className:"w-5 h-5 text-red-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cng vic qu hn"})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-yellow-800 text-sm",children:y.overdue}),s.jsx("p",{className:"text-yellow-600 text-xs mt-2",children:"Vui lng chy SQL migration  kch hot tnh nng ny."})]})]}):d.length===0?s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Kr,{className:"w-5 h-5 text-red-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Cng vic qu hn"})]}),s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Un,{className:"w-12 h-12 text-green-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Khng c cng vic qu hn"})]})]}):s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Kr,{className:"w-5 h-5 text-red-500"}),s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Cng vic qu hn (",d.length,")"]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-red-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-red-700 uppercase",children:"M CV"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-red-700 uppercase",children:"Cng vic"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-red-700 uppercase",children:"Nhn vin"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-red-700 uppercase",children:"Phng ban"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-red-700 uppercase",children:"Hn HT"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-red-700 uppercase",children:"Qu hn"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(T=>s.jsxs("tr",{className:"hover:bg-red-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"text-sm font-medium text-gray-900",children:T.task_code})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("p",{className:"text-sm text-gray-900 max-w-xs truncate",children:T.task_name})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"text-sm text-gray-600",children:T.assignee_name})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:"text-sm text-gray-600",children:T.department_name})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsx("span",{className:"text-sm text-gray-600",children:new Date(T.due_date).toLocaleDateString("vi-VN")})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:[T.days_overdue," ngy"]})})]},T.task_id))})]})})]});return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-200 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(md,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-indigo-900",children:"Phn tch hiu sut"}),s.jsx("p",{className:"text-xs text-indigo-700 mt-1",children:"nh gi hiu sut lm vic v top performers"})]})]})}),_(),A(),P(),B()]})}const V1e=[{value:"department",label:"Theo phng ban",icon:$r},{value:"employee",label:"Theo nhn vin",icon:$r}],W1e=[{key:"name",label:"Tn",visible:!0},{key:"total_tasks",label:"Tng s",visible:!0},{key:"finished_tasks",label:"Hon thnh",visible:!0},{key:"in_progress_tasks",label:"ang lm",visible:!0},{key:"cancelled_tasks",label:" hy",visible:!0},{key:"overdue_count",label:"Qu hn",visible:!0},{key:"completion_rate",label:"T l HT (%)",visible:!0},{key:"avg_score",label:"im TB",visible:!1}],K1e=()=>{const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(e.getFullYear(),e.getMonth()+1,0);return{start_date:r.toISOString().split("T")[0],end_date:t.toISOString().split("T")[0]}};function G1e(){const[e,r]=R.useState(!1),[t,n]=R.useState(!1),[a,i]=R.useState(!1),[o,c]=R.useState({...K1e(),department_id:void 0,group_by:"department"}),[u,l]=R.useState(W1e),[d,f]=R.useState(null),[p,h]=R.useState([]);R.useEffect(()=>{y()},[]);const y=async()=>{try{const P=await zi.getAllActive();h(P)}catch(P){console.error("Error loading dropdown data:",P)}},g=async()=>{r(!0);try{let P=[],B={total_tasks:0,finished_tasks:0,in_progress_tasks:0,cancelled_tasks:0,overdue_count:0,completion_rate:0};if(o.group_by==="department"){const T=await Yu.getCompletionByDepartment({start_date:o.start_date,end_date:o.end_date});P=o.department_id?T.filter(I=>I.department_id===o.department_id):T,P=P.map(I=>({id:I.department_id,code:I.department_code,name:I.department_name,total_tasks:I.total_tasks,finished_tasks:I.finished_tasks,in_progress_tasks:I.in_progress_tasks,cancelled_tasks:I.cancelled_tasks,overdue_count:I.overdue_count,completion_rate:I.completion_rate,avg_score:I.avg_score}))}else o.group_by==="employee"&&(P=(await Yu.getCompletionByEmployee({department_id:o.department_id,start_date:o.start_date,end_date:o.end_date})).map(I=>({id:I.employee_id,code:I.employee_code,name:I.employee_name,department_id:I.department_id,department:I.department_name,position_id:I.position_id,position:I.position_name,total_tasks:I.total_tasks,finished_tasks:I.finished_tasks,in_progress_tasks:I.in_progress_tasks,cancelled_tasks:I.cancelled_tasks,overdue_count:I.overdue_count,on_time_count:I.on_time_count,completion_rate:I.completion_rate,on_time_rate:I.on_time_rate,avg_score:I.avg_score})));B={total_tasks:P.reduce((T,I)=>T+(I.total_tasks||0),0),finished_tasks:P.reduce((T,I)=>T+(I.finished_tasks||0),0),in_progress_tasks:P.reduce((T,I)=>T+(I.in_progress_tasks||0),0),cancelled_tasks:P.reduce((T,I)=>T+(I.cancelled_tasks||0),0),overdue_count:P.reduce((T,I)=>T+(I.overdue_count||0),0),completion_rate:0},B.total_tasks>0&&(B.completion_rate=Number((B.finished_tasks/B.total_tasks*100).toFixed(1))),f({rows:P,summary:B})}catch(P){console.error("Error generating report:",P),alert("C li khi to bo co. Vui lng th li.")}finally{r(!1)}},m=async()=>{if(!d||d.rows.length===0){alert("Cha c d liu  xut");return}n(!0);try{const P={title:"Bo co ty chnh",company:"Cng ty TNHH MTV Huy Anh",filename:`bao-cao-tuy-chinh-${o.start_date}-${o.end_date}.xlsx`};if(o.group_by==="department"){const B=d.rows.map(T=>({department_id:T.id||"",department_code:T.code||"",department_name:T.name||"",total_tasks:T.total_tasks||0,finished_tasks:T.finished_tasks||0,in_progress_tasks:T.in_progress_tasks||0,cancelled_tasks:T.cancelled_tasks||0,overdue_count:T.overdue_count||0,completion_rate:T.completion_rate||0,avg_score:T.avg_score||null}));await j4(B,P)}else{const B=d.rows.map(T=>({employee_id:T.id||"",employee_code:T.code||"",employee_name:T.name||"",department_id:T.department_id||"",department_name:T.department||"",position_id:T.position_id||"",position_name:T.position||"",total_tasks:T.total_tasks||0,finished_tasks:T.finished_tasks||0,in_progress_tasks:T.in_progress_tasks||0,cancelled_tasks:T.cancelled_tasks||0,overdue_count:T.overdue_count||0,on_time_count:T.on_time_count||0,completion_rate:T.completion_rate||0,on_time_rate:T.on_time_rate||0,avg_score:T.avg_score||null}));await wB(B,{...P,filename:`bao-cao-nhan-vien-${o.start_date}-${o.end_date}.xlsx`})}}catch(P){console.error("Export Excel error:",P),alert("C li khi xut Excel. Vui lng th li.")}finally{n(!1)}},x=()=>{if(!d||d.rows.length===0){alert("Cha c d liu  xut");return}n(!0);try{const P=d.rows.map(B=>({department_id:B.id||"",department_code:B.code||"",department_name:B.name||"",total_tasks:B.total_tasks||0,finished_tasks:B.finished_tasks||0,in_progress_tasks:B.in_progress_tasks||0,cancelled_tasks:B.cancelled_tasks||0,overdue_count:B.overdue_count||0,completion_rate:B.completion_rate||0,avg_score:B.avg_score||null}));N4(P,{title:"BO CO TY CHNH",company:"Cng ty TNHH MTV Huy Anh",filename:`bao-cao-tuy-chinh-${o.start_date}-${o.end_date}.pdf`})}catch(P){console.error("Export PDF error:",P),alert("C li khi xut PDF. Vui lng th li.")}finally{n(!1)}},v=P=>{l(B=>B.map(T=>T.key===P?{...T,visible:!T.visible}:T))},w=()=>s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Al,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"B lc bo co"})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx(dn,{className:"w-4 h-4 inline mr-2"}),"T ngy"]}),s.jsx("input",{type:"date",value:o.start_date,onChange:P=>c(B=>({...B,start_date:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx(dn,{className:"w-4 h-4 inline mr-2"}),"n ngy"]}),s.jsx("input",{type:"date",value:o.end_date,onChange:P=>c(B=>({...B,end_date:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx(If,{className:"w-4 h-4 inline mr-2"}),"Nhm theo"]}),s.jsx("select",{value:o.group_by,onChange:P=>c(B=>({...B,group_by:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:V1e.map(P=>s.jsx("option",{value:P.value,children:P.label},P.value))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s.jsx($r,{className:"w-4 h-4 inline mr-2"}),"Phng ban"]}),s.jsxs("select",{value:o.department_id||"",onChange:P=>c(B=>({...B,department_id:P.target.value||void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),p.map(P=>s.jsx("option",{value:P.id,children:P.name},P.id))]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[s.jsxs("button",{onClick:g,disabled:e,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e?s.jsx(Vr,{className:"w-4 h-4 animate-spin"}):s.jsx(kO,{className:"w-4 h-4"}),s.jsx("span",{children:"To bo co"})]}),s.jsxs("button",{onClick:()=>i(!a),className:"flex items-center gap-2 px-4 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[s.jsx(sG,{className:"w-4 h-4"}),s.jsx("span",{children:"Ct hin th"}),a?s.jsx(si,{className:"w-4 h-4"}):s.jsx(Gs,{className:"w-4 h-4"})]})]}),a&&s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Chn ct hin th:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(P=>s.jsxs("button",{onClick:()=>v(P.key),className:`
                  flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm transition-colors
                  ${P.visible?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-200"}
                `,children:[P.visible?s.jsx(ja,{className:"w-3.5 h-3.5"}):s.jsx(Zx,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:P.label})]},P.key))})]})]}),_=()=>{if(!d)return null;const{summary:P}=d;return s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Tng s"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P.total_tasks})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Hon thnh"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:P.finished_tasks})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"ang lm"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:P.in_progress_tasks})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:" hy"}),s.jsx("p",{className:"text-2xl font-bold text-gray-500",children:P.cancelled_tasks})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Qu hn"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:P.overdue_count})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"T l HT"}),s.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[P.completion_rate,"%"]})]})]})},A=()=>{if(!d)return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[s.jsx(ym,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:'Chn b lc v nhn "To bo co"  xem kt qu'})]});if(d.rows.length===0)return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[s.jsx(Kr,{className:"w-12 h-12 text-yellow-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Khng c d liu trong khong thi gian ny"})]});const P=u.filter(B=>B.visible);return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Kt qu (",d.rows.length," dng)"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:m,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[s.jsx(zb,{className:"w-4 h-4"}),s.jsx("span",{children:"Xut Excel"})]}),s.jsxs("button",{onClick:x,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:[s.jsx(vr,{className:"w-4 h-4"}),s.jsx("span",{children:"Xut PDF"})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),P.map(B=>s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:B.label},B.key))]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.rows.map((B,T)=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:T+1}),P.map(I=>s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:I.key==="name"?s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-900",children:B[I.key]}),B.code&&s.jsxs("span",{className:"text-gray-500 ml-2",children:["(",B.code,")"]})]}):I.key==="completion_rate"?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${Math.min(B[I.key]||0,100)}%`}})}),s.jsxs("span",{className:"text-gray-900",children:[B[I.key],"%"]})]}):I.key==="overdue_count"&&B[I.key]>0?s.jsx("span",{className:"text-red-600 font-medium",children:B[I.key]}):I.key==="finished_tasks"?s.jsx("span",{className:"text-green-600 font-medium",children:B[I.key]}):s.jsx("span",{className:"text-gray-900",children:B[I.key]??"N/A"})},I.key))]},B.id||T))})]})})]})};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-xl p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ym,{className:"w-5 h-5 text-purple-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Bo co ty chnh"}),s.jsx("p",{className:"text-xs text-purple-700 mt-1",children:"To bo co vi cc tiu ch ty chn. Chn khong thi gian, phng ban v cch nhm d liu."})]})]})}),w(),_(),A()]})}const _5=[{key:"completion",label:"Bo co hon thnh",icon:s.jsx(If,{className:"w-4 h-4"}),description:"Thng k hon thnh theo phng ban, chc v, nhn vin"},{key:"performance",label:"Phn tch hiu sut",icon:s.jsx(md,{className:"w-4 h-4"}),description:"nh gi hiu sut lm vic v top performers"},{key:"custom",label:"Bo co ty chnh",icon:s.jsx(ym,{className:"w-4 h-4"}),description:"To bo co vi cc tiu ch ty chn"}];function X1e(){const[e,r]=R.useState("completion");return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50",children:[s.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg",children:s.jsx(vr,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bo co cng vic"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Phn tch v thng k hiu sut lm vic"})]})]}),s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:_5.map(t=>{const n=e===t.key;return s.jsxs("button",{onClick:()=>r(t.key),className:`
                    flex items-center gap-2 px-4 py-2.5 rounded-lg
                    font-medium text-sm whitespace-nowrap transition-all
                    ${n?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg shadow-blue-500/30":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}
                  `,children:[t.icon,s.jsx("span",{children:t.label})]},t.key)})})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(eW,{className:"w-5 h-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-blue-900 font-medium",children:_5.find(t=>t.key===e)?.label}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:_5.find(t=>t.key===e)?.description})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e==="completion"&&s.jsx(F1e,{}),e==="performance"&&s.jsx(H1e,{}),e==="custom"&&s.jsx(G1e,{})]})]})}function jB(e){const r=[];return e.length<8&&r.push("Mt khu phi c t nht 8 k t"),/[A-Z]/.test(e)||r.push("Mt khu phi c t nht 1 ch hoa"),/[a-z]/.test(e)||r.push("Mt khu phi c t nht 1 ch thng"),/[0-9]/.test(e)||r.push("Mt khu phi c t nht 1 s"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)||r.push("Mt khu phi c t nht 1 k t c bit (!@#$%^&*...)"),{isValid:r.length===0,errors:r}}function Y1e(e){const r=[];if(e.currentPassword||r.push("Vui lng nhp mt khu hin ti"),e.newPassword||r.push("Vui lng nhp mt khu mi"),e.confirmPassword||r.push("Vui lng xc nhn mt khu mi"),e.newPassword!==e.confirmPassword&&r.push("Mt khu xc nhn khng khp"),e.currentPassword===e.newPassword&&r.push("Mt khu mi phi khc mt khu hin ti"),e.newPassword){const t=jB(e.newPassword);t.isValid||r.push(...t.errors)}return{isValid:r.length===0,errors:r}}const gm={async getCurrentUserProfile(){try{const{data:{user:e},error:r}=await se.auth.getUser();if(r||!e)return{data:null,error:new Error("Cha ng nhp")};const{data:t,error:n}=await se.from("employees").select(`
          id,
          code,
          full_name,
          email,
          phone,
          address,
          avatar_url,
          created_at,
          updated_at,
          department_id,
          position_id
        `).eq("user_id",e.id).maybeSingle();if(n)throw n;if(!t)return{data:null,error:new Error("Khng tm thy thng tin nhn vin")};let a;if(t.department_id){const{data:f}=await se.from("departments").select("id, name").eq("id",t.department_id).maybeSingle();a=f?.name}let i;if(t.position_id){const{data:f}=await se.from("positions").select("id, name").eq("id",t.position_id).maybeSingle();i=f?.name}const{data:o,error:c}=await se.from("employee_profiles").select("*").eq("employee_id",t.id).maybeSingle();if(c&&c.code!=="PGRST116")throw c;const{data:u}=await se.from("user_security_settings").select("last_password_change").eq("employee_id",t.id).maybeSingle(),l=t;return{data:{id:o?.id||"",employee_id:t.id,user_id:e.id,full_name:t.full_name,email:t.email,employee_code:t.code,department_name:a,position_name:i,avatar_url:t.avatar_url,phone:t.phone,address:t.address,emergency_contact_name:o?.emergency_contact_name,emergency_contact_phone:o?.emergency_contact_phone,emergency_contact_relation:o?.emergency_contact_relation,bank_account_number:o?.bank_account_number,bank_name:o?.bank_name,last_password_change:u?.last_password_change,created_at:o?.created_at||l.created_at||"",updated_at:o?.updated_at||l.updated_at||""},error:null}}catch(e){return console.error(" [userSettingsService] getCurrentUserProfile error:",e),{data:null,error:e}}},async updateProfile(e,r){try{console.log(" [userSettingsService] updateProfile:",{employeeId:e,updates:r});const t={};if(r.phone!==void 0&&(t.phone=r.phone),r.address!==void 0&&(t.address=r.address),Object.keys(t).length>0){t.updated_at=new Date().toISOString();const{error:a}=await se.from("employees").update(t).eq("id",e);if(a)throw a}const n={};if(r.emergency_contact_name!==void 0&&(n.emergency_contact_name=r.emergency_contact_name),r.emergency_contact_phone!==void 0&&(n.emergency_contact_phone=r.emergency_contact_phone),r.emergency_contact_relation!==void 0&&(n.emergency_contact_relation=r.emergency_contact_relation),r.bank_account_number!==void 0&&(n.bank_account_number=r.bank_account_number),r.bank_name!==void 0&&(n.bank_name=r.bank_name),Object.keys(n).length>0){n.employee_id=e,n.updated_at=new Date().toISOString();const{error:a}=await se.from("employee_profiles").upsert(n,{onConflict:"employee_id"});if(a)throw a}return console.log(" [userSettingsService] Profile updated successfully"),{success:!0,error:null}}catch(t){return console.error(" [userSettingsService] updateProfile error:",t),{success:!1,error:t}}},async uploadAvatar(e,r){try{console.log(" [userSettingsService] uploadAvatar:",{employeeId:e,fileName:r.name});const t=2*1024*1024;if(r.size>t)return{success:!1,error:"nh khng c vt qu 2MB"};if(!["image/jpeg","image/png","image/webp"].includes(r.type))return{success:!1,error:"Ch chp nhn file JPG, PNG hoc WebP"};const a=r.name.split(".").pop(),o=`avatars/${`${e}-${Date.now()}.${a}`}`,{error:c}=await se.storage.from("employee-files").upload(o,r,{cacheControl:"3600",upsert:!0});if(c)throw c;const{data:{publicUrl:u}}=se.storage.from("employee-files").getPublicUrl(o),{error:l}=await se.from("employees").update({avatar_url:u,updated_at:new Date().toISOString()}).eq("id",e);if(l)throw l;return console.log(" [userSettingsService] Avatar uploaded:",u),{success:!0,url:u}}catch(t){return console.error(" [userSettingsService] uploadAvatar error:",t),{success:!1,error:t.message}}},async removeAvatar(e){try{const{error:r}=await se.from("employees").update({avatar_url:null,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;return console.log(" [userSettingsService] Avatar removed"),{success:!0,error:null}}catch(r){return console.error(" [userSettingsService] removeAvatar error:",r),{success:!1,error:r}}},async changePassword(e){try{console.log(" [userSettingsService] changePassword");const r=Y1e(e);if(!r.isValid)return{success:!1,error:r.errors.join(". ")};const{data:{user:t}}=await se.auth.getUser();if(!t?.email)return{success:!1,error:"Khng tm thy thng tin user"};const{error:n}=await se.auth.signInWithPassword({email:t.email,password:e.currentPassword});if(n)return{success:!1,error:"Mt khu hin ti khng ng"};const{error:a}=await se.auth.updateUser({password:e.newPassword});if(a)return console.error("Password update error:",a),{success:!1,error:"Khng th cp nht mt khu. Vui lng th li."};const{data:i}=await se.from("employees").select("id").eq("user_id",t.id).single();return i&&await se.from("user_security_settings").upsert({employee_id:i.id,last_password_change:new Date().toISOString(),updated_at:new Date().toISOString()},{onConflict:"employee_id"}),console.log(" [userSettingsService] Password changed successfully"),{success:!0,message:"i mt khu thnh cng!"}}catch(r){return console.error(" [userSettingsService] changePassword error:",r),{success:!1,error:"C li xy ra. Vui lng th li."}}},async checkPasswordExpiry(e){try{const{data:r}=await se.from("user_security_settings").select("last_password_change, require_password_change").eq("employee_id",e).maybeSingle();if(r?.require_password_change)return{isExpired:!0,daysSinceChange:null,message:"Bn cn i mt khu theo yu cu ca Admin"};if(!r?.last_password_change)return{isExpired:!1,daysSinceChange:null};const t=new Date(r.last_password_change),a=Math.floor((new Date().getTime()-t.getTime())/(1e3*60*60*24)),i=90,o=a>=i;return{isExpired:o,daysSinceChange:a,message:o?`Mt khu  qu ${i} ngy. Khuyn ngh i mt khu mi.`:void 0}}catch(r){return console.error(" [userSettingsService] checkPasswordExpiry error:",r),{isExpired:!1,daysSinceChange:null}}}},Q1e=[{label:"t nht 8 k t",validator:e=>e.length>=8},{label:"C ch hoa (A-Z)",validator:e=>/[A-Z]/.test(e)},{label:"C ch thng (a-z)",validator:e=>/[a-z]/.test(e)},{label:"C s (0-9)",validator:e=>/[0-9]/.test(e)},{label:"C k t c bit (!@#$...)",validator:e=>/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)}];function Z1e(){const[e,r]=R.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[t,n]=R.useState(!1),[a,i]=R.useState(!1),[o,c]=R.useState(!1),[u,l]=R.useState(!1),[d,f]=R.useState(null),[p,h]=R.useState(!1),y=(w,_)=>{r(A=>({...A,[w]:_})),f(null),h(!1)},g=async w=>{w.preventDefault(),f(null),h(!1),l(!0);try{const _=await gm.changePassword(e);_.success?(h(!0),r({currentPassword:"",newPassword:"",confirmPassword:""})):f(_.error||"i mt khu tht bi")}catch{f("C li xy ra. Vui lng th li.")}finally{l(!1)}},m=jB(e.newPassword),x=e.newPassword===e.confirmPassword&&e.confirmPassword!=="",v=e.currentPassword!==""&&m.isValid&&x&&!u;return s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(da,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"i mt khu"}),s.jsx("p",{className:"text-sm text-gray-500",children:"m bo ti khon ca bn c bo mt"})]})]})}),s.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[p&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx(zK,{className:"w-5 h-5 text-green-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-green-800",children:"i mt khu thnh cng!"}),s.jsx("p",{className:"text-sm text-green-600",children:"Mt khu mi  c p dng cho ti khon ca bn."})]})]}),d&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-600"}),s.jsx("p",{className:"text-red-800",children:d})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mt khu hin ti ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:t?"text":"password",value:e.currentPassword,onChange:w=>y("currentPassword",w.target.value),className:"w-full px-4 py-2.5 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhp mt khu hin ti",disabled:u}),s.jsx("button",{type:"button",onClick:()=>n(!t),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:t?s.jsx(Zx,{className:"w-5 h-5"}):s.jsx(ja,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mt khu mi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:a?"text":"password",value:e.newPassword,onChange:w=>y("newPassword",w.target.value),className:"w-full px-4 py-2.5 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhp mt khu mi",disabled:u}),s.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?s.jsx(Zx,{className:"w-5 h-5"}):s.jsx(ja,{className:"w-5 h-5"})})]}),e.newPassword&&s.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Yu cu mt khu:"}),s.jsx("div",{className:"space-y-1.5",children:Q1e.map((w,_)=>{const A=w.validator(e.newPassword);return s.jsxs("div",{className:`flex items-center gap-2 text-sm ${A?"text-green-600":"text-gray-500"}`,children:[A?s.jsx($i,{className:"w-4 h-4"}):s.jsx(Br,{className:"w-4 h-4"}),s.jsx("span",{children:w.label})]},_)})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Xc nhn mt khu mi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:o?"text":"password",value:e.confirmPassword,onChange:w=>y("confirmPassword",w.target.value),className:`w-full px-4 py-2.5 pr-12 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${e.confirmPassword&&!x?"border-red-300 bg-red-50":e.confirmPassword&&x?"border-green-300 bg-green-50":"border-gray-300"}`,placeholder:"Nhp li mt khu mi",disabled:u}),s.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?s.jsx(Zx,{className:"w-5 h-5"}):s.jsx(ja,{className:"w-5 h-5"})})]}),e.confirmPassword&&!x&&s.jsxs("p",{className:"mt-1.5 text-sm text-red-600 flex items-center gap-1",children:[s.jsx(Br,{className:"w-4 h-4"}),"Mt khu xc nhn khng khp"]}),e.confirmPassword&&x&&s.jsxs("p",{className:"mt-1.5 text-sm text-green-600 flex items-center gap-1",children:[s.jsx($i,{className:"w-4 h-4"}),"Mt khu khp"]})]}),s.jsx("div",{className:"pt-4 border-t border-gray-200",children:s.jsx("button",{type:"submit",disabled:!v,className:`w-full flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-medium transition-colors ${v?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:u?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-5 h-5 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"w-5 h-5"}),"i mt khu"]})})})]})]})}function J1e({profile:e,onProfileUpdate:r}){const[t,n]=R.useState({phone:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relation:"",bank_account_number:"",bank_name:""}),[a,i]=R.useState(!1),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState(!1),[p,h]=R.useState(!1);R.useEffect(()=>{e&&n({phone:e.phone||"",address:e.address||"",emergency_contact_name:e.emergency_contact_name||"",emergency_contact_phone:e.emergency_contact_phone||"",emergency_contact_relation:e.emergency_contact_relation||"",bank_account_number:e.bank_account_number||"",bank_name:e.bank_name||""})},[e]);const y=(w,_)=>{n(A=>({...A,[w]:_})),l(null),f(!1)},g=async()=>{if(e?.employee_id){c(!0),l(null);try{const w=await gm.updateProfile(e.employee_id,t);w.success?(f(!0),i(!1),r?.(),setTimeout(()=>f(!1),3e3)):l(w.error?.message||"Lu tht bi")}catch{l("C li xy ra. Vui lng th li.")}finally{c(!1)}}},m=()=>{e&&n({phone:e.phone||"",address:e.address||"",emergency_contact_name:e.emergency_contact_name||"",emergency_contact_phone:e.emergency_contact_phone||"",emergency_contact_relation:e.emergency_contact_relation||"",bank_account_number:e.bank_account_number||"",bank_name:e.bank_name||""}),i(!1),l(null)},x=async w=>{const _=w.target.files?.[0];if(!(!_||!e?.employee_id)){h(!0),l(null);try{const A=await gm.uploadAvatar(e.employee_id,_);A.success?r?.():l(A.error||"Upload nh tht bi")}catch{l("C li xy ra khi upload nh")}finally{h(!1)}}},v=async()=>{if(e?.employee_id&&confirm("Bn c chc mun xa nh i din?")){h(!0);try{(await gm.removeAvatar(e.employee_id)).success&&r?.()}finally{h(!1)}}};return e?s.jsxs("div",{className:"space-y-6",children:[d&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx($i,{className:"w-5 h-5 text-green-600"}),s.jsx("p",{className:"text-green-800",children:" lu thay i thnh cng!"})]}),u&&s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-600"}),s.jsx("p",{className:"text-red-800",children:u})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-8",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-white shadow-lg overflow-hidden",children:e.avatar_url?s.jsx("img",{src:e.avatar_url,alt:e.full_name,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-blue-100 flex items-center justify-center",children:s.jsx("span",{className:"text-3xl font-bold text-blue-600",children:e.full_name.charAt(0).toUpperCase()})})}),s.jsxs("div",{className:"absolute -bottom-1 -right-1 flex gap-1",children:[s.jsxs("label",{className:"p-1.5 bg-white rounded-full shadow cursor-pointer hover:bg-gray-50 transition-colors",children:[s.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:x,className:"hidden",disabled:p}),p?s.jsx(Mt,{className:"w-4 h-4 text-gray-400 animate-spin"}):s.jsx(QV,{className:"w-4 h-4 text-gray-600"})]}),e.avatar_url&&s.jsx("button",{onClick:v,disabled:p,className:"p-1.5 bg-white rounded-full shadow hover:bg-red-50 transition-colors",title:"Xa nh",children:s.jsx(En,{className:"w-4 h-4 text-red-500"})})]})]}),s.jsxs("div",{className:"text-white",children:[s.jsx("h2",{className:"text-2xl font-bold",children:e.full_name}),s.jsxs("p",{className:"text-blue-100 mt-1",children:["M NV: ",e.employee_code]}),s.jsxs("div",{className:"flex items-center gap-4 mt-2 text-blue-100",children:[e.department_name&&s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx($r,{className:"w-4 h-4"}),e.department_name]}),e.position_name&&s.jsxs("span",{className:"flex items-center gap-1.5",children:[s.jsx(Fb,{className:"w-4 h-4"}),e.position_name]})]})]})]})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin c nhn"}),a?s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:m,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Hy"}),s.jsxs("button",{onClick:g,disabled:o,className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 rounded-lg transition-colors flex items-center gap-2",children:[o?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(ai,{className:"w-4 h-4"}),"Lu"]})]}):s.jsx("button",{onClick:()=>i(!0),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"Chnh sa"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:[s.jsx(gg,{className:"w-4 h-4 inline mr-1.5"}),"Email"]}),s.jsxs("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:[e.email,s.jsx("span",{className:"ml-2 px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:" xc minh"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:[s.jsx(_f,{className:"w-4 h-4 inline mr-1.5"}),"S in thoi"]}),a?s.jsx("input",{type:"tel",value:t.phone,onChange:w=>y("phone",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhp s in thoi"}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.phone||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:[s.jsx(dc,{className:"w-4 h-4 inline mr-1.5"}),"a ch"]}),a?s.jsx("textarea",{value:t.address,onChange:w=>y("address",w.target.value),rows:2,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Nhp a ch"}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.address||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:s.jsx(VW,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lin h khn cp"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Thng tin ngi thn  lin h khi cn thit"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:"H tn"}),a?s.jsx("input",{type:"text",value:t.emergency_contact_name,onChange:w=>y("emergency_contact_name",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"H tn ngi lin h"}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.emergency_contact_name||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:"S in thoi"}),a?s.jsx("input",{type:"tel",value:t.emergency_contact_phone,onChange:w=>y("emergency_contact_phone",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"S in thoi"}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.emergency_contact_phone||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:"Mi quan h"}),a?s.jsxs("select",{value:t.emergency_contact_relation,onChange:w=>y("emergency_contact_relation",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"-- Chn --"}),s.jsx("option",{value:"B",children:"B"}),s.jsx("option",{value:"M",children:"M"}),s.jsx("option",{value:"V",children:"V"}),s.jsx("option",{value:"Chng",children:"Chng"}),s.jsx("option",{value:"Con",children:"Con"}),s.jsx("option",{value:"Anh/Ch/Em",children:"Anh/Ch/Em"}),s.jsx("option",{value:"Bn b",children:"Bn b"}),s.jsx("option",{value:"Khc",children:"Khc"})]}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.emergency_contact_relation||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(lc,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thng tin ngn hng"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Dng  nhn lng v cc khon thanh ton"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:"Ngn hng"}),a?s.jsx("input",{type:"text",value:t.bank_name,onChange:w=>y("bank_name",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"V d: Vietcombank, BIDV..."}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.bank_name||s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1.5",children:"S ti khon"}),a?s.jsx("input",{type:"text",value:t.bank_account_number,onChange:w=>y("bank_account_number",w.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhp s ti khon"}):s.jsx("div",{className:"px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:e.bank_account_number?`****${e.bank_account_number.slice(-4)}`:s.jsx("span",{className:"text-gray-400 italic",children:"Cha cp nht"})})]})]})})]})]}):s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx(Mt,{className:"w-8 h-8 animate-spin text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"ang ti thng tin..."})]})}const e2e=[{id:"profile",label:"H s c nhn",icon:s.jsx(ls,{className:"w-5 h-5"})},{id:"security",label:"Bo mt",icon:s.jsx(da,{className:"w-5 h-5"})},{id:"notifications",label:"Thng bo",icon:s.jsx(mO,{className:"w-5 h-5"}),disabled:!0,badge:"Sp ra mt"},{id:"appearance",label:"Giao din",icon:s.jsx(NO,{className:"w-5 h-5"}),disabled:!0,badge:"Sp ra mt"}];function j5(){const[e,r]=R.useState("profile"),[t,n]=R.useState(null),[a,i]=R.useState(!0),[o,c]=R.useState(null),[u,l]=R.useState(null),d=async()=>{try{i(!0),c(null);const{data:f,error:p}=await gm.getCurrentUserProfile();if(p){c(p.message);return}if(n(f),f?.employee_id){const h=await gm.checkPasswordExpiry(f.employee_id);l(h)}}catch{c("Khng th ti thng tin. Vui lng th li.")}finally{i(!1)}};return R.useEffect(()=>{d()},[]),a?s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mt,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"ang ti thng tin..."})]})}):o&&!t?s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Kr,{className:"w-8 h-8 text-red-600"})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"C li xy ra"}),s.jsx("p",{className:"text-gray-500 mb-4",children:o}),s.jsx("button",{onClick:d,className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Th li"})]})}):s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(ym,{className:"w-6 h-6 text-blue-600"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ci t ti khon"})]}),s.jsx("p",{className:"text-gray-500",children:"Qun l thng tin c nhn v ci t bo mt cho ti khon ca bn"})]}),u?.isExpired&&s.jsxs("div",{className:"mb-6 flex items-start gap-3 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[s.jsx(Kr,{className:"w-5 h-5 text-amber-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-amber-800",children:u.message}),s.jsx("button",{onClick:()=>r("security"),className:"mt-2 text-sm text-amber-700 hover:text-amber-900 font-medium underline",children:"i mt khu ngay "})]})]}),t?.last_password_change&&u&&u.daysSinceChange!==null&&!u.isExpired&&s.jsxs("div",{className:"mb-6 flex items-center gap-2 text-sm text-gray-500",children:[s.jsx(Xr,{className:"w-4 h-4"}),s.jsxs("span",{children:["Ln i mt khu cui: ",new Date(t.last_password_change).toLocaleDateString("vi-VN"),"(",u.daysSinceChange," ngy trc)"]})]}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsxs("div",{className:"lg:w-64 flex-shrink-0",children:[s.jsx("nav",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e2e.map(f=>s.jsxs("button",{onClick:()=>!f.disabled&&r(f.id),disabled:f.disabled,className:`w-full flex items-center gap-3 px-4 py-3 text-left transition-colors ${e===f.id?"bg-blue-50 text-blue-700 border-l-4 border-blue-600":f.disabled?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-50 border-l-4 border-transparent"}`,children:[s.jsx("span",{className:e===f.id?"text-blue-600":"",children:f.icon}),s.jsx("span",{className:"font-medium",children:f.label}),f.badge&&s.jsx("span",{className:"ml-auto px-2 py-0.5 bg-gray-100 text-gray-500 text-xs rounded-full",children:f.badge})]},f.id))}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-100",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Qc,{className:"w-5 h-5 text-blue-600"}),s.jsx("h4",{className:"font-medium text-blue-900",children:"Mo bo mt"})]}),s.jsxs("ul",{className:"text-sm text-blue-700 space-y-1.5",children:[s.jsx("li",{children:" i mt khu nh k 90 ngy"}),s.jsx("li",{children:" Khng chia s mt khu vi ai"}),s.jsx("li",{children:" S dng mt khu mnh"}),s.jsx("li",{children:" ng xut khi ri my tnh"})]})]})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[e==="profile"&&s.jsx(J1e,{profile:t,onProfileUpdate:d}),e==="security"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(Z1e,{}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Thng tin bo mt"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Ln i mt khu cui"}),s.jsx("p",{className:"text-sm text-gray-500",children:t?.last_password_change?new Date(t.last_password_change).toLocaleString("vi-VN"):"Cha c thng tin"})]}),u&&u.daysSinceChange!==null&&s.jsxs("span",{className:`px-3 py-1 rounded-full text-sm ${(u.daysSinceChange||0)>60?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700"}`,children:[u.daysSinceChange," ngy trc"]})]}),s.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Xc thc 2 yu t (2FA)"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Bo v ti khon vi m xc thc b sung"})]}),s.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-500 rounded-full text-sm",children:"Sp ra mt"})]}),s.jsxs("div",{className:"flex items-center justify-between py-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Phin ng nhp"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Qun l cc thit b  ng nhp"})]}),s.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-500 rounded-full text-sm",children:"Sp ra mt"})]})]})]})]}),e==="notifications"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx(mO,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ci t thng bo"}),s.jsx("p",{className:"text-gray-500",children:"Tnh nng ny ang c pht trin v s sm ra mt."})]}),e==="appearance"&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[s.jsx(NO,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ci t giao din"}),s.jsx("p",{className:"text-gray-500",children:"Tnh nng ny ang c pht trin v s sm ra mt."})]})]})]})]})}function t2e({initialData:e,onSuccess:r,onCancel:t}){const n=!!e,[a,i]=R.useState({code:"",name:"",shift_category:"short",start_time:"06:00",end_time:"14:00",crosses_midnight:!1,standard_hours:7,break_minutes:60,late_threshold_minutes:15,early_leave_threshold_minutes:15,is_active:!0}),[o,c]=R.useState({}),[u,l]=R.useState("");R.useEffect(()=>{e&&i({code:e.code,name:e.name,shift_category:e.shift_category,start_time:e.start_time?.substring(0,5)||"06:00",end_time:e.end_time?.substring(0,5)||"14:00",crosses_midnight:e.crosses_midnight,standard_hours:e.standard_hours,break_minutes:e.break_minutes,late_threshold_minutes:e.late_threshold_minutes,early_leave_threshold_minutes:e.early_leave_threshold_minutes,is_active:e.is_active})},[e]),R.useEffect(()=>{if(a.start_time&&a.end_time){const[m,x]=a.start_time.split(":").map(Number),[v,w]=a.end_time.split(":").map(Number);let _=m*60+x,A=v*60+w;a.crosses_midnight&&A<=_&&(A+=1440);const B=A-_-a.break_minutes,T=Math.max(0,Math.round(B/60*10)/10);i(I=>({...I,standard_hours:T}))}},[a.start_time,a.end_time,a.break_minutes,a.crosses_midnight]),R.useEffect(()=>{if(a.start_time&&a.end_time){const[m]=a.start_time.split(":").map(Number),[x]=a.end_time.split(":").map(Number),v=x<m||x===m&&a.end_time<a.start_time;v!==a.crosses_midnight&&i(w=>({...w,crosses_midnight:v}))}},[a.start_time,a.end_time]);const d=nn({mutationFn:m=>Xc.create(m),onSuccess:()=>r(),onError:m=>l(m.message||"Li to ca")}),f=nn({mutationFn:m=>Xc.update(e.id,m),onSuccess:()=>r(),onError:m=>l(m.message||"Li cp nht ca")}),p=d.isPending||f.isPending,h=()=>{const m={};return a.code.trim()||(m.code="M ca l bt buc"),a.name.trim()||(m.name="Tn ca l bt buc"),a.start_time||(m.start_time="Gi bt u l bt buc"),a.end_time||(m.end_time="Gi kt thc l bt buc"),a.standard_hours<=0&&(m.standard_hours="Gi chun phi > 0"),a.break_minutes<0&&(m.break_minutes="Thi gian ngh khng hp l"),c(m),Object.keys(m).length===0},y=async m=>{if(m.preventDefault(),l(""),!h())return;if((!n||a.code!==e?.code)&&await Xc.checkCodeExists(a.code,e?.id)){c({code:"M ca  tn ti"});return}const x={...a,start_time:a.start_time+":00",end_time:a.end_time+":00"};n?f.mutate(x):d.mutate(x)},g=(m,x)=>{i(v=>({...v,[m]:x})),c(v=>({...v,[m]:""})),l("")};return s.jsxs("form",{onSubmit:y,className:"space-y-6",children:[u&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:[s.jsx(Cr,{size:16}),u]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M ca ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:a.code,onChange:m=>g("code",m.target.value.toUpperCase()),placeholder:"VD: SHORT_1",disabled:n,className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 ${o.code?"border-red-300 bg-red-50":"border-gray-300"} ${n?"bg-gray-100 cursor-not-allowed":""}`}),o.code&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:o.code})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn ca ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:a.name,onChange:m=>g("name",m.target.value),placeholder:"VD: Ca 1 (Ngn)",className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 ${o.name?"border-red-300 bg-red-50":"border-gray-300"}`}),o.name&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:o.name})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Loi ca ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"flex gap-2",children:[{value:"short",label:"Ca ngn (8h)",color:"blue"},{value:"long",label:"Ca di (12h)",color:"purple"},{value:"admin",label:"Hnh chnh",color:"green"}].map(m=>s.jsx("button",{type:"button",onClick:()=>g("shift_category",m.value),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${a.shift_category===m.value?`bg-${m.color}-100 text-${m.color}-700 ring-2 ring-${m.color}-500`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:m.label},m.value))})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gi bt u ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"time",value:a.start_time,onChange:m=>g("start_time",m.target.value),className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 ${o.start_time?"border-red-300":"border-gray-300"}`}),o.start_time&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:o.start_time})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Gi kt thc ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"time",value:a.end_time,onChange:m=>g("end_time",m.target.value),className:`w-full px-3 py-2.5 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 ${o.end_time?"border-red-300":"border-gray-300"}`}),o.end_time&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:o.end_time})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi chun (t tnh)"}),s.jsxs("div",{className:"px-3 py-2.5 border border-gray-200 rounded-lg text-sm bg-gray-50 font-medium text-blue-700",children:[a.standard_hours,"h",a.crosses_midnight&&s.jsx("span",{className:"ml-2 text-xs text-indigo-500 font-normal",children:" Qua m"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngh gii lao (pht)"}),s.jsx("input",{type:"number",min:"0",max:"120",value:a.break_minutes,onChange:m=>g("break_minutes",parseInt(m.target.value)||0),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngng tr (pht)"}),s.jsx("input",{type:"number",min:"0",max:"60",value:a.late_threshold_minutes,onChange:m=>g("late_threshold_minutes",parseInt(m.target.value)||0),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Tr > ",a.late_threshold_minutes," pht mi tnh"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngng v sm (pht)"}),s.jsx("input",{type:"number",min:"0",max:"60",value:a.early_leave_threshold_minutes,onChange:m=>g("early_leave_threshold_minutes",parseInt(m.target.value)||0),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["V sm > ",a.early_leave_threshold_minutes," pht mi tnh"]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:a.is_active,onChange:m=>g("is_active",m.target.checked),className:"sr-only peer"}),s.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-100 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]}),s.jsx("span",{className:"text-sm text-gray-700",children:a.is_active?"ang hot ng":" tt"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:t,disabled:p,className:"px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Hy"}),s.jsxs("button",{type:"submit",disabled:p,className:"flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[p?s.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):s.jsx(ai,{size:16}),n?"Cp nht":"To mi"]})]})]})}const r2e={short:"Ca ngn",long:"Ca di",admin:"HC"},n2e={short:"bg-blue-50 text-blue-700",long:"bg-purple-50 text-purple-700",admin:"bg-green-50 text-green-700"};function s2e(){const e=Is(),[r,t]=R.useState({}),[n,a]=R.useState(!1),[i,o]=R.useState(null),[c,u]=R.useState(null),{data:l,isLoading:d}=gr({queryKey:["shifts-all-active"],queryFn:()=>Xc.getAllActive()}),{data:f,isLoading:p}=gr({queryKey:["departments-all"],queryFn:()=>zi.getAll({page:1,pageSize:100})}),{data:h,isLoading:y}=gr({queryKey:["department-shift-configs"],queryFn:()=>Xc.getAllDepartmentConfigs()}),g=l||[],m=(f?.data||[]).filter(T=>T.code!=="HAP-BGD");R.useEffect(()=>{if(h&&m.length>0){const T={};m.forEach(I=>{T[I.id]={shifts:new Set,defaultShift:""}}),h.forEach(I=>{T[I.department_id]&&(T[I.department_id].shifts.add(I.shift_id),I.is_default&&(T[I.department_id].defaultShift=I.shift_id))}),t(T),a(!1)}},[h,m.length]);const x=(T,I)=>{t(U=>{const H=U[T]||{shifts:new Set,defaultShift:""},z=new Set(H.shifts);if(z.has(I)){z.delete(I);const O=H.defaultShift===I?"":H.defaultShift;return{...U,[T]:{shifts:z,defaultShift:O}}}else{z.add(I);const O=H.defaultShift||I;return{...U,[T]:{shifts:z,defaultShift:O}}}}),a(!0)},v=(T,I)=>{t(U=>({...U,[T]:{...U[T],defaultShift:I}})),a(!0)},w=T=>{t(I=>{const U=I[T]||{shifts:new Set,defaultShift:""},H=g.map(z=>z.id);return U.shifts.size===H.length?{...I,[T]:{shifts:new Set,defaultShift:""}}:{...I,[T]:{shifts:new Set(H),defaultShift:U.defaultShift||H[0]}}}),a(!0)},_=async T=>{try{o(T);const I=r[T],U=Array.from(I.shifts).map(H=>({shift_id:H,is_default:H===I.defaultShift}));await Xc.updateDepartmentConfig(T,U),e.invalidateQueries({queryKey:["department-shift-configs"]}),u(T),setTimeout(()=>u(null),2e3)}catch(I){console.error("Save error:",I),alert("Li lu cu hnh")}finally{o(null)}},A=async()=>{for(const T of m)await _(T.id);a(!1)},P={short:g.filter(T=>T.shift_category==="short"),long:g.filter(T=>T.shift_category==="long"),admin:g.filter(T=>T.shift_category==="admin")};return d||p||y?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(Mt,{size:24,className:"animate-spin text-blue-600"}),s.jsx("span",{className:"ml-2 text-gray-500",children:"ang ti cu hnh..."})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 rounded-xl border border-blue-100",children:[s.jsx(Q4,{size:18,className:"text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium",children:"Hng dn:"}),s.jsxs("ul",{className:"mt-1 space-y-0.5 text-blue-700",children:[s.jsx("li",{children:" Checkbox = phng ban c php s dng ca ny"}),s.jsx("li",{children:" Radio = ca mc nh khi phn ca nhanh"}),s.jsx("li",{children:"Ban Gim c khng hin th (khng cn phn ca)"})]})]})]}),n&&s.jsx("div",{className:"flex items-center justify-end",children:s.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[s.jsx(ai,{size:16}),"Lu tt c thay i"]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsxs("thead",{children:[s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left bg-gray-50 font-semibold text-gray-700 sticky left-0 z-10 min-w-[180px]",children:"Phng ban"}),["short","long","admin"].map(T=>{const I=P[T];return I.length===0?null:s.jsx("th",{colSpan:I.length,className:`px-2 py-2 text-center border-l border-gray-200 ${n2e[T]}`,children:r2e[T]},T)}),s.jsx("th",{className:"px-4 py-3 text-center bg-gray-50 border-l border-gray-200 min-w-[80px]",children:"Thao tc"})]}),s.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[s.jsx("th",{className:"px-4 py-2 text-left sticky left-0 z-10 bg-gray-50"}),g.map(T=>s.jsxs("th",{className:"px-2 py-2 text-center border-l border-gray-100 font-medium text-gray-600 whitespace-nowrap min-w-[80px]",children:[s.jsx("div",{className:"text-xs",children:T.name}),s.jsxs("div",{className:"text-[10px] text-gray-400 font-normal mt-0.5",children:[T.start_time?.substring(0,5),"-",T.end_time?.substring(0,5)]})]},T.id)),s.jsx("th",{className:"px-4 py-2 text-center bg-gray-50 border-l border-gray-200"})]})]}),s.jsx("tbody",{children:m.map(T=>{const I=r[T.id]||{shifts:new Set,defaultShift:""},U=I.shifts.size===g.length,H=i===T.id,z=c===T.id;return s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50/50 transition-colors",children:[s.jsx("td",{className:"px-4 py-3 sticky left-0 bg-white z-10",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center flex-shrink-0",children:s.jsx($r,{size:14,className:"text-gray-500"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 text-sm",children:T.name}),s.jsx("div",{className:"text-xs text-gray-400",children:T.code})]})]})}),g.map(O=>{const L=I.shifts.has(O.id),E=I.defaultShift===O.id;return s.jsx("td",{className:"px-2 py-3 text-center border-l border-gray-100",children:s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[s.jsx("label",{className:"cursor-pointer",children:s.jsx("input",{type:"checkbox",checked:L,onChange:()=>x(T.id,O.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500 cursor-pointer"})}),L&&s.jsxs("label",{className:"cursor-pointer flex items-center gap-0.5",title:"Ca mc nh",children:[s.jsx("input",{type:"radio",name:`default-${T.id}`,checked:E,onChange:()=>v(T.id,O.id),className:"w-3 h-3 text-amber-500 border-gray-300 focus:ring-amber-500 cursor-pointer"}),E&&s.jsx("span",{className:"text-[10px] text-amber-600",children:""})]})]})},O.id)}),s.jsx("td",{className:"px-3 py-3 text-center border-l border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx("button",{onClick:()=>w(T.id),className:`px-2 py-1 text-xs rounded transition-colors ${U?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:U?"B tt c":"Chn tt c",children:U?" Tt c":"Tt c"}),s.jsx("button",{onClick:()=>_(T.id),disabled:H,className:`p-1.5 rounded transition-colors ${z?"bg-green-100 text-green-600":"text-gray-400 hover:text-blue-600 hover:bg-blue-50"}`,title:"Lu phng ban ny",children:H?s.jsx(Mt,{size:14,className:"animate-spin"}):z?s.jsx($i,{size:14}):s.jsx(ai,{size:14})})]})})]},T.id)})})]})})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:m.map(T=>{const I=r[T.id],U=I?.shifts?.size||0,H=g.find(z=>z.id===I?.defaultShift);return s.jsxs("div",{className:"px-4 py-3 bg-white rounded-lg border border-gray-200",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:T.name}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("span",{className:`text-xs ${U>0?"text-blue-600":"text-gray-400"}`,children:U>0?`${U} ca`:"Cha cu hnh"}),H&&s.jsxs("span",{className:"text-xs text-amber-600",children:[" ",H.name]})]})]},T.id)})})]})}const a2e={short:"Ca ngn (8h)",long:"Ca di (12h)",admin:"Hnh chnh"},i2e={short:"bg-blue-100 text-blue-800",long:"bg-purple-100 text-purple-800",admin:"bg-green-100 text-green-800"},o2e={SHORT_1:s.jsx(rG,{size:16,className:"text-orange-500"}),SHORT_2:s.jsx(ES,{size:16,className:"text-yellow-500"}),SHORT_3:s.jsx(CS,{size:16,className:"text-indigo-500"}),LONG_DAY:s.jsx(ES,{size:16,className:"text-amber-500"}),LONG_NIGHT:s.jsx(CS,{size:16,className:"text-purple-500"}),ADMIN_PROD:s.jsx(Xr,{size:16,className:"text-emerald-500"}),ADMIN_OFFICE:s.jsx(Xr,{size:16,className:"text-teal-500"})};function iP(e){return e?e.substring(0,5):"-"}function l2e(){const e=Is(),[r,t]=R.useState("shifts"),[n,a]=R.useState(""),[i,o]=R.useState("all"),[c,u]=R.useState(!1),[l,d]=R.useState(null),[f,p]=R.useState(null),{data:h,isLoading:y}=gr({queryKey:["shifts",n,i],queryFn:()=>Xc.getAll({page:1,pageSize:50,search:n||void 0,category:i!=="all"?i:void 0})}),g=nn({mutationFn:Xc.delete,onSuccess:()=>{e.invalidateQueries({queryKey:["shifts"]}),p(null)}}),m=()=>{d(null),u(!0)},x=A=>{d(A),u(!0)},v=()=>{u(!1),d(null),e.invalidateQueries({queryKey:["shifts"]})},w=(h?.data||[]).filter(A=>{if(n){const P=n.toLowerCase();return A.name.toLowerCase().includes(P)||A.code.toLowerCase().includes(P)}return!0}),_={short:w.filter(A=>A.shift_category==="short"),long:w.filter(A=>A.shift_category==="long"),admin:w.filter(A=>A.shift_category==="admin")};return s.jsxs("div",{className:"p-4 lg:p-6 max-w-7xl mx-auto",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l ca lm vic"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Thit lp ca v cu hnh phng ban"})]})}),s.jsxs("div",{className:"flex gap-1 mb-6 bg-gray-100 rounded-lg p-1 w-fit",children:[s.jsxs("button",{onClick:()=>t("shifts"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="shifts"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[s.jsx(xm,{size:16}),"Danh sch ca"]}),s.jsxs("button",{onClick:()=>t("config"),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all ${r==="config"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[s.jsx($r,{size:16}),"Cu hnh phng ban"]})]}),r==="shifts"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(ii,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo tn, m ca...",value:n,onChange:A=>a(A.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{value:i,onChange:A=>o(A.target.value),className:"px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c loi"}),s.jsx("option",{value:"short",children:"Ca ngn (8h)"}),s.jsx("option",{value:"long",children:"Ca di (12h)"}),s.jsx("option",{value:"admin",children:"Hnh chnh"})]}),s.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:[s.jsx(An,{size:16}),"Thm ca"]})]})]}),y?s.jsx("div",{className:"space-y-4",children:[1,2,3].map(A=>s.jsxs("div",{className:"animate-pulse bg-white rounded-xl p-6 border",children:[s.jsx("div",{className:"h-5 bg-gray-200 rounded w-32 mb-4"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-16 bg-gray-100 rounded"}),s.jsx("div",{className:"h-16 bg-gray-100 rounded"})]})]},A))}):s.jsxs("div",{className:"space-y-6",children:[(i==="all"?["short","long","admin"]:[i]).map(A=>{const P=_[A];return P.length===0?null:s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i2e[A]}`,children:a2e[A]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[P.length," ca"]})]})}),s.jsx("div",{className:"divide-y divide-gray-100",children:P.map(B=>s.jsxs("div",{className:"px-6 py-4 flex items-center gap-4 hover:bg-gray-50/50 transition-colors",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center flex-shrink-0",children:o2e[B.code]||s.jsx(Xr,{size:16,className:"text-gray-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:B.name}),s.jsx("span",{className:"text-xs text-gray-400 font-mono",children:B.code}),B.crosses_midnight&&s.jsx("span",{className:"px-1.5 py-0.5 bg-indigo-50 text-indigo-600 text-xs rounded font-medium",children:"Qua m"}),!B.is_active&&s.jsx("span",{className:"px-1.5 py-0.5 bg-red-50 text-red-600 text-xs rounded font-medium",children:"Tt"})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[s.jsxs("span",{children:[" ",iP(B.start_time)," - ",iP(B.end_time)]}),s.jsxs("span",{children:[" ",B.standard_hours,"h chun"]}),s.jsxs("span",{children:[" Ngh ",B.break_minutes," pht"]}),s.jsxs("span",{className:"hidden md:inline",children:[" Tr >",B.late_threshold_minutes," | Sm >",B.early_leave_threshold_minutes,""]})]})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[s.jsx("button",{onClick:()=>x(B),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Sa",children:s.jsx(sd,{size:16})}),s.jsx("button",{onClick:()=>p(B.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:s.jsx(En,{size:16})})]})]},B.id))})]},A)}),w.length===0&&s.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border",children:[s.jsx(xm,{size:48,className:"mx-auto text-gray-300 mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Khng tm thy ca lm vic no"})]})]})]}):s.jsx(s2e,{}),s.jsx(ji,{isOpen:c,onClose:()=>{u(!1),d(null)},title:l?"Sa ca lm vic":"Thm ca lm vic",size:"lg",children:s.jsx(t2e,{initialData:l,onSuccess:v,onCancel:()=>{u(!1),d(null)}})}),s.jsx(mc,{isOpen:!!f,onClose:()=>p(null),onConfirm:()=>f&&g.mutate(f),title:"Xa ca lm vic",message:"Bn c chc mun xa ca ny? Hnh ng ny khng th hon tc. Cc phn ca ang s dng ca ny s b nh hng.",confirmText:"Xa",isLoading:g.isPending,variant:"danger"})]})}const c2e={SHORT_1:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-200"},SHORT_2:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-200"},SHORT_3:{bg:"bg-indigo-50",text:"text-indigo-700",border:"border-indigo-200"},LONG_DAY:{bg:"bg-orange-50",text:"text-orange-700",border:"border-orange-200"},LONG_NIGHT:{bg:"bg-purple-50",text:"text-purple-700",border:"border-purple-200"},ADMIN_PROD:{bg:"bg-gray-50",text:"text-gray-700",border:"border-gray-200"},ADMIN_OFFICE:{bg:"bg-sky-50",text:"text-sky-700",border:"border-sky-200"}},u2e={SHORT_1:"Ca 1",SHORT_2:"Ca 2",SHORT_3:"Ca 3",LONG_DAY:"Ngy",LONG_NIGHT:"m",ADMIN_PROD:"HC-SX",ADMIN_OFFICE:"HC-VP"};function oP(e){return e?e.substring(0,5):""}function d2e(e){return c2e[e]||{bg:"bg-gray-50",text:"text-gray-600",border:"border-gray-200"}}function h2e({data:e,date:r,isSundayOff:t,isToday:n,isPast:a,onClick:i,readonly:o}){if(t)return s.jsx("td",{className:"p-0.5",children:s.jsx("div",{className:"h-10 rounded bg-gray-100 flex items-center justify-center",children:s.jsx("span",{className:"text-[10px] text-gray-400 italic",children:"CN"})})});if(!e)return s.jsx("td",{className:"p-0.5",children:s.jsx("div",{className:`h-10 rounded border border-dashed flex items-center justify-center
            ${a?"border-gray-200 bg-gray-50/50":"border-gray-300 bg-white hover:bg-blue-50 hover:border-blue-300"}
            ${!o&&!a?"cursor-pointer":""}
            ${n?"ring-2 ring-blue-400 ring-offset-1":""}
          `,onClick:!o&&!a?i:void 0,title:`${r} - Cha phn ca`,children:s.jsx("span",{className:"text-[10px] text-gray-300",children:!a&&!o?"+":""})})});const c=d2e(e.shift_code),u=u2e[e.shift_code]||e.shift_name,l=`${oP(e.start_time)}-${oP(e.end_time)}`;return s.jsx("td",{className:"p-0.5",children:s.jsxs("div",{className:`h-10 rounded border flex flex-col items-center justify-center relative
          ${c.bg} ${c.border}
          ${o?"":"cursor-pointer hover:shadow-sm hover:brightness-95"}
          ${n?"ring-2 ring-blue-400 ring-offset-1":""}
          ${a?"opacity-70":""}
        `,onClick:o?void 0:i,title:`${e.shift_name} (${l})${e.is_override?"  i ca":""}`,children:[s.jsx("span",{className:`text-[11px] font-semibold leading-none ${c.text}`,children:u}),s.jsx("span",{className:`text-[9px] leading-none mt-0.5 ${c.text} opacity-70`,children:l}),e.is_override&&s.jsx(_o,{size:8,className:"absolute top-0.5 right-0.5 text-yellow-500 fill-yellow-400"})]})})}function lP(e){return new Date(e+"T00:00:00").toLocaleDateString("vi-VN")}function f2e(e,r){const t=[],n=new Date(e+"T00:00:00"),a=new Date(r+"T00:00:00"),i=new Date(n);for(;i<=a;)t.push(i.toISOString().split("T")[0]),i.setDate(i.getDate()+1);return t}function p2e(e,r){return f2e(e,r).filter(n=>new Date(n+"T00:00:00").getDay()!==0).length}function m2e({isOpen:e,onClose:r,currentUserId:t,preSelectedDepartmentId:n}){const a=Is(),[i,o]=R.useState(1),[c,u]=R.useState(n||""),[l,d]=R.useState([]),[f,p]=R.useState("fixed"),[h,y]=R.useState(""),[g,m]=R.useState([{week_number:1,shift_id:""},{week_number:2,shift_id:""}]),[x,v]=R.useState(""),[w,_]=R.useState(""),[A,P]=R.useState(!1),[B,T]=R.useState(""),{data:I}=gr({queryKey:["departments-batch"],queryFn:()=>zi.getAll({page:1,pageSize:50,status:"active"}),enabled:e}),{data:U,isLoading:H}=gr({queryKey:["employees-batch",c],queryFn:()=>uc.getAll({page:1,pageSize:100,department_id:c||void 0,status:"active"}),enabled:e&&!!c}),{data:z}=gr({queryKey:["shifts-batch"],queryFn:()=>Xc.getAll({page:1,pageSize:50}),enabled:e}),O=I?.data||[],L=U?.data||[],E=z?.data||[],k=R.useMemo(()=>{const Q={short:[],long:[],admin:[]};return E.forEach(ne=>{const ie=ne.shift_category||"admin";Q[ie]&&Q[ie].push(ne)}),Q},[E]),N=nn({mutationFn:()=>{const Q=f==="fixed"?[{week_number:1,shift_id:h}]:g.filter(ne=>ne.shift_id);return xb.batchSchedule({employee_ids:l,date_from:x,date_to:w,pattern:Q,overwrite_existing:A,created_by:t,notes:B||void 0})},onSuccess:Q=>{a.invalidateQueries({queryKey:["shift-calendar"]}),alert(`Phn ca hon tt!
 To mi: ${Q.created} ngy
 B qua: ${Q.skipped} ngy
 Ghi : ${Q.overwritten} ngy`),S()}}),S=()=>{o(1),d([]),p("fixed"),y(""),m([{week_number:1,shift_id:""},{week_number:2,shift_id:""}]),v(""),_(""),P(!1),T(""),r()},C=Q=>{d(ne=>ne.includes(Q)?ne.filter(ie=>ie!==Q):[...ne,Q])},D=()=>{l.length===L.length?d([]):d(L.map(Q=>Q.id))},q=()=>{m(Q=>[...Q,{week_number:Q.length+1,shift_id:""}])},M=Q=>{g.length<=2||m(ne=>ne.filter((ie,ce)=>ce!==Q).map((ie,ce)=>({...ie,week_number:ce+1})))},G=(Q,ne)=>{m(ie=>ie.map((ce,de)=>de===Q?{...ce,shift_id:ne}:ce))},X=l.length>0,re=x&&w&&w>=x&&(f==="fixed"&&h||f==="rotation"&&g.every(Q=>Q.shift_id)),V=x&&w&&w>=x?p2e(x,w):0,J=V*l.length,W=Q=>E.find(ie=>ie.id===Q)?.name||"",F=N.isPending;return s.jsx(ji,{isOpen:e,onClose:S,title:"Phn ca hng lot",size:"lg",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center gap-2 mb-4",children:[{num:1,label:"Chn nhn vin"},{num:2,label:"Cu hnh ca"},{num:3,label:"Xc nhn"}].map((Q,ne)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold
                ${i>=Q.num?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}
              `,children:i>Q.num?s.jsx($i,{size:14}):Q.num}),s.jsx("span",{className:`text-xs ${i>=Q.num?"text-blue-600 font-medium":"text-gray-400"}`,children:Q.label}),ne<2&&s.jsx("div",{className:`w-8 h-0.5 ${i>Q.num?"bg-blue-400":"bg-gray-200"}`})]},Q.num))}),i===1&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),s.jsxs("select",{value:c,onChange:Q=>{u(Q.target.value),d([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:" Chn phng ban "}),O.map(Q=>s.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),c&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("label",{className:"text-sm font-medium text-gray-700",children:[s.jsx(_i,{size:14,className:"inline mr-1"}),"Nhn vin (",l.length,"/",L.length,")"]}),s.jsx("button",{type:"button",onClick:D,className:"text-xs text-blue-600 hover:text-blue-800",children:l.length===L.length?"B chn tt c":"Chn tt c"})]}),H?s.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"ang ti..."}):L.length===0?s.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"Khng c nhn vin no"}):s.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:L.map(Q=>s.jsxs("label",{className:`flex items-center gap-3 px-3 py-2 cursor-pointer hover:bg-gray-50
                          ${l.includes(Q.id)?"bg-blue-50":""}
                        `,children:[s.jsx("input",{type:"checkbox",checked:l.includes(Q.id),onChange:()=>C(Q.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:Q.full_name}),s.jsx("span",{className:"text-xs text-gray-500 ml-2",children:Q.code})]})]},Q.id))})]})]}),i===2&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx(dn,{size:14,className:"inline mr-1"}),"T ngy"]}),s.jsx("input",{type:"date",value:x,onChange:Q=>v(Q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n ngy"}),s.jsx("input",{type:"date",value:w,onChange:Q=>_(Q.target.value),min:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"})]})]}),V>0&&s.jsxs("p",{className:"text-xs text-gray-500",children:[V," ngy lm vic (b Ch nht)  ",l.length," NV = ",s.jsxs("strong",{children:[J," phn ca"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kiu phn ca"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>p("fixed"),className:`p-3 rounded-lg border text-left text-sm transition-all
                    ${f==="fixed"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"}
                  `,children:[s.jsx(jh,{size:16,className:"mb-1 text-blue-500"}),s.jsx("span",{className:"font-medium block",children:"C nh 1 ca"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Cng ca mi ngy"})]}),s.jsxs("button",{type:"button",onClick:()=>p("rotation"),className:`p-3 rounded-lg border text-left text-sm transition-all
                    ${f==="rotation"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"}
                  `,children:[s.jsx(CO,{size:16,className:"mb-1 text-purple-500"}),s.jsx("span",{className:"font-medium block",children:"Xoay ca"}),s.jsx("span",{className:"text-xs text-gray-500",children:"i ca theo tun"})]})]})]}),f==="fixed"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chn ca"}),s.jsx("div",{className:"space-y-2",children:Object.entries(k).map(([Q,ne])=>ne.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:Q==="short"?"Ca ngn (8h)":Q==="long"?"Ca di (12h)":"Hnh chnh"}),s.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:ne.map(ie=>s.jsxs("button",{type:"button",onClick:()=>y(ie.id),className:`p-2 rounded-lg border text-sm text-left transition-all
                                ${h===ie.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300"}
                              `,children:[s.jsx("span",{className:"font-medium block text-xs",children:ie.name}),s.jsxs("span",{className:"text-[10px] text-gray-500",children:[ie.start_time?.substring(0,5),"-",ie.end_time?.substring(0,5)]})]},ie.id))})]},Q))})]}),f==="rotation"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Pattern xoay ca"}),s.jsx("button",{type:"button",onClick:q,className:"text-xs text-blue-600 hover:text-blue-800",children:"+ Thm tun"})]}),s.jsx("div",{className:"space-y-2",children:g.map((Q,ne)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-xs text-gray-500 w-14 shrink-0",children:["Tun ",Q.week_number]}),s.jsxs("select",{value:Q.shift_id,onChange:ie=>G(ne,ie.target.value),className:`flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-sm\r
                          focus:ring-2 focus:ring-blue-500`,children:[s.jsx("option",{value:"",children:" Chn ca "}),Object.entries(k).map(([ie,ce])=>ce.length>0&&s.jsx("optgroup",{label:ie==="short"?"Ca ngn":ie==="long"?"Ca di":"HC",children:ce.map(de=>s.jsxs("option",{value:de.id,children:[de.name," (",de.start_time?.substring(0,5),"-",de.end_time?.substring(0,5),")"]},de.id))},ie))]}),g.length>2&&s.jsx("button",{type:"button",onClick:()=>M(ne),className:"text-red-400 hover:text-red-600 p-1",children:""})]},ne))}),s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Pattern lp li sau ",g.length," tun"]})]}),s.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:A,onChange:Q=>P(Q.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Ghi  lch ca  c"})]}),A&&s.jsx("p",{className:"text-xs text-amber-600 ml-6",children:" Ca  phn trong khong thi gian s b xa v thay th"}),s.jsx("div",{children:s.jsx("input",{type:"text",value:B,onChange:Q=>T(Q.target.value),placeholder:"Ghi ch (ty chn)",className:`w-full px-3 py-2 border border-gray-300 rounded-lg text-sm\r
                    focus:ring-2 focus:ring-blue-500`})})]})]}),i===3&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 space-y-2",children:[s.jsxs("h4",{className:"text-sm font-semibold text-blue-800 flex items-center gap-1",children:[s.jsx(ja,{size:14}),"Xem trc phn ca"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Nhn vin:"}),s.jsxs("span",{className:"font-medium",children:[l.length," ngi"]}),s.jsx("span",{className:"text-gray-600",children:"Khong thi gian:"}),s.jsxs("span",{className:"font-medium",children:[lP(x),"  ",lP(w)]}),s.jsx("span",{className:"text-gray-600",children:"Ngy lm vic:"}),s.jsxs("span",{className:"font-medium",children:[V," ngy (tr CN)"]}),s.jsx("span",{className:"text-gray-600",children:"Kiu phn ca:"}),s.jsx("span",{className:"font-medium",children:f==="fixed"?"C nh":"Xoay ca"}),f==="fixed"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-gray-600",children:"Ca:"}),s.jsx("span",{className:"font-medium",children:W(h)})]}),f==="rotation"&&g.map((Q,ne)=>s.jsxs("div",{className:"col-span-2 flex items-center gap-2 text-xs",children:[s.jsxs("span",{className:"text-gray-500",children:["Tun ",Q.week_number,":"]}),s.jsx("span",{className:"font-medium",children:W(Q.shift_id)})]},ne)),s.jsx("span",{className:"text-gray-600",children:"Ghi :"}),s.jsx("span",{className:`font-medium ${A?"text-amber-600":"text-gray-700"}`,children:A?"C":"Khng"}),s.jsx("span",{className:"text-gray-600",children:"Tng phn ca:"}),s.jsxs("span",{className:"font-bold text-blue-700",children:[J," records"]})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Danh sch nhn vin:"}),s.jsx("div",{className:"max-h-32 overflow-y-auto text-xs text-gray-600 bg-gray-50 rounded-lg p-2 space-y-0.5",children:L.filter(Q=>l.includes(Q.id)).map(Q=>s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx($i,{size:10,className:"text-green-500"}),s.jsx("span",{children:Q.full_name}),s.jsxs("span",{className:"text-gray-400",children:["(",Q.code,")"]})]},Q.id))})]}),N.isError&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:[s.jsx(Cr,{size:16}),s.jsxs("span",{children:["Li: ",N.error.message]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[s.jsx("div",{children:i>1&&s.jsxs(Lt,{variant:"outline",size:"sm",onClick:()=>o(i-1),disabled:F,children:[s.jsx(si,{size:14,className:"mr-1 rotate-[-90deg]"}),"Quay li"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{variant:"outline",onClick:S,disabled:F,children:"Hy"}),i<3?s.jsxs(Lt,{onClick:()=>o(i+1),disabled:i===1?!X:!re,children:["Tip theo",s.jsx(Gs,{size:14,className:"ml-1 rotate-[-90deg]"})]}):s.jsxs(Lt,{onClick:()=>N.mutate(),disabled:F,isLoading:F,children:[s.jsx($i,{size:14,className:"mr-1"}),"Xc nhn phn ca"]})]})]})]})})}const g2e={short:"Ca ngn (8h)",long:"Ca di (12h)",admin:"Hnh chnh"};function y2e({isOpen:e,onClose:r,employeeId:t,employeeName:n,date:a,currentShift:i,currentUserId:o}){const c=Is(),[u,l]=R.useState(""),[d,f]=R.useState(""),{data:p}=gr({queryKey:["shifts-for-override"],queryFn:()=>Xc.getAll({page:1,pageSize:50}),enabled:e}),y=(p?.data||[]).reduce((T,I)=>{const U=I.shift_category||"other";return T[U]||(T[U]=[]),T[U].push(I),T},{}),g=nn({mutationFn:()=>xb.overrideShift({employee_id:t,date:a,new_shift_id:u,created_by:o,notes:d||void 0}),onSuccess:()=>{c.invalidateQueries({queryKey:["shift-calendar"]}),x()}}),m=nn({mutationFn:()=>xb.delete(i.id),onSuccess:()=>{c.invalidateQueries({queryKey:["shift-calendar"]}),x()}}),x=()=>{l(""),f(""),r()},v=()=>{u&&g.mutate()},w=()=>{i?.id&&window.confirm("Xa ca  phn cho nhn vin ny?")&&m.mutate()},_=new Date(a+"T00:00:00"),P=`${["Ch nht","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7"][_.getDay()]}, ${_.toLocaleDateString("vi-VN")}`,B=g.isPending||m.isPending;return s.jsx(ji,{isOpen:e,onClose:x,title:i?"i ca t xut":"Phn ca",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Nhn vin"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Ngy"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:P})]}),i&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Ca hin ti"}),s.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[i.shift_name,i.assignment_type==="override"&&s.jsx("span",{className:"ml-1 text-xs text-yellow-600",children:"( i)"})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(OV,{size:14,className:"inline mr-1"}),i?"Chn ca mi":"Chn ca"]}),s.jsx("div",{className:"space-y-3",children:Object.entries(y).map(([T,I])=>s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:g2e[T]||T}),s.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:I.map(U=>s.jsxs("button",{type:"button",onClick:()=>l(U.id),disabled:i?.shift_id===U.id,className:`p-2 rounded-lg border text-left transition-all text-sm
                        ${u===U.id?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":i?.shift_id===U.id?"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50/50"}
                      `,children:[s.jsx("span",{className:"font-medium block",children:U.name}),s.jsxs("span",{className:"text-xs text-gray-500",children:[U.start_time?.substring(0,5)," - ",U.end_time?.substring(0,5)]})]},U.id))})]},T))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch (ty chn)"}),s.jsx("input",{type:"text",value:d,onChange:T=>f(T.target.value),placeholder:"L do i ca...",className:`w-full px-3 py-2 border border-gray-300 rounded-lg text-sm\r
              focus:ring-2 focus:ring-blue-500 focus:border-blue-500`})]}),g.isError&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:[s.jsx(Cr,{size:16}),s.jsxs("span",{children:["Li: ",g.error.message]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[s.jsx("div",{children:i&&s.jsxs(Lt,{variant:"ghost",size:"sm",onClick:w,disabled:B,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[s.jsx(En,{size:14,className:"mr-1"}),"Xa ca"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Lt,{variant:"outline",onClick:x,disabled:B,children:"Hy"}),s.jsx(Lt,{onClick:v,disabled:!u||B,isLoading:B,children:i?"i ca":"Phn ca"})]})]})]})})}function x2e(){return new Date().toISOString().split("T")[0]}function v2e(e){const r=new Date(e),t=r.getDay(),n=r.getDate()-t+(t===0?-6:1);return r.setDate(n),r}function cP(e){const r=new Date(e+"T00:00:00");return`${r.getDate()}/${r.getMonth()+1}`}function b2e(e,r){return`${["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"][r-1]} ${e}`}function NB(e){const r=v2e(e),t=[];for(let n=0;n<7;n++){const a=new Date(r);a.setDate(r.getDate()+n),t.push(a.toISOString().split("T")[0])}return t}function w2e(e,r){const t=[],n=new Date(e,r,0).getDate();for(let a=1;a<=n;a++)t.push(`${e}-${String(r).padStart(2,"0")}-${String(a).padStart(2,"0")}`);return t}function _2e(e){const r=NB(e),t=cP(r[0]),n=cP(r[6]);return`${t}  ${n}`}const j2e=["T2","T3","T4","T5","T6","T7","CN"],N2e=["Th 2","Th 3","Th 4","Th 5","Th 6","Th 7","CN"];function k2e(){const[e,r]=R.useState("week"),[t,n]=R.useState(""),[a,i]=R.useState(new Date),[o,c]=R.useState(new Date().getFullYear()),[u,l]=R.useState(new Date().getMonth()+1),[d,f]=R.useState(!1),[p,h]=R.useState(null),{user:y}=xn(),g=y?.employee_id||"",m=R.useMemo(()=>e==="week"?NB(a):w2e(o,u),[e,a,o,u]),x=m[0],v=m[m.length-1],w=x2e(),{data:_}=gr({queryKey:["departments-calendar"],queryFn:()=>zi.getAll({page:1,pageSize:50,status:"active"})}),{data:A,isLoading:P}=gr({queryKey:["shift-calendar",t,x,v],queryFn:()=>xb.getCalendarView({department_id:t||void 0,date_from:x,date_to:v}),enabled:!!x&&!!v}),B=_?.data||[],T=A||[],I=R.useCallback(()=>{if(e==="week"){const E=new Date(a);E.setDate(E.getDate()+7),i(E)}else u===12?(l(1),c(E=>E+1)):l(E=>E+1)},[e,a,u,o]),U=R.useCallback(()=>{if(e==="week"){const E=new Date(a);E.setDate(E.getDate()-7),i(E)}else u===1?(l(12),c(E=>E-1)):l(E=>E-1)},[e,a,u,o]),H=R.useCallback(()=>{const E=new Date;i(E),c(E.getFullYear()),l(E.getMonth()+1)},[]),z=R.useMemo(()=>{let E=0,k=0,N=0;return T.forEach(S=>{const C=n4.includes(S.department_code);m.forEach(D=>{if(!(new Date(D+"T00:00:00").getDay()===0&&C)){k++;const G=S.assignments[D];G&&(E++,G.is_override&&N++)}})}),{totalEmployees:T.length,totalAssigned:E,totalCells:k,coverageRate:k>0?Math.round(E/k*100):0,overrides:N}},[T,m]),O=(E,k,N,S)=>{h({employeeId:E,employeeName:k,date:N,currentShift:S?{id:S.id,shift_id:S.shift_id,shift_name:S.shift_name,assignment_type:S.assignment_type}:null})},L=e==="week"?_2e(a):b2e(o,u);return s.jsxs("div",{className:"p-4 lg:p-6 max-w-[1400px] mx-auto",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(pg,{size:24,className:"text-blue-500"}),"Phn ca"]}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:L})]}),s.jsxs("button",{onClick:()=>f(!0),className:`inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white\r
            rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors shadow-sm`,children:[s.jsx(jh,{size:16}),"Phn ca nhanh"]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($r,{size:16,className:"text-gray-400"}),s.jsxs("select",{value:t,onChange:E=>n(E.target.value),className:`px-3 py-1.5 border border-gray-300 rounded-lg text-sm\r
              focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),B.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]}),s.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-0.5",children:[s.jsx("button",{onClick:()=>r("week"),className:`px-3 py-1 text-xs font-medium rounded-md transition-all
              ${e==="week"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}
            `,children:"Tun"}),s.jsx("button",{onClick:()=>r("month"),className:`px-3 py-1 text-xs font-medium rounded-md transition-all
              ${e==="month"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}
            `,children:"Thng"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:U,className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(su,{size:18,className:"text-gray-600"})}),s.jsx("button",{onClick:H,className:`px-2.5 py-1 text-xs font-medium text-blue-600 bg-blue-50\r
              hover:bg-blue-100 rounded-lg transition-colors`,children:"Hm nay"}),s.jsx("button",{onClick:I,className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Ks,{size:18,className:"text-gray-600"})})]}),s.jsxs("div",{className:"ml-auto flex items-center gap-4 text-xs text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(_i,{size:13}),z.totalEmployees," NV"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(If,{size:13}),z.coverageRate,"% phn ca"]}),z.overrides>0&&s.jsxs("span",{className:"text-yellow-600",children:[" ",z.overrides," i ca"]})]})]}),P?s.jsxs("div",{className:"flex items-center justify-center py-20",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full"}),s.jsx("span",{className:"ml-3 text-gray-500",children:"ang ti lch ca..."})]}):T.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white rounded-xl border border-gray-200",children:[s.jsx(_i,{size:40,className:"text-gray-300 mb-3"}),s.jsx("p",{className:"text-gray-500 text-sm",children:t?"Khng c nhn vin trong phng ban ny":"Chn phng ban  xem lch phn ca"})]}):s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("th",{className:"sticky left-0 z-10 bg-gray-50 px-3 py-2 text-left text-xs font-semibold text-gray-600 min-w-[160px] border-b border-r border-gray-200",children:"Nhn vin"}),m.map(E=>{const k=new Date(E+"T00:00:00"),N=k.getDay(),S=N===0,C=E===w,D=N===0?6:N-1;return s.jsxs("th",{className:`px-0.5 py-1.5 text-center border-b border-gray-200 min-w-[52px]
                          ${C?"bg-blue-50":""}
                        `,children:[s.jsx("div",{className:`text-[10px] font-medium ${S?"text-red-500 font-semibold":"text-gray-500"}`,children:e==="week"?N2e[D]:j2e[D]}),s.jsx("div",{className:`text-xs font-bold
                          ${S?"text-red-500":C?"text-blue-600":"text-gray-700"}
                        `,children:k.getDate()})]},E)})]})}),s.jsx("tbody",{children:T.map((E,k)=>{const N=n4.includes(E.department_code);return s.jsxs("tr",{className:k%2===0?"bg-white":"bg-gray-50/30",children:[s.jsx("td",{className:"sticky left-0 z-10 px-3 py-1.5 border-r border-gray-200 min-w-[160px]",style:{backgroundColor:k%2===0?"white":"#fafafa"},children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center shrink-0",children:s.jsx("span",{className:"text-[10px] font-bold text-blue-600",children:E.employee_name.charAt(E.employee_name.lastIndexOf(" ")+1)||"?"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-xs font-medium text-gray-900 truncate",title:E.employee_name,children:E.employee_name}),s.jsx("p",{className:"text-[10px] text-gray-400",children:E.employee_code})]})]})}),m.map(S=>{const D=new Date(S+"T00:00:00").getDay(),q=S===w,M=S<w,G=E.assignments[S],X=D===0&&N;return s.jsx(h2e,{data:G||null,date:S,isSundayOff:X,isToday:q,isPast:M,onClick:()=>O(E.employee_id,E.employee_name,S,G||null)},S)})]},E.employee_id)})})]})}),s.jsxs("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 flex flex-wrap items-center gap-3 text-[10px]",children:[s.jsx("span",{className:"text-gray-500 font-medium",children:"Ch thch:"}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-emerald-100 border border-emerald-300"})," Ca 1"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-amber-100 border border-amber-300"})," Ca 2"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-indigo-100 border border-indigo-300"})," Ca 3"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-orange-100 border border-orange-300"})," Ca ngy"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-purple-100 border border-purple-300"})," Ca m"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-gray-100 border border-gray-300"})," HC-SX"]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-sky-100 border border-sky-300"})," HC-VP"]}),s.jsx("span",{className:"flex items-center gap-1 text-yellow-600",children:" i ca"}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"w-3 h-3 rounded bg-gray-100 border border-gray-300"}),s.jsx("span",{className:"text-gray-400 italic",children:"CN ngh (KT, R&D)"})]})]})]}),s.jsx(m2e,{isOpen:d,onClose:()=>f(!1),currentUserId:g,preSelectedDepartmentId:t}),p&&s.jsx(y2e,{isOpen:!!p,onClose:()=>h(null),employeeId:p.employeeId,employeeName:p.employeeName,date:p.date,currentShift:p.currentShift,currentUserId:g})]})}function N5(){return new Date().toISOString().split("T")[0]}function S2e(e,r){if(!e||!r)return 0;const[t,n]=e.split(":").map(Number),[a,i]=r.split(":").map(Number);let o=t*60+n,c=a*60+i;return c<=o&&(c+=1440),c-o}function C2e(e){if(e<=0)return"0 pht";const r=Math.floor(e/60),t=e%60;return r===0?`${t} pht`:t===0?`${r} gi`:`${r} gi ${t} pht`}function A2e({onSuccess:e,onClose:r}){const{user:t}=xn(),n=t?.employee_id,[a,i]=R.useState({request_date:N5(),planned_start_time:"17:30",planned_end_time:"19:30",reason:""}),[o,c]=R.useState(null),[u,l]=R.useState(!1),[d,f]=R.useState(!1),[p,h]=R.useState(null),[y,g]=R.useState({}),m=S2e(a.planned_start_time,a.planned_end_time);R.useEffect(()=>{a.request_date&&n&&x(a.request_date)},[a.request_date,n]);const x=async A=>{if(n)try{l(!0),c(null);const{data:P,error:B}=await se.from("shift_assignments").select(`
          shift_id,
          shift:shifts(id, name, code, start_time, end_time, shift_category)
        `).eq("employee_id",n).eq("date",A).maybeSingle();if(!B&&P?.shift){const T=Array.isArray(P.shift)?P.shift[0]:P.shift;T&&c(T)}}catch(P){console.error("Error loading shift for date:",P)}finally{l(!1)}},v=(A,P)=>{i(B=>({...B,[A]:P})),y[A]&&g(B=>{const T={...B};return delete T[A],T}),h(null)},w=()=>{const A={};return a.request_date?a.request_date<N5()&&(A.request_date="Ngy tng ca khng c  qu kh"):A.request_date="Vui lng chn ngy tng ca",a.planned_start_time||(A.planned_start_time="Vui lng chn gi bt u"),a.planned_end_time||(A.planned_end_time="Vui lng chn gi kt thc"),m<=0&&(A.planned_end_time="Gi kt thc phi sau gi bt u"),m>720&&(A.planned_end_time="Thi gian tng ca khng c vt qu 12 gi"),a.reason.trim()?a.reason.trim().length<10&&(A.reason="L do phi c t nht 10 k t"):A.reason="Vui lng nhp l do tng ca",g(A),Object.keys(A).length===0},_=async()=>{if(!n){h("Khng xc nh c nhn vin. Vui lng ng nhp li.");return}if(w())try{f(!0),h(null),await Hu.create({employee_id:n,request_date:a.request_date,shift_id:o?.id||null,planned_start_time:a.planned_start_time,planned_end_time:a.planned_end_time,planned_minutes:m,reason:a.reason.trim()}),e()}catch(A){console.error("Error creating overtime request:",A),h(A.message||"Khng th to phiu tng ca")}finally{f(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:r,children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:A=>A.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xr,{className:"w-5 h-5 text-blue-600"}),s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"To phiu tng ca"})]}),s.jsx("button",{onClick:r,disabled:d,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"px-6 py-4 space-y-5",children:[p&&s.jsxs("div",{className:"flex items-start gap-2 bg-red-50 text-red-700 p-3 rounded-lg text-sm",children:[s.jsx(Cr,{className:"w-4 h-4 mt-0.5 shrink-0"}),s.jsx("span",{children:p})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Ngy tng ca ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"date",value:a.request_date,onChange:A=>v("request_date",A.target.value),min:N5(),className:`w-full pl-10 pr-3 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm ${y.request_date?"border-red-500":""}`})]}),y.request_date&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:y.request_date})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Q4,{className:"w-4 h-4 text-blue-500"}),s.jsx("span",{className:"font-medium text-gray-700",children:"Ca lm vic:"}),u?s.jsxs("span",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx(Mt,{className:"w-3 h-3 animate-spin"}),"ang ti..."]}):o?s.jsxs("span",{className:"text-blue-700 font-medium",children:[o.name," (",o.start_time?.slice(0,5),"  ",o.end_time?.slice(0,5),")"]}):s.jsx("span",{className:"text-gray-500 italic",children:"Cha phn ca cho ngy ny"})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Gi bt u OT ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"time",value:a.planned_start_time,onChange:A=>v("planned_start_time",A.target.value),className:`w-full pl-10 pr-3 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm ${y.planned_start_time?"border-red-500":""}`})]}),y.planned_start_time&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:y.planned_start_time})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Gi kt thc OT ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Xr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"time",value:a.planned_end_time,onChange:A=>v("planned_end_time",A.target.value),className:`w-full pl-10 pr-3 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm ${y.planned_end_time?"border-red-500":""}`})]}),y.planned_end_time&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:y.planned_end_time})]})]}),m>0&&s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 flex items-center gap-2",children:[s.jsx(Xr,{className:"w-4 h-4 text-blue-600"}),s.jsxs("span",{className:"text-sm text-blue-700",children:["Thi gian tng ca d kin: ",s.jsx("strong",{children:C2e(m)})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["L do tng ca ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:a.reason,onChange:A=>v("reason",A.target.value),rows:3,placeholder:"Nhp l do cn tng ca...",className:`w-full px-3 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm resize-none ${y.reason?"border-red-500":""}`}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[y.reason?s.jsx("p",{className:"text-red-500 text-xs",children:y.reason}):s.jsx("span",{}),s.jsxs("span",{className:"text-xs text-gray-400",children:[a.reason.length,"/500"]})]})]})]}),s.jsxs("div",{className:"px-6 py-4 border-t bg-gray-50 rounded-b-xl flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:r,disabled:d,className:"px-4 py-2.5 border rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-sm font-medium disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:_,disabled:d||m<=0,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:d?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang gi..."]}):"Gi phiu tng ca"})]})]})})}const Eb={pending:{label:"Ch duyt",color:"text-yellow-700",bg:"bg-yellow-100"},approved:{label:" duyt",color:"text-green-700",bg:"bg-green-100"},rejected:{label:"T chi",color:"text-red-700",bg:"bg-red-100"},completed:{label:"Hon thnh",color:"text-blue-700",bg:"bg-blue-100"}};function kB(e){return e?new Date(e+"T00:00:00").toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}function sm(e){return e?e.slice(0,5):""}function k4(e){if(!e)return"";const r=Math.floor(e/60),t=e%60;return r===0?`${t} pht`:t===0?`${r} gi`:`${r}h${t.toString().padStart(2,"0")}`}function E2e(){const{user:e}=xn(),[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,u]=R.useState(1),[l,d]=R.useState(1),[f,p]=R.useState(0),h=10,[y,g]=R.useState("all"),[m,x]=R.useState(""),[v,w]=R.useState(""),[_,A]=R.useState(!1),[P,B]=R.useState(null),T=e?.employee_id,I=e?.department_id,U=e?.position_level||7,H=U<=5,z=U<=3,O=R.useCallback(async()=>{if(T)try{a(!0),o(null);const N=await Hu.getAll({page:c,pageSize:h,status:y==="all"?void 0:y,employee_id:H?void 0:T,department_id:H&&!z&&I||void 0,from_date:m||void 0,to_date:v||void 0});t(N.data),p(N.total),d(N.totalPages)}catch(N){console.error("Error loading overtime requests:",N),o(N.message||"Khng th ti danh sch phiu tng ca")}finally{a(!1)}},[T,I,H,z,c,h,y,m,v]);R.useEffect(()=>{O()},[O]),R.useEffect(()=>{u(1)},[y,m,v]);const L=async N=>{if(confirm("Bn c chc mun hy phiu tng ca ny?"))try{await Hu.cancel(N),O()}catch(S){alert(S.message||"Khng th hy phiu")}},E=()=>{A(!1),O()},k={total:f,pending:r.filter(N=>N.status==="pending").length,approved:r.filter(N=>N.status==="approved").length,rejected:r.filter(N=>N.status==="rejected").length};return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:H?"Qun l tng ca":"Tng ca ca ti"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:H?z?"Xem tt c phiu ng k tng ca":"Phiu ng k tng ca trong phng ban":"Qun l cc phiu ng k tng ca ca bn"})]}),s.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:[s.jsx(An,{className:"w-4 h-4"}),"To phiu tng ca"]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsx("div",{className:"text-sm text-gray-500",children:"Tng phiu"}),s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:k.total})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsx("div",{className:"text-sm text-yellow-600",children:"Ch duyt"}),s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:k.pending})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsx("div",{className:"text-sm text-green-600",children:" duyt"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:k.approved})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsx("div",{className:"text-sm text-red-600",children:"T chi"}),s.jsx("div",{className:"text-2xl font-bold text-red-600",children:k.rejected})]})]}),s.jsx("div",{className:"bg-white rounded-lg border p-4 mb-6",children:s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Al,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Lc:"})]}),s.jsxs("select",{value:y,onChange:N=>g(N.target.value),className:"text-sm border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c trng thi"}),s.jsx("option",{value:"pending",children:"Ch duyt"}),s.jsx("option",{value:"approved",children:" duyt"}),s.jsx("option",{value:"rejected",children:"T chi"}),s.jsx("option",{value:"completed",children:"Hon thnh"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",value:m,onChange:N=>x(N.target.value),className:"text-sm border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"T ngy"}),s.jsx("span",{className:"text-gray-400",children:""}),s.jsx("input",{type:"date",value:v,onChange:N=>w(N.target.value),className:"text-sm border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"n ngy"})]}),(y!=="all"||m||v)&&s.jsx("button",{onClick:()=>{g("all"),x(""),w("")},className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Xa b lc"})]})}),i&&s.jsx("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6 text-sm",children:i}),s.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[H&&s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Nhn vin"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Ngy tng ca"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Ca lm"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Gi OT"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Thi lng"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"L do"}),s.jsx("th",{className:"text-center px-4 py-3 font-medium text-gray-600",children:"Trng thi"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Ngi duyt"}),s.jsx("th",{className:"text-center px-4 py-3 font-medium text-gray-600",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y",children:n?s.jsx("tr",{children:s.jsx("td",{colSpan:H?9:8,className:"px-4 py-12 text-center text-gray-500",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx(Xr,{className:"w-5 h-5 animate-spin"}),"ang ti..."]})})}):r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:H?9:8,className:"px-4 py-12 text-center text-gray-500",children:s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx(ii,{className:"w-8 h-8 text-gray-300"}),s.jsx("span",{children:"Khng c phiu tng ca no"}),s.jsx("button",{onClick:()=>A(!0),className:"text-blue-600 hover:text-blue-800 text-sm underline mt-1",children:"To phiu mi"})]})})}):r.map(N=>{const S=Eb[N.status]||Eb.pending;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[H&&s.jsxs("td",{className:"px-4 py-3",children:[s.jsx("div",{className:"font-medium text-gray-900",children:N.employee?.full_name||""}),s.jsx("div",{className:"text-xs text-gray-500",children:N.employee?.department?.name||""})]}),s.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:kB(N.request_date)}),s.jsx("td",{className:"px-4 py-3 text-gray-600",children:N.shift?.name||""}),s.jsxs("td",{className:"px-4 py-3 text-gray-600",children:[sm(N.planned_start_time),"  ",sm(N.planned_end_time)]}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"font-medium text-gray-900",children:k4(N.planned_minutes)})}),s.jsx("td",{className:"px-4 py-3 text-gray-600 max-w-[200px] truncate",title:N.reason,children:N.reason}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("span",{className:`inline-flex px-2.5 py-1 rounded-full text-xs font-medium ${S.bg} ${S.color}`,children:S.label})}),s.jsx("td",{className:"px-4 py-3 text-gray-600",children:N.approver?.full_name||""}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx("button",{onClick:()=>B(N),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Xem chi tit",children:s.jsx(ja,{className:"w-4 h-4"})}),N.status==="pending"&&N.employee_id===T&&s.jsx("button",{onClick:()=>L(N.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Hy phiu",children:s.jsx(En,{className:"w-4 h-4"})})]})})]},N.id)})})]})}),l>1&&s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Hin th ",(c-1)*h+1,"",Math.min(c*h,f)," / ",f," phiu"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>u(N=>Math.max(1,N-1)),disabled:c<=1,className:"p-1.5 rounded border bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Trang ",c," / ",l]}),s.jsx("button",{onClick:()=>u(N=>Math.min(l,N+1)),disabled:c>=l,className:"p-1.5 rounded border bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),P&&s.jsx(T2e,{request:P,onClose:()=>B(null)}),_&&s.jsx(A2e,{onSuccess:E,onClose:()=>A(!1)})]})}function T2e({request:e,onClose:r}){const t=Eb[e.status]||Eb.pending;return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:r,children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:n=>n.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Chi tit phiu tng ca"}),s.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:""})]}),s.jsxs("div",{className:"px-6 py-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Trng thi:"}),s.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium ${t.bg} ${t.color}`,children:t.label})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Nhn vin:"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.employee?.full_name||""}),s.jsx("div",{className:"text-xs text-gray-500",children:e.employee?.department?.name})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Ngy tng ca:"}),s.jsx("span",{className:"font-medium text-gray-900",children:kB(e.request_date)})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Ca lm vic:"}),s.jsx("span",{className:"text-gray-900",children:e.shift?.name||"Khng xc nh"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Gi tng ca:"}),s.jsxs("span",{className:"text-gray-900",children:[sm(e.planned_start_time),"  ",sm(e.planned_end_time),s.jsxs("span",{className:"text-gray-500 ml-2",children:["(",k4(e.planned_minutes),")"]})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28 shrink-0",children:"L do:"}),s.jsx("span",{className:"text-gray-900",children:e.reason})]}),e.approved_by&&s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Ngi duyt:"}),s.jsx("span",{className:"text-gray-900",children:e.approver?.full_name||""})]}),e.rejection_reason&&e.status==="rejected"&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28 shrink-0",children:"L do t chi:"}),s.jsx("span",{className:"text-red-600",children:e.rejection_reason})]}),e.actual_start_time&&s.jsxs("div",{className:"border-t pt-4 mt-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Thi gian thc t"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-sm text-gray-500 w-28",children:"Gi thc t:"}),s.jsxs("span",{className:"text-gray-900",children:[sm(e.actual_start_time),"  ",sm(e.actual_end_time||""),e.actual_minutes&&s.jsxs("span",{className:"text-gray-500 ml-2",children:["(",k4(e.actual_minutes),")"]})]})]})]})]}),s.jsx("div",{className:"px-6 py-4 border-t bg-gray-50 rounded-b-xl",children:s.jsx("button",{onClick:r,className:"w-full px-4 py-2 border rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-sm font-medium",children:"ng"})})]})})}function x6(e){return e?new Date(e+"T00:00:00").toLocaleDateString("vi-VN",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}):""}function Cm(e){return e?e.slice(0,5):""}function v6(e){if(!e)return"";const r=Math.floor(e/60),t=e%60;return r===0?`${t} pht`:t===0?`${r} gi`:`${r}h${t.toString().padStart(2,"0")}`}function SB(e){return e?new Date(e).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function P2e(){const{user:e}=xn(),r=e?.employee_id,t=e?.department_id,n=e?.position_level||7,a=n<=3,i=n<=5,[o,c]=R.useState([]),[u,l]=R.useState([]),[d,f]=R.useState(!0),[p,h]=R.useState(null),[y,g]=R.useState("pending"),[m,x]=R.useState(null),[v,w]=R.useState(null),[_,A]=R.useState(""),[P,B]=R.useState(!1),T=R.useCallback(async()=>{if(r)try{f(!0),h(null);let O;a?O=await Hu.getAllPending():i&&t?O=await Hu.getPendingByDepartment(t):O=[],c(O)}catch(O){console.error("Error loading pending overtime requests:",O),h(O.message||"Khng th ti danh sch phiu ch duyt")}finally{f(!1)}},[r,t,a,i]),I=R.useCallback(async()=>{if(r)try{const O=await Hu.getApprovalHistory({approverId:r,departmentId:a?void 0:t||void 0,page:1,pageSize:20});l(O.data)}catch(O){console.error("Error loading approval history:",O)}},[r,t,a]);R.useEffect(()=>{T()},[T]),R.useEffect(()=>{y==="history"&&I()},[y,I]);const U=async O=>{if(r&&confirm(`Duyt phiu tng ca ca ${O.employee?.full_name}?`))try{x(O.id),await Hu.approve(O.id,r),T()}catch(L){alert(L.message||"Khng th duyt phiu")}finally{x(null)}},H=O=>{w(O),A("")},z=async()=>{if(!(!v||!r)){if(!_.trim()){alert("Vui lng nhp l do t chi");return}try{x(v.id),await Hu.reject(v.id,r,_.trim()),w(null),A(""),T()}catch(O){alert(O.message||"Khng th t chi phiu")}finally{x(null)}}};return i?s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Duyt phiu tng ca"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a?"Duyt tt c phiu ng k tng ca trong cng ty":`Duyt phiu ng k tng ca trong phng ${e?.department_name||"ban"}`})]}),s.jsxs("div",{className:"flex border-b mb-6",children:[s.jsxs("button",{onClick:()=>g("pending"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y==="pending"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Ch duyt",o.length>0&&s.jsx("span",{className:"ml-2 bg-yellow-100 text-yellow-700 text-xs font-bold px-2 py-0.5 rounded-full",children:o.length})]}),s.jsx("button",{onClick:()=>g("history"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y==="history"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Lch s duyt"})]}),p&&s.jsx("div",{className:"bg-red-50 text-red-700 p-4 rounded-lg mb-6 text-sm",children:p}),y==="pending"&&s.jsx("div",{children:d?s.jsxs("div",{className:"flex items-center justify-center py-12 text-gray-500",children:[s.jsx(Mt,{className:"w-5 h-5 animate-spin mr-2"}),"ang ti..."]}):o.length===0?s.jsxs("div",{className:"bg-white rounded-lg border p-12 text-center",children:[s.jsx(hn,{className:"w-12 h-12 text-green-300 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"Khng c phiu ch duyt"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Tt c phiu tng ca  c x l."})]}):s.jsx("div",{className:"space-y-4",children:o.map(O=>s.jsx(O2e,{request:O,isLoading:m===O.id,onApprove:()=>U(O),onReject:()=>H(O)},O.id))})}),y==="history"&&s.jsx("div",{children:u.length===0?s.jsxs("div",{className:"bg-white rounded-lg border p-12 text-center",children:[s.jsx(Xr,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"Cha c lch s"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Bn cha duyt/t chi phiu no."})]}):s.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Nhn vin"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Ngy OT"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Gi OT"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Thi lng"}),s.jsx("th",{className:"text-center px-4 py-3 font-medium text-gray-600",children:"Kt qu"}),s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:"Thi gian x l"})]})}),s.jsx("tbody",{className:"divide-y",children:u.map(O=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-4 py-3",children:[s.jsx("div",{className:"font-medium text-gray-900",children:O.employee?.full_name}),s.jsx("div",{className:"text-xs text-gray-500",children:O.employee?.department?.name})]}),s.jsx("td",{className:"px-4 py-3 text-gray-600",children:x6(O.request_date)}),s.jsxs("td",{className:"px-4 py-3 text-gray-600",children:[Cm(O.planned_start_time),"  ",Cm(O.planned_end_time)]}),s.jsx("td",{className:"px-4 py-3 font-medium",children:v6(O.planned_minutes)}),s.jsx("td",{className:"px-4 py-3 text-center",children:O.status==="approved"?s.jsx("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:" duyt"}):s.jsx("span",{className:"inline-flex px-2.5 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"T chi"})}),s.jsx("td",{className:"px-4 py-3 text-gray-500 text-xs",children:SB(O.approved_at||"")})]},O.id))})]})})}),v&&s.jsx(M2e,{request:v,reason:_,onReasonChange:A,onConfirm:z,onClose:()=>w(null),isLoading:m===v.id})]}):s.jsx("div",{className:"p-6 max-w-3xl mx-auto",children:s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[s.jsx(Kr,{className:"w-12 h-12 text-yellow-500 mx-auto mb-3"}),s.jsx("h2",{className:"text-lg font-bold text-yellow-800 mb-2",children:"Khng c quyn truy cp"}),s.jsx("p",{className:"text-sm text-yellow-600",children:"Ch Trng phng tr ln mi c quyn duyt phiu tng ca."})]})})}function O2e({request:e,isLoading:r,onApprove:t,onReject:n}){const[a,i]=R.useState(!1);return s.jsxs("div",{className:"bg-white rounded-lg border hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-center gap-4 px-5 py-4",children:[s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 text-blue-700 rounded-full flex items-center justify-center font-bold text-sm shrink-0",children:(e.employee?.full_name||"?")[0]}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-medium text-gray-900 truncate",children:e.employee?.full_name}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[s.jsx($r,{className:"w-3 h-3"}),e.employee?.department?.name||""]})]})]})}),s.jsxs("div",{className:"text-center shrink-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Ngy OT"}),s.jsx("div",{className:"font-medium text-gray-900 text-sm",children:x6(e.request_date)})]}),s.jsxs("div",{className:"text-center shrink-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Gi OT"}),s.jsxs("div",{className:"font-medium text-gray-900 text-sm",children:[Cm(e.planned_start_time),"  ",Cm(e.planned_end_time)]})]}),s.jsxs("div",{className:"text-center shrink-0",children:[s.jsx("div",{className:"text-xs text-gray-500",children:"Thi lng"}),s.jsx("div",{className:"font-bold text-blue-600 text-sm",children:v6(e.planned_minutes)})]}),s.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[s.jsxs("button",{onClick:t,disabled:r,className:"flex items-center gap-1.5 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium disabled:opacity-50",children:[r?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(hn,{className:"w-4 h-4"}),"Duyt"]}),s.jsxs("button",{onClick:n,disabled:r,className:"flex items-center gap-1.5 px-3 py-2 bg-white border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors text-sm font-medium disabled:opacity-50",children:[s.jsx(ua,{className:"w-4 h-4"}),"T chi"]}),s.jsx("button",{onClick:()=>i(!a),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:a?s.jsx(si,{className:"w-4 h-4"}):s.jsx(Gs,{className:"w-4 h-4"})})]})]}),a&&s.jsxs("div",{className:"px-5 py-3 border-t bg-gray-50 text-sm",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ca lm vic:"})," ",s.jsx("span",{className:"text-gray-900",children:e.shift?.name||"Khng xc nh"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Ngy to:"})," ",s.jsx("span",{className:"text-gray-900",children:SB(e.created_at)})]})]}),s.jsxs("div",{className:"mt-2",children:[s.jsx("span",{className:"text-gray-500",children:"L do:"})," ",s.jsx("span",{className:"text-gray-900",children:e.reason})]})]})]})}function M2e({request:e,reason:r,onReasonChange:t,onConfirm:n,onClose:a,isLoading:i}){return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:a,children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center gap-2 px-6 py-4 border-b",children:[s.jsx(ua,{className:"w-5 h-5 text-red-500"}),s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"T chi phiu tng ca"})]}),s.jsxs("div",{className:"px-6 py-4 space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(ls,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"font-medium text-gray-900",children:e.employee?.full_name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dn,{className:"w-4 h-4 text-gray-500"}),s.jsxs("span",{className:"text-gray-600",children:[x6(e.request_date)," | ",Cm(e.planned_start_time),"  ",Cm(e.planned_end_time)," (",v6(e.planned_minutes),")"]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["L do t chi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:r,onChange:o=>t(o.target.value),rows:3,placeholder:"Nhp l do t chi phiu tng ca...",className:"w-full px-3 py-2.5 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 text-sm resize-none",autoFocus:!0})]})]}),s.jsxs("div",{className:"px-6 py-4 border-t bg-gray-50 rounded-b-xl flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:a,disabled:i,className:"px-4 py-2.5 border rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-sm font-medium disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:n,disabled:i||!r.trim(),className:"flex items-center gap-2 px-5 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:i?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang x l..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ua,{className:"w-4 h-4"}),"Xc nhn t chi"]})})]})]})})}async function uP(){try{const{data:{user:e}}=await se.auth.getUser();if(!e)return null;const{data:r,error:t}=await se.from("employees").select("id").eq("user_id",e.id).single();return t||!r?null:r.id}catch{return null}}const _s={async getAll(e={}){const r=e.page||1,t=e.pageSize||10,{search:n,status:a,supplier_type:i,supplier_group:o,province:c,sortBy:u,sortOrder:l}=e,d=(r-1)*t,f=d+t-1;let p=se.from("v_suppliers_list").select("*",{count:"exact"});a&&a!=="all"&&(p=p.eq("status",a)),i&&i!=="all"&&(p=p.eq("supplier_type",i)),o&&o!=="all"&&(p=p.eq("supplier_group",o)),c&&c!=="all"&&(p=p.eq("province",c)),n&&(p=p.or(`name.ilike.%${n}%,code.ilike.%${n}%,short_name.ilike.%${n}%,tax_code.ilike.%${n}%`));const h=u||"created_at",y=l==="asc";p=p.order(h,{ascending:y});const{data:g,error:m,count:x}=await p.range(d,f);if(m)throw m;return{data:g||[],total:x||0,page:r,pageSize:t,totalPages:Math.ceil((x||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("suppliers").select("*").eq("status","active").is("deleted_at",null).order("name");if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("suppliers").select("*").eq("id",e).is("deleted_at",null).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async getByCode(e){const{data:r,error:t}=await se.from("suppliers").select("*").eq("code",e).is("deleted_at",null).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async create(e){const r=await uP(),t={...e};r&&(t.created_by=r);const{data:n,error:a}=await se.from("suppliers").insert(t).select().single();if(a)throw console.error("Create supplier error:",a),a;return n},async update(e,r){const{data:t,error:n}=await se.from("suppliers").update(r).eq("id",e).is("deleted_at",null).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("suppliers").update({deleted_at:new Date().toISOString(),status:"inactive"}).eq("id",e);if(r)throw r},async restore(e){const{data:r,error:t}=await se.from("suppliers").update({deleted_at:null,status:"active"}).eq("id",e).select().single();if(t)throw t;return r},async checkCodeExists(e,r){let t=se.from("suppliers").select("id",{count:"exact",head:!0}).eq("code",e);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async checkTaxCodeExists(e,r){if(!e)return!1;let t=se.from("suppliers").select("id",{count:"exact",head:!0}).eq("tax_code",e).is("deleted_at",null);r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async getProvinces(){const{data:e,error:r}=await se.from("suppliers").select("province").not("province","is",null).is("deleted_at",null);if(r)throw r;return[...new Set(e?.map(n=>n.province).filter(Boolean))].sort()},async getContacts(e){const{data:r,error:t}=await se.from("supplier_contacts").select("*").eq("supplier_id",e).order("is_primary",{ascending:!1}).order("name");if(t)throw t;return r||[]},async getContactById(e){const{data:r,error:t}=await se.from("supplier_contacts").select("*").eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async createContact(e){const{data:r,error:t}=await se.from("supplier_contacts").insert(e).select().single();if(t)throw t;return r},async updateContact(e,r){const{data:t,error:n}=await se.from("supplier_contacts").update(r).eq("id",e).select().single();if(n)throw n;return t},async deleteContact(e){const{error:r}=await se.from("supplier_contacts").delete().eq("id",e);if(r)throw r},async setPrimaryContact(e,r){const{error:t}=await se.from("supplier_contacts").update({is_primary:!0}).eq("id",r).eq("supplier_id",e);if(t)throw t},async getQuotations(e,r){let t=se.from("supplier_quotations").select("*").eq("supplier_id",e).order("quotation_date",{ascending:!1});r&&r!=="all"&&(t=t.eq("status",r));const{data:n,error:a}=await t;if(a)throw a;return n||[]},async getActiveQuotations(e){const r=new Date().toISOString().split("T")[0],{data:t,error:n}=await se.from("supplier_quotations").select("*").eq("supplier_id",e).eq("status","active").or(`valid_until.is.null,valid_until.gte.${r}`).order("quotation_date",{ascending:!1});if(n)throw n;return t||[]},async getQuotationById(e){const{data:r,error:t}=await se.from("supplier_quotations").select("*").eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async createQuotation(e){const r=await uP(),t={...e};r&&(t.created_by=r);const{data:n,error:a}=await se.from("supplier_quotations").insert(t).select().single();if(a)throw a;return n},async updateQuotation(e,r){const{data:t,error:n}=await se.from("supplier_quotations").update(r).eq("id",e).select().single();if(n)throw n;return t},async deleteQuotation(e){const{error:r}=await se.from("supplier_quotations").delete().eq("id",e);if(r)throw r},async uploadQuotationFile(e,r){const t=r.name.split(".").pop(),n=`${e}/${Date.now()}_${Math.random().toString(36).substring(7)}.${t}`,{data:a,error:i}=await se.storage.from("supplier-quotations").upload(n,r,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:{publicUrl:o}}=se.storage.from("supplier-quotations").getPublicUrl(a.path);return{url:o,fileName:r.name,fileSize:r.size,fileType:r.type}},async deleteQuotationFile(e){const r=e.split("/supplier-quotations/");if(r.length<2)return;const t=r[1],{error:n}=await se.storage.from("supplier-quotations").remove([t]);if(n)throw n},async getStatistics(){const{data:e,error:r}=await se.from("suppliers").select("status").is("deleted_at",null);if(r)throw r;const t=e?.length||0,n=e?.filter(p=>p.status==="active").length||0,a=e?.filter(p=>p.status==="inactive").length||0,i=e?.filter(p=>p.status==="blocked").length||0,{data:o}=await se.from("suppliers").select("supplier_group").is("deleted_at",null),c=Object.entries((o||[]).reduce((p,h)=>(p[h.supplier_group]=(p[h.supplier_group]||0)+1,p),{})).map(([p,h])=>({group:p,count:h})),{data:u}=await se.from("suppliers").select("supplier_type").is("deleted_at",null),l=Object.entries((u||[]).reduce((p,h)=>(p[h.supplier_type]=(p[h.supplier_type]||0)+1,p),{})).map(([p,h])=>({type:p,count:h})),{data:d}=await se.from("suppliers").select("total_debt").is("deleted_at",null),f=(d||[]).reduce((p,h)=>p+(h.total_debt||0),0);return{total:t,active:n,inactive:a,blocked:i,byGroup:c,byType:l,totalDebt:f}},async getTopSuppliersByOrders(e=10){const{data:r,error:t}=await se.from("suppliers").select("*").is("deleted_at",null).eq("status","active").order("total_orders",{ascending:!1}).limit(e);if(t)throw t;return r||[]},async getSuppliersWithDebt(){const{data:e,error:r}=await se.from("suppliers").select("*").is("deleted_at",null).gt("total_debt",0).order("total_debt",{ascending:!1});if(r)throw r;return e||[]}},I2e=[{value:"all",label:"Tt c trng thi"},{value:"active",label:"ang hot ng"},{value:"inactive",label:"Tm ngng"},{value:"blocked",label:" kha"}],R2e=[{value:"all",label:"Tt c loi"},{value:"company",label:"Cng ty"},{value:"individual",label:"C nhn"}],L2e=[{value:"all",label:"Tt c nhm"},{value:"primary",label:"NCC Chnh"},{value:"secondary",label:"NCC Ph"},{value:"service",label:"Dch v"}],D2e=[10,20,50,100],F2e=({status:e})=>{const r={active:{label:"Hot ng",className:"bg-green-100 text-green-800",icon:s.jsx(hn,{size:14})},inactive:{label:"Tm ngng",className:"bg-yellow-100 text-yellow-800",icon:s.jsx(ua,{size:14})},blocked:{label:" kha",className:"bg-red-100 text-red-800",icon:s.jsx(nu,{size:14})}},{label:t,className:n,icon:a}=r[e]||r.inactive;return s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${n}`,children:[a,t]})},B2e=({type:e})=>{const r={company:{label:"Cng ty",className:"bg-blue-100 text-blue-800",icon:s.jsx($r,{size:14})},individual:{label:"C nhn",className:"bg-purple-100 text-purple-800",icon:s.jsx(ls,{size:14})}},{label:t,className:n,icon:a}=r[e]||r.company;return s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${n}`,children:[a,t]})},$2e=({group:e})=>{const r={primary:{label:"Chnh",className:"bg-emerald-100 text-emerald-800"},secondary:{label:"Ph",className:"bg-gray-100 text-gray-800"},service:{label:"Dch v",className:"bg-orange-100 text-orange-800"}},{label:t,className:n}=r[e]||r.secondary;return s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${n}`,children:t})},q2e=({rating:e})=>s.jsxs("div",{className:"flex items-center gap-0.5",children:[[1,2,3,4,5].map(r=>s.jsx(_o,{size:14,className:r<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"},r)),s.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",e.toFixed(1),")"]})]}),z2e=({onAdd:e})=>s.jsxs("div",{className:"text-center py-12",children:[s.jsx($r,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Cha c nh cung cp"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Bt u bng cch thm nh cung cp u tin."}),s.jsx("div",{className:"mt-6",children:s.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:20}),"Thm nh cung cp"]})})]}),U2e=({page:e,totalPages:r,total:t,pageSize:n,onPageChange:a,onPageSizeChange:i})=>{const o=(e-1)*n+1,c=Math.min(e*n,t);return s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-t",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-sm text-gray-700",children:["Hin th ",s.jsx("span",{className:"font-medium",children:o})," - ",s.jsx("span",{className:"font-medium",children:c})," trong ",s.jsx("span",{className:"font-medium",children:t})," kt qu"]}),s.jsx("select",{value:n,onChange:u=>i(Number(u.target.value)),className:"border rounded px-2 py-1 text-sm",children:D2e.map(u=>s.jsxs("option",{value:u,children:[u," / trang"]},u))})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>a(e-1),disabled:e===1,className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(su,{size:20})}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,r)},(u,l)=>{let d;return r<=5||e<=3?d=l+1:e>=r-2?d=r-4+l:d=e-2+l,s.jsx("button",{onClick:()=>a(d),className:`px-3 py-1 rounded text-sm ${e===d?"bg-blue-600 text-white":"hover:bg-gray-100"}`,children:d},d)})}),s.jsx("button",{onClick:()=>a(e+1),disabled:e===r,className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Ks,{size:20})})]})]})},H2e=()=>{const e=ts(),[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,u]=R.useState(1),[l,d]=R.useState(10),[f,p]=R.useState(0),[h,y]=R.useState(0),[g,m]=R.useState({search:"",status:"all",supplier_type:"all",supplier_group:"all",province:"all"}),[x,v]=R.useState(!1),[w,_]=R.useState([]),[A,P]=R.useState(null),[B,T]=R.useState(null),[I,U]=R.useState(!1),H=async()=>{try{a(!0),o(null);const q={page:c,pageSize:l,search:g.search||void 0,status:g.status!=="all"?g.status:void 0,supplier_type:g.supplier_type!=="all"?g.supplier_type:void 0,supplier_group:g.supplier_group!=="all"?g.supplier_group:void 0,province:g.province!=="all"?g.province:void 0},M=await _s.getAll(q);t(M.data),p(M.total),y(M.totalPages)}catch(q){console.error("Load suppliers error:",q),o("Khng th ti danh sch nh cung cp")}finally{a(!1)}},z=async()=>{try{const q=await _s.getProvinces();_(q)}catch(q){console.error("Load provinces error:",q)}};R.useEffect(()=>{H()},[c,l,g]),R.useEffect(()=>{z()},[]);const O=q=>{m(M=>({...M,search:q})),u(1)},L=(q,M)=>{m(G=>({...G,[q]:M})),u(1)},E=()=>{m({search:"",status:"all",supplier_type:"all",supplier_group:"all",province:"all"}),u(1)},k=()=>e("/purchasing/suppliers/new"),N=q=>{e(`/purchasing/suppliers/${q}`),P(null)},S=q=>{e(`/purchasing/suppliers/${q}/edit`),P(null)},C=async()=>{if(B)try{U(!0),await _s.delete(B.id),T(null),H()}catch(q){console.error("Delete supplier error:",q),alert("Khng th xa nh cung cp")}finally{U(!1)}},D=R.useMemo(()=>g.status!=="all"||g.supplier_type!=="all"||g.supplier_group!=="all"||g.province!=="all",[g]);return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nh cung cp"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"Qun l danh sch nh cung cp"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>alert("Tnh nng xut Excel ang pht trin"),className:"inline-flex items-center gap-2 px-4 py-2 border rounded-lg hover:bg-gray-50",children:[s.jsx(Wg,{size:20}),"Xut Excel"]}),s.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:20}),"Thm NCC"]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[s.jsxs("div",{className:"p-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),s.jsx("input",{type:"text",placeholder:"Tm theo tn, m, MST...",value:g.search,onChange:q=>O(q.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),g.search&&s.jsx("button",{onClick:()=>O(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(Br,{size:16})})]}),s.jsxs("button",{onClick:()=>v(!x),className:`inline-flex items-center gap-2 px-4 py-2 border rounded-lg ${D?"border-blue-500 bg-blue-50 text-blue-700":"hover:bg-gray-50"}`,children:[s.jsx(Al,{size:20}),"B lc",D&&s.jsx("span",{className:"w-5 h-5 bg-blue-600 text-white text-xs rounded-full flex items-center justify-center",children:[g.status,g.supplier_type,g.supplier_group,g.province].filter(q=>q!=="all").length})]}),s.jsx("button",{onClick:H,disabled:n,className:"p-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:s.jsx(Vr,{size:20,className:n?"animate-spin":""})})]}),x&&s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),s.jsx("select",{value:g.status,onChange:q=>L("status",q.target.value),className:"w-full border rounded-lg px-3 py-2",children:I2e.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi NCC"}),s.jsx("select",{value:g.supplier_type,onChange:q=>L("supplier_type",q.target.value),className:"w-full border rounded-lg px-3 py-2",children:R2e.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhm NCC"}),s.jsx("select",{value:g.supplier_group,onChange:q=>L("supplier_group",q.target.value),className:"w-full border rounded-lg px-3 py-2",children:L2e.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tnh/Thnh ph"}),s.jsxs("select",{value:g.province,onChange:q=>L("province",q.target.value),className:"w-full border rounded-lg px-3 py-2",children:[s.jsx("option",{value:"all",children:"Tt c"}),w.map(q=>s.jsx("option",{value:q,children:q},q))]})]})]}),D&&s.jsx("div",{className:"mt-4",children:s.jsx("button",{onClick:E,className:"text-sm text-blue-600 hover:text-blue-800",children:"Xa b lc"})})]})]}),i&&s.jsx("div",{className:"p-4 bg-red-50 border-b border-red-100",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[s.jsx(Cr,{size:20}),s.jsx("span",{children:i}),s.jsx("button",{onClick:H,className:"ml-auto text-sm underline",children:"Th li"})]})}),n?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(Vr,{className:"mx-auto h-8 w-8 text-gray-400 animate-spin"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]}):r.length===0?s.jsx(z2e,{onAdd:k}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nh cung cp"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Loi / Nhm"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lin h"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"a ch"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"n hng"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Cng n"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y",children:r.map(q=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{children:[s.jsx("button",{onClick:()=>N(q.id),className:"font-medium text-blue-600 hover:text-blue-800 text-left",children:q.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:q.code}),q.tax_code&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-gray-300",children:""}),s.jsxs("span",{className:"text-xs text-gray-500",children:["MST: ",q.tax_code]})]})]}),q.rating>0&&s.jsx("div",{className:"mt-1",children:s.jsx(q2e,{rating:q.rating})})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx(B2e,{type:q.supplier_type}),s.jsx($2e,{group:q.supplier_group})]})}),s.jsx("td",{className:"px-4 py-4",children:s.jsxs("div",{className:"space-y-1 text-sm",children:[q.contact_name&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[s.jsx(ls,{size:14,className:"text-gray-400"}),q.contact_name]}),q.phone&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx(_f,{size:14,className:"text-gray-400"}),q.phone]}),q.email&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx(gg,{size:14,className:"text-gray-400"}),s.jsx("span",{className:"truncate max-w-[150px]",children:q.email})]})]})}),s.jsx("td",{className:"px-4 py-4",children:q.province&&s.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[s.jsx(dc,{size:14,className:"text-gray-400 flex-shrink-0"}),s.jsx("span",{className:"truncate max-w-[150px]",children:q.province})]})}),s.jsxs("td",{className:"px-4 py-4 text-center",children:[s.jsx("span",{className:"text-sm font-medium",children:q.total_orders||0}),q.active_quotations_count&&q.active_quotations_count>0&&s.jsxs("div",{className:"flex items-center justify-center gap-1 mt-1 text-xs text-blue-600",children:[s.jsx(vr,{size:12}),q.active_quotations_count," bo gi"]})]}),s.jsx("td",{className:"px-4 py-4 text-right",children:q.total_debt>0?s.jsx("span",{className:"text-sm font-medium text-red-600",children:new Intl.NumberFormat("vi-VN").format(q.total_debt)}):s.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsx(F2e,{status:q.status})}),s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>P(A===q.id?null:q.id),className:"p-2 rounded hover:bg-gray-100",children:s.jsx(Bb,{size:20})}),A===q.id&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>P(null)}),s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-20",children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:()=>N(q.id),className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(ja,{size:16}),"Xem chi tit"]}),s.jsxs("button",{onClick:()=>S(q.id),className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(ad,{size:16}),"Chnh sa"]}),s.jsx("hr",{className:"my-1"}),s.jsxs("button",{onClick:()=>{T({id:q.id,name:q.name}),P(null)},className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{size:16}),"Xa"]})]})})]})]})})]},q.id))})]})}),s.jsx(U2e,{page:c,totalPages:h,total:f,pageSize:l,onPageChange:u,onPageSizeChange:q=>{d(q),u(1)}})]})]}),B&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[s.jsx(Cr,{size:24}),s.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn xa"})]}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa nh cung cp ",s.jsx("strong",{children:B.name}),"?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-gray-500",children:"Hnh ng ny khng th hon tc."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>T(null),disabled:I,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:C,disabled:I,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:I?"ang xa...":"Xa"})]})]})})]})},V2e=[{value:"company",label:"Cng ty",icon:$r},{value:"individual",label:"C nhn",icon:ls}],W2e=[{value:"primary",label:"NCC Chnh",description:"Nh cung cp chnh, u tin t hng"},{value:"secondary",label:"NCC Ph",description:"Nh cung cp d phng"},{value:"service",label:"Dch v",description:"Cung cp dch v (vn chuyn, bo tr...)"}],K2e=[{value:0,label:"Thanh ton ngay"},{value:7,label:"7 ngy"},{value:15,label:"15 ngy"},{value:30,label:"30 ngy"},{value:45,label:"45 ngy"},{value:60,label:"60 ngy"},{value:90,label:"90 ngy"}],G2e=["An Giang","B Ra - Vng Tu","Bc Giang","Bc Kn","Bc Liu","Bc Ninh","Bn Tre","Bnh nh","Bnh Dng","Bnh Phc","Bnh Thun","C Mau","Cn Th","Cao Bng"," Nng","k Lk","k Nng","in Bin","ng Nai","ng Thp","Gia Lai","H Giang","H Nam","H Ni","H Tnh","Hi Dng","Hi Phng","Hu Giang","Ha Bnh","Hng Yn","Khnh Ha","Kin Giang","Kon Tum","Lai Chu","Lm ng","Lng Sn","Lo Cai","Long An","Nam nh","Ngh An","Ninh Bnh","Ninh Thun","Ph Th","Ph Yn","Qung Bnh","Qung Nam","Qung Ngi","Qung Ninh","Qung Tr","Sc Trng","Sn La","Ty Ninh","Thi Bnh","Thi Nguyn","Thanh Ha","Tha Thin Hu","Tin Giang","TP. H Ch Minh","Tr Vinh","Tuyn Quang","Vnh Long","Vnh Phc","Yn Bi"],Wp=({title:e,icon:r,children:t})=>s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-4 border-b",children:[s.jsx("span",{className:"text-blue-600",children:r}),s.jsx("h3",{className:"font-semibold text-gray-900",children:e})]}),t]}),na=({label:e,required:r,error:t,children:n,className:a=""})=>s.jsxs("div",{className:a,children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e,r&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n,t&&s.jsxs("p",{className:"mt-1 text-sm text-red-500 flex items-center gap-1",children:[s.jsx(Cr,{size:14}),t]})]}),CB=({supplier:e,onSuccess:r,onCancel:t})=>{const n=!!e,[a,i]=R.useState({name:"",short_name:"",supplier_type:"company",supplier_group:"primary",tax_code:"",phone:"",email:"",website:"",address:"",province:"",district:"",ward:"",bank_name:"",bank_account:"",bank_branch:"",bank_holder:"",payment_terms:30,credit_limit:0,contact_name:"",contact_phone:"",contact_email:"",contact_position:"",notes:"",status:"active"}),[o,c]=R.useState({}),[u,l]=R.useState(!1),[d,f]=R.useState(!1);R.useEffect(()=>{e&&i({name:e.name||"",short_name:e.short_name||"",supplier_type:e.supplier_type||"company",supplier_group:e.supplier_group||"primary",tax_code:e.tax_code||"",phone:e.phone||"",email:e.email||"",website:e.website||"",address:e.address||"",province:e.province||"",district:e.district||"",ward:e.ward||"",bank_name:e.bank_name||"",bank_account:e.bank_account||"",bank_branch:e.bank_branch||"",bank_holder:e.bank_holder||"",payment_terms:e.payment_terms||30,credit_limit:e.credit_limit||0,contact_name:e.contact_name||"",contact_phone:e.contact_phone||"",contact_email:e.contact_email||"",contact_position:e.contact_position||"",notes:e.notes||"",status:e.status||"active"})},[e]);const p=x=>{const{name:v,value:w,type:_}=x.target;i(A=>({...A,[v]:_==="number"?w===""?0:Number(w):w})),o[v]&&c(A=>({...A,[v]:void 0}))},h=x=>{i(v=>({...v,supplier_type:x}))},y=x=>{i(v=>({...v,supplier_group:x}))},g=async()=>{const x={};if(a.name?.trim()||(x.name="Vui lng nhp tn nh cung cp"),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&(x.email="Email khng hp l"),a.phone&&!/^[0-9]{10,11}$/.test(a.phone.replace(/[^0-9]/g,""))&&(x.phone="S in thoi khng hp l"),a.tax_code?.trim()){f(!0);try{await _s.checkTaxCodeExists(a.tax_code,e?.id)&&(x.tax_code="M s thu  tn ti")}catch(v){console.error("Check tax code error:",v)}finally{f(!1)}}return c(x),Object.keys(x).length===0},m=async x=>{if(x.preventDefault(),!!await g()){l(!0),c({});try{let w;n&&e?w=await _s.update(e.id,a):w=await _s.create(a),r(w)}catch(w){console.error("Save supplier error:",w),c({general:w.message||"Khng th lu nh cung cp. Vui lng th li."})}finally{l(!1)}}};return s.jsxs("form",{onSubmit:m,className:"space-y-6",children:[o.general&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-2 text-red-700",children:[s.jsx(Cr,{size:20}),o.general]}),s.jsxs(Wp,{title:"Thng tin c bn",icon:s.jsx($r,{size:20}),children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Loi nh cung cp ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:V2e.map(x=>{const v=x.icon,w=a.supplier_type===x.value;return s.jsxs("button",{type:"button",onClick:()=>h(x.value),className:`flex items-center gap-3 p-4 rounded-lg border-2 transition-colors ${w?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("div",{className:`p-2 rounded-lg ${w?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500"}`,children:s.jsx(v,{size:24})}),s.jsx("span",{className:`font-medium ${w?"text-blue-700":"text-gray-700"}`,children:x.label})]},x.value)})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nhm nh cung cp ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:W2e.map(x=>{const v=a.supplier_group===x.value;return s.jsxs("button",{type:"button",onClick:()=>y(x.value),className:`p-4 rounded-lg border-2 text-left transition-colors ${v?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx("span",{className:`font-medium ${v?"text-blue-700":"text-gray-700"}`,children:x.label}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x.description})]},x.value)})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(na,{label:"Tn nh cung cp",required:!0,error:o.name,className:"md:col-span-2",children:s.jsx("input",{type:"text",name:"name",value:a.name,onChange:p,placeholder:"VD: Cng ty TNHH Xi mng Holcim Vit Nam",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.name?"border-red-300":"border-gray-300"}`})}),s.jsx(na,{label:"Tn vit tt",children:s.jsx("input",{type:"text",name:"short_name",value:a.short_name,onChange:p,placeholder:"VD: Holcim",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"M s thu",error:o.tax_code,children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",name:"tax_code",value:a.tax_code,onChange:p,placeholder:"VD: 0302080428",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.tax_code?"border-red-300":"border-gray-300"}`}),d&&s.jsx(Mt,{className:"absolute right-3 top-1/2 -translate-y-1/2 animate-spin text-gray-400",size:18})]})})]})]}),s.jsxs(Wp,{title:"Thng tin lin h",icon:s.jsx(_f,{size:20}),children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(na,{label:"S in thoi",error:o.phone,children:s.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:p,placeholder:"VD: 028 3824 5888",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.phone?"border-red-300":"border-gray-300"}`})}),s.jsx(na,{label:"Email",error:o.email,children:s.jsx("input",{type:"email",name:"email",value:a.email,onChange:p,placeholder:"VD: contact@holcim.com.vn",className:`w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.email?"border-red-300":"border-gray-300"}`})}),s.jsx(na,{label:"Website",className:"md:col-span-2",children:s.jsx("input",{type:"url",name:"website",value:a.website,onChange:p,placeholder:"VD: https://www.holcim.com.vn",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})})]}),s.jsxs("div",{className:"mt-6 pt-6 border-t",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-4",children:"Ngi lin h chnh"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(na,{label:"H tn",children:s.jsx("input",{type:"text",name:"contact_name",value:a.contact_name,onChange:p,placeholder:"VD: Nguyn Vn A",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"Chc v",children:s.jsx("input",{type:"text",name:"contact_position",value:a.contact_position,onChange:p,placeholder:"VD: Trng phng Kinh doanh",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"in thoi",children:s.jsx("input",{type:"tel",name:"contact_phone",value:a.contact_phone,onChange:p,placeholder:"VD: 0903 123 456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"Email",children:s.jsx("input",{type:"email",name:"contact_email",value:a.contact_email,onChange:p,placeholder:"VD: nguyenvana@holcim.com.vn",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})})]})]})]}),s.jsx(Wp,{title:"a ch",icon:s.jsx(dc,{size:20}),children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(na,{label:"Tnh/Thnh ph",children:s.jsxs("select",{name:"province",value:a.province,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Chn tnh/thnh --"}),G2e.map(x=>s.jsx("option",{value:x,children:x},x))]})}),s.jsx(na,{label:"Qun/Huyn",children:s.jsx("input",{type:"text",name:"district",value:a.district,onChange:p,placeholder:"VD: Qun 1",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"Phng/X",children:s.jsx("input",{type:"text",name:"ward",value:a.ward,onChange:p,placeholder:"VD: Phng Bn Ngh",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"a ch chi tit",className:"md:col-span-3",children:s.jsx("textarea",{name:"address",value:a.address,onChange:p,rows:2,placeholder:"VD: 123 ng Nguyn Hu",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})})]})}),s.jsx(Wp,{title:"Thng tin ngn hng",icon:s.jsx(lc,{size:20}),children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(na,{label:"Tn ngn hng",children:s.jsx("input",{type:"text",name:"bank_name",value:a.bank_name,onChange:p,placeholder:"VD: Vietcombank",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"Chi nhnh",children:s.jsx("input",{type:"text",name:"bank_branch",value:a.bank_branch,onChange:p,placeholder:"VD: Chi nhnh Si Gn",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"S ti khon",children:s.jsx("input",{type:"text",name:"bank_account",value:a.bank_account,onChange:p,placeholder:"VD: 0071001234567",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),s.jsx(na,{label:"Tn ch ti khon",children:s.jsx("input",{type:"text",name:"bank_holder",value:a.bank_holder,onChange:p,placeholder:"VD: CTY TNHH XI MANG HOLCIM VN",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})})]})}),s.jsxs(Wp,{title:"iu khon thanh ton",icon:s.jsx(vr,{size:20}),children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(na,{label:"Thi hn thanh ton",children:s.jsx("select",{name:"payment_terms",value:a.payment_terms,onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:K2e.map(x=>s.jsx("option",{value:x.value,children:x.label},x.value))})}),s.jsxs(na,{label:"Hn mc cng n",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"number",name:"credit_limit",value:a.credit_limit||"",onChange:p,min:0,step:1e6,placeholder:"0 = Khng gii hn",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm",children:"VN"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:" trng hoc nhp 0 nu khng gii hn cng n"})]})]}),s.jsx("div",{className:"mt-4",children:s.jsx(na,{label:"Ghi ch",children:s.jsx("textarea",{name:"notes",value:a.notes,onChange:p,rows:3,placeholder:"Ghi ch thm v nh cung cp...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})})})]}),n&&s.jsx(Wp,{title:"Trng thi",icon:s.jsx(hn,{size:20}),children:s.jsx("div",{className:"flex items-center gap-6",children:[{value:"active",label:"Hot ng",color:"green"},{value:"inactive",label:"Tm ngng",color:"yellow"},{value:"blocked",label:" kha",color:"red"}].map(x=>s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"status",value:x.value,checked:a.status===x.value,onChange:p,className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:`text-${x.color}-600 font-medium`,children:x.label})]},x.value))})}),s.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[s.jsxs("button",{type:"button",onClick:t,disabled:u,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[s.jsx(Br,{size:18,className:"inline mr-2"}),"Hy"]}),s.jsx("button",{type:"submit",disabled:u||d,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:u?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{size:18,className:"animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{size:18}),n?"Cp nht":"To mi"]})})]})]})},X2e=()=>{const e=ts(),r=n=>{e(`/purchasing/suppliers/${n.id}`,{state:{message:` to nh cung cp ${n.code} thnh cng!`}})},t=()=>{e("/purchasing/suppliers")};return s.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4",children:[s.jsx(wo,{size:20}),"Quay li danh sch"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx($r,{className:"text-blue-600",size:28})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Thm nh cung cp mi"}),s.jsx("p",{className:"text-gray-500",children:"Nhp thng tin nh cung cp"})]})]})]}),s.jsx(CB,{supplier:null,onSuccess:r,onCancel:t})]})},Y2e=()=>{const e=ts(),{id:r}=_h(),[t,n]=R.useState(null),[a,i]=R.useState(!0),[o,c]=R.useState(null);R.useEffect(()=>{(async()=>{if(!r){c("ID nh cung cp khng hp l"),i(!1);return}try{i(!0);const f=await _s.getById(r);f?n(f):c("Khng tm thy nh cung cp")}catch(f){console.error("Load supplier error:",f),c("Khng th ti thng tin nh cung cp")}finally{i(!1)}})()},[r]);const u=d=>{e(`/purchasing/suppliers/${d.id}`,{state:{message:" cp nht nh cung cp thnh cng!"}})},l=()=>{e(`/purchasing/suppliers/${r}`)};return a?s.jsx("div",{className:"p-6 flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mt,{className:"mx-auto h-10 w-10 text-blue-600 animate-spin"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti thng tin..."})]})}):o?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"max-w-md mx-auto text-center",children:[s.jsx("div",{className:"p-4 bg-red-50 rounded-full w-16 h-16 mx-auto flex items-center justify-center mb-4",children:s.jsx(Cr,{className:"text-red-500",size:32})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Li"}),s.jsx("p",{className:"text-gray-600 mb-6",children:o}),s.jsx("button",{onClick:()=>e("/purchasing/suppliers"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Quay li danh sch"})]})}):s.jsxs("div",{className:"p-6 max-w-5xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4",children:[s.jsx(wo,{size:20}),"Quay li"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx($r,{className:"text-blue-600",size:28})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Chnh sa nh cung cp"}),s.jsxs("p",{className:"text-gray-500",children:[t?.code," - ",t?.name]})]})]})]}),t&&s.jsx(CB,{supplier:t,onSuccess:u,onCancel:l})]})},AB=[{value:"general",label:"Lin h chung"},{value:"sales",label:"Kinh doanh"},{value:"accounting",label:"K ton"},{value:"technical",label:"K thut"},{value:"management",label:"Qun l"}],Q2e=({supplierId:e,contact:r,onClose:t,onSuccess:n})=>{const a=!!r,[i,o]=R.useState({supplier_id:e,name:"",position:"",department:"",phone:"",mobile:"",email:"",contact_type:"general",is_primary:!1,notes:""}),[c,u]=R.useState(!1),[l,d]=R.useState(null);R.useEffect(()=>{r&&o({supplier_id:e,name:r.name||"",position:r.position||"",department:r.department||"",phone:r.phone||"",mobile:r.mobile||"",email:r.email||"",contact_type:r.contact_type||"general",is_primary:r.is_primary||!1,notes:r.notes||""})},[r,e]);const f=h=>{const{name:y,value:g,type:m}=h.target;o(x=>({...x,[y]:m==="checkbox"?h.target.checked:g}))},p=async h=>{if(h.preventDefault(),!i.name?.trim()){d("Vui lng nhp h tn");return}u(!0),d(null);try{a&&r?await _s.updateContact(r.id,i):await _s.createContact(i),n()}catch(y){console.error("Save contact error:",y),d(y.message||"Khng th lu thng tin lin h")}finally{u(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b sticky top-0 bg-white",children:[s.jsx("h3",{className:"text-lg font-semibold",children:a?"Chnh sa lin h":"Thm lin h mi"}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{size:20})})]}),s.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[l&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700 text-sm",children:[s.jsx(Cr,{size:16}),l]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["H tn ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:i.name,onChange:f,placeholder:"Nguyn Vn A",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chc v"}),s.jsx("input",{type:"text",name:"position",value:i.position,onChange:f,placeholder:"Trng phng",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban"}),s.jsx("input",{type:"text",name:"department",value:i.department,onChange:f,placeholder:"Phng Kinh doanh",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi lin h"}),s.jsx("select",{name:"contact_type",value:i.contact_type,onChange:f,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:AB.map(h=>s.jsx("option",{value:h.value,children:h.label},h.value))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"in thoi c nh"}),s.jsx("input",{type:"tel",name:"phone",value:i.phone,onChange:f,placeholder:"028 1234 5678",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Di ng"}),s.jsx("input",{type:"tel",name:"mobile",value:i.mobile,onChange:f,placeholder:"0903 123 456",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{type:"email",name:"email",value:i.email,onChange:f,placeholder:"nguyenvana@company.com",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",name:"is_primary",id:"is_primary",checked:i.is_primary,onChange:f,className:"w-4 h-4 text-blue-600 rounded"}),s.jsx("label",{htmlFor:"is_primary",className:"text-sm text-gray-700",children:"t lm lin h chnh"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),s.jsx("textarea",{name:"notes",value:i.notes,onChange:f,rows:2,placeholder:"Ghi ch...",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:t,disabled:c,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsxs("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:[c?s.jsx(Mt,{size:18,className:"animate-spin"}):s.jsx(ai,{size:18}),a?"Cp nht":"Thm mi"]})]})]})]})})},Z2e=({contact:e,onEdit:r,onDelete:t,onSetPrimary:n})=>{const[a,i]=R.useState(!1),o=c=>AB.find(u=>u.value===c)?.label||c;return s.jsxs("div",{className:`bg-white rounded-lg border p-4 ${e.is_primary?"ring-2 ring-blue-500":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-full ${e.is_primary?"bg-blue-100":"bg-gray-100"}`,children:s.jsx(ls,{size:20,className:e.is_primary?"text-blue-600":"text-gray-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),e.is_primary&&s.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-xs rounded-full flex items-center gap-1",children:[s.jsx(_o,{size:12,className:"fill-current"}),"Chnh"]})]}),e.position&&s.jsx("p",{className:"text-sm text-gray-500",children:e.position})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>i(!a),className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(Bb,{size:18})}),a&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>i(!1)}),s.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-lg shadow-lg border z-20",children:[s.jsxs("button",{onClick:()=>{r(),i(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(ad,{size:14}),"Chnh sa"]}),!e.is_primary&&s.jsxs("button",{onClick:()=>{n(),i(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(_o,{size:14}),"t lm chnh"]}),s.jsx("hr",{}),s.jsxs("button",{onClick:()=>{t(),i(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{size:14}),"Xa"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[e.department&&s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx($r,{size:14,className:"text-gray-400"}),e.department]}),(e.phone||e.mobile)&&s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(_f,{size:14,className:"text-gray-400"}),e.mobile||e.phone,e.phone&&e.mobile&&s.jsxs("span",{className:"text-gray-400",children:["/ ",e.phone]})]}),e.email&&s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(gg,{size:14,className:"text-gray-400"}),s.jsx("a",{href:`mailto:${e.email}`,className:"text-blue-600 hover:underline",children:e.email})]})]}),s.jsx("div",{className:"mt-3 pt-3 border-t",children:s.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:o(e.contact_type)})})]})},J2e=({supplierId:e})=>{const[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,u]=R.useState(!1),[l,d]=R.useState(null),[f,p]=R.useState(null),[h,y]=R.useState(!1),g=async()=>{try{a(!0),o(null);const A=await _s.getContacts(e);t(A)}catch(A){console.error("Load contacts error:",A),o("Khng th ti danh sch lin h")}finally{a(!1)}};R.useEffect(()=>{g()},[e]);const m=()=>{d(null),u(!0)},x=A=>{d(A),u(!0)},v=()=>{u(!1),d(null),g()},w=async()=>{if(f)try{y(!0),await _s.deleteContact(f.id),p(null),g()}catch(A){console.error("Delete contact error:",A),alert("Khng th xa lin h")}finally{y(!1)}},_=async A=>{try{await _s.setPrimaryContact(e,A.id),g()}catch(P){console.error("Set primary contact error:",P),alert("Khng th t lm lin h chnh")}};return n?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(Mt,{className:"mx-auto h-8 w-8 text-blue-600 animate-spin"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]}):i?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(Cr,{className:"mx-auto h-8 w-8 text-red-500"}),s.jsx("p",{className:"mt-2 text-red-600",children:i}),s.jsx("button",{onClick:g,className:"mt-4 text-blue-600 hover:underline",children:"Th li"})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Ngi lin h (",r.length,")"]}),s.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:18}),"Thm lin h"]})]}),r.length===0?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(ls,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 font-medium text-gray-900",children:"Cha c ngi lin h"}),s.jsx("p",{className:"mt-1 text-gray-500",children:"Thm ngi lin h u tin cho nh cung cp ny"}),s.jsxs("button",{onClick:m,className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:18}),"Thm lin h"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(A=>s.jsx(Z2e,{contact:A,onEdit:()=>x(A),onDelete:()=>p(A),onSetPrimary:()=>_(A)},A.id))}),c&&s.jsx(Q2e,{supplierId:e,contact:l,onClose:()=>{u(!1),d(null)},onSuccess:v}),f&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[s.jsx(Cr,{size:24}),s.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn xa"})]}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa lin h ",s.jsx("strong",{children:f.name}),"?"]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>p(null),disabled:h,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:w,disabled:h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:h?"ang xa...":"Xa"})]})]})})]})},Tb=[{value:"active",label:"Cn hiu lc",color:"green"},{value:"expired",label:"Ht hn",color:"red"},{value:"superseded",label:" thay th",color:"yellow"},{value:"cancelled",label:" hy",color:"gray"}],ewe=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png","image/gif"],twe=10*1024*1024,S4=e=>{if(e===0)return"0 Bytes";const r=1024,t=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(r));return parseFloat((e/Math.pow(r,n)).toFixed(2))+" "+t[n]},C4=e=>e?e.includes("pdf")?s.jsx(vr,{size:20,className:"text-red-500"}):e.includes("image")?s.jsx(bO,{size:20,className:"text-blue-500"}):e.includes("sheet")||e.includes("excel")?s.jsx(zb,{size:20,className:"text-green-500"}):s.jsx(vr,{size:20,className:"text-gray-500"}):s.jsx(mg,{size:20}),rwe=e=>e?new Date(e)<new Date:!1,nwe=({supplierId:e,quotation:r,onClose:t,onSuccess:n})=>{const a=!!r,i=R.useRef(null),[o,c]=R.useState({supplier_id:e,quotation_number:"",quotation_date:new Date().toISOString().split("T")[0],valid_until:"",title:"",description:"",total_amount:void 0,currency:"VND",status:"active",notes:""}),[u,l]=R.useState(null),[d,f]=R.useState(!1),[p,h]=R.useState(!1),[y,g]=R.useState(null);R.useEffect(()=>{r&&c({supplier_id:e,quotation_number:r.quotation_number||"",quotation_date:r.quotation_date?.split("T")[0]||"",valid_until:r.valid_until?.split("T")[0]||"",title:r.title||"",description:r.description||"",file_url:r.file_url,file_name:r.file_name,file_size:r.file_size,file_type:r.file_type,total_amount:r.total_amount,currency:r.currency||"VND",status:r.status||"active",notes:r.notes||""})},[r,e]);const m=_=>{const{name:A,value:P,type:B}=_.target;c(T=>({...T,[A]:B==="number"?P===""?void 0:Number(P):P}))},x=_=>{const A=_.target.files?.[0];if(A){if(!ewe.includes(A.type)){g("Loi file khng c h tr. Ch chp nhn PDF, Word, Excel, v hnh nh.");return}if(A.size>twe){g("File qu ln. Kch thc ti a l 10MB.");return}l(A),g(null)}},v=()=>{l(null),i.current&&(i.current.value="")},w=async _=>{if(_.preventDefault(),!o.quotation_date){g("Vui lng nhp ngy bo gi");return}h(!0),g(null);try{let A={file_url:o.file_url,file_name:o.file_name,file_size:o.file_size,file_type:o.file_type};if(u){f(!0);const B=await _s.uploadQuotationFile(e,u);A={file_url:B.url,file_name:B.fileName,file_size:B.fileSize,file_type:B.fileType},f(!1)}const P={...o,...A};a&&r?await _s.updateQuotation(r.id,P):await _s.createQuotation(P),n()}catch(A){console.error("Save quotation error:",A),g(A.message||"Khng th lu bo gi")}finally{h(!1),f(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b sticky top-0 bg-white",children:[s.jsx("h3",{className:"text-lg font-semibold",children:a?"Chnh sa bo gi":"Thm bo gi mi"}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{size:20})})]}),s.jsxs("form",{onSubmit:w,className:"p-4 space-y-4",children:[y&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700 text-sm",children:[s.jsx(Cr,{size:16}),y]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S bo gi"}),s.jsx("input",{type:"text",name:"quotation_number",value:o.quotation_number,onChange:m,placeholder:"BG-2026-001",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),s.jsx("select",{name:"status",value:o.status,onChange:m,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Tb.map(_=>s.jsx("option",{value:_.value,children:_.label},_.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tiu "}),s.jsx("input",{type:"text",name:"title",value:o.title,onChange:m,placeholder:"Bo gi vt liu xy dng Q1/2026",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngy bo gi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",name:"quotation_date",value:o.quotation_date,onChange:m,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hiu lc n"}),s.jsx("input",{type:"date",name:"valid_until",value:o.valid_until,onChange:m,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tng gi tr"}),s.jsx("input",{type:"number",name:"total_amount",value:o.total_amount||"",onChange:m,min:0,placeholder:"0",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v tin"}),s.jsxs("select",{name:"currency",value:o.currency,onChange:m,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"VND",children:"VND"}),s.jsx("option",{value:"USD",children:"USD"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File nh km"}),o.file_url&&!u&&s.jsxs("div",{className:"mb-2 p-3 bg-gray-50 border rounded-lg flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[C4(o.file_type),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:o.file_name}),o.file_size&&s.jsx("p",{className:"text-xs text-gray-500",children:S4(o.file_size)})]})]}),s.jsx("a",{href:o.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:"Xem file"})]}),u&&s.jsxs("div",{className:"mb-2 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[C4(u.type),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-700",children:u.name}),s.jsx("p",{className:"text-xs text-blue-600",children:S4(u.size)})]})]}),s.jsx("button",{type:"button",onClick:v,className:"text-red-500 hover:text-red-700",children:s.jsx(Br,{size:18})})]}),s.jsx("input",{ref:i,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif",onChange:x,className:"hidden"}),s.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-full px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-blue-400 hover:text-blue-500 flex items-center justify-center gap-2",children:[s.jsx(Gg,{size:20}),u||o.file_url?"Thay i file":"Chn file  upload"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"H tr: PDF, Word, Excel, hnh nh. Ti a 10MB."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:o.description,onChange:m,rows:2,placeholder:"M t ni dung bo gi...",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),s.jsx("textarea",{name:"notes",value:o.notes,onChange:m,rows:2,placeholder:"Ghi ch thm...",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:t,disabled:p,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{type:"submit",disabled:p||d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:p||d?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{size:18,className:"animate-spin"}),d?"ang upload...":"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{size:18}),a?"Cp nht":"Thm mi"]})})]})]})]})})},swe=({quotation:e,onEdit:r,onDelete:t})=>{const[n,a]=R.useState(!1),i=rwe(e.valid_until),o=Tb.find(u=>u.value===e.status)||Tb[0],c=(u,l="VND")=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:l}).format(u);return s.jsxs("div",{className:`bg-white rounded-lg border p-4 ${i&&e.status==="active"?"border-red-200":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${i?"bg-red-100":"bg-blue-100"}`,children:s.jsx(vr,{size:20,className:i?"text-red-600":"text-blue-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("h4",{className:"font-medium text-gray-900",children:e.title||e.quotation_number||"Bo gi"})}),e.quotation_number&&e.title&&s.jsx("p",{className:"text-sm text-gray-500",children:e.quotation_number})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>a(!n),className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(Bb,{size:18})}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s.jsxs("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-lg shadow-lg border z-20",children:[e.file_url&&s.jsxs("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>a(!1),children:[s.jsx(ja,{size:14}),"Xem file"]}),s.jsxs("button",{onClick:()=>{r(),a(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(ad,{size:14}),"Chnh sa"]}),s.jsx("hr",{}),s.jsxs("button",{onClick:()=>{t(),a(!1)},className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{size:14}),"Xa"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[s.jsx(dn,{size:14,className:"text-gray-400"}),new Date(e.quotation_date).toLocaleDateString("vi-VN")]}),e.valid_until&&s.jsxs("div",{className:`flex items-center gap-1 ${i?"text-red-600":"text-gray-600"}`,children:[s.jsx(Xr,{size:14,className:i?"text-red-400":"text-gray-400"}),"HSD: ",new Date(e.valid_until).toLocaleDateString("vi-VN"),i&&s.jsx("span",{className:"text-xs",children:"(Ht hn)"})]})]}),e.total_amount&&s.jsxs("div",{className:"flex items-center gap-1 text-gray-900 font-medium",children:[s.jsx(Y4,{size:14,className:"text-gray-400"}),c(e.total_amount,e.currency)]}),e.file_url&&s.jsxs("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:underline",children:[C4(e.file_type),s.jsx("span",{className:"truncate",children:e.file_name}),e.file_size&&s.jsxs("span",{className:"text-gray-400 text-xs",children:["(",S4(e.file_size),")"]})]}),e.description&&s.jsx("p",{className:"text-gray-500 line-clamp-2",children:e.description})]}),s.jsxs("div",{className:"mt-3 pt-3 border-t flex items-center justify-between",children:[s.jsx("span",{className:`px-2 py-1 bg-${o.color}-100 text-${o.color}-700 text-xs rounded font-medium`,children:o.label}),s.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString("vi-VN")})]})]})},awe=({supplierId:e})=>{const[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(null),[c,u]=R.useState("all"),[l,d]=R.useState(!1),[f,p]=R.useState(null),[h,y]=R.useState(null),[g,m]=R.useState(!1),x=async()=>{try{a(!0),o(null);const P=c!=="all"?c:void 0,B=await _s.getQuotations(e,P);t(B)}catch(P){console.error("Load quotations error:",P),o("Khng th ti danh sch bo gi")}finally{a(!1)}};R.useEffect(()=>{x()},[e,c]);const v=()=>{p(null),d(!0)},w=P=>{p(P),d(!0)},_=()=>{d(!1),p(null),x()},A=async()=>{if(h)try{m(!0),h.file_url&&await _s.deleteQuotationFile(h.file_url),await _s.deleteQuotation(h.id),y(null),x()}catch(P){console.error("Delete quotation error:",P),alert("Khng th xa bo gi")}finally{m(!1)}};return n?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(Mt,{className:"mx-auto h-8 w-8 text-blue-600 animate-spin"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]}):i?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(Cr,{className:"mx-auto h-8 w-8 text-red-500"}),s.jsx("p",{className:"mt-2 text-red-600",children:i}),s.jsx("button",{onClick:x,className:"mt-4 text-blue-600 hover:underline",children:"Th li"})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Bo gi (",r.length,")"]}),s.jsxs("select",{value:c,onChange:P=>u(P.target.value),className:"text-sm border rounded-lg px-3 py-1.5",children:[s.jsx("option",{value:"all",children:"Tt c"}),Tb.map(P=>s.jsx("option",{value:P.value,children:P.label},P.value))]})]}),s.jsxs("button",{onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:18}),"Thm bo gi"]})]}),r.length===0?s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(vr,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 font-medium text-gray-900",children:"Cha c bo gi"}),s.jsx("p",{className:"mt-1 text-gray-500",children:"Thm bo gi u tin t nh cung cp ny"}),s.jsxs("button",{onClick:v,className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{size:18}),"Thm bo gi"]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(P=>s.jsx(swe,{quotation:P,onEdit:()=>w(P),onDelete:()=>y(P)},P.id))}),l&&s.jsx(nwe,{supplierId:e,quotation:f,onClose:()=>{d(!1),p(null)},onSuccess:_}),h&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[s.jsx(Cr,{size:24}),s.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn xa"})]}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa bo gi ",s.jsx("strong",{children:h.title||h.quotation_number||"ny"}),"?",h.file_url&&s.jsx("span",{className:"block text-sm text-gray-500 mt-1",children:"File nh km cng s b xa."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>y(null),disabled:g,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:A,disabled:g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:g?"ang xa...":"Xa"})]})]})})]})},iwe=[{id:"info",label:"Thng tin chung",icon:s.jsx($r,{size:18})},{id:"contacts",label:"Ngi lin h",icon:s.jsx(_i,{size:18})},{id:"quotations",label:"Bo gi",icon:s.jsx(vr,{size:18})},{id:"orders",label:"n hng",icon:s.jsx(jl,{size:18})}],owe=({status:e})=>{const r={active:{label:"Hot ng",className:"bg-green-100 text-green-800",icon:s.jsx(hn,{size:16})},inactive:{label:"Tm ngng",className:"bg-yellow-100 text-yellow-800",icon:s.jsx(ua,{size:16})},blocked:{label:" kha",className:"bg-red-100 text-red-800",icon:s.jsx(nu,{size:16})}},{label:t,className:n,icon:a}=r[e]||r.inactive;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${n}`,children:[a,t]})},Za=({icon:e,label:r,value:t,isLink:n})=>t?s.jsxs("div",{className:"flex items-start gap-3 py-3 border-b border-gray-100 last:border-0",children:[s.jsx("span",{className:"text-gray-400 mt-0.5",children:e}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:r}),n?s.jsxs("a",{href:t.toString().startsWith("http")?t.toString():`https://${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[t,s.jsx(qb,{size:14})]}):s.jsx("p",{className:"text-gray-900 font-medium",children:t})]})]}):null,lwe=({rating:e})=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(r=>s.jsx(_o,{size:20,className:r<=e?"text-yellow-400 fill-yellow-400":"text-gray-300"},r))}),s.jsx("span",{className:"text-lg font-medium text-gray-700",children:e.toFixed(1)})]}),cwe=({supplier:e})=>{const r=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t);return s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx($r,{size:20,className:"text-blue-600"}),"Thng tin cng ty"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[s.jsx(Za,{icon:s.jsx(vr,{size:18}),label:"M NCC",value:e.code}),s.jsx(Za,{icon:s.jsx(vr,{size:18}),label:"M s thu",value:e.tax_code}),s.jsx(Za,{icon:s.jsx($r,{size:18}),label:"Loi",value:e.supplier_type==="company"?"Cng ty":"C nhn"}),s.jsx(Za,{icon:s.jsx(_o,{size:18}),label:"Nhm",value:e.supplier_group==="primary"?"NCC Chnh":e.supplier_group==="secondary"?"NCC Ph":"Dch v"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(_f,{size:20,className:"text-blue-600"}),"Thng tin lin h"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[s.jsx(Za,{icon:s.jsx(_f,{size:18}),label:"in thoi",value:e.phone}),s.jsx(Za,{icon:s.jsx(gg,{size:18}),label:"Email",value:e.email}),s.jsx(Za,{icon:s.jsx(zW,{size:18}),label:"Website",value:e.website,isLink:!0}),s.jsx(Za,{icon:s.jsx(dc,{size:18}),label:"a ch",value:[e.address,e.ward,e.district,e.province].filter(Boolean).join(", ")})]}),e.contact_name&&s.jsxs("div",{className:"mt-6 pt-6 border-t",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Ngi lin h chnh"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[s.jsx(Za,{icon:s.jsx(ls,{size:18}),label:"H tn",value:e.contact_name}),s.jsx(Za,{icon:s.jsx(vr,{size:18}),label:"Chc v",value:e.contact_position}),s.jsx(Za,{icon:s.jsx(_f,{size:18}),label:"in thoi",value:e.contact_phone}),s.jsx(Za,{icon:s.jsx(gg,{size:18}),label:"Email",value:e.contact_email})]})]})]}),e.bank_name&&s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(lc,{size:20,className:"text-blue-600"}),"Thng tin ngn hng"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[s.jsx(Za,{icon:s.jsx($r,{size:18}),label:"Ngn hng",value:e.bank_name}),s.jsx(Za,{icon:s.jsx(dc,{size:18}),label:"Chi nhnh",value:e.bank_branch}),s.jsx(Za,{icon:s.jsx(lc,{size:18}),label:"S ti khon",value:e.bank_account}),s.jsx(Za,{icon:s.jsx(ls,{size:18}),label:"Ch ti khon",value:e.bank_holder})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(vr,{size:20,className:"text-blue-600"}),"iu khon thanh ton"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6",children:[s.jsx(Za,{icon:s.jsx(vr,{size:18}),label:"Thi hn thanh ton",value:e.payment_terms===0?"Thanh ton ngay":`${e.payment_terms} ngy`}),s.jsx(Za,{icon:s.jsx(lc,{size:18}),label:"Hn mc cng n",value:e.credit_limit>0?r(e.credit_limit):"Khng gii hn"})]}),e.notes&&s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Ghi ch"}),s.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:e.notes})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"nh gi"}),s.jsx(lwe,{rating:e.rating||0})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Thng k"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[s.jsx("span",{className:"text-gray-600",children:"Tng n hng"}),s.jsx("span",{className:"font-semibold text-gray-900",children:e.total_orders||0})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[s.jsx("span",{className:"text-gray-600",children:"Tng gi tr"}),s.jsx("span",{className:"font-semibold text-gray-900",children:r(e.total_order_value||0)})]}),s.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[s.jsx("span",{className:"text-gray-600",children:" thanh ton"}),s.jsx("span",{className:"font-semibold text-green-600",children:r(e.total_paid||0)})]}),s.jsxs("div",{className:"flex justify-between items-center py-2",children:[s.jsx("span",{className:"text-gray-600",children:"Cng n"}),s.jsx("span",{className:`font-semibold ${e.total_debt>0?"text-red-600":"text-gray-900"}`,children:r(e.total_debt||0)})]})]})]}),e.last_order_date&&s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"n hng gn nht"}),s.jsx("p",{className:"text-gray-600",children:new Date(e.last_order_date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]})]})},uwe=({supplierId:e})=>s.jsxs("div",{className:"bg-white rounded-lg border p-8 text-center",children:[s.jsx(jl,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Lch s n hng"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Tnh nng ny s c pht trin trong Phase 3 - Qun l n hng"}),s.jsxs("p",{className:"text-sm text-gray-400",children:["Supplier ID: ",e]})]}),dwe=()=>{const e=ts(),{id:r}=_h(),t=jo(),[n,a]=R.useState(null),[i,o]=R.useState(!0),[c,u]=R.useState(null),[l,d]=R.useState("info"),[f,p]=R.useState(!1),[h,y]=R.useState(!1),[g,m]=R.useState(!1),x=t.state?.message,v=async()=>{if(!r){u("ID nh cung cp khng hp l"),o(!1);return}try{o(!0),u(null);const A=await _s.getById(r);A?a(A):u("Khng tm thy nh cung cp")}catch(A){console.error("Load supplier error:",A),u("Khng th ti thng tin nh cung cp")}finally{o(!1)}};R.useEffect(()=>{v()},[r]),R.useEffect(()=>{if(x){const A=setTimeout(()=>{e(t.pathname,{replace:!0,state:{}})},5e3);return()=>clearTimeout(A)}},[x]);const w=()=>{e(`/purchasing/suppliers/${r}/edit`)},_=async()=>{if(r)try{m(!0),await _s.delete(r),e("/purchasing/suppliers",{state:{message:" xa nh cung cp thnh cng!"}})}catch(A){console.error("Delete supplier error:",A),alert("Khng th xa nh cung cp")}finally{m(!1),y(!1)}};return i?s.jsx("div",{className:"p-6 flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mt,{className:"mx-auto h-10 w-10 text-blue-600 animate-spin"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti thng tin..."})]})}):c||!n?s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"max-w-md mx-auto text-center",children:[s.jsx("div",{className:"p-4 bg-red-50 rounded-full w-16 h-16 mx-auto flex items-center justify-center mb-4",children:s.jsx(Cr,{className:"text-red-500",size:32})}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Li"}),s.jsx("p",{className:"text-gray-600 mb-6",children:c||"Khng tm thy nh cung cp"}),s.jsx("button",{onClick:()=>e("/purchasing/suppliers"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Quay li danh sch"})]})}):s.jsxs("div",{className:"p-6",children:[x&&s.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700",children:[s.jsx(hn,{size:20}),x]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>e("/purchasing/suppliers"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4",children:[s.jsx(wo,{size:20}),"Quay li danh sch"]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-4 bg-blue-100 rounded-xl",children:s.jsx($r,{className:"text-blue-600",size:32})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n.name}),s.jsx(owe,{status:n.status})]}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-500",children:[s.jsx("span",{children:n.code}),n.tax_code&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["MST: ",n.tax_code]})]}),n.short_name&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:n.short_name})]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 px-4 py-2 border rounded-lg hover:bg-gray-50",children:[s.jsx(ad,{size:18}),"Chnh sa"]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>p(!f),className:"p-2 border rounded-lg hover:bg-gray-50",children:s.jsx(Bb,{size:20})}),f&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1)}),s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-20",children:s.jsxs("button",{onClick:()=>{y(!0),p(!1)},className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",children:[s.jsx(En,{size:16}),"Xa nh cung cp"]})})]})]})]})]})]}),s.jsx("div",{className:"border-b mb-6",children:s.jsx("div",{className:"flex gap-1",children:iwe.map(A=>s.jsxs("button",{onClick:()=>d(A.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${l===A.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[A.icon,A.label]},A.id))})}),l==="info"&&s.jsx(cwe,{supplier:n}),l==="contacts"&&s.jsx(J2e,{supplierId:n.id}),l==="quotations"&&s.jsx(awe,{supplierId:n.id}),l==="orders"&&s.jsx(uwe,{supplierId:n.id}),h&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[s.jsx(Cr,{size:24}),s.jsx("h3",{className:"text-lg font-semibold",children:"Xc nhn xa"})]}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa nh cung cp ",s.jsx("strong",{children:n.name}),"?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-gray-500",children:"Hnh ng ny khng th hon tc."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>y(!1),disabled:g,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:_,disabled:g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:g?"ang xa...":"Xa"})]})]})})]})},hwe=[{value:"Package",label:"Nguyn liu"},{value:"Fuel",label:"Nhin liu"},{value:"Wrench",label:"Ph tng"},{value:"HardHat",label:"Bo h"},{value:"FileText",label:"Vn phng phm"},{value:"Cpu",label:"Thit b in"},{value:"Droplet",label:"Ha cht"},{value:"Building",label:"Vt liu xy dng"},{value:"Box",label:"Bao b"},{value:"Layers",label:"Khc"}],fwe=[{value:"#3B82F6",label:"Xanh dng",bg:"bg-blue-500"},{value:"#10B981",label:"Xanh l",bg:"bg-emerald-500"},{value:"#F59E0B",label:"Cam",bg:"bg-amber-500"},{value:"#EF4444",label:"",bg:"bg-red-500"},{value:"#8B5CF6",label:"Tm",bg:"bg-violet-500"},{value:"#EC4899",label:"Hng",bg:"bg-pink-500"},{value:"#06B6D4",label:"Cyan",bg:"bg-cyan-500"},{value:"#6B7280",label:"Xm",bg:"bg-gray-500"}],bl={async getAll(e={}){const r=e.page||1,t=e.pageSize||10,{search:n,is_active:a}=e,i=(r-1)*t,o=i+t-1;let c=se.from("material_categories").select("*",{count:"exact"});a!=="all"&&a!==void 0&&(c=c.eq("is_active",a)),n&&(c=c.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:u,error:l,count:d}=await c.order("sort_order",{ascending:!0}).order("name",{ascending:!0}).range(i,o);if(l)throw l;return{data:u||[],total:d||0,page:r,pageSize:t,totalPages:Math.ceil((d||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("material_categories").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(r)throw r;return e||[]},async getById(e){const{data:r,error:t}=await se.from("material_categories").select("*").eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async create(e){const r=e.code.toUpperCase().trim();if(!/^[A-Z]{2,5}$/.test(r))throw new Error("M nhm phi t 2-5 k t ch in hoa");if(await this.checkCodeExists(r))throw new Error(`M nhm "${r}"  tn ti`);const{data:n,error:a}=await se.from("material_categories").insert({...e,code:r,sort_order:e.sort_order||0,is_active:e.is_active??!0}).select().single();if(a)throw a;return n},async update(e,r){if(r.code){const a=r.code.toUpperCase().trim();if(!/^[A-Z]{2,5}$/.test(a))throw new Error("M nhm phi t 2-5 k t ch in hoa");if(await this.checkCodeExists(a,e))throw new Error(`M nhm "${a}"  tn ti`);r.code=a}const{data:t,error:n}=await se.from("material_categories").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{count:r}=await se.from("material_types").select("id",{count:"exact",head:!0}).eq("category_id",e);if(r&&r>0)throw new Error(`Khng th xa nhm ny v c ${r} loi vt t ang s dng`);const{error:t}=await se.from("material_categories").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t},async hardDelete(e){const{error:r}=await se.from("material_categories").delete().eq("id",e);if(r)throw r},async toggleActive(e){const r=await this.getById(e);if(!r)throw new Error("Khng tm thy nhm vt t");return this.update(e,{is_active:!r.is_active})},async checkCodeExists(e,r){let t=se.from("material_categories").select("id",{count:"exact",head:!0}).eq("code",e.toUpperCase());r&&(t=t.neq("id",r));const{count:n}=await t;return(n||0)>0},async getMaterialCount(e){const{count:r,error:t}=await se.from("materials").select("id",{count:"exact",head:!0}).eq("category_id",e);if(t)throw t;return r||0},async getTypeCount(e){const{count:r,error:t}=await se.from("material_types").select("id",{count:"exact",head:!0}).eq("category_id",e);if(t)throw t;return r||0},async updateSortOrder(e){for(const r of e){const{error:t}=await se.from("material_categories").update({sort_order:r.sort_order}).eq("id",r.id);if(t)throw t}},async getAllWithCounts(){const{data:e,error:r}=await se.from("material_categories").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(r)throw r;return await Promise.all((e||[]).map(async n=>{const[a,i]=await Promise.all([this.getTypeCount(n.id),this.getMaterialCount(n.id)]);return{...n,type_count:a,material_count:i}}))}},k5={Package:Cn,Fuel:_O,Wrench:TO,HardHat:jO,FileText:vr,Cpu:xO,Droplet:vO,Building:ph,Box:gO,Layers:jh};function pwe({category:e,onClose:r,onSuccess:t}){const n=!!e,[a,i]=R.useState({code:"",name:"",description:"",icon:"Package",color:"#3B82F6",sort_order:0,is_active:!0}),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState(null);R.useEffect(()=>{e&&i({code:e.code,name:e.name,description:e.description||"",icon:e.icon||"Package",color:e.color||"#3B82F6",sort_order:e.sort_order,is_active:e.is_active})},[e]);const p=g=>g?/^[A-Za-z]{2,5}$/.test(g)?(f(null),!0):(f("M nhm phi t 2-5 k t ch ci"),!1):(f("Vui lng nhp m nhm"),!1);R.useEffect(()=>{const m=setTimeout(async()=>{if(a.code&&a.code.length>=2)try{await bl.checkCodeExists(a.code,e?.id)&&f(`M "${a.code.toUpperCase()}"  tn ti`)}catch(x){console.error("Error checking code:",x)}},500);return()=>clearTimeout(m)},[a.code,e?.id]);const h=g=>{const{name:m,value:x}=g.target;if(m==="code"){const v=x.toUpperCase().replace(/[^A-Z]/g,"").slice(0,5);i(w=>({...w,code:v})),p(v)}else i(m==="sort_order"?v=>({...v,sort_order:parseInt(x)||0}):v=>({...v,[m]:x}))},y=async g=>{if(g.preventDefault(),!!p(a.code)){if(!a.name.trim()){l("Vui lng nhp tn nhm");return}c(!0),l(null);try{n&&e?await bl.update(e.id,a):await bl.create(a),t()}catch(m){l(m instanceof Error?m.message:"C li xy ra")}finally{c(!1)}}};return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:r}),s.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n?"Chnh sa nhm vt t":"Thm nhm vt t mi"}),s.jsx("button",{onClick:r,className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:y,children:[s.jsxs("div",{className:"px-6 py-4 space-y-4",children:[u&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:u}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M nhm ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"code",value:a.code,onChange:h,placeholder:"VD: NL",maxLength:5,disabled:n,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 uppercase
                      ${d?"border-red-500":"border-gray-300"}
                      ${n?"bg-gray-100 cursor-not-allowed":""}`}),d&&s.jsx("p",{className:"mt-1 text-xs text-red-500",children:d}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"2-5 k t"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn nhm ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:a.name,onChange:h,placeholder:"VD: Nguyn liu",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:a.description,onChange:h,rows:2,placeholder:"M t ngn v nhm vt t...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biu tng"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:hwe.map(g=>{const m=k5[g.value],x=a.icon===g.value;return s.jsxs("button",{type:"button",onClick:()=>i(v=>({...v,icon:g.value})),className:`relative p-3 rounded-lg border-2 transition-all
                          ${x?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,title:g.label,children:[m&&s.jsx(m,{className:"w-5 h-5 text-gray-700"}),x&&s.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:s.jsx($i,{className:"w-2.5 h-2.5 text-white"})})]},g.value)})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mu sc"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:fwe.map(g=>{const m=a.color===g.value;return s.jsx("button",{type:"button",onClick:()=>i(x=>({...x,color:g.value})),className:`relative w-10 h-10 rounded-lg border-2 transition-all
                          ${m?"border-gray-900 scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:g.value},title:g.label,children:m&&s.jsx($i,{className:"w-5 h-5 text-white absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})},g.value)})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Xem trc"}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:a.color},children:a.icon&&k5[a.icon]&&(()=>{const g=k5[a.icon];return s.jsx(g,{className:"w-5 h-5 text-white"})})()}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:a.name||"Tn nhm"}),s.jsxs("div",{className:"text-sm text-gray-500",children:["M: ",a.code||"??"]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),s.jsx("input",{type:"number",name:"sort_order",value:a.sort_order,onChange:h,min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"S nh hin th trc"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:a.is_active,onChange:g=>i(m=>({...m,is_active:g.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"ang hot ng"})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:r,disabled:o,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{type:"submit",disabled:o||!!d,className:"flex items-center gap-2 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),n?"Cp nht":"To mi"]})})]})]})]})]})})}const mwe={Package:Cn,Fuel:_O,Wrench:TO,HardHat:jO,FileText:vr,Cpu:xO,Droplet:vO,Building:ph,Box:gO,Layers:jh};function gwe(){const[e,r]=R.useState([]),[t,n]=R.useState(!0),[a,i]=R.useState(null),[o,c]=R.useState(null),[u,l]=R.useState(1),[d]=R.useState(10),[f,p]=R.useState(0),[h,y]=R.useState(0),[g,m]=R.useState(""),[x,v]=R.useState("all"),[w,_]=R.useState(!1),[A,P]=R.useState(null),[B,T]=R.useState(null),[I,U]=R.useState({}),H=R.useCallback(async()=>{try{n(!0),i(null);const S=await bl.getAll({page:u,pageSize:d,search:g.trim()||void 0,is_active:x});r(S.data),p(S.total),y(S.totalPages);const C={};for(const D of S.data){const[q,M]=await Promise.all([bl.getTypeCount(D.id),bl.getMaterialCount(D.id)]);C[D.id]={types:q,materials:M}}U(C)}catch(S){console.error("Error fetching categories:",S),i(S instanceof Error?S.message:"Khng th ti d liu")}finally{n(!1)}},[u,d,g,x]);R.useEffect(()=>{H()},[H]),R.useEffect(()=>{l(1)},[g,x]),R.useEffect(()=>{if(o){const S=setTimeout(()=>c(null),3e3);return()=>clearTimeout(S)}},[o]),R.useEffect(()=>{if(a){const S=setTimeout(()=>i(null),5e3);return()=>clearTimeout(S)}},[a]);const z=()=>{P(null),_(!0)},O=S=>{P(S),_(!0)},L=async S=>{try{await bl.delete(S.id),c(` xa nhm "${S.name}"`),T(null),H()}catch(C){i(C instanceof Error?C.message:"Khng th xa nhm")}},E=async S=>{try{await bl.toggleActive(S.id),c(` ${S.is_active?"v hiu ha":"kch hot"} nhm "${S.name}"`),H()}catch(C){i(C instanceof Error?C.message:"Khng th cp nht trng thi")}},k=()=>{_(!1),P(null),c(A?"Cp nht thnh cng!":"To mi thnh cng!"),H()},N=(S,C)=>{const D=S?mwe[S]:Cn;return s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:C||"#6B7280"},children:D&&s.jsx(D,{className:"w-5 h-5 text-white"})})};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nhm vt t"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Qun l danh mc nhm vt t (cp 1)"})]}),s.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm nhm"]})]}),a&&s.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:a})]}),o&&s.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700",children:[s.jsx(hn,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:o})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex-1 min-w-[200px]",children:s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn...",value:g,onChange:S=>m(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),s.jsx("div",{className:"w-48",children:s.jsxs("select",{value:x==="all"?"all":x?"true":"false",onChange:S=>{S.target.value==="all"?v("all"):v(S.target.value==="true")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c trng thi"}),s.jsx("option",{value:"true",children:"ang hot ng"}),s.jsx("option",{value:"false",children:" v hiu"})]})}),s.jsx("button",{onClick:H,disabled:t,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:s.jsx(Vr,{className:`w-4 h-4 ${t?"animate-spin":""}`})})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nhm vt t"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S loi"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S vt t"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Th t"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:t?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:[s.jsx(Vr,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"ang ti..."]})}):e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:g||x!=="all"?"Khng tm thy nhm vt t ph hp":"Cha c nhm vt t no"})}):e.map(S=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[N(S.icon,S.color),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:S.name}),S.description&&s.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:S.description})]})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:S.code})}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:I[S.id]?.types||0}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:I[S.id]?.materials||0}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:S.sort_order}),s.jsx("td",{className:"px-4 py-3 text-center",children:S.is_active?s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Hot ng"}):s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"V hiu"})}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>E(S),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:S.is_active?"V hiu ha":"Kch hot",children:S.is_active?s.jsx(EO,{className:"w-5 h-5 text-green-600"}):s.jsx(AO,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>O(S),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Chnh sa",children:s.jsx(Z4,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>T(S),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})})]},S.id))})]})}),h>1&&s.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Hin th ",(u-1)*d+1," - ",Math.min(u*d,f)," / ",f," nhm"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>l(S=>Math.max(1,S-1)),disabled:u===1,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"px-3 py-2 text-sm",children:["Trang ",u," / ",h]}),s.jsx("button",{onClick:()=>l(S=>Math.min(h,S+1)),disabled:u===h,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),w&&s.jsx(pwe,{category:A,onClose:()=>{_(!1),P(null)},onSuccess:k}),B&&s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>T(null)}),s.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa nhm ",s.jsxs("strong",{children:['"',B.name,'"']}),"?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-gray-500",children:"Nhm s b v hiu ha v khng th s dng  to vt t mi."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>T(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Hy"}),s.jsx("button",{onClick:()=>L(B),className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Xa"})]})]})]})})]})}const Kc={async getAll(e={}){const r=e.page||1,t=e.pageSize||10,{search:n,category_id:a,is_active:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("material_types").select(`
        *,
        material_categories!inner (
          name,
          code,
          color
        )
      `,{count:"exact"});a&&(u=u.eq("category_id",a)),i!=="all"&&i!==void 0&&(u=u.eq("is_active",i)),n&&(u=u.or(`name.ilike.%${n}%,code.ilike.%${n}%`));const{data:l,error:d,count:f}=await u.order("sort_order",{ascending:!0}).order("name",{ascending:!0}).range(o,c);if(d)throw d;return{data:(l||[]).map(h=>({...h,category_name:h.material_categories?.name,category_code:h.material_categories?.code,category_color:h.material_categories?.color,material_categories:void 0})),total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getAllActive(e){let r=se.from("material_types").select(`
        *,
        material_categories!inner (
          name,
          code,
          color
        )
      `).eq("is_active",!0);e&&(r=r.eq("category_id",e));const{data:t,error:n}=await r.order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(n)throw n;return(t||[]).map(a=>({...a,category_name:a.material_categories?.name,category_code:a.material_categories?.code,category_color:a.material_categories?.color,material_categories:void 0}))},async getById(e){const{data:r,error:t}=await se.from("material_types").select(`
        *,
        material_categories!inner (
          name,
          code,
          color
        )
      `).eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return{...r,category_name:r.material_categories?.name,category_code:r.material_categories?.code,category_color:r.material_categories?.color,material_categories:void 0}},async getByCategory(e){const{data:r,error:t}=await se.from("material_types").select("*").eq("category_id",e).eq("is_active",!0).order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(t)throw t;return r||[]},async create(e){const r=e.code.toUpperCase().trim();if(!/^[A-Z0-9]{2,10}$/.test(r))throw new Error("M loi phi t 2-10 k t ch hoc s");if(await this.checkCodeExists(r,e.category_id))throw new Error(`M loi "${r}"  tn ti trong nhm ny`);const{data:n,error:a}=await se.from("material_types").insert({...e,code:r,sort_order:e.sort_order||0,is_active:e.is_active??!0}).select().single();if(a)throw a;return n},async update(e,r){if(r.code){const a=r.code.toUpperCase().trim();if(!/^[A-Z0-9]{2,10}$/.test(a))throw new Error("M loi phi t 2-10 k t ch hoc s");const i=await this.getById(e);if(!i)throw new Error("Khng tm thy loi vt t");const o=r.category_id||i.category_id;if(await this.checkCodeExists(a,o,e))throw new Error(`M loi "${a}"  tn ti trong nhm ny`);r.code=a}const{data:t,error:n}=await se.from("material_types").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{count:r}=await se.from("materials").select("id",{count:"exact",head:!0}).eq("type_id",e);if(r&&r>0)throw new Error(`Khng th xa loi ny v c ${r} vt t ang s dng`);const{error:t}=await se.from("material_types").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t},async hardDelete(e){const{error:r}=await se.from("material_types").delete().eq("id",e);if(r)throw r},async toggleActive(e){const r=await this.getById(e);if(!r)throw new Error("Khng tm thy loi vt t");return this.update(e,{is_active:!r.is_active})},async checkCodeExists(e,r,t){let n=se.from("material_types").select("id",{count:"exact",head:!0}).eq("code",e.toUpperCase()).eq("category_id",r);t&&(n=n.neq("id",t));const{count:a}=await n;return(a||0)>0},async getMaterialCount(e){const{count:r,error:t}=await se.from("materials").select("id",{count:"exact",head:!0}).eq("type_id",e);if(t)throw t;return r||0},async previewMaterialCode(e,r){const{data:t}=await se.from("material_categories").select("code").eq("id",e).single(),{data:n}=await se.from("material_types").select("code").eq("id",r).single();if(!t||!n)return"???-???001";const{count:a}=await se.from("materials").select("id",{count:"exact",head:!0}).eq("type_id",r),i=((a||0)+1).toString().padStart(3,"0");return`${t.code}-${n.code}${i}`}};function ywe({type:e,categories:r,defaultCategoryId:t,onClose:n,onSuccess:a}){const i=!!e,[o,c]=R.useState({category_id:"",code:"",name:"",description:"",sort_order:0,is_active:!0}),[u,l]=R.useState(!1),[d,f]=R.useState(null),[p,h]=R.useState(null),[y,g]=R.useState(""),m=r.find(_=>_.id===o.category_id);R.useEffect(()=>{e?c({category_id:e.category_id,code:e.code,name:e.name,description:e.description||"",sort_order:e.sort_order,is_active:e.is_active}):t&&c(_=>({..._,category_id:t}))},[e,t]),R.useEffect(()=>{m&&o.code?g(`${m.code}-${o.code}XXX`):g(m?`${m.code}-???XXX`:"???-???XXX")},[m,o.code]);const x=_=>_?/^[A-Za-z0-9]{2,10}$/.test(_)?(h(null),!0):(h("M loi phi t 2-10 k t ch hoc s"),!1):(h("Vui lng nhp m loi"),!1);R.useEffect(()=>{const A=setTimeout(async()=>{if(o.code&&o.code.length>=2&&o.category_id)try{await Kc.checkCodeExists(o.code,o.category_id,e?.id)&&h(`M "${o.code.toUpperCase()}"  tn ti trong nhm ny`)}catch(P){console.error("Error checking code:",P)}},500);return()=>clearTimeout(A)},[o.code,o.category_id,e?.id]);const v=_=>{const{name:A,value:P}=_.target;if(A==="code"){const B=P.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,10);c(T=>({...T,code:B})),x(B)}else c(A==="sort_order"?B=>({...B,sort_order:parseInt(P)||0}):B=>({...B,[A]:P}))},w=async _=>{if(_.preventDefault(),!o.category_id){f("Vui lng chn nhm vt t");return}if(x(o.code)){if(!o.name.trim()){f("Vui lng nhp tn loi");return}l(!0),f(null);try{i&&e?await Kc.update(e.id,o):await Kc.create(o),a()}catch(A){f(A instanceof Error?A.message:"C li xy ra")}finally{l(!1)}}};return s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:n}),s.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Chnh sa loi vt t":"Thm loi vt t mi"}),s.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 rounded",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:w,children:[s.jsxs("div",{className:"px-6 py-4 space-y-4",children:[d&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhm vt t ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"category_id",value:o.category_id,onChange:v,disabled:i,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500
                    ${i?"bg-gray-100 cursor-not-allowed":""}`,children:[s.jsx("option",{value:"",children:"-- Chn nhm --"}),r.map(_=>s.jsxs("option",{value:_.id,children:[_.code," - ",_.name]},_.id))]}),i&&s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Khng th thay i nhm khi chnh sa"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M loi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"code",value:o.code,onChange:v,placeholder:"VD: CS",maxLength:10,disabled:i,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 uppercase
                      ${p?"border-red-500":"border-gray-300"}
                      ${i?"bg-gray-100 cursor-not-allowed":""}`}),p&&s.jsx("p",{className:"mt-1 text-xs text-red-500",children:p}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"2-10 k t"})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn loi ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:o.name,onChange:v,placeholder:"VD: Cao su t nhin",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:o.description,onChange:v,rows:2,placeholder:"M t ngn v loi vt t...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(ja,{className:"w-4 h-4 inline mr-1"}),"Xem trc m vt t"]}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:m?.color||"#6B7280"},children:s.jsx(Kf,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-mono text-lg font-bold text-gray-900",children:y}),s.jsx("div",{className:"text-sm text-gray-500",children:m?`${m.name}  ${o.name||"Tn loi"}`:"Chn nhm  xem preview"})]})]}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"XXX = s th t vt t (t ng tng)"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),s.jsx("input",{type:"number",name:"sort_order",value:o.sort_order,onChange:v,min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"S nh hin th trc"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:o.is_active,onChange:_=>c(A=>({...A,is_active:_.target.checked})),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"ang hot ng"})]})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:n,disabled:u,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Hy"}),s.jsx("button",{type:"submit",disabled:u||!!p||!o.category_id,className:"flex items-center gap-2 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),i?"Cp nht":"To mi"]})})]})]})]})]})})}function xwe(){const[e,r]=R.useState([]),[t,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState(null),[u,l]=R.useState(null),[d,f]=R.useState(1),[p]=R.useState(10),[h,y]=R.useState(0),[g,m]=R.useState(0),[x,v]=R.useState(""),[w,_]=R.useState(""),[A,P]=R.useState("all"),[B,T]=R.useState(!1),[I,U]=R.useState(null),[H,z]=R.useState(null),[O,L]=R.useState({}),E=R.useCallback(async()=>{try{const M=await bl.getAllActive();n(M)}catch(M){console.error("Error fetching categories:",M)}},[]),k=R.useCallback(async()=>{try{i(!0),c(null);const M=await Kc.getAll({page:d,pageSize:p,search:x.trim()||void 0,category_id:w||void 0,is_active:A});r(M.data),y(M.total),m(M.totalPages);const G={};for(const X of M.data)G[X.id]=await Kc.getMaterialCount(X.id);L(G)}catch(M){console.error("Error fetching types:",M),c(M instanceof Error?M.message:"Khng th ti d liu")}finally{i(!1)}},[d,p,x,w,A]);R.useEffect(()=>{E()},[E]),R.useEffect(()=>{k()},[k]),R.useEffect(()=>{f(1)},[x,w,A]),R.useEffect(()=>{if(u){const M=setTimeout(()=>l(null),3e3);return()=>clearTimeout(M)}},[u]),R.useEffect(()=>{if(o){const M=setTimeout(()=>c(null),5e3);return()=>clearTimeout(M)}},[o]);const N=()=>{U(null),T(!0)},S=M=>{U(M),T(!0)},C=async M=>{try{await Kc.delete(M.id),l(` xa loi "${M.name}"`),z(null),k()}catch(G){c(G instanceof Error?G.message:"Khng th xa loi")}},D=async M=>{try{await Kc.toggleActive(M.id),l(` ${M.is_active?"v hiu ha":"kch hot"} loi "${M.name}"`),k()}catch(G){c(G instanceof Error?G.message:"Khng th cp nht trng thi")}},q=()=>{T(!1),U(null),l(I?"Cp nht thnh cng!":"To mi thnh cng!"),k()};return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Loi vt t"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Qun l danh mc loi vt t (cp 2, thuc nhm)"})]}),s.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm loi"]})]}),o&&s.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:o})]}),u&&s.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700",children:[s.jsx(hn,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:u})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex-1 min-w-[200px]",children:s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn...",value:x,onChange:M=>v(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),s.jsx("div",{className:"w-56",children:s.jsxs("div",{className:"relative",children:[s.jsx(Al,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsxs("select",{value:w,onChange:M=>_(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[s.jsx("option",{value:"",children:"Tt c nhm"}),t.map(M=>s.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},M.id))]})]})}),s.jsx("div",{className:"w-44",children:s.jsxs("select",{value:A==="all"?"all":A?"true":"false",onChange:M=>{M.target.value==="all"?P("all"):P(M.target.value==="true")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c trng thi"}),s.jsx("option",{value:"true",children:"ang hot ng"}),s.jsx("option",{value:"false",children:" v hiu"})]})}),s.jsx("button",{onClick:k,disabled:a,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:s.jsx(Vr,{className:`w-4 h-4 ${a?"animate-spin":""}`})})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loi vt t"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nhm"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S vt t"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Th t"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:a?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:[s.jsx(Vr,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"ang ti..."]})}):e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:x||w||A!=="all"?"Khng tm thy loi vt t ph hp":"Cha c loi vt t no"})}):e.map(M=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:M.category_color||"#6B7280"},children:s.jsx(Kf,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:M.name}),M.description&&s.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:M.description})]})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:M.code})}),s.jsxs("td",{className:"px-4 py-3",children:[s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white",style:{backgroundColor:M.category_color||"#6B7280"},children:M.category_code}),s.jsx("span",{className:"ml-2 text-sm text-gray-600",children:M.category_name})]}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:O[M.id]||0}),s.jsx("td",{className:"px-4 py-3 text-center text-sm text-gray-600",children:M.sort_order}),s.jsx("td",{className:"px-4 py-3 text-center",children:M.is_active?s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Hot ng"}):s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"V hiu"})}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>D(M),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:M.is_active?"V hiu ha":"Kch hot",children:M.is_active?s.jsx(EO,{className:"w-5 h-5 text-green-600"}):s.jsx(AO,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>S(M),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded",title:"Chnh sa",children:s.jsx(Z4,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>z(M),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})})]},M.id))})]})}),g>1&&s.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-500",children:["Hin th ",(d-1)*p+1," - ",Math.min(d*p,h)," / ",h," loi"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>f(M=>Math.max(1,M-1)),disabled:d===1,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"px-3 py-2 text-sm",children:["Trang ",d," / ",g]}),s.jsx("button",{onClick:()=>f(M=>Math.min(g,M+1)),disabled:d===g,className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),B&&s.jsx(ywe,{type:I,categories:t,defaultCategoryId:w,onClose:()=>{T(!1),U(null)},onSuccess:q}),H&&s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>z(null)}),s.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa loi ",s.jsxs("strong",{children:['"',H.name,'"']}),"?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-gray-500",children:"Loi s b v hiu ha v khng th s dng  to vt t mi."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>z(null),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Hy"}),s.jsx("button",{onClick:()=>C(H),className:"px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700",children:"Xa"})]})]})]})})]})}const qg=[{value:"piece",label:"n v m",color:"bg-blue-100 text-blue-800"},{value:"weight",label:"Khi lng",color:"bg-green-100 text-green-800"},{value:"volume",label:"Th tch",color:"bg-purple-100 text-purple-800"},{value:"length",label:"Chiu di",color:"bg-orange-100 text-orange-800"},{value:"area",label:"Din tch",color:"bg-yellow-100 text-yellow-800"}],vwe=e=>{const r=qg.find(t=>t.value===e);return r?r.label:e},bwe=e=>{const r=qg.find(t=>t.value===e);return r?r.color:"bg-gray-100 text-gray-800"},Zu={async getAll(e){const{page:r=1,pageSize:t=10,search:n,unitType:a,isActive:i}=e,o=(r-1)*t,c=o+t-1;let u=se.from("units").select("*",{count:"exact"});a&&(u=u.eq("unit_type",a)),i!==void 0&&(u=u.eq("is_active",i)),n&&(u=u.or(`code.ilike.%${n}%,name.ilike.%${n}%,symbol.ilike.%${n}%`));const{data:l,error:d,count:f}=await u.order("sort_order",{ascending:!0}).order("name",{ascending:!0}).range(o,c);if(d)throw d;return{data:l||[],total:f||0,page:r,pageSize:t,totalPages:Math.ceil((f||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("units").select("*").eq("is_active",!0).order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(r)throw r;return e||[]},async getByType(e){const{data:r,error:t}=await se.from("units").select("*").eq("unit_type",e).eq("is_active",!0).order("sort_order",{ascending:!0});if(t)throw t;return r||[]},async getById(e){const{data:r,error:t}=await se.from("units").select("*").eq("id",e).single();if(t)throw t;return r},async getByCode(e){const{data:r,error:t}=await se.from("units").select("*").eq("code",e).single();if(t&&t.code!=="PGRST116")throw t;return r},async checkCodeExists(e,r){let t=se.from("units").select("id").eq("code",e);r&&(t=t.neq("id",r));const{data:n,error:a}=await t.single();if(a&&a.code==="PGRST116")return!1;if(a)throw a;return!!n},async create(e){if(await this.checkCodeExists(e.code))throw new Error(`M n v "${e.code}"  tn ti`);const{data:t,error:n}=await se.from("units").insert({...e,code:e.code.toLowerCase().trim(),is_active:e.is_active??!0}).select().single();if(n)throw n;return t},async update(e,r){if(r.code&&await this.checkCodeExists(r.code,e))throw new Error(`M n v "${r.code}"  tn ti`);const{data:t,error:n}=await se.from("units").update({...r,code:r.code?r.code.toLowerCase().trim():void 0,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async deactivate(e){const{error:r}=await se.from("units").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async activate(e){const{error:r}=await se.from("units").update({is_active:!0,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async delete(e){const{error:r}=await se.from("units").delete().eq("id",e);if(r)throw r.code==="23503"?new Error("Khng th xa n v ang c s dng bi vt t"):r},async updateSortOrder(e){const r=e.map(n=>se.from("units").update({sort_order:n.sort_order}).eq("id",n.id)),t=await Promise.all(r);for(const n of t)if(n.error)throw n.error}},wwe=({unit:e,onClose:r,onSuccess:t})=>{const n=!!e,[a,i]=R.useState({code:"",name:"",symbol:"",unit_type:"piece",sort_order:0,is_active:!0}),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState(null);R.useEffect(()=>{e&&i({code:e.code,name:e.name,symbol:e.symbol||"",unit_type:e.unit_type,sort_order:e.sort_order,is_active:e.is_active})},[e]),R.useEffect(()=>{if(!a.code||a.code.length<1){f(null);return}const y=setTimeout(async()=>{try{const g=await Zu.checkCodeExists(a.code,e?.id);f(g?`M "${a.code}"  tn ti`:null)}catch(g){console.error("Error checking code:",g)}},300);return()=>clearTimeout(y)},[a.code,e?.id]);const p=y=>{const{name:g,value:m,type:x}=y.target;i(v=>({...v,[g]:x==="checkbox"?y.target.checked:x==="number"?parseInt(m)||0:m}))},h=async y=>{if(y.preventDefault(),!a.code.trim()){l("Vui lng nhp m n v");return}if(!a.name.trim()){l("Vui lng nhp tn n v");return}if(d){l(d);return}try{c(!0),l(null),n&&e?await Zu.update(e.id,a):await Zu.create(a),t()}catch(g){l(g.message||"C li xy ra")}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Cn,{className:"w-5 h-5 text-blue-600"})}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n?"Sa n v tnh":"Thm n v tnh"})]}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Br,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[u&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{className:"text-sm",children:u})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["M n v ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"code",value:a.code,onChange:p,placeholder:"VD: kg, tan, m3...",className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${d?"border-red-300 bg-red-50":""}`,disabled:o}),d&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:d}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"M s c chuyn sang ch thng"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn n v ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:a.name,onChange:p,placeholder:"VD: Kilogram, Tn, Mt khi...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"K hiu"}),s.jsx("input",{type:"text",name:"symbol",value:a.symbol,onChange:p,placeholder:"VD: kg, T, m, L...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"K hiu hin th trn bo co (c th dng k t c bit nh , )"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi n v"}),s.jsx("select",{name:"unit_type",value:a.unit_type,onChange:p,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o,children:qg.map(y=>s.jsx("option",{value:y.value,children:y.label},y.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t sp xp"}),s.jsx("input",{type:"number",name:"sort_order",value:a.sort_order,onChange:p,min:0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"S nh hn s hin th trc trong dropdown"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"checkbox",name:"is_active",id:"is_active",checked:a.is_active,onChange:p,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:o}),s.jsx("label",{htmlFor:"is_active",className:"text-sm text-gray-700",children:"ang hot ng"})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",disabled:o,children:"Hy"}),s.jsx("button",{type:"submit",disabled:o||!!d,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),n?"Cp nht":"Thm mi"]})})]})]})]})})},dP={piece:Cn,weight:J4,volume:NW,length:MK,area:YK},_we=()=>{const[e,r]=R.useState([]),[t,n]=R.useState(!0),[a,i]=R.useState(""),[o,c]=R.useState(""),[u,l]=R.useState("all"),[d,f]=R.useState(1),[p,h]=R.useState(1),[y,g]=R.useState(0),m=15,[x,v]=R.useState(!1),[w,_]=R.useState(null),[A,P]=R.useState(null),B=async()=>{try{n(!0);const N=await Zu.getAll({page:d,pageSize:m,search:a||void 0,unitType:o||void 0,isActive:u==="all"?void 0:u==="active"});r(N.data),h(N.totalPages),g(N.total)}catch(N){console.error("Error fetching units:",N)}finally{n(!1)}};R.useEffect(()=>{B()},[d,a,o,u]);const T=N=>{i(N.target.value),f(1)},I=N=>{c(N),f(1)},U=N=>{l(N),f(1)},H=()=>{_(null),v(!0)},z=N=>{_(N),v(!0)},O=()=>{v(!1),_(null),B()},L=async N=>{try{N.is_active?await Zu.deactivate(N.id):await Zu.activate(N.id),B()}catch(S){alert(S.message||"C li xy ra")}},E=async N=>{try{await Zu.delete(N.id),P(null),B()}catch(S){alert(S.message||"C li xy ra khi xa")}},k=N=>dP[N]||Cn;return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"n v tnh"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Qun l n v tnh cho vt t"})]}),s.jsxs("button",{onClick:H,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-5 h-5"}),"Thm n v"]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex-1 min-w-[200px]",children:s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo m, tn, k hiu...",value:a,onChange:T,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),s.jsx("div",{className:"w-48",children:s.jsxs("select",{value:o,onChange:N=>I(N.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Tt c loi"}),qg.map(N=>s.jsx("option",{value:N.value,children:N.label},N.value))]})}),s.jsx("div",{className:"w-40",children:s.jsxs("select",{value:u,onChange:N=>U(N.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c"}),s.jsx("option",{value:"active",children:"ang hot ng"}),s.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})}),s.jsx("button",{onClick:B,className:"p-2 border rounded-lg hover:bg-gray-50 transition-colors",title:"Lm mi",children:s.jsx(Vr,{className:"w-5 h-5 text-gray-600"})})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[s.jsx("span",{className:"text-sm text-gray-500 py-1",children:"Lc nhanh:"}),qg.map(N=>{const S=dP[N.value]||Cn;return s.jsxs("button",{onClick:()=>I(o===N.value?"":N.value),className:`flex items-center gap-1.5 px-3 py-1 text-sm rounded-full transition-colors ${o===N.value?N.color:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(S,{className:"w-4 h-4"}),N.label]},N.value)})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Tn n v"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"K hiu"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Loi"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Th t"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y",children:t?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(Vr,{className:"w-8 h-8 animate-spin text-blue-500"})}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]})}):e.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[s.jsx(Cn,{className:"w-12 h-12 text-gray-300 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"Khng c n v no"}),s.jsx("button",{onClick:H,className:"mt-3 text-blue-600 hover:underline",children:"+ Thm n v mi"})]})}):e.map(N=>{const S=k(N.unit_type);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"font-mono text-sm font-medium text-gray-900",children:N.code})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"text-gray-900",children:N.name})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"font-mono text-sm text-gray-600",children:N.symbol||"-"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full ${bwe(N.unit_type)}`,children:[s.jsx(S,{className:"w-3.5 h-3.5"}),vwe(N.unit_type)]})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("span",{className:"text-gray-600",children:N.sort_order})}),s.jsx("td",{className:"px-4 py-3 text-center",children:N.is_active?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:[s.jsx(im,{className:"w-3 h-3"}),"Hot ng"]}):s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:[s.jsx(xg,{className:"w-3 h-3"}),"Ngng"]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex justify-center gap-1",children:[s.jsx("button",{onClick:()=>z(N),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Sa",children:s.jsx(sd,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>L(N),className:`p-2 rounded-lg transition-colors ${N.is_active?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50"}`,title:N.is_active?"Ngng hot ng":"Kch hot",children:N.is_active?s.jsx(xg,{className:"w-4 h-4"}):s.jsx(im,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>P(N),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})})]},N.id)})})]})}),p>1&&s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Hin th ",e.length," / ",y," n v"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>f(N=>Math.max(1,N-1)),disabled:d===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Trang ",d," / ",p]}),s.jsx("button",{onClick:()=>f(N=>Math.min(p,N+1)),disabled:d===p,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),x&&s.jsx(wwe,{unit:w,onClose:()=>{v(!1),_(null)},onSuccess:O}),A&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa n v ",s.jsxs("strong",{children:['"',A.name,'"']})," (",A.code,")?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-red-600 mt-2 block",children:"Lu : Khng th xa n v ang c s dng bi vt t."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Hy"}),s.jsx("button",{onClick:()=>E(A),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Xa"})]})]})})]})},A4=async(e,r)=>{const{data:t,error:n}=await se.from("material_categories").select("code").eq("id",e).single();if(n||!t)throw new Error("Khng tm thy nhm vt t");let a=t.code;if(r){const{data:u,error:l}=await se.from("material_types").select("code").eq("id",r).single();!l&&u&&(a=`${t.code}-${u.code}`)}const{count:i,error:o}=await se.from("materials").select("*",{count:"exact",head:!0}).ilike("code",`${a}-%`);if(o)throw new Error("Khng th to m vt t");const c=((i||0)+1).toString().padStart(4,"0");return`${a}-${c}`},b6=async(e,r)=>A4(e,r),xo={async getAll(e){const{page:r=1,pageSize:t=10,search:n,categoryId:a,typeId:i,supplierId:o,status:c,lowStock:u}=e,l=(r-1)*t,d=l+t-1;let f=se.from("materials").select(`
        *,
        category:material_categories(id, code, name, icon, color),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol),
        preferred_supplier:suppliers!materials_preferred_supplier_id_fkey(id, code, name),
        created_by_employee:employees!materials_created_by_fkey(id, full_name)
      `,{count:"exact"}).is("deleted_at",null);a&&(f=f.eq("category_id",a)),i&&(f=f.eq("type_id",i)),o&&(f=f.eq("preferred_supplier_id",o)),c&&c!=="all"&&(f=f.eq("status",c)),n&&(f=f.or(`code.ilike.%${n}%,name.ilike.%${n}%`));const{data:p,error:h,count:y}=await f.order("code",{ascending:!0}).range(l,d);if(h)throw h;let g=p||[];return u&&(g=g.filter(m=>m.current_stock<m.min_stock)),{data:g,total:y||0,page:r,pageSize:t,totalPages:Math.ceil((y||0)/t)}},async getAllActive(){const{data:e,error:r}=await se.from("materials").select(`
        *,
        category:material_categories(id, code, name),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol)
      `).eq("status","active").is("deleted_at",null).order("name",{ascending:!0});if(r)throw r;return e||[]},async getByCategory(e){const{data:r,error:t}=await se.from("materials").select(`
        *,
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol)
      `).eq("category_id",e).eq("status","active").is("deleted_at",null).order("name",{ascending:!0});if(t)throw t;return r||[]},async getByType(e){const{data:r,error:t}=await se.from("materials").select(`
        *,
        category:material_categories(id, code, name),
        unit:units(id, code, name, symbol)
      `).eq("type_id",e).eq("status","active").is("deleted_at",null).order("name",{ascending:!0});if(t)throw t;return r||[]},async getById(e){const{data:r,error:t}=await se.from("materials").select(`
        *,
        category:material_categories(id, code, name, icon, color),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol),
        preferred_supplier:suppliers!materials_preferred_supplier_id_fkey(id, code, name, phone, email),
        created_by_employee:employees!materials_created_by_fkey(id, full_name)
      `).eq("id",e).single();if(t)throw t;return r},async getByCode(e){const{data:r,error:t}=await se.from("materials").select(`
        *,
        category:material_categories(id, code, name),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol)
      `).eq("code",e).is("deleted_at",null).single();if(t&&t.code!=="PGRST116")throw t;return r},async checkCodeExists(e,r){let t=se.from("materials").select("id").eq("code",e).is("deleted_at",null);r&&(t=t.neq("id",r));const{data:n,error:a}=await t.single();if(a&&a.code==="PGRST116")return!1;if(a)throw a;return!!n},async getLowStock(){const{data:e,error:r}=await se.from("materials").select(`
        *,
        category:material_categories(id, code, name, icon, color),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol),
        preferred_supplier:suppliers!materials_preferred_supplier_id_fkey(id, code, name)
      `).eq("status","active").is("deleted_at",null).order("current_stock",{ascending:!0});if(r)throw r;return(e||[]).filter(t=>t.current_stock<t.min_stock)},async create(e,r){if(!e.category_id)throw new Error("Vui lng chn nhm vt t");const t=await A4(e.category_id,e.type_id);if(await this.checkCodeExists(t))throw new Error(`M vt t "${t}"  tn ti`);const{data:a,error:i}=await se.from("materials").insert({code:t,name:e.name.trim(),short_name:e.short_name?.trim()||null,category_id:e.category_id,type_id:e.type_id||null,unit_id:e.unit_id||null,unit_name:e.unit_name?.trim()||null,description:e.description?.trim()||null,specifications:e.specifications?.trim()||null,brand:e.brand?.trim()||null,origin:e.origin?.trim()||null,reference_price:e.reference_price||null,min_price:e.min_price||null,max_price:e.max_price||null,last_purchase_price:e.last_purchase_price||null,last_purchase_date:e.last_purchase_date||null,min_stock:e.min_stock??0,current_stock:e.current_stock??0,preferred_supplier_id:e.preferred_supplier_id||null,image_url:e.image_url||null,notes:e.notes?.trim()||null,status:e.status??"active",created_by:r||null}).select(`
        *,
        category:material_categories(id, code, name, icon, color),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol)
      `).single();if(i)throw i;return a},async update(e,r){const t={updated_at:new Date().toISOString()};r.name!==void 0&&(t.name=r.name.trim()),r.short_name!==void 0&&(t.short_name=r.short_name?.trim()||null),r.category_id!==void 0&&(t.category_id=r.category_id||null),r.type_id!==void 0&&(t.type_id=r.type_id||null),r.unit_id!==void 0&&(t.unit_id=r.unit_id||null),r.unit_name!==void 0&&(t.unit_name=r.unit_name?.trim()||null),r.description!==void 0&&(t.description=r.description?.trim()||null),r.specifications!==void 0&&(t.specifications=r.specifications?.trim()||null),r.brand!==void 0&&(t.brand=r.brand?.trim()||null),r.origin!==void 0&&(t.origin=r.origin?.trim()||null),r.reference_price!==void 0&&(t.reference_price=r.reference_price||null),r.min_price!==void 0&&(t.min_price=r.min_price||null),r.max_price!==void 0&&(t.max_price=r.max_price||null),r.last_purchase_price!==void 0&&(t.last_purchase_price=r.last_purchase_price||null),r.last_purchase_date!==void 0&&(t.last_purchase_date=r.last_purchase_date||null),r.min_stock!==void 0&&(t.min_stock=r.min_stock),r.current_stock!==void 0&&(t.current_stock=r.current_stock),r.preferred_supplier_id!==void 0&&(t.preferred_supplier_id=r.preferred_supplier_id||null),r.image_url!==void 0&&(t.image_url=r.image_url||null),r.notes!==void 0&&(t.notes=r.notes?.trim()||null),r.status!==void 0&&(t.status=r.status);const{data:n,error:a}=await se.from("materials").update(t).eq("id",e).select(`
        *,
        category:material_categories(id, code, name, icon, color),
        type:material_types(id, code, name),
        unit:units(id, code, name, symbol),
        preferred_supplier:suppliers!materials_preferred_supplier_id_fkey(id, code, name)
      `).single();if(a)throw a;return n},async deactivate(e){const{error:r}=await se.from("materials").update({status:"inactive",updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async activate(e){const{error:r}=await se.from("materials").update({status:"active",updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async delete(e){const{error:r}=await se.from("materials").update({deleted_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async updateStock(e,r,t){const{data:n,error:a}=await se.from("materials").select("current_stock").eq("id",e).single();if(a)throw a;let i=n.current_stock||0;switch(t){case"add":i+=r;break;case"subtract":i=Math.max(0,i-r);break;case"set":i=r;break}const{error:o}=await se.from("materials").update({current_stock:i,updated_at:new Date().toISOString()}).eq("id",e);if(o)throw o},async updateLastPrice(e,r){const{error:t}=await se.from("materials").update({last_purchase_price:r,last_purchase_date:new Date().toISOString().split("T")[0],updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t},async getSuppliers(e){const{data:r,error:t}=await se.from("material_suppliers").select(`
        *,
        supplier:suppliers(id, code, name, phone, email)
      `).eq("material_id",e).order("is_preferred",{ascending:!1}).order("unit_price",{ascending:!0});if(t)throw t;return r||[]},async addSupplier(e){const{data:r,error:t}=await se.from("material_suppliers").insert(e).select(`
        *,
        supplier:suppliers(id, code, name, phone, email)
      `).single();if(t)throw t.code==="23505"?new Error("Nh cung cp ny  c thm cho vt t"):t;return r},async updateSupplier(e,r){const{data:t,error:n}=await se.from("material_suppliers").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select(`
        *,
        supplier:suppliers(id, code, name, phone, email)
      `).single();if(n)throw n;return t},async removeSupplier(e){const{error:r}=await se.from("material_suppliers").delete().eq("id",e);if(r)throw r},async setPreferredSupplier(e,r){const{error:t}=await se.from("material_suppliers").update({is_preferred:!0}).eq("material_id",e).eq("supplier_id",r);if(t)throw t},async getStats(){const{count:e}=await se.from("materials").select("*",{count:"exact",head:!0}).is("deleted_at",null),{count:r}=await se.from("materials").select("*",{count:"exact",head:!0}).eq("status","active").is("deleted_at",null),{count:t}=await se.from("materials").select("*",{count:"exact",head:!0}).eq("status","inactive").is("deleted_at",null),{data:n}=await se.from("materials").select("current_stock, min_stock").eq("status","active").is("deleted_at",null),a=(n||[]).filter(c=>c.current_stock<c.min_stock).length,{data:i}=await se.from("materials").select(`
        category:material_categories(name)
      `).eq("status","active").is("deleted_at",null),o={};return i?.forEach(c=>{const u=c.category?.name||"Khng phn loi";o[u]=(o[u]||0)+1}),{total:e||0,active:r||0,inactive:t||0,lowStock:a,byCategory:Object.entries(o).map(([c,u])=>({category:c,count:u}))}},generateMaterialCode:A4,previewMaterialCode:b6},EB=({material:e,onClose:r,onSuccess:t})=>{const n=!!e,[a,i]=R.useState({name:"",short_name:"",category_id:"",type_id:"",unit_id:"",description:"",specifications:"",brand:"",origin:"",reference_price:void 0,min_stock:0,current_stock:0,last_purchase_price:void 0,preferred_supplier_id:"",notes:"",status:"active"}),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState(""),[p,h]=R.useState(!1),[y,g]=R.useState([]),[m,x]=R.useState([]),[v,w]=R.useState([]),[_,A]=R.useState([]);R.useEffect(()=>{(async()=>{try{const[I,U,H]=await Promise.all([bl.getAllActive(),Zu.getAllActive(),_s.getAllActive()]);g(I),w(U),A(H)}catch(I){console.error("Error loading dropdown data:",I)}})()},[]),R.useEffect(()=>{e&&(i({name:e.name,short_name:e.short_name||"",category_id:e.category_id||"",type_id:e.type_id||"",unit_id:e.unit_id||"",description:e.description||"",specifications:e.specifications||"",brand:e.brand||"",origin:e.origin||"",reference_price:e.reference_price,min_stock:e.min_stock,current_stock:e.current_stock,last_purchase_price:e.last_purchase_price,preferred_supplier_id:e.preferred_supplier_id||"",notes:e.notes||"",status:e.status||"active"}),f(e.code))},[e]),R.useEffect(()=>{(async()=>{if(a.category_id)try{const I=await Kc.getByCategory(a.category_id);x(I),a.type_id&&(I.some(H=>H.id===a.type_id)||i(H=>({...H,type_id:""})))}catch(I){console.error("Error loading types:",I)}else x([]),i(I=>({...I,type_id:""}))})()},[a.category_id]),R.useEffect(()=>{!n&&a.category_id&&(async()=>{try{h(!0);const I=await b6(a.category_id,a.type_id||void 0);f(I)}catch(I){console.error("Error previewing code:",I),f("")}finally{h(!1)}})()},[n,a.category_id,a.type_id]);const P=T=>{const{name:I,value:U,type:H}=T.target;i(z=>({...z,[I]:H==="number"?U===""?void 0:parseFloat(U):U}))},B=async T=>{if(T.preventDefault(),!a.name.trim()){l("Vui lng nhp tn vt t");return}if(!a.category_id){l("Vui lng chn nhm vt t");return}try{c(!0),l(null),n&&e?await xo.update(e.id,a):await xo.create(a),t()}catch(I){l(I.message||"C li xy ra")}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Cn,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n?"Sa vt t":"Thm vt t mi"}),d&&s.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:["M: ",s.jsx("span",{className:"font-mono font-medium text-blue-600",children:d}),p&&s.jsx(Mt,{className:"w-3 h-3 animate-spin"})]})]})]}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Br,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:B,className:"flex-1 overflow-y-auto",children:[s.jsxs("div",{className:"p-6 space-y-6",children:[u&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[s.jsx(Cr,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{className:"text-sm",children:u})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(Cn,{className:"w-4 h-4"}),"Thng tin c bn"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn vt t ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"name",value:a.name,onChange:P,placeholder:"VD: Xi mng PCB40 Holcim",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhm vt t ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"category_id",value:a.category_id,onChange:P,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o||n,children:[s.jsx("option",{value:"",children:"-- Chn nhm --"}),y.map(T=>s.jsxs("option",{value:T.id,children:["[",T.code,"] ",T.name]},T.id))]}),n&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Khng th thay i nhm khi sa"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi vt t"}),s.jsxs("select",{name:"type_id",value:a.type_id,onChange:P,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:o||!a.category_id||n,children:[s.jsx("option",{value:"",children:"-- Chn loi --"}),m.map(T=>s.jsxs("option",{value:T.id,children:["[",T.code,"] ",T.name]},T.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v tnh"}),s.jsxs("select",{name:"unit_id",value:a.unit_id,onChange:P,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o,children:[s.jsx("option",{value:"",children:"-- Chn n v --"}),v.map(T=>s.jsxs("option",{value:T.id,children:[T.name," (",T.symbol||T.code,")"]},T.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NCC u tin"}),s.jsxs("select",{name:"preferred_supplier_id",value:a.preferred_supplier_id,onChange:P,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o,children:[s.jsx("option",{value:"",children:"-- Chn NCC --"}),_.map(T=>s.jsxs("option",{value:T.id,children:["[",T.code,"] ",T.name]},T.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quy cch / Thng s k thut"}),s.jsx("input",{type:"text",name:"specifications",value:a.specifications,onChange:P,placeholder:"VD: Bao 50kg, sn xut ti VN",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng hiu"}),s.jsx("input",{type:"text",name:"brand",value:a.brand,onChange:P,placeholder:"VD: Holcim, Ha Pht...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xut x"}),s.jsx("input",{type:"text",name:"origin",value:a.origin,onChange:P,placeholder:"VD: Vit Nam, Nht Bn...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{name:"description",value:a.description,onChange:P,rows:2,placeholder:"M t chi tit v vt t...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[s.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(jh,{className:"w-4 h-4"}),"Tn kho & Gi"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn kho ti thiu"}),s.jsx("input",{type:"number",name:"min_stock",value:a.min_stock,onChange:P,min:0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn kho hin ti"}),s.jsx("input",{type:"number",name:"current_stock",value:a.current_stock,onChange:P,min:0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi mua gn nht (VN)"}),s.jsx("input",{type:"number",name:"last_purchase_price",value:a.last_purchase_price??"",onChange:P,min:0,placeholder:"0",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi tham kho (VN)"}),s.jsx("input",{type:"number",name:"reference_price",value:a.reference_price??"",onChange:P,min:0,placeholder:"0",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]})]}),s.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[s.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[s.jsx(Kf,{className:"w-4 h-4"}),"Khc"]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),s.jsx("textarea",{name:"notes",value:a.notes,onChange:P,rows:2,placeholder:"Ghi ch thm...",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng thi"}),s.jsxs("select",{name:"status",value:a.status,onChange:P,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o,children:[s.jsx("option",{value:"active",children:"ang hot ng"}),s.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50 flex-shrink-0",children:[s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",disabled:o,children:"Hy"}),s.jsx("button",{type:"submit",disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),n?"Cp nht":"Thm mi"]})})]})]})]})})},jwe=()=>{const e=ts(),[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(""),[c,u]=R.useState(""),[l,d]=R.useState(""),[f,p]=R.useState("all"),[h,y]=R.useState(!1),[g,m]=R.useState(1),[x,v]=R.useState(1),[w,_]=R.useState(0),A=15,[P,B]=R.useState([]),[T,I]=R.useState([]),[U,H]=R.useState(!1),[z,O]=R.useState(null),[L,E]=R.useState(null),[k,N]=R.useState({total:0,active:0,lowStock:0});R.useEffect(()=>{(async()=>{try{const le=await bl.getAllActive();B(le)}catch(le){console.error("Error fetching categories:",le)}})()},[]),R.useEffect(()=>{(async()=>{if(c)try{const le=await Kc.getByCategory(c);I(le)}catch(le){console.error("Error fetching types:",le)}else I([]),d("")})()},[c]);const S=async()=>{try{a(!0);const de={page:g,pageSize:A,search:i||void 0,categoryId:c||void 0,typeId:l||void 0,status:f==="all"?void 0:f,lowStock:h||void 0},le=await xo.getAll(de);t(le.data),v(le.totalPages),_(le.total)}catch(de){console.error("Error fetching materials:",de)}finally{a(!1)}},C=async()=>{try{const de=await xo.getStats();N({total:de.total||0,active:de.active||0,lowStock:de.lowStock||0})}catch(de){console.error("Error fetching stats:",de)}};R.useEffect(()=>{S()},[g,i,c,l,f,h]),R.useEffect(()=>{C()},[]);const D=de=>{o(de.target.value),m(1)},q=de=>{u(de),d(""),m(1)},M=de=>{d(de),m(1)},G=()=>{O(null),H(!0)},X=de=>{O(de),H(!0)},re=de=>{e(`/purchasing/materials/${de.id}`)},V=()=>{H(!1),O(null),S(),C()},J=async de=>{try{de.status==="active"?await xo.deactivate(de.id):await xo.activate(de.id),S(),C()}catch(le){alert(le.message||"C li xy ra")}},W=async de=>{try{await xo.delete(de.id),E(null),S(),C()}catch(le){alert(le.message||"C li xy ra khi xa")}},F=()=>{o(""),u(""),d(""),p("all"),y(!1),m(1)},Q=i||c||l||f!=="all"||h,ne=de=>de==null?"-":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(de),ie=de=>de.current_stock??0,ce=de=>de.min_stock??0;return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Danh mc vt t"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Qun l vt t, nguyn liu"})]}),s.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-5 h-5"}),"Thm vt t"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx(Cn,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Tng vt t"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.total})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(im,{className:"w-6 h-6 text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"ang hot ng"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.active})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:s.jsx(Kr,{className:"w-6 h-6 text-red-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Tn kho thp"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:k.lowStock})]})]})})]}),s.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("div",{className:"flex-1 min-w-[200px]",children:s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm theo m hoc tn vt t...",value:i,onChange:D,className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),s.jsx("div",{className:"w-48",children:s.jsxs("select",{value:c,onChange:de=>q(de.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Tt c nhm"}),P.map(de=>s.jsx("option",{value:de.id,children:de.name},de.id))]})}),s.jsx("div",{className:"w-48",children:s.jsxs("select",{value:l,onChange:de=>M(de.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",disabled:!c,children:[s.jsx("option",{value:"",children:"Tt c loi"}),T.map(de=>s.jsx("option",{value:de.id,children:de.name},de.id))]})}),s.jsx("div",{className:"w-40",children:s.jsxs("select",{value:f,onChange:de=>{p(de.target.value),m(1)},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"Tt c"}),s.jsx("option",{value:"active",children:"ang hot ng"}),s.jsx("option",{value:"inactive",children:"Ngng hot ng"})]})}),s.jsxs("button",{onClick:()=>{y(!h),m(1)},className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${h?"bg-red-50 border-red-300 text-red-700":"hover:bg-gray-50"}`,children:[s.jsx(Kr,{className:"w-4 h-4"}),"Tn kho thp"]}),s.jsx("button",{onClick:()=>{S(),C()},className:"p-2 border rounded-lg hover:bg-gray-50 transition-colors",title:"Lm mi",children:s.jsx(Vr,{className:"w-5 h-5 text-gray-600"})}),Q&&s.jsxs("button",{onClick:F,className:"flex items-center gap-1 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(Br,{className:"w-4 h-4"}),"Xa b lc"]})]})}),s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"M"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Tn vt t"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Nhm / Loi"}),s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"VT"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Tn kho"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Gi gn nht"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Trng thi"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y",children:n?s.jsx("tr",{children:s.jsxs("td",{colSpan:8,className:"px-4 py-12 text-center",children:[s.jsx("div",{className:"flex justify-center",children:s.jsx(Vr,{className:"w-8 h-8 animate-spin text-blue-500"})}),s.jsx("p",{className:"mt-2 text-gray-500",children:"ang ti..."})]})}):r.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:8,className:"px-4 py-12 text-center",children:[s.jsx(Cn,{className:"w-12 h-12 text-gray-300 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"Khng c vt t no"}),s.jsx("button",{onClick:G,className:"mt-3 text-blue-600 hover:underline",children:"+ Thm vt t mi"})]})}):r.map(de=>{const le=ie(de),_e=ce(de),ue=le<_e;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"font-mono text-sm font-medium text-blue-600",children:de.code})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium text-gray-900",children:de.name}),de.has_variants&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 text-xs font-medium rounded bg-purple-100 text-purple-700",title:"C bin th",children:[s.jsx(Mf,{className:"w-3 h-3"}),"Bin th"]})]}),de.specifications&&s.jsx("p",{className:"text-xs text-gray-500 truncate max-w-xs",children:de.specifications})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex flex-col gap-1",children:[de.category&&s.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-gray-600",children:[s.jsx(jh,{className:"w-3 h-3"}),de.category.name]}),de.type&&s.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-gray-500",children:[s.jsx(Kf,{className:"w-3 h-3"}),de.type.name]})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"text-sm text-gray-600",children:de.unit?.symbol||de.unit?.name||"-"})}),s.jsxs("td",{className:"px-4 py-3 text-right",children:[s.jsxs("div",{className:`font-medium ${ue?"text-red-600":"text-gray-900"}`,children:[le.toLocaleString(),ue&&s.jsx(Kr,{className:"w-4 h-4 inline ml-1"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Ti thiu: ",_e.toLocaleString()]})]}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsx("span",{className:"text-sm text-gray-900",children:ne(de.last_purchase_price)})}),s.jsx("td",{className:"px-4 py-3 text-center",children:de.status==="active"?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:[s.jsx(im,{className:"w-3 h-3"}),"Hot ng"]}):s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:[s.jsx(xg,{className:"w-3 h-3"}),"Ngng"]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex justify-center gap-1",children:[s.jsx("button",{onClick:()=>re(de),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Xem chi tit",children:s.jsx(ja,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>X(de),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Sa",children:s.jsx(sd,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>J(de),className:`p-2 rounded-lg transition-colors ${de.status==="active"?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50"}`,title:de.status==="active"?"Ngng hot ng":"Kch hot",children:de.status==="active"?s.jsx(xg,{className:"w-4 h-4"}):s.jsx(im,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>E(de),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})]})})]},de.id)})})]})}),x>1&&s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Hin th ",r.length," / ",w," vt t"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>m(de=>Math.max(1,de-1)),disabled:g===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Trang ",g," / ",x]}),s.jsx("button",{onClick:()=>m(de=>Math.min(x,de+1)),disabled:g===x,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),U&&s.jsx(EB,{material:z,onClose:()=>{H(!1),O(null)},onSuccess:V}),L&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa vt t ",s.jsxs("strong",{children:['"',L.name,'"']})," (",L.code,")?",s.jsx("br",{}),s.jsx("span",{className:"text-sm text-red-600 mt-2 block",children:"Lu : Khng th xa vt t ang c s dng trong n hng."})]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>E(null),className:"px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Hy"}),s.jsx("button",{onClick:()=>W(L),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Xa"})]})]})})]})},X0={async getAll(e=!1){let r=se.from("variant_attributes").select("*").order("sort_order",{ascending:!0});e&&(r=r.eq("is_active",!0));const{data:t,error:n}=await r;if(n)throw n;return t||[]},async getById(e){const{data:r,error:t}=await se.from("variant_attributes").select("*").eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw t}return r},async create(e){const{data:r,error:t}=await se.from("variant_attributes").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("variant_attributes").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("variant_attributes").delete().eq("id",e);if(r)throw r},async getWithValues(e=!1){let r=se.from("variant_attributes").select("*, values:variant_attribute_values(*)").order("sort_order",{ascending:!0});e&&(r=r.eq("is_active",!0));const{data:t,error:n}=await r;if(n)throw n;return t||[]}},S5={async getByAttribute(e,r=!1){let t=se.from("variant_attribute_values").select("*").eq("attribute_id",e).order("sort_order",{ascending:!0});r&&(t=t.eq("is_active",!0));const{data:n,error:a}=await t;if(a)throw a;return n||[]},async create(e){const{data:r,error:t}=await se.from("variant_attribute_values").insert(e).select().single();if(t)throw t;return r},async update(e,r){const{data:t,error:n}=await se.from("variant_attribute_values").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return t},async delete(e){const{error:r}=await se.from("variant_attribute_values").delete().eq("id",e);if(r)throw r},async createBulk(e){const{data:r,error:t}=await se.from("variant_attribute_values").insert(e).select();if(t)throw t;return r||[]}},Pb={async getByMaterial(e){const{data:r,error:t}=await se.from("v_material_variants_detail").select("*").eq("material_id",e).order("sort_order",{ascending:!0});if(t){const{data:n,error:a}=await se.from("material_variants").select("*").eq("material_id",e).order("sort_order",{ascending:!0});if(a)throw a;return n||[]}return r||[]},async getById(e){const{data:r,error:t}=await se.from("v_material_variants_detail").select("*").eq("id",e).single();if(t){if(t.code==="PGRST116")return null;const{data:n,error:a}=await se.from("material_variants").select("*").eq("id",e).single();if(a){if(a.code==="PGRST116")return null;throw a}return n}return r},async create(e){const{attributes:r,...t}=e,{data:n,error:a}=await se.from("material_variants").insert(t).select().single();if(a)throw a;if(r&&r.length>0){const i=r.map(c=>({variant_id:n.id,attribute_id:c.attribute_id,attribute_value_id:c.value_id})),{error:o}=await se.from("material_variant_attributes").insert(i);if(o)throw o}return await se.from("materials").update({has_variants:!0}).eq("id",e.material_id),n},async update(e,r){const{attributes:t,...n}=r,{data:a,error:i}=await se.from("material_variants").update({...n,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;if(t!==void 0&&(await se.from("material_variant_attributes").delete().eq("variant_id",e),t.length>0)){const o=t.map(u=>({variant_id:e,attribute_id:u.attribute_id,attribute_value_id:u.value_id})),{error:c}=await se.from("material_variant_attributes").insert(o);if(c)throw c}return a},async delete(e){const{error:r}=await se.from("material_variants").update({status:"discontinued",updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r},async hardDelete(e){const{error:r}=await se.from("material_variants").delete().eq("id",e);if(r)throw r},async updateStock(e,r){const{error:t}=await se.from("material_variants").update({stock_quantity:r,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t},async updatePurchasePrice(e,r){const{error:t}=await se.from("material_variants").update({last_purchase_price:r,last_purchase_date:new Date().toISOString().split("T")[0],updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t},async getLowStock(e=20){const{data:r,error:t}=await se.from("material_variants").select("*, material:materials(id, code, name)").eq("status","active").order("stock_quantity",{ascending:!0}).limit(100);if(t)throw t;return(r||[]).filter(a=>a.stock_quantity<=a.min_stock).slice(0,e)},async search(e){let r=se.from("material_variants").select("*, material:materials(id, code, name, category_id, type_id, unit_id)");e.materialId&&(r=r.eq("material_id",e.materialId)),e.search&&(r=r.or(`variant_name.ilike.%${e.search}%,sku.ilike.%${e.search}%`)),e.status&&(r=r.eq("status",e.status)),r=r.order("material_id").order("sort_order",{ascending:!0}).limit(e.limit||50);const{data:t,error:n}=await r;if(n)throw n;let a=t||[];return e.lowStock&&(a=a.filter(i=>i.stock_quantity<=i.min_stock)),a}},Nwe=({materialId:e,materialName:r,variant:t,attributes:n,onClose:a,onSuccess:i})=>{const o=!!t,[c,u]=R.useState({material_id:e,variant_name:"",sku:"",reference_price:void 0,stock_quantity:0,min_stock:0,max_stock:void 0,notes:"",status:"active",attributes:[]}),[l,d]=R.useState({}),[f,p]=R.useState(!1),[h,y]=R.useState(null);R.useEffect(()=>{if(t&&(u({material_id:t.material_id,variant_name:t.variant_name,sku:t.sku||"",reference_price:t.reference_price,stock_quantity:t.stock_quantity,min_stock:t.min_stock,max_stock:t.max_stock,notes:t.notes||"",status:t.status}),t.attributes)){const v={};t.attributes.forEach(w=>{v[w.attribute_id]=w.value_id}),d(v)}},[t]),R.useEffect(()=>{if(!o&&Object.keys(l).length>0){const v=[];n.forEach(w=>{const _=l[w.id];if(_){const A=w.values.find(P=>P.id===_);A&&v.push(A.display_value||A.value)}}),v.length>0&&u(w=>({...w,variant_name:v.join(" - ")}))}},[l,n,o]);const g=v=>{const{name:w,value:_,type:A}=v.target;u(P=>({...P,[w]:A==="number"?_===""?void 0:Number(_):_}))},m=(v,w)=>{d(_=>({..._,[v]:w}))},x=async v=>{if(v.preventDefault(),y(null),!c.variant_name.trim()){y("Vui lng nhp tn bin th");return}try{p(!0);const w=Object.entries(l).filter(([A,P])=>P).map(([A,P])=>({attribute_id:A,value_id:P})),_={...c,attributes:w};o&&t?await Pb.update(t.id,_):await Pb.create(_),i()}catch(w){console.error("Error saving variant:",w),y(w.message||"C li xy ra khi lu bin th")}finally{p(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Cn,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:o?"Sa bin th":"Thm bin th mi"}),s.jsx("p",{className:"text-sm text-gray-500",children:r})]})]}),s.jsx("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:x,className:"overflow-y-auto max-h-[calc(90vh-140px)]",children:[s.jsxs("div",{className:"p-6 space-y-6",children:[h&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm",children:h}),n.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Thuc tnh bin th"}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:n.map(v=>s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:[v.name,v.unit&&s.jsxs("span",{className:"text-gray-400 ml-1",children:["(",v.unit,")"]})]}),s.jsxs("select",{value:l[v.id]||"",onChange:w=>m(v.id,w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsxs("option",{value:"",children:["-- Chn ",v.name.toLowerCase()," --"]}),v.values.filter(w=>w.is_active).map(w=>s.jsx("option",{value:w.id,children:w.display_value||w.value},w.id))]})]},v.id))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Thng tin c bn"}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:["Tn bin th ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:"variant_name",value:c.variant_name,onChange:g,placeholder:"VD: 100A - 3P",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),s.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"T ng to t thuc tnh hoc nhp th cng"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"M SKU"}),s.jsx("input",{type:"text",name:"sku",value:c.sku||"",onChange:g,placeholder:"VD: MCCB-100A-3P",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Tn kho & Gi"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"S lng tn"}),s.jsx("input",{type:"number",name:"stock_quantity",value:c.stock_quantity||0,onChange:g,min:"0",step:"0.001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Tn ti thiu"}),s.jsx("input",{type:"number",name:"min_stock",value:c.min_stock||0,onChange:g,min:"0",step:"0.001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Tn ti a"}),s.jsx("input",{type:"number",name:"max_stock",value:c.max_stock||"",onChange:g,min:"0",step:"0.001",placeholder:"Khng gii hn",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Gi tham kho (VN)"}),s.jsx("input",{type:"number",name:"reference_price",value:c.reference_price||"",onChange:g,min:"0",step:"1000",placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Trng thi"}),s.jsxs("select",{name:"status",value:c.status,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"active",children:"Hot ng"}),s.jsx("option",{value:"inactive",children:"Tm ngng"}),s.jsx("option",{value:"discontinued",children:"Ngng kinh doanh"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Ghi ch"}),s.jsx("textarea",{name:"notes",value:c.notes||"",onChange:g,rows:3,placeholder:"Ghi ch thm v bin th ny...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 bg-gray-50",children:[s.jsx("button",{type:"button",onClick:a,disabled:f,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Hy"}),s.jsx("button",{type:"submit",disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),o?"Cp nht":"Thm bin th"]})})]})]})]})})},Gx=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),kwe=({materialId:e,materialName:r,unitSymbol:t="",canEdit:n=!0,onVariantsChange:a})=>{const[i,o]=R.useState([]),[c,u]=R.useState([]),[l,d]=R.useState(!0),[f,p]=R.useState(!1),[h,y]=R.useState(null),[g,m]=R.useState(null);R.useEffect(()=>{x()},[e]);const x=async()=>{try{d(!0);const[P,B]=await Promise.all([Pb.getByMaterial(e),X0.getWithValues(!0)]);o(P),u(B)}catch(P){console.error("Error loading variants:",P)}finally{d(!1)}},v=async P=>{if(window.confirm("Bn c chc mun xa bin th ny?"))try{m(P),await Pb.delete(P),await x(),a?.()}catch(B){console.error("Error deleting variant:",B),alert("Khng th xa bin th")}finally{m(null)}},w=()=>{p(!1),y(null),x(),a?.()},_=P=>P.stock_quantity<=P.min_stock,A=P=>{const B={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",discontinued:"bg-red-100 text-red-800"},T={active:"Hot ng",inactive:"Tm ngng",discontinued:"Ngng kinh doanh"};return s.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-medium rounded-full ${B[P]||B.inactive}`,children:T[P]||P})};return l?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-500"})}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mf,{className:"w-5 h-5 text-gray-500"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bin th sn phm"}),s.jsxs("span",{className:"px-2 py-0.5 text-sm bg-gray-100 text-gray-600 rounded-full",children:[i.length," bin th"]})]}),n&&s.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm bin th"]})]}),i.length===0?s.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[s.jsx(Cn,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"Cha c bin th no"}),s.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Thm cc bin th  qun l tn kho v gi theo tng loi"}),n&&s.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm bin th u tin"]})]}):s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bin th"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SKU"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Tn kho"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Gi tham kho"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Gi mua gn nht"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Trng thi"}),n&&s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Thao tc"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(P=>s.jsxs("tr",{className:`hover:bg-gray-50 ${_(P)?"bg-red-50":""}`,children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[_(P)&&s.jsx(Kr,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:P.variant_name}),P.attributes&&Array.isArray(P.attributes)&&P.attributes.length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:P.attributes.map((B,T)=>s.jsxs("span",{className:"inline-flex px-1.5 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:[B.attribute_name,": ",B.display_value||B.value]},T))})]})]})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"text-sm text-gray-500 font-mono",children:P.sku||"-"})}),s.jsxs("td",{className:"px-4 py-3 text-right",children:[s.jsxs("div",{className:`text-sm font-medium ${_(P)?"text-red-600":"text-gray-900"}`,children:[P.stock_quantity.toLocaleString()," ",t]}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Ti thiu: ",P.min_stock]})]}),s.jsx("td",{className:"px-4 py-3 text-right",children:P.reference_price?s.jsx("span",{className:"text-sm text-gray-900",children:Gx(P.reference_price)}):s.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),s.jsx("td",{className:"px-4 py-3 text-right",children:P.last_purchase_price?s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-green-600",children:Gx(P.last_purchase_price)}),P.last_purchase_date&&s.jsx("div",{className:"text-xs text-gray-400",children:new Date(P.last_purchase_date).toLocaleDateString("vi-VN")})]}):s.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:A(P.status)}),n&&s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx("button",{onClick:()=>y(P),className:"p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Sa",children:s.jsx(Z4,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>v(P.id),disabled:g===P.id,className:"p-1.5 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Xa",children:g===P.id?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(En,{className:"w-4 h-4"})})]})})]},P.id))})]}),s.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{className:"text-gray-500",children:["Tng tn kho: ",s.jsxs("span",{className:"font-medium text-gray-900 ml-1",children:[i.reduce((P,B)=>P+B.stock_quantity,0).toLocaleString()," ",t]})]}),i.some(_)&&s.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[s.jsx(Kr,{className:"w-4 h-4"}),i.filter(_).length," bin th tn kho thp"]})]}),i.filter(P=>P.reference_price).length>0&&s.jsxs("div",{className:"text-gray-500",children:["Gi t: ",s.jsx("span",{className:"font-medium text-gray-900 ml-1",children:Gx(Math.min(...i.filter(P=>P.reference_price).map(P=>P.reference_price)))})," - ",s.jsx("span",{className:"font-medium text-gray-900",children:Gx(Math.max(...i.filter(P=>P.reference_price).map(P=>P.reference_price)))})]})]})})]}),(f||h)&&s.jsx(Nwe,{materialId:e,materialName:r,variant:h,attributes:c,onClose:()=>{p(!1),y(null)},onSuccess:w})]})},Swe=()=>{const e=ts(),{id:r}=_h(),[t,n]=R.useState(null),[a,i]=R.useState(!0),[o,c]=R.useState("info"),[u,l]=R.useState([]),[d,f]=R.useState(!1),[p,h]=R.useState([]),[y,g]=R.useState(!1),[m,x]=R.useState({supplier_id:"",unit_price:void 0,min_order_qty:void 0,lead_time_days:void 0,is_preferred:!1,notes:""}),[v,w]=R.useState(!1),[_,A]=R.useState(!1),P=async()=>{if(r)try{i(!0);const C=await xo.getById(r);n(C)}catch(C){console.error("Error fetching material:",C)}finally{i(!1)}},B=async()=>{if(r)try{f(!0);const C=await xo.getSuppliers(r);l(C)}catch(C){console.error("Error fetching suppliers:",C)}finally{f(!1)}},T=async()=>{try{const C=await _s.getAllActive();h(C)}catch(C){console.error("Error fetching available suppliers:",C)}};R.useEffect(()=>{P(),B(),T()},[r]);const I=async()=>{if(!(!r||!m.supplier_id))try{w(!0),await xo.addSupplier({material_id:r,supplier_id:m.supplier_id,unit_price:m.unit_price,min_order_qty:m.min_order_qty,lead_time_days:m.lead_time_days,is_preferred:m.is_preferred,notes:m.notes}),g(!1),x({supplier_id:"",unit_price:void 0,min_order_qty:void 0,lead_time_days:void 0,is_preferred:!1,notes:""}),B(),P()}catch(C){alert(C.message||"C li xy ra")}finally{w(!1)}},U=async C=>{if(confirm("Bn c chc mun xa nh cung cp ny?"))try{await xo.removeSupplier(C),B(),P()}catch(D){alert(D.message||"C li xy ra")}},H=async C=>{if(r)try{await xo.setPreferredSupplier(r,C),B(),P()}catch(D){alert(D.message||"C li xy ra")}},z=C=>C==null?"-":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(C),O=C=>C?new Date(C).toLocaleDateString("vi-VN"):"-",L=C=>C.current_stock??0,E=C=>C.min_stock??0;if(a)return s.jsx("div",{className:"p-6 flex justify-center items-center min-h-[400px]",children:s.jsx(Vr,{className:"w-8 h-8 animate-spin text-blue-500"})});if(!t)return s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Cn,{className:"w-12 h-12 text-gray-300 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"Khng tm thy vt t"}),s.jsx("button",{onClick:()=>e("/purchasing/materials"),className:"mt-4 text-blue-600 hover:underline",children:" Quay li danh sch"})]})});const k=L(t),N=E(t),S=k<N;return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("button",{onClick:()=>e("/purchasing/materials"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.name}),t.status==="active"?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:[s.jsx(im,{className:"w-3 h-3"}),"Hot ng"]}):s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600",children:[s.jsx(xg,{className:"w-3 h-3"}),"Ngng"]}),S&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:[s.jsx(Kr,{className:"w-3 h-3"}),"Tn kho thp"]}),t.has_variants&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full bg-purple-100 text-purple-800",children:[s.jsx(Mf,{className:"w-3 h-3"}),"C bin th"]})]}),s.jsxs("p",{className:"text-gray-500 mt-1",children:[s.jsx("span",{className:"font-mono font-medium text-blue-600",children:t.code}),t.specifications&&s.jsx("span",{className:"mx-2",children:""}),t.specifications]})]})]}),s.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ad,{className:"w-4 h-4"}),"Chnh sa"]})]}),s.jsx("div",{className:"border-b",children:s.jsxs("nav",{className:"flex gap-6",children:[s.jsx("button",{onClick:()=>c("info"),className:`pb-3 text-sm font-medium border-b-2 transition-colors ${o==="info"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Thng tin chung"}),s.jsxs("button",{onClick:()=>c("variants"),className:`pb-3 text-sm font-medium border-b-2 transition-colors flex items-center gap-2 ${o==="variants"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(Mf,{className:"w-4 h-4"}),"Bin th",t.has_variants&&s.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-purple-100 text-purple-700 rounded-full",children:""})]}),s.jsxs("button",{onClick:()=>c("suppliers"),className:`pb-3 text-sm font-medium border-b-2 transition-colors ${o==="suppliers"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Nh cung cp (",u.length,")"]})]})}),o==="info"&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Cn,{className:"w-5 h-5 text-blue-600"}),"Thng tin c bn"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"M vt t"}),s.jsx("p",{className:"font-mono font-medium text-blue-600",children:t.code})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Tn vt t"}),s.jsx("p",{className:"font-medium",children:t.name})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Nhm vt t"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(jh,{className:"w-4 h-4 text-gray-400"}),t.category?.name||"-"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Loi vt t"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Kf,{className:"w-4 h-4 text-gray-400"}),t.type?.name||"-"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"n v tnh"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(J4,{className:"w-4 h-4 text-gray-400"}),t.unit?.name||"-"," (",t.unit?.symbol||"",")"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"NCC u tin"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx($r,{className:"w-4 h-4 text-gray-400"}),t.preferred_supplier?.name||"-"]})]})]}),t.specifications&&s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Quy cch / Thng s"}),s.jsx("p",{className:"mt-1",children:t.specifications})]}),t.description&&s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"M t"}),s.jsx("p",{className:"mt-1",children:t.description})]})]}),t.notes&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(vr,{className:"w-5 h-5 text-blue-600"}),"Ghi ch"]}),s.jsx("p",{className:"text-gray-600",children:t.notes})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Tn kho"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500",children:"Hin ti"}),s.jsxs("span",{className:`text-xl font-bold ${S?"text-red-600":"text-gray-900"}`,children:[k.toLocaleString(),S&&s.jsx(Kr,{className:"w-4 h-4 inline ml-1"})]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500",children:"Ti thiu"}),s.jsx("span",{className:"font-medium",children:N.toLocaleString()})]}),s.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all ${S?"bg-red-500":"bg-green-500"}`,style:{width:`${Math.min(100,k/Math.max(N,1)*100)}%`}})}),t.has_variants&&s.jsx("p",{className:"text-xs text-gray-500 italic",children:"* Tn kho tng hp t cc bin th"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Gi"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500",children:"Gi mua gn nht"}),s.jsx("span",{className:"font-medium text-blue-600",children:z(t.last_purchase_price)})]}),t.reference_price&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-gray-500",children:"Gi tham kho"}),s.jsx("span",{className:"font-medium",children:z(t.reference_price)})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Thi gian"}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Ngy to"}),s.jsx("span",{children:O(t.created_at)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Cp nht"}),s.jsx("span",{children:O(t.updated_at)})]}),t.created_by_employee&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-500",children:"Ngi to"}),s.jsx("span",{children:t.created_by_employee.full_name})]})]})]})]})]}),o==="variants"&&s.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:s.jsx(kwe,{materialId:t.id,materialName:t.name,unitSymbol:t.unit?.symbol,canEdit:!0,onVariantsChange:()=>{P()}})}),o==="suppliers"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm nh cung cp"]})}),y&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Thm nh cung cp"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nh cung cp ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:m.supplier_id,onChange:C=>x(D=>({...D,supplier_id:C.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"-- Chn NCC --"}),p.filter(C=>!u.some(D=>D.supplier_id===C.id)).map(C=>s.jsxs("option",{value:C.id,children:["[",C.code,"] ",C.name]},C.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n gi (VN)"}),s.jsx("input",{type:"number",value:m.unit_price??"",onChange:C=>x(D=>({...D,unit_price:C.target.value?parseFloat(C.target.value):void 0})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thi gian giao (ngy)"}),s.jsx("input",{type:"number",value:m.lead_time_days??"",onChange:C=>x(D=>({...D,lead_time_days:C.target.value?parseInt(C.target.value):void 0})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0"})]})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:m.is_preferred,onChange:C=>x(D=>({...D,is_preferred:C.target.checked})),className:"w-4 h-4 text-blue-600 rounded"}),s.jsx("span",{className:"text-sm",children:"t lm NCC u tin"})]}),s.jsx("div",{className:"flex-1"}),s.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Hy"}),s.jsx("button",{onClick:I,disabled:!m.supplier_id||v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:v?"ang lu...":"Thm"})]})]}),d?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx(Vr,{className:"w-6 h-6 animate-spin text-blue-500"})}):u.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[s.jsx($r,{className:"w-12 h-12 text-gray-300 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-500",children:"Cha c nh cung cp no"})]}):s.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Nh cung cp"}),s.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"n gi"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"SL ti thiu"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Thi gian giao"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"u tin"}),s.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Thao tc"})]})}),s.jsx("tbody",{className:"divide-y",children:u.map(C=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:C.supplier?.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[C.supplier?.code,C.supplier?.phone&&`  ${C.supplier.phone}`]})]})}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsx("span",{className:"font-medium text-blue-600",children:z(C.unit_price)})}),s.jsx("td",{className:"px-4 py-3 text-center",children:C.min_order_qty?.toLocaleString()||"-"}),s.jsx("td",{className:"px-4 py-3 text-center",children:C.lead_time_days?`${C.lead_time_days} ngy`:"-"}),s.jsx("td",{className:"px-4 py-3 text-center",children:C.is_preferred?s.jsx(_o,{className:"w-5 h-5 text-yellow-500 fill-yellow-500 mx-auto"}):s.jsx("button",{onClick:()=>H(C.supplier_id),className:"p-1 text-gray-400 hover:text-yellow-500 transition-colors",title:"t lm u tin",children:s.jsx(ZK,{className:"w-5 h-5"})})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("button",{onClick:()=>U(C.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa",children:s.jsx(En,{className:"w-4 h-4"})})})]},C.id))})]})})]}),_&&s.jsx(EB,{material:t,onClose:()=>A(!1),onSuccess:()=>{A(!1),P()}})]})},Cwe=()=>{const e=ts(),[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(new Set),[c,u]=R.useState(""),[l,d]=R.useState(!1),[f,p]=R.useState(null),[h,y]=R.useState({code:"",name:"",description:"",unit:"",sort_order:0,is_active:!0}),[g,m]=R.useState(null),[x,v]=R.useState(null),[w,_]=R.useState({value:"",display_value:"",sort_order:0}),[A,P]=R.useState(null),[B,T]=R.useState(null),[I,U]=R.useState(null),H=R.useCallback(async()=>{try{a(!0);const J=(await X0.getWithValues()).map(W=>({...W,values:(W.values||[]).sort((F,Q)=>F.sort_order-Q.sort_order)}));t(J)}catch(V){T(V.message||"Li ti d liu")}finally{a(!1)}},[]);R.useEffect(()=>{H()},[H]),R.useEffect(()=>{if(I){const V=setTimeout(()=>U(null),3e3);return()=>clearTimeout(V)}},[I]),R.useEffect(()=>{if(B){const V=setTimeout(()=>T(null),5e3);return()=>clearTimeout(V)}},[B]);const z=()=>{p(null),y({code:"",name:"",description:"",unit:"",sort_order:r.length,is_active:!0}),d(!0)},O=V=>{p(V),y({code:V.code,name:V.name,description:V.description||"",unit:V.unit||"",sort_order:V.sort_order,is_active:V.is_active}),d(!0)},L=async()=>{try{if(!h.code.trim()||!h.name.trim()){T("Vui lng nhp m v tn thuc tnh");return}f?(await X0.update(f.id,h),U(` cp nht thuc tnh "${h.name}"`)):(await X0.create(h),U(` thm thuc tnh "${h.name}"`)),d(!1),p(null),H()}catch(V){T(V.message||"Li lu thuc tnh")}},E=async V=>{try{await X0.delete(V),U(" xa thuc tnh"),P(null),H()}catch(J){T(J.message||"Khng th xa thuc tnh ang c s dng"),P(null)}},k=V=>{const J=r.find(F=>F.id===V),W=Math.max(0,...(J?.values||[]).map(F=>F.sort_order));m(V),v(null),_({value:"",display_value:"",sort_order:W+1}),o(F=>new Set([...F,V]))},N=V=>{v(V),m(V.attribute_id),_({value:V.value,display_value:V.display_value||"",sort_order:V.sort_order})},S=async()=>{try{if(!w.value.trim()){T("Vui lng nhp gi tr");return}x?(await S5.update(x.id,{attribute_id:x.attribute_id,value:w.value.trim(),display_value:w.display_value.trim()||void 0,sort_order:w.sort_order}),U(` cp nht gi tr "${w.value}"`)):g&&(await S5.create({attribute_id:g,value:w.value.trim(),display_value:w.display_value.trim()||void 0,sort_order:w.sort_order}),U(` thm gi tr "${w.value}"`)),m(null),v(null),H()}catch(V){T(V.message||"Li lu gi tr")}},C=async V=>{try{await S5.delete(V),U(" xa gi tr"),P(null),H()}catch(J){T(J.message||"Khng th xa gi tr ang c s dng"),P(null)}},D=()=>{m(null),v(null)},q=V=>{o(J=>{const W=new Set(J);return W.has(V)?W.delete(V):W.add(V),W})},M=()=>{o(new Set(r.map(V=>V.id)))},G=()=>{o(new Set)},X=r.filter(V=>{if(!c)return!0;const J=c.toLowerCase();return V.name.toLowerCase().includes(J)||V.code.toLowerCase().includes(J)||V.values.some(W=>W.value.toLowerCase().includes(J)||(W.display_value||"").toLowerCase().includes(J))}),re=r.reduce((V,J)=>V+J.values.length,0);return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>e("/purchasing/materials"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Qun l thuc tnh bin th"}),s.jsx("p",{className:"text-gray-500 mt-1",children:"nh ngha thuc tnh v gi tr cho bin th vt t"})]})]}),s.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-5 h-5"}),"Thm thuc tnh"]})]}),B&&s.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 text-red-700 rounded-lg border border-red-200",children:[s.jsx(Kr,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:B}),s.jsx("button",{onClick:()=>T(null),className:"ml-auto",children:s.jsx(Br,{className:"w-4 h-4"})})]}),I&&s.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 text-green-700 rounded-lg border border-green-200",children:[s.jsx($i,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("span",{children:I})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Mf,{className:"w-4 h-4"}),s.jsxs("span",{children:[s.jsx("strong",{children:r.length})," thuc tnh"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Kf,{className:"w-4 h-4"}),s.jsxs("span",{children:[s.jsx("strong",{children:re})," gi tr"]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Tm thuc tnh...",value:c,onChange:V=>u(V.target.value),className:"pl-9 pr-4 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-56"})]}),s.jsx("button",{onClick:M,className:"px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"M tt c"}),s.jsx("button",{onClick:G,className:"px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Thu gn"}),s.jsx("button",{onClick:H,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Lm mi",children:s.jsx(Vr,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:" Hng dn:"})," Thm thuc tnh mi (VD: in p, Tit din, Chiu di...) ri nh ngha cc gi tr tng ng. Khi to bin th cho vt t, user s chn t danh sch ny."]}),s.jsx("p",{className:"text-xs text-blue-600 mt-1",children:'V d: Thuc tnh "in p"  Gi tr: 220V, 380V, 440V | Thuc tnh "Tit din"  Gi tr: 1.5mm, 2.5mm, 4mm, 6mm'})]}),s.jsx("div",{className:"space-y-3",children:n?s.jsx("div",{className:"flex justify-center py-12",children:s.jsx(Vr,{className:"w-8 h-8 animate-spin text-blue-500"})}):X.length===0?s.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[s.jsx(Mf,{className:"w-12 h-12 text-gray-300 mx-auto"}),s.jsx("p",{className:"mt-3 text-gray-500",children:c?"Khng tm thy thuc tnh no":"Cha c thuc tnh no"}),!c&&s.jsx("button",{onClick:z,className:"mt-3 text-blue-600 hover:underline text-sm",children:"+ Thm thuc tnh u tin"})]}):X.map(V=>{const J=i.has(V.id),W=g===V.id&&!x;return s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>q(V.id),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[J?s.jsx(Gs,{className:"w-5 h-5 text-gray-400"}):s.jsx(Ks,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:V.name}),V.unit&&s.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded",children:V.unit}),!V.is_active&&s.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-100 text-red-600 rounded",children:"Ngng"})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-400 font-mono",children:V.code}),V.description&&s.jsxs("span",{className:"text-xs text-gray-500",children:[" ",V.description]}),s.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[V.values.length," gi tr"]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-1",onClick:F=>F.stopPropagation(),children:[s.jsx("button",{onClick:()=>k(V.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Thm gi tr",children:s.jsx(An,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>O(V),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Sa thuc tnh",children:s.jsx(sd,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>P({type:"attribute",id:V.id,name:V.name}),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xa thuc tnh",children:s.jsx(En,{className:"w-4 h-4"})})]})]}),J&&s.jsxs("div",{className:"border-t bg-gray-50",children:[V.values.length===0&&!W?s.jsxs("div",{className:"px-5 py-4 text-center text-sm text-gray-500",children:["Cha c gi tr no."," ",s.jsx("button",{onClick:()=>k(V.id),className:"text-blue-600 hover:underline",children:"Thm gi tr"})]}):s.jsxs("div",{className:"divide-y divide-gray-200",children:[V.values.map(F=>x?.id===F.id?s.jsx("div",{className:"px-5 py-3 bg-blue-50",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 text-center text-xs text-gray-400",children:["#",w.sort_order]}),s.jsx("input",{type:"text",value:w.value,onChange:ne=>_({...w,value:ne.target.value}),placeholder:"Gi tr *",className:"flex-1 px-3 py-1.5 border rounded text-sm focus:ring-2 focus:ring-blue-500",autoFocus:!0}),s.jsx("input",{type:"text",value:w.display_value,onChange:ne=>_({...w,display_value:ne.target.value}),placeholder:"Hin th (ty chn)",className:"flex-1 px-3 py-1.5 border rounded text-sm focus:ring-2 focus:ring-blue-500"}),s.jsx("input",{type:"number",value:w.sort_order,onChange:ne=>_({...w,sort_order:parseInt(ne.target.value)||0}),className:"w-16 px-2 py-1.5 border rounded text-sm text-center focus:ring-2 focus:ring-blue-500",title:"Th t"}),s.jsx("button",{onClick:S,className:"p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",children:s.jsx($i,{className:"w-4 h-4"})}),s.jsx("button",{onClick:D,className:"p-1.5 text-gray-500 hover:bg-gray-200 rounded transition-colors",children:s.jsx(Br,{className:"w-4 h-4"})})]})},F.id):s.jsxs("div",{className:"px-5 py-2.5 flex items-center gap-3 hover:bg-gray-100 transition-colors group",children:[s.jsxs("div",{className:"w-8 text-center text-xs text-gray-400",children:["#",F.sort_order]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-800",children:F.value}),F.display_value&&F.display_value!==F.value&&s.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[" hin th: ",F.display_value]})]}),!F.is_active&&s.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-red-100 text-red-600 rounded",children:"Ngng"}),s.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:()=>N(F),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Sa",children:s.jsx(sd,{className:"w-3.5 h-3.5"})}),s.jsx("button",{onClick:()=>P({type:"value",id:F.id,name:F.display_value||F.value}),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Xa",children:s.jsx(En,{className:"w-3.5 h-3.5"})})]})]},F.id)),W&&s.jsxs("div",{className:"px-5 py-3 bg-green-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"w-8 text-center text-xs text-gray-400",children:["#",w.sort_order]}),s.jsx("input",{type:"text",value:w.value,onChange:F=>_({...w,value:F.target.value}),placeholder:"Gi tr * (VD: 220, 380, 1.5...)",className:"flex-1 px-3 py-1.5 border rounded text-sm focus:ring-2 focus:ring-blue-500",autoFocus:!0,onKeyDown:F=>{F.key==="Enter"&&S(),F.key==="Escape"&&D()}}),s.jsx("input",{type:"text",value:w.display_value,onChange:F=>_({...w,display_value:F.target.value}),placeholder:"Hin th (VD: 220V, 1.5mm)",className:"flex-1 px-3 py-1.5 border rounded text-sm focus:ring-2 focus:ring-blue-500",onKeyDown:F=>{F.key==="Enter"&&S(),F.key==="Escape"&&D()}}),s.jsx("input",{type:"number",value:w.sort_order,onChange:F=>_({...w,sort_order:parseInt(F.target.value)||0}),className:"w-16 px-2 py-1.5 border rounded text-sm text-center focus:ring-2 focus:ring-blue-500",title:"Th t"}),s.jsx("button",{onClick:S,className:"p-1.5 text-green-600 hover:bg-green-100 rounded transition-colors",title:"Lu",children:s.jsx($i,{className:"w-4 h-4"})}),s.jsx("button",{onClick:D,className:"p-1.5 text-gray-500 hover:bg-gray-200 rounded transition-colors",title:"Hy",children:s.jsx(Br,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-11",children:"Nhn Enter  lu, Esc  hy"})]})]}),!W&&V.values.length>0&&s.jsx("div",{className:"px-5 py-2 border-t",children:s.jsxs("button",{onClick:()=>k(V.id),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[s.jsx(An,{className:"w-3.5 h-3.5"}),"Thm gi tr mi"]})})]})]},V.id)})}),l&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:f?"Sa thuc tnh":"Thm thuc tnh mi"}),s.jsx("button",{onClick:()=>d(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M thuc tnh *"}),s.jsx("input",{type:"text",value:h.code,onChange:V=>y({...h,code:V.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")}),placeholder:"VD: voltage, section, length",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 font-mono text-sm",disabled:!!f}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ch ch thng, s, du _"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn thuc tnh *"}),s.jsx("input",{type:"text",value:h.name,onChange:V=>y({...h,name:V.target.value}),placeholder:"VD: in p, Tit din, Chiu di",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",autoFocus:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v"}),s.jsx("input",{type:"text",value:h.unit||"",onChange:V=>y({...h,unit:V.target.value}),placeholder:"VD: V, mm, m, kg",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Th t hin th"}),s.jsx("input",{type:"number",value:h.sort_order,onChange:V=>y({...h,sort_order:parseInt(V.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("input",{type:"text",value:h.description||"",onChange:V=>y({...h,description:V.target.value}),placeholder:"VD: in p nh mc ca thit b",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",id:"attr_active",checked:h.is_active,onChange:V=>y({...h,is_active:V.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),s.jsx("label",{htmlFor:"attr_active",className:"text-sm text-gray-700",children:"ang hot ng"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:" Gi  thuc tnh ph bin:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:[{code:"voltage",name:"in p",unit:"V"},{code:"section",name:"Tit din",unit:"mm"},{code:"length",name:"Chiu di",unit:"m"},{code:"weight",name:"Trng lng",unit:"kg"},{code:"diameter",name:"ng knh",unit:"mm"},{code:"thickness",name:" dy",unit:"mm"},{code:"capacity",name:"Cng sut",unit:"W"},{code:"pressure",name:"p sut",unit:"bar"}].map(V=>s.jsxs("button",{onClick:()=>{!h.code&&!h.name&&y({...h,code:V.code,name:V.name,unit:V.unit})},className:"text-xs px-2 py-1 bg-white border rounded hover:bg-blue-50 hover:border-blue-300 transition-colors",title:`${V.name} (${V.unit})`,children:[V.name," (",V.unit,")"]},V.code))})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t bg-gray-50 rounded-b-xl",children:[s.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-100 transition-colors",children:"Hy"}),s.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ai,{className:"w-4 h-4"}),f?"Cp nht":"Thm mi"]})]})]})}),A&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xc nhn xa"}),s.jsxs("p",{className:"text-gray-600 mb-1",children:["Bn c chc mun xa ",A.type==="attribute"?"thuc tnh":"gi tr"," ",s.jsxs("strong",{children:['"',A.name,'"']}),"?"]}),A.type==="attribute"&&s.jsx("p",{className:"text-sm text-red-600 mb-4",children:" Tt c gi tr ca thuc tnh ny cng s b xa. Khng th xa nu ang c s dng trong bin th."}),A.type==="value"&&s.jsx("p",{className:"text-sm text-red-600 mb-4",children:" Khng th xa nu ang c s dng trong bin th vt t."}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Hy"}),s.jsx("button",{onClick:()=>{A.type==="attribute"?E(A.id):C(A.id)},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Xa"})]})]})})]})},ec={draft:"Nhp",confirmed:" xc nhn",partial:"ang giao",completed:"Hon thnh",cancelled:" hy"},Awe={draft:["confirmed","cancelled"],confirmed:["partial","completed","cancelled"],partial:["completed"],completed:[],cancelled:[]};function hv(e,r,t=10){const n=Math.round(e*r*100)/100,a=Math.round(n*t/100*100)/100,i=Math.round((n+a)*100)/100;return{amount:n,vat_amount:a,total_amount:i}}function Ewe(e){const r=e.reduce((a,i)=>a+(i.amount||0),0),t=e.reduce((a,i)=>a+(i.vat_amount||0),0),n=e.reduce((a,i)=>a+(i.total_amount||0),0);return{total_amount:Math.round(r*100)/100,vat_amount:Math.round(t*100)/100,grand_total:Math.round(n*100)/100}}function Twe(e){const r=new Map;for(const t of e){const n=t.supplier_id;r.has(n)||r.set(n,{supplier_id:n,supplier_code:t.supplier?.code||"",supplier_name:t.supplier?.name||"",supplier_short_name:t.supplier?.short_name,items:[],subtotal:0,vat_total:0,grand_total:0,items_count:0});const a=r.get(n);a.items.push(t),a.subtotal+=t.amount||0,a.vat_total+=t.vat_amount||0,a.grand_total+=t.total_amount||0,a.items_count+=1}for(const t of r.values())t.subtotal=Math.round(t.subtotal*100)/100,t.vat_total=Math.round(t.vat_total*100)/100,t.grand_total=Math.round(t.grand_total*100)/100;return Array.from(r.values())}function ba(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(e)}function Pwe(e,r){return Awe[e]?.includes(r)||!1}const zo=`
  *,
  requester:employees!purchase_orders_requester_id_fkey(
    id, code, full_name
  ),
  department:departments!purchase_orders_department_id_fkey(
    id, code, name
  ),
  creator:employees!purchase_orders_created_by_fkey(
    id, code, full_name
  )
`,Xx=`
  *,
  material:materials!purchase_order_items_material_id_fkey(
    id, code, name, unit_name
  ),
  supplier:suppliers!purchase_order_items_supplier_id_fkey(
    id, code, name, short_name
  )
`,Owe=`
  *,
  performer:employees!purchase_order_history_performed_by_fkey(
    id, full_name
  )
`,ca={async getAll(e=1,r=10,t){console.log(" [poService.getAll] Called with:",{page:e,pageSize:r,filter:t});const n=(e-1)*r,a=n+r-1;let i=se.from("purchase_orders").select(zo,{count:"exact"});if(t?.search){const l=`%${t.search}%`;i=i.or(`order_code.ilike.${l},project_name.ilike.${l}`)}t?.status&&(Array.isArray(t.status)?i=i.in("status",t.status):i=i.eq("status",t.status)),t?.department_id&&(i=i.eq("department_id",t.department_id)),t?.requester_id&&(i=i.eq("requester_id",t.requester_id)),t?.created_by&&(i=i.eq("created_by",t.created_by)),t?.date_from&&(i=i.gte("order_date",t.date_from)),t?.date_to&&(i=i.lte("order_date",t.date_to)),t?.min_amount&&(i=i.gte("grand_total",t.min_amount)),t?.max_amount&&(i=i.lte("grand_total",t.max_amount));const{data:o,error:c,count:u}=await i.order("created_at",{ascending:!1}).range(n,a);if(c)throw console.error(" [poService.getAll] Error:",c),c;return console.log(" [poService.getAll] Result:",{count:u,returned:o?.length}),{data:o||[],total:u||0,page:e,pageSize:r,totalPages:Math.ceil((u||0)/r)}},async getById(e){console.log(" [poService.getById] ID:",e);const{data:r,error:t}=await se.from("purchase_orders").select(zo).eq("id",e).single();if(t){if(t.code==="PGRST116")return null;throw console.error(" [poService.getById] Error:",t),t}return r},async getByCode(e){console.log(" [poService.getByCode] Code:",e);const{data:r,error:t}=await se.from("purchase_orders").select(zo).eq("order_code",e).maybeSingle();if(t)throw console.error(" [poService.getByCode] Error:",t),t;return r},async create(e,r){console.log(" [poService.create] Creating new PO");const t=await this.generateOrderCode(),n={order_code:t,order_date:e.order_date||new Date().toISOString().split("T")[0],project_name:e.project_name||null,project_code:e.project_code||null,expected_delivery_date:e.expected_delivery_date||null,delivery_address:e.delivery_address||null,delivery_notes:e.delivery_notes||null,requester_id:e.requester_id||null,department_id:e.department_id||null,notes:e.notes||null,internal_notes:e.internal_notes||null,approval_number:e.approval_number||null,approval_date:e.approval_date||null,approved_by_name:e.approved_by_name||null,approval_documents:e.approval_documents||null,status:"draft",total_amount:0,vat_amount:0,grand_total:0,invoice_progress:0,payment_progress:0,created_by:r},{data:a,error:i}=await se.from("purchase_orders").insert(n).select(zo).single();if(i)throw console.error(" [poService.create] Error:",i),i;return await this.addHistory(a.id,"created",r,{description:`To n hng ${t}`}),console.log(" [poService.create] Created:",t),a},async update(e,r,t){console.log(" [poService.update] ID:",e);const n=await this.getById(e);if(!n)throw new Error("Khng tm thy n hng");if(n.status!=="draft")throw new Error(`Khng th sa n hng  trng thi "${ec[n.status]}"`);const a={...r,updated_at:new Date().toISOString()},{data:i,error:o}=await se.from("purchase_orders").update(a).eq("id",e).select(zo).single();if(o)throw console.error(" [poService.update] Error:",o),o;return await this.addHistory(e,"updated",t,{description:"Cp nht thng tin n hng",old_value:{project_name:n.project_name,expected_delivery_date:n.expected_delivery_date},new_value:{project_name:r.project_name,expected_delivery_date:r.expected_delivery_date}}),console.log(" [poService.update] Updated:",e),i},async updateApprovalEvidence(e,r,t){console.log(" [poService.updateApprovalEvidence] ID:",e);const n=await this.getById(e);if(!n)throw new Error("Khng tm thy n hng");if(n.status==="cancelled")throw new Error("Khng th cp nht thng tin ph duyt cho n hng  hy");const a={updated_at:new Date().toISOString()};r.approval_number!==void 0&&(a.approval_number=r.approval_number||null),r.approval_date!==void 0&&(a.approval_date=r.approval_date||null),r.approved_by_name!==void 0&&(a.approved_by_name=r.approved_by_name||null),r.approval_documents!==void 0&&(a.approval_documents=r.approval_documents||null);const{data:i,error:o}=await se.from("purchase_orders").update(a).eq("id",e).select(zo).single();if(o)throw console.error(" [poService.updateApprovalEvidence] Error:",o),o;return await this.addHistory(e,"updated",t,{description:"Cp nht thng tin ph duyt bn ngoi"}),console.log(" [poService.updateApprovalEvidence] Updated"),i},async delete(e){console.log(" [poService.delete] ID:",e);const r=await this.getById(e);if(!r)throw new Error("Khng tm thy n hng");if(r.status!=="draft")throw new Error("Ch c th xa n hng  trng thi Nhp");const{error:t}=await se.from("purchase_order_items").delete().eq("order_id",e);if(t)throw console.error(" [poService.delete] Error deleting items:",t),t;const{error:n}=await se.from("purchase_order_history").delete().eq("order_id",e);n&&console.error(" [poService.delete] Error deleting history:",n);const{error:a}=await se.from("purchase_orders").delete().eq("id",e);if(a)throw console.error(" [poService.delete] Error:",a),a;console.log(" [poService.delete] Deleted:",e)},async updateStatus(e,r,t){console.log(" [poService.updateStatus] ID:",e,"NewStatus:",r);const n=await this.getById(e);if(!n)throw new Error("Khng tm thy n hng");if(!Pwe(n.status,r))throw new Error(`Khng th chuyn t "${ec[n.status]}" sang "${ec[r]}"`);const a={status:r,updated_at:new Date().toISOString()},{data:i,error:o}=await se.from("purchase_orders").update(a).eq("id",e).select(zo).single();if(o)throw console.error(" [poService.updateStatus] Error:",o),o;const c={partial:"Chuyn sang ang giao (nhn 1 phn)",completed:"n hng hon thnh"};return await this.addHistory(e,"status_changed",t,{description:c[r]||`Chuyn trng thi sang ${ec[r]}`,old_value:{status:n.status},new_value:{status:r}}),console.log(" [poService.updateStatus]",n.status,"",r),i},async confirm(e,r){console.log(" [poService.confirm] ID:",e);const t=await this.getById(e);if(!t)throw new Error("Khng tm thy n hng");if(t.status!=="draft")throw new Error(`Ch c th xc nhn n hng  trng thi Nhp (hin ti: ${ec[t.status]})`);if((await this.getItems(e)).length===0)throw new Error("n hng phi c t nht 1 vt t trc khi xc nhn");if(t.grand_total<=0)throw new Error("n hng phi c tng tin > 0 trc khi xc nhn");const{data:a}=await se.from("employees").select("full_name").eq("id",r).single(),i=a?.full_name||null,o=new Date().toISOString(),c={status:"confirmed",confirmed_by:r,confirmed_at:o,confirmed_by_name:i,updated_at:o},{data:u,error:l}=await se.from("purchase_orders").update(c).eq("id",e).select(zo).single();if(l)throw console.error(" [poService.confirm] Error:",l),l;return await this.addHistory(e,"confirmed",r,{description:`Xc nhn n hng${i?" bi "+i:""}`,old_value:{status:"draft"},new_value:{status:"confirmed"}}),console.log(" [poService.confirm] draft  confirmed"),u},async confirmWithFiles(e,r,t){console.log(" [poService.confirmWithFiles] ID:",e,"Files:",t.length);const n=await this.getById(e);if(!n)throw new Error("Khng tm thy n hng");if(n.status!=="draft")throw new Error(`Ch c th xc nhn n hng  trng thi Nhp (hin ti: ${ec[n.status]})`);if((await this.getItems(e)).length===0)throw new Error("n hng phi c t nht 1 vt t trc khi xc nhn");if(n.grand_total<=0)throw new Error("n hng phi c tng tin > 0 trc khi xc nhn");if(!t||t.length===0)throw new Error("Vui lng upload t nht 1 file bng chng xc nhn");const{data:i}=await se.from("employees").select("full_name").eq("id",r).single(),o=i?.full_name||null,c=new Date().toISOString(),u={status:"confirmed",confirmed_by:r,confirmed_at:c,confirmed_by_name:o,confirmation_files:t,updated_at:c},{data:l,error:d}=await se.from("purchase_orders").update(u).eq("id",e).select(zo).single();if(d)throw console.error(" [poService.confirmWithFiles] Error:",d),d;return await this.addHistory(e,"confirmed",r,{description:`Xc nhn n hng${o?" bi "+o:""} (${t.length} file bng chng)`,old_value:{status:"draft"},new_value:{status:"confirmed",confirmation_files:t}}),console.log(" [poService.confirmWithFiles] draft  confirmed with",t.length,"files"),l},async cancel(e,r,t){if(console.log(" [poService.cancel] ID:",e),!t?.trim())throw new Error("Vui lng nhp l do hy n hng");const n=await this.getById(e);if(!n)throw new Error("Khng tm thy n hng");if(!["draft","confirmed"].includes(n.status))throw new Error(`Khng th hy n hng  trng thi "${ec[n.status]}". Ch hy c khi Nhp hoc  xc nhn.`);const{data:a}=await se.from("employees").select("full_name").eq("id",r).single(),i=a?.full_name||null,o=new Date().toISOString(),c={status:"cancelled",cancelled_by:r,cancelled_at:o,cancelled_by_name:i,cancellation_reason:t.trim(),updated_at:o},{data:u,error:l}=await se.from("purchase_orders").update(c).eq("id",e).select(zo).single();if(l)throw console.error(" [poService.cancel] Error:",l),l;return await this.addHistory(e,"cancelled",r,{description:`Hy n hng: ${t.trim()}`,old_value:{status:n.status},new_value:{status:"cancelled"},details:{reason:t.trim()}}),console.log(" [poService.cancel]",n.status," cancelled"),u},async getItems(e){console.log(" [poService.getItems] Order:",e);const{data:r,error:t}=await se.from("purchase_order_items").select(Xx).eq("order_id",e).order("sort_order",{ascending:!0}).order("created_at",{ascending:!0});if(t)throw console.error(" [poService.getItems] Error:",t),t;return r||[]},async getItemsBySupplier(e){const r=await this.getItems(e);return Twe(r)},async addItem(e,r){console.log(" [poService.addItem] Order:",e);const t=await this.getById(e);if(!t)throw new Error("Khng tm thy n hng");if(t.status!=="draft")throw new Error(`Khng th thm vt t khi n hng  trng thi "${ec[t.status]}"`);const n=r.vat_rate??10,{amount:a,vat_amount:i,total_amount:o}=hv(r.quantity,r.unit_price,n),{data:c}=await se.from("purchase_order_items").select("sort_order").eq("order_id",e).order("sort_order",{ascending:!1}).limit(1),u=(c?.[0]?.sort_order||0)+1,l={order_id:e,material_id:r.material_id||null,supplier_id:r.supplier_id,material_code:r.material_code||null,material_name:r.material_name,specifications:r.specifications||null,unit:r.unit,quantity:r.quantity,unit_price:r.unit_price,vat_rate:n,amount:a,vat_amount:i,total_amount:o,invoiced_quantity:0,invoiced_amount:0,notes:r.notes||null,sort_order:r.sort_order??u},{data:d,error:f}=await se.from("purchase_order_items").insert(l).select(Xx).single();if(f)throw console.error(" [poService.addItem] Error:",f),f;return await this.recalculateOrderTotals(e),console.log(" [poService.addItem] Added item:",d.id),d},async addItems(e,r){console.log(" [poService.addItems] Order:",e,"Count:",r.length);const t=await this.getById(e);if(!t)throw new Error("Khng tm thy n hng");if(t.status!=="draft")throw new Error(`Khng th thm vt t khi n hng  trng thi "${ec[t.status]}"`);const{data:n}=await se.from("purchase_order_items").select("sort_order").eq("order_id",e).order("sort_order",{ascending:!1}).limit(1);let a=(n?.[0]?.sort_order||0)+1;const i=r.map(u=>{const l=u.vat_rate??10,{amount:d,vat_amount:f,total_amount:p}=hv(u.quantity,u.unit_price,l);return{order_id:e,material_id:u.material_id||null,supplier_id:u.supplier_id,material_code:u.material_code||null,material_name:u.material_name,specifications:u.specifications||null,unit:u.unit,quantity:u.quantity,unit_price:u.unit_price,vat_rate:l,amount:d,vat_amount:f,total_amount:p,invoiced_quantity:0,invoiced_amount:0,notes:u.notes||null,sort_order:u.sort_order??a++}}),{data:o,error:c}=await se.from("purchase_order_items").insert(i).select(Xx);if(c)throw console.error(" [poService.addItems] Error:",c),c;return await this.recalculateOrderTotals(e),console.log(" [poService.addItems] Added",o?.length,"items"),o||[]},async updateItem(e,r){console.log(" [poService.updateItem] Item:",e);const{data:t,error:n}=await se.from("purchase_order_items").select("order_id, quantity, unit_price, vat_rate").eq("id",e).single();if(n||!t)throw new Error("Khng tm thy chi tit n hng");const a=await this.getById(t.order_id);if(!a||a.status!=="draft")throw new Error("Khng th sa chi tit khi n hng khng  trng thi Nhp");const i=r.quantity??t.quantity,o=r.unit_price??t.unit_price,c=r.vat_rate??t.vat_rate??10,{amount:u,vat_amount:l,total_amount:d}=hv(i,o,c),f={...r,quantity:i,unit_price:o,vat_rate:c,amount:u,vat_amount:l,total_amount:d,updated_at:new Date().toISOString()};delete f.sort_order;const{data:p,error:h}=await se.from("purchase_order_items").update(f).eq("id",e).select(Xx).single();if(h)throw console.error(" [poService.updateItem] Error:",h),h;return await this.recalculateOrderTotals(t.order_id),console.log(" [poService.updateItem] Updated:",e),p},async removeItem(e){console.log(" [poService.removeItem] Item:",e);const{data:r,error:t}=await se.from("purchase_order_items").select("order_id").eq("id",e).single();if(t||!r)throw new Error("Khng tm thy chi tit n hng");const n=await this.getById(r.order_id);if(!n||n.status!=="draft")throw new Error("Khng th xa chi tit khi n hng khng  trng thi Nhp");const{error:a}=await se.from("purchase_order_items").delete().eq("id",e);if(a)throw console.error(" [poService.removeItem] Error:",a),a;await this.recalculateOrderTotals(r.order_id),console.log(" [poService.removeItem] Removed:",e)},async removeAllItems(e){console.log(" [poService.removeAllItems] Order:",e);const{error:r}=await se.from("purchase_order_items").delete().eq("order_id",e);if(r)throw console.error(" [poService.removeAllItems] Error:",r),r;await this.recalculateOrderTotals(e),console.log(" [poService.removeAllItems] Done")},async reorderItems(e,r){console.log(" [poService.reorderItems] Order:",e);const t=r.map(({id:n,sort_order:a})=>se.from("purchase_order_items").update({sort_order:a}).eq("id",n));await Promise.all(t),console.log(" [poService.reorderItems] Done")},async recalculateOrderTotals(e){console.log(" [poService.recalculateOrderTotals] Order:",e);const r=await this.getItems(e),t=Ewe(r),{error:n}=await se.from("purchase_orders").update({total_amount:t.total_amount,vat_amount:t.vat_amount,grand_total:t.grand_total,updated_at:new Date().toISOString()}).eq("id",e);n&&console.error(" [poService.recalculateOrderTotals] Error:",n),console.log(" [poService.recalculateOrderTotals] Totals:",t)},async generateOrderCode(){const r=`DH-${new Date().getFullYear()}-`,{data:t,error:n}=await se.from("purchase_orders").select("order_code").ilike("order_code",`${r}%`).order("order_code",{ascending:!1}).limit(1);if(n)throw console.error(" [poService.generateOrderCode] Error:",n),n;let a=1;if(t&&t.length>0&&t[0].order_code){const c=t[0].order_code.replace(r,""),u=parseInt(c,10);isNaN(u)||(a=u+1)}const i=`${r}${a.toString().padStart(4,"0")}`;return console.log(" [poService.generateOrderCode] Generated:",i),i},async addHistory(e,r,t,n){console.log(" [poService.addHistory] Order:",e,"Action:",r);const{error:a}=await se.from("purchase_order_history").insert({order_id:e,action:r,description:n?.description||null,old_value:n?.old_value||null,new_value:n?.new_value||null,details:n?.details||null,performed_by:t,performed_at:new Date().toISOString()});a&&console.error(" [poService.addHistory] Error:",a)},async getHistory(e){console.log(" [poService.getHistory] Order:",e);const{data:r,error:t}=await se.from("purchase_order_history").select(Owe).eq("order_id",e).order("performed_at",{ascending:!1});if(t)throw console.error(" [poService.getHistory] Error:",t),t;return r||[]},async getStats(){console.log(" [poService.getStats]");const{data:e,error:r}=await se.from("purchase_orders").select("status, grand_total, expected_delivery_date");if(r)throw console.error(" [poService.getStats] Error:",r),r;const t=new Date().toISOString().split("T")[0],n=e||[],a={total_orders:n.length,total_amount:n.reduce((i,o)=>i+(o.grand_total||0),0),draft_count:n.filter(i=>i.status==="draft").length,confirmed_count:n.filter(i=>i.status==="confirmed").length,partial_count:n.filter(i=>i.status==="partial").length,completed_count:n.filter(i=>i.status==="completed").length,cancelled_count:n.filter(i=>i.status==="cancelled").length,overdue_count:n.filter(i=>i.expected_delivery_date&&i.expected_delivery_date<t&&!["completed","cancelled"].includes(i.status)).length};return console.log(" [poService.getStats] Result:",a),a},async getStatusCounts(e){let r=se.from("purchase_orders").select("status");e?.department_id&&(r=r.eq("department_id",e.department_id)),e?.created_by&&(r=r.eq("created_by",e.created_by));const{data:t,error:n}=await r;if(n)throw console.error(" [poService.getStatusCounts] Error:",n),n;const a={all:t?.length||0,draft:0,confirmed:0,partial:0,completed:0,cancelled:0};return t?.forEach(i=>{a[i.status]!==void 0&&a[i.status]++}),a},async getOrdersBySupplier(e){console.log(" [poService.getOrdersBySupplier] Supplier:",e);const{data:r,error:t}=await se.from("purchase_order_items").select("order_id").eq("supplier_id",e);if(t)throw t;const n=[...new Set((r||[]).map(o=>o.order_id))];if(n.length===0)return[];const{data:a,error:i}=await se.from("purchase_orders").select(zo).in("id",n).order("created_at",{ascending:!1});if(i)throw i;return a||[]},async getRecent(e=5){const{data:r,error:t}=await se.from("purchase_orders").select(zo).order("created_at",{ascending:!1}).limit(e);if(t)throw t;return r||[]},async getConfirmedOrders(){const{data:e,error:r}=await se.from("purchase_orders").select(zo).eq("status","confirmed").order("created_at",{ascending:!0});if(r)throw r;return e||[]},async getOrderInvoiceSummary(e){console.log(" [poService.getOrderInvoiceSummary] Order:",e);const{data:r,error:t}=await se.from("purchase_orders").select("id, order_code, grand_total, invoice_progress, payment_progress").eq("id",e).single();if(t)throw t;const{data:n,error:a}=await se.from("supplier_invoices").select("id, total_amount, paid_amount, remaining_amount, status, due_date").eq("order_id",e).neq("status","cancelled");if(a)throw a;const i=new Date().toISOString().split("T")[0],o=n||[],c=o.reduce((p,h)=>p+(h.total_amount||0),0),u=o.reduce((p,h)=>p+(h.paid_amount||0),0),l=o.reduce((p,h)=>p+(h.remaining_amount||0),0),d=o.filter(p=>p.due_date&&p.due_date<i&&p.status!=="paid"),f=d.reduce((p,h)=>p+(h.remaining_amount||0),0);return{order_id:r.id,order_code:r.order_code,grand_total:r.grand_total||0,invoice_count:o.length,total_invoiced:c,invoice_progress:r.grand_total>0?Math.round(c/r.grand_total*100):0,total_paid:u,total_remaining:l,payment_progress:c>0?Math.round(u/c*100):0,overdue_count:d.length,overdue_amount:f}},async getOrderInvoiceBreakdown(e){console.log(" [poService.getOrderInvoiceBreakdown] Order:",e);const{data:r,error:t}=await se.from("purchase_order_items").select(`
        supplier_id,
        total_amount,
        supplier:suppliers!purchase_order_items_supplier_id_fkey(
          id, code, name
        )
      `).eq("order_id",e);if(t)throw t;const n=new Map;for(const d of r||[]){const f=d.supplier_id,p=Array.isArray(d.supplier)?d.supplier[0]:d.supplier;n.has(f)||n.set(f,{supplier_id:f,supplier_code:p?.code||"",supplier_name:p?.name||"",order_subtotal:0,order_item_count:0});const h=n.get(f);h.order_subtotal+=d.total_amount||0,h.order_item_count+=1}const{data:a,error:i}=await se.from("supplier_invoices").select(`
        id, invoice_code, invoice_number, invoice_date, due_date,
        total_amount, paid_amount, remaining_amount, status,
        image_urls, notes, created_by, created_at, supplier_id,
        creator:employees!supplier_invoices_created_by_fkey(full_name)
      `).eq("order_id",e).neq("status","cancelled").order("created_at",{ascending:!1});if(i)throw i;const o=(a||[]).map(d=>d.id),c=new Map;if(o.length>0){const{data:d,error:f}=await se.from("invoice_payments").select(`
          id, invoice_id, payment_date, amount, payment_method,
          reference_number, bank_name, notes, created_at,
          creator:employees!invoice_payments_created_by_fkey(full_name)
        `).in("invoice_id",o).order("payment_date",{ascending:!1});if(f)throw f;for(const p of d||[]){const h=Array.isArray(p.creator)?p.creator[0]:p.creator,y={id:p.id,payment_date:p.payment_date,amount:p.amount,payment_method:p.payment_method,reference_number:p.reference_number,bank_name:p.bank_name,notes:p.notes,created_by_name:h?.full_name||null,created_at:p.created_at};c.has(p.invoice_id)||c.set(p.invoice_id,[]),c.get(p.invoice_id).push(y)}}const u=new Date().toISOString().split("T")[0],l=[];for(const[d,f]of n){const p=(a||[]).filter(g=>g.supplier_id===d).map(g=>{const m=Array.isArray(g.creator)?g.creator[0]:g.creator,x=!!(g.due_date&&g.due_date<u&&g.status!=="paid"),v=x&&g.due_date?Math.floor((new Date().getTime()-new Date(g.due_date).getTime())/(1e3*60*60*24)):0;return{id:g.id,invoice_code:g.invoice_code,invoice_number:g.invoice_number,invoice_date:g.invoice_date,due_date:g.due_date,total_amount:g.total_amount,paid_amount:g.paid_amount,remaining_amount:g.remaining_amount,status:g.status,is_overdue:x,days_overdue:v,image_urls:g.image_urls,notes:g.notes,created_by_name:m?.full_name||null,created_at:g.created_at,payments:c.get(g.id)||[]}}),h=p.reduce((g,m)=>g+m.total_amount,0),y=p.reduce((g,m)=>g+m.paid_amount,0);l.push({...f,invoices:p,total_invoiced:h,invoice_progress:f.order_subtotal>0?Math.round(h/f.order_subtotal*100):0,total_paid:y,payment_progress:h>0?Math.round(y/h*100):0,remaining:h-y})}return l.sort((d,f)=>f.remaining-d.remaining),l},async getOrdersProgressBatch(e){if(console.log(" [poService.getOrdersProgressBatch] Count:",e.length),e.length===0)return new Map;const{data:r,error:t}=await se.from("purchase_orders").select("id, invoice_progress, payment_progress").in("id",e);if(t)throw t;const{data:n,error:a}=await se.from("supplier_invoices").select("order_id, id, status, due_date").in("order_id",e).neq("status","cancelled");if(a)throw a;const i=new Date().toISOString().split("T")[0],o=new Map;for(const u of n||[]){o.has(u.order_id)||o.set(u.order_id,{count:0,overdue:0});const l=o.get(u.order_id);l.count+=1,u.due_date&&u.due_date<i&&u.status!=="paid"&&(l.overdue+=1)}const c=new Map;for(const u of r||[]){const l=o.get(u.id)||{count:0,overdue:0};c.set(u.id,{order_id:u.id,invoice_progress:u.invoice_progress||0,payment_progress:u.payment_progress||0,invoice_count:l.count,overdue_count:l.overdue})}return c},async getOrderSuppliers(e){console.log(" [poService.getOrderSuppliers] Order:",e);const{data:r,error:t}=await se.from("purchase_order_items").select(`
        supplier_id,
        total_amount,
        supplier:suppliers!purchase_order_items_supplier_id_fkey(id, code, name)
      `).eq("order_id",e);if(t)throw t;const n=new Map;for(const a of r||[]){const i=Array.isArray(a.supplier)?a.supplier[0]:a.supplier,o=a.supplier_id;n.has(o)||n.set(o,{id:o,code:i?.code||"",name:i?.name||"",item_count:0,subtotal:0});const c=n.get(o);c.item_count+=1,c.subtotal+=a.total_amount||0}return Array.from(n.values()).sort((a,i)=>a.name.localeCompare(i.name))}},Mwe=[10,20,50],Iwe={draft:vr,pending:Xr,approved:Un,rejected:ua,partial:Cn,completed:Un,cancelled:ua},Rwe={draft:"bg-gray-100 text-gray-700",pending:"bg-yellow-100 text-yellow-700",approved:"bg-blue-100 text-blue-700",rejected:"bg-red-100 text-red-700",partial:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700",cancelled:"bg-gray-100 text-gray-500"};function Lwe({status:e}){const r=Iwe[e]||vr,t=ec[e]||e,n=Rwe[e]||"bg-gray-100 text-gray-700";return s.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium ${n}`,children:[s.jsx(r,{className:"w-3.5 h-3.5"}),t]})}function hP({value:e,label:r,color:t="blue"}){const n={blue:"bg-blue-500",green:"bg-green-500",orange:"bg-orange-500"};return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all ${n[t]||n.blue}`,style:{width:`${Math.min(e,100)}%`}})}),s.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap w-16 text-right",children:r})]})}function Dwe(){const e=ts(),[r,t]=R.useState([]),[n,a]=R.useState(!0),[i,o]=R.useState(0),[c,u]=R.useState(0),[l,d]=R.useState(1),[f,p]=R.useState(10),[h,y]=R.useState(""),[g,m]=R.useState(""),[x,v]=R.useState("all"),[w,_]=R.useState(""),[A,P]=R.useState(""),[B,T]=R.useState(""),[I,U]=R.useState(!1),[H,z]=R.useState({}),[O,L]=R.useState([]),[E,k]=R.useState(null),[N,S]=R.useState({show:!1,order:null}),[C,D]=R.useState(!1),q=R.useCallback(async()=>{a(!0);try{const F={};h&&(F.search=h),x&&x!=="all"&&(F.status=x),w&&(F.department_id=w),A&&(F.date_from=A),B&&(F.date_to=B);const Q=await ca.getAll(l,f,F);t(Q.data),o(Q.total),u(Q.totalPages)}catch(F){console.error("Li ti danh sch n hng:",F)}finally{a(!1)}},[l,f,h,x,w,A,B]),M=R.useCallback(async()=>{try{const F=await ca.getStatusCounts();z(F)}catch(F){console.error("Li ti thng k:",F)}},[]),G=R.useCallback(async()=>{try{const F=await zi.getAllActive();L(F.map(Q=>({id:Q.id,name:Q.name})))}catch(F){console.error("Li ti phng ban:",F)}},[]);R.useEffect(()=>{q()},[q]),R.useEffect(()=>{M(),G()},[M,G]);const X=()=>{y(g),d(1)},re=F=>{F.key==="Enter"&&X()},V=()=>{m(""),y(""),v("all"),_(""),P(""),T(""),d(1)},J=async()=>{if(N.order){D(!0);try{await ca.delete(N.order.id),S({show:!1,order:null}),q(),M()}catch(F){alert(F.message||"Li xa n hng")}finally{D(!1)}}},W=h||x!=="all"||w||A||B;return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"n hng"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Qun l n hng mua hng"})]}),s.jsxs("button",{onClick:()=>e("/purchasing/orders/new"),className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[s.jsx(An,{className:"w-4 h-4"}),"To n hng"]})]}),s.jsx("div",{className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1 overflow-x-auto",children:[{key:"all",label:"Tt c",icon:jl},{key:"draft",label:"Nhp",icon:vr},{key:"pending",label:"Ch duyt",icon:Xr},{key:"approved",label:" duyt",icon:Un},{key:"rejected",label:"T chi",icon:ua},{key:"completed",label:"Hon thnh",icon:Un}].map(F=>{const Q=x===F.key,ne=F.key==="all"?H.all:H[F.key],ie=F.icon;return s.jsxs("button",{onClick:()=>{v(F.key),d(1)},className:`flex items-center gap-1.5 px-3 py-2 rounded-md text-sm font-medium whitespace-nowrap transition-colors ${Q?"bg-white text-blue-700 shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[s.jsx(ie,{className:"w-4 h-4"}),F.label,ne!==void 0&&ne>0&&s.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${Q?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-600"}`,children:ne})]},F.key)})}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"p-4 flex items-center gap-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:g,onChange:F=>m(F.target.value),onKeyDown:re,placeholder:"Tm theo m n, tn d n...",className:"w-full pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsx("button",{onClick:X,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm transition-colors",children:"Tm"}),s.jsxs("button",{onClick:()=>U(!I),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-colors ${I||W?"bg-blue-50 text-blue-700 border border-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx(Al,{className:"w-4 h-4"}),"B lc",W&&s.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"})]}),s.jsx("button",{onClick:()=>{q(),M()},className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",title:"Lm mi",children:s.jsx(Vr,{className:"w-4 h-4"})})]}),I&&s.jsxs("div",{className:"px-4 pb-4 pt-0 border-t border-gray-100",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 mb-1 block",children:"Phng ban"}),s.jsxs("select",{value:w,onChange:F=>{_(F.target.value),d(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),O.map(F=>s.jsx("option",{value:F.id,children:F.name},F.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 mb-1 block",children:"T ngy"}),s.jsx("input",{type:"date",value:A,onChange:F=>{P(F.target.value),d(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-500 mb-1 block",children:"n ngy"}),s.jsx("input",{type:"date",value:B,onChange:F=>{T(F.target.value),d(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]}),W&&s.jsx("div",{className:"mt-3 flex justify-end",children:s.jsxs("button",{onClick:V,className:"flex items-center gap-1 text-sm text-gray-500 hover:text-red-600 transition-colors",children:[s.jsx(Br,{className:"w-3.5 h-3.5"}),"Xa b lc"]})})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-t border-gray-200 bg-gray-50",children:[s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"M n"}),s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"D n / Cng trnh"}),s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Ngy to"}),s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Phng ban"}),s.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Tng tin"}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Trng thi"}),s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider w-40",children:"Tin "}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider w-16"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:n?Array.from({length:5}).map((F,Q)=>s.jsxs("tr",{className:"animate-pulse",children:[s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-28"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-40"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-28"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 ml-auto"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-20 mx-auto"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"})}),s.jsx("td",{className:"px-4 py-4",children:s.jsx("div",{className:"h-6 bg-gray-200 rounded w-6 mx-auto"})})]},Q)):r.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:8,className:"px-4 py-16 text-center",children:[s.jsx(jl,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 font-medium",children:W?"Khng tm thy n hng ph hp":"Cha c n hng no"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:W?"Th thay i b lc  xem kt qu khc":"Bt u bng cch to n hng mi"}),!W&&s.jsxs("button",{onClick:()=>e("/purchasing/orders/new"),className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[s.jsx(An,{className:"w-4 h-4"}),"To n hng u tin"]})]})}):r.map(F=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors cursor-pointer group",onClick:()=>e(`/purchasing/orders/${F.id}`),children:[s.jsx("td",{className:"px-4 py-3.5",children:s.jsx("span",{className:"font-semibold text-blue-600 group-hover:text-blue-700",children:F.order_code})}),s.jsx("td",{className:"px-4 py-3.5",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-900 font-medium truncate max-w-[200px]",children:F.project_name||""}),F.requester&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:F.requester.full_name})]})}),s.jsxs("td",{className:"px-4 py-3.5",children:[s.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[s.jsx(dn,{className:"w-3.5 h-3.5 text-gray-400"}),new Date(F.order_date).toLocaleDateString("vi-VN")]}),F.expected_delivery_date&&s.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Giao: ",new Date(F.expected_delivery_date).toLocaleDateString("vi-VN")]})]}),s.jsx("td",{className:"px-4 py-3.5",children:F.department?s.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[s.jsx($r,{className:"w-3.5 h-3.5 text-gray-400"}),F.department.name]}):s.jsx("span",{className:"text-sm text-gray-400",children:""})}),s.jsxs("td",{className:"px-4 py-3.5 text-right",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:ba(F.grand_total)}),F.grand_total>0&&F.vat_amount>0&&s.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["VAT: ",ba(F.vat_amount)]})]}),s.jsx("td",{className:"px-4 py-3.5 text-center",children:s.jsx(Lwe,{status:F.status})}),s.jsx("td",{className:"px-4 py-3.5",onClick:Q=>Q.stopPropagation(),children:["approved","partial","completed"].includes(F.status)?s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(hP,{value:F.invoice_progress,label:`H ${F.invoice_progress}%`,color:"blue"}),s.jsx(hP,{value:F.payment_progress,label:`TT ${F.payment_progress}%`,color:"green"})]}):s.jsx("span",{className:"text-xs text-gray-400",children:""})}),s.jsx("td",{className:"px-4 py-3.5 text-center",onClick:Q=>Q.stopPropagation(),children:s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>k(E===F.id?null:F.id),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx($b,{className:"w-4 h-4"})}),E===F.id&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>k(null)}),s.jsxs("div",{className:"absolute right-0 top-8 z-20 bg-white border border-gray-200 rounded-lg shadow-lg py-1 w-44",children:[s.jsxs("button",{onClick:()=>{k(null),e(`/purchasing/orders/${F.id}`)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(ja,{className:"w-4 h-4"}),"Xem chi tit"]}),["draft","rejected"].includes(F.status)&&s.jsxs("button",{onClick:()=>{k(null),e(`/purchasing/orders/${F.id}/edit`)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(sd,{className:"w-4 h-4"}),"Chnh sa"]}),F.status==="draft"&&F.grand_total>0&&s.jsxs("button",{onClick:async()=>{if(k(null),!!confirm("Np n hng ny  ch duyt?"))try{alert("Chc nng np n s c hon thin trong Phase 3.3"),q(),M()}catch(Q){alert(Q.message||"Li")}},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-blue-700 hover:bg-blue-50",children:[s.jsx(Hb,{className:"w-4 h-4"}),"Np duyt"]}),F.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>{k(null),S({show:!0,order:F})},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{className:"w-4 h-4"}),"Xa"]})]})]})]})]})})]},F.id))})]})}),i>0&&s.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"text-sm text-gray-500",children:["Hin th ",(l-1)*f+1,"",Math.min(l*f,i)," / ",i," n hng"]}),s.jsx("select",{value:f,onChange:F=>{p(Number(F.target.value)),d(1)},className:"text-sm border border-gray-300 rounded-md px-2 py-1 focus:ring-2 focus:ring-blue-500 outline-none",children:Mwe.map(F=>s.jsxs("option",{value:F,children:[F," / trang"]},F))})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>d(Math.max(1,l-1)),disabled:l<=1,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:s.jsx(su,{className:"w-4 h-4"})}),Array.from({length:Math.min(c,5)},(F,Q)=>{let ne;return c<=5||l<=3?ne=Q+1:l>=c-2?ne=c-4+Q:ne=l-2+Q,s.jsx("button",{onClick:()=>d(ne),className:`w-8 h-8 rounded-lg text-sm font-medium transition-colors ${l===ne?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:ne},ne)}),s.jsx("button",{onClick:()=>d(Math.min(c,l+1)),disabled:l>=c,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),N.show&&N.order&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>S({show:!1,order:null})}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl p-6 w-full max-w-md mx-4",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx(Cr,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Xa n hng?"}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Bn c chc mun xa n hng"," ",s.jsx("strong",{className:"text-gray-700",children:N.order.order_code}),"? Thao tc ny khng th hon tc."]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[s.jsx("button",{onClick:()=>S({show:!1,order:null}),disabled:C,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Hy"}),s.jsx("button",{onClick:J,disabled:C,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:C?"ang xa...":"Xa"})]})]})]})]})}function Fwe({formData:e,departments:r,employees:t,onChange:n,defaultShowDelivery:a=!1}){const[i,o]=R.useState(!0),[c,u]=R.useState(a);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[s.jsxs("button",{type:"button",onClick:()=>o(!i),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 transition-colors rounded-t-xl",children:[s.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(vr,{className:"w-5 h-5 text-blue-500"}),"Thng tin chung"]}),i?s.jsx(si,{className:"w-5 h-5 text-gray-400"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-400"})]}),i&&s.jsx("div",{className:"px-5 pb-5 border-t border-gray-100",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngy n hng ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",value:e.order_date,onChange:l=>n("order_date",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn d n / Cng trnh"}),s.jsx("input",{type:"text",value:e.project_name,onChange:l=>n("project_name",l.target.value),placeholder:"VD: Nh xng mi, Bo tr Q1...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M d n"}),s.jsx("input",{type:"text",value:e.project_code,onChange:l=>n("project_code",l.target.value),placeholder:"VD: DA-2026-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phng ban yu cu"}),s.jsxs("select",{value:e.department_id,onChange:l=>n("department_id",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"Chn phng ban"}),r.map(l=>s.jsx("option",{value:l.id,children:l.name},l.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngi yu cu"}),s.jsxs("select",{value:e.requester_id,onChange:l=>n("requester_id",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"Chn nhn vin"}),t.filter(l=>!e.department_id||l.department_id===e.department_id).map(l=>s.jsxs("option",{value:l.id,children:[l.full_name," (",l.code,")"]},l.id))]})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[s.jsxs("button",{type:"button",onClick:()=>u(!c),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 transition-colors rounded-t-xl",children:[s.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(dc,{className:"w-5 h-5 text-green-500"}),"Giao hng"]}),c?s.jsx(si,{className:"w-5 h-5 text-gray-400"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-400"})]}),c&&s.jsx("div",{className:"px-5 pb-5 border-t border-gray-100",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy giao d kin"}),s.jsx("input",{type:"date",value:e.expected_delivery_date,onChange:l=>n("expected_delivery_date",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"a ch giao hng"}),s.jsx("input",{type:"text",value:e.delivery_address,onChange:l=>n("delivery_address",l.target.value),placeholder:"a ch nhn hng...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch giao hng"}),s.jsx("textarea",{value:e.delivery_notes,onChange:l=>n("delivery_notes",l.target.value),rows:2,placeholder:"VD: Giao vo bui sng, lin h trc 30 pht...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none"})]})]})})]})]})}function Bwe({initialName:e="",onSave:r,onClose:t}){const n=R.useRef(null),[a,i]=R.useState({name:e,category_id:"",type_id:"",unit_id:"",preferred_supplier_id:"",specifications:"",brand:"",origin:"",description:"",reference_price:0,min_stock:0,current_stock:0,last_purchase_price:0,status:"active"}),[o,c]=R.useState("---"),[u,l]=R.useState(!1),[d,f]=R.useState([]),[p,h]=R.useState([]),[y,g]=R.useState([]),[m,x]=R.useState([]),[v,w]=R.useState([]),[_,A]=R.useState(!1),[P,B]=R.useState(!0),[T,I]=R.useState(""),[U,H]=R.useState(!1);R.useEffect(()=>{(async()=>{try{B(!0);const[E,k,N,S]=await Promise.all([bl.getAll({page:1,pageSize:100,is_active:!0}),Kc.getAll({page:1,pageSize:200,is_active:!0}),Zu.getAll({page:1,pageSize:200,isActive:!0}),_s.getAll({page:1,pageSize:200,status:"active"})]);f(E?.data||[]);const C=k?.data||[];h(C),g(C),x(N?.data||[]),w(S?.data||[])}catch{I("Khng th ti d liu danh mc")}finally{B(!1)}})()},[]),R.useEffect(()=>{P||setTimeout(()=>n.current?.focus(),100)},[P]),R.useEffect(()=>{if(a.category_id){const L=p.filter(E=>E.category_id===a.category_id);g(L),a.type_id&&!L.find(E=>E.id===a.type_id)&&i(E=>({...E,type_id:""}))}else g(p)},[a.category_id,p]),R.useEffect(()=>{(async()=>{if(!a.category_id){c("---");return}try{l(!0);const E=await b6(a.category_id,a.type_id||"");c(E)}catch{c("---")}finally{l(!1)}})()},[a.category_id,a.type_id]);const z=(L,E)=>{i(k=>({...k,[L]:E})),T&&I("")},O=async()=>{if(!a.name.trim()){I("Vui lng nhp tn vt t"),n.current?.focus();return}if(!a.category_id){I("Vui lng chn nhm vt t");return}try{A(!0),I("");const L=await xo.create(a),E=m.find(N=>N.id===a.unit_id),k={id:L.id,code:L.code,name:L.name,unit_name:E?.name||L.unit_name||"",specifications:L.specifications||a.specifications?.trim()||void 0,reference_price:L.reference_price||a.reference_price||void 0,last_purchase_price:L.last_purchase_price||a.last_purchase_price||void 0,unit:E?{id:E.id,code:E.code,name:E.name,symbol:E.symbol}:void 0};r(k)}catch(L){console.error("Create material error:",L),I(L.message||"Li to vt t. Vui lng th li.")}finally{A(!1)}};return R.useEffect(()=>{const L=E=>{E.key==="Escape"&&!_&&t()};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[_,t]),s.jsxs("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4",children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:_?void 0:t}),s.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col animate-in fade-in zoom-in-95 duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:s.jsx(Cn,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Thm vt t mi"}),s.jsxs("p",{className:"text-sm text-blue-600 font-mono flex items-center gap-1.5",children:[s.jsx(ja,{className:"w-3.5 h-3.5"}),"M: ",u?"...":o]})]})]}),s.jsx("button",{onClick:t,disabled:_,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:P?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(Mt,{className:"w-8 h-8 text-blue-500 animate-spin"}),s.jsx("p",{className:"text-sm text-gray-500 mt-3",children:"ang ti d liu..."})]}):s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-3",children:[s.jsx(Cn,{className:"w-4 h-4"}),"Thng tin c bn"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tn vt t ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{ref:n,type:"text",value:a.name,onChange:L=>z("name",L.target.value),placeholder:"VD: Xi mng PCB40 Holcim",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhm vt t ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:a.category_id,onChange:L=>z("category_id",L.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"-- Chn nhm --"}),d.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loi vt t"}),s.jsxs("select",{value:a.type_id,onChange:L=>z("type_id",L.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"-- Chn loi --"}),y.map(L=>s.jsx("option",{value:L.id,children:L.name},L.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"n v tnh"}),s.jsxs("select",{value:a.unit_id,onChange:L=>z("unit_id",L.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"-- Chn n v --"}),m.map(L=>s.jsxs("option",{value:L.id,children:[L.name,L.symbol?` (${L.symbol})`:""]},L.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NCC u tin"}),s.jsxs("select",{value:a.preferred_supplier_id||"",onChange:L=>z("preferred_supplier_id",L.target.value),className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[s.jsx("option",{value:"",children:"-- Chn NCC --"}),v.map(L=>s.jsxs("option",{value:L.id,children:[L.code," - ",L.short_name||L.name]},L.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quy cch / Thng s k thut"}),s.jsx("input",{type:"text",value:a.specifications||"",onChange:L=>z("specifications",L.target.value),placeholder:"VD: Bao 50kg, sn xut ti VN",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thng hiu"}),s.jsx("input",{type:"text",value:a.brand||"",onChange:L=>z("brand",L.target.value),placeholder:"VD: Holcim, Ha Pht...",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xut x"}),s.jsx("input",{type:"text",value:a.origin||"",onChange:L=>z("origin",L.target.value),placeholder:"VD: Vit Nam, Nht Bn...",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),s.jsx("textarea",{value:a.description||"",onChange:L=>z("description",L.target.value),rows:2,placeholder:"M t chi tit v vt t...",className:"w-full px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none"})]})]})]}),s.jsxs("div",{children:[s.jsxs("button",{type:"button",onClick:()=>H(!U),className:"flex items-center gap-2 text-sm font-medium text-gray-500 hover:text-gray-700 transition-colors",children:[s.jsx("span",{className:`transform transition-transform ${U?"rotate-90":""}`,children:""}),"Tn kho & Gi",!U&&s.jsx("span",{className:"text-xs text-gray-400",children:"(ty chn)"})]}),U&&s.jsxs("div",{className:"mt-3 space-y-4 pl-1",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn kho ti thiu"}),s.jsx("input",{type:"number",value:a.min_stock||"",onChange:L=>z("min_stock",parseFloat(L.target.value)||0),min:0,placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Tn kho hin ti"}),s.jsx("input",{type:"number",value:a.current_stock||"",onChange:L=>z("current_stock",parseFloat(L.target.value)||0),min:0,placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Gi mua gn nht"}),s.jsx("input",{type:"number",value:a.last_purchase_price||"",onChange:L=>z("last_purchase_price",parseFloat(L.target.value)||0),min:0,placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Gi tham kho (VN)"}),s.jsx("input",{type:"number",value:a.reference_price||"",onChange:L=>z("reference_price",parseFloat(L.target.value)||0),min:0,placeholder:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none"})]})]})]}),T&&s.jsxs("div",{className:"flex items-start gap-2 bg-red-50 border border-red-200 rounded-lg px-3 py-2.5",children:[s.jsx(Cr,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-sm text-red-700",children:T})]})]})}),!P&&s.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-100 bg-gray-50/50 rounded-b-2xl flex-shrink-0",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"M to ra: "}),s.jsx("span",{className:"font-mono font-semibold text-blue-700",children:u?"...":o})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:t,disabled:_,className:"px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Hy"}),s.jsx("button",{onClick:O,disabled:_||!a.name.trim()||!a.category_id,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 shadow-sm",children:_?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang to..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),"To vt t"]})})]})]})]})]})}function TB(){return`temp_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}function E4(){return{_tempId:TB(),supplier_id:"",material_code:"",material_name:"",specifications:"",unit:"",quantity:0,unit_price:0,vat_rate:10,amount:0,vat_amount:0,total_amount:0,notes:""}}function PB(e){const{amount:r,vat_amount:t,total_amount:n}=hv(e.quantity,e.unit_price,e.vat_rate);return{...e,amount:r,vat_amount:t,total_amount:n}}function $we({item:e,materials:r,onSelect:t,onClear:n,onQuickAdd:a}){const[i,o]=R.useState(!1),[c,u]=R.useState(""),l=R.useRef(null),d=R.useRef(null),[f,p]=R.useState({}),h=!!(e.material_id&&e.material_name),y=R.useMemo(()=>{const B=c.toLowerCase().trim();return B?r.filter(T=>T.name.toLowerCase().includes(B)||T.code.toLowerCase().includes(B)||(T.specifications||"").toLowerCase().includes(B)||(T.category_name||"").toLowerCase().includes(B)).slice(0,40):r.slice(0,50)},[r,c]),g=R.useCallback(()=>{if(!d.current)return;const B=d.current.getBoundingClientRect(),T=window.innerHeight-B.bottom-16,I=B.top-16,U=Math.min(380,Math.max(T,I)),H=T<200&&I>T;p({position:"fixed",left:Math.max(8,B.left),width:Math.max(B.width,380),maxHeight:U,zIndex:9999,...H?{bottom:window.innerHeight-B.top+4}:{top:B.bottom+4}})},[]),m=R.useCallback(()=>{g(),o(!0)},[g]),x=R.useCallback(()=>{o(!1),u("")},[]),v=R.useCallback(B=>{t(B),x()},[t,x]),w=R.useCallback(B=>{B.stopPropagation(),n(),u(""),setTimeout(()=>l.current?.focus(),50)},[n]),_=R.useCallback(()=>{const B=c.trim();x(),a(B)},[c,x,a]);R.useEffect(()=>{if(!i)return;const B=T=>{T.key==="Escape"&&x()};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[i,x]);const A=B=>B.last_purchase_price||B.reference_price||0,P=B=>B.unit?.name||B.unit_name||"";return h?s.jsxs("div",{ref:d,className:"flex items-center gap-2 px-2.5 py-2 bg-blue-50 border border-blue-200 rounded-lg cursor-default group/mat",children:[s.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded flex items-center justify-center flex-shrink-0",children:s.jsx($i,{className:"w-3.5 h-3.5 text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.material_name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[s.jsx("span",{className:"font-mono text-gray-400",children:e.material_code}),e.unit&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-1 text-gray-300",children:""}),e.unit]}),e.specifications&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-1 text-gray-300",children:""}),s.jsx("span",{className:"text-gray-400",children:e.specifications})]})]})]}),s.jsx("button",{type:"button",onClick:w,className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors opacity-0 group-hover/mat:opacity-100",title:"i vt t",children:s.jsx(Vr,{className:"w-3.5 h-3.5"})})]}):s.jsxs("div",{ref:d,className:"relative",children:[s.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-2 border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 transition-all bg-white",children:[s.jsx(ii,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),s.jsx("input",{ref:l,type:"text",value:c,onChange:B=>{u(B.target.value),i||m()},onFocus:m,placeholder:"Tm vt t theo tn, m...",className:"flex-1 text-sm outline-none bg-transparent placeholder:text-gray-400 min-w-0"}),c&&s.jsx("button",{type:"button",onClick:()=>u(""),className:"p-0.5 text-gray-300 hover:text-gray-500 transition-colors",children:s.jsx(Br,{className:"w-3.5 h-3.5"})})]}),i&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:x}),s.jsxs("div",{style:f,className:"bg-white border border-gray-200 rounded-xl shadow-xl overflow-hidden flex flex-col",children:[!c&&s.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-100",children:s.jsxs("p",{className:"text-xs text-gray-500",children:[" G  tm kim trong ",r.length," vt t"]})}),s.jsx("div",{className:"flex-1 overflow-y-auto overscroll-contain",children:y.length===0?s.jsxs("div",{className:"px-4 py-8 text-center",children:[s.jsx(Cn,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Khng tm thy vt t"," ",c&&s.jsxs("span",{className:"font-medium",children:['"',c,'"']})]}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Bn c th to vt t mi bn di"})]}):y.map(B=>{const T=P(B),I=A(B);return s.jsxs("button",{type:"button",onClick:()=>v(B),className:"w-full px-3 py-2.5 text-left hover:bg-blue-50 flex items-center gap-2.5 border-b border-gray-50 last:border-b-0 transition-colors group/item",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0 group-hover/item:bg-blue-100 transition-colors",children:s.jsx(Cn,{className:"w-4 h-4 text-gray-400 group-hover/item:text-blue-500"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:c?qwe(B.name,c):B.name}),s.jsxs("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:[s.jsx("span",{className:"font-mono text-gray-400",children:B.code}),T&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-1 text-gray-300",children:""}),T]}),B.specifications&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"mx-1 text-gray-300",children:""}),s.jsx("span",{className:"text-gray-400",children:B.specifications})]})]})]}),I>0&&s.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0 font-medium tabular-nums",children:ba(I)})]},B.id)})}),s.jsxs("div",{className:"border-t border-gray-200 bg-gray-50/80",children:[y.length>0&&c&&s.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-400 border-b border-gray-100",children:["Tm thy ",y.length,y.length>=40?"+":""," kt qu"]}),s.jsxs("button",{type:"button",onClick:_,className:"w-full px-3 py-2.5 text-left flex items-center gap-2.5 text-emerald-700 hover:bg-emerald-50 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:s.jsx(hW,{className:"w-4 h-4 text-emerald-600"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"text-sm font-medium",children:"To vt t mi"}),c&&s.jsxs("p",{className:"text-xs text-emerald-600/70 truncate",children:['vi tn "',c,'"']})]})]})]})]})]})]})}function qwe(e,r){if(!r)return e;const t=e.toLowerCase().indexOf(r.toLowerCase());return t===-1?e:s.jsxs(s.Fragment,{children:[e.slice(0,t),s.jsx("span",{className:"bg-yellow-100 text-yellow-800 rounded-sm px-0.5",children:e.slice(t,t+r.length)}),e.slice(t+r.length)]})}function zwe({item:e,index:r,suppliers:t,materials:n,onChange:a,onRemove:i,onSelectMaterial:o,onClearMaterial:c,onQuickAdd:u}){const l=(d,f)=>{const p={...e,[d]:f};["quantity","unit_price","vat_rate"].includes(d)?a(PB(p)):a(p)};return s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50/30 group",children:[s.jsx("td",{className:"px-3 py-3 text-center text-sm text-gray-400 font-medium w-12 align-top pt-5",children:r+1}),s.jsx("td",{className:"px-3 py-3 min-w-[260px] align-top",children:s.jsx($we,{item:e,materials:n,onSelect:o,onClear:c,onQuickAdd:u})}),s.jsx("td",{className:"px-3 py-3 min-w-[180px] align-top",children:s.jsxs("select",{value:e.supplier_id,onChange:d=>{const f=t.find(p=>p.id===d.target.value);f?a({...e,supplier_id:f.id,supplier_code:f.code,supplier_name:f.name}):l("supplier_id","")},className:`w-full px-2.5 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors ${e.supplier_id?"border-gray-300 text-gray-900":"border-gray-300 text-gray-400"}`,children:[s.jsx("option",{value:"",children:"Chn NCC *"}),t.map(d=>s.jsxs("option",{value:d.id,children:[d.code," - ",d.short_name||d.name]},d.id))]})}),s.jsx("td",{className:"px-3 py-3 w-28 align-top",children:s.jsx("input",{type:"number",value:e.quantity||"",onChange:d=>l("quantity",parseFloat(d.target.value)||0),min:0,step:"any",placeholder:"0",className:"w-full px-2.5 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none transition-colors tabular-nums"})}),s.jsxs("td",{className:"px-3 py-3 w-32 align-top",children:[s.jsx("input",{type:"number",value:e.unit_price||"",onChange:d=>l("unit_price",parseFloat(d.target.value)||0),min:0,step:"any",placeholder:"0",className:"w-full px-2.5 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none transition-colors tabular-nums"}),e.material_id&&e.unit_price>0&&e.unit&&s.jsxs("p",{className:"text-[10px] text-gray-400 text-right mt-0.5 tabular-nums",children:["/",e.unit]})]}),s.jsx("td",{className:"px-3 py-3 w-20 align-top",children:s.jsx("input",{type:"number",value:e.vat_rate,onChange:d=>l("vat_rate",parseFloat(d.target.value)||0),min:0,max:100,step:.5,className:"w-full px-2.5 py-2 border border-gray-300 rounded-lg text-sm text-right focus:ring-2 focus:ring-blue-500 outline-none transition-colors tabular-nums"})}),s.jsx("td",{className:"px-3 py-3 w-36 text-right align-top pt-5",children:e.total_amount>0?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 tabular-nums",children:ba(e.total_amount)}),e.vat_amount>0&&s.jsxs("p",{className:"text-[10px] text-gray-400 mt-0.5 tabular-nums",children:["VAT: ",ba(e.vat_amount)]})]}):s.jsx("span",{className:"text-sm text-gray-300",children:""})}),s.jsx("td",{className:"px-3 py-3 w-12 text-center align-top pt-4",children:s.jsx("button",{type:"button",onClick:i,className:"p-1.5 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",title:"Xa dng",children:s.jsx(En,{className:"w-4 h-4"})})})]})}function Uwe({items:e,suppliers:r,materials:t,onChange:n,onMaterialCreated:a}){const[i,o]=R.useState({show:!1,rowIndex:null,initialName:""}),c=(m,x)=>{const v=e.map((w,_)=>_===m?x:w);n(v)},u=()=>{n([...e,E4()])},l=m=>{e.length<=1?n([E4()]):n(e.filter((x,v)=>v!==m))},d=(m,x)=>{const v=e.map((w,_)=>{if(_!==m)return w;const A=x.unit?.name||x.unit_name||w.unit,P=x.last_purchase_price||x.reference_price||w.unit_price,B={...w,material_id:x.id,material_code:x.code,material_name:x.name,unit:A||"",specifications:x.specifications||"",unit_price:P||0};return PB(B)});n(v)},f=m=>{const x=e.map((v,w)=>w!==m?v:{...v,material_id:void 0,material_code:"",material_name:"",unit:"",specifications:""});n(x)},p=(m,x)=>{o({show:!0,rowIndex:m,initialName:x})},h=m=>{const x={id:m.id,code:m.code,name:m.name,unit_name:m.unit_name,specifications:m.specifications,reference_price:m.reference_price,unit:m.unit};i.rowIndex!==null&&d(i.rowIndex,x),a?.(x),o({show:!1,rowIndex:null,initialName:""})},y=()=>{o({show:!1,rowIndex:null,initialName:""})},g=e.filter(m=>m.material_name&&m.supplier_id).length;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-100",children:[s.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(jl,{className:"w-5 h-5 text-orange-500"}),"Danh sch vt t",s.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",g," mc)"]})]}),s.jsxs("button",{type:"button",onClick:u,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm dng"]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50/80 border-b border-gray-200",children:[s.jsx("th",{className:"px-3 py-2.5 text-center text-xs font-semibold text-gray-500 uppercase w-12",children:"#"}),s.jsx("th",{className:"px-3 py-2.5 text-left text-xs font-semibold text-gray-500 uppercase min-w-[260px]",children:"Vt t"}),s.jsx("th",{className:"px-3 py-2.5 text-left text-xs font-semibold text-gray-500 uppercase min-w-[180px]",children:"NCC"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-gray-500 uppercase w-28",children:"S lng"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-gray-500 uppercase w-32",children:"n gi"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-gray-500 uppercase w-20",children:"VAT %"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-gray-500 uppercase w-36",children:"Thnh tin"}),s.jsx("th",{className:"px-3 py-2.5 w-12"})]})}),s.jsx("tbody",{children:e.map((m,x)=>s.jsx(zwe,{item:m,index:x,suppliers:r,materials:t,onChange:v=>c(x,v),onRemove:()=>l(x),onSelectMaterial:v=>d(x,v),onClearMaterial:()=>f(x),onQuickAdd:v=>p(x,v)},m._tempId))})]})}),s.jsx("div",{className:"px-5 py-3 border-t border-gray-100",children:s.jsxs("button",{type:"button",onClick:u,className:"flex items-center gap-1.5 text-sm text-gray-500 hover:text-blue-600 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm dng vt t"]})})]}),i.show&&s.jsx(Bwe,{initialName:i.initialName,onSave:h,onClose:y})]})}function Hwe({items:e,suppliers:r}){const t=e.filter(a=>a.supplier_id&&a.total_amount>0);if(t.length===0)return null;const n=Wwe(t,r);return s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[s.jsx($r,{className:"w-4 h-4"}),"Tng hp theo NCC (",n.length," nh cung cp)"]}),s.jsx("div",{className:"space-y-2",children:n.map(a=>s.jsxs("div",{className:"flex items-center justify-between text-sm bg-white rounded-lg px-3 py-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-900",children:a.supplier.name}),s.jsxs("span",{className:"text-gray-400 ml-2",children:["(",a.supplier.code,")"]}),s.jsxs("span",{className:"text-gray-400 ml-2",children:[" ",a.items.length," vt t"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"font-semibold text-gray-900",children:ba(a.total)}),a.vat>0&&s.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(VAT: ",ba(a.vat),")"]})]})]},a.supplier.id))})]})}function Vwe({items:e,grandTotal:r}){const t=e.reduce((n,a)=>{const i=a.supplier_id;return n[i]||(n[i]={supplier:a.supplier||{id:i,name:"N/A",code:""},items:[],subtotal:0,vat:0,total:0}),n[i].items.push(a),n[i].subtotal+=a.amount,n[i].vat+=a.vat_amount,n[i].total+=a.total_amount,n},{});return Object.keys(t).length===0?s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx(Cn,{className:"w-10 h-10 mx-auto mb-2"}),s.jsx("p",{children:"Cha c vt t no"})]}):s.jsxs("div",{className:"space-y-6",children:[Object.entries(t).map(([n,a])=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx($r,{className:"w-4 h-4 text-blue-500"}),a.supplier?.name||"N/A",s.jsxs("span",{className:"text-xs font-normal text-gray-400",children:["(",a.supplier?.code,")  ",a.items.length," vt t"]})]}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:ba(a.total)})]}),s.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 w-10",children:"#"}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"M"}),s.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Tn vt t"}),s.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 w-16",children:"VT"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 w-24",children:"SL"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 w-28",children:"n gi"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 w-16",children:"VAT%"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 w-32",children:"Thnh tin"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:a.items.map((i,o)=>s.jsxs("tr",{className:"hover:bg-gray-50/50",children:[s.jsx("td",{className:"px-3 py-2.5 text-center text-xs text-gray-400",children:o+1}),s.jsx("td",{className:"px-3 py-2.5 text-xs text-gray-500",children:i.material_code||""}),s.jsxs("td",{className:"px-3 py-2.5",children:[s.jsx("p",{className:"text-sm text-gray-900",children:i.material_name}),i.specifications&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:i.specifications})]}),s.jsx("td",{className:"px-3 py-2.5 text-center text-xs text-gray-500",children:i.unit}),s.jsx("td",{className:"px-3 py-2.5 text-right text-sm text-gray-900",children:i.quantity.toLocaleString("vi-VN")}),s.jsx("td",{className:"px-3 py-2.5 text-right text-sm text-gray-900",children:ba(i.unit_price)}),s.jsxs("td",{className:"px-3 py-2.5 text-right text-xs text-gray-500",children:[i.vat_rate,"%"]}),s.jsxs("td",{className:"px-3 py-2.5 text-right",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:ba(i.total_amount)}),i.vat_amount>0&&s.jsxs("p",{className:"text-xs text-gray-400",children:["VAT: ",ba(i.vat_amount)]})]})]},i.id))}),s.jsxs("tfoot",{children:[s.jsxs("tr",{className:"bg-gray-50 border-t border-gray-200",children:[s.jsx("td",{colSpan:5}),s.jsx("td",{className:"px-3 py-2 text-right text-xs text-gray-500",children:"Tin hng:"}),s.jsx("td",{colSpan:2,className:"px-3 py-2 text-right text-sm font-medium text-gray-900",children:ba(a.subtotal)})]}),s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("td",{colSpan:5}),s.jsx("td",{className:"px-3 py-1 text-right text-xs text-gray-500",children:"VAT:"}),s.jsx("td",{colSpan:2,className:"px-3 py-1 text-right text-sm text-gray-600",children:ba(a.vat)})]}),s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("td",{colSpan:5}),s.jsx("td",{className:"px-3 py-2 text-right text-xs font-medium text-gray-700",children:"Tng:"}),s.jsx("td",{colSpan:2,className:"px-3 py-2 text-right text-sm font-bold text-blue-600",children:ba(a.total)})]})]})]})})]},n)),Object.keys(t).length>1&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-semibold text-blue-800",children:["Tng cng (",Object.keys(t).length," NCC, ",e.length," vt t)"]}),s.jsx("span",{className:"text-lg font-bold text-blue-700",children:ba(r)})]})]})}function Wwe(e,r){const t=new Map;for(const n of e){const a=n.supplier_id;if(!t.has(a)){const o=r.find(c=>c.id===a);t.set(a,{supplier:{id:a,name:o?.short_name||o?.name||n.supplier_name||"N/A",code:o?.code||n.supplier_code||""},items:[],subtotal:0,vat:0,total:0})}const i=t.get(a);i.items.push(n),i.subtotal+=n.amount,i.vat+=n.vat_amount,i.total+=n.total_amount}return Array.from(t.values())}function Kwe({totalAmount:e,vatAmount:r,grandTotal:t,validItemCount:n,supplierCount:a}){return s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-5",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Tng cng n hng"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Tin hng:"}),s.jsx("span",{className:"font-medium text-gray-900",children:ba(e)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-500",children:"Thu VAT:"}),s.jsx("span",{className:"font-medium text-gray-900",children:ba(r)})]}),s.jsxs("div",{className:"border-t pt-3 flex justify-between",children:[s.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Tng cng:"}),s.jsx("span",{className:"text-lg font-bold text-blue-600",children:ba(t)})]}),s.jsxs("p",{className:"text-xs text-gray-400 pt-1",children:[n," vt t hp l t ",a," nh cung cp"]})]})]})}function fP(){const e=ts(),{id:r}=_h(),{user:t}=xn(),n=!!r,[a,i]=R.useState(n),[o,c]=R.useState(!1),[u,l]=R.useState(null),[d,f]=R.useState({order_date:new Date().toISOString().split("T")[0],project_name:"",project_code:"",expected_delivery_date:"",delivery_address:"",delivery_notes:"",requester_id:t?.employee_id||"",department_id:t?.department_id||"",notes:"",internal_notes:""}),[p,h]=R.useState([E4()]),[y,g]=R.useState(null),[m,x]=R.useState(""),[v,w]=R.useState([]),[_,A]=R.useState([]),[P,B]=R.useState([]),[T,I]=R.useState([]),[U,H]=R.useState(!1),[z,O]=R.useState(!1);R.useEffect(()=>{(async()=>{try{const D=await zi.getAllActive();w(D);const{data:q}=await uc.getAll({page:1,pageSize:200,status:"active"});A(q||[]);const{data:M}=await _s.getAll({page:1,pageSize:200,status:"active"});B(M||[]);const{data:G}=await xo.getAll({page:1,pageSize:500,status:"active"});I(G||[])}catch(D){console.error("Li ti d liu dropdown:",D)}})()},[]),R.useEffect(()=>{if(!r)return;(async()=>{i(!0);try{const D=await ca.getById(r);if(!D){l("Khng tm thy n hng");return}if(!["draft","rejected"].includes(D.status)){l(`Khng th sa n hng  trng thi "${ec[D.status]}"`);return}x(D.order_code),g(D.id),f({order_date:D.order_date,project_name:D.project_name||"",project_code:D.project_code||"",expected_delivery_date:D.expected_delivery_date||"",delivery_address:D.delivery_address||"",delivery_notes:D.delivery_notes||"",requester_id:D.requester_id||"",department_id:D.department_id||"",notes:D.notes||"",internal_notes:D.internal_notes||""});const q=await ca.getItems(r);q.length>0&&h(q.map(M=>({_tempId:TB(),id:M.id,material_id:M.material_id||void 0,supplier_id:M.supplier_id,material_code:M.material_code||"",material_name:M.material_name,specifications:M.specifications||"",unit:M.unit,quantity:M.quantity,unit_price:M.unit_price,vat_rate:M.vat_rate,amount:M.amount,vat_amount:M.vat_amount,total_amount:M.total_amount,notes:M.notes||"",supplier_name:M.supplier?.name,supplier_code:M.supplier?.code}))),(D.expected_delivery_date||D.delivery_address)&&O(!0),(D.notes||D.internal_notes)&&H(!0)}catch(D){l(D.message||"Li ti n hng")}finally{i(!1)}})()},[r]);const L=p.filter(C=>C.material_name&&C.supplier_id&&C.quantity>0&&C.unit_price>0),E={total_amount:L.reduce((C,D)=>C+D.amount,0),vat_amount:L.reduce((C,D)=>C+D.vat_amount,0),grand_total:L.reduce((C,D)=>C+D.total_amount,0)},k=new Set(L.map(C=>C.supplier_id)).size,N=()=>d.order_date?p.some(q=>q.material_name&&q.supplier_id&&q.quantity>0&&q.unit_price>0&&q.unit)?p.filter(q=>q.material_name&&!q.supplier_id).length>0?"Vui lng chn NCC cho tt c vt t":null:"Cn t nht 1 dng vt t hp l (tn, NCC, SL, n gi, VT)":"Vui lng chn ngy n hng",S=async()=>{const C=N();if(C){l(C);return}c(!0),l(null);try{const D=t?.employee_id;if(!D)throw new Error("Khng xc nh c ngi dng");let q;n&&y?(await ca.update(y,d,D),q=y,await ca.removeAllItems(q)):q=(await ca.create(d,D)).id;const M=p.filter(G=>G.material_name&&G.supplier_id&&G.quantity>0&&G.unit_price>0).map((G,X)=>({material_id:G.material_id,supplier_id:G.supplier_id,material_code:G.material_code,material_name:G.material_name,specifications:G.specifications,unit:G.unit,quantity:G.quantity,unit_price:G.unit_price,vat_rate:G.vat_rate,notes:G.notes,sort_order:X+1}));M.length>0&&await ca.addItems(q,M),e(`/purchasing/orders/${q}`,{state:{message:n?"Cp nht n hng thnh cng!":"To n hng thnh cng!"}})}catch(D){l(D.message||"Li lu n hng")}finally{c(!1)}};return a?s.jsx("div",{className:"p-6 flex items-center justify-center min-h-[400px]",children:s.jsx(Mt,{className:"w-8 h-8 text-blue-500 animate-spin"})}):s.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:()=>e("/purchasing/orders"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n?`Sa n hng ${m}`:"To n hng mi"}),s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:n?"Chnh sa thng tin v chi tit n hng":"Nhp thng tin v thm vt t cn mua"})]})]}),s.jsx("button",{onClick:S,disabled:o,className:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors shadow-sm",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"})," ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"})," Lu n hng"]})})]}),u&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg px-4 py-3 flex items-start gap-3",children:[s.jsx(Cr,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),s.jsx("p",{className:"text-sm text-red-700 flex-1",children:u}),s.jsx("button",{onClick:()=>l(null),className:"text-red-400 hover:text-red-600",children:s.jsx(Br,{className:"w-4 h-4"})})]}),s.jsx(Fwe,{formData:d,departments:v,employees:_,onChange:(C,D)=>f(q=>({...q,[C]:D})),defaultShowDelivery:z}),s.jsx(Uwe,{items:p,suppliers:P,materials:T,onChange:h,onMaterialCreated:C=>I(D=>[C,...D])}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Hwe,{items:p,suppliers:P}),s.jsx(Kwe,{totalAmount:E.total_amount,vatAmount:E.vat_amount,grandTotal:E.grand_total,validItemCount:L.length,supplierCount:k})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[s.jsxs("button",{type:"button",onClick:()=>H(!U),className:"w-full flex items-center justify-between px-5 py-4 hover:bg-gray-50 transition-colors rounded-t-xl",children:[s.jsxs("h2",{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(vr,{className:"w-5 h-5 text-gray-400"})," Ghi ch"]}),U?s.jsx(si,{className:"w-5 h-5 text-gray-400"}):s.jsx(Gs,{className:"w-5 h-5 text-gray-400"})]}),U&&s.jsx("div",{className:"px-5 pb-5 border-t border-gray-100",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch (cho NCC)"}),s.jsx("textarea",{value:d.notes,onChange:C=>f(D=>({...D,notes:C.target.value})),rows:3,placeholder:"Ghi ch gi km cho nh cung cp...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch ni b"}),s.jsx("textarea",{value:d.internal_notes,onChange:C=>f(D=>({...D,internal_notes:C.target.value})),rows:3,placeholder:"Ghi ch ni b, ch hin th trong h thng...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-none"})]})]})})]}),s.jsxs("div",{className:"flex items-center justify-between bg-white rounded-xl border border-gray-200 shadow-sm px-5 py-4 sticky bottom-4",children:[s.jsx("button",{onClick:()=>e("/purchasing/orders"),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:"Hy b"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right mr-4",children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Tng cng"}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:ba(E.grand_total)})]}),s.jsx("button",{onClick:S,disabled:o,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors shadow-sm font-medium",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"})," ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"})," ",n?"Cp nht n hng":"To n hng"]})})]})]})]})}const Gwe={draft:"Nhp",confirmed:" xc nhn",partial:"ang giao",completed:"Hon thnh",cancelled:" hy"},Xwe={draft:vr,confirmed:Un,partial:Cn,completed:rW,cancelled:nu},Ywe={draft:"bg-gray-100 text-gray-700 border-gray-300",confirmed:"bg-blue-50 text-blue-700 border-blue-300",partial:"bg-orange-50 text-orange-700 border-orange-300",completed:"bg-green-50 text-green-700 border-green-300",cancelled:"bg-gray-50 text-gray-500 border-gray-300"};function Qwe({status:e,size:r="sm"}){const t=Xwe[e]||vr,n=Gwe[e]||e,a=Ywe[e]||"bg-gray-100 text-gray-700 border-gray-300",i={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-xs",lg:"px-3 py-1.5 text-sm"},o={sm:"w-3 h-3",md:"w-3.5 h-3.5",lg:"w-4 h-4"};return s.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full font-semibold border ${a} ${i[r]}`,children:[s.jsx(t,{className:o[r]}),n]})}const pP={blue:"bg-blue-500",green:"bg-green-500",orange:"bg-orange-500",red:"bg-red-500"};function mP({value:e,label:r,color:t="blue",showLabel:n=!0}){const a=pP[t]||pP.blue;return s.jsxs("div",{children:[n&&s.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[s.jsx("span",{className:"text-gray-500",children:r}),s.jsxs("span",{className:"font-medium text-gray-700",children:[e,"%"]})]}),s.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all ${a}`,style:{width:`${Math.min(e,100)}%`}})})]})}function Zwe({order:e,onEdit:r}){const t=e.approval_number||e.approval_date||e.approved_by_name,n=e.approval_documents&&e.approval_documents.length>0,a=e.status!=="cancelled";return!t&&!n?s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qc,{className:"w-5 h-5 text-amber-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-sm font-medium text-amber-800",children:"Cha c thng tin ph duyt"}),s.jsx("p",{className:"text-xs text-amber-600 mt-0.5",children:" xut mua hng cn c ph duyt qua h thng bn ngoi. Vui lng cp nht thng tin v upload file bng chng khi c."})]}),a&&r&&s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-xs font-medium text-amber-700 bg-amber-100 border border-amber-300 rounded-lg hover:bg-amber-200 transition-colors flex-shrink-0",children:"+ Thm"})]})}):s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between",children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Qc,{className:"w-4 h-4 text-green-600"}),"Thng tin ph duyt"]}),a&&r&&s.jsx("button",{onClick:r,className:"px-2.5 py-1 text-xs font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors",children:"Sa"})]}),s.jsxs("div",{className:"p-4 space-y-3",children:[t&&s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.approval_number&&s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500",children:"S  xut"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.approval_number})]}),e.approval_date&&s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Ngy duyt"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(e.approval_date).toLocaleDateString("vi-VN")})]}),e.approved_by_name&&s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Ngi duyt"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.approved_by_name})]})]}),n&&s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-gray-500 block mb-2",children:"File nh km"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.approval_documents.map((i,o)=>{const u=/\.(jpg|jpeg|png|gif|webp)$/i.test(i.name||"")?bO:vr;return s.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg hover:bg-gray-100 transition-colors group",children:[s.jsx(u,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-500"}),s.jsx("span",{className:"text-xs text-gray-700 max-w-[150px] truncate",children:i.name||`File ${o+1}`}),s.jsx(ja,{className:"w-3.5 h-3.5 text-gray-300 group-hover:text-blue-500"})]},o)})})]})]})]})}function Jwe({order:e}){return e.status!=="cancelled"||!e.cancellation_reason?null:s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(nu,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-red-800",children:"n hng  b hy"}),s.jsxs("p",{className:"text-sm text-red-700 mt-1",children:[s.jsx("strong",{children:"L do:"})," ",e.cancellation_reason]}),e.cancelled_by_name&&s.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["Hy bi: ",e.cancelled_by_name,e.cancelled_at&&`  ${new Date(e.cancelled_at).toLocaleString("vi-VN")}`]})]})]})})}function e_e({order:e,onEditApproval:r}){const t=e.invoice_progress??0,n=e.payment_progress??0;return s.jsxs("div",{className:"space-y-4",children:[s.jsx(Jwe,{order:e}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[s.jsx(dn,{className:"w-3.5 h-3.5"}),"Ngy n hng"]}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:new Date(e.order_date||e.created_at).toLocaleDateString("vi-VN")}),e.expected_delivery_date&&s.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Giao: ",new Date(e.expected_delivery_date).toLocaleDateString("vi-VN")]})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[s.jsx($r,{className:"w-3.5 h-3.5"}),"Phng ban / Ngi yu cu"]}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:e.department?.name||"-"}),e.requester?.full_name&&s.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:e.requester.full_name})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[s.jsx(jl,{className:"w-3.5 h-3.5"}),"Tng tin"]}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:ba(e.grand_total)})]}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 space-y-2",children:[s.jsx(mP,{value:t,label:"Ha n",color:"blue"}),s.jsx(mP,{value:n,label:"Thanh ton",color:"green"})]})]}),e.confirmed_by&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-center gap-3",children:[s.jsx(Un,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),s.jsxs("p",{className:"text-sm text-blue-700",children:[s.jsx("strong",{children:"Xc nhn bi:"})," ",e.confirmed_by_name||e.confirmed_by,e.confirmed_at&&`  ${new Date(e.confirmed_at).toLocaleString("vi-VN")}`]})]}),s.jsx(Zwe,{order:e,onEdit:r}),(e.delivery_address||e.delivery_notes)&&s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsxs("h4",{className:"text-xs font-medium text-gray-500 mb-2 flex items-center gap-1.5",children:[s.jsx(dc,{className:"w-3.5 h-3.5"}),"Thng tin giao hng"]}),e.delivery_address&&s.jsx("p",{className:"text-sm text-gray-900",children:e.delivery_address}),e.delivery_notes&&s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.delivery_notes})]}),(e.notes||e.internal_notes)&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.notes&&s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[s.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-1",children:"Ghi ch (cho NCC)"}),s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.notes})]}),e.internal_notes&&s.jsxs("div",{className:"bg-yellow-50 rounded-lg border border-yellow-200 p-4",children:[s.jsx("h4",{className:"text-xs font-medium text-yellow-600 mb-1",children:"Ghi ch ni b"}),s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:e.internal_notes})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 pt-2",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ls,{className:"w-3.5 h-3.5"}),"To bi: ",e.creator?.full_name||"-"]}),s.jsxs("span",{children:["Cp nht: ",new Date(e.updated_at).toLocaleString("vi-VN")]})]})]})}function t_e({items:e,grandTotal:r}){return e.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx(Cn,{className:"w-10 h-10 mx-auto mb-2"}),s.jsx("p",{children:"Cha c vt t no"})]}):s.jsx(Vwe,{items:e,grandTotal:r})}const r_e={created:vr,updated:sd,confirmed:Un,status_changed:CO,items_updated:Cn,cancelled:nu,invoice_added:hc,payment_added:lc},n_e={created:"bg-blue-100 text-blue-600",updated:"bg-gray-100 text-gray-600",confirmed:"bg-green-100 text-green-600",status_changed:"bg-purple-100 text-purple-600",items_updated:"bg-indigo-100 text-indigo-600",cancelled:"bg-red-100 text-red-600",invoice_added:"bg-orange-100 text-orange-600",payment_added:"bg-teal-100 text-teal-600"};function s_e({history:e}){return e.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx(vr,{className:"w-10 h-10 mx-auto mb-2"}),s.jsx("p",{children:"Cha c lch s"})]}):s.jsx("div",{className:"space-y-0",children:e.map((r,t)=>{const n=r_e[r.action]||vr,a=n_e[r.action]||"bg-gray-100 text-gray-500";return s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${a}`,children:s.jsx(n,{className:"w-4 h-4"})}),t<e.length-1&&s.jsx("div",{className:"w-px flex-1 bg-gray-200 my-1"})]}),s.jsxs("div",{className:"pb-4 flex-1",children:[s.jsx("p",{className:"text-sm text-gray-900",children:r.description||r.action}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[r.performer&&s.jsx("span",{className:"text-xs text-gray-500",children:r.performer.full_name}),s.jsx("span",{className:"text-xs text-gray-400",children:new Date(r.performed_at).toLocaleString("vi-VN")})]}),r.action==="cancelled"&&r.details?.reason&&s.jsxs("p",{className:"text-xs text-red-500 mt-1",children:["L do: ",r.details.reason]}),r.old_value&&r.new_value&&s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[typeof r.old_value=="string"?r.old_value:JSON.stringify(r.old_value),"  ",typeof r.new_value=="string"?r.new_value:JSON.stringify(r.new_value)]})]})]},r.id)})})}function _l(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}function T4(e){return new Date(e).toLocaleDateString("vi-VN")}function a_e(e){return new Date(e).toLocaleString("vi-VN")}const gP={pending:{label:"Ch TT",className:"bg-yellow-100 text-yellow-700",icon:Xr},partial:{label:"TT mt phn",className:"bg-orange-100 text-orange-700",icon:md},paid:{label:" TT ",className:"bg-green-100 text-green-700",icon:Un},cancelled:{label:" hy",className:"bg-gray-100 text-gray-500",icon:nu}};function i_e({status:e}){const r=gP[e]||gP.pending,t=r.icon;return s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${r.className}`,children:[s.jsx(t,{className:"w-3 h-3"}),r.label]})}const o_e={cash:"Tin mt",bank_transfer:"Chuyn khon"};function zg({value:e,color:r="blue",height:t="h-2"}){const n={blue:"bg-blue-500",green:"bg-green-500",orange:"bg-orange-500",red:"bg-red-500"};return s.jsx("div",{className:`w-full bg-gray-200 rounded-full ${t} overflow-hidden`,children:s.jsx("div",{className:`${t} rounded-full transition-all duration-500 ${n[r]}`,style:{width:`${Math.min(e,100)}%`}})})}function l_e({summary:e}){return s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(vr,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Tng n hng"})]}),s.jsx("p",{className:"text-lg font-bold text-gray-900",children:_l(e.grand_total)})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(hc,{className:"w-4 h-4 text-blue-500"}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Ha n (",e.invoice_count,")"]})]}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:_l(e.total_invoiced)}),s.jsx(zg,{value:e.invoice_progress,color:"blue",height:"h-1"}),s.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[e.invoice_progress,"%"]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(lc,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{className:"text-xs text-gray-500",children:" thanh ton"})]}),s.jsx("p",{className:"text-lg font-bold text-green-600",children:_l(e.total_paid)}),s.jsx(zg,{value:e.payment_progress,color:"green",height:"h-1"}),s.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[e.payment_progress,"%"]})]}),s.jsxs("div",{className:`border rounded-lg p-3 ${e.overdue_count>0?"bg-red-50 border-red-200":"bg-white border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.overdue_count>0?s.jsx(Kr,{className:"w-4 h-4 text-red-500"}):s.jsx(FV,{className:"w-4 h-4 text-orange-500"}),s.jsx("span",{className:"text-xs text-gray-500",children:e.overdue_count>0?`Qu hn (${e.overdue_count} H)`:"Cn phi tr"})]}),s.jsx("p",{className:`text-lg font-bold ${e.overdue_count>0?"text-red-600":"text-orange-600"}`,children:_l(e.total_remaining)})]})]})}function c_e({payment:e}){return s.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-green-50 rounded-lg text-sm",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(lc,{className:"w-3.5 h-3.5 text-green-600"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-green-700",children:_l(e.amount)}),s.jsx("span",{className:"text-gray-500 ml-2",children:o_e[e.payment_method]||e.payment_method}),e.reference_number&&s.jsxs("span",{className:"text-gray-400 ml-2",children:["#",e.reference_number]})]})]}),s.jsxs("div",{className:"text-right text-xs text-gray-500",children:[s.jsx("div",{children:T4(e.payment_date)}),e.created_by_name&&s.jsx("div",{children:e.created_by_name})]})]})}function u_e({invoice:e,onPayment:r,onViewDetail:t}){const[n,a]=R.useState(!1),i=e.total_amount>0?Math.round(e.paid_amount/e.total_amount*100):0;return s.jsxs("div",{className:`border rounded-lg overflow-hidden ${e.is_overdue?"border-red-300 bg-red-50/30":"border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>a(!n),children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(hc,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900",children:e.invoice_code}),e.invoice_number&&s.jsxs("span",{className:"text-xs text-gray-500",children:["(S H: ",e.invoice_number,")"]}),s.jsx(i_e,{status:e.status}),e.is_overdue&&s.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-red-600 font-medium",children:[s.jsx(Kr,{className:"w-3 h-3"}),"Qu hn ",e.days_overdue," ngy"]})]}),s.jsxs("div",{className:"flex items-center gap-3 mt-0.5 text-xs text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(dn,{className:"w-3 h-3"}),T4(e.invoice_date)]}),e.due_date&&s.jsxs("span",{children:["Hn TT: ",T4(e.due_date)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:_l(e.total_amount)}),s.jsxs("p",{className:"text-xs text-gray-500",children:[" TT: ",i,"%"]})]}),n?s.jsx(si,{className:"w-4 h-4 text-gray-400"}):s.jsx(Gs,{className:"w-4 h-4 text-gray-400"})]})]}),n&&s.jsxs("div",{className:"border-t border-gray-200 p-3 space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[s.jsxs("span",{children:[" TT: ",_l(e.paid_amount)]}),s.jsxs("span",{children:["Cn li: ",_l(e.remaining_amount)]})]}),s.jsx(zg,{value:i,color:e.status==="paid"?"green":"blue",height:"h-1.5"})]}),e.image_urls&&e.image_urls.length>0&&s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-medium text-gray-500 mb-1 flex items-center gap-1",children:[s.jsx(Kg,{className:"w-3 h-3"}),"nh ha n (",e.image_urls.length,")"]}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.image_urls.slice(0,4).map((o,c)=>s.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"w-16 h-16 rounded-lg border border-gray-200 overflow-hidden hover:border-blue-400 transition-colors",children:s.jsx("img",{src:o,alt:`H ${c+1}`,className:"w-full h-full object-cover"})},c)),e.image_urls.length>4&&s.jsxs("div",{className:"w-16 h-16 rounded-lg border border-gray-200 flex items-center justify-center text-xs text-gray-500",children:["+",e.image_urls.length-4]})]})]}),e.notes&&s.jsx("p",{className:"text-xs text-gray-500 italic",children:e.notes}),e.payments.length>0&&s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs font-medium text-gray-500 mb-1.5",children:["Lch s thanh ton (",e.payments.length,")"]}),s.jsx("div",{className:"space-y-1.5",children:e.payments.map(o=>s.jsx(c_e,{payment:o},o.id))})]}),s.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-3",children:[e.created_by_name&&s.jsxs("span",{children:["To bi: ",e.created_by_name]}),s.jsx("span",{children:a_e(e.created_at)})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-1 border-t border-gray-100",children:[s.jsxs("button",{onClick:o=>{o.stopPropagation(),t(e.id)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(ja,{className:"w-3.5 h-3.5"}),"Chi tit"]}),["pending","partial"].includes(e.status)&&s.jsxs("button",{onClick:o=>{o.stopPropagation(),r(e.id)},className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors",children:[s.jsx(lc,{className:"w-3.5 h-3.5"}),"Thanh ton"]})]})]})]})}function d_e({supplier:e,onAddInvoice:r,onPayment:t,onViewInvoice:n}){const[a,i]=R.useState(!1);return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>i(!a),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx($r,{className:"w-5 h-5 text-blue-500"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:e.supplier_name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[e.supplier_code,"  ",e.order_item_count," vt t "," ","n hng: ",_l(e.order_subtotal)]})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"hidden sm:flex items-center gap-3 text-xs",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-500",children:"Ha n"}),s.jsxs("p",{className:"font-semibold text-blue-600",children:[e.invoice_progress,"%"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-500",children:"Thanh ton"}),s.jsxs("p",{className:"font-semibold text-green-600",children:[e.payment_progress,"%"]})]}),e.remaining>0&&s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-500",children:"Cn n"}),s.jsx("p",{className:"font-semibold text-orange-600",children:_l(e.remaining)})]})]}),a?s.jsx(Gs,{className:"w-5 h-5 text-gray-400"}):s.jsx(si,{className:"w-5 h-5 text-gray-400"})]})]}),!a&&s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[s.jsx("span",{children:"Ha n"}),s.jsxs("span",{children:[e.invoice_progress,"% (",_l(e.total_invoiced),")"]})]}),s.jsx(zg,{value:e.invoice_progress,color:"blue",height:"h-1.5"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[s.jsx("span",{children:"Thanh ton"}),s.jsxs("span",{children:[e.payment_progress,"% (",_l(e.total_paid),")"]})]}),s.jsx(zg,{value:e.payment_progress,color:"green",height:"h-1.5"})]})]}),e.invoices.length>0?s.jsx("div",{className:"space-y-2",children:e.invoices.map(o=>s.jsx(u_e,{invoice:o,onPayment:t,onViewDetail:n},o.id))}):s.jsxs("div",{className:"text-center py-6 text-gray-400",children:[s.jsx(hc,{className:"w-8 h-8 mx-auto mb-2"}),s.jsx("p",{className:"text-sm",children:"Cha c ha n"})]}),s.jsxs("button",{onClick:()=>r(e.supplier_id),className:"w-full flex items-center justify-center gap-2 py-2.5 border-2 border-dashed border-gray-300 text-gray-500 hover:border-blue-400 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm ha n cho ",e.supplier_name]})]})]})}function h_e({orderId:e,orderStatus:r,onAddInvoice:t,onPayment:n,onViewInvoice:a,refreshKey:i=0}){const[o,c]=R.useState(null),[u,l]=R.useState([]),[d,f]=R.useState(!0),[p,h]=R.useState(null),y=R.useCallback(async()=>{f(!0),h(null);try{const[m,x]=await Promise.all([ca.getOrderInvoiceSummary(e),ca.getOrderInvoiceBreakdown(e)]);c(m),l(x)}catch(m){console.error(" [OrderInvoiceTab] loadData error:",m),h(m.message||"Li ti d liu")}finally{f(!1)}},[e]);R.useEffect(()=>{y()},[y,i]);const g=["confirmed","partial","completed"].includes(r);return d?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(Mt,{className:"w-6 h-6 animate-spin text-blue-500"}),s.jsx("span",{className:"ml-2 text-gray-500",children:"ang ti ha n & thanh ton..."})]}):p?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Cr,{className:"w-8 h-8 text-red-400 mx-auto mb-2"}),s.jsx("p",{className:"text-red-600 text-sm",children:p}),s.jsx("button",{onClick:y,className:"mt-2 text-sm text-blue-600 hover:underline",children:"Th li"})]}):r==="draft"?s.jsxs("div",{className:"text-center py-12 text-gray-400",children:[s.jsx(hc,{className:"w-12 h-12 mx-auto mb-3"}),s.jsx("p",{className:"text-sm font-medium",children:"n hng  trng thi Nhp"}),s.jsx("p",{className:"text-xs mt-1",children:"Xc nhn n hng trc khi thm ha n"})]}):s.jsxs("div",{className:"space-y-4",children:[o&&s.jsx(l_e,{summary:o}),u.length>0?s.jsx("div",{className:"space-y-4",children:u.map(m=>s.jsx(d_e,{supplier:m,onAddInvoice:g?t:()=>{},onPayment:n,onViewInvoice:a},m.supplier_id))}):s.jsxs("div",{className:"text-center py-8 text-gray-400",children:[s.jsx(hc,{className:"w-10 h-10 mx-auto mb-2"}),s.jsx("p",{className:"text-sm",children:"Cha c ha n no"}),g&&s.jsxs("button",{onClick:()=>t(),className:"mt-3 inline-flex items-center gap-1.5 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"Thm ha n u tin"]})]})]})}const U0="supplier-invoices",H0={MAX_FILE_SIZE:10*1024*1024,MAX_FILES_PER_INVOICE:5,ALLOWED_TYPES:["image/jpeg","image/png","image/webp","application/pdf"]};function P4(e,r,t=10){const n=Math.round(e*r),a=Math.round(n*t/100),i=n+a;return{amount:n,vatAmount:a,totalAmount:i}}function yP(e){let r=0,t=0;for(const n of e){const a=P4(n.quantity,n.unit_price,n.vat_rate);r+=a.amount,t+=a.vatAmount}return{subtotal:r,vatAmount:t,totalAmount:r+t}}function f_e(e){const t=["B","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(1))+" "+t[n]}const xP={async generateInvoiceCode(){const r=`HD-${new Date().getFullYear()}-`,{data:t,error:n}=await se.from("supplier_invoices").select("invoice_code").ilike("invoice_code",`${r}%`).order("invoice_code",{ascending:!1}).limit(1);if(!n&&t&&t.length>0){const a=t[0].invoice_code,i=parseInt(a.slice(-4))+1;return`${r}${i.toString().padStart(4,"0")}`}return`${r}0001`},async getAll(e){const{page:r,pageSize:t,search:n,status:a,supplier_id:i,order_id:o,from_date:c,to_date:u}=e,l=(r-1)*t,d=l+t-1;let f=se.from("supplier_invoices").select(`
        *,
        order:purchase_orders!supplier_invoices_order_id_fkey(
          id, code:order_code, order_date, status, project_name
        ),
        supplier:suppliers!supplier_invoices_supplier_id_fkey(
          id, code, name, short_name, phone, email, tax_code
        ),
        creator:employees!supplier_invoices_created_by_fkey(
          id, full_name
        )
      `,{count:"exact"});a&&a!=="all"&&(f=f.eq("status",a)),i&&(f=f.eq("supplier_id",i)),o&&(f=f.eq("order_id",o)),c&&(f=f.gte("invoice_date",c)),u&&(f=f.lte("invoice_date",u)),n&&(f=f.or(`invoice_code.ilike.%${n}%,invoice_number.ilike.%${n}%`));const{data:p,error:h,count:y}=await f.order("created_at",{ascending:!1}).range(l,d);if(h)throw h;return{data:(p||[]).map(m=>({...m,order:Array.isArray(m.order)?m.order[0]:m.order,supplier:Array.isArray(m.supplier)?m.supplier[0]:m.supplier,creator:Array.isArray(m.creator)?m.creator[0]:m.creator})),total:y||0,page:r,pageSize:t,totalPages:Math.ceil((y||0)/t)}},async getById(e){const{data:r,error:t}=await se.from("supplier_invoices").select(`
        *,
        order:purchase_orders!supplier_invoices_order_id_fkey(
          id, code:order_code, order_date, status, project_name
        ),
        supplier:suppliers!supplier_invoices_supplier_id_fkey(
          id, code, name, short_name, phone, email, tax_code,
          bank_account, bank_name
        ),
        creator:employees!supplier_invoices_created_by_fkey(
          id, full_name
        )
      `).eq("id",e).single();if(t)throw t;if(!r)return null;const{data:n,error:a}=await se.from("supplier_invoice_items").select(`
        *,
        order_item:purchase_order_items!supplier_invoice_items_order_item_id_fkey(
          id, quantity, unit_price, invoiced_quantity
        )
      `).eq("invoice_id",e).order("sort_order",{ascending:!0});if(a)throw a;return{...r,order:Array.isArray(r.order)?r.order[0]:r.order,supplier:Array.isArray(r.supplier)?r.supplier[0]:r.supplier,creator:Array.isArray(r.creator)?r.creator[0]:r.creator,items:(n||[]).map(i=>({...i,order_item:Array.isArray(i.order_item)?i.order_item[0]:i.order_item}))}},async getByOrderId(e){const{data:r,error:t}=await se.from("supplier_invoices").select(`
        *,
        supplier:suppliers!supplier_invoices_supplier_id_fkey(
          id, code, name, short_name
        ),
        creator:employees!supplier_invoices_created_by_fkey(
          id, full_name
        )
      `).eq("order_id",e).order("created_at",{ascending:!1});if(t)throw t;return(r||[]).map(n=>({...n,supplier:Array.isArray(n.supplier)?n.supplier[0]:n.supplier,creator:Array.isArray(n.creator)?n.creator[0]:n.creator}))},async getBySupplierId(e){const{data:r,error:t}=await se.from("supplier_invoices").select(`
        *,
        order:purchase_orders!supplier_invoices_order_id_fkey(
          id, code:order_code, order_date, status
        ),
        creator:employees!supplier_invoices_created_by_fkey(
          id, full_name
        )
      `).eq("supplier_id",e).order("invoice_date",{ascending:!1});if(t)throw t;return(r||[]).map(n=>({...n,order:Array.isArray(n.order)?n.order[0]:n.order,creator:Array.isArray(n.creator)?n.creator[0]:n.creator}))},async getOrderItemsForInvoice(e,r){const{data:t,error:n}=await se.from("purchase_order_items").select(`
        id,
        material_id,
        material_code,
        material_name,
        unit,
        quantity,
        unit_price,
        vat_rate,
        amount,
        vat_amount,
        total_amount,
        invoiced_quantity,
        notes
      `).eq("order_id",e).eq("supplier_id",r).order("sort_order",{ascending:!0});if(n)throw n;return(t||[]).map(a=>({...a,remaining_quantity:(a.quantity||0)-(a.invoiced_quantity||0)}))},async create(e){const r=await this.generateInvoiceCode(),t=yP(e.items),{data:n,error:a}=await se.from("supplier_invoices").insert({invoice_code:r,order_id:e.order_id,supplier_id:e.supplier_id,invoice_number:e.invoice_number||null,invoice_date:e.invoice_date,due_date:e.due_date||null,subtotal:t.subtotal,vat_amount:t.vatAmount,total_amount:t.totalAmount,paid_amount:0,remaining_amount:t.totalAmount,status:"pending",notes:e.notes||null,created_by:e.created_by||null}).select().single();if(a)throw a;if(e.items.length>0){const i=e.items.map((c,u)=>{const l=P4(c.quantity,c.unit_price,c.vat_rate);return{invoice_id:n.id,order_item_id:c.order_item_id||null,material_code:c.material_code||null,material_name:c.material_name,unit:c.unit,quantity:c.quantity,unit_price:c.unit_price,vat_rate:c.vat_rate,amount:l.amount,vat_amount:l.vatAmount,total_amount:l.totalAmount,notes:c.notes||null,sort_order:c.sort_order??u}}),{error:o}=await se.from("supplier_invoice_items").insert(i);if(o)throw o}return await this.updateOrderItemInvoicedQuantities(e.items),await this.updateOrderInvoiceStatus(e.order_id),await this.addOrderHistory(e.order_id,"invoice_added",e.created_by||null,`Thm ha n ${r}`),this.getById(n.id)},async update(e,r){const t=await this.getById(e);if(!t)throw new Error("Ha n khng tn ti");if(t.status!=="pending")throw new Error("Ch c th sa ha n ang ch thanh ton");const n={};if(r.invoice_number!==void 0&&(n.invoice_number=r.invoice_number),r.invoice_date&&(n.invoice_date=r.invoice_date),r.due_date!==void 0&&(n.due_date=r.due_date),r.notes!==void 0&&(n.notes=r.notes),r.items&&r.items.length>0){const i=yP(r.items);n.subtotal=i.subtotal,n.vat_amount=i.vatAmount,n.total_amount=i.totalAmount,n.remaining_amount=i.totalAmount-(t.paid_amount||0),t.items&&await this.rollbackOrderItemInvoicedQuantities(t.items);const{error:o}=await se.from("supplier_invoice_items").delete().eq("invoice_id",e);if(o)throw o;const c=r.items.map((l,d)=>{const f=P4(l.quantity,l.unit_price,l.vat_rate);return{invoice_id:e,order_item_id:l.order_item_id||null,material_code:l.material_code||null,material_name:l.material_name,unit:l.unit,quantity:l.quantity,unit_price:l.unit_price,vat_rate:l.vat_rate,amount:f.amount,vat_amount:f.vatAmount,total_amount:f.totalAmount,notes:l.notes||null,sort_order:l.sort_order??d}}),{error:u}=await se.from("supplier_invoice_items").insert(c);if(u)throw u;await this.updateOrderItemInvoicedQuantities(r.items)}n.updated_at=new Date().toISOString();const{error:a}=await se.from("supplier_invoices").update(n).eq("id",e);if(a)throw a;return t.order_id&&await this.updateOrderInvoiceStatus(t.order_id),this.getById(e)},async delete(e){const r=await this.getById(e);if(!r)throw new Error("Ha n khng tn ti");if(r.status!=="pending")throw new Error("Ch c th xa ha n ang ch thanh ton");if((r.paid_amount||0)>0)throw new Error("Khng th xa ha n  c thanh ton");r.items&&await this.rollbackOrderItemInvoicedQuantities(r.items);const{error:t}=await se.from("supplier_invoice_items").delete().eq("invoice_id",e);if(t)throw t;const{error:n}=await se.from("supplier_invoices").delete().eq("id",e);if(n)throw n;r.order_id&&(await this.updateOrderInvoiceStatus(r.order_id),await this.addOrderHistory(r.order_id,"invoice_deleted",null,`Xa ha n ${r.invoice_code}`))},async cancel(e,r,t){const n=await this.getById(e);if(!n)throw new Error("Ha n khng tn ti");if(n.status==="cancelled")throw new Error("Ha n  b hy");if((n.paid_amount||0)>0)throw new Error("Khng th hy ha n  c thanh ton. Vui lng hon tin trc.");n.items&&await this.rollbackOrderItemInvoicedQuantities(n.items);const{error:a}=await se.from("supplier_invoices").update({status:"cancelled",notes:r?`${n.notes||""}
[L do hy]: ${r}`.trim():n.notes,updated_at:new Date().toISOString()}).eq("id",e);if(a)throw a;return n.order_id&&(await this.updateOrderInvoiceStatus(n.order_id),await this.addOrderHistory(n.order_id,"invoice_cancelled",t||null,`Hy ha n ${n.invoice_code}${r?": "+r:""}`)),this.getById(e)},async uploadImage(e,r){if(!H0.ALLOWED_TYPES.includes(r.type))throw new Error("Loi file khng h tr. Chp nhn: JPG, PNG, WebP, PDF");if(r.size>H0.MAX_FILE_SIZE)throw new Error(`File qu ln. Ti a ${f_e(H0.MAX_FILE_SIZE)}`);const t=await this.getById(e);if(!t)throw new Error("Ha n khng tn ti");const n=t.image_urls||[];if(n.length>=H0.MAX_FILES_PER_INVOICE)throw new Error(` t gii hn ${H0.MAX_FILES_PER_INVOICE} file/ha n`);const a=r.name.split(".").pop(),i=`${e}/${Date.now()}_${Math.random().toString(36).slice(2)}.${a}`,{error:o}=await se.storage.from(U0).upload(i,r,{cacheControl:"3600",upsert:!1});if(o)throw new Error("Li upload file: "+o.message);const{data:c}=se.storage.from(U0).getPublicUrl(i),u=c.publicUrl,l=[...n,u],{error:d}=await se.from("supplier_invoices").update({image_url:l[0],image_urls:l,updated_at:new Date().toISOString()}).eq("id",e);if(d)throw await se.storage.from(U0).remove([i]),d;return u},async deleteImage(e,r){const t=await this.getById(e);if(!t)throw new Error("Ha n khng tn ti");const a=(t.image_urls||[]).filter(o=>o!==r),{error:i}=await se.from("supplier_invoices").update({image_url:a.length>0?a[0]:null,image_urls:a.length>0?a:null,updated_at:new Date().toISOString()}).eq("id",e);if(i)throw i;try{const o=r.split(`/${U0}/`).pop();o&&await se.storage.from(U0).remove([o])}catch(o){console.warn("Khng th xa file trong storage:",o)}},async getSummary(e){let r=se.from("supplier_invoices").select("id, status, total_amount, paid_amount, remaining_amount");e?.order_id&&(r=r.eq("order_id",e.order_id)),e?.supplier_id&&(r=r.eq("supplier_id",e.supplier_id)),e?.from_date&&(r=r.gte("invoice_date",e.from_date)),e?.to_date&&(r=r.lte("invoice_date",e.to_date)),r=r.neq("status","cancelled");const{data:t,error:n}=await r;if(n)throw n;const a=t||[],i=new Map;let o=0,c=0,u=0;for(const l of a){o+=l.total_amount||0,c+=l.paid_amount||0,u+=l.remaining_amount||0;const d=i.get(l.status)||{count:0,amount:0};d.count+=1,d.amount+=l.total_amount||0,i.set(l.status,d)}return{total_invoices:a.length,total_amount:o,total_paid:c,total_remaining:u,by_status:Array.from(i.entries()).map(([l,d])=>({status:l,count:d.count,amount:d.amount}))}},async getSuppliersInOrder(e){const{data:r,error:t}=await se.from("purchase_order_items").select(`
        supplier_id,
        supplier:suppliers!purchase_order_items_supplier_id_fkey(
          id, code, name, short_name
        )
      `).eq("order_id",e);if(t)throw t;const n=new Map;for(const a of r||[]){const i=Array.isArray(a.supplier)?a.supplier[0]:a.supplier;i&&!n.has(i.id)&&n.set(i.id,i)}return Array.from(n.values())},async updateOrderItemInvoicedQuantities(e){for(const r of e)if(r.order_item_id){const{data:t,error:n}=await se.from("supplier_invoice_items").select("quantity").eq("order_item_id",r.order_item_id);if(!n&&t){const a=t.reduce((i,o)=>i+(o.quantity||0),0);await se.from("purchase_order_items").update({invoiced_quantity:a}).eq("id",r.order_item_id)}}},async rollbackOrderItemInvoicedQuantities(e){for(const r of e)if(r.order_item_id){const{data:t,error:n}=await se.from("supplier_invoice_items").select(`
            quantity,
            invoice:supplier_invoices!supplier_invoice_items_invoice_id_fkey(status)
          `).eq("order_item_id",r.order_item_id).neq("invoice_id",r.invoice_id);if(!n&&t){const a=t.filter(i=>(Array.isArray(i.invoice)?i.invoice[0]:i.invoice)?.status!=="cancelled").reduce((i,o)=>i+(o.quantity||0),0);await se.from("purchase_order_items").update({invoiced_quantity:a}).eq("id",r.order_item_id)}}},async updateOrderInvoiceStatus(e){const{data:r,error:t}=await se.from("purchase_orders").select("id, status").eq("id",e).single();if(t||!r||!["confirmed","partial"].includes(r.status))return;const{data:n,error:a}=await se.from("supplier_invoices").select("id, status").eq("order_id",e).neq("status","cancelled");if(a)return;if((n||[]).length===0){r.status==="partial"&&await se.from("purchase_orders").update({status:"confirmed",updated_at:new Date().toISOString()}).eq("id",e);return}const{data:o,error:c}=await se.from("purchase_order_items").select("id, quantity, invoiced_quantity").eq("order_id",e);if(c)return;const l=(o||[]).every(d=>(d.invoiced_quantity||0)>=(d.quantity||0))?"completed":"partial";r.status!==l&&await se.from("purchase_orders").update({status:l,updated_at:new Date().toISOString()}).eq("id",e)},async addOrderHistory(e,r,t,n){try{await se.from("purchase_order_history").insert({order_id:e,action:r,description:n,performed_by:t})}catch(a){console.warn("Khng th ghi lch s:",a)}},async getOverdueInvoices(){const e=new Date().toISOString().split("T")[0],{data:r,error:t}=await se.from("supplier_invoices").select(`
        *,
        order:purchase_orders!supplier_invoices_order_id_fkey(
          id, code:order_code
        ),
        supplier:suppliers!supplier_invoices_supplier_id_fkey(
          id, code, name, short_name
        )
      `).in("status",["pending","partial"]).not("due_date","is",null).lt("due_date",e).order("due_date",{ascending:!0});if(t)throw t;return(r||[]).map(n=>({...n,order:Array.isArray(n.order)?n.order[0]:n.order,supplier:Array.isArray(n.supplier)?n.supplier[0]:n.supplier}))}};function sf(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}const vP="invoice-images",C5=5,p_e=10*1024*1024;function m_e({show:e,orderId:r,preSelectedSupplierId:t,currentUserId:n,onClose:a,onSuccess:i}){const[o,c]=R.useState("select_supplier"),[u,l]=R.useState([]),[d,f]=R.useState(""),[p,h]=R.useState([]),[y,g]=R.useState(!1),[m,x]=R.useState(!1),[v,w]=R.useState(null),[_,A]=R.useState(""),[P,B]=R.useState(new Date().toISOString().split("T")[0]),[T,I]=R.useState(""),[U,H]=R.useState(""),[z,O]=R.useState([]),[L,E]=R.useState([]),[k,N]=R.useState(!1);R.useEffect(()=>{e&&S()},[e,r]),R.useEffect(()=>{t&&u.length>0&&(f(t),c("fill_form"))},[t,u]);const S=async()=>{try{const ne=await ca.getOrderSuppliers(r);l(ne)}catch(ne){console.error("Error loading suppliers:",ne),w("Li ti danh sch NCC")}};R.useEffect(()=>{d&&o==="fill_form"&&C(d)},[d,o]);const C=async ne=>{g(!0);try{const ie=await xP.getOrderItemsForInvoice(r,ne);h(ie.map(ce=>({...ce,selected:ce.remaining_quantity>0,invoice_quantity:ce.remaining_quantity>0?ce.remaining_quantity:0})))}catch(ie){console.error("Error loading order items:",ie),w("Li ti vt t")}finally{g(!1)}},D=R.useCallback(ne=>{const ie=Array.from(ne.target.files||[]),ce=C5-z.length,de=ie.filter(le=>le.size>p_e?(alert(`File "${le.name}" vt qu 10MB`),!1):!le.type.startsWith("image/")&&le.type!=="application/pdf"?(alert(`File "${le.name}" khng phi nh hoc PDF`),!1):!0).slice(0,ce);O(le=>[...le,...de]),de.forEach(le=>{if(le.type.startsWith("image/")){const _e=new FileReader;_e.onload=ue=>{E(pe=>[...pe,ue.target?.result])},_e.readAsDataURL(le)}else E(_e=>[..._e,""])}),ne.target.value=""},[z]),q=ne=>{O(ie=>ie.filter((ce,de)=>de!==ne)),E(ie=>ie.filter((ce,de)=>de!==ne))},M=async()=>{if(z.length===0)return[];N(!0);const ne=[];try{for(const ie of z){const ce=ie.name.split(".").pop()||"jpg",de=`${r}/${Date.now()}-${Math.random().toString(36).slice(2)}.${ce}`,{error:le}=await se.storage.from(vP).upload(de,ie,{cacheControl:"3600"});if(le)throw le;const{data:_e}=se.storage.from(vP).getPublicUrl(de);ne.push(_e.publicUrl)}}finally{N(!1)}return ne},G=ne=>{h(ie=>ie.map((ce,de)=>de===ne?{...ce,selected:!ce.selected,invoice_quantity:ce.selected?0:ce.remaining_quantity}:ce))},X=(ne,ie)=>{h(ce=>ce.map((de,le)=>le===ne?{...de,invoice_quantity:Math.min(Math.max(0,ie),de.remaining_quantity),selected:ie>0}:de))},re=p.filter(ne=>ne.selected&&ne.invoice_quantity>0),V=re.reduce((ne,ie)=>ne+ie.invoice_quantity*ie.unit_price,0),J=re.reduce((ne,ie)=>ne+ie.invoice_quantity*ie.unit_price*(ie.vat_rate/100),0),W=V+J,F=async()=>{if(re.length===0){w("Chn t nht 1 vt t");return}x(!0),w(null);try{const ne=await M(),ie=re.map((ce,de)=>({order_item_id:ce.id,material_code:ce.material_code,material_name:ce.material_name,unit:ce.unit,quantity:ce.invoice_quantity,unit_price:ce.unit_price,vat_rate:ce.vat_rate,sort_order:de}));await xP.create({order_id:r,supplier_id:d,invoice_number:_||void 0,invoice_date:P,due_date:T||void 0,notes:U||void 0,created_by:n||void 0,items:ie}),i(),Q()}catch(ne){console.error("Error creating invoice:",ne),w(ne.message||"Li to ha n")}finally{x(!1)}},Q=()=>{c("select_supplier"),f(""),h([]),A(""),B(new Date().toISOString().split("T")[0]),I(""),H(""),O([]),E([]),w(null),a()};return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:Q}),s.jsxs("div",{className:"relative w-full max-w-2xl max-h-[90vh] bg-white rounded-xl shadow-2xl flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-5 border-b flex-shrink-0",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(hc,{className:"w-5 h-5 text-blue-500"}),"Thm ha n NCC"]}),d&&s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:u.find(ne=>ne.id===d)?.name})]}),s.jsx("button",{onClick:Q,className:"text-gray-400 hover:text-gray-600 p-1 rounded-lg hover:bg-gray-100",children:s.jsx(Br,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-5",children:[v&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:[s.jsx(Cr,{className:"w-4 h-4 flex-shrink-0"}),v]}),o==="select_supplier"&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Chn nh cung cp  to ha n:"}),s.jsx("div",{className:"space-y-2",children:u.map(ne=>s.jsxs("button",{onClick:()=>{f(ne.id),c("fill_form")},className:"w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50/50 transition-colors text-left",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx($r,{className:"w-5 h-5 text-gray-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:ne.name}),s.jsxs("p",{className:"text-xs text-gray-500",children:[ne.code,"  ",ne.item_count," vt t"]})]})]}),s.jsx("p",{className:"text-sm font-medium text-gray-600",children:sf(ne.subtotal)})]},ne.id))})]}),o==="fill_form"&&s.jsxs(s.Fragment,{children:[!t&&s.jsxs("button",{onClick:()=>c("select_supplier"),className:"flex items-center gap-2 text-sm text-blue-600 hover:underline",children:[s.jsx(Gs,{className:"w-4 h-4 rotate-90"}),"i NCC"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S ha n NCC"}),s.jsx("input",{type:"text",value:_,onChange:ne=>A(ne.target.value),placeholder:"VD: 0001234",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngy ha n ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",value:P,onChange:ne=>B(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hn thanh ton"}),s.jsx("input",{type:"date",value:T,onChange:ne=>I(ne.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),s.jsx("input",{type:"text",value:U,onChange:ne=>H(ne.target.value),placeholder:"Ghi ch ha n...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(Cn,{className:"w-4 h-4 text-blue-500"}),"Vt t t n hng"]}),y?s.jsxs("div",{className:"flex items-center justify-center py-6",children:[s.jsx(Mt,{className:"w-5 h-5 animate-spin text-blue-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"ang ti..."})]}):s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"w-10 p-2 text-center",children:s.jsx("input",{type:"checkbox",checked:p.length>0&&p.every(ne=>ne.selected),onChange:ne=>{const ie=ne.target.checked;h(ce=>ce.map(de=>({...de,selected:ie&&de.remaining_quantity>0,invoice_quantity:ie?de.remaining_quantity:0})))},className:"rounded border-gray-300"})}),s.jsx("th",{className:"p-2 text-left text-xs font-medium text-gray-500",children:"Vt t"}),s.jsx("th",{className:"p-2 text-center text-xs font-medium text-gray-500 w-20",children:"VT"}),s.jsx("th",{className:"p-2 text-right text-xs font-medium text-gray-500 w-20",children:"H"}),s.jsx("th",{className:"p-2 text-right text-xs font-medium text-gray-500 w-20",children:" H"}),s.jsx("th",{className:"p-2 text-center text-xs font-medium text-gray-500 w-24",children:"SL nhn"}),s.jsx("th",{className:"p-2 text-right text-xs font-medium text-gray-500 w-28",children:"n gi"}),s.jsx("th",{className:"p-2 text-right text-xs font-medium text-gray-500 w-28",children:"Thnh tin"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:p.map((ne,ie)=>{const ce=ne.invoice_quantity*ne.unit_price,de=ne.remaining_quantity<=0;return s.jsxs("tr",{className:`${de?"bg-gray-50 opacity-50":ne.selected?"bg-blue-50/30":""}`,children:[s.jsx("td",{className:"p-2 text-center",children:s.jsx("input",{type:"checkbox",checked:ne.selected,disabled:de,onChange:()=>G(ie),className:"rounded border-gray-300"})}),s.jsxs("td",{className:"p-2",children:[s.jsx("p",{className:"font-medium text-gray-900 text-xs",children:ne.material_name}),ne.material_code&&s.jsx("p",{className:"text-xs text-gray-500",children:ne.material_code})]}),s.jsx("td",{className:"p-2 text-center text-xs text-gray-500",children:ne.unit}),s.jsx("td",{className:"p-2 text-right text-xs",children:ne.quantity}),s.jsx("td",{className:"p-2 text-right text-xs text-gray-500",children:ne.invoiced_quantity}),s.jsx("td",{className:"p-2 text-center",children:s.jsx("input",{type:"number",min:0,max:ne.remaining_quantity,value:ne.invoice_quantity,onChange:le=>X(ie,parseFloat(le.target.value)||0),disabled:de,className:"w-full px-2 py-1 text-center border border-gray-300 rounded text-xs focus:ring-1 focus:ring-blue-500 disabled:bg-gray-100"})}),s.jsx("td",{className:"p-2 text-right text-xs",children:sf(ne.unit_price)}),s.jsx("td",{className:"p-2 text-right text-xs font-medium",children:ne.selected&&ne.invoice_quantity>0?sf(ce):""})]},ne.id)})}),re.length>0&&s.jsxs("tfoot",{className:"bg-gray-50",children:[s.jsxs("tr",{children:[s.jsx("td",{colSpan:7,className:"p-2 text-right text-xs font-medium text-gray-600",children:"Tm tnh:"}),s.jsx("td",{className:"p-2 text-right text-xs font-medium",children:sf(V)})]}),s.jsxs("tr",{children:[s.jsx("td",{colSpan:7,className:"p-2 text-right text-xs text-gray-500",children:"VAT:"}),s.jsx("td",{className:"p-2 text-right text-xs",children:sf(J)})]}),s.jsxs("tr",{children:[s.jsx("td",{colSpan:7,className:"p-2 text-right text-sm font-bold text-gray-700",children:"Tng:"}),s.jsx("td",{className:"p-2 text-right text-sm font-bold text-blue-600",children:sf(W)})]})]})]})})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(Kg,{className:"w-4 h-4 text-blue-500"}),"nh ha n (",z.length,"/",C5,")"]}),L.length>0&&s.jsx("div",{className:"flex gap-2 mb-3 flex-wrap",children:L.map((ne,ie)=>s.jsxs("div",{className:"relative w-20 h-20 rounded-lg border border-gray-200 overflow-hidden group",children:[ne?s.jsx("img",{src:ne,alt:`Preview ${ie+1}`,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:s.jsx(vr,{className:"w-6 h-6 text-gray-400"})}),s.jsx("button",{onClick:()=>q(ie),className:"absolute top-0.5 right-0.5 bg-red-500 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Br,{className:"w-3 h-3"})})]},ie))}),z.length<C5&&s.jsxs("label",{className:"flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50/30 transition-colors",children:[s.jsx(Gg,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Chn nh ha n (JPG, PNG, PDF - ti a 10MB)"}),s.jsx("input",{type:"file",accept:"image/*,application/pdf",multiple:!0,onChange:D,className:"hidden"})]})]})]})]}),o==="fill_form"&&s.jsxs("div",{className:"flex items-center justify-between p-5 border-t flex-shrink-0 bg-gray-50",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-500",children:" chn: "}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[re.length," vt t"]}),re.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-gray-400 mx-2",children:""}),s.jsx("span",{className:"font-bold text-blue-600",children:sf(W)})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:Q,disabled:m,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-200 rounded-lg transition-colors",children:"ng"}),s.jsx("button",{onClick:F,disabled:m||re.length===0,className:"flex items-center gap-2 px-5 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),k?"ang ti nh...":"ang lu..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ai,{className:"w-4 h-4"}),"Lu ha n"]})})]})]})]})]}):null}const bP="order-confirmations",A5=5,g_e=10*1024*1024;function y_e(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}function x_e({show:e,orderCode:r,loading:t,onClose:n,onConfirm:a}){const[i,o]=R.useState([]),[c,u]=R.useState([]),[l,d]=R.useState(""),f=y=>{const g=Array.from(y.target.files||[]),m=A5-i.length,x=g.filter(v=>v.size>g_e?(d(`File "${v.name}" vt qu 10MB`),!1):!0).slice(0,m);o(v=>[...v,...x]),d(""),x.forEach(v=>{if(v.type.startsWith("image/")){const w=new FileReader;w.onload=_=>{u(A=>[...A,_.target?.result])},w.readAsDataURL(v)}else u(w=>[...w,""])}),y.target.value=""},p=y=>{o(g=>g.filter((m,x)=>x!==y)),u(g=>g.filter((m,x)=>x!==y))},h=()=>{if(i.length===0){d("Vui lng upload t nht 1 file bng chng ( xut  k duyt)");return}a(i)};return R.useEffect(()=>{e||(o([]),u([]),d(""))},[e]),e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),s.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-xl shadow-2xl",children:[s.jsxs("div",{className:"p-5 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Un,{className:"w-5 h-5 text-blue-500"}),"Xc nhn n hng"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["n ",s.jsx("strong",{children:r}),' s chuyn sang trng thi " xc nhn"']})]}),s.jsxs("div",{className:"p-5 space-y-4",children:[s.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-700",children:[s.jsx("strong",{children:"Bt buc:"})," Upload nh/PDF  xut  c k duyt. Sau khi xc nhn, n hng s b kha khng sa c."]}),l&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600 flex items-center gap-2",children:[s.jsx(Cr,{className:"w-4 h-4 flex-shrink-0"}),l]}),c.length>0&&s.jsx("div",{className:"flex gap-2 flex-wrap",children:c.map((y,g)=>s.jsxs("div",{className:"relative w-20 h-20 rounded-lg border border-gray-200 overflow-hidden group",children:[y?s.jsx("img",{src:y,alt:"",className:"w-full h-full object-cover"}):s.jsxs("div",{className:"w-full h-full bg-gray-100 flex flex-col items-center justify-center",children:[s.jsx(vr,{className:"w-5 h-5 text-gray-400"}),s.jsx("span",{className:"text-[10px] text-gray-400 mt-0.5",children:i[g]?.name.split(".").pop()?.toUpperCase()})]}),s.jsx("button",{onClick:()=>p(g),className:"absolute top-0.5 right-0.5 bg-red-500 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(Br,{className:"w-3 h-3"})})]},g))}),i.length<A5&&s.jsxs("label",{className:"flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 hover:bg-blue-50/30 transition-colors",children:[s.jsx(Gg,{className:"w-6 h-6 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Ko th hoc chn file"}),s.jsxs("span",{className:"text-xs text-gray-400",children:["JPG, PNG, PDF  ti a 10MB/file  ",i.length,"/",A5]}),s.jsx("input",{type:"file",accept:"image/*,application/pdf",multiple:!0,onChange:f,className:"hidden"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 p-5 border-t bg-gray-50 rounded-b-xl",children:[s.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-200 rounded-lg",children:"Hy"}),s.jsx("button",{onClick:h,disabled:t||i.length===0,className:"flex items-center gap-2 px-5 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:t?s.jsxs(s.Fragment,{children:[s.jsx(Mt,{className:"w-4 h-4 animate-spin"}),"ang xc nhn..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Un,{className:"w-4 h-4"}),"Xc nhn n hng"]})})]})]})]}):null}function v_e({show:e,orderCode:r,loading:t,onClose:n,onConfirm:a}){return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xa n hng?"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["n ",s.jsx("strong",{children:r})," s b xa vnh vin. Khng th hon tc."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),s.jsxs("button",{onClick:a,disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[t?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(En,{className:"w-4 h-4"}),t?"ang xa...":"Xa"]})]})]})]}):null}function b_e({show:e,orderCode:r,loading:t,onClose:n,onConfirm:a}){const[i,o]=R.useState("");return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:n}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Hy n hng?"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["n ",s.jsx("strong",{children:r})," s b hy."]}),s.jsx("textarea",{value:i,onChange:c=>o(c.target.value),placeholder:"L do hy (ty chn)...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mb-4"}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:n,disabled:t,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"ng"}),s.jsxs("button",{onClick:()=>a(i),disabled:t,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[t?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(nu,{className:"w-4 h-4"}),t?"ang hy...":"Hy n hng"]})]})]})]}):null}function w_e(){const e=ts(),{id:r}=_h(),t=jo(),{user:n}=xn(),[a,i]=R.useState(null),[o,c]=R.useState([]),[u,l]=R.useState([]),[d,f]=R.useState(!0),[p,h]=R.useState(null),[y,g]=R.useState("info"),[m,x]=R.useState(t.state?.message||null),[v,w]=R.useState(!1),[_,A]=R.useState(!1),[P,B]=R.useState(!1),[T,I]=R.useState(!1),[U,H]=R.useState(!1),[z,O]=R.useState(!1),[L,E]=R.useState(),[k,N]=R.useState(0),S=R.useCallback(async()=>{if(r){f(!0);try{const[_e,ue,pe]=await Promise.all([ca.getById(r),ca.getItems(r),ca.getHistory(r)]);if(!_e){h("n hng khng tn ti");return}i(_e),c(ue),l(pe)}catch(_e){console.error("Error loading order:",_e),h(_e.message||"Li ti n hng")}finally{f(!1)}}},[r]);R.useEffect(()=>{S()},[S]),R.useEffect(()=>{if(m){const _e=setTimeout(()=>x(null),5e3);return()=>clearTimeout(_e)}},[m]);const C=async _e=>{if(!(!a||!r)){w(!0);try{const ue=[];for(const me of _e){const Ce=me.name.split(".").pop()||"jpg",fe=`${r}/${Date.now()}-${Math.random().toString(36).slice(2)}.${Ce}`,{error:xe}=await se.storage.from(bP).upload(fe,me,{cacheControl:"3600"});if(xe)throw xe;const{data:je}=se.storage.from(bP).getPublicUrl(fe);ue.push(je.publicUrl)}const pe=n?.employee_id||"";await ca.confirmWithFiles(r,pe,ue),x("n hng  c xc nhn"),A(!1),S()}catch(ue){console.error("Error confirming order:",ue),alert(ue.message||"Li xc nhn n hng")}finally{w(!1)}}},D=async _e=>{if(!(!a||!r)){w(!0);try{const ue=n?.employee_id||"";await ca.cancel(r,ue,_e),x("n hng  b hy"),I(!1),S()}catch(ue){alert(ue.message||"Li hy n hng")}finally{w(!1)}}},q=async()=>{if(!(!a||!r)){w(!0);try{await ca.delete(r),e("/purchasing/orders",{state:{message:` xa n hng ${a.order_code}`}})}catch(_e){alert(_e.message||"Li xa n hng")}finally{w(!1)}}},M=_e=>{E(_e),O(!0)},G=()=>{N(_e=>_e+1),S()},X=_e=>{e(`/purchasing/invoices/${_e}?tab=payment`)},re=_e=>{e(`/purchasing/invoices/${_e}`)};if(d)return s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsx(Mt,{className:"w-8 h-8 animate-spin text-blue-500"})});if(p||!a)return s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Cr,{className:"w-12 h-12 text-red-400 mx-auto mb-3"}),s.jsx("p",{className:"text-lg font-medium text-gray-900 mb-1",children:p||"n hng khng tn ti"}),s.jsx("button",{onClick:()=>e("/purchasing/orders"),className:"mt-3 text-sm text-blue-600 hover:underline",children:" Quay li danh sch"})]})});const V=a.status,J=V==="draft",W=V==="confirmed",F=V==="partial",Q=J,ne=J,ie=J||W,ce=W||F,de={};o.forEach(_e=>{const ue=_e.supplier_id||"unknown";de[ue]||(de[ue]=[]),de[ue].push(_e)});const le=[{key:"info",label:"Thng tin",icon:vr},{key:"items",label:"Vt t",icon:Cn,count:o.length},{key:"invoices",label:"Ha n & TT",icon:hc},{key:"history",label:"Lch s",icon:Z5,count:u.length}];return s.jsxs("div",{className:"max-w-5xl mx-auto p-4 sm:p-6 space-y-5",children:[m&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700",children:[s.jsx(Un,{className:"w-4 h-4"}),m]}),s.jsx("button",{onClick:()=>x(null),children:s.jsx(Br,{className:"w-4 h-4 text-green-400"})})]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("button",{onClick:()=>e("/purchasing/orders"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg mt-0.5",children:s.jsx(wo,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:a.order_code}),s.jsx(Qwe,{status:V})]}),a.project_name&&s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:a.project_name})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[Q&&s.jsxs("button",{onClick:()=>e(`/purchasing/orders/${r}/edit`),className:"flex items-center gap-1.5 px-3 py-2 text-sm text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg",children:[s.jsx(sd,{className:"w-4 h-4"}),"Sa"]}),ne&&s.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg",children:[s.jsx(Un,{className:"w-4 h-4"}),"Xc nhn"]}),ce&&s.jsxs("button",{onClick:()=>M(),className:"flex items-center gap-1.5 px-3 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg",children:[s.jsx(hc,{className:"w-4 h-4"}),"Thm H"]}),(ie||J)&&s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>H(!U),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:s.jsx($b,{className:"w-5 h-5"})}),U&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>H(!1)}),s.jsxs("div",{className:"absolute right-0 top-10 z-20 bg-white border border-gray-200 rounded-lg shadow-lg py-1 w-44",children:[ie&&s.jsxs("button",{onClick:()=>{I(!0),H(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-orange-600 hover:bg-orange-50",children:[s.jsx(nu,{className:"w-4 h-4"}),"Hy n hng"]}),J&&s.jsxs("button",{onClick:()=>{B(!0),H(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{className:"w-4 h-4"}),"Xa n hng"]})]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(dn,{className:"w-3 h-3"}),"Ngy to"]}),s.jsx("p",{className:"text-sm font-medium text-gray-900 mt-0.5",children:new Date(a.order_date||a.created_at).toLocaleDateString("vi-VN")})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx($r,{className:"w-3 h-3"}),"NCC"]}),s.jsxs("p",{className:"text-sm font-medium text-gray-900 mt-0.5",children:[Object.keys(de).length," nh cung cp"]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(jl,{className:"w-3 h-3"}),"Vt t"]}),s.jsxs("p",{className:"text-sm font-medium text-gray-900 mt-0.5",children:[o.length," mc"]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Tng tin"}),s.jsx("p",{className:"text-lg font-bold text-blue-600 mt-0.5",children:y_e(a.grand_total||0)})]})]}),(a.delivery_address||a.delivery_notes)&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 mb-1.5",children:[s.jsx(dc,{className:"w-4 h-4 text-green-500"}),"Giao hng"]}),a.delivery_address&&s.jsx("p",{className:"text-sm text-gray-600",children:a.delivery_address}),a.delivery_notes&&s.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:a.delivery_notes})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm",children:[s.jsx("div",{className:"flex border-b border-gray-200 overflow-x-auto",children:le.map(_e=>{const ue=_e.icon;return s.jsxs("button",{onClick:()=>g(_e.key),className:`flex items-center gap-2 px-5 py-3 text-sm font-medium border-b-2 whitespace-nowrap transition-colors ${y===_e.key?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(ue,{className:"w-4 h-4"}),_e.label,_e.count!==void 0&&s.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded-full",children:_e.count})]},_e.key)})}),s.jsxs("div",{className:"p-5",children:[y==="info"&&s.jsx(e_e,{order:a}),y==="items"&&s.jsx(t_e,{items:o,grandTotal:a.grand_total||0}),y==="invoices"&&s.jsx(h_e,{orderId:a.id,orderStatus:a.status,onAddInvoice:M,onPayment:X,onViewInvoice:re,refreshKey:k}),y==="history"&&s.jsx(s_e,{history:u})]})]}),s.jsx(x_e,{show:_,orderCode:a.order_code,loading:v,onClose:()=>A(!1),onConfirm:C}),s.jsx(v_e,{show:P,orderCode:a.order_code,loading:v,onClose:()=>B(!1),onConfirm:q}),s.jsx(b_e,{show:T,orderCode:a.order_code,loading:v,onClose:()=>I(!1),onConfirm:D}),s.jsx(m_e,{show:z,orderId:a.id,preSelectedSupplierId:L,currentUserId:n?.employee_id??void 0,onClose:()=>{O(!1),E(void 0)},onSuccess:G})]})}const E5={async getByInvoiceId(e){console.log(" [paymentService] getByInvoiceId:",e);const{data:r,error:t}=await se.from("invoice_payments").select(`
        *,
        creator:created_by(id, code, full_name)
      `).eq("invoice_id",e).order("payment_date",{ascending:!1});if(t)throw console.error(" [paymentService] getByInvoiceId error:",t),t;const n=(r||[]).map(a=>{const i=Array.isArray(a.creator)?a.creator[0]:a.creator;return{...a,created_by_name:i?.full_name||"",created_by_code:i?.code||"",creator:void 0}});return console.log(" [paymentService] Found",n.length,"payments"),n},async getById(e){const{data:r,error:t}=await se.from("invoice_payments").select(`
        *,
        creator:created_by(id, code, full_name)
      `).eq("id",e).single();if(t)throw console.error(" [paymentService] getById error:",t),t;if(!r)return null;const n=Array.isArray(r.creator)?r.creator[0]:r.creator;return{...r,created_by_name:n?.full_name||"",created_by_code:n?.code||"",creator:void 0}},async create(e){console.log(" [paymentService] create:",e);const{data:r,error:t}=await se.from("invoice_payments").insert({invoice_id:e.invoice_id,payment_date:e.payment_date,amount:e.amount,payment_method:e.payment_method,reference_number:e.reference_number||null,bank_name:e.bank_name||null,notes:e.notes||null,created_by:e.created_by||null}).select().single();if(t)throw console.error(" [paymentService] create error:",t),t.message?.includes("vt qu s tin cn li")?new Error("S tin thanh ton vt qu s tin cn li ca ha n"):t;return console.log(" [paymentService] Created payment:",r.id),r},async update(e,r){console.log(" [paymentService] update:",e,r);const{data:t,error:n}=await se.from("invoice_payments").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error(" [paymentService] update error:",n),n.message?.includes("vt qu s tin cn li")?new Error("S tin thanh ton vt qu s tin cn li ca ha n"):n;return console.log(" [paymentService] Updated payment:",e),t},async delete(e){console.log(" [paymentService] delete:",e);const{error:r}=await se.from("invoice_payments").delete().eq("id",e);if(r)throw console.error(" [paymentService] delete error:",r),r;console.log(" [paymentService] Deleted payment:",e)},async getAll(e){const{page:r,pageSize:t,search:n,supplier_id:a,payment_method:i,from_date:o,to_date:c}=e,u=(r-1)*t,l=u+t-1;console.log(" [paymentService] getAll:",e);let d=se.from("invoice_payments").select(`
        *,
        creator:created_by(id, code, full_name),
        invoice:invoice_id(
          id,
          invoice_number,
          invoice_date,
          due_date,
          total_amount,
          paid_amount,
          remaining_amount,
          payment_status,
          supplier_id,
          order_id,
          supplier:supplier_id(id, code, name),
          order:order_id(id, order_code, title)
        )
      `,{count:"exact"});i&&i!=="all"&&(d=d.eq("payment_method",i)),o&&(d=d.gte("payment_date",o)),c&&(d=d.lte("payment_date",c)),n&&(d=d.or(`reference_number.ilike.%${n}%,notes.ilike.%${n}%`));const{data:f,error:p,count:h}=await d.order("payment_date",{ascending:!1}).order("created_at",{ascending:!1}).range(u,l);if(p)throw console.error(" [paymentService] getAll error:",p),p;let y=(f||[]).map(g=>{const m=Array.isArray(g.creator)?g.creator[0]:g.creator,x=Array.isArray(g.invoice)?g.invoice[0]:g.invoice,v=x?.supplier?Array.isArray(x.supplier)?x.supplier[0]:x.supplier:null,w=x?.order?Array.isArray(x.order)?x.order[0]:x.order:null;return{...g,created_by_name:m?.full_name||"",created_by_code:m?.code||"",invoice_number:x?.invoice_number||"",invoice_date:x?.invoice_date||"",due_date:x?.due_date||"",invoice_total_amount:x?.total_amount||0,invoice_paid_amount:x?.paid_amount||0,invoice_remaining_amount:x?.remaining_amount||0,invoice_payment_status:x?.payment_status||"unpaid",supplier_id:v?.id||x?.supplier_id||"",supplier_code:v?.code||"",supplier_name:v?.name||"",order_id:w?.id||x?.order_id||"",order_code:w?.order_code||"",order_title:w?.title||"",creator:void 0,invoice:void 0}});return a&&(y=y.filter(g=>g.supplier_id===a)),console.log(" [paymentService] Found",y.length,"payments"),{data:y,total:h||0,page:r,pageSize:t,totalPages:Math.ceil((h||0)/t)}},async getDebtSummary(){console.log(" [paymentService] getDebtSummary");const{data:e,error:r}=await se.from("v_supplier_debt_summary").select("*").order("total_remaining_amount",{ascending:!1});return r?(console.error(" [paymentService] getDebtSummary error:",r),this.getDebtSummaryFallback()):(console.log(" [paymentService] Debt summary:",e?.length,"suppliers"),e||[])},async getDebtSummaryFallback(){console.log(" [paymentService] getDebtSummaryFallback");const{data:e,error:r}=await se.from("suppliers").select("id, code, name, phone, payment_terms").eq("status","active");if(r)throw r;if(!e?.length)return[];const t=[];for(const n of e){const{data:a,error:i}=await se.from("supplier_invoices").select("id, total_amount, paid_amount, remaining_amount, payment_status, due_date, status").eq("supplier_id",n.id).neq("status","cancelled");if(i||!a?.length)continue;const o=new Date().toISOString().split("T")[0],c=new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],u={supplier_id:n.id,supplier_code:n.code,supplier_name:n.name,supplier_phone:n.phone,payment_terms:n.payment_terms,total_invoices:a.length,unpaid_invoices:a.filter(l=>l.payment_status==="unpaid").length,partial_invoices:a.filter(l=>l.payment_status==="partial").length,paid_invoices:a.filter(l=>l.payment_status==="paid").length,total_invoice_amount:a.reduce((l,d)=>l+(d.total_amount||0),0),total_paid_amount:a.reduce((l,d)=>l+(d.paid_amount||0),0),total_remaining_amount:a.reduce((l,d)=>l+(d.remaining_amount||0),0),overdue_invoices:a.filter(l=>l.due_date&&l.due_date<o&&l.payment_status!=="paid").length,overdue_amount:a.filter(l=>l.due_date&&l.due_date<o&&l.payment_status!=="paid").reduce((l,d)=>l+(d.remaining_amount||0),0),due_soon_invoices:a.filter(l=>l.due_date&&l.due_date>=o&&l.due_date<=c&&l.payment_status!=="paid").length,due_soon_amount:a.filter(l=>l.due_date&&l.due_date>=o&&l.due_date<=c&&l.payment_status!=="paid").reduce((l,d)=>l+(d.remaining_amount||0),0)};u.total_invoices>0&&t.push(u)}return t.sort((n,a)=>a.total_remaining_amount-n.total_remaining_amount),t},async getSupplierDebt(e){console.log(" [paymentService] getSupplierDebt:",e);const{data:r,error:t}=await se.from("suppliers").select("id, code, name, phone, payment_terms, total_debt").eq("id",e).single();if(t)throw t;const{data:n,error:a}=await se.from("supplier_invoices").select(`
        *,
        order:order_id(id, order_code, title)
      `).eq("supplier_id",e).neq("status","cancelled").order("invoice_date",{ascending:!1});if(a)throw a;const i=(n||[]).map(p=>p.id);let o=[];if(i.length>0){const{data:p,error:h}=await se.from("invoice_payments").select(`
          *,
          creator:created_by(id, code, full_name),
          invoice:invoice_id(id, invoice_number, supplier_id)
        `).in("invoice_id",i).order("payment_date",{ascending:!1});!h&&p&&(o=p.map(y=>{const g=Array.isArray(y.creator)?y.creator[0]:y.creator,m=Array.isArray(y.invoice)?y.invoice[0]:y.invoice;return{...y,created_by_name:g?.full_name||"",invoice_number:m?.invoice_number||"",supplier_id:e,supplier_code:r?.code||"",supplier_name:r?.name||"",creator:void 0,invoice:void 0}}))}const c=new Date().toISOString().split("T")[0],u=new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0],l=n||[],d={supplier_id:r.id,supplier_code:r.code,supplier_name:r.name,supplier_phone:r.phone,payment_terms:r.payment_terms,total_invoices:l.length,unpaid_invoices:l.filter(p=>p.payment_status==="unpaid").length,partial_invoices:l.filter(p=>p.payment_status==="partial").length,paid_invoices:l.filter(p=>p.payment_status==="paid").length,total_invoice_amount:l.reduce((p,h)=>p+(h.total_amount||0),0),total_paid_amount:l.reduce((p,h)=>p+(h.paid_amount||0),0),total_remaining_amount:l.reduce((p,h)=>p+(h.remaining_amount||0),0),overdue_invoices:l.filter(p=>p.due_date&&p.due_date<c&&p.payment_status!=="paid").length,overdue_amount:l.filter(p=>p.due_date&&p.due_date<c&&p.payment_status!=="paid").reduce((p,h)=>p+(h.remaining_amount||0),0),due_soon_invoices:l.filter(p=>p.due_date&&p.due_date>=c&&p.due_date<=u&&p.payment_status!=="paid").length,due_soon_amount:l.filter(p=>p.due_date&&p.due_date>=c&&p.due_date<=u&&p.payment_status!=="paid").reduce((p,h)=>p+(h.remaining_amount||0),0)},f=l.map(p=>{const h=Array.isArray(p.order)?p.order[0]:p.order;return{...p,order_code:h?.order_code||"",order_title:h?.title||"",order:void 0}});return{summary:d,invoices:f,payments:o}},async getOverdueInvoices(){console.log(" [paymentService] getOverdueInvoices");const{data:e,error:r}=await se.from("v_overdue_invoices").select("*").order("days_overdue",{ascending:!1});return r?(console.error(" [paymentService] getOverdueInvoices error:",r),this.getOverdueInvoicesFallback()):(console.log(" [paymentService] Found",e?.length,"overdue invoices"),e||[])},async getOverdueInvoicesFallback(){const e=new Date().toISOString().split("T")[0],{data:r,error:t}=await se.from("supplier_invoices").select(`
        *,
        supplier:supplier_id(id, code, name, phone),
        order:order_id(id, order_code, title)
      `).lt("due_date",e).neq("payment_status","paid").neq("status","cancelled").order("due_date",{ascending:!0});if(t)throw t;return(r||[]).map(n=>{const a=Array.isArray(n.supplier)?n.supplier[0]:n.supplier,i=Array.isArray(n.order)?n.order[0]:n.order,o=new Date(n.due_date),c=new Date(e),u=Math.floor((c.getTime()-o.getTime())/(1e3*60*60*24));return{id:n.id,invoice_number:n.invoice_number,invoice_date:n.invoice_date,due_date:n.due_date,total_amount:n.total_amount||0,paid_amount:n.paid_amount||0,remaining_amount:n.remaining_amount||0,payment_status:n.payment_status||"unpaid",days_overdue:u,supplier_id:a?.id||"",supplier_code:a?.code||"",supplier_name:a?.name||"",supplier_phone:a?.phone||"",order_id:i?.id||"",order_code:i?.order_code||"",order_title:i?.title||""}})},async getPaymentStats(e,r){console.log(" [paymentService] getPaymentStats:",e,r);try{const{data:t,error:n}=await se.rpc("fn_payment_stats",{p_from_date:e||null,p_to_date:r||null});if(n)throw n;if(t&&t.length>0)return t[0]}catch(t){console.warn(" [paymentService] fn_payment_stats failed, using fallback:",t)}return this.getPaymentStatsFallback(e,r)},async getPaymentStatsFallback(e,r){let t=se.from("invoice_payments").select("amount, payment_method");e&&(t=t.gte("payment_date",e)),r&&(t=t.lte("payment_date",r));const{data:n}=await t,{data:a}=await se.from("supplier_invoices").select("remaining_amount, due_date, payment_status").neq("status","cancelled").neq("payment_status","paid"),i=new Date().toISOString().split("T")[0],o=(a||[]).filter(l=>l.due_date&&l.due_date<i),c=n||[],u=c.reduce((l,d)=>l+(d.amount||0),0);return{total_payments:c.length,total_amount:u,cash_amount:c.filter(l=>l.payment_method==="cash").reduce((l,d)=>l+(d.amount||0),0),bank_transfer_amount:c.filter(l=>l.payment_method==="bank_transfer").reduce((l,d)=>l+(d.amount||0),0),avg_payment:c.length>0?u/c.length:0,total_debt:(a||[]).reduce((l,d)=>l+(d.remaining_amount||0),0),total_overdue:o.reduce((l,d)=>l+(d.remaining_amount||0),0),overdue_count:o.length}},async getPaymentTrend(e=6){console.log(" [paymentService] getPaymentTrend:",e);const r=[];for(let t=e-1;t>=0;t--){const n=new Date;n.setMonth(n.getMonth()-t);const a=n.getFullYear(),i=n.getMonth()+1,o=`${a}-${i.toString().padStart(2,"0")}-01`,c=new Date(a,i,0).toISOString().split("T")[0],{data:u,error:l}=await se.from("invoice_payments").select("amount").gte("payment_date",o).lte("payment_date",c);if(l)continue;const d=u||[];r.push({month:`T${i}/${a}`,amount:d.reduce((f,p)=>f+(p.amount||0),0),count:d.length})}return r},async getInvoiceForPayment(e){const{data:r,error:t}=await se.from("supplier_invoices").select(`
        id, invoice_number, total_amount, paid_amount, remaining_amount, payment_status, due_date,
        supplier:supplier_id(code, name)
      `).eq("id",e).single();if(t)return console.error(" [paymentService] getInvoiceForPayment error:",t),null;const n=Array.isArray(r.supplier)?r.supplier[0]:r.supplier;return{id:r.id,invoice_number:r.invoice_number,total_amount:r.total_amount||0,paid_amount:r.paid_amount||0,remaining_amount:r.remaining_amount||0,payment_status:r.payment_status||"unpaid",due_date:r.due_date,supplier_name:n?.name||"",supplier_code:n?.code||""}},formatCurrency(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(e)},formatDate(e){return e?new Date(e).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):""}},__e=()=>{const[e,r]=R.useState([]),[t,n]=R.useState([]),[a,i]=R.useState(null),[o,c]=R.useState("debt"),[u,l]=R.useState(!0),[d,f]=R.useState(""),[p,h]=R.useState(""),[y,g]=R.useState("total_remaining_amount"),[m,x]=R.useState("desc"),[v,w]=R.useState("has_debt"),_=R.useCallback(async()=>{try{l(!0),f("");const[k,N,S]=await Promise.all([E5.getDebtSummary(),E5.getOverdueInvoices(),E5.getPaymentStats()]);r(k),n(N),i(S)}catch(k){console.error("Error loading debt data:",k),f("Khng th ti d liu cng n")}finally{l(!1)}},[]);R.useEffect(()=>{_()},[_]);const A=k=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(k),P=k=>k?new Date(k).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"",B=k=>{const S={unpaid:{label:"Cha TT",className:"bg-red-100 text-red-700"},partial:{label:"TT mt phn",className:"bg-yellow-100 text-yellow-700"},paid:{label:" TT",className:"bg-green-100 text-green-700"}}[k]||{label:k,className:"bg-gray-100 text-gray-700"};return s.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs font-medium ${S.className}`,children:S.label})},T=e.filter(k=>{if(p){const N=p.toLowerCase();if(!k.supplier_name.toLowerCase().includes(N)&&!k.supplier_code.toLowerCase().includes(N))return!1}return v==="has_debt"?k.total_remaining_amount>0:v==="overdue"?k.overdue_invoices>0:!0}).sort((k,N)=>{const S=k[y]??0,C=N[y]??0;return typeof S=="string"?m==="asc"?S.localeCompare(C):C.localeCompare(S):m==="asc"?S-C:C-S}),I=t.filter(k=>{if(!p)return!0;const N=p.toLowerCase();return k.supplier_name.toLowerCase().includes(N)||k.supplier_code.toLowerCase().includes(N)||k.invoice_number.toLowerCase().includes(N)||k.order_code&&k.order_code.toLowerCase().includes(N)}),U=k=>{y===k?x(m==="asc"?"desc":"asc"):(g(k),x("desc"))},H=({field:k})=>s.jsx(pO,{className:`w-3.5 h-3.5 cursor-pointer ${y===k?"text-blue-600":"text-gray-400"}`,onClick:()=>U(k)}),z=e.reduce((k,N)=>k+N.total_remaining_amount,0),O=e.reduce((k,N)=>k+N.overdue_amount,0),L=e.reduce((k,N)=>k+N.due_soon_amount,0),E=e.filter(k=>k.total_remaining_amount>0).length;return s.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" Cng n & Thanh ton"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Theo di cng n nh cung cp, cnh bo qu hn"})]}),s.jsxs("button",{onClick:_,disabled:u,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[s.jsx(Vr,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Lm mi"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2.5 bg-blue-100 rounded-lg",children:s.jsx(Y4,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Tng cng n"}),s.jsx("p",{className:"text-lg font-bold text-blue-600",children:A(z)}),s.jsxs("p",{className:"text-xs text-gray-400",children:[E," NCC cn n"]})]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2.5 bg-red-100 rounded-lg",children:s.jsx(Kr,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Qu hn"}),s.jsx("p",{className:"text-lg font-bold text-red-600",children:A(O)}),s.jsxs("p",{className:"text-xs text-gray-400",children:[t.length," ha n"]})]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2.5 bg-yellow-100 rounded-lg",children:s.jsx(Xr,{className:"w-5 h-5 text-yellow-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Sp n hn (7 ngy)"}),s.jsx("p",{className:"text-lg font-bold text-yellow-600",children:A(L)}),s.jsxs("p",{className:"text-xs text-gray-400",children:[e.reduce((k,N)=>k+N.due_soon_invoices,0)," ha n"]})]})]})}),s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2.5 bg-green-100 rounded-lg",children:s.jsx(md,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500",children:" thanh ton"}),s.jsx("p",{className:"text-lg font-bold text-green-600",children:A(a?.total_amount||0)}),s.jsxs("p",{className:"text-xs text-gray-400",children:[a?.total_payments||0," ln TT"]})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between border-b px-4",children:[s.jsxs("div",{className:"flex gap-1",children:[s.jsxs("button",{onClick:()=>c("debt"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${o==="debt"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx($r,{className:"w-4 h-4 inline mr-1.5"}),"Cng n NCC",E>0&&s.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs bg-blue-100 text-blue-600 rounded-full",children:E})]}),s.jsxs("button",{onClick:()=>c("overdue"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${o==="overdue"?"border-red-600 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[s.jsx(Kr,{className:"w-4 h-4 inline mr-1.5"}),"Qu hn",t.length>0&&s.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs bg-red-100 text-red-600 rounded-full",children:t.length})]})]}),s.jsxs("div",{className:"flex items-center gap-2 py-2",children:[o==="debt"&&s.jsxs("select",{value:v,onChange:k=>w(k.target.value),className:"px-3 py-1.5 text-xs border border-gray-200 rounded-lg",children:[s.jsx("option",{value:"all",children:"Tt c NCC"}),s.jsx("option",{value:"has_debt",children:"Cn cng n"}),s.jsx("option",{value:"overdue",children:"C qu hn"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(ii,{className:"w-4 h-4 absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",value:p,onChange:k=>h(k.target.value),placeholder:"Tm NCC, m H...",className:"pl-8 pr-3 py-1.5 text-xs border border-gray-200 rounded-lg w-48 focus:ring-1 focus:ring-blue-500"})]})]})]}),s.jsx("div",{className:"p-0",children:u?s.jsxs("div",{className:"flex items-center justify-center py-16 text-gray-500",children:[s.jsx(Mt,{className:"w-6 h-6 animate-spin mr-2"}),"ang ti d liu..."]}):d?s.jsxs("div",{className:"flex flex-col items-center py-16 text-red-500",children:[s.jsx(Cr,{className:"w-8 h-8 mb-2"}),s.jsx("p",{className:"text-sm",children:d}),s.jsx("button",{onClick:_,className:"mt-2 text-blue-600 text-sm hover:underline",children:"Th li"})]}):o==="debt"?s.jsx("div",{className:"overflow-x-auto",children:T.length===0?s.jsxs("div",{className:"flex flex-col items-center py-16 text-gray-400",children:[s.jsx(hn,{className:"w-12 h-12 mb-3 text-green-300"}),s.jsx("p",{className:"text-sm font-medium",children:"Khng c cng n no!"}),s.jsx("p",{className:"text-xs",children:"Tt c ha n  c thanh ton"})]}):s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gray-50",children:[s.jsx("th",{className:"text-left px-4 py-3 font-medium text-gray-600",children:s.jsxs("div",{className:"flex items-center gap-1",children:["NCC ",s.jsx(H,{field:"supplier_name"})]})}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-gray-600",children:"H"}),s.jsx("th",{className:"text-right px-3 py-3 font-medium text-gray-600",children:s.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Tng H ",s.jsx(H,{field:"total_invoice_amount"})]})}),s.jsx("th",{className:"text-right px-3 py-3 font-medium text-gray-600",children:" TT"}),s.jsx("th",{className:"text-right px-3 py-3 font-medium text-gray-600",children:s.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Cn n ",s.jsx(H,{field:"total_remaining_amount"})]})}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-gray-600",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Qu hn ",s.jsx(H,{field:"overdue_amount"})]})}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-gray-600",children:"TT"}),s.jsx("th",{className:"px-3 py-3"})]})}),s.jsx("tbody",{className:"divide-y",children:T.map(k=>{const N=k.total_invoice_amount>0?Math.round(k.total_paid_amount/k.total_invoice_amount*100):0;return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:k.supplier_name}),s.jsx("p",{className:"text-xs text-gray-500",children:k.supplier_code})]})}),s.jsx("td",{className:"text-center px-3 py-3",children:s.jsxs("div",{className:"text-xs space-y-0.5",children:[s.jsxs("div",{children:[k.total_invoices," H"]}),k.unpaid_invoices>0&&s.jsxs("span",{className:"text-red-500",children:[k.unpaid_invoices," cha TT"]}),k.partial_invoices>0&&s.jsxs("span",{className:"text-yellow-500",children:[k.partial_invoices," TT 1 phn"]})]})}),s.jsx("td",{className:"text-right px-3 py-3 font-medium",children:A(k.total_invoice_amount)}),s.jsx("td",{className:"text-right px-3 py-3 text-blue-600",children:A(k.total_paid_amount)}),s.jsx("td",{className:"text-right px-3 py-3",children:s.jsx("span",{className:`font-bold ${k.total_remaining_amount>0?"text-orange-600":"text-green-600"}`,children:A(k.total_remaining_amount)})}),s.jsx("td",{className:"text-center px-3 py-3",children:k.overdue_invoices>0?s.jsxs("div",{children:[s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[s.jsx(Kr,{className:"w-3 h-3"}),k.overdue_invoices]}),s.jsx("p",{className:"text-xs text-red-500 mt-0.5",children:A(k.overdue_amount)})]}):k.due_soon_invoices>0?s.jsxs("div",{children:[s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:[s.jsx(Xr,{className:"w-3 h-3"}),k.due_soon_invoices]}),s.jsx("p",{className:"text-xs text-yellow-500 mt-0.5",children:"Sp n hn"})]}):s.jsx("span",{className:"text-xs text-green-500",children:""})}),s.jsx("td",{className:"px-3 py-3",children:s.jsxs("div",{className:"w-16",children:[s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:`h-1.5 rounded-full ${N>=100?"bg-green-500":N>=50?"bg-blue-500":"bg-orange-500"}`,style:{width:`${Math.min(N,100)}%`}})}),s.jsxs("p",{className:"text-xs text-gray-400 text-center mt-0.5",children:[N,"%"]})]})}),s.jsx("td",{className:"px-3 py-3",children:s.jsx(Ks,{className:"w-4 h-4 text-gray-400"})})]},k.supplier_id)})}),s.jsx("tfoot",{children:s.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[s.jsxs("td",{className:"px-4 py-3 text-gray-700",children:["Tng cng (",T.length," NCC)"]}),s.jsxs("td",{className:"text-center px-3 py-3 text-gray-700",children:[T.reduce((k,N)=>k+N.total_invoices,0)," H"]}),s.jsx("td",{className:"text-right px-3 py-3 text-gray-700",children:A(T.reduce((k,N)=>k+N.total_invoice_amount,0))}),s.jsx("td",{className:"text-right px-3 py-3 text-blue-600",children:A(T.reduce((k,N)=>k+N.total_paid_amount,0))}),s.jsx("td",{className:"text-right px-3 py-3 text-orange-600",children:A(T.reduce((k,N)=>k+N.total_remaining_amount,0))}),s.jsx("td",{className:"text-center px-3 py-3 text-red-600",children:A(T.reduce((k,N)=>k+N.overdue_amount,0))}),s.jsx("td",{colSpan:2})]})})]})}):o==="overdue"?s.jsx("div",{className:"overflow-x-auto",children:I.length===0?s.jsxs("div",{className:"flex flex-col items-center py-16 text-gray-400",children:[s.jsx(hn,{className:"w-12 h-12 mb-3 text-green-300"}),s.jsx("p",{className:"text-sm font-medium",children:"Khng c ha n qu hn!"}),s.jsx("p",{className:"text-xs",children:"Tt c ang trong thi hn thanh ton"})]}):s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-red-50",children:[s.jsx("th",{className:"text-left px-4 py-3 font-medium text-red-700",children:"Ha n"}),s.jsx("th",{className:"text-left px-3 py-3 font-medium text-red-700",children:"NCC"}),s.jsx("th",{className:"text-left px-3 py-3 font-medium text-red-700",children:"n hng"}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-red-700",children:"Hn TT"}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-red-700",children:"Qu hn"}),s.jsx("th",{className:"text-right px-3 py-3 font-medium text-red-700",children:"Tng H"}),s.jsx("th",{className:"text-right px-3 py-3 font-medium text-red-700",children:"Cn n"}),s.jsx("th",{className:"text-center px-3 py-3 font-medium text-red-700",children:"Trng thi"})]})}),s.jsx("tbody",{className:"divide-y",children:I.map(k=>s.jsxs("tr",{className:"hover:bg-red-50/50",children:[s.jsxs("td",{className:"px-4 py-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(vr,{className:"w-4 h-4 text-red-400"}),s.jsx("span",{className:"font-medium text-gray-900",children:k.invoice_number})]}),s.jsxs("p",{className:"text-xs text-gray-500 ml-6",children:["Ngy: ",P(k.invoice_date)]})]}),s.jsxs("td",{className:"px-3 py-3",children:[s.jsx("p",{className:"font-medium text-gray-900",children:k.supplier_name}),s.jsx("p",{className:"text-xs text-gray-500",children:k.supplier_code})]}),s.jsx("td",{className:"px-3 py-3",children:k.order_code?s.jsx("p",{className:"text-xs text-blue-600",children:k.order_code}):s.jsx("span",{className:"text-xs text-gray-400",children:""})}),s.jsx("td",{className:"text-center px-3 py-3",children:s.jsx("span",{className:"text-xs text-red-600 font-medium",children:P(k.due_date)})}),s.jsx("td",{className:"text-center px-3 py-3",children:s.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${k.days_overdue>30?"bg-red-200 text-red-800":k.days_overdue>7?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:[s.jsx(Kr,{className:"w-3 h-3"}),k.days_overdue," ngy"]})}),s.jsx("td",{className:"text-right px-3 py-3 font-medium",children:A(k.total_amount)}),s.jsx("td",{className:"text-right px-3 py-3",children:s.jsx("span",{className:"font-bold text-red-600",children:A(k.remaining_amount)})}),s.jsx("td",{className:"text-center px-3 py-3",children:B(k.payment_status)})]},k.id))}),s.jsx("tfoot",{children:s.jsxs("tr",{className:"bg-red-50 font-semibold",children:[s.jsxs("td",{colSpan:5,className:"px-4 py-3 text-red-700",children:["Tng cng (",I.length," ha n qu hn)"]}),s.jsx("td",{className:"text-right px-3 py-3 text-red-700",children:A(I.reduce((k,N)=>k+N.total_amount,0))}),s.jsx("td",{className:"text-right px-3 py-3 text-red-700",children:A(I.reduce((k,N)=>k+N.remaining_amount,0))}),s.jsx("td",{})]})})]})}):null})]})]})},j_e={draft:"Nhp",confirmed:" xc nhn",partial:"ang giao",completed:"Hon thnh",cancelled:" hy"},N_e={draft:"bg-gray-100 text-gray-700",confirmed:"bg-blue-100 text-blue-700",partial:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700",cancelled:"bg-gray-100 text-gray-500"},k_e={draft:vr,confirmed:Un,partial:Cn,completed:Un,cancelled:nu},S_e=[{key:"all",label:"Tt c",icon:jl},{key:"draft",label:"Nhp",icon:vr},{key:"confirmed",label:" XN",icon:Un},{key:"partial",label:"ang giao",icon:Cn},{key:"completed",label:"Hon thnh",icon:Un}];function C_e(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}function A_e({status:e}){const r=k_e[e]||vr,t=j_e[e]||e,n=N_e[e]||"bg-gray-100 text-gray-700";return s.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium ${n}`,children:[s.jsx(r,{className:"w-3.5 h-3.5"}),t]})}function E_e({invoiceProgress:e,paymentProgress:r,status:t}){return t==="draft"||t==="cancelled"?s.jsx("span",{className:"text-xs text-gray-400",children:""}):s.jsxs("div",{className:"space-y-1.5 min-w-[100px]",children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(hc,{className:"w-3 h-3 text-blue-400 flex-shrink-0"}),s.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:`${Math.min(e,100)}%`}})}),s.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[e,"%"]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(lc,{className:"w-3 h-3 text-green-400 flex-shrink-0"}),s.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:`${Math.min(r,100)}%`}})}),s.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[r,"%"]})]})]})}function T_e(){const e=ts(),r=jo(),[t,n]=R.useState([]),[a,i]=R.useState(!0),[o,c]=R.useState("all"),[u,l]=R.useState(""),[d,f]=R.useState(""),[p,h]=R.useState(1),[y,g]=R.useState(10),[m,x]=R.useState(0),[v,w]=R.useState({}),[_,A]=R.useState(!1),[P,B]=R.useState(""),[T,I]=R.useState([]),[U,H]=R.useState(null),[z,O]=R.useState({show:!1,order:null,loading:!1}),[L,E]=R.useState(r.state?.message||null);R.useEffect(()=>{zi.getAllActive().then(I).catch(console.error)},[]);const k=R.useCallback(async()=>{i(!0);try{const M={page:p,pageSize:y,search:u};o!=="all"&&(M.status=o),P&&(M.department_id=P);const G=await ca.getAll(M);n(G.data),x(G.total)}catch(M){console.error("Error loading orders:",M)}finally{i(!1)}},[p,y,u,o,P]);R.useEffect(()=>{k()},[k]),R.useEffect(()=>{(async()=>{try{const G=await ca.getStatusCounts();w(G)}catch(G){console.error("Error loading counts:",G)}})()},[t]),R.useEffect(()=>{if(L){const M=setTimeout(()=>E(null),5e3);return()=>clearTimeout(M)}},[L]);const N=()=>{l(d),h(1)},S=M=>{c(M),h(1)},C=async()=>{if(z.order){O(M=>({...M,loading:!0}));try{await ca.delete(z.order.id),O({show:!1,order:null,loading:!1}),k()}catch(M){alert(M.message||"Li xa"),O(G=>({...G,loading:!1}))}}},D=Math.ceil(m/y),q=Object.values(v).reduce((M,G)=>M+G,0)-(v.cancelled||0);return s.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 space-y-5",children:[L&&s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("span",{className:"text-sm text-green-700 flex items-center gap-2",children:[s.jsx(Un,{className:"w-4 h-4"}),L]}),s.jsx("button",{onClick:()=>E(null),children:s.jsx(Br,{className:"w-4 h-4 text-green-400"})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(jl,{className:"w-6 h-6 text-blue-500"}),"n t hng"]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[m," n hng"]})]}),s.jsxs("button",{onClick:()=>e("/purchasing/orders/new"),className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 shadow-sm transition-colors",children:[s.jsx(An,{className:"w-4 h-4"}),"To n hng"]})]}),s.jsx("div",{className:"flex gap-1 p-1 bg-gray-100 rounded-xl overflow-x-auto",children:S_e.map(M=>{const G=M.icon,X=M.key==="all"?q:v[M.key]||0;return s.jsxs("button",{onClick:()=>S(M.key),className:`flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap transition-colors ${o===M.key?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[s.jsx(G,{className:"w-4 h-4"}),M.label,s.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${o===M.key?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-500"}`,children:X})]},M.key)})}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:d,onChange:M=>f(M.target.value),onKeyDown:M=>M.key==="Enter"&&N(),placeholder:"Tm m n, d n...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d&&s.jsx("button",{onClick:()=>{f(""),l(""),h(1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(Br,{className:"w-4 h-4"})})]}),s.jsxs("button",{onClick:()=>A(!_),className:`flex items-center gap-2 px-4 py-2.5 border rounded-lg text-sm transition-colors ${_||P?"border-blue-500 text-blue-600 bg-blue-50":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:[s.jsx(Al,{className:"w-4 h-4"}),"B lc",P&&s.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),s.jsx("button",{onClick:k,disabled:a,className:"p-2.5 border border-gray-300 rounded-lg text-gray-500 hover:bg-gray-50",children:s.jsx(Vr,{className:`w-4 h-4 ${a?"animate-spin":""}`})})]}),_&&s.jsxs("div",{className:"flex items-end gap-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Phng ban"}),s.jsxs("select",{value:P,onChange:M=>{B(M.target.value),h(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"Tt c phng ban"}),T.map(M=>s.jsx("option",{value:M.id,children:M.name},M.id))]})]}),P&&s.jsx("button",{onClick:()=>{B(""),h(1)},className:"px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",children:"Xa lc"})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"M n"}),s.jsx("th",{className:"text-left px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"D n"}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Ngy"}),s.jsx("th",{className:"text-right px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Tng tin"}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Trng thi"}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Tin "}),s.jsx("th",{className:"text-center px-4 py-3 text-xs font-semibold text-gray-500 uppercase tracking-wider w-12"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:a?Array.from({length:5}).map((M,G)=>s.jsxs("tr",{className:"animate-pulse",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-40"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mx-auto"})}),s.jsx("td",{className:"px-4 py-3 text-right",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-28 ml-auto"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("div",{className:"h-5 bg-gray-200 rounded-full w-20 mx-auto"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mx-auto"})}),s.jsx("td",{className:"px-4 py-3"})]},G)):t.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[s.jsx(jl,{className:"w-10 h-10 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:u||P?"Khng tm thy n hng ph hp":"Cha c n hng no"}),!u&&!P&&s.jsx("button",{onClick:()=>e("/purchasing/orders/new"),className:"mt-3 text-sm text-blue-600 hover:underline",children:"+ To n hng u tin"})]})}):t.map(M=>s.jsxs("tr",{onClick:()=>e(`/purchasing/orders/${M.id}`),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("span",{className:"font-medium text-blue-600 hover:underline",children:M.order_code})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("p",{className:"text-gray-900 truncate max-w-[200px]",children:M.project_name||""})}),s.jsx("td",{className:"px-4 py-3 text-center text-gray-500",children:new Date(M.order_date||M.created_at).toLocaleDateString("vi-VN")}),s.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900",children:C_e(M.grand_total||0)}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx(A_e,{status:M.status})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx(E_e,{invoiceProgress:M.invoice_progress||0,paymentProgress:M.payment_progress||0,status:M.status})}),s.jsx("td",{className:"px-4 py-3 text-center",onClick:G=>G.stopPropagation(),children:s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>H(U===M.id?null:M.id),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded",children:s.jsx($b,{className:"w-4 h-4"})}),U===M.id&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>H(null)}),s.jsxs("div",{className:"absolute right-0 top-8 z-20 bg-white border border-gray-200 rounded-lg shadow-lg py-1 w-40",children:[s.jsxs("button",{onClick:()=>{e(`/purchasing/orders/${M.id}`),H(null)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(ja,{className:"w-4 h-4"}),"Xem chi tit"]}),M.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>{e(`/purchasing/orders/${M.id}/edit`),H(null)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[s.jsx(sd,{className:"w-4 h-4"}),"Chnh sa"]}),s.jsx("div",{className:"border-t border-gray-100 my-1"}),s.jsxs("button",{onClick:()=>{O({show:!0,order:M,loading:!1}),H(null)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[s.jsx(En,{className:"w-4 h-4"}),"Xa"]})]})]})]})]})})]},M.id))})]})}),D>1&&s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-gray-50",children:[s.jsxs("span",{className:"text-xs text-gray-500",children:["Hin th ",t.length," / ",m]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>h(M=>Math.max(1,M-1)),disabled:p===1,className:"p-1.5 border border-gray-300 rounded hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(su,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-gray-600 px-2",children:[p," / ",D]}),s.jsx("button",{onClick:()=>h(M=>Math.min(D,M+1)),disabled:p===D,className:"p-1.5 border border-gray-300 rounded hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Ks,{className:"w-4 h-4"})})]})]})]}),z.show&&z.order&&s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>!z.loading&&O({show:!1,order:null,loading:!1})}),s.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl p-6 max-w-sm w-full",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Xa n hng?"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["n ",s.jsx("strong",{children:z.order.order_code})," s b xa vnh vin."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:()=>O({show:!1,order:null,loading:!1}),disabled:z.loading,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),s.jsxs("button",{onClick:C,disabled:z.loading,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[z.loading?s.jsx(Mt,{className:"w-4 h-4 animate-spin"}):s.jsx(En,{className:"w-4 h-4"}),z.loading?"ang xa...":"Xa"]})]})]})]})]})}const P_e=new _z({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function O_e({children:e}){const{isAuthenticated:r,isLoading:t}=xn();return t?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r?s.jsx(s.Fragment,{children:e}):s.jsx($u,{to:"/login",replace:!0})}function M_e({children:e}){const{isAuthenticated:r,isLoading:t}=xn();return t?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r?s.jsx($u,{to:"/",replace:!0}):s.jsx(s.Fragment,{children:e})}function I_e({children:e}){const{checkAuth:r}=xn();return R.useEffect(()=>{r()},[r]),s.jsx(s.Fragment,{children:e})}function R_e(){return s.jsx(jz,{client:P_e,children:s.jsx(Hq,{children:s.jsx(I_e,{children:s.jsxs(vq,{children:[s.jsx(fr,{path:"/login",element:s.jsx(M_e,{children:s.jsx(bX,{})})}),s.jsxs(fr,{path:"/",element:s.jsx(O_e,{children:s.jsx(EG,{})}),children:[s.jsx(fr,{index:!0,element:s.jsx(cme,{})}),s.jsx(fr,{path:"departments",element:s.jsx(u0e,{})}),s.jsx(fr,{path:"positions",element:s.jsx(f0e,{})}),s.jsx(fr,{path:"employees",element:s.jsx(g0e,{})}),s.jsx(fr,{path:"contract-types",element:s.jsx(x0e,{})}),s.jsx(fr,{path:"contracts",element:s.jsx(w0e,{})}),s.jsx(fr,{path:"leave-types",element:s.jsx(N0e,{})}),s.jsx(fr,{path:"leave-requests",element:s.jsx(S0e,{})}),s.jsx(fr,{path:"attendance",element:s.jsx(M0e,{})}),s.jsx(fr,{path:"shifts",element:s.jsx(l2e,{})}),s.jsx(fr,{path:"shift-assignments",element:s.jsx(k2e,{})}),s.jsx(fr,{path:"overtime",element:s.jsx(E2e,{})}),s.jsx(fr,{path:"overtime/approval",element:s.jsx(P2e,{})}),s.jsx(fr,{path:"salary-grades",element:s.jsx(R0e,{})}),s.jsx(fr,{path:"payroll-periods",element:s.jsx(D0e,{})}),s.jsx(fr,{path:"payslips",element:s.jsx(B0e,{})}),s.jsx(fr,{path:"performance-criteria",element:s.jsx(U0e,{})}),s.jsx(fr,{path:"performance-reviews",element:s.jsx(G0e,{})}),s.jsx(fr,{path:"tasks",element:s.jsx(kge,{})}),s.jsx(fr,{path:"tasks/create",element:s.jsx(bT,{})}),s.jsx(fr,{path:"tasks/new",element:s.jsx(bT,{})}),s.jsx(fr,{path:"tasks/:id",element:s.jsx(mye,{})}),s.jsx(fr,{path:"tasks/:id/edit",element:s.jsx(Tge,{})}),s.jsx(fr,{path:"my-tasks",element:s.jsx(zye,{})}),s.jsx(fr,{path:"approvals",element:s.jsx(exe,{})}),s.jsx(fr,{path:"evaluations/self-evaluation",element:s.jsx(PT,{})}),s.jsx(fr,{path:"self-evaluation",element:s.jsx(PT,{})}),s.jsx(fr,{path:"task-detail/:taskId",element:s.jsx(RT,{})}),s.jsx(fr,{path:"my-tasks/:taskId",element:s.jsx(RT,{})}),s.jsx(fr,{path:"reports/tasks",element:s.jsx(X1e,{})}),s.jsxs(fr,{path:"purchasing",children:[s.jsx(fr,{index:!0,element:s.jsx($u,{to:"/purchasing/suppliers",replace:!0})}),s.jsx(fr,{path:"suppliers",element:s.jsx(H2e,{})}),s.jsx(fr,{path:"suppliers/new",element:s.jsx(X2e,{})}),s.jsx(fr,{path:"suppliers/:id",element:s.jsx(dwe,{})}),s.jsx(fr,{path:"suppliers/:id/edit",element:s.jsx(Y2e,{})}),s.jsx(fr,{path:"categories",element:s.jsx(gwe,{})}),s.jsx(fr,{path:"types",element:s.jsx(xwe,{})}),s.jsx(fr,{path:"units",element:s.jsx(_we,{})}),s.jsx(fr,{path:"materials",element:s.jsx(jwe,{})}),s.jsx(fr,{path:"materials/:id",element:s.jsx(Swe,{})}),s.jsx(fr,{path:"variant-attributes",element:s.jsx(Cwe,{})}),s.jsx(fr,{path:"orders",element:s.jsx(Dwe,{})}),s.jsx(fr,{path:"orders/new",element:s.jsx(fP,{})}),s.jsx(fr,{path:"orders/:id",element:s.jsx(w_e,{})}),s.jsx(fr,{path:"orders/:id/edit",element:s.jsx(fP,{})}),s.jsx(fr,{path:"debt",element:s.jsx(__e,{})}),s.jsx(fr,{path:"payments",element:s.jsx(T_e,{})})]}),s.jsx(fr,{path:"settings",element:s.jsx(j5,{})}),s.jsx(fr,{path:"account",element:s.jsx(j5,{})}),s.jsx(fr,{path:"profile",element:s.jsx(j5,{})}),s.jsx(fr,{path:"my-evaluations",element:s.jsx($u,{to:"/my-tasks?tab=approved",replace:!0})}),s.jsx(fr,{path:"evaluations/my-tasks",element:s.jsx($u,{to:"/my-tasks",replace:!0})}),s.jsx(fr,{path:"evaluations/approval",element:s.jsx($u,{to:"/approvals",replace:!0})}),s.jsx(fr,{path:"evaluations/my",element:s.jsx($u,{to:"/my-tasks?tab=approved",replace:!0})}),s.jsx(fr,{path:"evaluations/results",element:s.jsx($u,{to:"/my-tasks?tab=approved",replace:!0})})]}),s.jsx(fr,{path:"*",element:s.jsx($u,{to:"/",replace:!0})})]})})})})}v$.createRoot(document.getElementById("root")).render(s.jsx(R.StrictMode,{children:s.jsx(R_e,{})}));export{Dn as _,on as c,ru as g};
